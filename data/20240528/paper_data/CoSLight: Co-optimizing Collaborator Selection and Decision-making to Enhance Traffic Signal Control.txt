CoSLight: Co-optimizing Collaborator Selection and
Decision-making to Enhance Traffic Signal Control
JingqingRuan‚Ä† ZiyueLi‚àó HuaWei
ruanjingqing2019@ia.ac.cn zlibn@wiso.uni-koeln.de hzw77@ist.psu.edu
InstituteofAutomation,Chinese UniversityofCologne ArizonaStateUniversity
AcademyofSciences EWIgGmbH Arizona,U.S.A
Beijing,China Cologne,Germany
HaoyuanJiang¬ß JiamingLu‚Ä† XuantangXiong
jianghaoyuan@zju.edu.cn lujia_ming@126.com xiongxuantang2021@ia.ac.cn
SenseTimeResearch SenseTimeResearch InstituteofAutomation,Chinese
BaiduInc. ISTBIofFudanUniversity AcademyofSciences
Shenzhen,China Shanghai,China Beijing,China
HangyuMao‚àó RuiZhao
maohangyu@senstime.com zhaorui@sensetime.com
SenseTimeResearch SenseTimeResearch
Beijing,China QingYuanResearchInstituteof
ShanghaiJiaoTongUniversity
Beijing,China
ABSTRACT KEYWORDS
Effectivemulti-intersectioncollaborationispivotalforreinforcement- TrafficSignalControl,Multi-intersectionTransportation,Multia-
learning-basedtrafficsignalcontroltoalleviatecongestion.Existing gentSystems,Multi-agentReinforcementLearning
workmainlychoosesneighboringintersectionsascollaborators.
ACMReferenceFormat:
However,quiteanamountofcongestion,evensomewide-range
JingqingRuan‚Ä†,ZiyueLi‚àó,HuaWei,HaoyuanJiang¬ß,JiamingLu‚Ä†,Xuan-
congestion,iscausedbynon-neighborsfailingtocollaborate.To
tangXiong,HangyuMao‚àó,andRuiZhao.2018.CoSLight:Co-optimizing
addresstheseissues,weproposetoseparatethecollaboratorselec- CollaboratorSelectionandDecision-makingtoEnhanceTrafficSignalCon-
tionasasecondpolicytobelearned,concurrentlybeingupdated trol.InProceedingsofMakesuretoenterthecorrectconferencetitlefromyour
withtheoriginalsignal-controllingpolicy.Specifically,theselection rightsconfirmationemai(Conferenceacronym‚ÄôXX).ACM,NewYork,NY,
policyinreal-timeadaptivelyselectsthebestteammatesaccord- USA,25pages.https://doi.org/XXXXXXX.XXXXXXX
ingtophase-andintersection-levelfeatures.Empiricalresultson
bothsyntheticandreal-worlddatasetsproviderobustvalidation 1 INTRODUCTION
forthesuperiorityofourapproach,offeringsignificantimprove- TrafficSignalControl(TSC)playsacriticalroleinmanagingurban
mentsoverexistingstate-of-the-artmethods.Codeisavailableat trafficflowandalleviatingcongestion.Overthepastdecade,multi-
https://github.com/AnonymousAccountss/CoSLight. agentreinforcementlearning(MARL)hasemergedasapowerful
toolforoptimizingTSC[11,44].However,effectivelypromoting
CCSCONCEPTS
multi-intersectioncollaborationremainsapersistentchallengein
‚Ä¢Computingmethodologies‚ÜíNeuralnetworks;Partially-observable applyingMARLtoTSC.
Markovdecisionprocesses;Multi-agentreinforcementlearning; Traditionally,researchershavetreatedgeographicallyadjacent
Sequentialdecisionmaking. intersectionsasnaturalcollaborators,andcombinedMARLmeth-
odswithgraphneuralnetworks(GNNs)[4,7,19,27,43,47,51]
‚Ä†TheseauthorsworkasresearchinternsatSenseTimeResearch.
andapproachesmulti-levelembeddings[10,12,17,25,29,55]to
¬ßWorkdoneatSenseTimeResearch,nowinBaiduInc.
‚àóThecorrespondingauthor. modelmulti-intersectioncollaboration.However,thecollaboration
amongintersectionsmightbefarbeyondtopologicalproximityin
Permissiontomakedigitalorhardcopiesofallorpartofthisworkforpersonalor therealworld[48,58].Forinstance,duringmorningrushhours,
classroomuseisgrantedwithoutfeeprovidedthatcopiesarenotmadeordistributed
forprofitorcommercialadvantageandthatcopiesbearthisnoticeandthefullcitation signalsfromresidentialtobusinessareasmustbestrategicallyco-
onthefirstpage.Copyrightsforcomponentsofthisworkownedbyothersthanthe ordinatedtofacilitatedrivingintown.AsshowninFigure1(a),
author(s)mustbehonored.Abstractingwithcreditispermitted.Tocopyotherwise,or
intersectionsinupperstreamsshouldregulateincomingtrafficto
republish,topostonserversortoredistributetolists,requirespriorspecificpermission
and/orafee.Requestpermissionsfrompermissions@acm.org. preventdownstreamcongestion,requiringthemtosynchronize
Conferenceacronym‚ÄôXX,June03‚Äì05,2018,Woodstock,NY withsignalsclosertobusinessdistricts,whichdirecttraffictowards
¬©2018Copyrightheldbytheowner/author(s).PublicationrightslicensedtoACM. parkingandalternateroutes.Thiscoordinationgoesbeyondmere
ACMISBN978-1-4503-XXXX-X/18/06
https://doi.org/XXXXXXX.XXXXXXX proximity,emphasizingtheneedfordynamicandnon-adjacent
4202
yaM
72
]AM.sc[
1v25171.5042:viXraConferenceacronym‚ÄôXX,June03‚Äì05,2018,Woodstock,NY TrovatoandTobin,etal.
Weconductcomprehensiveexperimentsusingbothsynthetic-
andrealdatawithdifferenttrafficflowandnetworkstructures.
Residential area
Ourmethodconsistentlyoutperformsstate-of-the-artRLmethods,
whichshowsthattheeffectivenessofcollaboratorselectionand
Business area
jointoptimizationwithdecisionpolicy.Wefurthershowcasethat
Coordination theselectedcollaboratorsarenotnecessarilygeographicneighbors,
andvisualizeseveralinterestingcollaborationstrategieslearnedby
(a) Morning Rush Hours (b) Evening Rush Hours
ourmethodtoshowthatourcollaboratorselectioniseffectiveand
generalizabletodifferentroadnetworks.
œÅ ÔøΩ w/o optimization œÅ ÔøΩ,ÔøΩ joint optimization
Insummary,ourcontributionisthefollowing:
‚Ä¢ CoSLightisthefirstworktodecoupleandco-optimizethe
suboptimal
collaboratorselectionpolicyandsignalplanningpolicy.
ÔøΩ ÔøΩ‚àó ÔøΩ‚àó
‚Ä¢ Specifically,CoSLightcombinesaDual-FeatureExtractor,
capturingbothphase-andintersection-levelfeatures,witha
Œ∏ Œ∏
Multi-IntersectionCollaborationmoduledesignedtostrate-
(c) Fixed œÅ, with Optimized Œ∏ (d) Joint Optimization of œÅ and Œ∏ gicallychoosecooperatingintersections.Moreover,ajoint
optimizationstrategyisderivedtoco-trainthecollaborator
Figure1:(a)-(b):Thecoordinationbetweenareasofintersec-
selectionanddecision-makingpolicies,whichusesajoint
tionsduringrushhours;(c)-(d):ThecollaborationpolicyùùÜ
policygradienttoenhancethecumulativereturn,empha-
anddecisionpolicyùúΩ shouldbejointlyoptimizedtoprevent
sizingtheinterdependencebetweencollaborationselection
suboptimal.
anddecision-making.
‚Ä¢ Extensiveevaluationsandmulti-dimensionalanalysisusing
collaborationacrossthenetwork.Likewise,duringeveningrush syntheticandreal-worlddatasetsdemonstratetheeffective-
hoursinFigure1(b),signalsfrombusinesstoresidentialareasalso nessandsuperiorityofCoSLight.
needtocooperateforbetterdrivingoutoftown.Thecoordination
2 RELATEDWORK
betweenareasofintersectionsinthemorningandeveningpeaks
mostlydifferduetodifferentorigin-destinationflowsandother Inthissection,wereviewexistingapproachesbasedonhowthey
factorssuchasweatherandtrippurpose. collaborate:implicitandexplicitcollaboration.
Inthispaper,weproposeCoSLighttoinvestigatethecollabo- Implicitcollaborationonlyaccessesinformationfromother
rationamongintersectionsbeyondtopologicalneighbors,which agentsduringtheupdatephasetoassistgradientbackpropagation.
comesalongwithtwoquestions: MPLightrepurposesFRAP[57]foramulti-agentcontext.IPPO[1]
‚Ä¢Whomtocollaborateforbetterdecisions?Whileexisting andMAPPO[50]tackleTSCproblemsdirectlyfromtheMARLper-
methods relying on heavy GNNs to learn whom to collaborate spective.Workslike[15,35]extendthesingle-agentDQNsolution
requireinformationpropagationwithinthewholenetwork,inreal- tomulti-agentscenariosusingthemax-pluscoordinationalgorithm.
time,thecollaboratorselectionmustbelightandagile.Inthispaper, OthermethodssuchasIntelliLight[45]andPressLight[42]enrich
weutilizeasimpletwo-layerMLPstructurefortop-ùëòcollaborator thestatespacebyleveragingdifferenttypesofadditionalinforma-
selection,whichnotonlyreducescomputationalcomplexity[9,33, tion,likeimageframesormaxpressure,respectively.FMA2C[21]
41]butalsoachievesbetterperformanceinexperiments.Instead andFedLight[49]considercollaborativeoptimizationfromfed-
of counting on GNNs to learn the relationships by themselves, eratedRL.However,thesemethodsfocusonmulti-intersection
weincorporatetwogoldenrulesintheMLPcollaborationmatrix: informationfromanupdatemechanismorgradientdesignperspec-
that‚Äúyouareyourbiggestcollaborator‚Äùand‚Äúmutualreciprocity‚Äù, tive,whilethedecentralizedexecutionleadstoweakattentionand
whichpenalizethediagonaltobethelargestandthematrixtobe mayhinderefficientmulti-intersectioncollaboration.
symmetric.Theserulessignificantlyimprovecollaborationbenefits. Explicitcollaborationallowsaccessingotheragents‚Äôinfor-
‚Ä¢Howtocollaborateandoptimizedecisions?Thegoodness mationduringthedecision-makingprocesstoenhancecollabo-
ofcollaboratorselectionlargelyinfluencesthegoodnessofthede- ration.Toovercometheshortcomingsofweakcollaborationin
cisionpolicy.Forexample,thetraditionalpracticeistofirstselect implicitstrategies,explicitcollaborationmethodscanbefurther
collaboratorswithouttrainingandthentodecidethesignalpolicy, categorizedintotwosub-classes.Onelineofresearchfocuseson
asshowninFigure1(c),whichcomeswithtwodrawbacks:(1)the multi-intersectionrepresentationextraction,suchasCoLight[43],
decisionpolicyforoneintersectionmightneedalongertimetoad- DynSTGAT[47],IG-RL[7],MaCAR[51],andMetaGAT[19],which
justtoitscollaborators,(2)thedecisionpolicyisoptimizedtowards utilizeGNNsasthefeatureextractortomodelrepresentationsof
maximizing the cumulative reward, while the collaborators are thecurrentintersectionanditsneighbors.However,thesemeth-
selectedseparatelywithoutacknowledgmentoftheperformance odsriskintroducingnoise,suchasunrelatedintersectionfeatures,
ofdecisionpolicy.Toaddressthischallenge,inthispaper,wede- intocollaboration;italsosuffersfromthecomputationalcomplex-
signajointoptimizationschemethatsimultaneouslytrainsthe ity of matrix multiplication. Another line of research leverages
collaborationselectionpolicyanddecisionpolicytomaximizethe group-basedcooperation[22,28,29,39,40].MT-GAD[13],and
cumulativereturnthroughajointpolicygradient,reinforcingthe JointLight[16]usesheuristicgrouping,whichrequiresmanualde-
strongcouplingbetweencollaborationpolicyanddecisionpolicy. sign,whileCGB-MATSC[38]appliesKNNgroupingdirectlybasedCoSLight:Co-optimizingCollaboratorSelectionandDecision-makingtoEnhanceTrafficSignalControl Conferenceacronym‚ÄôXX,June03‚Äì05,2018,Woodstock,NY
onstateobservation,anon-parametricmethod.GeneraLight[53] Multi-IntersectionTrafficSignalControl(TSC).Ateachin-
utilizesùëò-meanstoexecutetheflowclusteringtolearndiversemeta- tersection,anRLagentisdeployedtomanagethetrafficsignal
parameters.GPLight[18]utilizesmutualinformationandgathering control.Duringeachtimeunitdenotedasùë° ,theRLagent
ùëëùë¢ùëüùëéùë°ùëñùëúùëõ
constraintstoderivelatentrepresentations,whicharesubsequently ùëñobservesthestateoftheenvironment,representedasùëúùëñ.Itthen
ùë°
clusteredintogroups.However,theirgroupingstrategiescannot determinestheactionùëéùëñ,whichdictatesthesignalphaseforinter-
ùë°
bedirectlyco-optimizedwiththedecision-makingprocessusing sectionùëñ.Theobjectiveoftheagentùëñistochooseanoptimalaction
therewardsignalinRL,leadingtoapotentiallysuboptimalsignal (i.e.,determiningthemostappropriatesignalphase)tomaximize
policy. thecumulativereward.
Incontrasttotheseexistingmethods,weintroduceadual-feature QueueLength.Thequeuelengthateachintersectionùëñisdefined
extractortoderivecollaboratorrepresentationsbeneficialforcol- astheaggregatelengthofvehiclequeuesinallincominglanes
laboration.Furthermore,weproposeCoSpolicyco-learnedwith towardtheintersection,denotedas:
decisionpolicywithMIRL.Thisallowsfortheselectionofoptimal
collaboratorsandprimitiveactionforeachintersection,guiding ùëÑ ùëôùëñ ùëíùëõ =‚àëÔ∏Å ùëû(ùëô),ùëô ‚ààL ùëñùëñ ùëõ, (1)
intensecollaborationamongmultipleintersections.
whereùëû(ùëô)isthequeuelengthinthelaneùëô.
3 PRELIMINARYANDPROBLEMSTATEMENT
Pressure.Pressurecanbedividedintointersection-wiseand
phase-wise categories. Intersection-wise pressure measures the
3.1 Preliminary imbalancebetweenincomingandoutgoingvehiclequeuesatan
Firstly,weintroducesomefundamentalconceptsrelatedtotraffic intersection,indicatingtrafficloaddiscrepancies.Phase-wisepres-
signal control, including traffic movement, signal phase, traffic sureconcernsaspecificsignalphaseùëù.Eachsignalphasepermits
intersection,multi-intersectiontrafficsignalcontrol,queuelength, severaltrafficmovements,eachmarkedby(ùëô,ùëö).Letùë•(ùëô,ùëö)sig-
andpressure.InFigure2,wegiveavisualrepresentationofthese nifythevehiclecountdifferencebetweenlaneùëô andlaneùëöfora
conceptstofurtheraidunderstanding. movement(ùëô,ùëö),andthephase-wisepressureùëÉ(ùëù)denotesthecu-
mulativesumofthepressuresofallpermissiblemovementswithin
thatphase,i.e.,(cid:205) (ùëô,ùëö)ùë•(ùëô,ùëö).
A B C D
E F G H 3.2 ProblemStatement
(b) Twelve Movements (c) Eight Phases
38 25 Then,weformulateùëÅ-intersectionproblembasedonmultiagent
Left Lane 6
Through Lane 1 47 Phases A B C D E F G H Markov decision processes (MMDPs) [5] as collaborator-based
Right Lane
.....
MMDPs,whichcanbeexpressedas<{I},S,O,{Cùëñ} ùëñùëÅ =1,{Aùëñ} ùëñùëÅ =1,
Time steps t = 1 2 3 T - 2 T - 1 T P,ùëü,ùõæ >.ùëñ ‚àà I istheùëñùë°‚Ñé intersection,ùëÅ isthenumberofinter-
(a) Four-arm Intersection (d) Phase Selection sections, and S,O are the global state space and local observa-
tionspace.Cùëñ andAùëñ denotetheselectedcollaboratorandaction
Figure2:(a)Theillustrationofintersection.(b)Thereare12
spacefortheùëñùë°‚Ñé intersection.WelabelùíäùíÖùíî:=(ùíäùíÖùíî1,...,ùíäùíÖùíîùëÅ) ‚ààC
movements:[North,South,West,East(fourapproaches)]√ó
andùíÇ := (ùëé1,...,ùëéùëÅ) ‚àà A thejointcollaboratoridentifiersand
[Left,Go-through,Right(threedirections)].Usually,turning
actionsforallintersections.P(¬∑|ùë†,ùíäùíÖùíî,ùíÇ)isthetransitiondynam-
right isn‚Äôt signal-controlled, so only 8 movements (index
ics.Allintersectionssharethesamerewardfunctionùëü(ùë†,ùíäùíÖùíî,ùíÇ) :
from1-8in(a))aresignal-controlled.(c)Aphaseistwonon-
S√óC√óA ‚Üí R.ùõæ ‚àà (0,1) denotesadiscountfactor.Here,we
conflictingmovementsthatcanbereleasedtogether.There
are8phases,e.g.,phase-Acombinesmovements1and5.(d)
candenoteùúè =(ùë†0,ùíäùíÖùíî0,ùíÇ0,ùë†1,...)asthetrajectoryinducedbythe
Thesignal-controlpolicyistoselectonephaseforthenext
policyùùÖùëéùëôùëô ={{ùúåùëñ ¬∑ùúãùëñ} ùëñùëÅ =1},whereùúåùëñ denotesthecollaboratorse-
lectionpolicy,andùúãùëñ isthedecisionpolicy.Alltheintersections
timestepaccordingtothetrafficcondition.
coordinatetogethertomaximizethecumulativediscountedreturn
TrafficIntersection.Atrafficintersection,wheremultipleroads E icùùâ y‚àº aùùÖ sùëé tùëôùëô he(cid:2)(cid:205) prùë°‚àû o=0 duùõæ cùë° tùëü( oùë† fùë° s, eùíäùíÖ leùíî cùë° t, iùíÇ oùë° n)(cid:3) p. oW lice yc ùúåan ande dfi dn ee cit sh ie onov pe or la icll yjo ùúãin bt ap seo dl-
intersect,usestrafficsignalstocontrolvehicleflow.Figure2depicts onBayesianchainrules.
afour-armintersection,equippedwithlanesdesignatedforleft
turns,straighttravel,andrightturns.Itfeaturesfourroadsand ùëÅ
twelvelanesforbothenteringandexitingtraffic.Wedenotethe
ùùÖùëéùëôùëô (ùíäùíÖùíî,ùíÇ|ùë†)=(cid:214) ùúåùëñ (ùíäùíÖùíîùëñ |ùëúùëñ )√óùúãùëñ (ùëéùëñ |ùëúùëñ,ùíäùíÖùíîùëñ ). (2)
incomingandoutgoinglanesatintersectionùëñasLùëñ andLùëñ . ùëñ=1
ùëñùëõ ùëúùë¢ùë°
TrafficMovement.Itreferstotheprogressionofvehiclesacross 4 METHODOLOGY
anintersectioninaspecificdirection,namely,turningleft,going
4.1 MainModules
straight,orturningright.AsdepictedinFigure2,twelvedistinct
trafficmovementscanbeidentified.Right-turningvehiclesusually As shown in Figure 3, the dual-feature extractor pre-processes
proceedregardlessofthesignalstatus. eachintersectionbyobtainingphase-andintersection-levelrep-
SignalPhase.Itisasetoftwotrafficmovementsthatcanbe resentations.Subsequently,theCoSidentifiesthemostappropri-
releasedtogetherwithoutconflicts.AsillustratedinFigure2,the atecollaboratorsandcollectstheirinformationtoassistwiththe
intersectioncompriseseightdistinctphasesA-H. decision-makingprocess.Conferenceacronym‚ÄôXX,June03‚Äì05,2018,Woodstock,NY TrovatoandTobin,etal.
Phase
A
...
1 Diagonal maximization cons. 1638 4725 E FRAP   1    1  Te...T ao m Tp m o-k pTa -ot  kep-  k  Symmetry cons. ids Mean D Poe lc ii cs yion 1
sigCnomlleanbtorator  Teammate 1
H ssS ige nle mc eti no tn 
Policy
0.4 0.1 0.1 0.1 0.2
(CoS) 
0.1 0.6 0.1 0.1 0.1 sample Decision         0.1 0.1 0.5 0.2 0.1 ids Mean Policy  Phase ... 0.1 0.2 0.3 0.3 0.1   Softmax... 0.2 0.1 0.2 0.1 0.4 
A
Softmax... Collaborator Matrix
1638 4725 E FRAP         Softmax ids Mean D Poe lc ii cs yion  


H
Dual-Feature Extractor Multi-Intersection Collaboration
Figure3:OverviewofourproposedCoSLight:integratingDual-FeatureExtractorforphase-andintersection-levelfeatures
withthemoduleofMulti-IntersectionCollaborationtoselectteammatesforcooperation.
4.1.1 Dual-FeatureExtractor. Tooptimizepolicy-makinginTSC, comprehensiveinsighttoprovidesufficientrepresentationforsub-
acomprehensiverepresentationoftrafficsituationsisvital.While sequentmodeling.
phase-levelfeaturesinformindividualintersections,theylackbroader
4.1.2 Multi-IntersectionCollaboration. Themodulefacilitatesco-
coordinationinsightsfromcorrelatedintersections.Thus,wecom-
operation among multiple intersections. By leveraging the rich
plementthesewithintersection-levelfeaturestobettercapture
network-widetrafficdynamicsformulti-intersectioncontrolbased
representationùíÜùëñùëü,wedesigntheCoStoselectsuitablecollabora-
torsforeachintersection.
onTransformer[37].
Asmentionedbefore,sincethecollaborationpolicy(CoS)will
Atthephaselevel,weadoptFRAP[57]toobtainthephase-
beco-optimizedwiththedecisionpolicy,aliteandfastmoduleis
levelrepresentation.Therawobservationsùëú fromthesimulator
preferredtoavoidbecomingthecomputationbottleneck.Thus,we
includeùêæfeatures,suchasthenumberofvehicles,queuelength,the
pursueminimalism:tousetwo-stackedMLPs.Surprisingly,weare
currentphase,theflow,etc.Foranytrafficmovementùëö‚àà{1,...,8}
notalone:incomputervision,MLP-Mixer[33]isexclusivelybased
inanintersectionùëñ,theùëò-thfeatureintherawobservationcanbe
onMLPandattainscompetitivescoresasCNN-basedmethodsor
denotedasùëúùëñ .Forbrevity,thesuperscriptùëñisomittedhereinafter.
ùëö,ùëò evenViT.Inthespatiotemporaldomain,MLPInit[9]alsoproves
Theprocesscanbesummarizedasfollows.
thatMLPscouldbe600√ófasterthanGNNandachievescomparable
ùíÜùëö=|| ùëòùêæ =1ùúé(MLP ùëò(ùëú ùëö,ùëò)),ùíÜùëùùëêùëü =FRAP(ùíÜùëö1,...,ùíÜùëö8), (3) resultssinceMLPisfreefrommatrixmultiplication.GFS[41]gives
aninsightfulandtheoretically-rigidexplanation:MLPswithgen-
ùíÜùëñ ùëùùëü =MLP(ùíÜùëùùëêùëü), (4) erallayernormalizationprovidesimilarfunctionalityand
where||isconcatenation,ùúéistheactivationfunction,andùíÜùëöisthe effectivenessofaggregatingnodes.Moreover,anablationstudy
embeddingoftrafficmovement.ThenFRAP(¬∑)module(detailsin byreplacingMLPswithGNNsinSection6.5empiricallyconfirms
AppendixB)isappliedtoextractthephasecompetitionrepresenta- theeffectivenessofMLPs.
tionùíÜùëùùëêùëü,andwereshapeùíÜùëùùëêùëü asavectorthroughflattenoperation. Thus, the top-ùëò Collaborator Selection (CoS) policy is imple-
Finally,ùíÜùëñ
ùëùùëü
isthephaserepresentationintheintersectionùëñ. mentedbytwo-stackedMLPlayers,
Attheintersectionlevel,weadopttheTransformerencoder[23, ùú∂ùëñ =ùëì ùê∂ùëúùëÜ(ùíÜùëñùëü)=MLP(ùíÜùëñùëü), (6)
24,52]asthebackbonetomodeltherelationshipacrossmultiplein-
tersections:ittakesinthephaserepresentationsùíÜùëùùëü ={ùíÜùëñ ùëùùëü} ùëñùëÅ =1,ùíÜùëùùëü ‚àà w dih ste rr ie buùú∂ tiùëñ or nep cr ae nse bn ets coth ne stl ro ug ci tt es df :romtheMLP.Thentheprobability
RùëÅ√óùëë,ùëë istheinputdimension.Attentioncanbecalculatedto
(cid:32) exp(ùõºùëñ) (cid:33)
o mb at ta ii on nt fh re omint de ir ffse ec reti no tn i- nle tev re sl er ce tp iore ns se ‚Äôn rt ea pt rio esn enùíÜùëñ tùëü a, tia ott ne sn .dingtoinfor- Pùëñ :=ùê∂ùëéùë°ùëíùëîùëúùëüùëñùëêùëéùëô (cid:205) ùëó‚Ä≤‚ààIexpùëó (ùõºùëñ ùëó‚Ä≤),ùëó ‚àà I , (7)
fromwhichtheindicesoftheselectedcollaboratorsfortheintersec-
ùíÜùëñùëü =TransformerEnc(ùíÜùëùùëü), ùíÜùëñùëü ‚ààRùëÅ√óùëë, (5) tionùëñcanbesampled.Here,wesetthehyper-parameterùëòas5.We
The TransformerEnc is the standard Transformer encoder with cansamplethetop-ùëòcollaboratoridentifierswithoutreplacement
multi-head,followedbyafeed-forwardnetwork. fromPùëñ,whichmeanssamplingthefirstelement,thenrenormal-
Insummary,byextractingfeaturesfromboththephase-and izingtheremainingprobabilitiestosamplethenextelement.Let
intersection-level simultaneously, we are able to obtain a more ùêºùê∑‚àó,...,ùêºùê∑‚àó bean(ordered)samplewithoutreplacementfromthe
1 ùëò
...
...
...
...
...
...
...
...
Transformer
Backbone
...
...
... ... ... ... ... ... ... ... ... ... ... ...
...
...
...
...CoSLight:Co-optimizingCollaboratorSelectionandDecision-makingtoEnhanceTrafficSignalControl Conferenceacronym‚ÄôXX,June03‚Äì05,2018,Woodstock,NY
Pùëñ,thenthejointprobabilitycanbeformulatedasfollows. thematrixsignifiestheprobabilityofcollaboratorselectionbetween
ùëÉ(ùêºùê∑ 1‚àó=ùëñùëë 1‚àó,...,ùêºùê∑ ùëò‚àó =ùëñùëë ùêæ‚àó)=(cid:214) ùëñùëò
=1
(cid:205)
ùúÑe ‚ààx Ip ùëñ‚àó( eùõº xùëñùëñ pùëë ùëñ‚àó (ùõº) ùúÑùëñ), (8) t mhe iR zi aun tt l ie e or n1se : cc ‚Äú ot Yi noo sun ts ra aùëñ r ia e nn y td o iu sùëó. r imb pig og see dst .Tc ool pla rib oo rr ita izt eor i‚Äù t. sD deia cig so ion na -l mm aka ix ni g-
whereùëñùëë‚àó,...,ùëñùëë‚àó =argtop-ùëò(Pùëñ)isthesampledtop-ùêæ realization foreachintersection,weenforcethediagonalmaximizationcon-
ofvariab1 lesùêºùê∑‚àóùëò
,...,ùêºùê∑‚àó,andI‚àó=I\{ùëñùëë‚àó,...,ùëñùëë‚àó }isthedomain
straintonthematrixùë¥ùúå,ensuringitremainsavalidprobability
1 ùëò ùëñ 1 ùëñ‚àí1 distributionmatrix.Themainobjectiveistomaximizethesumof
(withoutreplacement)fortheùëñ-thsampledelement.Summarized
thediagonalelementswhilecomplyingwithspecificconstraints
as ùíäùíÖùíîùëñ ‚àº ùúåùëñ(ùíÜùëñùëü),where ùíäùíÖùíîùëñ ‚àà Z1√óùëò referstotheindicesofthe
thatrequiretheelementstobenon-negative,andtherowsums
selectedcollaboratorsforintersectionùëñ,andùúårepresentstheCoS,
mustequal1:
whoseparametersaresharedamongallintersections.
With ùíäùíÖùíîùëñ and ùíÜùëñùëü, we obtain theùëò collaborators‚Äô representa-
ùëÅ ùëÅ
tions:ùíÜùë°ùëñ ùëíùëéùëö = lookup(ùíÜùëñùëü,ùíäùíÖùíîùëñ),wherelookupoperatorextracts max‚àëÔ∏Å ùëÄ ùëñùúå ùëñ ùë†.ùë°. ùëÄ ùëñùúå ùëó ‚â•0,‚àÄùëñ,ùëó; ‚àëÔ∏Å ùëÄ ùëñùúå ùëó =1,‚àÄùëñ. (13)
thevectoratindex ùíäùíÖùíîùëñ ‚àà Z1√óùëò frommatrix ùíÜùëñùëü ‚àà RùëÅ√óùëë,thus ùëñ=1 ùëó=1
ùíÜùë°ùëñ
ùëíùëéùëö
‚ààRùëò√óùëë.Afterthat,mean-poolingisusedtoobtainthefinal
Rule2:‚ÄúCollaborationshouldbemutualreciprocal‚Äù.Sym-
collaborationrepresentation. metry constraint is enforced. To encourage collaboration and
ùíÜ¬Øùë°ùëñ ùëíùëéùëö=mean-pooling(ùíÜùë°ùëñ ùëíùëéùëö), ùíÜ¬Øùë°ùëñ
ùëíùëéùëö
‚ààR1√óùëë. (9) mutualconsiderationbetweenintersections,weincorporateasym-
Forthedecisionpolicyùúãùëñ,itreceivestheintersection-levelrep- metryconstraintintothetraining.Thesymmetryconstraint,calcu-
latedasthemeansquareddifferencebetweenthematrixùëÄùúå and
resentationandcollaboratorrepresentationandoutputstheaction
ùëéùëñ fortheintersectionùëñ.
itstranspose[ùëÄùúå]ùëá,guidestheneuralnetworktolearnsymmetric
collaboratorselection.Mathematically,thesymmetryconstraintis
ùëéùëñ =ùúãùëñ(¬∑|[ùíÜùëñùëñ ùëü||ùíÜ¬Øùë°ùëñ ùëíùëéùëö]). (10)
formulatedasfollows.
Wehaveintroducedtheinferenceprocessofthemainmodules.
Next,weproposeanend-to-endjointoptimizationschemetoobtain min 1 ‚àëÔ∏ÅùëÅ ‚àëÔ∏ÅùëÅ (ùëÄùúå ‚àí[ùëÄùúå ]T )2 . (14)
theoptimalCoSùúåanddecisionpolicyùúã.
ùëÅ2
ùëñ=1 ùëó=1
ùëñùëó ùëñùëó
In summary, we can define the loss function for optimizing
4.2 OptimizationScheme
theCoSpolicy:
4.2.1 OverallOptimizationObjective. TheoverallobjectiveùúÇisto
maximizethecumulativereturn,formulatedasfollows. L(ùúåùúë)=‚àíJ(ùúë,ùúÉ)‚àí‚àëÔ∏ÅùëÅ ùëÄ ùëñùúå ùëñ+ ùëÅ1
2
‚àëÔ∏ÅùëÅ ‚àëÔ∏ÅùëÅ (ùëÄ ùëñùúå
ùëó
‚àí[ùëÄ ùëñùúå ùëó]T )2 . (15)
(cid:34)‚àû (cid:35) ùëñ=1 ùëñ=1 ùëó=1
m ùúëa ,ùúÉxJ(ùúë,ùúÉ)=m ùúëa ,ùúÉxE
ùíäùíÖùíî‚àºùùÜùúë
‚àëÔ∏Å ùõæùë°ùëü(ùë†ùë°,ùíÇùíï) , (11)
Followingthemulti-agentpolicygradientoptimization[8,54],
ùíÇ‚àºùùÖùúÉ(¬∑|ùë†,ùíäùíÖùíî) ùë°=0
wecanderivethegradientforùúå :
ùúë
whereùùÜ = {ùúå1,...,ùúåùëÅ}andùùÖ = {ùúã1,...,ùúãùëÅ}arejointCoSpolicy
anddecisionpolicy,parameterizedby{ùúë1,...,ùúëùëÅ}and{ùúÉ1,...,ùúÉùëÅ}, ‚àáùúëùëñJ(ùúë,ùúÉ)=‚à´ ùëÜùëùùúãùëéùëôùëô (ùë†)(cid:205) ùíäùíÖùíîùúåùúë(ùíäùíÖùíî|ùë†)¬∑
res Ape cc ct oi rv de il ny g.
toBellmanEquation[3,32],theQ-functionprovides
(cid:104) ‚àáùúë(cid:205) ùëñlogùúå ùúëùëñ ùëñ(ùíäùíÖùíîùëñ|ùë†)¬∑(cid:205) ùíÇùúã(ùíÇ|ùë†,ùíäùíÖùíî)(cid:105) ¬∑ùëÑ ùúãùëñ(ùëúùëñ,ùëéùëñ)ùëëùë† . (16)
anestimatetoguidetheagenttowardtheoptimalpolicythatmaxi- ‚àí N1‚àáùúëùë¥ùúå+ N2 (cid:16) ùë¥ùúå ‚àí[ùë¥ùúå]T(cid:17) ‚àáùúëùë¥ùúå
mizescumulativerewards.Thus,theobjectivecanbewritten:
Thus,incorporatingtheseconstraintsintotheCoSpolicygra-
=J E(ùúë ùëùùúã,ùúÉ ùëéùëô) ùëô,= ùúãùëéE ùëôùëôùë†‚àº (cid:20) ùëñùëù (cid:206)ùëÅ =ùúã 1ùëé ùúåùëôùëô ùúëùëñ,( (ùíä ùíäùíÖ ùíÖùíî, ùíîùíÇ ùëñ) |‚àº ùëúùúã ùëñùëé )ùëô ùúãùëô ùúÉùëñ(cid:104) (ùúã ùëéùëé ùëñùëô |ùëô ùëú( ùëñùíä ,ùíÖ ùíäùíÖùíî, ùíîùíÇ ùëñ)|ùë† ùëÑ)ùëÑ ùúãùëñùúã (ùëé ùëúùëô ùëñùëô ,( ùëéùë† ùëñ, )ùíÇ (cid:21)) ,(cid:105) (12) d l pai rbe on o mrt a oo t tp o et r cim oco oiz m pa ept ri aoo tsn ii vte i eon dna eb cpl ie r sos iogt nh re -e mssp aio v kl e ii nc lyy g.ùúå aA mùúë s ot ao nr gl ee isa nur tn l et r,t sh t ehe ce to iopp noti slm i ,c ra y el scc uao ln tl-
-
whereùëùùúãùëéùëôùëô denotesthestationarydistributioninducedbypol- inginenhancedtrafficsignalcontrolandimprovedtrafficflow
efficiency.
icyùúãùëéùëôùëô,ùëÑùúãùëéùëôùëô isthejointaction-valuefunction,andùëÑùúãùëñ isthe
individualaction-valuefunction.Here,ùëÑùúãùëñ simplifiesthelearn- 4.2.3 OptimizingDecisionPolicy. AssumedwehaveùíäùíÖùíî ‚àºùùÜùë° to
ingprocessbyfocusingonlocalstate-actionpairsratherthanthe identifythemostappropriatecollaboratorsandthentooptimizethe
globalstate,effectivelymitigatingthescalabilityissueinlarge-scale multi-agentdecisionpolicyùùÖùë° asfollows.Forthedecisionpolicy,
environments. wecanderiveitsgradientwiththeEq.(12).
4.2.2 OptimizingCoSPolicy. TheCoSpolicyùùÜùë° aimstochoose ‚àáùúÉùëñJ(ùúë,ùúÉ)=‚à´ ùëÜùëùùúãùëéùëôùëô (ùë†)(cid:205) ùíäùíÖùíîùúå(ùíäùíÖùíî|ùë†)(cid:205) ùíÇùúã ùúÉ(ùíÇ|ùë†,ùíäùíÖùíî)¬∑
optimalcollaboratorsforintersections.Wefollowtworules:(a)
Intersectionsshouldprimarilyfocusontheirowndecisions.(b)
‚àáùúÉ(cid:205) ùëñlogùúã ùúÉùëñ ùëñ(ùëéùëñ|ùëúùëñ,ùíäùíÖùíîùëñ)¬∑ùëÑ ùúãùëñ(ùëúùëñ,ùëéùëñ)ùëëùë†
Theyshouldalsoaccountforandcollaboratewitheachother‚Äôs ‚âàE (ùë†,ùíÇ,ùíäùíÖùíî)‚àºD(cid:104) ‚àáùúÉ(cid:205) ùëñlogùúã ùúÉùëñ ùëñ(ùëéùëñ|ùëúùëñ,ùíäùíÖùíîùëñ)¬∑ùëÑ ùúãùëñ(ùëúùëñ,ùëéùëñ)(cid:105) (17)
d rue lc ei ssi io nns th.T eh cu os ll, at bw oo rak te oy rc so eln es ct tr ia oi nnt ps ra or ce ei sn s.troducedtoensurethese =E
(ùë†,ùíÇ,ùíäùíÖùíî)‚àºùê∑
(cid:34) (cid:205)
ùëñ
‚àáùúÉ ùúãùëñ ùëñùúã ùëñùúÉùëñ (ùëñ ùëé( ùëñùëé |ùëúùëñ ùëñ|ùëú ,ùíäùëñ ùíÖ,ùíä ùíîùíÖ ùëñùíî )ùëñ) ¬∑ùëÑ ùúãùëñ(ùëúùëñ,ùëéùëñ)(cid:35) ,
Firstly,wecandenotethedistributionsofùùÜùë° forallintersections ùúÉ
asacollaboratormatrixùë¥ùúå ‚ààRùëÅ√óùëÅ,whereeachelementùëÄ ùëñùúå
ùëó
in whereùúã ùúÉùëñ
ùëñ
istheolddecisionpolicyusedforsampling.Conferenceacronym‚ÄôXX,June03‚Äì05,2018,Woodstock,NY TrovatoandTobin,etal.
Algorithm1Theoptimizationprocess. thederivedlossforbackpropagationtraining.Thedetailedprocess
ispresentedinAlgorithm1.
1: Ensure:Collaboratorassignmentpolicy{ùúåùëñ} ùëñùëÅ =1,collaborator-
Moreover,thenetworkdesignandhyper-parametersettingsare
basedmulti-agentactor{ùúãùëñ}ùëÅ ,andcritics{ùëÑùëñ}ùëÅ ;
ùëñ=1 ùëñ=1 providedinAppendixA.
Initialize:ùõæ,D ‚Üê ‚àÖ,ùêø1,ùêø2,ùêµ;//ùêø1,ùêø2areintervals;ùêµisthe
mini-batchsize. 6 EXPERIMENTS
2:
Initialize:theparametersùúÉùëñ,ùúëùëñ,ùúôùëñ forùúåùëñ,ùúãùëñ,andùëÑùëñ;
6.1 Environments
3: foreachepisodedo
4: Resetstate‚Üê{ùëúùëñ 0} ùëñùëÅ =1;//dropùëñasùíê0forbrevity; TheevaluationscenarioscomefromtheSimulationofUrbanMobil-
5: foreachtimestepùë° do ity(SUMO)1,whichcontainsthreesyntheticscenariosandtworeal
6: Obtainthedual-featuresùíÜùëñùëü; roadnetworkmapsofdifferentscales,includingGrid4√ó4,Avenue
7: foreachintersectionùëñdo 4√ó4,Grid5√ó5,Cologne8,andNanshan.Asforeachscenario,each
8: Getthecollaboratorindices ùíäùíÖùíîùëñ = ùúåùëñ(¬∑|ùíÜùëñùëü) foreach individualepisodelastsforatimespanof3600seconds,during
intersection; whichtheactionintervalisŒîùë° =15seconds.
9: Querythecollaboratorrepresentationùëí¬Ø ùë°ùëñ ùëíùëéùëö withùíÜùëñùëü
andùíäùíÖùíîùëñ; 6.2 Baselines
Gettheactionùëéùëñ =ùúãùëñ(¬∑|[ùëí ùëñùëñ ùëü||ùëí¬Ø ùë°ùëñ ùëíùëéùëö]); Weanalyzetheperformanceofourmethodbycomparingitwith
10: endfor twoconventionaltransportationtechniquesandsixstate-of-the-art
11: TakejointactionsùíÇùë°; (SOTA)RL/MARLalgorithms.
12: Receiverewardùíìùë° andobservethenextstateoùë°+1; ConventionalMethods:
13: Addtransition{ùíêùë°,ùíäùíÖùíîùë°,ùíÇùë°,ùíìùë°,ùíêùë°+1}intoD;
‚Ä¢ FixedTimeControl(FTC)[26]withrandomoffsetexe-
14: endfor
cuteseachphasewithinaloop,utilizingapre-definedphase
15: ifepisodes‚â•ùêø1then
duration.
16: Samplebatch{ùíêùëó,ùíäùíÖùíîùëó,ùíÇùëó,ùíìùëó,ùíêùëó+1}ùêµ ùëó=0‚àºD;
‚Ä¢ MaxPressure[14,36]greedilychoosesthephasewiththe
17: UpdatetheCoSpolicyùúåùëñ using(16); maximumpressure,whichisaSOTAtransportationcontrol
18: Updatethedecisionpolicyùúãùëñ using(17); method.
19: Updatethecriticùúôùëñ using(18);
RL-basedMethods:
20: endif
Updatingthetargetnetworkseveryùêø2episodes; ‚Ä¢ IPPO[1,2]controlseachintersectionwithanindependent
PPOagent,whichistrainedwiththedatafromthecurrent
21: endfor
intersection.
‚Ä¢ MAPPO[30,50]executeswithanindependentPPOagent
andistrainedcollectivelyusingthedatafromallintersec-
Thecriticisupdatedtominimizethedifferencebetweenthe
tions,enablinganoptimizedcoordinatedtrafficflow.
predictedandactualreturns,whichresemblestheaction-valueTD-
‚Ä¢ MAT[46]isastrongbaselineinMARLwithcentralized
learning[31].ThelossfunctionforùëÑùúãùëñ isformulatedasfollows.
trainingwithcentralizedexecutionparadigm,modelingthe
L ùëÑùúãùëñ(ùúô)=E
(ùëúùëñ,ùëéùëñ,ùëüùëñ,ùëúùëñ‚Ä≤)‚àºD(cid:20)(cid:16)
ùë¶ùëñ ‚àíùëÑùúãùëñ
(ùëúùëñ,ùëéùëñ;ùúô)(cid:17)2(cid:21)
, (18) ‚Ä¢
T FRSC Aa Ps [a 57s ]eq mu oe dn eti la sl pp hr ao sb ele cm om.
petitionandemploysdeepQ-
networkagentforeachintersectiontooptimizetrafficphase
whereùë¶ùëñ =ùëüùëñ +ùõæmax ùëéùëñ‚Ä≤ùëÑ (cid:101)ùúãùëñ (ùëúùëñ‚Ä≤,ùëéùëñ‚Ä≤)isthelearningtarget,ùõæ isthe operation.
discountedfactor,andùëÑ (cid:101)ùúãùëñ isthetargetnetworkforintersectionùëñ. ‚Ä¢ MPLight[6]utilizestheconceptofpressureasbothstate
ThejointoptimizationschemeensurestheCoSpolicyandthe andrewardtocoordinatemultipleintersections,whichis
collaborator-baseddecisionpolicyconvergeinthesamedirection basedonFRAP.
byoptimizingthesameobjectivefunction,whichistomaximize ‚Ä¢ CoLight[43]leveragesaGATtoextractneighboringin-
thecumulativediscountedreturninanend-to-endmanner.The formation,therebyassistingtheagentinoptimizingqueue
proposedmethodfacilitateseffectivedecision-makingandcollab- length.
orationamongintersections,allowingthetwopoliciestowork ‚Ä¢ Advanced-CoLight[56]combinesadvancedtrafficstate
togetherharmoniouslytowardachievingtheoverallgoal. forthetrafficmovementrepresentationwithapressureof
queuinganddemandofrunningforvehicleswithCoLight,
5 ALGORITHMICFRAMEWORK toenhancethedecision-makingprocess.
Hereweprovideadetailedpseudocodetoelaboratetheoverall ‚Ä¢ MetaGAT[19]leveragesGAT-basedcontexttoboostcoop-
erationamongintersections.
inferenceandtrainingprocess.Intheinferenceprocess,wefirst
select suitable teammate IDs ùíäùíÖùíîùëñ for each intersectionùëñ based ‚Ä¢ DuaLight[20]introducesascenario-specificexperiential
onitsobservationsùëúùëñ.Thenwecalculatetheteammatevectors weightmoduleandascenario-sharedco-trainmoduleto
ùëí¬Øùëñ according to the teammate IDs and concatenate them to facilitatetheinformationextractionofscenariosandinter-
ùë°ùëíùëéùëö sections.
theselfvectorùëíùëñ toobtaintheactionfordecisionmaking,and
ùëñùëü
finallyinteractwiththeSUMOenvironment.Intraining,weuse 1https://www.eclipse.org/sumo/CoSLight:Co-optimizingCollaboratorSelectionandDecision-makingtoEnhanceTrafficSignalControl Conferenceacronym‚ÄôXX,June03‚Äì05,2018,Woodstock,NY
AverageTripTime(seconds) AverageDelayTime(seconds)
Methods
Grid4√ó4 Avenue4√ó4 Grid5√ó5 Cologne8 Nanshan Grid4√ó4 Avenue4√ó4 Grid5√ó5 Cologne8 Nanshan
FTC 206.68¬±0.54 828.38¬±8.17 550.38¬±8.31 124.4¬±1.99 729.02¬±37.03 94.64¬±0.43 1234.30¬±6.50 790.18¬±7.96 62.38¬±2.95 561.69¬±37.09
MaxPressure 175.97¬±0.70 686.12¬±9.57 274.15¬±15.23 95.96¬±1.11 720.89¬±29.94 64.01¬±0.71 952.53¬±12.48 240.00¬±18.43 31.93¬±1.07 553.94¬±32.61
IPPO 167.62¬±2.42 431.31¬±28.55 259.28¬±9.55 90.87¬±0.40 743.69¬±38.9 56.38¬±1.46 914.58¬±36.90 243.58¬±9.29 26.82¬±0.43 577.99¬±42.22
MAPPO 164.96¬±1.87 565.67¬±44.8 300.90¬±8.31 97.68¬±2.03 744.47¬±30.07 53.65¬±1.00 1185.2¬±167.48 346.78¬±28.25 33.37¬±1.97 580.49¬±33.6
MAT 246.13¬±24.23 421.85¬±73.13 356.81¬±11.05 111.59¬±18.82 754.28¬±58.70 106.70¬±14.07 565.42¬±91.35 217.93¬±40.64 25.23¬±8.69 415.84¬±75.59
FRAP 161.58¬±1.9 383.71¬±4.42 238.41¬±10.66 88.61¬±0.33 709.18¬±21.46 50.02¬±0.93 794.13¬±42.52 203.95¬±8.92 27.5¬±0.24 542.43¬±21.51
MPLight 179.51¬±0.95 541.29¬±45.24 261.76¬±6.60 98.44¬±0.62 668.81¬±7.92 67.52¬±0.97 1083.18¬±63.38 213.78¬±14.44 34.38¬±0.63 494.05¬±7.52
CoLight 163.52¬±0.00 409.93¬±0.00 242.37¬±0.00 89.72¬±0.00 608.01¬±0.00 51.58¬±0.00 776.61¬±0.00 248.32¬±0.00 25.56¬±0.00 428.95¬±0.00
Advanced-CoLight 171.63¬±1.71 421.44¬±5.61 237.67¬±3.02 91.22¬±1.01 612.34¬±9.79 52.31¬±0.01 763.78¬±14.01 242.50¬±5.06 25.12¬±1.08 512.45¬±6.98
MetaGAT 165.23¬±0.00 374.80¬±0.87 266.60¬±0.00 90.74¬±0.00 676.42¬±0.00 53.20¬±0.00 772.36¬±0.00 234.80¬±0.00 26.85¬±0.00 503.42¬±0.00
DuaLight 161.0¬±0.00 396.65¬±0.00 221.83¬±0.00 89.74¬±0.00 609.89¬±0.00 49.32¬±0.00 756.99¬±69.44 237.71¬±0.00 25.35¬±0.00 429.49¬±0.00
CoSLight 159.1¬±3.12 364.21¬±4.78 220.32¬±1.71 90.46¬±0.55 621.23¬±7.17 46.11¬±1.21 744.98¬±16.49 178.54¬±4.34 24.79¬±1.23 476.57¬±17.12
Table1:Scenario-wiseevaluation.Ourmethodachieveseitherthebest(boldface)orthesecond-best(underlined)performance.
AverageRewards Intersection-wiseevaluation. Table2showsCoSLightachieves
Methods
Grid4√ó4 Avenue4√ó4 Grid5√ó5 Cologne8 Nanshan thebestresultsinallscenarios.Comparedtothesecond-bestresult,
FTC -0.614¬±0.015 -4.503¬±0.025 -2.346¬±0.052 -2.114¬±0.021 -3.479¬±0.186 oursachieveda7.71%improvementonaverage.Thisconsistentper-
MaxPressure -0.393¬±0.003 -4.032¬±0.040 -1.132¬±0.013 -0.756¬±0.012 -3.055¬±0.162 formanceenhancementacrossintersection-wiseevaluationmetrics
IPPO -0.336¬±0.004 -2.558¬±0.213 -0.943¬±0.037 -0.646¬±0.015 -3.555¬±0.097 underlinestherobustnessofourproposedmethod.
MAPPO -0.308¬±0.006 -2.744¬±0.238 -1.273¬±0.107 -1.697¬±0.132 -4.161¬±0.195 Notably, these findings provide strong evidence that our al-
MAT -0.328¬±0.001 -3.100¬±0.279 -1.109¬±0.132 -1.811¬±0.117 -5.002¬±0.755 gorithm performs well not only in terms of global cooperation
FRAP -0.274¬±0.000 -2.573¬±0.012 -1.064¬±0.002 -0.705¬±0.020 -3.191¬±0.170 (scenario-wiseevaluation)butalsofromtheperspectiveofbene-
MPLight -0.414¬±0.012 -4.079¬±0.049 -1.087¬±0.041 -0.842¬±0.026 -3.117¬±0.116 fitsatindividualintersections(intersection-wiseevaluation).This
CoLight -0.309¬±0.006 -2.326¬±0.057 -0.918¬±0.042 -0.695¬±0.008 -2.939¬±0.092 dual-levelefficacyshowcasestheeffectivenessofourapproach,sig-
Advanced-CoLight -0.291¬±0.011 -2.317¬±0.018 -1.112¬±0.018 -0.607¬±0.001 -2.904¬±0.016 nifyingitsabilitytofosteroverallroadnetworkperformancewhile
MetaGAT -0.468¬±0.126 -2.538¬±0.077 -1.326¬±0.311 -0.805¬±0.168 -3.289¬±0.261 simultaneouslyoptimizingindividualintersectionoperations.
DuaLight -0.331¬±0.112 -2.711¬±0.005 -1.007¬±0.622 -0.724¬±0.338 -4.330¬±0.306
CoSLight -0.251¬±0.000 -2.309¬±0.068 -0.890¬±0.012 -0.538¬±0.007 -2.899¬±0.014 6.5 AblationAnalysisofThreeSettings
Table2:Intersection-wiseevaluation.Ourmethodconstantly
achievesthebestperformance.
6.3 EvaluationMetrics
Weutilizetwoevaluationmetricsinourstudy.Firstly,atthesce-
nariolevel[2],wecomputetheaveragedelay,andaveragetriptime
bytrackingvehiclesinthescenario.Specifically,delaysignifiesthe
(a) Ablating FRAP, Transformer, (b) Comparing collaborator (c) Ablating diagonal, symmetry,
holdupcausedbysignalizedintersections(eitherstoporapproach Teammate CoS; Replacing CoS, Dual matrix design (ours v.s. fixed or and both constraints in
Extractor with GNNs in Grid ùüì√óùüì random matrices) in Nanshan collaborator matrix in Cologne8
delay)foravehicle,andtriptimedenotesthecompletedurationof
Figure4:AblationStudies
avehicle‚Äôsjourneyfromitsorigintoitsdestination.
Secondly,attheintersectionlevel,weemploytheexternalreward
AblationofComponents.Firstly,weselectivelyremovediffer-
oftheenvironmentasanevaluationcriterion,includingtheaverage
entmodules,specificallytheFRAP,Transformer,andCollaborator
delaytime,averagewaittime,averagequeuelength,andaverage
modules,tovalidatethenecessityofeachcomponentinCoSLight.
pressureforeachintersection.Thesemetricsarecalculatedateach
InFigure4(a),(1)itisevidentthattheTransformermodulethat
individualintersectionbyaveragingthevaluesacrossallvehicles.
aggregatesotherintersections‚ÄôinformationandtheTeammateCoS
modulethatadaptivelyselectscollaboratorsarethemostimpor-
6.4 MainResults
tant.(2)Moreover,tojustifytheMLPdesignforCoS,wereplaceit
Scenario-wiseevaluation. AsillustratedinTable1,theperfor- inCoSwithGNNs,wherewecouldobserveasignificantslowdown
mancesmarkedinboldfaceandunderlinedrepresentthebestand ofconvergenceandperformancedropinCoSwithGNN,dueto
second-bestresults,respectively.CoSLightconsistentlyachieves GNN‚Äôscomputationalcomplexityasthebottleneck.(3)Tojustify
substantialperformanceimprovements,reducingtheaveragedelay Transformerasabetterdesigntoaggregateotherintersections‚Äô
timeby7.68%,theaveragetriptimeby1.98%,whichnotonlyvali- information,wereplacedthetransformermoduleinthedualextrac-
datestheeffectivenessofCoSLightbutalsohighlightsitspotential torwithGNNs(DualwithGNN).Weseesimilarperformancedrops.
toefficientlymanageandenhancemulti-intersectioncollaboration Suchafeatureextractorencourageslearningbetterembeddingfor
invarioustrafficscenarios. eachagentandunderstandingthembetter,showninFigure5.Conferenceacronym‚ÄôXX,June03‚Äì05,2018,Woodstock,NY TrovatoandTobin,etal.
AblationoftheCollaboratorMatrix.Tofurtherassessthe 6.7 AnalysisofCollaboratorNumberùëò
impactoftheco-learnedcollaboratormatrix,weconductexperi-
mentswherethematrixintheproposedCoSisreplacedwithboth 2.0
1.0
fixed(astopologicaladjacencymatrix)andrandom(freezingthe 2.5
collaboratorselectionafterrandomlyinitializingtop-ùëòselection) 1.2
3.0
matrices.Figure4(b)showsthatusingco-learnedcollaboratorma- 1.4
3.5
tricesinCoScanboostperformance,highlightingthecriticalrole 1.6
4.0
ofthedynamicalcollaborationmatrixinachievingeffectivecoordi-
1.8
nation.Thus,thejointoptimizationofthecollaboratormatrixwith 2 4 6 8 10 12 14 16
The Number of Collaborators 2 4 6 8 1012141618202224
decisionpoliciesiskeyforoptimizingcumulativerewards. (a)Avenue4√ó4 The ( bN )um Gb re idr o 5f C √óoll 5aborators
AblationofConstraintsonCollaboratorMatrix.InFigure Figure6:Violinplotsdisplaytheperformancetrade-offsat
4(c),wefurtherevaluatethecontributionsoftheconstraintsin varyingnumbersofcollaborators.
Eq(13)and(14)byremovingtheDiagonalconstraint,theSym-
metryconstraint,orboth.RemovingtheSymmetryconstraintsig- Figure6showsthetrade-offbetweenthenumberofcollabora-
nificantlydegradesperformance,whichunderlinesthesymmetric torsandperformance.Forexample,inAvenue4√ó4(Figure6(a)),
interplaybetweeneachotherisessential.Conversely,theDiagonal ùëò =8yieldsthebestresults,suggestinganoptimalbalancebetween
constrainthasamarginalimpact,primarilyenhancingtheconver- usefulinformationandperformancegains.Informationfrommore
gencespeed.TheseinsightshighlightthevalueoftheSymmetry collaboratorsbeyondthispointdoesnotguaranteeimprovedresults
constraintforoptimalityandtheDiagonalconstraintforefficiency. andmayleadtohigherresourceusage.Thisfindingposesadirec-
Insummary,theablationsprovideempiricalevidencethateach tionforfutureworktodynamicallydeterminetheidealnumberof
dimensionofCoSisvital.Theco-learningofthecollaboratorma- collaborators,potentiallyenhancingthealgorithm‚Äôsefficiency.
trix,theadherencetospecificconstraints,andtheintegrationof
crucialcomponentssuchastheFRAP,Transformer,andCollabo- 6.8 VisualizationofCollaboratorMatrix
ratormodulesallcontributetotherobustnessandeffectivenessof
At the beginning At the convergence At the beginning At the convergence
thesystem.Throughvalidation,wedemonstratethatourmodel
leadstoenhancedperformanceincomplexenvironments.
6.6 VisualizationAnalysisofDual-feature
Avenue ùüí√óùüí Cologne8
Figure7:Saliencymapsofcollaboratormatrix.Thedeeper
thecolor,thestrongerthecorrelation.CoSLighthaslearned
diagonalmaximizationandsymmetryconstraints.
Inthissection,wevisuallyanalyzethecollaboratormatrixto
offeranintuitiveunderstandingofattentiondistributionamong
(a)Avenue4√ó4 (b)Nanshan
intersectionsduringtraining.Theresultsareshownatthestart
Figure5:VisualizationofDual-feature.Eachcolorrepresents andendoftrainingintheCologne8(8intersections)andAvenue4
aspecificintersection.CoSLighthascaptureduniquefeatures √ó4(16intersections)scenarios,respectively.Thesaliencymapsin
ateachintersectionwithdistinctclusteringpatterns. Figure7depictthestateofthecollaboratormatrixatthebeginning
andtheendofthetraining,respectively.
Weanalyzethedual-featureembeddingsfromourDual-Feature Upontheconclusionofthetraining,wenoticeadeepeningofthe
Extractor.AsshowninFigure5,wetest10episodesforeachinter- coloralongthediagonalelementsofthesaliencymap.Thissignifies
sectionineachscenario,resultingin2400dual-featureembeddings anincreasedself-attention,indicatingthattheintersectionshave
visualizedusingthet-SNEtechnique[34]. adaptedtopaymoreheedtotheirownstates.Additionally,the
Theseembeddingsdemonstrateadistinctclusteringpattern,sug- symmetryapparentinthesaliencymapsuggestsmutualawareness
gestingthatourmodelcapturesuniquefeaturesateachintersection amongintersections.Asthetrainingprogresses,intersectionsnot
effectively.Thisallowsthemodeltogroupsimilarstatestogether, onlylearntofocusonthemselvesbutalsopayattentiontotheir
adaptingtovariationsintrafficconditionsandintersection-level peers,signifyingalearnedmutualcollaboration.
characteristics.Thisadaptabilityisacrucialadvantageofourap- Theseobservationsvalidatetheeffectivenessofourapproach
proach,contributingsignificantlytoitsperformanceimprovement. increatingacollaborativeenvironmentamongintersections,thus
Moreresultsofallfivescenariosundertheabovesettingsarein leadingtoenhancedperformance.
AppendixE-J.Inconclusion,throughrigorousexperimentsand
6.9 VisualizationofCollaboratorSelection
insightfulanalysis,ourstudyconfirmsthatourmethod,whichinte-
gratesdual-featureextractionandmulti-intersectioncollaboration, Figure8depictsthecollaboratorselectionprocess.Forùêæ = 1in
providesaneffectiveandefficientsolutionfortheTSC. Figure8(b),self-selectionisprevalent;however,agent0displays
sdraweR
edosipE
egarevACoSLight:Co-optimizingCollaboratorSelectionandDecision-makingtoEnhanceTrafficSignalControl Conferenceacronym‚ÄôXX,June03‚Äì05,2018,Woodstock,NY
CoS Decisionpolicy CoSTraining DecisionTraining TotalTime
Grid4x4 0.153¬±0.008 0.143¬±0.008 1.522¬±0.112 2.940¬±0.163 4.758¬±0.179
Avenue4x4 0.161¬±0.006 0.152¬±0.006 1.423¬±0.176 3.050¬±0.203 4.785¬±0.276
Grid5x5 0.168¬±0.011 0.153¬±0.011 2.531¬±0.093 6.148¬±0.123 9.000¬±0.123
agent 0 agent 4 agent 7
Cologne8 0.111¬±0.007 0.105¬±0.007 2.001¬±0.096 2.336¬±0.192 4.553¬±0.186
Nanshan 0.190¬±0.008 0.181¬±0.008 1.321¬±0.124 4.130¬±0.511 5.822¬±0.507
(a) The topological layout of Cologne 8, emphasizes
8 signaled intersections and 3 detailed intersections. Avg(Percent) 0.156(2.83%) 0.147(2.66%) 1.760(31.29%) 3.721(63.21%) 5.778
Table3:Averageinferenceandtrainingtime(s).
collaboration.Moreover,wearethefirsttoproposeajointoptimiza-
tionregimetotraintheCoSanddecisionpoliciessimultaneously
formaximizingthecumulativediscountedreturn.Comprehensive
experimentsonbothsyntheticandreal-worlddatasetsvalidateour
approach‚Äôssuperiority.Theextensiveanalysisfurtherreinforces
theeffectivenessandefficacyofCoSLight.
(b) K=1 (c) K=3
Futureresearchcouldpotentiallyexploreanadaptivemecha-
Figure8:CollaboratorselectiononCologne8,showingself- nismtoefficientlydeterminetheoptimalnumberofcollaborators,
selectionandefficientcross-collaborationat(b)K=1with thereby enhancing the performance and effectiveness of traffic
predominantlysolodynamics,and(c)K=3withinter-agent signalcontrol.
collaborationwithnotjustthetopologicalselection.
variedcollaborationpatterns,likelyduetotheintricacyofitssignal
controltasks(refertoFigure8(a)),whichrequireengagingwith
multiplecollaboratorsforoptimaltrafficmanagement.Whenùêæ
increasesto3,asshowninFigure8(c),agentsexhibitbothself-
selectionandmutualcollaboration,formingcomplexinteraction
networks.Forexample,agent3largelycollaborateswithagents
2(non-neighbor)and4(neighbor);Similarly,agent4withagents
3(neighbor)and6(neighbor);Also,agent2withagents6(non-
neighbor)and7(non-neighbor).Specifically,agent2isquitefar
from6and7,buttheyformastrongcollaborationsinceagent2
isintheofficebuildingandagents6and7areinthecommunity
residentialregion.
Overall,suchlearnedpatternssuggeststrategicselectionbeyond
topologicalneighbors.Collectively,theseresultsaffirmthatthecol-
laboratorselectionmechanismisadaptivelyresponsivetoboththe
complexityoftraffictasksandthebenefitsofstrategiccollaboration
tooptimizetrafficflow.
6.10 AverageInferenceandTrainingTime
Wecollected100episodesover100trainingepochstoobtaintheav-
erageinferencetimeforCoSandDecisionpoliciesperepisodeand
averagetrainingtimeperepoch.Weexperimentedon4NVIDIA
TITANXpGPUs(12G).InTable3,acrossfivescenarios,CoSin-
ferenceandtrainingtimesaverage2.83%and31.29%,respectively,
whileDecisionpolicyaverages2.66%forinferenceand63.21%for
training.TheCoSstrategyaddsa34.42%timeoverhead,justifiable
byitsperformancebenefits.
7 CONCLUSION
Inthispaper,weintroduceaninnovativeapproachtotrafficsig-
nalcontrol,employingatop-ùëòcollaboratorselectionpolicywitha
dual-featureextractor.Thisuniquestrategyallowsfortheeffective
extractionofphase-andintersection-levelrepresentationswhile
adaptivelyselectingcollaboratorsforenhancedmulti-intersectionConferenceacronym‚ÄôXX,June03‚Äì05,2018,Woodstock,NY TrovatoandTobin,etal.
REFERENCES
[28] Ruan,J.,Hao,X.,Li,D.,andMao,H. Learningtocollaboratebygrouping:
[1] Ault,J.,Hanna,J.P.,andSharon,G.Learninganinterpretabletrafficsignal aconsensus-orientedstrategyformulti-agentreinforcementlearning. arXiv
controlpolicy.arXivpreprintarXiv:1912.11023(2019). preprintarXiv:2307.15530(2023).
[2] Ault,J.,andSharon,G.Reinforcementlearningbenchmarksfortrafficsignal [29] Ruan,J.,Xie,R.,Xiong,X.,Xu,S.,andXu,B. Made:Multi-scaledecision
control. InThirty-fifthConferenceonNeuralInformationProcessingSystems enhancementformulti-agentreinforcementlearning.InICASSP2024-2024IEEE
DatasetsandBenchmarksTrack(Round1)(2021). InternationalConferenceonAcoustics,SpeechandSignalProcessing(ICASSP)(2024),
[3] Bellman,R.Dynamicprogramming.Science153,3731(1966),34‚Äì37. IEEE,pp.31‚Äì35.
[4] B√∂hmer,W.,Kurin,V.,andWhiteson,S.Deepcoordinationgraphs.InInter- [30] Schulman,J.,Wolski,F.,Dhariwal,P.,Radford,A.,andKlimov,O.Proximal
nationalConferenceonMachineLearning(2020),PMLR,pp.980‚Äì991. policyoptimizationalgorithms.arXivpreprintarXiv:1707.06347(2017).
[5] Boutilier,C.Planning,learningandcoordinationinmultiagentdecisionpro- [31] Sutton,R.S.Learningtopredictbythemethodsoftemporaldifferences.Machine
cesses.InTARK(1996),vol.96,pp.195‚Äì210. learning3(1988),9‚Äì44.
[6] Chen,C.,Wei,H.,Xu,N.,Zheng,G.,Yang,M.,Xiong,Y.,Xu,K.,andLi,Z. [32] Sutton,R.S.,andBarto,A.G.Introductiontoreinforcementlearning.1998.
Towardathousandlights:Decentralizeddeepreinforcementlearningforlarge- [33] Tolstikhin, I. O., Houlsby, N., Kolesnikov, A., Beyer, L., Zhai, X., Un-
scaletrafficsignalcontrol. InProceedingsoftheAAAIConferenceonArtificial terthiner,T.,Yung,J.,Steiner,A.,Keysers,D.,Uszkoreit,J.,Lucic,M.,
Intelligence(2020),vol.34,pp.3414‚Äì3421. andDosovitskiy,A.Mlp-mixer:Anall-mlparchitectureforvision.InAdvances
[7] Devailly,F.-X.,Larocqe,D.,andCharlin,L. Ig-rl:Inductivegraphrein- inNeuralInformationProcessingSystems(2021),pp.24261‚Äì24272.
forcementlearningformassive-scaletrafficsignalcontrol.IEEETransactionson [34] VanderMaaten,L.,andHinton,G.Visualizingdatausingt-sne.Journalof
IntelligentTransportationSystems23,7(2022),7496‚Äì7507. machinelearningresearch9,11(2008).
[8] Foerster,J.,Farqhar,G.,Afouras,T.,Nardelli,N.,andWhiteson,S.Coun- [35] VanderPol,E.,andOliehoek,F.A.Coordinateddeepreinforcementlearners
terfactualmulti-agentpolicygradients.InProceedingsoftheAAAIconferenceon fortrafficlightcontrol.Proceedingsoflearning,inferenceandcontrolofmulti-agent
artificialintelligence(2018),vol.32. systems(atNIPS2016)8(2016),21‚Äì38.
[9] Han,X.,Zhao,T.,Liu,Y.,Hu,X.,andShah,N.MLPInit:Embarrassinglysimple [36] Varaiya,P. Themax-pressurecontrollerforarbitrarynetworksofsignalized
GNNtrainingaccelerationwithMLPinitialization.InTheEleventhInternational intersections.Advancesindynamicnetworkmodelingincomplextransportation
ConferenceonLearningRepresentations(2023). systems(2013),27‚Äì66.
[10] Hao,Q.,Huang,W.,Feng,T.,Yuan,J.,andLi,Y.Gat-mf:Graphattentionmean [37] Vaswani,A.,Shazeer,N.,Parmar,N.,Uszkoreit,J.,Jones,L.,Gomez,A.N.,
fieldforverylargescalemulti-agentreinforcementlearning.InProceedingsofthe Kaiser,≈Å.,andPolosukhin,I.Attentionisallyouneed.InAdvancesinNeural
29thACMSIGKDDConferenceonKnowledgeDiscoveryandDataMining(2023), InformationProcessingSystems(2017),pp.5998‚Äì6008.
pp.685‚Äì697. [38] Wang,T.,Cao,J.,andHussain,A. Adaptivetrafficsignalcontrolforlarge-
[11] Jiang,H.,Li,Z.,Li,Z.,Bai,L.,Mao,H.,Ketter,W.,andZhao,R. Agen- scalescenariowithcooperativegroup-basedmulti-agentreinforcementlearning.
eralscenario-agnosticreinforcementlearningfortrafficsignalcontrol. IEEE TransportationresearchpartC:emergingtechnologies125(2021),103046.
TransactionsonIntelligentTransportationSystems(2024). [39] Wang,T.,Dong,H.,Lesser,V.,andZhang,C.Roma:Multi-agentreinforcement
[12] Jiang,J.,Dun,C.,Huang,T.,andLu,Z. Graphconvolutionalreinforcement learningwithemergentroles.arXivpreprintarXiv:2003.08039(2020).
learning.arXivpreprintarXiv:1810.09202(2018). [40] Wang,T.,Gupta,T.,Mahajan,A.,Peng,B.,Whiteson,S.,andZhang,C.Rode:
[13] Jiang,Q.,Li,J.,Sun,W.,andZheng,B.Dynamiclanetrafficsignalcontrolwith Learningrolestodecomposemulti-agenttasks.arXivpreprintarXiv:2010.01523
groupattentionandmulti-timescalereinforcementlearning.IJCAI. (2020).
[14] Kouvelas,A.,Lioris,J.,Fayazi,S.A.,andVaraiya,P. Maximumpressure [41] Wang,X.,Gu,P.,Wang,P.,Wang,B.,Zhou,Z.,Bai,L.,andWang,Y.Graph-free
controllerforstabilizingqueuesinsignalizedarterialnetworks.Transportation learningingraph-structureddata:Amoreefficientandaccuratespatiotemporal
ResearchRecord2421,1(2014),133‚Äì141. learningperspective.arXivpreprintarXiv:2301.11742(2023).
[15] Kuyer,L.,Whiteson,S.,Bakker,B.,andVlassis,N.Multiagentreinforcement [42] Wei,H.,Chen,C.,Zheng,G.,Wu,K.,Gayah,V.,Xu,K.,andLi,Z.Presslight:
learningforurbantrafficcontrolusingcoordinationgraphs.InMachineLearning Learningmaxpressurecontroltocoordinatetrafficsignalsinarterialnetwork.
andKnowledgeDiscoveryinDatabases:EuropeanConference,ECMLPKDD(2008), InProceedingsofthe25thACMSIGKDDinternationalconferenceonknowledge
pp.656‚Äì671. discovery&datamining(2019),pp.1290‚Äì1298.
[16] Labres,J.V.,Bazzan,A.L.,andAbdoos,M.Improvingtrafficsignalcontrol [43] Wei,H.,Xu,N.,Zhang,H.,Zheng,G.,Zang,X.,Chen,C.,Zhang,W.,Zhu,Y.,
withjoint-actionreinforcementlearning. In2021IEEESymposiumSerieson Xu,K.,andLi,Z.Colight:Learningnetwork-levelcooperationfortrafficsignal
ComputationalIntelligence(SSCI)(2021),pp.01‚Äì08. control.InProceedingsofthe28thACMInternationalConferenceonInformation
[17] Liang,E.,Su,Z.,Fang,C.,andZhong,R.Oam:Anoption-actionreinforcement andKnowledgeManagement(2019),pp.1913‚Äì1922.
learningframeworkforuniversalmulti-intersectioncontrol.InProceedingsof [44] Wei,H.,Zheng,G.,Gayah,V.,andLi,Z. Asurveyontrafficsignalcontrol
theAAAIConferenceonArtificialIntelligence(2022),vol.36,pp.4550‚Äì4558. methods.arXivpreprintarXiv:1904.08117(2019).
[18] Liu,Y.,Luo,G.,Yuan,Q.,Li,J.,Jin,L.,Chen,B.,andPan,R.Gplight:grouped [45] Wei,H.,Zheng,G.,Yao,H.,andLi,Z. Intellilight:Areinforcementlearning
multi-agentreinforcementlearningforlarge-scaletrafficsignalcontrol.InPro- approachforintelligenttrafficlightcontrol. InProceedingsofthe24thACM
ceedingsoftheThirty-SecondInternationalJointConferenceonArtificialIntelligence
SIGKDDInternationalConferenceonKnowledgeDiscovery&DataMining(2018),
(2023),pp.199‚Äì207. pp.2496‚Äì2505.
[19] Lou,Y.,Wu,J.,andRan,Y. Meta-reinforcementlearningformultipletraf- [46] Wen,M.,Kuba,J.,Lin,R.,Zhang,W.,Wen,Y.,Wang,J.,andYang,Y.Multi-
ficsignalscontrol. InProceedingsofthe31stACMInternationalConferenceon agentreinforcementlearningisasequencemodelingproblem. Advancesin
Information&KnowledgeManagement(2022),pp.4264‚Äì4268. NeuralInformationProcessingSystems35(2022),16509‚Äì16521.
[20] Lu,J.,Ruan,J.,Jiang,H.,Li,Z.,Mao,H.,andZhao,R.Dualight:Enhancingtraffic [47] Wu,L.,Wang,M.,Wu,D.,andWu,J. Dynstgat:Dynamicspatial-temporal
signalcontrolbyleveragingscenario-specificandscenario-sharedknowledge. graphattentionnetworkfortrafficsignalcontrol. InProceedingsofthe30th
arXivpreprintarXiv:2312.14532(2023). ACMInternationalConferenceonInformation&KnowledgeManagement(2021),
[21] Ma,J.,andWu,F.Feudalmulti-agentdeepreinforcementlearningfortraffic pp.2150‚Äì2159.
signalcontrol.InProceedingsofthe19thInternationalConferenceonAutonomous [48] Wu,Y.,Zhuang,D.,Labbe,A.,andSun,L.Inductivegraphneuralnetworks
AgentsandMultiagentSystems(AAMAS)(2020),pp.816‚Äì824. forspatiotemporalkriging.InProceedingsoftheAAAIConferenceonArtificial
[22] Mao,H.,Liu,W.,Hao,J.,Luo,J.,Li,D.,Zhang,Z.,Wang,J.,andXiao,Z.Neigh- Intelligence(2021),vol.35,pp.4478‚Äì4485.
borhoodcognitionconsistentmulti-agentreinforcementlearning.InProceedings [49] Ye,Y.,Zhao,W.,Wei,T.,Hu,S.,andChen,M.Fedlight:Federatedreinforcement
oftheAAAIconferenceonartificialintelligence(2020),vol.34,pp.7219‚Äì7226. learningforautonomousmulti-intersectiontrafficsignalcontrol.In202158th
[23] Mao,H.,Zhao,R.,Chen,H.,Hao,J.,Chen,Y.,Li,D.,Zhang,J.,andXiao,Z. ACM/IEEEDesignAutomationConference(DAC)(2021),IEEE,pp.847‚Äì852.
Transformerintransformerasbackbonefordeepreinforcementlearning.arXiv [50] Yu,C.,Velu,A.,Vinitsky,E.,Gao,J.,Wang,Y.,Bayen,A.,andWu,Y. The
preprintarXiv:2212.14538(2022). surprisingeffectivenessofppoincooperativemulti-agentgames.Advancesin
[24] Mao,H.,Zhao,R.,Li,Z.,Xu,Z.,Chen,H.,Chen,Y.,Zhang,B.,Xiao,Z.,Zhang, NeuralInformationProcessingSystems35(2022),24611‚Äì24624.
J.,andYin,J.Pdit:Interleavingperceptionanddecision-makingtransformers [51] Yu,Z.,Liang,S.,Wei,L.,Jin,Z.,Huang,J.,Cai,D.,He,X.,andHua,X.-S.
fordeepreinforcementlearning.arXivpreprintarXiv:2312.15863(2023). Macar:Urbantrafficlightcontrolviaactivemulti-agentcommunicationand
[25] Oroojlooy,A.,Nazari,M.,Hajinezhad,D.,andSilva,J.Attendlight:Universal actionrectification.InProceedingsoftheTwenty-NinthInternationalConference
attention-basedreinforcementlearningmodelfortrafficsignalcontrol.Advances onInternationalJointConferencesonArtificialIntelligence(2021),pp.2491‚Äì2497.
inNeuralInformationProcessingSystems33(2020),4079‚Äì4090. [52] Zhang,B.,Mao,H.,Li,L.,Xu,Z.,Li,D.,Zhao,R.,andFan,G.Stackelbergdeci-
[26] Roess,R.P.,Prassas,E.S.,andMcShane,W.R.Trafficengineering.2004. siontransformerforasynchronousactioncoordinationinmulti-agentsystems.
[27] Ruan,J.,Du,Y.,Xiong,X.,Xing,D.,Li,X.,Meng,L.,Zhang,H.,Wang,J.,and arXivpreprintarXiv:2305.07856(2023).
Xu,B.Gcs:Graph-basedcoordinationstrategyformulti-agentreinforcement [53] Zhang,H.,Liu,C.,Zhang,W.,Zheng,G.,andYu,Y.Generalight:Improving
learning.arXivpreprintarXiv:2201.06257(2022). environmentgeneralizationoftrafficsignalcontrolviametareinforcementlearn-
ing.InProceedingsofthe29thACMInternationalConferenceonInformation&CoSLight:Co-optimizingCollaboratorSelectionandDecision-makingtoEnhanceTrafficSignalControl Conferenceacronym‚ÄôXX,June03‚Äì05,2018,Woodstock,NY
KnowledgeManagement(2020),pp.1783‚Äì1792.
[54] Zhang,K.,Yang,Z.,Liu,H.,Zhang,T.,andBasar,T. Fullydecentralized
multi-agentreinforcementlearningwithnetworkedagents. InInternational
ConferenceonMachineLearning(2018),pp.5872‚Äì5881.
[55] Zhang,L.,Wu,Q.,andDeng,J.Attentionlight:Rethinkingqueuelengthand
attentionmechanismfortrafficsignalcontrol.arXivpreprintarXiv:2201.00006
(2021).
[56] Zhang,L.,Wu,Q.,Shen,J.,L√º,L.,Du,B.,andWu,J. Expressionmightbe
enough:representingpressureanddemandforreinforcementlearningbased
trafficsignalcontrol. InInternationalConferenceonMachineLearning(2022),
PMLR,pp.26645‚Äì26654.
[57] Zheng,G.,Xiong,Y.,Zang,X.,Feng,J.,Wei,H.,Zhang,H.,Li,Y.,Xu,K.,and
Li,Z.Learningphasecompetitionfortrafficsignalcontrol.InProceedingsofthe
28thACMinternationalconferenceoninformationandknowledgemanagement
(2019),pp.1963‚Äì1972.
[58] Zhong,L.,Yang,J.,Chen,Z.,andWang,S.Contrastivegraphconvolutionalnet-
workswithgenerativeadjacencymatrix.IEEETransactionsonSignalProcessing
71(2023),772‚Äì785.Conferenceacronym‚ÄôXX,June03‚Äì05,2018,Woodstock,NY TrovatoandTobin,etal.
Appendices
A DETAILEDNETWORKARCHITECTUREANDHYPER-PARAMETERSDESCRIPTIONS
Thereisasummaryofalltheneuralnetworksusedinourframeworkaboutthenetworkstructure,layers,andactivationfunctions.
NetworkStructure Layers HiddenSize ActivationFunctions
FRAP FRAP1 - - -
PositionalEmbedding 1 64 None
TransformerBackbone EncoderLayer 2 64 ReLu
OutputLayer(MLP)3 1 32 ReLu
Top-kCollaboratorAssignment MLP 2 64 ReLu
Actor MLP+RNN+MLP 3 [64]+[64]+[32] ReLu
Critic MLP 2 64 ReLu
TableA1:TheSummaryforNetworkArchitecture
Thereareourhyper-parametersettingsforthetraining,showninTableA2.
Bytheway,wereferreaderstothesourcecodeinthesupplementarytocheckthedetailedhyper-parameters.
B THEDETAILSABOUTFRAP
Atthephaselevel,weadoptFRAP[57]toobtainthephase-wiserepresentation.Therawobservationsùëú fromthesimulatorincludeùêæ
features,suchasthenumberofvehicles,queuelength,thecurrentphase,theflow,etc.Foranytrafficmovementùëö,ùëö ‚àà {1,...,8}inan
intersectionùëñ,theùëò-thfeatureintherawobservationcanbedenotedasùëúùëñ .Forbrevity,thesuperscriptùëñisomittedhereinafter.First,the
ùëö,ùëò
embeddingoftrafficmovementùëöisobtainedbyMulti-LayerPerceptron(MLP):
ùíÜùëö =|| ùëòùêæ =1ùëÜùëñùëîùëöùëúùëñùëë(ùëÄùêøùëÉ ùëò(ùëú ùëö,ùëò)), (19)
where||denotesconcatenation,andùëÜùëñùëîùëöùëúùëñùëë istheactivationfunction.ThenFRAPmoduleisappliedtoextractthephasecompetition
representation,denotedasfollows.
ùíÜùëùùëêùëü =ùêπùëÖùê¥ùëÉ(ùíÜùëö1,...,ùíÜùëö8). (20)
Theprocesscanbesummarizedasfollows.
(1) Phaseembedding:Eachphaseùëùconsistsoftwomovementsùëö1,ùëö2,andwegetthephaseembeddingùíÜùëù =ùíÜùëö1+ùíÜùëö2.
(2) Phasepairrepresentation:Foranypairùëù ùëò,ùëù
ùëô
fromdifferentphases,thepairwiserelationvectorisùíÜùëùùëò,ùëùùëô =ùíÜùëùùëò||ùíÜùëùùëô.Gatheringthe
vectorsofallphasepairscanobtainthepairdemandembeddingvolumeùë¨.Thenthephasepairrepresentationcanbedenotedas
ùíÜùëùùëùùëü =ùê∂ùëúùëõùë£1√ó1(ùë¨),whereùê∂ùëúùëõùë£1√ó1istheconvolutionallayerwith1√ó1filters.
(3) Phasecompetition:Letùë¥ bephasecompetitionmask,andthephasecompetitionrepresentationcanbeobtainedby:ùíÜùëùùëêùëü =
ùê∂ùëúùëõùë£1√ó1(ùíÜùëùùëùùëü ‚äóùë¥),where‚äóistheelement-wisemultiplication.Here,wereshapeùíÜùëùùëêùëü asavectorthroughflattenoperation.
Finally,anMLPisutilizedtominethephaserepresentationintheintersectionùëñasfollows.
ùíÜùëñ
ùëùùëü
=ùëÄùêøùëÉ(ùíÜùëùùëêùëü) (21)
C THEDETAILSABOUTEVALUATIONSETTINGS
InTableA3,wepresentdetailedstatisticsincludingthetotalnumberofintersections(#TotalInt.),alongwiththequantityof2-arm,3-arm,
and4-armintersectionsineachscenario.
Inreal-worldtrafficscenarios,manyintersectionsdon‚Äôtconformtoastandardfour-armstructure,potentiallyhavingvariedlanecounts
andorientations.Toensurethebroadapplicationofourmethodacrossdiversescenarios,weintentionallyconductedexperimentsintwo
settingsthatfeaturenon-standardintersections:Cologne8andNanshan.
Thesescenariosincorporatenotjustthetypicalfour-armintersectionsbutalsoirregularoneswherethenumberanddirectionoflanes
deviatefromthestandard.Byrunningexperimentsinsuchenvironments,wedemonstratethatourapproachiseffectivenotonlyinhandling
standardintersectionsbutalsoexcelsinmanagingtheseirregularities.Thisfurtherunderscorestherobustnessandpotentialwide-scale
applicabilityofourmethodology.
1Refertotheimplementation:https://github.com/Chacha-Chen/MPLightCoSLight:Co-optimizingCollaboratorSelectionandDecision-makingtoEnhanceTrafficSignalControl Conferenceacronym‚ÄôXX,June03‚Äì05,2018,Woodstock,NY
Description
textbfValue
optimizer ùê¥ùëëùëéùëöùëä
learningrate 5‚àó10‚àí4
groupembeddingsize 32
attentionhead 8
transformerlayer 2
actorembeddingsize 32
statekey [‚Ä≤ùëêùë¢ùëüùëüùëíùëõùë°_ùëù‚Ñéùëéùë†ùëí‚Ä≤,‚Ä≤ùëêùëéùëü_ùëõùë¢ùëö‚Ä≤,‚Ä≤ùëûùë¢ùëíùë¢ùëí_ùëôùëíùëõùëîùë°‚Ñé‚Ä≤,
‚Ä≤ùëúùëêùëêùë¢ùëùùëéùëõùëêùë¶‚Ä≤,‚Ä≤ùëìùëôùëúùë§‚Ä≤,‚Ä≤ùë†ùë°ùëúùëù_ùëêùëéùëü_ùëõùë¢ùëö‚Ä≤,‚Ä≤ùëùùëüùëíùë†ùë†ùë¢ùëüùëí‚Ä≤]
numberofactions 8
interactionsteps 300000
ùõº 10‚àí4
ùõΩ1 0.9
ùõΩ2 0.999
ùúÄ-greedyùúÄ 10‚àí5
clippingùúñ 0.2
seed [0,10)
numberofprocess 64
evalinterval 4000
evalepisodes 100
TableA2:Thehyper-parametersettings.
Dataset Country #TotalInt. #2-arm #3-arm #4-arm FlowType minFlow(/hour) maxFlow meanFlow
Grid4√ó4 synthetic 16 0 0 16 multi-modalGaussian(m.m.G) 66 136 94.5
Avenue4√ó4 synthetic 16 0 0 16 m.m.G 94.5 666 364.6
Grid5√ó5 synthetic 25 0 0 25 m.m.G 120 1363 269.8
Cologne8 Germany 8 1 3 4 realflowinthemorningpeak(8AM-9AM) 134 212 139.0
Nanshan China 29 1 6 22 realflowintheeveningpeak(6PM-7PM) 160 1440 172.6
TableA3:Thedetailedstatisticsaboutevaluationscenarios
D ADDITIONALRESULTSOFHOPS
AsshowninFigureA1,wefurtherconductedexperimentsonGrid4√ó4andGrid5√ó5tosubstantiateourassertion:theoptimalnumberand
rangeofcollaboratingintersectionsvaryacrossdifferentscenarios.Forinstance,inGrid4√ó4,theimpactofcollaborationremainslargely
consistentregardlessofincreasingdistances,suggestingthatthebenefitsofcollaborationmightbedistance-independentinthissetting.
Alternatively,itcouldindicatethatmerelyselectingtopologicallyadjacentintersectionsmightnotenhancethecollaborativeoutcomes.In
contrast,Grid5√ó5displaysanegativeimpactwithone-hopcollaboration,whereastwo-hopcollaborationproducesthegreatestbenefits.
Thisunderscoresthesignificanceofpreciselyandjudiciouslyselectingcollaborators,highlightingthatnotjustthepresence,butthequality
andcontextofcollaborationmatters.Conferenceacronym‚ÄôXX,June03‚Äì05,2018,Woodstock,NY TrovatoandTobin,etal.
(a)Grid4√ó4 (b)Grid5√ó5
FigureA1:Gainsoverhops.
E ADDITIONALMAINRESULTSOFINTERSECTION-WISEEVALUATIONS
Inthesection,weprovidetheadditionalresultswiththeintersection-levelevaluationinTableA4.Ouralgorithmconsistentlyyielded
favorableresults,evenachievingsuperiorevaluationimprovementsinmanycases.Thisconsistentperformanceenhancementacross
intersection-wiseevaluationmetricsunderlinestherobustnessofourproposedmethod.
Notably,thesefindingsprovidestrongevidencethatouralgorithmperformswellnotonlyintermsofglobalcooperationbutalsofrom
theperspectiveofbenefitsatindividualintersections.Thisdual-levelefficacyshowcasestheeffectivenessofourapproach,signifyingits
abilitytofosteroverallroadnetworkperformancewhilesimultaneouslyoptimizingindividualintersectionoperations.
Moreover,theconsistentandsuperiorperformanceacrossvariousintersection-wiseevaluationssignifiesthealgorithm‚Äôsabilitytohandle
differenttrafficscenariosanddynamicseffectively.It‚Äôsworthnotingthattrafficscenarioscanbewidelyvariedandunpredictable,thusthe
adaptabilityshownbyourmodelunderscoresitsreal-worldapplicationpotential.CoSLight:Co-optimizingCollaboratorSelectionandDecision-makingtoEnhanceTrafficSignalControl Conferenceacronym‚ÄôXX,June03‚Äì05,2018,Woodstock,NY
Model Intersection-wiseMetrics Grid4√ó4 Avenue4√ó4 Grid5√ó5 Cologne8 Nanshan
Total -0.614¬±0.015 -4.503¬±0.025 -2.346¬±0.052 -2.114¬±0.021 -3.479¬±0.186
Delaytime -0.065¬±0.001 -0.660¬±0.004 -0.213¬±0.010 -0.214¬±0.000 -0.603¬±0.050
FTC Waittime -0.279¬±0.007 -1.175¬±0.010 -0.605¬±0.006 -1.210¬±0.013 -1.566¬±0.043
Queuelength -0.203¬±0.005 -2.294¬±0.018 -1.154¬±0.028 -0.564¬±0.007 -1.079¬±0.095
Pressure -0.066¬±0.001 -0.372¬±0.005 -0.373¬±0.015 -0.125¬±0.000 -0.229¬±0.052
Total -0.393¬±0.003 -4.032¬±0.040 -1.132¬±0.013 -0.756¬±0.012 -3.055¬±0.162
Delaytime -0.055¬±0.000 -0.600¬±0.009 -0.123¬±0.002 -0.143¬±0.002 -0.547¬±0.062
MaxPressure Waittime -0.173¬±0.002 -1.168¬±0.012 -0.379¬±0.008 -0.373¬±0.006 -1.398¬±0.032
Queuelength -0.115¬±0.000 -1.811¬±0.023 -0.447¬±0.009 -0.198¬±0.005 -0.958¬±0.066
Pressure -0.050¬±0.001 -0.453¬±0.006 -0.184¬±0.003 -0.042¬±0.001 -0.153¬±0.020
Total -0.274¬±0.000 -2.573¬±0.012 -1.064¬±0.002 -0.705¬±0.020 -3.191¬±0.170
Delaytime -0.051¬±0.001 -0.403¬±0.003 -0.120¬±0.001 -0.146¬±0.001 -0.600¬±0.012
Frap Waittime -0.107¬±0.001 -0.525¬±0.004 -0.352¬±0.002 -0.313¬±0.003 -1.391¬±0.021
Queuelength -0.079¬±0.000 -1.287¬±0.010 -0.392¬±0.002 -0.196¬±0.001 -0.985¬±0.090
Pressure -0.035¬±0.000 -0.436¬±0.002 -0.193¬±0.001 -0.042¬±0.000 -0.215¬±0.020
Total -0.336¬±0.004 -2.558¬±0.213 -0.943¬±0.037 -0.646¬±0.015 -3.555¬±0.097
Delaytime -0.053¬±0.000 -0.314¬±0.011 -0.104¬±0.005 -0.133¬±0.001 -0.586¬±0.027
IPPO Waittime -0.145¬±0.002 -0.395¬±0.064 -0.325¬±0.015 -0.314¬±0.001 -1.572¬±0.056
Queuelength -0.095¬±0.001 -1.103¬±0.029 -0.352¬±0.011 -0.164¬±0.004 -1.170¬±0.026
Pressure -0.043¬±0.001 -0.346¬±0.021 -0.162¬±0.009 -0.037¬±0.001 -0.227¬±0.017
Total -0.308¬±0.006 -2.744¬±0.238 -1.273¬±0.107 -1.697¬±0.132 -4.161¬±0.195
Delaytime -0.051¬±0.001 -0.390¬±0.039 -0.126¬±0.008 -0.207¬±0.013 -0.682¬±0.020
MAPPO Waittime -0.132¬±0.003 -0.497¬±0.060 -0.334¬±0.019 -0.899¬±0.064 -1.710¬±0.094
Queuelength -0.085¬±0.002 -1.433¬±0.139 -0.552¬±0.054 -0.443¬±0.042 -1.446¬±0.096
Pressure -0.040¬±0.001 -0.423¬±0.037 -0.260¬±0.031 -0.147¬±0.022 -0.323¬±0.010
Total -0.414¬±0.012 -4.079¬±0.049 -1.087¬±0.041 -0.842¬±0.026 -3.117¬±0.116
Delaytime -0.056¬±0.001 -0.656¬±0.022 -0.115¬±0.006 -0.150¬±0.002 -0.561¬±0.019
MPlight Waittime -0.182¬±0.006 -0.907¬±0.112 -0.362¬±0.008 -0.424¬±0.015 -1.430¬±0.053
Queuelength -0.124¬±0.003 -2.057¬±0.120 -0.429¬±0.018 -0.225¬±0.008 -0.964¬±0.043
Pressure -0.052¬±0.001 -0.459¬±0.013 -0.181¬±0.013 -0.045¬±0.002 -0.162¬±0.006
Total -0.309¬±0.006 -2.326¬±0.057 -0.918¬±0.042 -0.695¬±0.008 -2.939¬±0.092
Delaytime -0.051¬±0.000 -0.395¬±0.010 -0.099¬±0.004 -0.132¬±0.001 -0.559¬±0.041
CoLight Waittime -0.135¬±0.003 -0.440¬±0.015 -0.283¬±0.011 -0.351¬±0.005 -1.321¬±0.049
Queuelength -0.083¬±0.002 -1.114¬±0.032 -0.356¬±0.019 -0.171¬±0.003 -0.880¬±0.012
Pressure -0.039¬±0.001 -0.376¬±0.007 -0.180¬±0.017 -0.041¬±0.002 -0.179¬±0.006
Total -0.468¬±0.126 -2.538¬±0.077 -1.326¬±0.311 -0.805¬±0.168 -3.289¬±0.261
Delaytime -0.059¬±0.008 -0.399¬±0.009 -0.139¬±0.029 -0.144¬±0.009 -0.627¬±0.031
MetaGAT Waittime -0.195¬±0.042 -0.531¬±0.055 -0.377¬±0.045 -0.409¬±0.101 -1.424¬±0.08
Queuelength -0.153¬±0.06 -1.207¬±0.061 -0.55¬±0.155 -0.207¬±0.047 -1.022¬±0.13
Pressure -0.061¬±0.017 -0.402¬±0.014 -0.26¬±0.087 -0.046¬±0.012 -0.215¬±0.028
Total -0.251¬±0.000 -2.309¬±0.068 -0.890¬±0.012 -0.538¬±0.007 -2.899¬±0.014
Delaytime -0.041¬±0.000 -0.551¬±0.004 -0.090¬±0.006 -0.117¬±0.002 -0.532¬±0.011
Ours Waittime -0.100¬±0.002 -0.597¬±0.008 -0.281¬±0.011 -0.243¬±0.001 -1.39¬±0.037
Queuelength -0.061¬±0.001 -0.231¬±0.013 -0.358¬±0.007 -0.120¬±0.002 -0.801¬±0.031
Pressure -0.039¬±0.002 -0.492¬±0.005 -0.151¬±0.003 -0.020¬±0.007 -0.232¬±0.011
TableA4:Performanceonsyntheticandreal-worlddatausingintersection-wiseevaluation.Conferenceacronym‚ÄôXX,June03‚Äì05,2018,Woodstock,NY TrovatoandTobin,etal.
F ADDITIONALABLATIONOFVARIOUSSETTINGS
F.1 AdditionalAblationofVariousCollaboratorMatrix
Weconductacomprehensiveablationstudyregardingdifferentcollaboratormatrices.Inthiscontext,the‚Äúfixedmatrix‚Äùsignifiesselecting
thenearestfourintersectionsasneighborsbasedonthetopology,centeredaroundoneself,andkeepingitconstantthroughouttheexperiment.
Meanwhile,the‚Äúrandommatrix‚Äùreferstorandomlychoosingfourintersectionsascollaboratorsateachinstance,makingitpossiblethat
differentintersectionstobeselectedatvarioustimes.
Theexperimentalresultsindicatethatourapproach,whichjointlyoptimizestheselectionofcollaborators,issuperior.Forinstance,in
scenarioslikeGrid4√ó4andGrid5√ó5,usingafixedorrandomcollaboratormatrixleadstoperformancedegradation,withtheperformance
deterioratingevenfurtherinthelatterstagesoflearning.Observingallfivescenarios,boththefixedandrandommatricesdemonstrate
similarperformancetrends.Thissuggeststhatsuchnon-learning-basedapproachesmaylackadaptabilitytothedynamicnatureoftraffic
scenariosandcan‚Äôteffectivelycapturetheintricateinteractionsamongintersections.Incontrast,ourjointoptimizationparadigmisbetter
positionedtoleveragetheinterplayandachieveoptimalcollaborationforboostingtrafficsignalcontrol.
(a)Grid4√ó4 (b)Avenue4√ó4 (c)Grid5√ó5
(d)Cologne8 (e)Nanshan
FigureA2:Learningcurvesoftheablationstudyaboutvariouscollaboratormatrices.
F.2 AdditionalAblationabouttheConstraints
ToassessthesignificanceoftheconstraintsinEquations(13)and(14),weconductathoroughablationstudyacrossfivescenarios.Specifically:
‚Ä¢ w/oDiagonal:Theconstraintfordiagonalmaximizationisremoved.
‚Ä¢ w/oSymmetry:Thesymmetryconstraintisomitted.
‚Ä¢ w/oBoth:Boththediagonalmaximizationandsymmetryconstraintsareeliminated.
Fromthissetup,weaimtounderstandtheindividualandcombinedrolesoftheseconstraintsintheoverallperformanceandadaptabilityof
ourmodelinvarioustrafficsituations.
AsdepictedinFigureA3,forscenarioslikeGrid4√ó4andGrid5√ó5,alltheseconfigurationscaneventuallyachievesimilarperformance
levels.However,whenincorporatingtheproposedconstraints,there‚Äôsaclearadvantageintermsofquicklyreachingpeakperformance,thus
showcasingfasterconvergence.Specifically,intheGrid4√ó4scenario,removingthediagonalmaximizationconstraintresultsinsignificant
performancedegradationintheearlystages.Thissuggeststhatdecisionsinthisscenariomightrelymoreheavilyonthefeaturesofthe
intersectionitself.Ontheotherhand,otherscenariosdisplaylargerperformancedropswhenthesymmetryconstraintisremoved,indicating
agreaterneedtoconsidermutualcharacteristicsformoredecisiveandinteroperabledecision-making.BothCologne8andNanshanscenarios
showatrendofstagnatinglearningwhenconstraintsareremoved.ThisimpliesthattheseconstraintsplayavitalroleinguidingthelearningCoSLight:Co-optimizingCollaboratorSelectionandDecision-makingtoEnhanceTrafficSignalControl Conferenceacronym‚ÄôXX,June03‚Äì05,2018,Woodstock,NY
process,especiallyinscenarioswithpotentiallyintricateinternaldynamics.Byaddingtheseconstraints,theexplorationspacebecomes
morecompact,makingiteasiertolearnaneffectivedecision-makingstrategy.
(a)Grid4√ó4 (b)Avenue4√ó4 (c)Grid5√ó5
(d)Cologne8 (e)Nanshan
FigureA3:Learningcurvesoftheablationstudyaboutvariousconstraints.
F.3 AdditionalAblationabouttheMainComponents
First,letusdelineatetheexperimentalsetupforthissection.
‚Ä¢ w/oFRAP:RemovetheFRAPmodulefromthedual-featureextractor,retainingonlytheintersection-levelfeatures.
‚Ä¢ w/oTransformer:EliminatetheTransformermodulefromthedual-featureextractor,keepingsolelythephase-levelfeatures.
‚Ä¢ w/oTeammate:RemovetheCoSmodule,resultinginnoteammatecoordination.
‚Ä¢ CoSwithGNN:ReplacetheMLPsintheCoSmodulewithGNNs.
Inthissection,wepresentmulti-dimensionaltrainingcurvesforvariousevaluationmetricsincludingaverageepisoderewards,average
delaytime,averagewaittime,averagequeuelength,andaveragepressureacrossdifferentscenarios.Theseresultssupplementourmain
ablationstudiesandprovideamorecomprehensiveunderstandingoftheperformanceandrobustnessofouralgorithmundervarious
conditions.
Ablationanalysisonaverageepisoderewards. AsshowninFigureA4,InexperimentsacrossGrid4√ó4,Avenue4√ó4,Grid5√ó5,and
Cologne8,weobservedasignificantlyslowerconvergencerateforCoSwithGNN,takingmuchlongertoreachaplateaucomparedto
ouralgorithm.FortheNanshanmap,whichfeaturesanirregulartopologywith28intersections,theslowdownwaslesspronounced.We
speculatethatinsuchacomplexscenario,GNNsmightbebetteratcapturinginherentdynamicalinformation,thusresultinginadecent
convergencerateandperformance.However,forthissetting,trainingourCoSonasingleseed(300ktimestamps)tookjust13.1hours,
whereastheGNNvarianttookastaggering40.8hours.IntermsofGPUconsumptionforasingleprocess,theMLPversionofCoSpeakedat
1.5G,whiletheGNNversionutilizednearly12G.Thisclearlydemonstratesthatwhileachievingcompetitiveperformance,CoSwithMLPs
significantlysaveoncomputationalresources.
Theaboveisanevaluationofthetrainingcurveconcerningtheaverageepisodereward.Subsequently,thetrainingcurvesforfine-grained
evaluationsineachscenario,includingtheaveragedelaytime,averagewaittime,averagequeuelength,andaveragepressure,areprovided.
Ablationanalysisonaveragedelaytime. AsdepictedinFigureA5,whichpresentsthelearningcurvesfromtheablationstudyconcerningthe
averagedelaytime,ouralgorithmwithallitsmodulesdemonstratessignificantimprovementsinfouroutofthefivescenarios.Theone
exceptionwasNanshan,wheretheimpactofourfinely-designedmodulesappearedtobelesssubstantial.Conferenceacronym‚ÄôXX,June03‚Äì05,2018,Woodstock,NY TrovatoandTobin,etal.
(a)Grid4√ó4 (b)Avenue4√ó4 (c)Grid5√ó5
(d)Cologne8 (e)Nanshan
FigureA4:Learningcurvesoftheablationstudyofthevariouscomponentsabouttheaverageepisoderewards.
WehypothesizethatthisanomalymaybeduetothelargerscaleoftheNanshanmap.Thecomplexityinherentinlargermapsmight
dilutetheeffectsofourspecializedmoduleswhenitcomestoreducingdelaytimes.However,theconsistentimprovementsintheotherfour
scenariosunderscoretheoveralleffectivenessofouralgorithmanditscomponents,provingtheirvalueinoptimizingtrafficsignalcontrol
acrossamajorityofscenarios.
Ablationanalysisonaveragewaittime. FigureA6showsthelearningcurvesoftheablationstudyabouttheaveragewaittime.Intermsof
averagewaitingtime,ourcompletealgorithmhasshownconsistentperformanceadvantagesacrossallmaps.Thisindicatesthatthefull
suiteofmodulesinourapproachishighlyeffectiveinreducingwaittimes,acriticalfactorintrafficsignalcontrol.Theuniformsuccess
acrossallscenariosreinforcestherobustnessofourmethodanditspotentialforbroadapplicationindiversetrafficsituations.
Ablationanalysisonaveragequeuelength. AsillustratedinFigureA7,whichdisplaysthelearningcurvesoftheablationstudyaboutthe
averagequeuelength,ourfullalgorithmshowedconsistentperformanceimprovementsinallscenarios,exceptfortheAvenue4√ó4.We
believethatthecomplexityandhightrafficflowoftheAvenue4√ó4scenariomayhaveresultedinthelessnoticeableimprovementinqueue
lengthbyouralgorithm.
Thissuggeststhatwhileourmethodperformsexcellentlyacrossmostscenarios,certainsituationswithhighcomplexityandtraffic
densitymaypresentadditionalchallenges.Despitethis,theoverallperformanceadvantageinthemajorityofscenariosreinforcesthe
effectivenessofourapproach,demonstratingitscapabilitytomanagequeuelength-animportantfactorintrafficflowcontrol.
Ablationanalysisonaveragepressure. FigureA8showsthelearningcurvesoftheablationstudyabouttheaveragepressure.Ourcomplete
algorithmperformedbetterinallsituations,exceptfortheAvenue4√ó4scenario.Weconjecturethatthehighcomplexityandsignificant
trafficvolumeoftheAvenue√óscenariomayhaveledtoalessnoticeableeffectinpressurereductionfromouralgorithm.
Thistrenddoesshedlightonapossiblelimitationofourmethod,whichmightyieldsmallerperformanceimprovementsinhighlycomplex
scenarioswithdensetrafficflow.However,thisshouldnotbeseenasasignificantshortcoming.Whencomparedtobaselinealgorithms,our
methodstilldisplayssubstantialadvantages.Additionally,ourcompletealgorithmachievedsignificantandconsistentimprovementsinall
otherscenarios,attestingtoitsrobustnessandgeneraleffectivenessinTSC.CoSLight:Co-optimizingCollaboratorSelectionandDecision-makingtoEnhanceTrafficSignalControl Conferenceacronym‚ÄôXX,June03‚Äì05,2018,Woodstock,NY
(a)Grid4√ó4 (b)Avenue4√ó4 (c)Grid5√ó5
(d)Cologne8 (e)Nanshan
FigureA5:Learningcurvesoftheablationstudyabouttheaveragedelaytime.
(a)Grid4√ó4 (b)Avenue4√ó4 (c)Grid5√ó5
(d)Cologne8 (e)Nanshan
FigureA6:Learningcurvesoftheablationstudyabouttheaveragewaittime.Conferenceacronym‚ÄôXX,June03‚Äì05,2018,Woodstock,NY TrovatoandTobin,etal.
(a)Grid4√ó4 (b)Avenue4√ó4 (c)Grid5√ó5
(d)Cologne8 (e)Nanshan
FigureA7:Learningcurvesoftheablationstudyabouttheaveragequeuelength.
(a)Grid4√ó4 (b)Avenue4√ó4 (c)Grid5√ó5
(d)Cologne8 (e)Nanshan
FigureA8:Learningcurvesoftheablationstudyabouttheaveragepressure.CoSLight:Co-optimizingCollaboratorSelectionandDecision-makingtoEnhanceTrafficSignalControl Conferenceacronym‚ÄôXX,June03‚Äì05,2018,Woodstock,NY
G ADDITIONALANALYSISOFCOLLABORATORNUMBERùëò
Inthissection,wepresentviolinplotsforallscenariosinFigureA9,demonstratingtheeffectofvaryingthenumberofcollaborators.Notably,
intheGrid4√ó4scenario,thereisacleartrendofperformanceenhancementasthenumberofcollaboratorsincreases.Thisindicatesthat,in
suchastraightforwardgridenvironment,theperformanceimprovementsbroughtaboutbytargetedcollaborationbetweencollaborators
maynotbeassignificantasthosefromtheincorporationofinformationfromacrosstheentiremap.Inthissimplecase,theinformation
iseithernotredundant,orthedecision-makingisnotaffectedbyanyredundantinformation.IntheCologne8scenario,theperformance
improvementsbroughtaboutbyincreasingthenumberofcollaboratorsarenotapparent.Thissuggeststhat,inthisextremelysimplisticmap
withsparsetrafficandonlyeightintersections,collaborationbetweencollaboratorsmaynotbeascrucial.Inothermaps,abalancesimilar
towhatwementionedearlierisdisplayed.Itsignifiesthenuancedrelationshipbetweenthenumberofcollaboratorsandtheresulting
performanceimprovement.
Ineachmap,varyingthenumberofcollaboratorscaninfluencetheperformancedifferently,highlightingtheimportanceoftailoring
strategiestospecificscenarios.Forinstance,whileGrid4√ó4benefitsmorefromaholisticinformationintegrationacrossallintersections,
Cologne8seeslimitedgainsfromextensivecollaboratorsduetoitssimplicityandsparsetraffic.Theanalysisalsounderscoresthefactthat
theenvironmentalcomplexityandspecificscenariofactorsheavilyinfluencethisrelationship.Thisfurtherhighlightstheimportanceof
adaptivelydeterminingtheappropriatenumberofcollaborators,apotentialareaforfutureexploration.
2.0
1.0
0.25
2.5
0.30 1.2
0.35 3.0 1.4
0.40 3.5 1.6
0.45
4.0
1.8
0.50
2 4 6 8 10 12 14 16 2 4 6 8 1012141618202224
2 4 6 8 10 12 14 16
The Number of Teammates The Number of Collaborators The Number of Collaborators
(a)Grid4√ó4 (b)Avenue4√ó4 (c)Grid5√ó5
2.50
0.6 2.75
0.8 3.00
1.0 3.25
3.50
1.2
3.75
1.4
4.00
1.6
4.25
1 2 3 4 5 6 7 8 2 4 6 8 10 12 14 16 18 20 22 24 26 28
The Number of Teammates The Number of Teammates
(d)Cologne8 (e)Nanshan
FigureA9:Violinplotofanalysisaboutvariousnumberofcollaborators.
H ADDITIONALVISUALIZATIONANALYSISOFCOLLABORATORMATRIX
Inthissection,wepresentanextendedvisualizationanalysis,incorporatingheatmapsacrossallscenariosinFigureA10toprovidea
morecomprehensiveunderstandingofthelearningdynamics.Thisadditionalmaterialaffirmstheintriguingpatternthatwehavealready
discussed:intersectionsarenotonlylearningtoconcentrateontheirownstates,buttheyalsodevelopanawarenessoftheirpeers.This
revealsacollaborativelearningprocessamongintersections.
Eachintersectionmanagestostrikeabalancebetweenself-attentionandpeerattention,learningtorecognizewhencollaboration
couldbringaboutperformanceimprovements.Inthisway,weseethatouralgorithmhasfosteredalearnedmutualcollaborationamong
intersections.Theseobservationsofferabroadervalidationoftheeffectivenessofourapproachindevelopingacollaborativeenvironment
amongintersections,whichultimatelyleadstoperformanceenhancementacrossdifferentscenarios.
I ADDITIONALVISUALIZATIONANALYSISOFDUAL-FEATURE
Inthissection,weoffer2Dand3DTSNEvisualizationresultsforeachscenario,showninFigureA11andA12,respectively.Theseresults
consistentlydemonstrateadistinctiveclusteringcharacteristic.Whiletheembeddingsforeachintersectionmaydifferduetovaryingtraffic
sdraweR
edosipE
egarevA
sdraweR
edosipE
egarevA
sdraweR
edosipE
egarevA
sdraweR
edosipE
egarevAConferenceacronym‚ÄôXX,June03‚Äì05,2018,Woodstock,NY TrovatoandTobin,etal.
Teammate Matrix Teammate Matrix Teammate Matrix 0.12 Teammate Matrix 0.062600 0.0627 0.10 0.10
0.062575
0.08 0.062550 0.08 0.0626
0.062525
0.0625
0.06 0.062500 0.06
0.04 0.062475 0.04 0.0624
0.062450
0 1 2 3 4 5 6Inter7sectio8n ID9 10 11 12 13 14 15 0 1 2 3 4 5 6Inter7sectio8n ID9 10 11 12 13 14 15 0 1 2 3 4 5 6Inter7sectio8n ID9 10 11 12 13 14 15 0 1 2 3 4 5 6Inter7sectio8n ID9 10 11 12 13 14 15
(a)BeginninginGrid4√ó4 (b)EndinginGrid4√ó4 (c)BeginninginAvenue4√ó4 (d)EndinginAvenue4√ó4
Teammate Matrix Teammate Matrix Teammate Matrix Teammate Matrix 0.1255 0.08 0.04008 0.16
0.1254 0.07 0.04006
0.14 0.1253 0.06 0.04004
0.04002 0.12 0.1252 0.05
0.04000 0.1251
0.04 0.10
0.03998 0.1250
0.03 0.08 0.03996 0.1249
0.02 0.03994 0.06 0.1248
01234567891In0te1r1se1c2tio1n3 ID1415161718192021222324 01234567891In0te1r1se1c2tio1n3 ID1415161718192021222324 0 1 2 In3tersection 4ID 5 6 7 0 1 2 In3tersection 4ID 5 6 7
(e)BeginninginGrid5√ó5 (f)EndinginGrid5√ó5 (g)BeginninginCologne8 (h)EndinginCologne8
Teammate Matrix
Teammate Matrix
0.06 0.035720
0.035718
0.05
0.035716
0.04 0.035714
0.03 0.035712
0.035710
0.02
01234567891011Int1e2rs1e3c1t4ion15 ID161718192021222324252627 01234567891011Int1e2rs1e3c1t4ion15 ID161718192021222324252627
(i)BeginninginNanshan (j)EndinginNanshan
FigureA10:Additionalvisualizationofteammatrix.Thedeeperthecolor,thestrongerthecorrelation.
conditionsandintricaciesinherenttothelocation,theclusteringpatternindicatesthatthemodelsuccessfullyinterpretsanddistillsthese
uniquecharacteristicsintoitsdecision-makingprocess.Thisabilitytolearnandadapttotheuniquefeaturesofeachintersectionisakey
strengthofourapproachandprovidesasignificantcontributiontoperformanceimprovement.
0 1 2 3
4
5 6DI n7oitces8retnI9
01
11
21 31
41
51
012345678901DI
1n1oit2c1esr3e1tn4I151617181910212223242
0 1 2 3
4
5 6DI n7oitces8retnI9
01
11
21 31
41
51
012345678901DI
1n1oit2c1esr3e1tn4I151617181910212223242
01234567890111D2I
1no3i1tce4s1re5t1nI617181910212223242526272
0 1 2 3
4
5 6DI n7oitces8retnI9
01
11
21 31
41
51
0
1
2
D3I noitcesret4nI
5
6
7
01234567890111D2I
1no3i1tce4s1re5t1nI617181910212223242526272
0 1 2 3
4
5 6DI n7oitces8retnI9
01
11
21 31
41
51
0
1
2
D3I noitcesret4nI
5
6
7CoSLight:Co-optimizingCollaboratorSelectionandDecision-makingtoEnhanceTrafficSignalControl Conferenceacronym‚ÄôXX,June03‚Äì05,2018,Woodstock,NY
(a)Grid4√ó4 (b)Avenue4√ó4 (c)Grid5√ó5
(d)Cologne8 (e)Nanshan
FigureA11:2-DTSNEVisualizationofDual-feature.Eachcolorrepresentsaspecificintersection.
(a)Grid4√ó4 (b)Avenue4√ó4 (c)Grid5√ó5
(d)Cologne8 (e)Nanshan
FigureA12:3-DTSNEVisualizationofDual-feature.Eachcolorrepresentsaspecificintersection.Conferenceacronym‚ÄôXX,June03‚Äì05,2018,Woodstock,NY TrovatoandTobin,etal.
J ADDITIONALVISUALIZATIONANALYSISOFCOLLABORATORASSIGNMENT
Inthissection,weprovideadditionalresultsforthevisualizationofthecollaboratorassignment.Specifically,weconductedtestsonthe
Cologne8andAvenue4√ó4scenarios,withcollaboratorcountsof1,2,3,4,and5.Werefrainedfromtestingscenarioswithalargernumberof
intersectionsandcollaboratorsduetothediversityofbarcolors,whichcouldcomplicateobservationandpreventmeaningfulconclusions.
(a)K=1 (b)K=2 (c)K=3
(d)K=4 (e)K=5
FigureA13:VisualizationofthecollaboratorassignmentonCologne8.
InFigureA13,wepresenttheevolutionofthecollaboratorassignmentontheCologne8dataset.
‚Ä¢ WehavepreviouslyanalyzedscenarioswhenthecollaboratornumberKequals1and3inthemainmanuscript.
‚Ä¢ ForK=2,weobserveanintriguingmutualselectiontrendamongagents2and3,aswellasagents4and5.Throughthereconstruction
oftheoriginaltrafficflow,weidentifiedtrafficcorrelationsbetweentheseagentpairs,furthervalidatingtheefficacyofouradaptive
methodinselectingthemostsuitablecollaborators.
‚Ä¢ WhenKisincreasedto4,agent4primarilychoosesagents4,2,1,and5ascollaborators,agent2predominantlyselectsagents2,3,1,
and6,whileagent1mainlyselectsagents1,2,4,and0.Thiscollaborativebehaviorsuggeststhatourapproachcanmanagemore
complexscenarioswheremultipleagentsareinvolved.
‚Ä¢ UponfurtherincreasingKto5,weobserveanemergenceofcross-collaborationwithinthevirtualsubareas,whichsolidifiesour
earlierobservationsthatouralgorithmcaneffectivelyhandlecross-topologycollaboratorselection.
Thiscross-collaborationphenomenonalsodemonstratestheflexibilityofourmethodincreatingdynamic,adaptivecollaborations,evenin
complexenvironmentswithmultipleagents.Insummary,theseresultsstronglyindicatethatourlearning-basedstrategycanadaptively
selecttheoptimalcollaboratorsbasedontheintrinsicdynamicsandtheevolvingnatureofthetrafficflow.Thisadaptiveapproachto
collaboratorselectionprovidesamoreresponsiveandeffectivemechanismtomanagethecomplexitiesofreal-worldtrafficscenarios.
Subsequently,inFigureA14,wepresentanexaminationofcollaboratorassignmentontheAvenue4√ó4datasettofurthersubstantiatethe
effectivenessofourapproach.
‚Ä¢ AtK=1,thevastmajorityofagentsarecapableofselectingthemselvesascollaborators.Interestingly,agent0consistentlychooses
agent11asitscollaborator.Throughthereconstructionoftheoriginaltrafficnetwork,weobservedthatagents0and11aresituated
adjacenttoeachotheronthenetwork,withhighlycorrelatedtrafficflow.Thisfindingindirectlyconfirmsourmethod‚Äôsabilityto
learninherenttrafficpatterns.Otherinstancesofmutualselectionareoccasionallyobserved,forexample,betweenagents4and5.
‚Ä¢ WhenKisincrementedto2,agent0continuestoselectagent11andaddsitselftothelistofcollaborators.Amutualselectiontrendis
alsoobservedamongagentpairs5and10,1and11,aswellas4and13.
‚Ä¢ ForK=3,agent0includesanewcollaborator,agent3,inadditiontoitselfandagent11.Correspondingly,agent3tendstochoose
agents3,0,and11asitscollaborators.Otheragentsalsodisplaymutualselectionwithintheircollaborativesubareas.CoSLight:Co-optimizingCollaboratorSelectionandDecision-makingtoEnhanceTrafficSignalControl Conferenceacronym‚ÄôXX,June03‚Äì05,2018,Woodstock,NY
(a)K=1 (b)K=2 (c)K=3
(d)K=4 (e)K=5
FigureA14:VisualizationofthecollaboratorassignmentonAvenue4√ó4.
‚Ä¢ AsKexpandsto4,agent0addsanothernewcollaborator,agent6,toitspreviouscollaborators(0,11,3).Thispatternofincrementally
addingnewcollaboratorsasthenumberofoptionsincreasesdemonstratesouralgorithm‚Äôscapacitytorecognizetheintrinsictraffic
dynamicsandinterrelationamongmultipleintersections.
‚Ä¢ WithK=5,uponcarefulanalysis,theaforementionedphenomenaandsupportingconclusionscontinuetohold.
Inconclusion,theseresultsconvincinglydemonstratethatourapproachiseffectiveinselectingcollaboratorsadaptivelyindifferentscenarios.
Notonlydoesitcapturetheintrinsicdynamicsofthetrafficbutalsodiscernstheinherentrelationsbetweenmultipleintersections,thus
establishingthevalueofourmethodindealingwithcomplextrafficscenarios.
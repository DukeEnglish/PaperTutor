Improving the prediction of individual engagement in
recommendations using cognitive models
RoderickSeow YunfanZhao DuncanWood
yseow@andrew.cmu.edu yunfanzhao@fas.harvard.edu djwood@andrew.cmu.edu
CarnegieMellonUniversity HarvardUniversity CarnegieMellonUniversity
Pittsburgh,Pennsylvania,USA Boston,Massachusetts,USA Pittsburgh,Pennsylvania,USA
MilindTambe CleotildeGonzalez
milind_tambe@harvard.edu coty@cmu.edu
HarvardUniversity CarnegieMellonUniversity
Boston,Massachusetts,USA Pittsburgh,Pennsylvania,USA
Abstract 1 Introduction
Forpublichealthprogramswithlimitedresources,theabilityto Public health programs play an essential role in improving the
predicthowbehaviorschangeovertimeandinresponsetointerven- healthoutcomesofindividualsandcommunities,oftenthroughed-
tionsiscrucialfordecidingwhenandtowhominterventionsshould ucationandsubsequentbehavioralchange.Somehealthprograms
beallocated.Usingdatafromareal-worldmaternalhealthprogram, interactwiththeirintendedbeneficiariesinabroadandinfrequent
wedemonstratehowacognitivemodelbasedonInstance-Based manner.Forexample,acampaignaboutthehealthrisksofsmoking
Learning(IBL)Theorycanaugmentexistingpurelycomputational mayaddressageneralpopulationofsmokersthroughscattered
approaches.Ourfindingsshowthat,comparedtogeneraltime- advertisementsinthemedia[18].Othersrelyonrepeateddirectin-
seriesforecasters(e.g.,LSTMs),IBLmodels,whichreflecthuman teractionswiththeirintendedbeneficiaries.Forexample,maternal
decision-makingprocesses,betterpredictthedynamicsofindivid- healthprogramsthatsendautomatedmessagesaboutexerciseand
uals‚Äôstates.Additionally,IBLprovidesestimatesofthevolatilityin nutritiontoenrolledexpectantmothers[13].Inthiscase,itiscru-
individuals‚Äôstatesandtheirsensitivitytointerventions,whichcan cialthatmothersremainengagedforthedurationoftheprogram
improvetheefficiencyoftrainingofothertimeseriesmodels. oraslongaspossibletoreceivethemaximumbenefit.Unfortu-
nately,manysuchprogramsfacehighlevelsofdisengagementand
dropout,whichseverelylimittheireffectiveness[1].
CCSConcepts
Toreducedropout,programscanprovideinterventionsdesigned
‚Ä¢ Computing methodologies ‚Üí Modeling and simulation;
toincreasebeneficiaryengagement.Forexample,programstaffcan
‚Ä¢Human-centeredcomputing‚ÜíCollaborativeandsocial
makepersonalizedservicecallstobeneficiariesatriskofdropping
computing.
outtoaddressconcernsaboutdecliningparticipation.However,pro-
gramswithlimitedstaffandresourcescannotinterveneonalltheir
Keywords beneficiaries.Instead,theymustchooseasubsetofbeneficiariesto
gettheintervention.
CognitiveModeling,Instance-basedlearning,Time-seriesforecast-
RecentapproachestothischallengehaveadoptedtheRestless
ing,Limitedresourceallocation,Maternalhealth,Engagement
Multi-ArmedBandit(RMAB)resourceallocationframework[12].
Within this framework, the engagement dynamics of each ben-
ACMReferenceFormat: eficiary(i.e.,transitionbetweendiscreteengagementstates)are
RoderickSeow,YunfanZhao,DuncanWood,MilindTambe,andCleotilde
modeledasaMarkovDecisionProcess(MDP).Acentralizedplan-
Gonzalez.2024. Improvingthepredictionofindividualengagementin
ner decides which beneficiaries to intervene upon at each time
recommendationsusingcognitivemodels.InProceedingsofthe6thInterna-
pointbasedonthedynamicslearnedfromtheMDPs.Importantly,
tionalWorkshoponHealthRecommenderSystemsco-locatedwiththe18th
beneficiariescanchangetheirengagementstateevenwithoutan
ACMConferenceonRecommenderSystems(HealthRecySys‚Äô24).Bari,Italy,
8pages. intervention.Themostoptimalapproachinthisframeworkisthe
Whittleindex[22],whichranksbeneficiariesaccordingtothelike-
lihoodofbecomingandremainingengagedgivenanintervention.
Akeyassumptionofthisframeworkisthatbeneficiaries‚Äôdy-
namicscanbemodeledasanMDP.However,itisquestionable
Permissiontomakedigitalorhardcopiesofallorpartofthisworkforpersonalor
whetherthesedynamicsareindeedMarkovianinreality.Recent
classroomuseisgrantedwithoutfeeprovidedthatcopiesarenotmadeordistributed
forprofitorcommercialadvantageandthatcopiesbearthisnoticeandthefullcitation workdemonstratedthatthesedynamicsareoftennon-Markovian;
onthefirstpage.Copyrightsforcomponentsofthisworkownedbyothersthanthe thatis,abeneficiary‚Äôstransitionsbetweenstates(i.e.,engagedand
author(s)mustbehonored.Abstractingwithcreditispermitted.Tocopyotherwise,or
republish,topostonserversortoredistributetolists,requirespriorspecificpermission disengaged)dodependontheirindividualizedhistory,andinstead
and/orafee.Requestpermissionsfrompermissions@acm.org. developedtheTime-seriesArmRankingIndex(TARI)whichex-
HealthRecySys‚Äô24,October18,2024,Bari,Italy tendsRMABstoallowfornon-Markoviandynamicsandcontinuous
¬©2024Copyrightheldbytheowner/author(s).PublicationrightslicensedtoACM.
4202
guA
82
]GL.sc[
1v74161.8042:viXraHealthRecySys‚Äô24,October18,2024,Bari,Italy Seowetal.
engagementlevels[7].AccordingtoTARI,eachbeneficiaryismod- 1.2 Background
elednotasaMDP,butusingtime-seriesforecasterssuchasLSTMs 1.2.1 Time-seriesArmRankingIndex(TARI). Inthecontextofmul-
[10]ortransformers[20].Usingtheselearnedtime-seriesmodels, tiplepotentialbeneficiariestreatedasarmsinanRMAB,eacharm
TARIcomputesanindexthatreflectstherelativeengagementbene- isconsideredanindependenttimeseries[7].Wetrainamodelto
fitofinterveningonabeneficiaryversusnotinterveningatagiven predictthenextstateùë† ùë°+1basedonthreepiecesofinformation:
timepoint,andthenranksbeneficiariesaccordingtothecomputed
‚Ä¢ Ahistoricalrecord(lengthh)ofthepaststatesandactions
ind Wice its h.
inthecontextdescribedthusfar,weproposetheuseof
ofthearm(denotedby{(ùë† ùëñ,ùëé ùëñ)}‚Ñé ùëñ<ùë°).
‚Ä¢ Thecurrentstate(e.g.,engagementlevel)ofthearmùë† ùë°.
computationalcognitivemodelsofindividualbeneficiariesinstead
‚Ä¢ Apotentialactionùëé ùë°,where1representsanintervention
ofLSTMs.Specifically,wewillcreateamodelbasedonasuccessful
and0representsnointervention.
accountofindividualdynamicdecisionmaking,Instance-Based
Thistrainingtakesplaceoffline.Duringtesttime,themodel‚Äôspa-
LearningTheory(IBLT)[9]torepresenteachbeneficiary‚Äôstime
rametersarefixedandweusethetrainedmodelwithiteratedmulti-
seriesactivities.UsinganIBLmodelisexpectedtohaveatleasttwo
potentialadvantagesovergeneraltime-seriesforecasters(TSFs).
steptogeneratealong-termforecastoffuturestatesùë† ùë°+1,ùë† ùë°+2,...,ùë†
ùë°+ùêª
[19].ThisforecastisthenusedtocalculatetheTARIindex,which
First,TSFsneedlargeamountsofdatatofine-tuneduetothe
helpsustodecidetherelativeutilityofinterveninginanarm.
large number of model parameters. Given the relatively sparse
Foreacharm,weusetheTSFmodeltoestimatetwovalues:
amountofdataavailableperbeneficiary,existingapproachestypi-
callytrainasinglemodelusingdatafromallavailablebeneficiaries. ‚Ä¢ Timetodisengagementwithinterventionùë¢ ùëõ:Thispredicts
Forinstance,Danassisandcolleagues(2023)spliteachbeneficiary‚Äôs howlongitwilltakeforthearmtobecomenon-engagedif
trajectoryintoasetoffixed-lengthvectorswhereeachvectorrep- weinterveneonceatthecurrenttimestep(t)andthennever
resentedtheinterventionhistoryandengagementlevelsofseven interveneagain.
consecutivetimesteps.ThenanLSTMwastrainedonthesevectors, ‚Ä¢ Timetodisengagementwithoutinterventionùë£ ùëõ:Thispre-
wherethetaskwastopredicttheengagementlevelatthenexttime dictshowlongitwilltakeforthearmtobecomenon-engaged
step[7].Incontrast,anIBLcognitivemodelcanbepersonalized ifwedidnotinterveneatall.
becauseitcanmodelandpredictindividualhumanbehaviorwith TheTARIindexforanarmissimplytheratioofthesetwotimes.A
lessdata[6].ThisisbecauseIBLTmakesstrongassumptionsabout higherTARIindexsuggeststhatinterveningnowwouldbemore
thedynamicsofhumanbehaviorthatarederivedfrompriorre- beneficial.Finally,similartotheWhittleindex,wechoosetoacton
searchonhumancognitionanddecisionmaking.Inparticular,IBLT theùëòarmwiththehighestTARIindexateachtimestep:
accountsformemoryeffects(i.e.,themorerecentadatapointis,
ùë¢
ùëõ
themoreitcontributestotheprediction)andsimilarityeffects(i.e., TARI(ùëõ)= .
ùë£
engagementlevelsthatareobservedundersimilarcontextsshould ùëõ
besimilartoeachother)thatgeneralTSFsdonot. 1.2.2 Instance-BasedLearningTheory. Instance-BasedLearning
Second,theparametersofIBLcognitivemodelsaregroundedin Theory(IBLT)isacognitivetheoryofdynamicdecisionmaking,
psychologicalconstructssuchasmemoryandattention,andare groundedinhumanlearningandmemorymechanisms.Ithassuc-
thusmoreeasilyinterpretedthantheparametersofgeneralLSTMs. cessfullyaccountedforhumanbehaviorinavarietyofcontexts,
Thisadvantageinturnenablescognitivemodelstoprovideinsight rangingfromabstractrepeated-choicetaskstomorereal-world
aboutindividualdifferencesincognitionthatmayaffectbeneficia- searchandchoice[17]andcontinuouscontroltasks[9].Inpartic-
ries‚Äôbehaviors.Wedemonstratehowtheseindividualcognitive ular,inmostofthesecontexts,humanparticipantsarerequired
differencescanbeusedtoaugmentexistingapproachesthatrely tomakeaseriesofdecisionswhileexposedtochangingenviron-
primarilyongeneralLSTMs. ments.GivenIBLT‚Äôsprevioussuccessincapturinghumandecision
making,weexpectthatamodelbasedonIBLTwouldsimilarlybe
abletoaccountforthetemporalandintervention-relateddynamics
1.1 OurContributions
ofbeneficiaries‚Äôengagementlevels.
(1) Usingreal-worlddatafromamaternalhealthprogram,we AtthecoreofIBLTistherepresentationofadecisioninthe
showthatcognitivemodelsaremoreaccuratecomparedto form of an instance. Typically, an instance has three parts: the
LSTMsincapturingthetemporaldynamicsofindividual context,thedecisionitself,andtheassociatedutility.Forexample,
behaviorsandpredictingthebehaviorsofindividualbenefi- thedarknessoftheskywouldbethecontext,thechoicetobringan
ciaries. umbrella(ornot)wouldbethedecision,andtheutilitymayinvolve
(2) Weshowcasethatpersonalizedcognitivemodelscouldre- thecostofbringinganumbrellaaddedtowhetherornotyougot
vealindividualcharacteristicsthroughweightsfitting.We wet.
illustratehowtoclusterindividualsusinglearntcharacteris- IBLTproposesthattheagentmakesapredictionofthepotential
tics. utilityofadecisionbasedonsimilarinstancesstoredinmemory.
(3) Weshowclusteringbasedonlearntindividualcharacteristics Forexample,itpredictsthepotentialutilityofbringingornotbring-
could guide and improve the performance of time series inganumbrellainsituationswithsimilarskydarkness.Decisions
models.Specifically,weshowthatLSTMstrainedinclusters arestoredasinstancesinmemoryandretrievedwhentheagentis
betterpredictbehaviorswithinthoseclusterscomparedto facedwithanotherdecision.Topredicttheutilityofeachpotential
LSTMstrainedonrandomsamplesofbeneficiaries. action,thepastutilitiesofsimilarinstancesareweightedbytheirImprovingthepredictionofindividualengagementinrecommendationsusingcognitivemodels HealthRecySys‚Äô24,October18,2024,Bari,Italy
probabilityofretrievalfrommemorytogenerateestimatesofthe Asmentionedabove,thesimilarityoftwoinstancesdepends
expectedutility(i.e.,aBlendedvalue).Theagentthenselectsthe notonlyonthesimilaritybetweenattributevalues,butalsoon
optionthathasthehighestestimatedutility.Theutilitiesofin- theweightorinfluenceoftheattribute(ùë§ inEquation1).Psycho-
stancesinmemoryareupdatedusingtheactualoutcomeobserved logically,anattributeweightrepresentshowrelevanttheagent
foradecisionmade.Thus,theexpectedinitialutilityturnsintoan considersanattributetomakesimilarityjudgmentsbetweentwo
experiencedutility.Theupdatedinstancesarethenbootstrapped contexts.Tocapturepotentialindividualdifferencesbetweenmoth-
tomakefuturedecisions. ers,wepersonalizedanIBLmodelforaspecificmotherbyfinding
Thecontributionofaretrievedinstance‚Äôsoutcometothefinal the combination of attribute weight values that resulted in the
estimatedutilityofanoptiondependsonthememoryactivation smallesttrainingpredictionerror.
of the instance. The activation of an instance (ùê¥ ùëñ) reflects how Giventhepredictionsofengagementlevel,wethenfollowthe
readilyitcomestomind,whichinturndependsonthefrequency, TARIalgorithmandgeneratearankedlistofmothersaccordingto
recency,andsimilarityfactorsaccordingtothefollowingequation thepredictedrelativebenefitintheimprovementinengagement
asproposedbytheACT-Rcognitivearchitecture[2]. eachmotherreceivesfromaninterventionversusnotreceiving
one.
ùê¥ ùëñ =ùëôùëõ(‚àëÔ∏Å (ùë°‚àíùë°‚Ä≤)‚àíùëë )+ùúá‚àëÔ∏Å (ùë§ ùëó(ùëÜùëñùëö(ùë† ùëñ,ùëó,ùë† ùë°,ùëó)‚àí1)+ùúéùúâ (1)
3 SimulationSetup
ùëó
whereùëë isadecayparameter,ùúá isascalingparameteronthe 3.1 Data
overall impact of similarity to activation,ùë§ ùëó is the importance Wetestedourapproachondatafromamaternalhealthcarepro-
(or weight) of an attribute in the similarity calculations,ùëÜùëñùëö is gramoperatedinpartnershipwithaNGO-ARMMAN[3].The
a similarity function that returns the degree of similarity for a mainobjectiveoftheprogramistoimprovethehealthoutcomes
particularattribute ùëó betweeninstanceùëñandthecurrentcontext, ofexpectantandearlymothersinvulnerablecommunitiesthrough
andùúéùúâisascalednoisedistribution.Theactivationofaninstance
thedisseminationofautomatedmessagesaboutmaternalandin-
isthenconvertedintoaretrievalprobabilityaspertheBoltzmann fancycare.Tohelpincreasetheengagementofmothersenrolled
softmaxfunction: intheprogram,ARMMANstaffcandeliveralimitednumberof
interventionsperweekintheformofvoicecallsinwhichmothers
ùëíùê¥ùëñ/ùúè
ùëÉ ùëñ = (2) havetheopportunitytoaskquestionsandinteractwithARMMAN
(cid:205) ùëóùëíùê¥ùëó/ùúè staff.
whereùúèisthetemperatureparameter.Theexpectedutilityvalue ThedatasetwascollectedbyARMMANin2022andcontainsthe
of an option (ùëé) is then computed using all retrieved instances dataof12,000mothersovera40-weekperiod.Twodatapointswere
weightedbytheirretrievalprobabilitiesthroughblendingaspro- recordedforeachmotherperweek:whetherornotshereceived
posedin[8,9]: acallfromanARMMANstaffandtheamountoftimeshespent
listeningtoautomatedhealthmessages.Thelatterisusedasaproxy
‚àëÔ∏Å
ùëâ(ùëé)= ùëÉ ùëñùë¢ ùëñ (3) for engagement level, normalized to the range [0, 1]. Although
ùëñ thedatasetalsocontainedthedemographicinformationofeach
Theagentthenchoosestheoptionwiththehighestblended mother,itwasfoundthattherewaslittleornopredictionbenefit
valueùëâ. inincorporatingdemographicvariablesasadditionalfeaturesfor
time-seriesforecasters[7].Thus,wefocussolelyonthebehavioral
2 ProposedApproach variables(presenceofinterventionandlevelofengagement).
ForanIBLmodeltobeabletopredicttheeffectofaninterven-
ConsistentwithIBLT,weaccountforengagementattheindividual
tiononamother‚Äôsengagementlevel,itneedstobetrainedona
levelsuchthateachbeneficiaryismodeledbyanIBLmodel.Each
trajectorythatincludesatleastoneintervention.However,ofthe
IBLmodelistrainedthroughmodeltracing;ateachtimestep,the
12,000mothers,only5,400mothersreceivedatleast1intervention
modelisgivenaninstancethatrepresentsthebeneficiary‚Äôsrecent
earlyonintheirprogramtenure.Wealsoassumethatmothers
engagementhistoryandcurrentengagementlevel(seeFigure1a).
receiveanintervention(ortheequivalentofanintervention)upon
Thisinstanceisthenstoredinthemodel‚Äôsmemory,andissubject
theirenrollmentintheprogram.Furthermore,becausetheamount
tothesametemporalandsimilaritymechanismsthatgovernits
oftimeneededtotrainallIBLmodelsscalesupwiththenumber
influenceonfutureestimatesofthebeneficiary‚Äôsengagementlevel.
ofmothers,wedecidedtoexploreourapproachwithasubsetof
ForIBLmodelstoactastime-seriespredictors,weuseamodel‚Äôs
210mothersoutofthe5,400motherswhoreceivedatleastone
blendedvalueofthecurrentengagementcontextasitsprediction
interventionintheiractualtrajectories.
ofthebeneficiary‚Äôsengagementlevel.EachIBLinstancehastwo
attributesthatarederivedpurelyfromthebeneficiary‚Äôsengagement
3.2 SimulationProcedure
history:thenumberoftimestepssincethelastinterventionandthe
engagementlevelontheimmediatelypriortimestep.TheIBLmodel Thefirst25weeksofeachmothers‚Äôtrajectoryweredesignatedas
determinesthesimilaritybetweenthecurrentcontextandeach trainingdata.Followingtheapproachofpreviousstudies,totrain
instanceinmemoryaccordingtothesetwoattributes,andthese theLSTMmodel,thetrainingdatawasreconstructedintosliding
similaritiesarefactoredintoaninstance‚Äôsactivationaccordingto windowsof7consecutivetimesteps.ThenanLSTMmodelwas
Equation1. trainedintheentiretrainingdataset(seeFigure1bforavisualHealthRecySys‚Äô24,October18,2024,Bari,Italy Seowetal.
Figure1:a)Transformingabeneficiary‚ÄôstrajectoryintoIBLinstancesandLSTMslidingwindows.EachIBLinstancerepresents
theengagementcontextatagiventimestepandconsistsofthreeparts;theengagementlevelontheimmediatelypriortimestep,
thenumberoftimestepssincethelastintervention,andtheengagementlevelonthecurrenttimestep.Incontrast,theLSTM
datawasconstructedbysegmentingtrajectoriesintoslidingwindowsoflength7.b)Training/testingsetupforcomparing
IBLandLSTMmethods.Differentcolorsindicatedatafromindividualbeneficiaries.UndertheIBLprocedure,oneIBLmodel
istrainedperbeneficiary.EachtrainedIBLmodelisthenusedtomakepredictionsfortheirrespectivebeneficiariesduring
testing.UndertheLSTMprocedure,oneLSTMistrainedusingdatafromallbeneficiaries.ThetrainedLSTMmodelisthenused
tomakepredictionsforallbeneficiariesduringtesting.c)LSTMtraining/testingsetupsundervariousIBL-clusters-related
conditions.Differentcolorsindicatedifferentclustertypes.NotethattheLSTMintheRandomconditionistrainedonarandom
subsetofone-thirdofthetrainingdataascomparedtotheothertrainingconditions.
descriptionofthedifferencesbetweentheIBLandLSTMtraining/ moreinstancesandbecomesmorealignedinitshistorywiththat
testingprocedure). ofthemodeledindividual.Weaccountforthisassumptioninthe
FortrainingoftheIBLmodels,anIBLmodelwastrainedper modelfittingprocedurebyweightingearlierpredictionerrors(e.g.,
mother.EachIBLmodeltracedamother‚Äôstrajectorythrougheach atweeks1and2)lessthanlaterones(e.g.,atweeks24and25)
timestepuptoweek25.Thebest-fittingprofileofattributeweights accordingtothefollowingequations:
permotherwasdeterminedbyperformingagridsearchforthe
combinationthatminimizedtheweightedsumofone-steppredic- ùëôùëúùë†ùë† =‚àëÔ∏Å ùëû ùë° ‚àóùëÜùê∏ ùë° (4)
tionerrors(loss).Thegridwasconstructedbytakingallpossible ùë°
combinationsofparametervaluesintherange(0,0)to(5,5)in
intervalsof0.5. ùëíùë°/10
IfanIBLmodelwithaspecificcombinationofattributeweights ùëû ùë° = (cid:205) ùëñùëíùë°ùëñ/10 (5)
isanadequatemodelofanindividual‚Äôsbehavioraldynamics,then
themodelshouldincreaseitspredictionaccuracyasitacquires whereùëÜùê∏ ùë° isthesquaredpredictionerrorandùëû ùë° isthenormal-
izedweightfactorforthetimestepùë°.Improvingthepredictionofindividualengagementinrecommendationsusingcognitivemodels HealthRecySys‚Äô24,October18,2024,Bari,Italy
Thetrainedmodelswerethentaskedwithgeneratingpredic-
tionsforthenext14weeks.Fortheone-steppredictiontask,the
modelsiterativelygeneratedpredictionsforthenexttimestep(i.e.,
forweek26,thenforweek27,thenforweek28,etc.).Consistent
withthefactthatthesampledmothersdidnotreceiveadditionalin-
terventionsbeyondthefirst14weeksoftheirtenure,wesimulated
thesepredictionsintheabsenceofadditionalsimulatedinterven-
tions,whichthenallowedustocomparethemodels‚Äôengagement
predictionswiththegroundtruthdata.
WecomparedtheIBL-TARIandLSTM-TARIpolicieswiththree
other baseline policies: (i) random allocation, where each bene-
ficiaryhasthesameprobabilityofreceivinganintervention,(ii)
round-robinallocation,whereabeneficiarythatreceivedaninter-
ventionwillnotreceiveanotheruntilallotherbeneficiarieshave
alsoreceivedanintervention,and(iii)nointervention,whereno
Figure 2: Next-step prediction error per testing time step
interventionsaredelivered.ConsistentwithARMMAN‚Äôslimited
(smallerisbetter).N=210.ThepersonalizedIBLmodelscon-
resources,allpoliciesarealloweda3%budget(exceptthenointer-
sistentlyachievesloweraveragepredictionerror(0.23across
ventionpolicy),whichcorrespondstoallocatinginterventionsto6
alltimesteps)ascomparedtotheLSTMmodel(0.32),which
beneficiaries.
translatestoa29%reductioninerror.
Inordertosimulatetheeffectofaninterventiononabenefi-
ciary‚Äôsengagementlevelwhentheydidnotreceiveoneinreality,it
wasnecessarytodevelopacounterfactualgenerator.Wefollowed
expectations,theIBL-TARIpolicydoesnotoutperformtheLSTM-
theapproachadoptedinpreviousstudiesandtrainedaseparate
TARIpolicyonthisperformancemetric.
LSTMmodelontrajectoriesfromtheentiredataset(approximately
12000beneficiaries),whichisfarlargerthanthesubsetusedforour
4.3 ElucidatingindividualdifferenceswithIBL
policysimulations.Thiscounterfactualgeneratorwasusedonly
parameters
whenamother‚Äôssimulatedtrajectorydeviatedfromherground-
truthtrajectory(i.e.,receivedasimulatedinterventionwhenshedid Beyondmoreaccuratepredictionsofengagement,anotheradvan-
notreceiveoneinrealityornotreceivingasimulatedintervention tage of the proposed IBL approach over more general TSFs (as
whenshedidreceiveoneinreality). exemplifiedbytheLSTMapproach)istheabilitytoidentifyindivid-
ualdifferencesinbeneficiaries‚Äôbehavioralcharacteristics.Because
4 Results eachbeneficiaryismodeledbyaseparateIBLmodel,theparameter
4.1 Predictingnext-stepengagementlevels valuesofeachmodelprovidepotentialinsightsintohowbeneficia-
riesdifferfromeachotherintheirengagementandintervention
Webeginbypresentingtheresultsdirectlycomparingtheperfor-
dynamics.
manceofthepersonalizedIBLmodelsandtheLSTMmodelonthe
Specifically,theattributeweightsofeachmother‚ÄôsIBLmodel
next-steppredictiontask.Figure2showsthepredictionerrorofthe
trainedondatafromthefirst25weeksofhertenurecanbein-
twoapproachesduringeachofthe14weeksinthetestingperiod.
terpretedasmeasuresofhowreliablyherengagementchangesin
Clearly,IBLmodelsconsistentlyachievelowerpredictionerrors
responsetoanintervention(intervention-sensitivity)andhowcon-
thanLSTM.About10%lesserrorsonaverage(0.23onaverage)
sistentlyherengagementchangesbetweentimesteps(transition-
comparedtotheLSTMmodel(0.32onaverage).
consistency).
Figure3showsthedistributionofmothersaccordingtotheir
4.2 Usingpredictionstoinformintervention
attributesweightprofiles.Fromthevisualinspectionofthedata,
allocation
thereappeartobethreetypesofmothers.Weconfirmedthatthe
Giventhisresult,wehypothesizedthattheTARIalgorithmwould optimalnumberofclustersisbetween3to4clustersusingmultiple
benefitfromusingIBLmodelstofilltheroleofitstime-seriesfore- measuresofclustergoodness(silhouette:4,within-sum-of-squares:
caster.Moreaccuratenext-steppredictionsshouldleadtoamore 4,gapstatistic:3).Forinterpretability,subsequentanalyzesassume
accuratepredictionoftherelativebenefitofinterveningversus thatmothersarepartitionedintothreeclusters.
notinterveningonamother,andthusallowforamoreaccurate Eachclusterwaslabeledaccordingtoitsdefiningcharacteristics.
rankingofmothers.Figure7(inAppendix)showsthepercentage Intervention-sensitivemothers(ùëÅ =62)arethosecharacterizedby
ofmotherswhohaveanengagementlevelof0.25andaboveduring ahighinterventionlagweight;giventhatsuchamotherisùë° time
eachtesttimestepfollowingthevariousinterventionallocation stepsawayfromhermostrecentintervention,itislikelythather
policies.TheLSTM-TARIpolicyoutperformsallotherpolicies,par- engagementlevelwillbesimilartoherengagementlevelwhen
ticularlylateroninthetestingperiod.Theaveragepercentageof shewasùë° timestepsawayfrompreviousinterventions.Transition-
engagedmothersacrosstestingtimestepsforthevariouspolicies consistentmothers(ùëÅ =66)arethosewhoarecharacterizedbya
areasfollows:IBL-TARI(55.58%);Round-robin(55.65%);Random highpreviousengagementweight;Sinceùë• wastheengagement
(54.29%);LSTM-TARI(61.05%);Control(46.22%).Contrarytoour levelofsuchamotherintheimmediatelyprevioustimestep,itHealthRecySys‚Äô24,October18,2024,Bari,Italy Seowetal.
islikelythathercurrentengagementlevelwillbesimilartoher ‚Ä¢ Outside-cluster:OneLSTMtrainedoneachcluster;pre-
engagementlevelinthetimestepfollowingapreviousstatewhen dictfortestmothersfromadifferentcluster.Asthereare
herengagementlevelwassimilartoùë•.State-stablemothers(ùëÅ=82) 3clusters,werepeatthismethodtoobtainpredictionson
arethosecharacterizedbyrelativelylowvaluesinbothdimensions; theothernon-trainingclusterandrecordtheaveragepre-
giventhatùë• wasthelevelofengagementofsuchamotherinthe dictionerrorofthetwosimulations.Forinstance,predic-
immediatelyprecedingtimestep,itscurrentlevelofengagementis tionaccuracyforthestate-stabletestingsetistheaverage
likelytobesimilartoùë•. ofthepredictionaccuracyoftheLSTMmodeltrainedon
thetransition-consistenttrainingsetandthatofthemodel
trainedontheintervention-sensitivetrainingset.
‚Ä¢ Random:OneLSTMtrainedonarandomsubsetofone-
thirdofthetrainingset(ùëÅ =35);predictforalltestmothers
Figure3:Distributionofattributeweightprofiles.Eachdot
representstheIBLmodelpersonalizedtoaparticularbenefi-
ciary(mother).Pointsareslightlyjitteredtobettervisualize
density.Lighterpointsindicatetrainingsetmotherswhile
darkerpointsindicatetestingsetmothers.Beneficiariesare
clusteredinto3clustersaccordingtoak-meansalgorithm. Figure4:Next-steppredictionerrorpertestingtimestepfor
Largercirclesoutlinedinblackindicateclustercentroids. thevariousLSTMtraining-testingmethods.Notethatthe
performancefortheOutside-clustermethodisanaverage
oftheperformanceoftwoLSTMmodels(e.g.,forastate-
4.3.1 TestingthegeneralizabilityofindividualdifferencesinIBLat-
stablemother,theaveragepredictionerrorofaLSTMtrained
tributeweights. Thepreviousresultsshowedthatindividualmoth-
onintervention-sensitivemothersandaLSTMtrainedon
ersareassociatedwithdifferentweightprofilesoftheattributes
transition-consistentmothers.
oftheIBLinstance.However,itremainsunclearwhetherthese
weightsaregenerallymeaningful;thatis,iftheydocaptureindivid-
ualdifferencesthatarepredictiveofbehavioraldynamicsbeyondan
IBLmodelingcontext.Specifically,iftheseattributeweightsreflect
underlyingindividualdifferencesinengagementandintervention
dynamics,thenwewouldexpectothermodelingapproachesthat
accountfortheseattributeweightstoperformbetterthanthose
thatdonot.
WetestedthishypothesisbytrainingandtestingLSTMmodels
withvariouscluster-relatedsamples.Usingtheclusterassignments
derivedabove,werandomlyspliteachclusterinhalftoconstructa
trainingandatestingset.Forallmethods,thetaskistopredictthe
next-stateengagementofthetestingsetduringthetestingperiod
(i.e.,thelast14weeks).Weexaminedthefollowingmethods(see1c
foravisualdescription):
‚Ä¢ Entire:OneLSTMtrainedonalltrainingmothers;predict
foralltestmothers.
‚Ä¢ Within-cluster:OneLSTMtrainedoneachcluster;pre-
Figure5:Comparisonofpredictionerrorspertestingmother
dictfortestmothersintheirrespectivetrainingcluster.For
betweenEntireandWithin-clustermethods.Bluelinesin-
instance,theLSTMtrainedonthestate-stabletrainingset
dicatemotherswhoare(onaverage)betterpredictedbythe
wouldbetestedonthestate-stabletestingset.Wehypothe-
Within-clustermethodwhereasredlinesindicatethosebet-
sizethatthismethodshouldyieldthemostaccuratepredic-
terpredictedbytheEntiremethod.
tionsgiventheinformativenessoftheidentifiedIBLclusters.Improvingthepredictionofindividualengagementinrecommendationsusingcognitivemodels HealthRecySys‚Äô24,October18,2024,Bari,Italy
Figure4showstheaveragepredictionerrorforthevariousmeth- memoryanddecisionswouldsimultaneouslyprovidemoreaccu-
ods.Insupportofthegeneralizabilityoftheclustersderivedfrom ratepredictionsofbeneficiaries‚Äôengagementdynamicsandmore
IBLattributeweights,LSTMsthataretrainedandtestedondif- meaningfulindividualdifferencesthatcanalsobeleveragedby
ferentclusters(Outside-cluster)andaLSTMtrainedonarandom otherpredictionmethods.
sample(Random)performrelativelyworsecomparedtotheLSTMs Wetestedourmethodonreal-worldengagementdatafrommoth-
thatweretrainedandtestedonthesameclusters(Within). ersenrolledinamaternalhealthprogram,anddemonstratedthatit
ComparedtotheEntiremethod,theWithin-clustermethoddoes resultsinhighernext-steppredictionaccuracycomparedtoexisting
notappeartoprovideanyadditionalbenefitinaverageprediction time-seriesmethods,suchasLSTMmodels.ThepersonalizedIBL
accuracy,whichmightleadonetofavorthesimplerapproach(i.e., modelsrevealedthatmotherscouldbeclusteredintothreetypes
trainingonevs.threemodels).However,asFigure5shows,the basedontheirIBLattributeweights,specifically,howfluctuations
Within-clustermethodisthemoreaccurateonefortwo-thirdsof intheirbehaviorscouldbeattributedtointervention-sensitivity
themothers(Within:70vs.Entire:35). andtransition-consistency.Theseclusterswerealsoshowntoim-
Follow-upexploratoryanalyseswiththeWithin-clustermethod provethepredictionaccuracyofothertime-seriesmodels;LSTMs
suggestthatmothersclosertotheircluster‚Äôscentroidarebetter trainedandtestedonwithin-clusterdataoutperformedallother
predictedbytheWithin-clustermethodascomparedtotheEntire LSTMtrainingmethods.
method.Threebinomialregressionmodelswereconstructed,one Futureworkcouldexplorepersonalizinginterventionsandinter-
foreachcluster;foragivenmother,theEuclideandistancebetween ventionschedulesbasedontheseidentifiedindividualdifferences
herIBLmodel‚Äôsattributeweightsandtheircluster‚Äôscentroid(dist) inbehavioralcharacteristics.Forexample,intervention-sensitive
wasusedtopredictthemethodthatresultedinalowerprediction beneficiariescouldbeallocatedmorefrequentbutshortercalls,
error. Although none of the effects were significant due to the whiletransition-consistentbeneficiariescouldbeallocatedfewer
imbalancedandsmallclasses,forState-stable(ùõΩ ùëëùëñùë†ùë° =‚àí0.8637)and butlongercallstoensurethattheirengagementlevelismaximized
Transition-consistentmothers(ùõΩ ùëëùëñùë†ùë° = ‚àí1.235),thefurtherthey oneachcall.
werefromtheclustercentroid,thelesslikelytheywouldbebetter Onelimitationofthisworkisthelackofanunbiasedcounterfac-
predictedbytheWithin-clustermethod(seeFigure6). tualgeneratortosimulatetheeffectofrecommendedinterventions;
inourwork,weusedaLSTMmodeltrainedonthefulldataset
togeneratecounterfactuals.Itislikelythatthesequenceofen-
gagementstatesgeneratedbythisLSTMmodeldoesnotreflect
thetrueengagementdynamicsoftheactualmothers,andthatthe
generatedcounterfactualstateswouldbebetterpredictedbyan-
otherLSTMmodelduetothesimilaritiesinmodelarchitecture.
ThispossiblyexplainstheapparentcontradictionbetweentheIBL
modelsoutperformingtheLSTMmodelsonpredictionaccuracy
(whichdoesnotinvolvecounterfactuals)butunderperformingon
numberofengagedmothers(whichrequiresgeneratingcounter-
factuals).Futureworkshouldprioritizetestingourmethodwith
otherdatasets,particularlywithaparadigmwheretheeffectsof
recommendedinterventionsonparticipants‚Äôtaskengagementcan
be experimentally measured, rather than relying on potentially
biasedcounterfactuals.
Anotherlimitationisthatourmethodcurrentlymakespredic-
Figure 6: Probabilities of the Within-cluster vs. Entire
tionsonlyfromthe26thweekofamother‚Äôspregnancyonward,
methodresultinginalowerpredictionerror.Ifamother
asthefirst25weeksareneededtotrainandpersonalizetheIBL
isbetterpredictedbytheWithin-clustermethod,sheisas-
model.Apossibleextensionofthisworkcouldinvolveexploring
signedaprobabilityof1.Linesshowpredictionsbybinomial
hybridmethods,suchasinitiallyrelyingonpredictionsfromother
regressionmodels,andshadedareasreflectthe95%CIs.
trainedIBLmodelsandgraduallytransitioningtothepersonalized
model.
5 ConclusionsandFuturework Acknowledgments
Inprogramswithlimitedresourcestoprovideinterventionstoa ThisresearchwassupportedbytheAIResearchInstitutesProgram
largenumberofbeneficiaries,akeyquestionistodecidewhich fundedbytheNationalScienceFoundationunderAIInstitutefor
subsetofbeneficiariesshouldreceiveanintervention.Inthispaper, SocietalDecisionMaking(AI-SDM),AwardNo.2229881
wedevelopanovelapproachthatusescomputationalcognitive
modelsbasedonInstance-basedLearningTheory[8,9]tomodel References
thehumandynamictransitionsofbeingengagedordisengaged [1] SakiAmagai,SarahPila,AaronJKaat,CindyJNowinski,andRichardCGershon.
inaprogram.Giventhenon-Markoviannatureofthetransitions 2022.Challengesinparticipantengagementandretentionusingmobilehealth
apps:literaturereview.JournalofmedicalInternetresearch24,4(2022),e35120.
ofabeneficiarybetweenstates[7],acognitivealgorithmthatre-
[2] JohnRAndersonandChristianJLebiere.2014.Theatomiccomponentsofthought.
flectstheeffectsoftime,attention,andcontextsimilarityonhuman PsychologyPress.HealthRecySys‚Äô24,October18,2024,Bari,Italy Seowetal.
A Real-worldARMMANDataset
[3] ARMMAN.2024. mMitra-ARMMAN-HelpingMothersandChildren. https:
//armman.org/mmitra/
A.1 SecondaryAnalysis
[4] TurgayAyer,CanZhang,AnthonyBonifonte,AnneCSpaulding,andJagpreet
Chhatwal.2019. PrioritizinghepatitisCtreatmentinUSprisons. Operations
Ourexperimentfallsintothecategoryofsecondaryanalysisof
Research67,3(2019),853‚Äì873.
[5] NikhilBehari,EdwinZhang,YunfanZhao,AparnaTaneja,DheerajNagaraj,and the data shared by ARMMAN. This paper does not involve the
MilindTambe.2024.ADecision-LanguageModel(DLM)forDynamicRestless deploymentoftheproposedalgorithmoranyotherbaselinesto
Multi-ArmedBanditTasksinPublicHealth. arXivpreprintarXiv:2402.14807
the service call program. As noted earlier, the experiments are
(2024).
[6] ErinHBugbeeandCleotildeGonzalez.2022.Makingpredictionswithoutdata: secondaryanalysiswithapprovalfromtheARMMANethicsboard.
Howaninstance-basedlearningmodelpredictssequentialdecisionsinthebal-
loonanalogrisktask.InProceedingsoftheannualmeetingofthecognitivescience
A.2 ConsentandDataUsage
society,Vol.44.
[7] PanayiotisDanassis,ShresthVerma,JacksonAKillian,AparnaTaneja,andMilind ConsentisobtainedfromeverybeneficiaryenrollingintheNGO‚Äôs
Tambe.2023.Limitedresourceallocationinanon-Markovianworld:thecaseof
maternalandchildhealthcare.arXivpreprintarXiv:2305.12640(2023). mobilehealthprogram.Thedatacollectedthroughtheprogramis
[8] CleotildeGonzalezandVarunDutt.2011.Instance-basedlearning:integrating ownedbytheNGOandonlytheNGOisallowedtosharedata.In
samplingandrepeateddecisionsfromexperience.Psychologicalreview118,4
ourexperiments,weuseanonymizedcalllistenershiplogstocal-
(2011),523.
[9] CleotildeGonzalez,JavierFLerch,andChristianLebiere.2003.Instance-based culateempiricaltransitionprobabilities.Nopersonallyidentifiable
learningindynamicdecisionmaking.CognitiveScience27,4(2003),591‚Äì635. information(PII)isavailabletous.Thedataexchangeandusage
[10] SeppHochreiterandJ√ºrgenSchmidhuber.1997.Longshort-termmemory.Neural
wereregulatedbyclearlydefinedexchangeprotocolsincluding
computation9,8(1997),1735‚Äì1780.
[11] NatashaJaques,AngelikiLazaridou,EdwardHughes,CaglarGulcehre,Pedro anonymization,read-accessonlytoresearchers,restricteduseof
Ortega,DJStrouse,JoelZLeibo,andNandoDeFreitas.2019.Socialinfluenceas thedataforresearchpurposesonly,andapprovalbyARMMAN‚Äôs
intrinsicmotivationformulti-agentdeepreinforcementlearning.InInternational
conferenceonmachinelearning.PMLR,3040‚Äì3049. ethicsreviewcommittee.
[12] JacksonAKillian,ArpitaBiswas,LilyXu,ShresthVerma,VineetNair,Aparna
Taneja,AparnaHegde,NehaMadhiwalla,PaulaRodriguezDiaz,SonjaJohnson- A.3 InterventionsinARMMANdata
Yu,etal.2023.Robustplanningoverrestlessgroups:engagementinterventionsfor
alarge-scalematernaltelehealthprogram.InProceedingsoftheAAAIConference TheinterventionsinARMMANdataarechosenbasedonrestless
onArtificialIntelligence,Vol.37.14295‚Äì14303.
multi-armbandit(RMAB)algorithms[15,25].RMABsareamodel
[13] ArshikaLalan,ShresthVerma,PaulaRodriguezDiaz,PanayiotisDanassis,Amrita
Mahale,KumarMadhuSudan,AparnaHegde,MilindTambe,andAparnaTaneja. for sequentially distributing scarce resources to a set of agents
2024.ImprovingHealthInformationAccessintheWorld‚ÄôsLargestMaternalMo- [11,22,23].Concretely,wehaveasetofarmsandalimitedbudget
bileHealthProgramviaBanditAlgorithms.InProceedingsoftheAAAIConference
andfacethequestionofdecidingwhicharmstopullineachround.
onArtificialIntelligence,Vol.38.22913‚Äì22919.
[14] ElliotLee,MarielSLavieri,andMichaelVolk.2019. Optimalscreeningfor ThestateofarmsevolvesaccordingtoaMarkovDecisionProcess
hepatocellularcarcinoma:Arestlessbanditmodel. Manufacturing&Service wheretransitionprobabilitiesdependonwhetherthearmispulled
OperationsManagement21,1(2019),198‚Äì212.
[15] AdityaMate,LovishMadaan,AparnaTaneja,NehaMadhiwalla,ShresthVerma, inthisstep.RMABshaveabroadrangeofapplications,including
GargiSingh,AparnaHegde,PradeepVarakantham,andMilindTambe.2022. resourceallocationinanti-poaching,machinemaintenance,cellular
Fieldstudyindeployingrestlessmulti-armedbandits:Assistingnon-profitsin
networks[16,24].RMABshaveespeciallybeusedinhealthcare
improvingmaternalandchildhealth.InProceedingsoftheAAAIConferenceon
ArtificialIntelligence,Vol.36.12017‚Äì12025. settingssuchascallschedulinginamaternalandchildcareprogram
[16] NavikkumarModi,PhilippeMary,andChristopheMoy.2019.Transferrestless [5, 21], screening patients at risk of cancer [14], and allocating
multi-armedbanditpolicyforenergy-efficientheterogeneouscellularnetwork.
hepatitisCtreatment[4].
EURASIPJournalonAdvancesinSignalProcessing2019,1(2019),1‚Äì19.
[17] ThuyNgocNguyenandCleotildeGonzalez.2022.Theoryofmindfromobser-
vationincognitivemodelsandhumans.Topicsincognitivescience14,4(2022),
665‚Äì686.
[18] SarahONogueira,AnnMcNeill,MarcelaFu,ChristinaNKyriakos,UteMons,
EsteveFern√°ndez,WitoldAZato≈Ñski,AntigonaCTrofor,TiborDemjen,Yannis
Tountas,etal.2018.Impactofanti-smokingadvertisingonhealth-riskknowledge
andquitattemptsacross6EuropeancountriesfromtheEUREST-PLUSITC
EuropeSurvey.TobaccoInducedDiseases16(2018).
[19] SouhaibBenTaieb,RobJHyndman,etal.2012.Recursiveanddirectmulti-step
forecasting:thebestofbothworlds.Vol.19. DepartmentofEconometricsand
BusinessStatistics,MonashUniv.
[20] AshishVaswani,NoamShazeer,NikiParmar,JakobUszkoreit,LlionJones,
AidanNGomez,≈ÅukaszKaiser,andIlliaPolosukhin.2017. Attentionisall
youneed.Advancesinneuralinformationprocessingsystems30(2017).
[21] ShresthVerma,YunfanZhao,SanketShah,NiclasBoehmer,AparnaTaneja,
andMilindTambe.2024.GroupFairnessinPredict-Then-OptimizeSettingsfor
RestlessBandits.The40thConferenceonUncertaintyinArtificialIntelligence.
[22] PeterWhittle.1988. Restlessbandits:Activityallocationinachangingworld.
Journalofappliedprobability25,A(1988),287‚Äì298.
[23] GuojunXiongandJianLi.2023. Finite-TimeAnalysisofWhittleIndexbased
Q-LearningforRestlessMulti-ArmedBanditswithNeuralNetworkFunction
Approximation.InThirty-seventhConferenceonNeuralInformationProcessing
Figure7:Percentageofmothersengagedintheprogramper
Systems.
[24] YunfanZhao,NikhilBehari,EdwardHughes,EdwinZhang,DheerajNagaraj,
testingtimestep.ùëÅ =210,budgetùëò=6.
KarlTuyls,AparnaTaneja,andMilindTambe.2023.TowardsZeroShotLearning
inRestlessMulti-armedBandits.AAMAS(2023).
[25] YunfanZhao,TonghanWang,DheerajNagaraj,AparnaTaneja,andMilindTambe.
2024.TheBanditWhisperer:CommunicationLearningforRestlessBandits.arXiv
preprintarXiv:2408.05686(2024).
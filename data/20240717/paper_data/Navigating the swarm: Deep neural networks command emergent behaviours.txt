Navigating the swarm: Deep neural networks command emergent behaviours
Authors:
Dongjo Kim1, Jeongsu Lee2*, Ho-Young Kim1,3*
Affiliations:
1 Department of Mechanical Engineering, Seoul National University, Seoul 08826, Korea
2 Department of Mechanical, Smart, and Industrial Engineering, Gachon University, Seongnam
13120, Korea
3 Institute of Advanced Machines and Design, Seoul National University, Seoul, 08826, Korea
* Corresponding authors. Email: leejeongsu@gachon.ac.kr; hyk@snu.ac.kr
SUMMARY
Interacting individuals in complex systems often give rise to coherent motion exhibiting
coordinated global structures1,2. Such phenomena are ubiquitously observed in nature, from
cell migration3,4, bacterial swarms5-7, animal and insect groups8-23, and even human societies24.
Primary mechanisms responsible for the emergence of collective behavior have been
extensively identified, including local alignments based on average or relative velocity5,12-
17,25,26, non-local pairwise repulsive-attractive interactions such as distance-based potentials27-
29, interplay between local and non-local interactions8,21-24,30-32, and cognitive-based
inhomogeneous interactions33,34. However, discovering how to adapt these mechanisms to
modulate emergent behaviours remains elusive. Here, we demonstrate that it is possible to
generate coordinated structures in collective behavior at desired moments with intended global
patterns by fine-tuning an inter-agent interaction rule. Our strategy employs deep neural
networks, obeying the laws of dynamics, to find interaction rules that command desired
collective structures, including rings, mills, clumps, and flocks. The decomposition of
interaction rules into distancing and aligning forces, expressed by polynomial series, facilitates
the training of neural networks to propose desired interaction models. Presented examples
include altering the average radius and size of clusters in vortical swarms, timing of transitions
from random to ordered states, and continuously shifting between typical modes of collective
motions. This strategy can even be leveraged to superimpose collective modes, resulting in
hitherto unexplored but highly practical hybrid collective patterns, such as protective security
formations. Our findings reveal innovative strategies for creating and controlling collective
motion, paving the way for new applications in robotic swarm operations35,36, active matter
organisation, and for the uncovering of obscure interaction rules in biological systems.TEXT
Individuals in a group influence each other constantly. Collective motion emerges as a
reflection of group-level consensus from individual interactions in the absence of centralized
decision-making as seen in school of fish, flock of birds, and glow of fireflies (Fig. 1a).
Elucidating the fundamental principles underlying the attainment of global consensus through
the intricate network of individual interactions has long been an active area of inquiry in the
study of collective motion5,7-10,12-16,21-34,37-42. Elementary interaction mechanisms that promote
these collective behaviours include distancing in pairwise interactions based on relative
positions27-29 and aligning moving direction to an average value within an interaction range5,12-
17,25,26. Despite our growing understanding of the fundamental principles governing the
emergence of collective motion in complex systems, our ability to control these behaviours by
adjusting individual-level interactions still falls short of our aspirations. The capability to
actively manage these emergent behaviours has wide-ranging implications, including the
development of decentralised control systems in robotic swarms, synchronization of facilities
such as energy plants, and infrastructure management in mega-cities, such as traffic flow
controls.
This study seeks a strategy to actively control collective behaviours of agents following
physical rules by manipulating individual-level interaction rules. Our approach starts with a
reciprocal interaction model that accounts for both distancing and aligning forces in agent
interactions, represented as . These forces are based on the
relative distance, r , and rela(cid:1) t(cid:2) i(cid:3) ve= v(cid:5) e(cid:6) lo(cid:7)(cid:2) c(cid:3) i(cid:8) ty(cid:9) ,(cid:10) (cid:11)v(cid:12) + , b(cid:14) et∘ w(cid:16) ee(cid:6) n(cid:7)(cid:2) (cid:3) i(cid:8) n(cid:9) te(cid:17) r(cid:11)(cid:12)acting agents indexed as i and j.
ij ij
Here, F represents the pairwise interaction force, and and are unit vectors pointing
ij
in the directions of the relative distance and velocity(cid:9) , (cid:10)(cid:11)r(cid:12)especti(cid:9) v(cid:17) e(cid:11)l(cid:12)y. The functions f and g
respectively describe the coefficients of distancing and aligning forces based on absolute
distance r = |r |. Additionally, signifies a cut-off operator that nullifies output beyond a
ij ij
specific interaction range r , en(cid:14)su∘ring that alignments only occur within physically realistic
c
limits. In this description, our primary goal is to propose a strategy for determining the mapping
functions f and g that govern the entire agent group to promote desired collective patterns.
Discovering the functional relationships for f and g requires consideration of both the
physical laws that describe dynamic behaviours and the geometric parameters that characterize
collective patterns. Physics-informed neural networks43-45 enable the exploration of a solution
curve that adheres to both physical rules and data-driven features by integrating these elements
into the loss function. Inspired by this concept, we employed neural networks to express the
positions (x and y) of interacting agents over time t for i-th agent. We then integrate the
i i
equation of motion (Eq. 1 in Methods) of interacting agents into the loss function, drawing on
the self-propelled particles model4,5,12-17,19,21,23-25,27,28,31,33, as depicted in Fig. 1b.
Next, the coefficient functions f and g are represented using a polynomial series:
and . These polynomial representations provide the
fl(cid:5) ex((cid:7) ib(cid:2)(cid:3)i) lit=
y
(cid:23)(cid:24) (cid:26)(cid:24)
n∑ e(cid:22)e(cid:21) de(cid:22)d(cid:7)(cid:2) (cid:3)to accur(cid:16) at( e(cid:7) l(cid:2)y(cid:3) ) m= od∑ e(cid:22)l (cid:25) th(cid:22)e(cid:7) (cid:2)r(cid:3)andom functional and facilitate neural network training. Thecoefficients, a and b , along with the exponents of the polynomials, n and m , become
k k k k
trainable parameters within the neural networks. Therefore, the neural networks in our study
are expressed as (x, y) = NN(t | a , b , n , m , θ), where θ represents the trainable parameters
i i k k k k
in neural network layers. The detailed description is appended in Methods.
The neural networks are trained from random initial states to generate desired collective
patterns at specified moments, as depicted in Fig. 1c. Simulations of self-propelled particle
(SPP) dynamics are conducted to verify that the proposed interaction force model indeed leads
to the emergence of collective motion. It is observed that a force model with randomly
initialized a , b , n and m fails to produce coherent motion, leading to divergence among the
k k k k
agents. Training is accomplished by incorporating both geometric and dynamic characteristics
of the target collective patterns into the loss function. The chosen target patterns are derived
from canonical collective motions identified in previous studies1,12-18,21,25-28,32,34,37, namely
ordered state, ring, clumps, mill and flock as illustrated in Fig. 1d. The characteristic equations
for the geometry and dynamics of each collective motion, which are integrated into the loss
function, are summarized in Methods section and Extended Data Tables 1, 2.
Figure 2a illustrates the step-by-step procedure for modulating emergent behaviours. Initially,
we select the target collective motion and then determine the corresponding force model, which
may involve aligning, distancing, or a combination of these forces. The aligning force
facilitates the emergence of a globally ordered state from a disordered group of active
materials1,25,26 whereas the distancing force promotes the formation of collective swarms,
,
which are categorized as rings, clumps, and mills27,28,32,37. In addition, the flocking behaviour,
characterized by the exploration of unbounded regions similar to formation flight, is induced
by the combination of aligning and distancing forces. Subsequently, we incorporate the desired
characteristics of the collective motion—such as the timing of the onset of the ordered state,
rotational direction, and geometric features of the swarm—into the loss function of the neural
networks. The neural networks then identify the force model best suited to achieve the desired
collective pattern.
We first present the emergence of an ordered state from a completely disordered state,
initiated by localized alignments in scenarios where f = 0, as depicted in Fig. 2b and
supplementary video 1. Previous studies have demonstrated that localized aligning actions can
induce a globally ordered state, as observed in ferromagnetic colloids46, vibrating granules47,48,
and liquid crystals49,50. This experiment aims to show that our strategy can directly control the
timing of the transition to a globally ordered state, defined as the time for order parameter O=
(1/N)|∑v/v| to reach 0.9. We examined the movement of 40 SPPs within periodic boundaries
i i i
as a model for phase transition1,25. Two distinct successful cases are presented: 1) controlling
the timing to achieve a globally ordered state at a fixed interaction range, and 2) synchronizing
the duration to reach the ordered state across cases with varying interaction ranges (Fig. 2c, d).
Our strategy identifies an adjustable input parameter of timing for the neural networks,
exhibiting a linear correlation with the time required to transition from a disordered to an
ordered state (Fig. 2c, top). Moreover, we can fine-tune the timing for the appearance of the
ordered state to achieve precision within 4.7% error with average value 17.8 across variousinteraction ranges (Fig. 2c, bottom), and confirmed the robustness of the trained interaction
models' ability to modulate ordered state by conducting 100 trials under random initial
condition, and noise; see Extended Data Fig. 1.
Next, the collective patterns that emerge from distancing forces in scenarios where g = 0 are
examined, as detailed in Fig. 3a-c and supplementary video 2-6. These patterns correspond to
ring, clump, and mill formations. The emergence of each collective pattern is characterized by
a threshold distance where the attraction force transitions to repulsion force. For the ring pattern,
only attraction forces are present, as indicated by the negative values in the f(r ) plots of Fig.
ij
3a. The magnitude of the attraction force increases with the distance and decreases with the
desired pattern radius. The clump and mill patterns emerge from a combination of attraction
and repulsion in distancing forces, each with a distinct critical transition point (Fig. 3b, c). The
relative scale of repulsion versus attraction is known to trigger the transition from clumps to
mill patterns28,37, corroborating the predictions of our proposed neural networks. These
experiments confirm the efficacy of the proposed strategy in modulating emergent behaviours
resulting from both aligning actions and distancing forces.
The proposed strategy can not only give rise to the desired collective pattern but also controls
its geometric features. As shown in Fig. 3a-c, the global radius of swirling patterns, denoted as
R, has been effectively manipulated to the desired size. The plot of the global radius versus the
desired radius confirms a clear match for every collective pattern considered (ring, clumps, and
mill). Furthermore, the local geometric and dynamic features can also be controlled, as
demonstrated in Fig. 3b, c. For instance, the size of clusters ε in the clumps can be
independently controlled by incorporating the standard deviation of the radius distribution into
the neural networks' control parameters (Fig. 3b). The neural networks have effectively
demonstrated the ability to modulate the size of clusters by tuning the relative scale of attraction
to repulsive forces, as illustrated in the f(r ) plots.
ij
For the mill pattern, the rotational direction could serve as an additional desired input. The
subtle changes in force model enable a single mill characterized by unidirectional rotation, as
depicted in Fig. 3c. The motion of SPPs begins from initial random states, balanced in total
momentum, and is conducted under the influence of pairwise interactions that conserve this
total momentum. Therefore, it is remarkable that the proposed strategy guides force model to
achieve biased rotational momentum, resulting from the internal acceleration and deceleration
of each agent.
The combination of distancing and aligning forces induces a flocking pattern in agents
moving in unbounded environments, as depicted in Fig. 3d and supplementary video 7. In our
study, we distinguish 'flock' from an 'ordered state.' Flock refers to an animal swarm model that
explores open environments with a coherent geometric feature, whereas the ordered state
represents the collective pattern of moving particles in a localized area of active matter,
modeled with periodic boundaries. An aligning force effectively directs the swarm towards the
same direction, resulting in a flocking pattern. A significant finding of this study is the ability
of neural networks to determine a control strategy for adjusting the extent of spatial spread.
The networks use the transition point from attraction to repulsion to precisely control thegeometric size of the entire swarm in space, as illustrated in the coefficient of force plots in Fig.
3d. This control is executed by managing the maximum spatial extent of the swarm relative to
its centre of mass, which is integrated into the loss function of the neural networks. Repeated
experiments starting from random initial conditions confirm that the extent of spatial spread
closely aligns with the desired swarm size, as shown in Fig. 3d. These experiments have
confirmed that the proposed strategy could accurately modulate not only the appearance but
also the specific geometric features of desired collective patterns.
We extend our strategy to actively leverage collective patterns in realizing hitherto
unexplored collective systems, as illustrated in exemplary cases of Fig. 4. The first scenario in
Fig. 4a involves continuous transitions between different collective modes to demonstrate a
model of robotic swarms performing various functions via collective behaviors. The simulation
reveals that the SPPs continuously alter global patterns by adjusting interaction force models
under the guidance of neural networks. Initially, a scenario describing the desired collective
patterns at specific temporal moments are provided to the neural networks. The neural networks
then prompt interaction models for the corresponding collective patterns, having been trained
on the geometric characteristics of the desired collective motions. Observations of the order
parameter, normalized angular momentum O = (1/N)∑(r×v/rv), and normalized absolute
r i i i i i
angular momentum O = (1/N)∑|r×v/rv| confirm the emergence of the desired collective
r,abs i i i i i
patterns at the corresponding moments, namely a continuous shift from an initial random state
to clumps, rings, mills, flock, and finally to a single mill. This experiment suggests that our
strategy can dynamically control swarming behaviours by tuning the interaction rules of
interacting agents.
The second scenario, depicted in Fig. 4b, explores the superimposition of distinct collective
patterns to synthesize novel hybrid collective dynamics. The SPPs are divided into two groups,
with each group adhering to a different interaction model specific to their assigned collective
pattern. This process leads to non-homogeneous interactions. Despite the non-homogeneous
nature of the interaction mechanism, each SPP interacts with every other agent, irrespective of
group classification. In other words, each individual agent decides its motion based on the
information from every other recognizable agent, without regard to group classifications.
Consequently, the interactions become non-reciprocal, leading to non-conservative interaction
dynamics (refer to Eq. 5 in Methods section).
Several representative cases of superimposed collective patterns are displayed in Fig. 4b. We
first synthesized a dual-ring (ⅰ) and dual-clumps (ⅱ) mode characterized by identical collective
patterns, yet with two distinct geometrical features. These structures, while having different
radii, share an identical centre. Each ring or clumps rotates independently but together they
form a globally coherent pattern. Moreover, our strategy facilitates the combination of different
collective modes, as demonstrated by the coexistence of ring and mill patterns. These patterns
are controlled to share the same centre but maintain different global radii, resulting in a
coherent pattern where the ring encircles the milling group from the outside (ⅶ). Such
collective patterns can be utilized to enable swarming agents to function collaboratively, for
instance, one group protecting another or encircling a target group. Additionally, thesynthesized collective patterns can be used to navigate an open environment in specific hybrid
formation. The combination of flock and mill patterns (ⅳ, ⅷ) demonstrates a reconnaissance
formation, effectively guarding a critical group by encirclement with another group.
This study presents a unique strategy to precisely control the collective behaviour of complex
systems. By integrating distancing and aligning forces into the interaction force model, we
enable neural networks to identify individual-level interaction models that generate desired
collective patterns. This proposed strategy allows for the modulation of not only the timing of
pattern occurrence and collective modes but also geometric and dynamic features, such as
radius, local cluster size, and rotational direction. Furthermore, the strategy's versatility extends
to applications such as the smooth transition between different collective modes within the
same agent group, demonstrating potential for controlling swarming robots. The synthesis of
collective patterns, aimed at provoking unconventional collective behaviours, has been
demonstrated—for instance, in search-and-rescue formations or in guarding or capturing
scenarios. For the first time, the proposed strategy successfully controls collective behaviours
by adjusting the individual-level interaction rules. These findings are thus expected to shift our
perspective on the emergence of complex systems from merely subjects of study to objects of
use and control.Fig. 1| Schematic Illustration of the Strategy for Controlling Collective Motions. a, Examples of
collective behaviours, such as bird flocks and fish schools. b, Interaction model between agents,
consisting of distancing and aligning forces. c, Procedure for constructing neural networks to realize
desired collective patterns. This involves refining a randomly initialized interaction model through
neural network training, incorporating the geometric and dynamic characteristics of the target collective
patterns. d, Representative collective motions generated by the proposed strategy.Fig. 2| Modulation of emergent behaviour by manipulating interaction models. a, Overall
flowchart to obtain an interaction model to control collective behaviours. b, Illustration of the transition
to an ordered state from an initially disordered state (number density ρ = 4); supplementary video 1. c,
Order parameter plotted over time, manifesting the modulation of the timing for the appearance of the
ordered state within a specified interaction range (top), and the synchronization of the emergence of the
ordered state across different interaction ranges (bottom). d, Inferred interaction model for each
collective motion in Fig. 2c.Fig. 3| Visualization of collective behaviour patterns and their modulation. Snapshots of ring,
clump, mill, and flock patterns, as generated from numerical simulations and the interaction models
identified via neural network training; supplementary video 2-6. Also, the average radius (R), the
clusters’ size for clumps (ε), and flock size (defined from the maximum spatial extent) are plotted
against the control input for manipulation. The accompanying error bar on these plots signifies the
standard deviation, derived from 100 trial runs. a-c, Observed collective motions. With a set radius R =
4, it is demonstrated how the geometric and dynamic properties of these patterns—namely rings, clumps,
and mills—can be modulated to either decrease or increase in scale. d, The positions and velocities of
40 SPPs at T =0 and 50 are graphically depicted, alongside the corresponding interaction models
identified through neural network. All SPPs are randomly initialized at T = 0.Fig. 4| Versatile manipulations of collective motions. a, Transition between collective motions
triggered by changing the coefficients and exponents within the interaction model; supplementary video
8. It has been achieved by varying the coefficients and exponents in the interaction model over specified
time intervals: clumps (T = 0-30), ring (T = 30-60), double mill (T = 60-90), flock (T = 90-140), and
single mill (T = 145-230). The agents, initially in random positions and velocities, undergo these
transitions smoothly. During a brief period of T = 140-145, where only noise is introduced to ensure
unbiased conditions for the subsequent phase. Temporal variations in the order parameter, normalized
absolute angular momentum, and normalized angular momentum signify the achievement of each target
pattern when at least one of these parameter values approaches unity. b. Emergence of unprecedented
hybrid collective patterns governed by non-homogeneous interaction models; supplementary video 9.
Models A and B, developed through neural network training, are applied to two groups of 20 agents
within a total of 40: ring (R = 2) – ring (R = 4), clumps (R = 2, ε = 2) – clumps (R = 4, ε = 2), single
mill (R = 2) – single mill (R = 4), flock (size = 2) – single mill (R = 4), ring (R = 4) – clumps (R = 4, ε
= 2), clumps (R = 2, ε = 3) – clumps (R = 2, ε = 4), double mill (R = 2) – ring (R = 4), and double mill
(R = 2) – flock (size = 4).Acknowledgements
This work was supported by National Research Foundation of Korea (Grant No. 2018-052541
and 2021-017476) via SNU SOFT Foundry Institute, and administered by SNU Institute of
Engineering Research.
References
1. Vicsek, T. & Zafeiris, A. Collective motion. Phys. Rep. 517, 71–140 (2012).
2. Sumpter, D. J. T. Collective Animal Behavior (Princeton Univ. Press, 2010)
3. Saw, T. B. et al. Topological defects in epithelia govern cell death and extrusion. Nature
544, 212-216 (2017).
4. Szabo, B. et al. Phase transition in the collective migration of tissue cells: experiment and
model. Phys. Rev. E 74, 061908 (2006).
5. Czirók, A., Ben-Jacob, E., Cohen, I. & Vicsek, T. Formation of complex bacterial colonies
via self-generated vortices. Phys. Rev. E 54, 1791 (1996).
6. Elgeti, J., Winkler, R. G. & Gompper, G. Physics of microswimmers—single particle
motion and collective behavior: a review. Rep. Prog. Phys. 78, 056601 (2015).
7. Cisneros, L. H., Cortez, R., Dombrowski, C., Goldstein, R. E. & Kessler, J. O. Fluid
dynamics of self-propelled microorganisms, from individuals to concentrated
populations. Exp. Fluids 43, 737–753 (2007).
8. Gómez-Nava, L., Bon, R. & Peruani, F. Intermittent collective motion in sheep results from
alternating the role of leader and follower. Nat. Phys. 18, 1494–1501 (2022)
9. Jhawar, J. et al. Noise-induced schooling of fish. Nat. Phys. 16, 488-493 (2020).
10. Gal, A. & Kronauer, D. J. The emergence of a collective sensory response threshold in ant
colonies. Proc. Natl. Acad. Sci. USA 119, e2123076119 (2022).
11. Buhl, J. et al. From disorder to order in marching locusts. Science 312, 1402–1406 (2006).
12. Cavagna, A., Giardina, I. & Grigera, T. S. The physics of flocking: correlation as a compass
from experiments to theory. Phys. Rep. 728, 1–62 (2018).
13. Ballerini, M. et al. Interaction ruling animal collective behavior depends on topological
rather than metric distance: evidence from a field study. Proc. Natl. Acad. Sci. USA 105,
1232–1237 (2008).
14. Cavagna, A. et al. Scale-free correlations in starling flocks. Proc. Natl. Acad. Sci. USA 107,
11865–11870 (2010).
15. Bialek, W. et al. Statistical mechanics for natural flocks of birds. Proc. Natl. Acad. Sci.USA 109, 4786–4791 (2012).
16. Attanasi, A. et al. Information transfer and behavioural inertia in starling flocks. Nat.
Phys. 10, 691–696 (2014).
17. Cavagna, A. et al. Marginal speed confinement resolves the conflict between correlation
and control in collective behaviour. Nat. Commun. 13, 2315 (2022).
18. Nagy, M., Ákos, Z., Biro, D. & Vicsek, T. Hierarchical group dynamics in pigeon
flocks. Nature 464, 890–893 (2010).
19. Ling, H. et al. Behavioural plasticity and the transition to order in jackdaw flocks. Nat.
Commun. 10, 5174 (2019).
20. Cavagna, A. et al. Dynamic scaling in natural swarms. Nat. Phys. 13, 914–918 (2017).
21. Lukeman, R., Li, Y.-X. & Edelstein-Keshet, L. Inferring individual rules from collective
behavior. Proc. Natl. Acad. Sci. USA 107, 12576–12580 (2010).
22. Katz, Y., Tunstrøm, K., Ioannou, C. C., Huepe, C. & Couzin, I. D. Inferring the structure
and dynamics of interactions in schooling fish. Proc. Natl. Acad. Sci. USA 108, 18720–
18725 (2011).
23. Mizumoto, N., Miyata, S. & Pratt, S. C. Inferring collective behaviour from a fossilized
fish shoal. Proc. R. Soc. B, 286, 20190891 (2019).
24. Helbing, D., Farkas, I. & Vicsek, T. Simulating dynamical features of escape
panic. Nature 407, 487–490 (2000).
25. Vicsek, T., Czirók, A., Ben-Jacob, E., Cohen, I. & Shochet, O. Novel type of phase
transition in a system of self-driven particles. Phys. Rev. Lett. 75, 1226–1229 (1995).
26. Cucker, F. & Smale, S. Emergent behavior in flocks. IEEE T. Automat. Contr. 52, 852–862
(2007).
27. Levine, H., Rappel, W. J. & Cohen, I. Self-organization in systems of self-propelled
particles. Phys. Rev. E 63, 017101 (2000).
28. D’Orsogna, M. R., Chuang, Y. L., Bertozzi, A. L. & Chayes, L. S. Self-propelled particles
with soft-core interactions: patterns, stability, and collapse. Phys. Rev. Lett. 96, 104302
(2006).
29. Romanczuk, P., Couzin, I. D. & Schimansky-Geier, L. Collective motion due to individual
escape and pursuit response. Phys. Rev. Lett. 102, 010602 (2009).
30. Reynolds, C. W. Flocks, herds and schools: a distributed behavioral model. In Proc. 14th
Annu. Conf. Computer Graphics and Interactive Techniques 25–34 (ACM, 1987).
31. Couzin, I. D., Krause, J., Franks, N. R. & Levin, S. A. Effective leadership and decision-making in animal groups on the move. Nature 433, 513–516 (2005).
32. Couzin, I. D., Krause, J., James, R., Ruxton, G. D. & Franks, N. R. Collective memory and
spatial sorting in animal groups. J. Theor. Biol. 218, 1–11 (2002).
33. Bastien, R. & Romanczuk, P. A model of collective behavior based purely on vision. Sci.
Adv. 6, eaay0792 (2020).
34. Charlesworth, H. J. & Turner, M. S. Intrinsically motivated collective motion. Proc. Natl.
Acad. Sci. USA 116, 15362–15367 (2019).
35. Pratissoli, F.et al. Coherent movement of error-prone individuals through mechanical
coupling. Nat. Commun. 14, 4063 (2023).
36. Petersen, K., Napp, N., Stuart-Smith, R., Rus, D. & Kovac, M. A review of collective
robotic construction. Sci. Robot. 4, eaau8479 (2019).
37. Bhaskar, D. et al. Analyzing collective motion with machine learning and
topology. Chaos 29, 123125 (2019).
38. Supekar, R. et al. Learning hydrodynamic equations for active matter from particle
simulations and experiments. Proc. Natl. Acad. Sci. USA 120, e2206994120 (2023).
39. Ha, S. & Jeong, H. Unraveling hidden interactions in complex systems with deep
learning. Sci. Rep. 11, 12804 (2021).
40. Heras, F. J., Romero-Ferrero, F., Hinz, R. C. & de Polavieja, G. G. Deep attention networks
reveal the rules of collective motion in zebrafish. PLoS Comput. Biol. 15, e1007354 (2019).
41. Liang, J. et al. The structure inference of flocking systems based on the
trajectories. Chaos 32, 101103 (2022).
42. Cichos, F., Gustavsson, K., Mehlig, B. & Volpe, G. Machine learning for active matter. Nat.
Mach. Intell. 2, 94–103 (2020).
43. Raissi, M., Perdikaris, P. & Karniadakis, G. E. Physics-informed neural networks: a deep
learning framework for solving forward and inverse problems involving nonlinear partial
differential equations. J. Comput. Phys. 378, 686–707 (2019). => PINN original paper
44. Raissi, M., Yazdani, A. & Karniadakis, G. E. Hidden fluid mechanics: learning velocity
and pressure fields from flow visualizations. Science 367, 1026–1030 (2020).
45. Karniadakis, G. E. et al. Physics-informed machine learning. Nat. Rev. Phys. 3, 422–440
(2021).
46. Kaiser, A., Snezhko, A. & Aranson, I. S. Flocking ferromagnetic colloids. Sci. Adv. 3,
e1601469 (2017).
47. Olafsen, J. & Urbach, J. Clustering, order, and collapse in a driven granularmonolayer. Phys. Rev. Lett. 81, 4369–4372 (1998).
48. Tsai, J. C., Voth, G. A. & Gollub, J. P. Internal granular dynamics, shear-induced
crystallization, and compaction steps. Phys. Rev. Lett. 91, 064301 (2003).
49. van der Kooij, H. M. et al. Morphing of liquid crystal surfaces by emergent collectivity. Nat.
Commun. 10, 3501 (2019).
50. Boamfa, M. I., Kim, M. W., Maan, J. C. & Rasing, Th. Observation of surface and bulk
phase transitions in nematic liquid crystals. Nature 421, 149–152 (2003).
Author contributions
H.-Y.K. conceived the idea and supervised the research. D.K. and J.L. were responsible for
designing the experiments and analyzing the data. D.K., J.L., and H.-Y.K. contributed to the
writing of the manuscript.
Code availability
The Python code used for trainings and simulations in this manuscript is available at the
following link: https://github.com/dongjokim03/Collective_motions_training.git
Competing interests
H.-Y.K. and D.K. are the inventors on the patent applications (#10-2024-0054253, Republic
of Korea) submitted by SNU R&DB Foundation that covers neural network training method
for collective motions and its applications.Methods
Self-propelled particles
Collective movements are predominantly seen in entities capable of generating momentum.
Thus, previous studies have employed self-propelled particles as a model for simulating the
agents exhibiting collective behaviours 4,5,12-17,19,21,23-25,27,28,31,33. The self-propelled agents were
assumed to be able to generate propulsion, whose concept can be represented in multiple forms,
such as constant (v = v )4,5,13,25, linear (dv/dt = [(v /v)-1]∙v)1,17,24, linear with damping (dv/dt =
0 0
γ[(v /v)-1]∙v)33, and marginal control (dv/dt = [(v /v)-1]n∙v, n>1)17,28. Recent research has
0 0
shown that the concept of marginal control could be highly suitable for analyzing the observed
correlations in bird flocking17. However, our study focuses on uncovering the interrelations
among agents in collective behaviours, leading us to choose the simplest self-propulsion form:
linear propulsion. For the velocity v of agent i, the reference self-propelled speed v , and the
i 0
interaction forces F between agents i and j, their motions can be described by the ordinary
ij
differential equation similar to the Langevin equation12,13,15,17
(1)
d(cid:17)(cid:2) (cid:30)(cid:31)
= (cid:17)(cid:2)(cid:29) −1"+ # (cid:1)(cid:2)(cid:3) +%(cid:2),
d(cid:28) (cid:30)(cid:2)
where η is white Gaussian noise whose variance17(cid:3) i(s$ p(cid:2))roportional to dimension d and effective
i
temperature T. In our study, we set the reference self-propelled speed v as 2.
0
Loss function for neural network
Our study employs a simple neural network architecture comprising four fully connected
layers, each with 32 neurons, designed specifically for inferring hidden interactions in
collective motions. The first three layers feature tanh activation functions, while the final layer
employs no activation function, instead incorporating a scale factor R, which corresponds to
the target of geometric characteristics, such as the average radius and the size of flock. The
network's total loss function integrates components from the governing dynamics in Eq. (1)
and ground truth data relevant to characteristics of collective behaviour. This function is a
summation of two parts: ℒ = ℒ + ℒ . ℒ represents the residual error between
total ground truth ODE ODE
the predicted force and that calculated from agent dynamics:
2
/4 / (2)
1 d(cid:17)(cid:2) (cid:30)(cid:31)
ℒ()* = ##- −(cid:17)(cid:2)(cid:29) −1"− # (cid:1)(cid:2)(cid:3). .
++, d(cid:28) (cid:30)(cid:2)
(cid:3)01(cid:2)01 (cid:3)($(cid:2))
ℒ consists of the initial condition, geometrical, and dynamic characteristics specific to
ground truth
the targeted collective motion. The training target changes depending on the collective pattern,
leading to variations in ℒ . This variation is formulated as,
ground truth
(3)
ℒ6789:; <79<= = # >∗ℒ∗,
where * indicates the index for the loss function defin∗ed by Extended Data Tables 1 and 2. Themaximum radius and minimum distance in Extended Data Table 2 are applied using the
rectified linear unit (ReLU) function applying thresholds R and d . This is implemented as
max min
max(0, r - R ) for the maximum radius and max(0, d - r ) for the minimum distance. In
i max min ij
loss for order parameter in transient state, ground truth values are applied while linearly
increasing from initial value to 1.
Training of neural network
The objective of the neural network is to predict collective behaviours within the time range
. For this purpose, the time interval [0, T] is discretized into N points and normalized
t
(cid:28)to∈ th[e0 ,rCa]nge of [-1,1]. The trainable parameters, including a , b , n , and m , are uniformly
k k k k
random initialized within the range of -1 to 1 (ring, clumps, and mill) or -0.1 to 0.1 (ordered
state and flock). The weights in θ are set using the Xavier uniform initialization method, while
the biases in θ are initialized with a constant value of 0.1. The training process commences
with the Adam optimizer, utilizing a learning rate of 10-3 for 200 epochs. Subsequently, the
optimization method is switched to the L-BFGS algorithm, based on the Pytorch framework
with tolerance 10-4 for ℒ . To determine collocation points, equidistant time interval Δt =
total
T/(0.1N) is selected, corresponding to 10% of the N time steps without loss of initial and final
t t
index. Specifically, for training related to maximum radius and minimum distance in flock
scenarios, these characteristics cannot be applied in transient motion. Therefore, collocation
points are selected based on Δt but within the range [N/2, N], accounting for 5% of all points.
t t
Numerical solution
To examine the consequent collective behaviours of SPPs under the learned coefficient
functions f and g, we computed the numerical solutions for the dynamics of SPPs as dictated
by Eq. 1. In this model, η represents white Gaussian noise, which is only applied in the ordered
i
state and flock. This noise has a zero mean with a standard deviation of σ = (2dT) 1/2, where d
denotes the spatial dimension's degree and T the effective temperature17. For the ordered state
in our research, we utilized a standard deviation of σ = 1, and for flock behaviour, a standard
deviation of 10 was employed. The numerical solutions were obtained using the Runge-Kutta
4th order method, as implemented in Scipy, with a maximum time step of 0.01. For patterns
like ring, clumps, and mill, initial positions and velocities for the x and y axes were randomly
assigned values within [-1, 1]. On the other hand, for ordered states and flocks, initial positions
were chosen within [-L, L] to maintain a density of ρ = N/L2, while velocities were selected
from the range [-v , v ].
0 0
Probability for collective patterns
In our study, agents influenced by the learned interaction forces generally displayed thetargeted collective patterns with the specified geometrical or dynamical characteristics.
However, random initial positions and velocities sometimes resulted in skewed linear or
angular momentum, leading to unexpected collective behaviours, such as swarm-like patterns.
To investigate this, we conducted a series of tests to assess the probability of achieving the
intended collective patterns under random initial conditions, repeating these tests 100 times (as
shown in Extended Data Fig. 2). Except for the case of single mill patterns at R = 4 and R = 6,
the occurrence probabilities for all intended collective patterns were observed to be higher than
80%. In the test of single mill patterns, irrespective of the initial momentum imbalances,
unintended collective patterns frequently emerged. Previous studies have indicated that
interaction forces greatly exceeding the magnitude of self-propulsion can give rise to
crystalline swarm structures28. Indeed, all the unexpected patterns observed at single mill with
the target of R = 4 and R = 6 were swarm-like. Consequently, careful selection of the target
average radius, which serves as an input for the neural network, is important for effectively
controlling single mill patterns.
Exponential transition
The transition between different collective motions is achieved by altering the coefficients
and exponents within the same polynomial form of interaction forces. To avoid abrupt
switching while changing the coefficient functions f and g, we utilized a simple exponential
decay function. Specifically, for the pth collective motion commencing at time t = t , the
p
interaction forces are modified as
(4)
,HI, ,HI, ,HI, ,HI,
Using(cid:1) t(cid:2) h(cid:3) e,E e= xpF o(cid:5) nE e( n1 ti− ale decay) a+ pp(cid:5)E roI a1 ce h, byJ (cid:9) th(cid:10) e(cid:11)(cid:12) t+ im(cid:14) e t∘ rF e(cid:16) aE ch(1 es− t e + 5, t) he+ te(cid:16) rE mI 1e J(cid:9)(cid:17)(cid:11)(cid:12) . exceeds
p
,HI,
0.99, effectively transitioning F to represent the interaction forces for 1th−e epth collective
ij,p
pattern.
Non-homogeneous interaction
Numerous models have been proposed to explain collective behaviours in agents, yet most of
them assume homogeneous interaction models, implying uniform function of force between
agents13-17, 24-28, 31, 32. Building on the neural network learning of homogeneous interaction
forces, we extended our approach to investigate unprecedented collective patterns featuring
non-homogeneous interactions. In a system of N = 40 agents, we assigned different coefficient
functions: those with subscript A to 20 agents for collective pattern A, and those with subscript
B to the remaining 20 agents for pattern B, as detailed in Eq. (5).
(5)
(cid:5)L(cid:9)(cid:10)(cid:11)(cid:12) +(cid:14)L ∘(cid:16)L(cid:9)(cid:17)(cid:11)(cid:12), for 1 ≤ Q ≤ 20,1 ≤ S ≤ 40
(cid:1)(cid:2)(cid:3) = K
Our polynomial interact(cid:5) iU o(cid:9) n(cid:10) (cid:11)m(cid:12) + od(cid:14) eU l p∘ r(cid:16) esU e(cid:9) r(cid:17) v(cid:11)e(cid:12), s tf ho er 2 g0 eo< meQ tr≤ ic4 al0 , c1 ha≤ racS t≤ eri4 st0 ics, even when thenumber of agents sharing the same interaction is halved compared to the training scenario. This
not only demonstrates the potential of leveraging collective behaviour for novel patterns but
also underscores the robustness and adaptability of our polynomial interaction model.f(r ) = 0
ij
/ / / /
* v r σ(r) r
i, initial i i ij
1 1 1 (cid:10)(cid:2) ×(cid:17)(cid:2) 1 (cid:10)(cid:2) ×(cid:17)(cid:2)
#(cid:10)(cid:2) #(cid:7)(cid:2) #W W Z# Z
+ + + Y(cid:30)(cid:31) + Y(cid:30)(cid:31)
Ring 1 (cid:2)001 5 (cid:2)001 0 0 (cid:2)01 5 (cid:2)010
Clumps 1 1 0 1 5 0 0 0
Mill (double) 1 1 0 1 0 5 5 0
Mill (single) 1 1 0 1 0 5 0 5
Extended Data Table 1| of ℒ for ring, clumps, and mill.
ground truth
[∗g(r ) ≠ 0
ij
/ /
* r v Max. radius Min. distance
i, initial i, initial
1 (cid:17)(cid:2) 1 (cid:17)(cid:2),\]:^_
#W W #W W
+ (cid:30)(cid:31) + (cid:30)(cid:31)
Ordered state 5 5 (cid:2)051 (cid:2)01 5 0 0
Flock 1 1 5 0 5 5
Extended Data Table 2| of ℒ for ordered state and flock.
ground truth
[∗Extended Data Fig. 1| Robustness of trained interaction model for ordered state. a, Linear
correlation between the control input and the timing for the ordered state. b, Timing versus interaction
ranges. All error bars represent the standard deviation from 100 trials.Extended Data Fig. 2| Probability for collective pattern. For 100 random initial conditions, 40 SPPs
are simulated with trained coefficient functions f and g.
PROBABILISTIC EASY VARIATIONAL CAUSAL EFFECT
USEF FAGHIHI* AND AMIR SAKI
Abstract. Let X and Z be random vectors, and Y =g(X,Z). In this paper, on
the one hand, for the case that X and Z are continuous, by using the ideas from
thetotalvariationandthefluxofg,wedevelopapointofviewincausalinference
capableofdealingwithabroaddomainofcausalproblems. Indeed, wefocusona
function, called Probabilistic Easy Variationoal Causal Effect (PEACE), which
can measure the direct causal effect of X on Y with respect to continuously and
interventionally changing the values of X while keeping the value of Z constant.
PEACE is a function of d ≥ 0, which is a degree managing the strengths of
probabilitydensityvaluesf(x|z). Ontheotherhand,wegeneralizetheaboveidea
forthediscretecaseandshowitscompatibilitywiththecontinuouscase. Further,
we investigate some properties of PEACE using measure theoretical concepts.
Furthermore,weprovidesomeidentifiabilitycriteriaandseveralexamplesshowing
the generic capability of PEACE. We note that PEACE can deal with the causal
problems for which micro-level or just macro-level changes in the value of the
input variables are important. Finally, PEACE is stable under small changes in
∂g /∂x and the joint distribution of X and Z, where g is obtained from g by
in in
removing all functional relationships defining X and Z.
1. Introduction
Causal reasoning plays an essential role in human cognition for our adaptation to
ourenvironment. Amongothers,itisvitalinfindingthecausesofbothobservational
and non-observational events, planning for actions, and predicting future events
[19]. Causal reasoning is widely used in different domains such as Deep Learning
algorithms (DLs). However, advanced DLs, such as ChatGpt can not fully perform
causal reasonings (see [2] and [11]). Current causal reasoning frameworks/theories
eachhavetheirstrengths. Forinstance, Rubin-NeymanandPearlcausalframeworks
[14, 15] are two of the most well-known frameworks of causality, which are used with
DLsforreasoning. Indeed,thesetwoframeworksaresomehowequivalentinconcepts
butwithdifferentpointsofview. Also, Janzingetal. introducedanewframeworkin
[10] by using information theoretic concepts. In [7], we discussed the strengths and
the weaknesses of usual causal effect formulas in Rubin-Neyman, Pearl, and Janzing
et al. frameworks. Indeed, we clarified that at a micro level, causal effect formulas
associated with Pearl causal framework work well with rare situations, such as rare
medical conditions, while Janzing et al. framework shows the reverse strengths:
works well at a macro level. In this paper, we will develop a new generic causal
Key words and phrases. Causal inference, total variation, direct causal effect, Pearl causal
model, intervention.
1
4202
raM
21
]LM.tats[
1v54770.3042:viXraframework that can handle causal inference both at the micro and macro levels by
using the idea of total variation as its core.
In [7], we introduced a framework for causal inference that takes benefits from 1)
the concept of intervention as it is in the Pearl framework, and 2) it uses a novel idea
called natural availability of changing. The latter says that, given Y = g(X,Z) with
X and Z discrete random variables, for calculating a1 direct causal effect (DCE) of
X on Y, P(x|z) might be important for different values of X = x and Z = z. To
clarify this, assume that in an observational study, the value Z = z rarely occurred.
Here, we have two different situations: 1) this rare occurrence has a notable or
important impact on a DCE of X on Y (e.g., the causal effect of a rare disease on
the blood pressure), and 2) it does not have a notable impact on a DCE of X on Y
(e.g., the causal effect of a rare noise on the quality of images). In the first situation,
it seems that P(x|z) should not be involved in a DCE formula of X on Y, or if it is
involved, it should be somehow strengthened. In contrast, in the second situation,
it is reasonable to have P(x|z) involved in a DCE of X on Y. We should note that
the aforementioned two situations are such as two endpoints of a segment, and each
inner point of this segment could happen in a real-world problem. Indeed, when we
move from the first situation to the second one, the importance of involving P(x|z)
in a DCE of X on Y increases. To deal with this, we used a degree d ≥ 0 in such a
way that P(x|z)d could somehow satisfy the above need: smaller and greater degrees
d correspond to the situations close to the first situation and the second situation
discussed above, respectively. To formalize our framework, we provided some ideas
and postulates as discussed in [7]. Then, we introduced several DCEs, where each
had its point of view. Hence, the direct causal effect values obtained by these DCEs
should be interpreted in the same way they have been defined. One of these DCEs,
is called Probabilistic Easy Variationoal Causal Effect (PEACE), which measures
causal changes of Y with respect to continuously and interventionally changing the
values of X, while keeping Z constant. Indeed, let Supp(X) = {x ,...,x } be the
0 l
set of all possible values of X with x < ··· < x . In [7], we defined
0 l
PEACE (X → Y) := E (NPIEVz(X → Y)),
d Z d
l
(cid:88)
NPIEVz(X → Y) := 4d |g (x ,z)−g (x ,z)|P(x |z)dP(x |z)d,
d in i in i−1 i i−1
i=1
where g is a function that is obtained by removing the functional relationships
in
defining X and Z (i.g., if X = h(Z,W) for some random variable W, then this func-
tional relationship should be ignored. The same is true, for a functional relationship
such as Z = q(X,W′) for some random variable W′.) The notation g (x,z) in the
in
Pearl framework could be interpreted as calculating Y while Do(X = x,Z = z).
The term P(x |z)dP(x |z)d is interpreted as the natural availability of degree d of
i i−1
changing the value of X from x to x , while keeping Z = z. That is the prob-
i−1 i
ability of selecting independently x and x from the subpopulation determined
i i−1
by Z = z, equipped/weakened/strengthened with a degree d. Note that 4d is a
1We use “a” rather than “the”, since theoretically different formulas for calculating “direct
causal effect” could be proposed.
2normalizer term and comes from the fact that P(x |z)dP(x |z)d ≤ 1/4d. Further,
i i−1
we note that
(cid:80)l
|g (x ,z) − g (x ,z)| is the total variation of the sequence
i=1 in i in i−1
g (x ,z),...,g (x ,z).
in 0 in l
Inthispaper, wegeneralizetheideaofPEACEdiscussedin[7]fordiscreterandom
variables in three ways: 1) to involve continuous random variables, 2) to involve the
direct causal effect of a random vector on a random variable, and 3) in dimension
1, to involve the positive and negative direct causal effect values for the continuous
case2. To do so, we use the ideas of the total variation and the flux of a function of
several variables. Let Y = g(X,Z), where X and Z are continuous random vectors
such that Supp(X) is a subset of an open subset Ω of Rn. We define
PEACE (X →Y):=E (NPIEVz(X →Y)),
d Z ˆ d
(cid:26) (cid:27)
(1) NPIEVz(X →Y):=4dsup g (x,z)div(φ)(x)dx:φ∈C1(Ω,Rn), |φ|≤f2 (·|z) ,
d in c X|Z
Ω
where C1(Ω,Rn) is the set of all compactly supported continuously differentiable
c
functions from Ω to Rn, div(φ) is the divergence of φ, and f is the probability
X|Z
density function of X given Z. While our definition of PEACE seems complicated,
for the case that g is continuously differentiable, in Theorem 4.6, we show that
ˆ
(cid:12) (cid:12)
NPIEVz(X → Y) := 4d (cid:12) (cid:12)∂g in (t,z)(cid:12) (cid:12)f(x|z)2ddtdz.
d (cid:12) ∂x (cid:12)
Ω
It follows that PEACE is stable under small changes in ∂g /∂x and the joint dis-
in
tribution of X and Z. Further, we generalize the above definition of PEACE for the
case that both X and Z are discrete random vectors. To do so, first, by generalizing
the idea of the flux to involve discrete functions, we provide a new definition of
the total variation of a function of several variables in the discrete case. Then, we
use our new definition of the total variation to define PEACE for discrete random
vectors. Furthermore, in dimension 1, namely, for the case that X and Z are ran-
dom variables and Y = g(X,Z), we define the positive and the negative PEACEs.
Indeed, we note that the ordinary PEACE measures the absolute value of the direct
causal changes, while positive and negative PEACEs measure the positive and the
negative direct causal changes, respectively. Here, by the direct causal changes, we
mean the changes of Y with respect to continuously and interventionally increasing
the values of X, while keeping Z constant. Let ε ∈ {±}. In [7], we defined the
positive and the negative PEACEs for the discrete case as follows:
l
(cid:88)
PIEVz(X → Y)ε := (g (x )−g (x ))εP(x |z)dP(x |z)d,
d in i in i−1 i i−1
i=1
where for any r ∈ R, r+ = max{r,0}, r− = |r| − r+, and we have assumed that
Supp(X) = {x ,...,x } with x < ··· < x . In this paper, for the case that X and
0 l 0 l
2By dimension 1, we mean the random vector that we mentioned before, has just one variable.
3Z are continuous random variables and Supp(X) ⊆ [a,b], we define3
PIEVz(X → Y)ε := lim Lz (X → Y)ε, P ∈ P([a,b]),
d P,d
∥P∥→0
(cid:88)nP
(cid:16) (cid:17)ε
Lz (X → Y)ε := g(x(P))−g(x(P)) f(x(P)|z)df(x(P)|z)d,
P,d i i−1 i i−1
i=1
where P([a,b]) is the set of all partitions of [a,b], and for any P ∈ P([a,b]), we
assume that P = {x(P),...,x(P)} with x(P) < ··· < x(P). In Theorem 8.1, we show
0 nP 0 nP
that when g has the continuous partial derivatives with respect to X, then
in
ˆ
∞ (cid:18) ∂g (cid:19)ε
(2) PIEVz(X → Y)ε = in (t,z) f2d (t|z)dt.
d ∂x X|Z
−∞
Now, we briefly explain the organization of the paper. In Section 2, we provide some
basic concepts required to fully understand the next sections. Section 3 is devoted
to discovering the relationships between the divergence of a function f defined on a
domain Ω, the flux of f passing through the boundary of Ω, and the total variation
of f. This section is a preparation to justify the causal sense of the definition given
in Equation (1). In Section 4, we define and investigate PEACE, and we discuss why
it is causally significant. Let Y = g(X,Z) with Supp(X) ⊆ Ω, where Ω is an open
subset of Rn. We show that if we define µ on the collection of all open subsets of
Ω by setting µ(Γ) := PEACE (X| → Y), then µ induces a Borel regular measure,
d Γ
whereX| istherestrictionofXonΓ, andmorepreciselyitistherestrictedfunction
Γ
X| : X−1(Γ) → R. Further, we show that if X = h(W) such that h is a restriction
Γ
of an onto isometry of Rn, then PEACE (W → Y) = PEACE (X → Y). Section
d d
5 is devoted to defining a new formula for the total variation of a multivariate
discrete function compatible with the continuous definition. To do so, first, we
discuss why the previous definitions by the other researchers are not suitable. Next,
we generalized the concept of the flux of a function for discrete functions. Then, we
usethisgeneralizationtodefinethetotalvariationofamultivariatediscretefunction.
In Section 6, for a discrete random vector X, we define PEACE (X → Y) by using
d
the total variation formula defined in Section 5 and the idea of defining PEACE
for the continuous case. Further, in Theorem 6.2, we show that our definition of
PEACE for the discrete case is compatible with the one for the continuous case. In
Section 7, we provide an identifiability criteria for PEACE (X → Y) to deal with
d
unobserved variables such as U in Y = g(X,Z,U ). Section 8 is devoted to the
Y Y
positive and the negative PEACEs. In this section, Equation (2) is proven. Finally,
in Section 9, we provide some examples supporting our framework and its general
capability. In Section 10, we provide the conclusion of this paper. Some lemmas,
propositions, and theorems required to prove our results are given and discussed in
Appendix A. The proofs of our results are provided in Appendices B and C.
3Here, Supp(X)⊆(−∞,b], Supp(X)⊆[a,∞) and Supp(X)⊆(−∞,∞) work as well.
42. Preliminaries
In this section, we briefly discuss some basic concepts required for the remainder
of the paper.
Cells and Cubes. Let n be a positive integer. By an n-cell, we mean a Cartesian
product of n bounded closed interval (i.e., [a ,b ] × ··· × [a ,b ], where a ,b ∈ R
1 1 n n i i
for any 1 ≤ i ≤ n). Further, by an n-cube, we mean the boundary of an n-cell4. We
may call a 2-cube, and a 3-cube a rectangle, and a cube, respectively.
Partitions of a Closed Interval. Let [a,b] be an interval. Then, by a partition
for [a,b] we mean a chain {x ,...,x }, where a = x < x < ··· < x < x = b,
0 n 0 1 n−1 n
and n is a positive integer. We denote the set of all partitions of [a,b] by P([a,b]).
Support of a Function. Let φ : V ⊆ Rn → W ⊆ Rm be a function. The closed
support or simply support of φ, denoted by Supp(φ), is defined as the topological
closure of the set of all points x ∈ V with φ(x) ̸= 0 in V.
Some Notations. In this paper, we denote elements of Rn by bold variables such
as x = (x ,...,x ). However, when our focus is on n = 1, we use the usual variables
1 n
such as x. Further, for n = 3, we use the standard variables x,y and z.
For any two sets S and S , by S \S we mean the set of all points of S which do
1 2 1 2 1
not belong to S . Also, we denote the powerset of a set S by P(S). We denote the
2
interior and the boundary of a subset V of Rn by Int(V) and Bd(V), respectively
(see [12] for knowledge on topology).
Let F : V → W be a function and U ⊆ V. Then, we denote the restriction of F
on U by F| (i.e., F| : U → W sending each x ∈ U to F(x)).
U U
Let l be a non-negative integer. Assume that V ⊆ Rn and W ⊆ Rm. We
denote the set of all functions φ : V → W, whose derivatives of order l exist and
are continuous by Cl(V,W). Also, we denote the set of all compactly supported
functions φ ∈ Cl(V,W) by Cl(V,W).
c
Diffeomorphisms and Jacobians. Let U and V be two open subsets of Rn. A
function h : U → V is called a diffeomorphism if it is bijective and differentiable,
and it has a differentiable inverse. For a function h such as above (not necessarily a
diffeomorphism), we define the jacobian matrix of h as follows:
(cid:18) (cid:19)
∂h
i
Jac(h)(a) := (a) , h = (h ,...,h ).
1 n
∂x
j i,j
4Here,by“boundary”wemeanitstopologicalmeaning. Indeed,onecouldseethattheboundary
of an n-cell C = [a ,b ]×···×[a ,b ] is the set of all points x = (x ,...,x ) of C for which
1 1 n n 1 n
x ∈{a ,b } for some i with 1≤i≤n.
i i i
5Isometries and Orthogonal Matrices. A function h : U ⊆ Rn → V ⊆ Rm is
called an isometry if |h(x)−h(x′)| = |x−x′| for any x,x′ ∈ U. An n×n matrix
A whose entries are real numbers is called orthogonal if AAT = I , where AT is
n
the transpose of A. By the Mazur-Ulam theorem [8, Theorem 1.3.5], for each onto
isometry h : Rn → Rn, there exists an orthogonal matrix A such that h(x) = Ax+a,
where A is an invertible n×n matrix, and a ∈ Rn (here, we consider the vectors in
Rn as colomn vectors).
Measure Theoretical Preliminaries. Let Ω be a set. A subcollection Σ of P(Ω)
is called a σ-algebra, if ∅ ∈ Σ, E ∈ Σ implies Ω\E ∈ Σ for any E ∈ Σ , and
(cid:83)
E ∈ Σ for any family {E } of elements of Σ. Let Σ be a σ-algebra on Ω.
i∈I i i i∈I
Then, a function µ : Σ → [0,∞] is called a measure, if µ(∅) = 0 and
µ((cid:83)∞
E ) =
i=0 i
(cid:80)∞ µ(E ) for any family {E }∞ of pair-wise disjoint elements of Σ. The latter
i=0 i i i=1
property is called the countably additive property. A function µ : P(Ω) → [0,∞]
∗
is called an outer measure, if µ (∅) = 0, µ (E) ≤ µ (F) for any E,F ∈ P(Ω)
∗ ∗ ∗
with E ⊆ F, and µ((cid:83)∞ E ) ≤ (cid:80)∞ µ(E ) for any family {E }∞ of elements of
i=0 i i=0 i i i=1
P(Ω). Thelattertwopropertiesarecalledmonotonicity andcountably subadditivity,
respectively. Let µ be an outer measure on Ω. Then, E ∈ P(Ω) is called µ -
∗ ∗
measurable, if for any A ∈ P(Ω), we have that µ (A) = µ (A∩E)+µ (A∩(Ω\E)).
∗ ∗ ∗
It is well-known that the set of all µ -measurable subsets of Ω is a σ-algebra, and µ
∗ ∗
is a measure on this σ-algebra. We define the σ-algebra generated by a subcollection
Θ of P(Ω) to be the intersection of all σ-algebras on Ω which contain Θ. If Ω is a
topological space, then the σ-algebra generated by open sets in Ω is called a Borel
σ-algebra. Each element of a Borelσ-algebra is calleda Borel set. A measure defined
on a Borel σ-algebra is called a Borel measure. In the case that Ω ⊆ Rn is open,
an outer measure µ on Ω is called Borel regular, if for any A ⊆ Ω, there exists a
∗
Borel set E in Ω with µ (A) = µ (E). Roughly speaking, the Lebesgue measure on
∗ ∗
Rn is a generalization of the volume in Rn (for n = 1 and n = 2, we will have a
generalization of the length and the area for the subsets of R and R2, respectively).
See [9] for the precise definitions of the Lebesgue measure, the Lebesgue integration,
and other related concepts and results in measure theory.
Integral on an Open set. Let F : V ⊆ Rn → W ⊆ Rm be a function, where V is
bounded. Assume that C is an n-cell containing V. Define F(cid:101) : C → W by setting
F ´(cid:101)|
V
= F an ´d F(cid:101)|
C\V
≡ 0. Following [13, §13], we define the integral o ´f F on V as
F dx := F(cid:101)dx. A bounded subset V of Rn is called rectifiable if dx exists
V C V
(see [13, §14]). Note that V is rectifiable if and only if the Lebesgue measure of
Bd(V) is 0 ([13, Theorem 14.1]). Now, we take a close look at integrals over open
subsets of Rn. Let F : V → W ⊆ Rm be a function, where V is an open subset
of Rn. Assume that {C }∞ is a sequence of rectifiable compact subspaces of V in
i i=0
such a way that C ⊆ Int(C ) and the boundary of C is a piece-wise manifold of
i i+1 i
class C1 for any i ≥ 0, and V = (cid:83)∞ i=0C i´(for the existence of such a sequence see
Lemma A.1). In addition, assume that |F(x)|dx < ∞ for any i ≥ 0. Then,
Ci
6´
lim F(x)dx exists, and we have that (see [13, §15]):
i→∞ Ci
ˆ ˆ
F(x)dx = lim F(x)dx.
i→∞
V Ci
In the above, we call the sequence {C }∞ an admissible compact cover for V.
i i=0
3. Relationship Between the Divergence and the Total Variation of
a Function
The main purpose of this section is to introduce a famous multivariate version of
the total variation and show how it intuitively measures the variations of a function.
To do so, we need to have some steps. Let f : V → R be a function, where V is an
open subset of Rn. Also, let Ω be a compact subspace of V, and S be the boundary
of Ω of class C1. Moreover, assume that C is an infinitesimal n-cell contained in
Ω and D is its boundary. In this section, first, we intuitively discuss the flux of
f passing through S. Then, we state and clarify the divergence theorem, which
makes a relationship between the flux of f passing through S and the integral of the
divergence of f on Ω. Next, the definition of the total variation of f is given, and we
justifythatfortheunivariatefunctions,thisdefinitionofthetotalvariationcoincides
with the classic total variation of a function under some assumptions. Further, we
explain how the flux and the total variation of f are related concepts. Indeed, the
flux of f on D is approximately equal to the multiplication of the divergence of f on
C and the volume of C. However, the total variation of f is obtained similarly to the
latter with one change: we replace the divergence of f with the inner product of the
divergence of f and a weight function, which is bounded by 1 and makes the above
inner product maximum. In this way, on the one hand, under some assumptions,
the absolute values of the partial derivatives of f will appear, which are somehow
related to the variations of f. On the other hand, this implies a close relationship
between the divergence and the total variation of f.
3.1. Divergence Theorem. Let F : U → Rn be a continuously differentiable
function, where U is an open subset of Rn. Then, the divergence of F is defined as:
n
(cid:88) ∂F
div(F) : U → R, div(x) := (x).
∂x
i
i=1
The flux of F passing through a surface S ⊆ U is defined as the following surface
integral:
˛
Flux(F;S) := F(x)·N(cid:98)(x)dS,
S
where N(cid:98)(x) is the outward unit vector perpendicular to S at the point x, and
F(x) · N(cid:98)(x) is the standard inner product of F(x) and N(cid:98)(x) as vectors in Rn for
any x ∈ S. We call N(cid:98)(x) the outward unit normal vector for S at x as well.
7N(cid:98) N(cid:98)
D
2
N(cid:98)
• •
(x,y,z) (x,y,z)
−N(cid:98)
D
1
(a) (b) (c)
Figure 1. (A) A 3-cell centered at the point (x,y,z) with the
outward unit normal vector N(cid:98). (B) The faces of the cell parallel to
the xy plane. (C) Two identical 3-cells, one of which is on top of the
other one. The outward unit normal vectors of these two cubes on
their common face are in opposite directions.
Thefollowingtheoremcalledthedivergence theorem5, makesabridgebetweenthe
flux of a function passing through a surface and a multiple integral on the region
surrounded by that surface (see [20, Theorem 9.2.4]).
Theorem 3.1. Let Ω ⊆ Rn be compact and its boundary is C1. Assume that V ⊆ Rn
be an open neighborhood of Ω. Then, for any continuously differentiable function
F : V → Rn, we have that
ˆ ˛
div(F)dx = F ·N(cid:98) dS, S = Bd(Ω).
Ω S
Now, we provide an intuitive justification for the divergence theorem in three
dimensions, which makes it clear where div(F) comes from6. To do so, first, assume
that we are given an infinitesimal 3-cell as shown in Part (A) of Figure 1. Also,
assume that the boundary of this cell is a cube D, and the side lengths of D are
∆x,∆y, and ∆z. To compute Flux(F;D), we divide D into three pairs of parallel
faces. First, as shown in Part (B) of Figure 1, we consider the faces D and D
1 2
parallel to the xy plane. For each i = 1,2, one could say that F approximately
takes the same value on D . Hence, Flux(F;D ) and Flux(F;D ) are approximately
i 1 2
(cid:16) (cid:17) (cid:16) (cid:17)
F ·N(cid:98) (x,y,z−∆z/2)∆x∆y and F ·N(cid:98) (x,y,z+∆z/2)∆x∆y, respectively. We
note that
⃗ ⃗
N(cid:98)(x,y,z −∆z/2) = −k = (0,0,−1), N(cid:98)(x,y,z +∆z/2) = k = (0,0,1).
5This theorem is famous by two other names: Gauss’s theorem, and Ostrogradsky’s theorem
6We make it clear that this is not a precise proof!
8Now, let F = (F ,F ,F ). Then, the above fluxes are respectively as follows:
1 2 3
−F (x,y,z −∆z/2)∆x∆y, F (x,y,z +∆z/2)∆x∆y.
3 3
Hence, we have that
(cid:0) (cid:1)
Flux(F;D ∪D ) ≈ F (x,y,z +∆z/2)−F (x,y,z −∆z/2) ∆x∆y.
1 2 3 3
We note that
∆z∂F
3
F (x,y,z +∆z/2) ≈ F (x,y,z)+ (x,y,z),
3 3
2 ∂z
∆z∂F
3
F (x,y,z −∆z/2) ≈ F (x,y,z)− (x,y,z),
3 3
2 ∂z
which implies that
∂F
3
F (x,y,z +∆z/2)−F (x,y,z −∆z/2) ≈ ∆z (x,y,z).
3 3
∂z
Thus, Flux(F;D ∪ D ) ≈ (∂F /∂z)(x,y,z)∆x∆y∆z. For the flux of F passing
1 2 3
through each of the other two pairs of parallel faces of D, by similar arguments, we
obtain (∂F /∂x)(x,y,z)∆x∆y∆z and (∂F /∂y)(x,y,z)∆x∆y∆z. Therefore, we
1 2
have that
(cid:18) (cid:19)
∂F ∂F ∂F
1 2 3
Flux(F;D) ≈ + + (x,y,z)∆x∆y∆z = div(F)(x,y,z)∆x∆y∆z.
∂x ∂y ∂z
Now, let us consider two identical 3-cells as shown in Part (C) of Figure 1. Since
the outward unit normal vectors on the common face of these two cells are in the
opposite directions, the effect of the common face disappears in the fluxes of F
passing through the boundaries of these cells7. A similar argument holds for any
two adjacent identical 3-cells. Now, let Ω ⊆ R3 be compact as shown in Figure 2
with the smooth boundary S. We call a collection Γ of 3-cells in R3 addmissible
for Ω, if we have the following conditions:
(1) Each cell in Γ is contained in Ω,
(2) Every two cells in Γ are identical,
(3) The intersection of every two distinct cells in Γ is empty or a common vertex,
edge, or face of both, and
(4) Γ is maximal with respect to the above three conditions.
Let Γ be an admissible collection of 3-cells for Ω. We denote the union of all cells
in Γ by ∥Γ∥. We also denote the boundary of ∥Γ∥ and the disjoint union of the
boundaries of the cells in Γ by S and S , respectively (see Figure 3). Then,
∥Γ∥ Γ
as we discussed above, we have that Flux(F;S ) = Flux(F;S ). Thus, we have
Γ ∥Γ∥
that
(cid:88)
Flux(F;S ) = div(F)(x,y,z)∆x∆y∆z,
∥Γ∥
where the summation is over all center points of the cells in Γ.
7For the cells in the bottom and the top, we obtain (∂F /∂z)(x,y,z +∆z/2)∆x∆y∆z and
3
−(∂F /∂z)(x,y,z +∆z/2)∆x∆y∆z for the flux of F passing through the common face of the
3
cells, respectively.
9S
Figure 2. A compact region Ω ⊆ R3, whose boundary S is
smooth. The region Ω could be estimated by the union of the cells
belonging to an admissible collection of cells for Ω.
C C
3 4
C C C
2 1 5
C
6
(a) (b) (c)
Figure 3.
Admissible collections could be similarly defined in any dimension.
In this figure, for a better visualization, we consider an admissible collection
Γ={C ,...,C } of 2-cells for a 2-dimensional shape. Note that the subfigures
1 6
(A), (B), and (C) shows ∥Γ∥, S , and S , respectively. However, each of the
Γ ∥Γ∥
red sides is considered twice as it is the common side of two adjacent squares.
(cid:112)
Assume that mesh(Γ) := ∆x2 +∆y2 +∆z2, where ∆x, ∆y, and ∆z are the
side lengths of each cube in Γ. We note that by tending mesh(Γ) to 0, S tends
∥Γ∥
to S. It follows that
Flux(F;S) ≈ lim Flux(F;S )
∥Γ∥
mesh(Γ)→0 ˚
(cid:88)
≈ lim div(F)(x,y,z)∆x∆y∆z ≈ div(F)dV.
mesh(Γ)→0 Ω
Note that in our intuitive justification of the divergence theorem, we used the linear
approximations of F. That is why instead of equality in the theorem we have an
approximation. However, in the precise proof of the theorem, it is shown that the
error terms in the approximations tend to 0, and hence we will have equality in the
theorem.
103.2. Total Variation. Let g : [a,b] → R be a function. The total variation of g,
denoted by TV(g), is defined as follows:
(cid:88)nP
(cid:12) (cid:16) (cid:17) (cid:16) (cid:17)(cid:12)
TV(g) := max (cid:12)g x(P) −g x(P) (cid:12),
(cid:12) i i−1 (cid:12)
P∈P([a,b])
i=1
where P = {x(P),...,x(P)} for any P ∈ P([a,b]).
0 n
Now, we talk about the multivariate total variation. Let g : U → R be Riemann
integrable, where U is an open subset of Rn. Then, the total variation of g is defined
as follows:
ˆ
(cid:26) (cid:27)
TV (g) := sup gdiv(φ)dx : φ ∈ C1(U,Rn), ∥φ∥ ≤ 1 .
n c ∞
U
Now, we justify why TV is a generalization of TV. To do so, we have to show
n
that TV and TV coincide with each other under some assumptions. Assume that
1 ´
g : [a,b] → Riscontinuouslydifferentiable. Itiswell-knownthatTV(g) = b |g′|dx8
a
. Consider the extra assumptions that g ∈ C2([a,b],R), and g′ has finitely many
zeros (for the general result without these two assumptions, see Theorem 4.6). We
show that TV (g) = TV(g). Let φ ∈ C1((a,b),R) with ∥φ∥ ≤ 1. Then, it follows
1 c ∞
from integrating by part and φ(a+) = φ(b−) = 0 that
ˆ ˆ ˆ ˆ
b− b− (cid:12)b− b− b−
gdiv(φ)dx = gφ′dx = gφ(cid:12) − g′φdx = − g′φdx.
(cid:12)
a+ a+ a+ a+ a+
Hence,
ˆ ˆ
b b
(3) gdiv(φ)dx = − g′φdx.
a a
Now, we have that
ˆ ˆ ˆ ˆ ˆ
b b (cid:12) b (cid:12) b b
(cid:12) (cid:12)
gdiv(φ)dx = − g′φdx ≤ (cid:12) g′φdx(cid:12) ≤ |g′φ|dx ≤ |g′|dx.
(cid:12) (cid:12)
a a a a a
´
The latter inequality is due to ∥φ∥ ≤ 1. Thus, TV (g) ≤ b |g′|dx. Assume that
∞ 1 a
r ,...,r are all zeros of g′ such that r < ··· < r . Then, for any small enough
0 k 0 k
ε > 0, we assume that r = a+ε and r = b−ε (see Figure 4). Also, we define
−1 k+1
φ : (a,b) → R in such a way that it satisfies the following conditions:
ε
(1) φ equals −|g′|/g′ at the points x with |x−r | ≥ ε for each 0 ≤ i ≤ k.
ε i
(2) φ ≡ 0 on the intervals [a,r ] and [r ,b] (hence, the support of φ must
ε −1 k+1 ε
be compact).
(3) At the other points, we define φ to be equal to any continuously differ-
ε
entiable function ψ with the following properties (see the red parts of the
ε
graph in Figure 4):
• ∥ψ ∥ ≤ 1, and
ε ∞
• the values of ψ′ at the points r , r and r ±ε equal 0 for 0 ≤ i ≤ k.
ε −1 k+1 i
8Onecouldeasilyprovethisstatementbyusingthetriangleinequality,themeanvaluetheorem,
and the definition of the Riemann integration.
11(4) φ′ is continuous9.
ε
Now, we have that
ˆ ˆ ˆ
b (cid:88)k+1 ri−ε (cid:88)k+1 ri+ε
g′φ dx = g′φ dx+ g′φ dx,
ε ε ε
a
i=0
ri−1+ε
i=0
ri−ε
while we have that
ˆ ˆ ˆ
(cid:88)k+1 ri−ε (cid:88)k+1 ri−ε |g′| (cid:88)k+1 ri−ε
g′φ dx = −g′ dx = − |g′|dx,
ε g′
i=0
ri−1+ε
i=0
ri−1+ε
i=0
ri−1+ε
(cid:12) ˆ (cid:12) ˆ ˆ
(cid:12)(cid:88)k+1 ri+ε (cid:12) (cid:88)k+1 ri+ε (cid:88)k+1 ri+ε
(cid:12) g′φ dx(cid:12) ≤ |g′φ |dx ≤ |g′|dx.
(cid:12) ε (cid:12) ε
(cid:12)
i=0
ri−ε (cid:12)
i=0
ri−ε
i=0
ri−ε
It follows that
ˆ ˆ (cid:12) ˆ ˆ ˆ (cid:12)
(cid:12)
(cid:12)
b b (cid:12)
(cid:12)
(cid:12) (cid:88)k+1 ri−ε (cid:88)k+1 ri+ε b (cid:12)
(cid:12) g′φ dx+ |g′|dx(cid:12) = (cid:12)− |g′|dx+ g′φ dx+ |g′|dx(cid:12)
ε (cid:12) ε (cid:12)
(cid:12) (cid:12)
a a (cid:12)
i=0
ri−1+ε
i=0
ri−ε a (cid:12)
(cid:12) ˆ ˆ (cid:12)
(cid:12)(cid:88)k+1 ri+ε (cid:88)k+1 ri+ε (cid:12)
= (cid:12) g′φ dx+ |g′|dx(cid:12)
(cid:12) ε (cid:12)
(cid:12)
i=0
ri−ε
i=0
ri−ε (cid:12)
(cid:12) ˆ (cid:12) ˆ
(cid:12)(cid:88)k+1 ri+ε (cid:12) (cid:88)k+1 ri+ε
≤ (cid:12) g′φ dx(cid:12)+ |g′|dx
(cid:12) ε (cid:12)
(cid:12)
i=0
ri−ε (cid:12)
i=0
ri−ε
ˆ
(cid:88)k+1 ri+ε
≤ 2 |g′|dx ≤ 4M(k +2)ε,
i=0
ri−ε
where M is a bound for g′. It follows that
ˆ ˆ
(cid:18) b (cid:19) b
lim − g′φ dx = |g′|dx.
ε
ε→0
a a
Therefore, TV (g) = TV(g).
1
Now, we obtain an equality similar to Equation (3) in the multivariate case. To
do so, let g ∈ C1(V,R), where V is an open subset of Rn. Also, assume that U is a
9This is easy to be done. For instance, for each interval [r −ε,r +ε] with i ̸= −1,k+1, one
i i
could consider a polynomial P of degree 4 with ∥P ∥ ≤1 as a solution for the following system
i i ∞
of equations:
P (r
−ε)=−|g′(ri−ε)|,
P (r
+ε)=−|g′(ri+ε)|,
i i g′(ri−ε) i i g′(ri+ε)
P′(r −ε)=0, P′(r +ε)=0.
i i i i
Also, for i = −1 or i = k+1, we consider the following system of equations to define P on the
i
intervals [r ,r +ε] and [r −ε,r ], respectively:
−1 −1 k+1 k+1
|g′(r +ε)|
P (r )=P′ (r )=P′(r +ε)=0, P (r +ε)=− −1 .
−1 −1 −1 −1 i −1 i −1 g′(r +ε)
−1
|g′(r −ε)|
P (r )=P′ (r )=P′(r −ε)=0, P (r −ε)=− k+1
k+1 k+1 k+1 k+1 i k+1 i k+1 g′(r −ε)
k+1
By the above setting, φ′ is continuous.
ε
121
r r
0 2
r
1
| | |
a
b
r = a+ε r = b−ε
−1 3
−1
Figure 4. Let g :[a,b]→R be continuosly differentiable. Define g(cid:101)′ :D →R
sending each x∈D to −|g′(x)|/g′(x), where D ={x∈(a,b):g′(x)̸=0}. Also,
assume that r ,...,r are all zeros of g′ (in this figure, we have that k =2). For
0 k
a given small enough ε>0, this figure shows the graph of a smooth extension
φ
ε
:(a,b)→R of a restriction of g(cid:101)′, which satisfies the following properties: 1)
the support of φ is compact, 2) ∥φ ∥ ≤1, and 3) the integral of φ is an
ε ε ∞ ε
approximation of the integral of g(cid:101)′. Let us assume that r
−1
=a+ε and
r =b−ε. The thick segments on the x axis have the length 2ε. Also, r , r ,
k+1 −1 0
r , r , and r are the midpoints of the five inner thick segments. The black
1 2 3
segments on the graph come from the graph of g(cid:101)′.
bounded open subset of Rn satisfying U ⊆ V, and the boundary of U is a C1 surface
S. Fix φ ∈ C1(U,Rn) with ∥φ∥ ≤ 1. Let {C }∞ be an admissible compact
c ∞ i i=0
cover for U. Then, there exists a positive integer N such that i ≥ N implies that
0 0
Supp(φ) ∩ S = ∅, where S = Bd(C ) (see Proposition A.3). For an i ≥ N , we
i i i 0
define R : C → Rn by setting R(x) = φ(x)g(x). Then, by the divergence theorem,
i
we have that ˆ ˆ
div(R)dx = R·N(cid:98) dS = 0,
Ci S i
since φ and consequently R are 0 on S due to Supp(φ) ∩ S = ∅. Assume that
i i
φ = (φ ,...,φ ). Then, we have that
1 n
n n (cid:18) (cid:19)
(cid:88) ∂(φ g) (cid:88) ∂φ ∂g
i i
div(R) = = g +φ
i
∂x ∂x ∂x
i i i
i=1 i=1
n n
(cid:88) ∂φ (cid:88) ∂g
i
(4) = g + φ = gdiv(φ)+φ·∇g.
i
∂x ∂x
i i
i=1 i=1
´
Now, it follows from div(R)dx = 0 that
Ci
ˆ ˆ
(5) gdiv(φ)dx = − φ·∇gdx,
Ci Ci
which implies that
ˆ ˆ ˆ ˆ
(cid:18) (cid:19)
gdiv(φ)dx = lim gdiv(φ)dx = lim − φ·∇gdx = − φ·∇gdx.
i→∞ i→∞
U Ci Ci U
13Now, we justify why TV somehow measures the variations of real-valued functions
n
with n variables. To do so, let n = 3. First, assume that C is an infinitesimal 3-cell.
We have that
(cid:18) (cid:19)
∂g ∂g ∂g
φ·∇gdxdydz = φ +φ +φ dxdydz.
1 2 3
∂x ∂y ∂z
As we already discussed in Subsection 3.1, (∂g/∂x)dxdydz, (∂g/∂y)dxdydz, and
(∂g/∂z)dxdydz are the approximated fluxes passing through the three pairs of faces
of C parallel to the yz, xz, and xy planes, respectively. Hence, φ·∇gdxdydz is a
weightedsumoftheabovethreefluxes´. Here, byconsideringanadmissiblecollection
Γ of 3-cells for C , we can say that − φ·∇gdxdydz is approximately the sum of
i Ci
the above weighted sums varying on different cells in Γ. Note that´since ∥φ∥ ≤ 1,
∞
we have that φ (∂g/∂x ) ≤ |∂g/∂x |. Hence, when we maximize − φ·∇gdxdydz
i i i U
to obtaint TV (g), in fact we are somehow measuring variations of g while moving
n
slowly through U.
4. PEACEs of Continuous Random Vectors
Assume that Ω ⊆ Rn is open, and W = g(X), where g : Ω → R is integrable.
In this section, we define the PEACE of degree d of a random vector on an output
variable. Then, we justify why our definition of PEACE is causally significant.
Furthermore, assume that λ(Γ) is the PEACE of degree d of X| on W for any open
Γ
subset Γ of Ω. We show that λ extends to a Borel regular measure on Ω.
First of all, we define the PEACE of X on W as follows:
ˆ
(cid:26) (cid:27)
PEACE(X → W) := sup gdiv(φ)dx : φ ∈ C1(Ω,Rn), |φ| ≤ f2 ,
c X
Ω
where f is the probability density function of X.
X
Now we justify why the above formula captures causality. To do so, let n = 3,
X = (X,Y,Z), and let g : U → R be continuously differentiable, where U is an open
subset of Rn . Then, Equation (5) holds, where {C }∞ is an admissible compact
i i=0
cover for U. Hence, it is enough to justify our formula when C is an infinitesimal
i
3-cell centered at (x,y,z) whose side lengths are ∆x,∆y and ∆z. In this case, it
follows from Equation (5) that
ˆ
gdiv(φ)dxdydz ≈ −φ·∇g∆x∆y∆z,
Ci
while we have that
(cid:18) (cid:19)
∂g ∂g ∂g
φ·∇g∆x∆y∆z = φ +φ +φ ∆x∆y∆z.
1 2 3
∂x ∂y ∂z
Foranyy−∆y/2 ≤ y′ ≤ y+∆y/2andz−∆z/2 ≤ z′ ≤ z+∆z/2, (∂g/∂x)(x,y,z)∆x
isapproximatelythedifferencebetweenthevaluesofg atthepoints(x−∆x/2,y′,z′)
and (x + ∆x/2,y′,z′). Therefore, (∂g/∂x)(x,y,z)∆x∆ydz is the total difference
considered on these two faces of C . A similar interpretation holds for the other
i
two terms (i.e., (∂g/∂y)(x,y,z)∆x∆y∆z and (∂g/∂z)(x,y,z)∆x∆y∆z). Here, we
14have considered X, Y, and Z as independent variables. Thus, all dependencies be-
tween these variables have been cut, which is an intervention. Consequently, each of
(∂g/∂x)(x,y,z)∆x∆y∆z, (∂g/∂y)(x,y,z)∆x∆y∆z, and (∂g/∂z)(x,y,z)∆x∆y∆z
reflects the causal effect obtained by intervening on the values of X,Y and Z with
respect to three different interventional changes as follows:
(1) keeping y and z constant, and changing x from x − ∆x/2 to x + ∆x/2
(corresponded to (∂g/∂x)(x,y,z)∆x∆y∆z),
(2) keeping x and z constant, and changing y from y − ∆y/2 to y + ∆y/2
(corresponded to (∂g/∂y)(x,y,z)∆x∆y∆z), and
(3) keeping x and y constant, and changing z from z −∆z/2 to z +∆z/2 (cor-
responded to (∂g/∂z)(x,y,z)∆x∆y∆z).
Also,−φ ,−φ and−φ areprobabilisticweightsforthesethreesinglecausaleffects.
1 2 3
We note that
(cid:115)
(cid:18)
∂g
(cid:19)2 (cid:18)
∂g
(cid:19)2 (cid:18)
∂g
(cid:19)2
∇g·φ∆x∆y∆z ≤ |∇g||φ|∆x∆y∆z = |φ| + |φ| + |φ| ∆x∆y∆z.
∂x ∂y ∂z
Hence, (∂g/∂x)∆x∆y∆z ≈ (g(x+∆x/2,y,z)−g(x−∆x/2,y,z))∆y∆z. Select-
ing each component of this difference has approximately the density f (x,y,z), and
X
hence when we randomly and independently select both components, we have the
density f2. Hence, we can assume that |φ| ≤ f2 (in the proof of Theorem 4.6, we
X X
will see that the aforementioned supremum is obtained when φ equals (∇g/|∇g|)f2
X
on the points with ∇g ̸= 0).
We define the PEACE of degree d of X on W as follows:
ˆ
(cid:26) (cid:27)
PEACE (X → W) := sup gdiv(φ)dx : φ ∈ C1(Ω,Rn), |φ| ≤ f2d .
d c X
Ω
Here, when d increases, the points with higher density have a greater contribution
in determining the value of PEACE. Hence, we will have a spectrum for the values
of PEACE. Since, φ ≡ 0 is in C1(Ω,Rn), the value 0 belongs to the above set,
c
and hence PEACE (X → W) ≥ 0. In the following proposition, by considering
d
countable families of pair-wise disjoint open subsets of Ω, we show that PEACE is
countably additive.
Proposition 4.1. Let {Ω }∞ be a family of pair-wise disjoint open subsets of Rn,
i i=0
and Ω =
(cid:83)∞
Ω . Then, we have that
i=0 i
∞
(cid:88)
PEACE (X → Y) = PEACE (X| → Y).
d d Ωi
i=0
Proof. See Appendix C. □
In the following, by considering countable families of open subsets of Ω, we show
that PEACE is countably subadditive
15Proposition 4.2. Let {Ω }∞ be a family of open subsets of Rn, and Ω = (cid:83)∞ Ω .
i i=0 i=0 i
Then, we have that
∞
(cid:88)
PEACE (X → Y) ≤ PEACE (X| → Y).
d d Ωi
i=0
Proof. See Appendix C. □
Now, we show that PEACE is monotone.
Proposition 4.3. Let Ω and Γ be two open subsets of Rn with Γ ⊆ Ω. Then,
PEACE (X| → Y) ≤ PEACE (X → Y).
d Γ d
Proof. See Appendix C. □
In the following theorem, we show that PEACE on open subsets of Ω can be
extended to a Borel regular measure.
Theorem 4.4. Denote the set of all open subsets of Ω by τ. Define λ : τ → [0,∞]
by λ(Γ) = PEACE (X| → Y). Then, define µ : P(Ω) → [0,∞] by
d Γ
µ(E) := inf{λ(Γ) : E ⊆ Γ, Γ ∈ τ}.
Then, µ is an outer measure. Moreover, µ is a Borel regular measure.
Proof. See Appendix C. □
Remark 4.5. Considering Theorem 4.4, one could use Proposition 4.3 to show that
µ = λ on τ.
In the following theorem, we show that how continuously differentiability of g
could lead us to a handy and easily computable formula for PEACE.
Theorem 4.6. Let Y = g(X) with g ∈ C1(Ω,R), where Ω is a bounded open subset
of Rn. Then, we have that
ˆ
PEACE (X → Y) = |∇g(x)|f2d(x)dx.
d X
Ω
Proof. See Appendix B. □
Corollary 4.7. Theorem 4.6 holds even when Ω is not bounded.
Proof. See Appendix B. □
The following theorem supports that PEACE is causally significant.
Corollary 4.8. Let Y = g(X) with g ∈ C1(Ω,R), where Ω is an open subset
of Rn. Also, let Γ be the the set of all points x ∈ Ω with f (x) ̸= 0. Then,
X
PEACE (X → Y) = 0 if and only if g| is locally constant. Consequently, if in
d Γ
addition Ω is connected, then PEACE (X → Y) = 0 if and only if g| is constant.
d Γ
Proof. See Appendix B. □
16Now, we introduce the notation g . In fact, when we use the notation g against
in in
g, we mean that the domain of g is an n-cell C, while the domain of g is an open
in
subset Ω of C defined by some functional relationships. Hence, all variables in C
are independent, while this might not be true for the variables in Ω. In other words,
g is obtained from g after removing all functional relationships defining X and Z.
in
The index in here comes from the word “intervention”.
Now, let Y = g(X,Z) with g : Ω → R, where X = (X ,...,X ) and Z =
1 n
(Z ,...,Z ), and Ω ⊆ Rn+m is open. Assume that π : Rn+m → Rn is the projection
1 m
of Rn+m on Rn (i.e., π(x,z) = x). For a fixed Z = z, we denote the probability
density function of X given Z by f . We intend to formulate the PEACE of degree
X|Z
d of X on Y. To do so, we define the probabilistic interventional easy variation of
degree d of X on Y keeping Z = z as follows:
ˆ
(cid:26) (cid:27)
PIEVz(X → Y) := sup g (x,z)div(φ)(x)dx : φ ∈ C1(U,Rn), |φ| ≤ f2d (·,z) ,
d in c X|Z
U
where U = π(Ω). Then, we define the PEACE of degree d of X on Y as follows:
PEACE (X → Y) := 4dE (PIEVz(X → Y)).
d Z d
We note that all previous results about PEACE for the functions of the form of Y =
g(X) hold for PIEVz(X → Y) as well. The changes required in the aforementioned
d
results are to replace f2d with f2d (·,z), Ω with the domain of X, and g with
X X|Z
(g ) : U → R defined by setting (g ) (x) = g (x,z).
in z in z in
In the following proposition, we investigate the effect of the change of variables
on the PEACE formula. Especially, we show that isometry change of variables do
not affect the value of PEACE.
Proposition 4.9. Let Y = g(X,Z) with g ∈ C1(Ω,R) and X = h(W), where Ω is
an open subset of Rn+m, W ∈ Rn, and h is a diffeomorphism. Then
(1) In general, we have that
ˆ
(cid:12) (cid:12)
PIEVz(W → Y) = (cid:12) (cid:12)Jac(h)(h−1(x))∂g in (x,z)(cid:12) (cid:12)(cid:0)(cid:12) (cid:12)det(cid:0) Jac(h)(h−1(x))(cid:1)(cid:12) (cid:12)f(x|z)(cid:1)2d dw.
d (cid:12) ∂x (cid:12)
Γ
(2) If h is an affine function defined by X = h(W) = AW +a, where A is an
n×n invertible matrix whose entries are real numbers, then
ˆ
(cid:12) (cid:12)
PIEVz(W → Y) = (cid:12) (cid:12)AT∂g in (x,z)(cid:12) (cid:12)(|det(A)|f(x|z))2d dw.
d (cid:12) ∂x (cid:12)
Γ
(3) If h is a restriction of an onto isometry of Rn, then
PEACE (W → Y) = PEACE (X → Y).
d d
Proof. See Appendix C. □
5. A New Formula for Total Variation
To define the PEACE of an outcome random variable with respect to a discrete
random vector, first, we need a definition for the total variation of a multivariate
discrete function. The total variation of a discrete function of two variables has been
17under a hot discussion in the recent decades (see [1, 3, 16]), since each photo, in the
classic sense, could be seen as such a function. Let Ω ⊆ Z2 and g : Ω → R, where
Z is the set of integers. Then, the total variation of g could be naturally defined as
follows:10
(cid:88) (cid:112) (cid:88)
TV(g) := ∂ g(k,l)2 +∂ g(k,l)2, TV (g) := |∂ g(k,l)|+|∂ g(k,l)|,
1 2 ani 1 2
(k,l)∈Ω (k,l)∈Ω
where
∂ g(k,l) = g(k +1,l)−g(k,l), ∂ g(k,l) = g(k,l+1)−g(k,l).
1 2
Note that if we try to reformulate the above definitions which could be used for
any domain Ω ⊆ R2 and a continuously d´ifferentiable function g : Ω → R, then we
cannot reach the true formula, which is |∇g(x)|dx. To see this, for a partition
Ω
{(x ,y ) : 0 ≤ k ≤ n, 0 ≤ l ≤ n′} for Ω, by the mean value theorem for g, for any k
k l
and l, there exist θ ∈ (x ,x ) and η ∈ (y ,y ) in such a way that
k k k+1 l l l+1
(cid:115)
(cid:112)
(cid:18)
∂g
(cid:19)2 (cid:18)
∂g
(cid:19)2
∂ g(x ,y )2 +∂ g(x ,y )2 = (θ ,y ) ∆x + (x ,η ) ∆y .
1 k l 2 k l k l k k l l
∂x ∂y
Hence, ∆x ,∆y → 0, does not yield that TV(g) is the integral mentioned above.
k l
A similar argument shows that TV (g) does not equal the above integral as well.
ani
In [1], a complicated alternative definition has been proposed for the total variation
of a discrete function applicable in image denoising. This definition comes from an
interpolation of a discrete function, and hence it is a continuous point of view for
the discrete total variation of a function. Note that this definition yields an integral
such as the above.
In this section, we provide a new formula for the total variation of a multivariate
discrete function compatible with the continuous definition. To do so, we use the
idea of the flux of a function that we previously used in the continuous case. In this
section and Section 6, we study the PEACE of X on Y when Y = g(X). However,
all the content we discuss is satisfied when we have that Y = g(X,Z). Here, we
need to replace PEACE (X → Y) with NPIEVz(X → Y) = 4dPIEVz(X → Y),
d d d
and define PEACE (X → Y) = E (NPIEVz(X → Y)). Also, we need to replace g
d Z d
with g and naturally modifying some notations (e.g., replacing ∇g with ∂g /∂x).
in in
Let Y = g(X), where X = (X ,...,X ), and Supp(X ) = {x ,...,x }, where
1 n i i1 ini
x < ··· < x for any i. Let 2 ≤ j ≤ n for any i. Then, by a discrete-like n-cube
i1 ini i i
C(x ,...,x ), we mean the set of points (α ,...,α ), where α ∈ {x ,x }
1j1 njn 1 n i iji i,ji−1
for any i. For any 1 ≤ i ≤ n, a face-like F(x ,...,x ;x ) of C(x ,...,x )
1j1 njn iji 1j1 njn
is obtained when we fix α = x . Similarly, the face-like F(x ,...,x ;x )
i iji 1j1 njn i,ji−1
is defined, when we fix α = x . We call the above two face-likes the par-
i i,ji−1
allel face-likes (see Figure 5). Let Γ be the set of all discrete-like n-cubes
obtained from (cid:81)n Supp(X ). Let φ : Γ → Rn be an arbitrary function with
i=1 i
|φ| ≤ 1. For simplicity, assume that φ = φ(C(x ,...,x )), and φ =
j1,...,jn 1j1 njn j1,...,jn
10These two formulas are used for image denoising.
18Figure 5. The set of the vertices of each of the small cubes and
their faces are a cube-like and a face-like, respectively.
(cid:16) (cid:17)
φ(1) ,...,φ(n) . Now, we define the φ-flux of g passing through these two
j1,...,jn j1,...,jn
parallel face-likes, denoted by Flux(i)(x ,...,x ) as follows:
φ 1j1 njn
Flux(i)(x ,...,x ) := dif(i)(C(x ,...,x ))φ(i) Vol(F(x ,...,x ;x )),
φ 1j1 njn g 1j1 njn j1,...,jn 1j1 njn iji
where
 
dif(i)(C(x ,...,x )) := 1   (cid:88) (cid:0) g(x)−g(x′)(cid:1) 
g 1j1 njn 2n−1  
 
x∈F(x1j1,...,xnjn;xiji)
x′ i=xi,ji−1,∀k̸=ix′ k=x
k
is the mean of the differences of g on corresponding points of a pair of parallel
face-likes, Vol(F(x ,...,x ;x )) =
((cid:81)n
∆x )/∆x , and ∆x = x −
1j1 njn iji k=1 kj k iji kj k kj k
x for any 1 ≤ k ≤ n. Next, we define the φ-flux of g passing through
k,j −1
k
C(x ,...,x ) as the sum of φ-fluxes of g passing through all pairs of parallel
1j1 njn
face-likes of C(x ,...,x ):
1j1 njn
n
(cid:88)
Flux (x ,...,x ) := Flux(i)(x ,...,x ).
φ 1j1 njn φ 1j1 njn
i=1
Finally, we define the φ-variation and the total variation of g as follows, respectively:
(cid:88)
TV (g) := Flux (x ,...,x ), TV(g) := supTV (g).
φ φ 1j1 njn φ
φ
j1,...,jn
Proposition 5.1. Considering the above assumptions, define
Flux(i)(x ,...,x ) := dif(i)(C(x ,...,x ))Vol(F(x ,...,x ;x )).
1j1 njn g 1j1 njn 1j1 njn iji
Then, if
(cid:118)
(cid:117) n
(cid:117)(cid:88)
Flux(x ,...,x ) := (cid:116) Flux(i)(x ,...,x )2,
1j1 njn 1j1 njn
i=1
19we have that
n
(cid:88)
TV(g) = Flux(x ,...,x ).
1j1 njn
j1,...,jn
Proof. See Appendix C. □
Remark 5.2. One could see that for n = 1, this definition of total variation coin-
cides with the previous definition given in [7]11.
The above definition of total variation could be generalized to the continuous
case as well. Let Y = g(X) with g : Ω → R, where X ,...,X are continuous
1 n
random variables, and Ω is an open subset of Rn. Assume that {C }∞ is an
j j=0
admissible compact cover for Ω. Let φ ∈ C1(C,Rn) with ∥φ∥ ≤ 1 and φ =
c ∞
(φ(1),...,φ(n)). There exists N such that j ≥ N implies that Supp(φ) ⊆ C . Fix
0 0 j
j ≥ N , and let C ⊆ C = [a ,b ]×···×[a ,b ]. A partition for C is obtained as
0 j 1 1 n n
P × ··· × P , where P ∈ P([a ,b ]) for any i. We denote the set of all partitions
1 n i i i
of C by P(C). For any P ∈ P(C), set P = (cid:81)n {x(P),...,x(P)}. Now, we define
i=1 i0 ini
Flux(i)(x(P),...,x(P);x(P) ) as follows
φ i0 ini j1,...,jn
dif(i)(C(x(P),...,x(P)))φ(i)(x(P) )Vol(F(x(P),...,x(P);x(P))),
g i0 ini j1,...,jn i0 ini iji
where x(P) is an arbitrary point in C(x(P),...,x(P)). Next, we define
j1,...,jn i0 ini
n
(cid:88)
Flux (x(P),...,x(P);x(P) ) := Flux(i)(x(P),...,x(P);x(P) )
φ i0 ini j1,...,jn φ i0 ini j1,...,jn
i=1
as before. Finally, we define the discrete-like φ-variation and total variation of g as
follows, respectively:
(cid:88)
TVdis(g) := lim Flux(x(P),...,x(P);x(P) ),
φ
∥P∥→0
1j1 njn j1,...,jn
j1,...,jn
TVdis(g) := supTVdis(g),
φ
φ
where ∥P∥ is the maximum of the diameters of the discrete-like n-cubes of P. One
could see that if g is continuously differentiable or a Lipschitz function12, then the
above definitions of φ-variation and total variation are well-defined (they do not
depend on the choice of x and the admissible compact cover for Ω).
j1,...,jn
11Let Y =g(X), where X is a discrete random variable for which Supp(X)={x ,...,x } with
0 l
x < ··· < x . Then, the total variation of g is defined to be the total variation of the sequence
0 l
g(x ),...,g(x ), namely,
(cid:80)l
|g(x )−g(x )|.
0 l i=1 i i−1
12g is called a Lipschitz function if there exists M >0 in such a way that for any x,x′ ∈Ω, we
have that |g(x)−g(x′)|≤M|x−x′|.
206. PEACE in Discrete Case
In this section, we define the PEACE formula for discrete random vectors. To do
so, we use the total variation formula that we defined in Section 5, which is based
on the idea of the flux of a function and the definition of the PEACE formula in the
continuous case.
Let φ : Γ → Rn with |φ| ≤ w , where Γ is the set of all discrete-like n-cubes of
X,d
(cid:81)n Supp(X ), and w : Γ → R is defined by
i=1 i X,d
 
4d (cid:88)n 1  (cid:88) 
ω (C(x ,...,x )) =  Pd (x)Pd (x′).
X,d 1j1 njn n 2n−1  X X 
 
i=1 x∈F(x1j1,...,xnjn;xiji)
x′ i=xi,ji−1,∀k̸=ix′ i=xi
Intiuitively,ω (C(x ,...,x )) = 4dE(cid:0)E (cid:0)P (X)dP (X′)d(cid:1)(cid:1) ,wheretheran-
X,d 1j1 njn X
Ufm
X X
domvariableX isX| thatuniformlytakesitsvalues. Wenotethat
P (x)P (x′) isU tf hm e probF a(x b1 ij l1 i, t.. y.,x onj fn r;x aij ni) domly and independently selecting x and x′,
X X
respectively, that could be thought of the availability of the interventional change
g(x)−g(x′). Also, the outer expected value in the above formula for ω is a uni-
X,d
form average over the set of parallel face-likes of C(x ,...,x ). Now, considering
1j1 njn
the above notations, we define the probabilistic φ-flux (PFlux ) of g passing through
φ
the parallel face-likes F(x ,...,x ;x ) and F(x ,...,x ;x ), as follows:
1j1 njn iji 1j1 njn i,ji−1
PFlux(i)(x ,...,x ) := dif(i)(C(x ,...,x ))φ(i) Vol(F(x ,...,x ;x )),
φ 1j1 njn g 1j1 njn j1,...,jn 1j1 njn iji
We also define
n
(cid:88)
PFlux (x ,...,x ) := PFlux(i)(x ,...,x ).
φ 1j1 njn φ 1j1 njn
i=1
Finally, we define the φ-PEACE and the PEACE of degrees d of X on Y as
follows, respectively:
(cid:88)
PEACEφ(X → Y) := PFlux (x ,...,x ),
d φ 1j1 njn
j1,...,jn
PEACE (X → Y) := supPEACEφ(X → Y).
d d
φ
The following proposition could be shown similarly to the proof of Proposition 5.1.
Proposition6.1. Consideringtheaboveassumptions, definePFlux(i)(x ,...,x )
1j1 njn
as follows:
ω (C(x ,...,x ))dif(i)(C(x ,...,x ))Vol(F(x ,...,x ;x )).
X,d 1j1 njn g 1j1 njn 1j1 njn iji
Then, if
(cid:118)
(cid:117) n
(cid:117)(cid:88)
PFlux(x ,...,x ) := (cid:116) PFlux(i)(x ,...,x )2,
1j1 njn 1j1 njn
i=1
21we have that
n
(cid:88)
PEACE (X → Y) = PFlux(x ,...,x ).
d 1j1 njn
j1,...,jn
In the case that X and Y are continuous random variables, using an admissible
compact cover for Ω (as in Section 5), we define the discrete-like φ-PEACE and
PEACE as follows, respectively:
(cid:88)
PEACEφ,dis(X → Y) := lim PFlux (x(P),...,x(P);x(P) ),
d
∥P∥→0
φ 1j1 njn j1,...,jn
j1,...,jn
PEACEdis(X → Y) := supPEACEφ,dis(X → Y),
d d
φ
where x(P) is an arbitrary point in C(x(P),...,x(P)). Similar to the discussion in
j1,...,jn 1j1 njn
Section5, onecouldseethatifg iscontinuouslydifferentiableoraLipschitzfunction,
then the above definitions of φ-PEACE and PEACE are well-defined. Note that, for
the continuous case, we assume that φ ∈ C1(C,Rn) with |φ| ≤ f2d. The previous
c X
assumption is a replacement for the assumption |φ| ≤ ω in the discrete case13.
X,d
In the following theorem, we show that our definitions of PEACE in discrete and
continuous cases are compatible.
Theorem 6.2. Let Y = g(X) with g ∈ C1(Ω,R), where Ω is a bounded open subset
of Rn. Then,
ˆ
PEACEdis(X → Y) = PEACE (X → Y) = |∇g|f2ddx.
d d X
Ω
Proof. See Appendix C. □
7. Identifiability of PEACE
Let F be a formula associating a quantity F(S) to an SEM S. Roughly speaking,
we say that F is identifiable under the assumption A, if F(S) could be computed
only by using observed variables for any SEM S under the assumption A (see [7]).
Let Y = g(X,Z,U ), where U is an unobserved random variable. We say that g
Y Y in
is separable with respect to Z if we can write g(X,Z,U ) = g(1)(X,Z)+g(2)(Z,U ).
Y Y
One could see that if g has the partial dervative with respect to X, then g is
in
separable with respect to Z if and only if (∂g /∂X)(X,Z,U ) is a function of X
in Y
and Z. From this fact, and the proof of [7, Theorem 4.19], one could show the
following theorem and its corollary:
Theorem 7.1. Let Y = g(X,Z,U ), and g has the partial derivative with respect
Y in
to X, and the following conditions are satisfied for any x ∈ Supp(X) and z ∈
Supp(Z):
(1) g (X,Z,U ) is separable with respect to Z, and
in Y
(2) Given U , the random variables X and Z are independent.
Y
13Whenwedecreasethediameterofacubeto0, thenwecanassumethatallprobabilityvalues
in the definition of ω are equal to fd(x ), and hence in the continuous case, ω ≈f2d.
X,d X j1,...,jn X,d X
22Then, PEACE (X → Y) is identifiable. Besides, if we have the following additional
d
assumptions for any x ∈ Supp(X) and z ∈ Supp(Z):
(3) Given Z, Y and X are independent,
x,z
(4) Y is a one-to-one function of (U ) , and
x,z Y x,z
(5) Y and Z are independent,
x,z
then, we have that
ˆ
PIEV(z,uy) (X → Y) =
(cid:12)
(cid:12)
(cid:12)∂E(Y|X,Z) (x,z)(cid:12)
(cid:12) (cid:12)f2d(x|z)dx,
d (cid:12) ∂X (cid:12)
Supp(X)
(cid:16) (cid:17)
PEACE (X → Y) = E PIEV(z,uy) (X → Y) .
d Z d
Corollary 7.2. Let Y = Xα+Zβ+γU , where γ ̸= 0. If Z and X are independent
Y
given U , then PEACE (X → Y) is identifiable, and we have that
Y d
ˆ
PIEV(z,uY)(X → Y) = |α| f2d(x|z)dx.
d
Supp(X)
Further, if the following assumptions hold for any x ∈ Supp(X) and z ∈ Supp(Z):
• Given Z, Y and X are independent, and
x,z
• Y and Z are independent,
x,z
then, we have that
(cid:12) (cid:12)∂E(Y|X,Z)(cid:12)
(cid:12)
|α| = (cid:12) (cid:12).
(cid:12) ∂X (cid:12)
8. Positive and Negative PEACEs
In[7,Section4.6],wedefinedthepositiveandthenegativePEACEsinthediscrete
case. Now, we discuss these concepts in the continuous case.
Let X and Z be a random variable and a random vector, respectively. Also,
let Y = g(X,Z), where Supp(X) ⊆ [a,b]. Similar to the discrete case, by the
positive/negative interventional variation of X on Y, we mean only to account for
the positive interventional changes of Y due to the increase in the value of X and
keeping Z constant. The positive/negative probabilistic interventional easy variation
of Y with respect to X has a similar interpretation. Indeed, for ε ∈ {±}, we define
PIEVz(X → Y)ε := lim Lz (X → Y)ε, P ∈ P([a,b]),
d P,d
∥P∥→0
(cid:88)nP
(cid:16) (cid:17)ε
Lz (X → Y)ε := g(x(P))−g(x(P)) f(x(P)|z)df(x(P)|z)d.
P,d i i−1 i i−1
i=1
Theorem 8.1. Assume that Y = g(X,Z) has the continuous partial derivatives
with respect to X, and Supp(X) ⊆ [a,b]. Then, we have that
ˆ
b(cid:18)
∂g
(cid:19)ε
PIEVz(X → Y)ε = in (t,z) f2d(t|z)dt, ε ∈ {±}.
d ∂x
a
Proof. See Appendix C. □
23Now, we generalize our definition to include the random variables X whose sup-
ports are not necessarily bounded. To do so, assume that Supp(X) ⊆ [a,∞). Then,
we define
PIEVz(X → Y)+ := lim lim Lz (X| → Y)+.
d P,d [a,b]
b→∞P∈P([a,b])
∥P∥→0
Similarly, if Supp(X) ⊆ (−∞,b], we define
PIEVz(X → Y)+ := lim lim Lz (X| → Y)+.
d P,d [a,b]
a→−∞P∈P([a,b])
∥P∥→0
Finally, if Supp(X) ⊆ (−∞,∞), we define PIEV(X → Y)+ as follows:
lim lim Lz (X| → Y)+ + lim lim Lz (X| → Y)+.
P,d [a,0] P,d [0,b]
a→−∞P∈P([a,0]) b→∞P∈P([0,b])
∥P∥→0 ∥P∥→0
Corollary 8.2. Theorem 8.1 holds also for any random variable X which does not
necessarily satisfy Supp(X) ⊆ [a,b].
Proof. It is straightforward. □
Corollary 8.3. Under the assumptions of Corollary 8.2, we have that
PIEVz(X → Y) = PIEVz(X → Y)+ +PIEVz(X → Y)−.
d d d
Remark 8.4. Let Y = g(X,Z) with Supp(X) ⊆ (a,b). Another alternative defini-
tion for PIEVz(X → Y)+ (resp. PIEVz(X → Y)−) is as follows:
ˆ
(cid:26) (cid:27)
sup g φ′dx : φ ∈ C1(Γ,R),|φ| ≤ f2d(·|z) ,
in c
Γ
where Γ is an open subset of (a,b) consisting of all points x ∈ (a,b) for which there
exist r in such a way that the restriction of g (·,z) to (x−r ,x+r ) is increasing
x in x x
(resp. decreasing). In this case, one could see that if g(·,z) is continuously dif-
ferentiable, then Theorem 8.1 holds. In the situations that Supp(X) is unbounded,
Corollary 8.2 holds. Furthermore, in general, Corollary 8.3 holds as well.
Now, naturally such as before, by normalizing and then taking the expected value
with respect to Z, we have the PEACE (X → Y)ε formula for ε ∈ {±}. One could
d
see that
PEACE (X → Y) = PEACE (X → Y)+ +PEACE (X → Y)−.
d d d
9. Investigating Some Examples
In this section, we investigate some causal problems to show the general capability
of our framework.
24PEACEs Corresponding to Independent Uniform Discrete Random Vari-
ables. Let Y = Xα+Zβ in such a way that X given Z has a uniform distribution.
Assume that Supp(X ) = {1,2,...,n } for any i. Then, by using the notations of
i i
Proposition 6.1, we have that ω ≡ 1/(n ···n )2d, and dif(i) ≡ α . It follows
X|Z,d 1 m i
that PFlux(i) ≡ α /(n ···n )2d, and hence PFlux ≡ |α|/(n ···n )2d. Therefore,
i 1 m 1 m
(n −1)···(n −1)|α|
1 m
PIEV (X → Y) = .
d (n ···n )2d
1 m
Hence,
4d(n −1)···(n −1)|α|
PEACE (X → Y) = 1 m .
d (n ···n )2d
1 m
Newton’s Second Law. Assume that a force f is applied to an object of mass
m as shown in Figure 6. Consequently, a friction force f resists the movement
0
of the object. Assume that f overcomes f , and the object starts moving. Then,
0
by Newton’s second law of motion, we have that f − f = ma, where a is the
0
acceleration of the object. Consider a specific moment when the object is moving,
and the friction force F due to environmental factors has a random nature and acts
0
against a random force F >> F . Hence, in this specific moment, we can assume
0
that F and F are independent, and F ∼ N(µ,σ2) and F ∼ N(µ ,σ2). It follows
0 0 0 0
that a has a random nature as well. Let A be the random variable describing the
value of a. Then, we have that A = g(F,F ) = (F −F )/m. Therefore, for d > 0,
0 0
we have that
ˆ ˆ
PIEVF0=β(F → A) ≈ ∞ (cid:12) (cid:12) (cid:12)∂g (α,β)(cid:12) (cid:12) (cid:12)f2d(α)dα = 1 ∞ f2d(α|β)dα
d (cid:12)∂F (cid:12) F m F
−∞ ˆ −∞ ˆ
=
1 ∞ e−d(α− σµ)2
dα = √
1 ∞ e−α 22
dα
m(2πσ2)d m 2d(2π)dσ2d−1
−∞ −∞
√
2π 1
= √ = √ .
m 2d(2π)dσ2d−1 m d2dπd−1σ2d−1
2
Hence,
(cid:18) (cid:19)
1
PEACE (F → A) ≈ E PIEVF0=β(F → A) = √ .
d F0 d m d2dπd−1σ2d−1
2
Similarly, we have that
(cid:18) (cid:19)
1
PEACE (F → A) ≈ E PIEVF=β(F → A) = √ .
d 0 F d 0 m d2dπd−1σ2d−1
2 0
25f
f m
0
Figure 6. An object of mass m that is affected by a force f and
consequently the friction force f .
0
6
PEACE (F →A) PEACE (F →A)
d d
PEACE d(F 0 →A) 40 PEACE d(F 0 →A)
PEACE ((F,F )→A)
d 0
4 30
20
2
10
0
0
0.2 0.4 0.6 0.8 1 0.2 0.4 0.6 0.8 1
d d
(a) (b)
Figure 7. The PEACEs of degree d of F, F , and (F,F ) on A for
0 0
σ = 0.1, σ = 0.05, and m = 1kg.
0
Further,
ˆ ˆ
∞ ∞
PEACE ((F,F ) → A) = |∇g(α,β)|f2d (α,β)dαdβ
d 0 (F,F0)
√−∞ ˆ−∞ ˆ
2 (cid:18) ∞ (cid:19)(cid:18) ∞ (cid:19)
= f2d(α)dα f2d(β)dβ
m F F0
−∞ −∞
√ (cid:32) (cid:33)
(cid:18) (cid:19)
2 1 1
= √ √
m d2dπd−1σ2d−1 d2dπd−1σ2d−1
2 2 0
1
= .
m22d−1dπ2d−1(σσ )2d−1
2 0
PEACEs Corresponding the joint of Random Variables vs PEACEs Cor-
responding to Each of the Variables. Let X and Z be continuous random
vectors, y = g(X,Z), and X = (X ,...,X ). Assume that g has continuous par-
1 m
tial derivatives with respect to variables in X. We can generalize the definition of
PEACE in the following sense:
ˆ
PEACE(r)(X → Y) := E (X → Y) := PIEVz(X → Y)fr(z)dx.
d Z(r) d Z
26
ECAEP
dHence, forgreaterr, theabovemeanismoredependentonthegreaterdensityvalues
of Z rather than the smaller ones. Now, first, we get a lower and an upper bound
for PEACE(2d)(X → Y) in terms of the values PEACE(2d)(X → Y). To do so, by
d d i
setting Xi = (X ,...,X ,X ,...,X ) and Wi = (Xi,Z), we have that
1 i−1 i+1 m
¨
(cid:12) (cid:12)
PEACE(2d)(X → Y) = (cid:12) (cid:12)∂g (x,z)(cid:12) (cid:12)f(x|z)2df(z)2ddxdz
d (cid:12)∂x (cid:12)
¨
m (cid:12) (cid:12)
(cid:88)(cid:12) ∂g (cid:12)
≤ (cid:12) (x ,wi)(cid:12)f(x|z)2df(z)2ddxdz
i
(cid:12)∂x (cid:12)
i
i=1
¨
m (cid:12) (cid:12)
(cid:88) (cid:12) ∂g (cid:12)
= (cid:12) (x ,wi)(cid:12)f(x |xi,z)2df(xi|z)2df(z)2ddx dwi
i i i
(cid:12)∂x (cid:12)
i
i=1
¨
m (cid:12) (cid:12)
(cid:88) (cid:12) ∂g (cid:12)
= (cid:12) (x ,wi)(cid:12)f(x |wi)2df(wi)2ddx dwi
i i i
(cid:12)∂x (cid:12)
i
i=1
m
(cid:88)
= PEACE(2d)(X → Y).
d i
i=1
Similarly,byusingthewell-knownfactthatthequadraticmeanofsomenon-negative
numbers is not less than the arithmetic means of them, we have that
m
1 (cid:88)
PEACE(2d)(X → Y) ≥√ PEACE(2d)(X → Y).
d n d i
i=1
Now, consider the case that g is linear and for any i, X and Xi are independent
i
given Z. Then, if Y = Xα+Zβ, where α and β are column vectors, we have that
¨ ¨
m
(cid:89)
PEACE (X → Y) = |α|f(x|z)2df(z)dxdz = |α|f(x |z)2df(z)dx dwi
d i i
i=1
¨
(cid:89)m |α|(cid:81)m PEACE (X → Y)
= |α|f(x |wi)2df(wi)dx dwi = i=1 d i .
i i
|α ···α |
1 n
i=1
Effect of Sodium Intake and Age on the Blood Peasure. This example has
been discussed in [18] using the Pearl graphical framework. Let S, A, P, and B
denote the sodium intake, the age, the proteinuria, and the blood pressure, respec-
tively. Then, there is a causal graph as shown in Figure 8. For this example, we
use the data and the python code provided in PEACE-General). to obtain the
plots shown in Figure 9. We note that Subfigures (9a, 9b) shows that when we
increase the degree d from 0 to 1, PEACE (A → B) loses its strength against
d
PEACE (S → B) and becomes less than PEACE (S → B). This means that the
d d
“average causal change of B with respect to A for more probable subpopulations
determined by S” becomes less than the “average causal change of B with respect
to S in more probable subpopulations determined by A”. However, by Subfigures
(9c, 9d), when we increase the degree d from 0 to 1, PEACE(2d)(A → B) remains
d
superior against PEACE(2d)(S → B). Indeed, in PEACE(2d)(∗ → B), compared
d d
27A
S B
P
Figure 8. The causal graph associated to the sodium intake (S),
age (A), the proteinuria (P), and the blood pressure (B).
to PEACE (∗ → B), the density values f(#) appeared in the final average, have
d
the same power (2d) as the density values f(∗|#) for ∗,# ∈ {S,A} with ∗ ̸= #.
As we see in Figures (9e,9f), by increasing d, PEACE ((S,A) → B) becomes less
d
than both PEACE (S → B) and PEACE (A → B), while Figures (9g, 9h) say
d d
that PEACE(2d)((S,A) → B) remains superior to both PEACE(2d)(S → B) and
d d
PEACE(2d)(A → B).
d
10. Conclusion
In this paper, we extended and developed a framework, introduced in [7], for
measuring the direct causal effect of a random vector on an outcome variable in both
discrete and continuous cases. To formalize our framework, we used several concepts
andtoolsfromfunctionalanalysisandmeasuretheorysuchasintegralsonopensets,
total variation of a multivariate function, and the flux of a function passing through
a surface. Our framework has a general capability to deal with different types of
causal problems compared to the other well-known frameworks such as the Rubin-
Neyman, the Pearl, and the Janzing et al. frameworks. Indeed, we introduced and
justified a function called Probabilistic Easy Variational Causal Effect (PEACE),
which measures the total direct causal changes of an outcome Y with respect to
interventionally and continuously changing the value of the exposure/treatment X,
while keeping other variables Z unchanged. PEACE is a function of a degree d ≥ 0.
By considering small and high values for d, one could have direct causal effect
values for which the probability/density of X given Z is strengthened and weakened,
respectively. Hence, inanobservationalstudy, whenraresubpopulationsdetermined
by Z do not have important impacts on Y (e.g., the problem of the effect of a rare
noise on the quality of an image), then higher values of d are suitable. Otherwise,
smaller values of d could be used (e.g., the problem of the effect of a rare disease on
blood pressure). PEACE reflects the total absolute direct causal changes of Y with
respecttoXregardlessofbeingpositiveornegative. Thus,tomeasureseparatelythe
positive and the negative direct causal changes of Y, we introduced the positive and
negative PEACEs. Further, we showed that the PEACE of X on Y is stable under
small changes of the joint density of X and Z, and the partial derivative of Y with
in
respect to X, where Y is obtained from Y by removing all functional relationships
in
28(a) (b)
(c) (d)
(e) (f)
(g) (h)
Figure 9.
The PEACEs of sodium intake, age, and the joint of sodium
intake and age on blood pressure. The horizontal axis denotes the degree
d. Also, the vertical axis of Plots (A), (B), (E), and (F) denotes the
PEACE , while in the other plots, it denotes PEACE(2d) .
d d
29definingXandZ. Furthermore, inthepresenceofunobservedvariables, weprovided
anidentifiabilitycriterion. Moreover, wesupportedthegeneralcapabilityofPEACE
by investigating some examples.
References
1. R´emyAbergelandLionelMoisan,Theshannontotalvariation,JournalofMathematicalImag-
ing and Vision 59 (2017), no. 2, 341–370.
2. YejinBang,SamuelCahyawijaya,NayeonLee,WenliangDai,DanSu,BryanWilie,HolyLove-
nia, Ziwei Ji, Tiezheng Yu, Willy Chung, et al., A multitask, multilingual, multimodal evalua-
tion of chatgpt on reasoning, hallucination, and interactivity, arXivpreprintarXiv:2302.04023
(2023).
3. Antonin Chambolle, Total variation minimization and a class of binary mrf models, Interna-
tional Workshop on Energy Minimization Methods in Computer Vision and Pattern Recogni-
tion, Springer, 2005, pp. 136–152.
4. Louis De Branges, The stone-weierstrass theorem, Proceedings of the American Mathematical
Society 10 (1959), no. 5, 822–824.
5. Jay L Devore, Kenneth N Berk, Matthew A Carlton, et al., Modern mathematical statistics
with applications, vol. 285, Springer, 2012.
6. L Craig Evans and RF Gariepy, Studies in advanced mathematics, 1992.
7. Usef Faghihi and Amir Saki, Probabilistic variational causal effect as a new theory for causal
reasoning, arXiv preprint arXiv:2208.06269 (2022).
8. RichardJFlemingandJamesEJamison, Isometries in banach spaces: Vector-valued function
spaces and operator spaces, volume two, vol. 1, CRC press, 2007.
9. GeraldBFolland,Real analysis: modern techniques and their applications,vol.40,JohnWiley
& Sons, 1999.
10. Dominik Janzing, David Balduzzi, Moritz Grosse-Wentrup, and Bernhard Sch¨olkopf, Quanti-
fying causal influences, (2013).
11. Cyrus Kalantarpour, Usef Faghihi, Elouanes Khelifi, and Fran¸cois-Xavier Roucaut, Clinical
grade prediction of therapeutic dosage for electroconvulsive therapy (ect) based on patient’s
pre-ictal eeg using fuzzy causal transformers.
12. James R Munkres, Topology, (No Title) (2000).
13. JR Munkres, Analysis on manifolds, advanced book program, 1991.
14. Judea Pearl and Dana Mackenzie, The book of why: the new science of cause and effect, Basic
books, 2018.
15. Donald B Rubin, Estimating causal effects of treatments in randomized and nonrandomized
studies., Journal of educational Psychology 66 (1974), no. 5, 688.
16. Leonid I Rudin, Stanley Osher, and Emad Fatemi, Nonlinear total variation based noise re-
moval algorithms, Physica D: nonlinear phenomena 60 (1992), no. 1-4, 259–268.
17. Walter Rudin, Real and complex analysis, mcgraw-hill, Inc., (1974).
18. Michael Schomaker, Daniel Redondo-Sanchez, Maria Jose Sanchez Perez, Anand Vaidya, and
Mireille E Schnitzer, Educational note: Paradoxical collider effect in the analysis of non-
communicable disease epidemiological data: a reproducible illustration and web application,
arXiv preprint arXiv:1809.07111 (2018).
19. Michael Waldmann, The oxford handbook of causal reasoning, Oxford University Press, 2017.
20. Michel Willem, Functional analysis: Fundamentals and applications, Springer Nature, 2023.
30Appendix A. Some Results on Admissible Compact Covers
In the following lemma, we show that each open subset of Rn has an admissible
compact cover.
Lemma A.1. Let V be an open subset of Rn. Then, there exists a sequence {C }∞
i i=0
of rectifiable compact subspaces of V such that C ⊆ Int(C ), the boundary of C
i i+1 i
is piece-wise C1 for any i ≥ 0, and V = (cid:83)∞ C .
i=0 i
Proof. Let {a }∞ be a strictly decreasing sequence of positive real numbers con-
i i=0
verging to 0. For any non-negative integer i, assume that
1
B = {x ∈ V : inf |x−x′| ≥ a , |x| ≤ }.
i i
x′∈Rn\V a
i
Then, for any i, B is a compact subsapce of Rn, B ⊆ Int(B ), and V = (cid:83)∞ B .
i i i+1 i=0 i
However, the sets B might not be rectifiable, and their boundaries might not be
i
piece-wise C1. To solve this issue, for any i and x ∈ B , assume that V ⊆ Int(B )
i i,x i+1
is a bounded closed n-cell including x. In the rest of this proof, by “i” we mean
any i. Now, assume that U ⊆ V is an open subset of Rn including x. Then,
i,x i,x
{U : x ∈ B } is an open cover for B , which has a finite subcover {U ,...,U }
fori, Bx
by
thei
compactness of B . Set
Ci
=
(cid:83)ni
V . Then, C is
comi p,x a0
ct as a
fii,x nn ii
te
i i i j=0 i,xj i
union of compact subsets of Rn. Further, clearly B ⊆ C ⊆ Int(B ) ⊆ Int(C ),
i i i+1 i+1
and
(cid:83)∞
B ⊆
(cid:83)∞
C , and hence
(cid:83)∞
C = V. Since each n-cell is rectifiable, C is
i=0 i i=0 i i=0 i i
also rectifiable as a finite union of n-celles. Finally, the boundary of C is piece-wise
i
linear, and consequently, it is a piece-wise manifold of class C1. □
Remark A.2. In the proof of Lemma A.1, we could define
1
B = {x ∈ V : h(x) ≥ a , |x| ≤ },
i i
a
i
where h : V → R is a positive continuous function. The rest of the proof is the same
as before, and suitable C ’s could be found. Thus, we have that
i
(cid:26) (cid:27)
1
C ⊆ Int(B ) = x ∈ V : h(x) > a , |x| < .
i i+1 i+1
a
i+1
The following result is directly used in the proof of Theorem 4.6. The following
proposition is required to prove Theorem 4.6.
Proposition A.3. Let V be an open subset of Rn and {C }∞ be an admissible
i i=0
compact cover for V. Also, let C ⊆ V be compact. Then, there exists a positive
integer N such that i ≥ N implies that C ∩Bd(C ) = ∅.
0 0 i
Proof. It is enough to show that there exists N with C ⊆ C , since it follows
0 N0−1
from C ⊆ Int(C ) that C ∩ Bd(C ) = ∅ for any i ≥ N . On the contrary,
N0−1 i i 0
assume that C ⊈ C for any i. Choose x ∈ C\C for any i. It follows from the
i i i
compactness of C that {x }∞ has a convergent subsequence {x }∞ . Assume
i i=0 ij j=0
that x = lim x . There exists an index l with x ∈ C , which implies that
j→∞ ij l
x ∈ Int(C ). Let i ≥ l+1. Then, x ∈ Int(C ), and hence there exists a positive
l+1 j0 ij0
integer N ≥ j such that j ≥ N implies that x ∈ C . Now, it follows from
C ⊆ C
that0
x ∈ C , a contradiction!
ij ij0
□
ij0 iN iN iN
31Appendix B. Proof of Theorem 4.6 and Its Corollaries
To prove Theorem 4.6, roughly speaking, the idea is to build a sequence of func-
tions belonging to C1(Ω,Rn) such that their integrals on Ω tend to the integral of
c
(|∇g|/∇(g))f2d on the set of points with ∇g ̸= 0. To do so, first, we need some
X
lemmas and their corollaries. We start with the following lemma that is used to
prove Lemma B.7.
Lemma B.1. Let f(x) = max{x,0} for any x ∈ R (this function is called the
positive part or ReLU function). Then, for any ε > 0, there exists a non-negative
function ψ ∈ C1(R,R) with |ψ(x)−f(x)| < ε for any x ∈ R.
Proof. Equivalently, we show that for any ε > 0, there exists a non-negative function
ψ ∈ C1(R,R) with ψ(x) = 0 when x ≤ 0, and |ψ(x)−x| < ε when x ≥ 0. Let ε > 0.
Define
 0, x ≤ 0

ψ(x) = 2x2, 0 ≤ x ≤ ε .
ε 4
 x− ε, x ≥ ε
8 4
One could see that ψ ∈ C1(R,R). For 0 ≤ x ≤ ε/4, we have that
2x2 2x2
|ψ(x)−x| < ε ⇐⇒ −x−ε < 0 & −x+ε > 0.
ε ε
The first and the second inequalities are true for −ε/2 < x < ε and any x ∈ R,
respectively. Hence, both inequalities are true for 0 ≤ x ≤ ε/4. Clearly, for x ≥ ε/4,
we have that |ψ(x)−x| = ε/8 < ε. □
The following lemma is required to prove Corrolary B.6.
Lemma B.2. Let U and V with ∅ ≠ U ⊆ V be open subsets of Rn, and let x ∈ U.
0
Then, there exists q ∈ C1(V,R) with Supp(q) ⊆ U and q(x ) ̸= 0.
c 0
Proof. Define
(cid:26)
x2, x > 0
q : R → R, q (x) = .
0 0 0, x ≤ 0
One could see that q ∈ C1(R,R). Now, for any closed interval [a,b] with a < b, we
0
define q (x) = q (x−a)q (b−x). Then, q ∈ C1(R,R) with Supp(q ) ⊆ [a,b].
a,b 0 0 a,b c a,b
Now, for an n-cell C = [a ,b ] × ··· × [a ,b ], we define q : Rn → R by setting
1 1 n n C
q (x) = q (x )···q (x ). Obviously, q ∈ C1(Rn,R) with Supp(q ) ⊆ C.
C a1,b1 1 an,bn n C c C
Now, let C be an n-cell with x ∈ C \Bd(C ) ⊆ C ⊆ U. Then, the desired
0 0 0 0 0
function q could be selected as the restriction of (q) on V. □
C0
The following lemma is known as Urysohn’s lemma for locally compact Hausdorff
topological spaces (see [17, Lemma 2.12]).
Lemma B.3. Let X be a Hausdorff topological space and K ⊆ U ⊆ X, where K is
compact and U is an open subset of X. Then, there exists q ∈ C (X,R) in such a
c
way that 0 ≤ q ≤ 1, q| ≡ 1 and Supp(q) ⊆ U.
K
The following corollary is directly used in the proof of Theorem 4.6.
32Corollary B.4. Let X be a Hausdorff topological space and K ⊆ U ⊆ X, where K is
compact and U is an open subset of X. Also, let f : X → R be a continuous function.
Then, there exists f(cid:101) ∈ C (X,R) with f(cid:101)| = f, |f(cid:101)| ≤ |f|, and Supp(f(cid:101)) ⊆ U.
c K
Especially, if f is non-negative, then we have the additional property 0 ≤ f(cid:101)≤ f.
Proof. It follows from Lemma B.3 that there exists q ∈ C (X,R) with 0 ≤ q ≤ 1,
c
q| ≡ 1 and Supp(q) ⊆ U. Now, it is enough to assume that f(cid:101)= qf. □
K
Now, we provide some definitions and concepts that are used in Theorem B.5.
Let X be a topological space. We say that a continuous function f : X → R
vanishes at infinity if for any ε > 0, there exists a compact subspace K of X
with |f| < ε on X\K. We denote the set of all continuous functions f : X → R
that vanish at infinity by C (X,R). Note that C (X,R) is an algebra. In other
0 0
words, it is non-empty, and for any f,g ∈ C (X,R) and α ∈ R, we have that
0
f +αg ∈ C (X,R) and fg ∈ C (X,R). Further, C (X,R) is equipped with the L∞-
0 0 0
norm (i.e., ∥f∥ = sup |f(x)|). Let A be a subalgebra of C (X,R). We say that
∞ x∈X 0
A separates the points of X if for any x ,x ∈ X with x ̸= x , there exists f ∈ A
1 2 1 2
with f(x ) ̸= f(x ). Further, we say that A vanishes nowhere if for any x ∈ X
1 2
there exists f ∈ A with f(x) ̸= 0. The following is known as the Stone–Weierstrass
theorem for locally compact spaces (see [4]).
Theorem B.5. Let X be a locally compact Hausdorff topological space and A be a
subalgebra of C (X,R). Then, A is dense in C (X,R) if and only if A separate the
0 0
points of X and it vanishes nowhere.
We use the following corollary in Lemma B.7 and also directly in the proof of
Theorem 4.6.
Corollary B.6. Let U be an open subset of Rn. Then, C1(U,R) is dense in
c
C (U,R).
0
Proof. Each open subset of Rn is a locally compact Hausdorff topological space. Let
x ,x ∈ U with x ̸= x . Since U is an open subset of Rn, there exists r > 0 with
1 2 1 2
B(x ,r) = {y ∈ Rn : |x − y| < r} ⊆ U. Let r′ = min{r,|x − x |}. Then, by
1 1 1 2
Lemma B.2, there exists q ∈ C1(U,R) with Supp(q) ⊆ B(x ,r′/2) and q(x ) ̸= 0.
c 1 1
Also, since x ∈/ B(x ,r′/2), we have that q(x ) = 0. Thus, C1(U,R) vanishes
2 1 2 c
nowhere, and it separates the points of U. Therefore, it follows from Theorem B.5
that C1(U,R) is dense in C (U,R). □
c 0
In the proof of Theorem 4.6, we use the following lemma to approximate f2d with
X
a compactly supported continuously differentiable function (see Approximations of
continuous functions by compactly supported smooth functions with a criterion).
Lemma B.7. Let f : U → R be a non-negative continuous function which vanishes
at infinity. Then, for any ε > 0, there exists a non-negative function g ∈ C1(U,R)
c
with 0 ≤ f −g < ε.
Proof. Let ε > 0. It follows from Corollary B.6 that there exists g ∈ C1(U,R) with
1 c
|f−g | < ε/4. Assume that g = g −ε/2. Then, we have that ε/4 < f−g < 3ε/4.
1 2 1 2
33It follows from Lemma B.1 that there exists a non-negative function ψ ∈ C1(R,R)
c
in such a way that ψ(x) = 0 for x ≤ 0, and |ψ(x)−x| < ε/4 for x > 0. Set g = ψ◦g .
2
Then, g ≥ 0. Now, we show that 0 ≤ f − g < ε. Let x ∈ U. First, assume that
g (x) > 0. Then, it follows from |ψ(g (x))−g (x)| < ε/4 that |g(x)−g (x)| < ε/4,
2 2 2 2
and hence
f(x)−g(x)
ε ε (cid:122) (cid:125)(cid:124) (cid:123) 3ε ε
0 = − < (f −g )(x)+(g −g)(x) < + = ε.
2 2
4 4 4 4
Next, assume that g (x) ≤ 0. Then, g(x) = ψ(g (x)) = 0, and hence g (x) ≤ g(x).
2 2 2
Thus,
3ε
0 ≤ f(x) = f(x)−g(x) ≤ f(x)−g (x) < < ε.
2
4
Therefore, we have that 0 ≤ f −g < ε. □
Proof of Theorem 4.6. Let φ ∈ C1(Ω,Rn) with |φ| ≤ f2d. We define R : Ω → R
c X
by setting R(x) = φ(x)g(x) for any x ∈ Ω. Then, by Equation (4), div(R) =
∇g · φ + gdiv(φ). Such as before, let {C }∞ be an admissible compact cover for
i i=0
Ω. Then, by Proposition A.3, there exists a positive integer N in such a way that
0
i ≥ N implies that φ = 0, where S = Bd(C ). For any i ≥ N , it follows from
0 |S i i 0
i
the divergence theorem that
ˆ ˆ
div(R)(x)dx = R(x)·N(cid:98)(x)dS.
Ci S i
Now, since φ and conseq´uently R are 0 on S , the right side of the above equality
i
is 0. Hence, we have that div(R)dx = 0, which implies that
ˆ
Ci
ˆ
gdiv(φ)dx = − ∇g ·φdx.
Ci Ci
Now, we have that
ˆ ˆ ˆ ˆ
(cid:12) (cid:12)
(cid:12) (cid:12)
(cid:12) ∇g ·φdx(cid:12) ≤ |∇g ·φ|dx ≤ |∇g||φ|dx ≤ |∇g|f2ddx.
(cid:12) (cid:12) X
Ci Ci Ci Ci
It follows that
ˆ ˆ ˆ ˆ
gdiv(φ)dx = lim gdiv(φ)dx ≤ lim |∇g|f2ddx = |∇g|f2ddx.
X X
i→∞ i→∞
Ω Ci
´
Ci Ω
Therefore, PEACE (X → Y) ≤ |∇g(x)|f2d(x)dx.
d Ω X
Conversely, define
∇g
θ := − f2d, k = 1,2,3,...,
k |∇g| X
k
(cid:112)
where for any x ∈ Rn, by |x| we mean x2 +···+x2 +1/k. One could see that
k √ 1 n √
(cid:112)
|x| = |x|2 +1/k, and hence 1/ k ≤ |x| ≤ |x| + 1/ k. Now, fix a positive
k k
integer k. Obviously, |θ | ≤ f2d but it might θ ∈/ C1(Ω,Rn). In the rest of this
k X k c
proof, we overcome this issue.
34For each 1 ≤ i ≤ n, let p = −∂g/∂x . Now, by Corollary B.4, there exist
i i
h ,q(i) ∈ C (Ω,R) with 0 ≤ h ≤ f2d and |q(i)| ≤ |p | satisfying h | = f2d| and
k k c k X k i k C k X C k
q | = p | for each 1 ≤ i ≤ n. Next, it follows from Lemma B.7 that there exists
k C i C
k k
a non-negative function (cid:101)h ∈ C1(Ω,R) with 0 ≤ h −(cid:101)h < 1/k. Also, by Corrolary
k c k k
B.6, there exists g(i) ∈ C1(Ω,R) with |g(i) − q(i)| < 1/k2 for each 1 ≤ i ≤ n.
k c k k
Now, let g = (g(1),...,g(n)) and g = g /|g | . We note that g ∈ C1(Ω,Rn) and
k k k (cid:101)k k k k (cid:101)k c
0 ≤ (cid:101)h ≤ h ≤ f2d. Now, we define θ(cid:101) = g (cid:101)h . Clearly, we have that θ(cid:101) ∈ C1(Ω,Rn)
k k X k (cid:101)k k k c
and |θ(cid:101) | ≤ f2d.
k X
By Remark A.2, let {C }∞ be an admissible compact cover for Ω\B, where
k k=1
(cid:26) (cid:27)
1
C ⊆ x ∈ Ω : |∇g(x)| > √ , B = {x ∈ Ω : ∇g(x) = 0}, k = 1,2,3,...
k
4 k
Assume that S = {x ∈ Ω : |∇g| < 1/k} for any k. Let M and M be bounds for
k ´ 1 2
|∇g| and f2d, respectively. Also, let A = dx. Assume that H = −∇g·θ(cid:101) . Then,
X Ω k k
|H | ≤ M /k on S . We note that
k 2 k
ˆ ˆ ˆ ˆ
(cid:12) (cid:12) (cid:12) (cid:12)
(cid:12) (cid:12) (cid:12) (cid:12)
(cid:12) H dx− H dx(cid:12) = (cid:12) H dx− H dx(cid:12)
k k k k
(cid:12) (cid:12) (cid:12) (cid:12)
Ω Ω\B ˆS k (ˆΩ\B)∩S k ˆ
(cid:12) (cid:12) (cid:12) (cid:12)
(cid:12) (cid:12) (cid:12) (cid:12) 2M 2A
≤ (cid:12) H dx(cid:12)+(cid:12) H dx(cid:12) ≤ 2 |H | dx ≤ .
k k k
(cid:12) (cid:12) (cid:12) (cid:12) k
S (Ω\B)∩S S
k k k
Similarly, we have that
ˆ ˆ
(cid:12) (cid:12)
(cid:12)
(cid:12) |∇g|f2ddx−
|∇g|f2ddx(cid:12)
(cid:12) ≤
2M 2A
.
(cid:12) X X (cid:12) k
Ω Ω\B
There exists a positive integer N in such a way that k ≥ N implies that
0 0
ˆ ˆ ˆ ˆ
(cid:12) (cid:12) (cid:12) (cid:12)
(cid:12) (cid:12) 1 (cid:12) (cid:12) 1
(cid:12) −∇g ·θ(cid:101) dx− −∇g ·θ(cid:101) dx(cid:12) < , (cid:12) |∇g|f2ddx− |∇g|f2ddx(cid:12) < .
(cid:12) k k (cid:12) k (cid:12) X X (cid:12) k
Ω\B C Ω\B C
k k
Assume that
ˆ ˆ
(cid:12) (cid:12)
(cid:12) (cid:12)
L = (cid:12) −∇g ·θ(cid:101) dx− |∇g|f2ddx(cid:12), k = 1,2,3,···
k (cid:12) k X (cid:12)
Ω Ω
35To prove the theorem, it is enough to show that lim L = 0. We have that
k→∞ k
L ≤ L(1) +L(2) +L(3) +L(4) +L(5), where
k k k k k k
ˆ ˆ
(cid:12) (cid:12)
L(1) = (cid:12) (cid:12) −∇g ·θ(cid:101) dx− −∇g ·θ(cid:101) dx(cid:12) (cid:12) < 2M 2A ,
k (cid:12) k k (cid:12) k
ˆΩ ˆ Ω\B
(cid:12) (cid:12)
L(2) = (cid:12) (cid:12) |∇g|f2ddx− |∇g|f2ddx(cid:12) (cid:12) < 2M 2A ,
k (cid:12) X X (cid:12) k
ˆΩ Ω\ˆB
(cid:12) (cid:12)
L(3) = (cid:12) (cid:12) −∇g ·θ(cid:101) dx− −∇g ·θ(cid:101) dx(cid:12) (cid:12) < 1 ,
k (cid:12) k k (cid:12) k
ˆΩ\B ˆ C k
(cid:12) (cid:12)
L(4) = (cid:12) (cid:12) |∇g|f2ddx− |∇g|f2ddx(cid:12) (cid:12) < 1 ,
k (cid:12) X X (cid:12) k
ˆΩ\B ˆC
k
(cid:12) (cid:12)
L(5) = (cid:12) (cid:12) −∇g ·θ(cid:101) dx− |∇g|f2ddx(cid:12) (cid:12).
k (cid:12) k X (cid:12)
C C
k k
√
Notethat onC , q(i) = p = −∂g/∂x foreach 1 ≤ i ≤ n. Hence, |g +∇g| ≤ n/k2.
k k i i k
Furthermore, onecouldseethat||g | −|∇g| | ≤ ||g |−∇g| ≤ |g +∇g|, andhence,
k k k k k
on C , we have that
k
(cid:12) (cid:12) (cid:12) (cid:12) (cid:12) (cid:12)
(cid:12) ∇g (cid:12) (cid:12)|∇g| kg k +|g k| k∇g(cid:12) (cid:12)|∇g| kg k +|g k| k∇g(cid:12)
(cid:12) (cid:12)g (cid:101)k + |∇g| (cid:12) (cid:12) = (cid:12) (cid:12) |g | |∇g| (cid:12) (cid:12) ≤ (cid:12) (cid:12) 1 (cid:12) (cid:12)
k k k k k
= k||∇g| (g +∇g)+∇g(|g | −|∇g| )|
k k k k k
(cid:18)(cid:18) (cid:19) (cid:19)
1
≤ k |∇g|+ √ |g +∇g|+|∇g||g +∇g|
k k
k
M
3
≤ k(2|∇g|+1)|g +∇g| ≤ ,
k
k
√
where M = (2M +1) n. Now, we note that L(5) ≤ L(5,1) +L(5,2) +L(5,3), where
3 1 k k k k
ˆ ˆ
(cid:12) (cid:18) (cid:19) (cid:12)
L(5,1) = (cid:12) (cid:12) −∇g ·θ(cid:101) dx− ∇g · ∇g (cid:101)h dx(cid:12) (cid:12),
k (cid:12) k |∇g| k (cid:12)
ˆC k C k ˆ k
(cid:12) (cid:18) (cid:19) (cid:18) (cid:19) (cid:12)
L(5,2) = (cid:12) (cid:12) ∇g · ∇g (cid:101)h dx− ∇g · ∇g f2d dx(cid:12) (cid:12),
k (cid:12) |∇g| k |∇g| X (cid:12)
ˆC
k
k ˆC
k
k
(cid:12) (cid:18) (cid:19) (cid:12)
L(5,3) = (cid:12) (cid:12) ∇g · ∇g f2d dx− |∇g|f2ddx(cid:12) (cid:12),
k (cid:12) |∇g| X X (cid:12)
C k C
k k
36We have that
ˆ
(cid:12) (cid:18) (cid:19) (cid:12)
L( k5,1) = (cid:12) (cid:12)
(cid:12)
−∇g · g (cid:101)k + |∇∇ gg
|
(cid:101)h kdx(cid:12) (cid:12)
(cid:12)
≤ M k4 , M 4 = M 1M 2M 3A,
ˆC
k
k
(cid:12) (cid:12)
L(5,2) = (cid:12) (cid:12) |∇g|2 ((cid:101)h −f2d)dx(cid:12) (cid:12) ≤ M 1A ,
k (cid:12) |∇g| k X (cid:12) k
ˆC
k
k
(cid:12) (cid:18) (cid:19) (cid:12)
L(5,3) = (cid:12) (cid:12) |∇g|f2d |∇g| −1 dx(cid:12) (cid:12).
k (cid:12) X |∇g| (cid:12)
C k
k
√
For any x ∈ R with |x| > 1/ 4 k,
|x| −|x| |x|2 −|x|2 1 1 1 1
k = k = k ≤ k < k = √ .
|x| |x| (|x| +|x|) |x| (|x| +|x|) 2|x|2 √2 2 k
k k k k k
k
√ √
Thus, on C , (|∇g| − |∇g|)/|∇g| < 1/(2 k). Hence, L(5,3) ≤ (M M A)/(2 k).
k k k k √ 1 2
Therefore, L ≤ ((4M A+2+M +M A)/k) + (M M A)/(2 k), which implies
k 2 4 1 1 2
that lim L = 0, and hence the proof is complete.
k→∞ k
Proof of Corollary 4.7. Let {Ω }∞ be an increasing sequence of bounded open
k k=0
subsets of Rn with Ω = (cid:83)∞ Ω (for instance, one could assume that Ω = B(0,k)∩
k=0 k k
Ω for any k). First, assume that PEACE (X → Y) < ∞, and let ε > 0. Then,
d
there exists φ ∈ C1(Ω,Rn) with |φ| ≤ f2d and
c X ˆ
PEACE (X → Y)−ε < gdiv(φ)dx.
d
Ω
Now, we show that there exists k with Supp(φ) ⊆ Ω . On the contrary, assume
0 k0
that Supp(φ) ⊈ Ω for any k. Then, there exists x ∈ Supp(φ)\Ω for any k. It
k k k
follows from the comnpactness of Supp(φ) that there exists a subsequence {x }∞
ki i=0
convergent to a point of Supp(φ) such as x. Since, Supp(φ) ⊆ Ω, there exists N
0
with x ∈ Ω . Since {x }∞ converges to x and Ω is open, there exists a positive
N0 ki i=0 N0
integer N ≥ N such that i ≥ N implies that x ∈ Ω . Therefore, x ∈ Ω ⊆
0 ki N0 kN N0
Ω ⊆ Ω , a contradiction! Hence, there exists k with Supp(φ) ⊆ Ω . It follows
N kN 0 k0
from the above discussion and Theorem 4.6 that
ˆ ˆ
PEACE (X → Y)−ε < gdiv(φ)dx = gdiv(φ)dx
d
Ω Ω k0 ˆ ˆ
≤ PEACE (X| → Y) = |∇g|f2ddx ≤ |∇g|f2ddx,
d Ω k0 X X
Ω Ω
k0
which implies that
ˆ
PEACE (X → Y) ≤ |∇g|f2ddx.
d X
Ω
Conversely, there exist k and ψ ∈ C1(Ω ,Rn) with |ψ| ≤ f2d such that
ˆ 1 ˆ c k1 ˆ X
ε
|∇g|f2ddx < |∇g|f2ddx+ < gdiv(ψ)dx+ε.
X X 2
Ω Ω Ω
k1 k1
37Define ψ(cid:101) ∈ C1(Ω,Rn) with |ψ(cid:101)| ≤ f2d by setting ψ(cid:101)| = ψ| and ψ(cid:101)| ≡ 0.
c X Ω k1 Ω k1 Ω\Ω k1
Then, we have that
ˆ ˆ
gdiv(ψ)dx = gdiv(ψ(cid:101))dx ≤ PEACE (X → Y),
d
Ω Ω
k1
which implies that
ˆ
|∇g|f2ddx < PEACE (X → Y)+ε,
X d
Ω
and hence ˆ
|∇g|f2ddx ≤ PEACE (X → Y).
X d
Ω
Consequently, we have that
ˆ
PEACE (X → Y) = |∇g|f2ddx.
d X
Ω
´
Now, assume that PEACE (X → Y) = ∞. We show that |∇g|f2ddx = ∞. For
d Ω ´ X
anyM > 0thereexistsφ ∈ C1(Ω,Rn)with|φ | ≤ f2d suchthat gdiv(φ )dx >
M c M X Ω M
M. It follows that there ex´ists a positive integer N for which´k ≥ N implies
0 0
that Supp(φ ) ⊆ Ω and gdiv(φ )dx > M, and hence |∇g|f2ddx =
M k Ω M Ω X
PEACE (X| → Y) > M. It fk ollows that k
d Ω
k ˆ ˆ
|∇g|f2ddx = lim |∇g|f2ddx = ∞.
X X
k→∞
Ω Ω
k
Proof of Corollary 4.8. The first part of the corollary follows from the fact that
the gradient of a function is 0 if and only if that function is locally constant. To
prove the second part, first we note that Γ is an open subset of Ω, and hence it is
connected by the connectedness of Ω. Now, on the contrary, assume that g| is not
Γ
constant and α is a value of g| . Then, U = {x ∈ Γ : g(x) = α} is both open and
Γ
close in Γ, which contradicts with connectedness of Γ. Therefore, g| is constant.
Γ
Appendix C. Proofs of Other Results
Proof of Proposition 4.1. Let φ ∈ C1(Ω,Rn) with |φ| ≤ f2d. Then, one could
c X
see that Supp(φ| ) = Supp(φ)∩Ω for any i. Thus, φ| ∈ C1(Ω ,Rn) for any i. It
Ωi i Ωi c i
follows that
ˆ ˆ
∞ ∞
(cid:88) (cid:88)
gdiv(φ)dx = gdiv(φ)dx ≤ PEACE (X| → Y),
d Ωi
Ω
i=0
Ωi
i=0
which implies that
∞
(cid:88)
PEACE (X → Y) ≤ PEACE (X| → Y).
d d Ωi
i=0
38Conversely, first, assume that for any i, PEACE (X| → Y) < ∞, and let ε > 0.
d Ωi
Then, there exists φ ∈ C1(Ω ,Rn) with |φ | ≤ f2d| in such a way that
i c i ˆ i X Ωi
ε
(6) PEACE (X| → Y)− < gdiv(φ )dx, i = 0,1,2,···
d Ωi 2i+1 i
Ωi
Now, we define ψ : Ω → Rn by setting ψ| = φ for any i. Then, |ψ| ≤ f2d and
Supp(ψ) =
(cid:83)∞
Supp(φ ) ⊆
(cid:83)∞
Ω = Ω.
HΩi ence,i
we have that
X
i=0 i i=0 i
ˆ ˆ
∞ ∞ ∞
(cid:88) (cid:88) (cid:88)
PEACE (X| → Y) < gdiv(φ )dx = gdiv(ψ| )dx+ε
d Ωi i Ωi
i=0 ˆi=0
Ωi
i=0
Ωi
= gdiv(ψ)dx+ε ≤ PEACE (X → Y)+ε,
d
Ω
which implies that
∞
(cid:88)
PEACE (X| → Y) ≤ PEACE (X → Y).
d Ωi d
i=0
Now, assume that one of the values PEACE (X| → Y) is ∞. Without loss of
d Ωi
generality, assume that PEACE (X| → Y) = ∞. Then,´for any M > 0 there
d Ω0
exists φ ∈ C1(Ω ,Rn) with |φ | ≤ f2d in such a way that gdiv(φ )dx > M.
Now, weM definc e ψ0 : Ω → R bM y settiX ng ψ | = φ , and Ω ψ0 | ≡M 0. Then,
M M Ω0 M M Ω\Ω0
ψ ∈ C1(Ω,Rn) with |ψ | ≤ f2d. Note that
M c ˆ M X ˆ
gdiv(ψ )dx = gdiv(φ )dx > M,
M M
Ω Ω0
which implies that PEACE (X → Y) = ∞.
d
Proof of Proposition 4.2. Let φ ∈ C1(Ω,Rn) with |φ| ≤ f2d. By compactness
c X
of Supp(φ), it is covered by finitely many of the aforementioned open sets. Assume
that Supp(φ) ⊆
(cid:83)m
Ω . Then, by the partition of unity theorem (see [13, Theorem
i=0 i
16.3]), there exists α ∈ C1(Ω,R) with Supp(α ) ⊆ Ω and α ≥ 0 for any 0 ≤ i ≤ m,
i c i i i
in such a way that (cid:80)m α = 1. Thus, φ = (cid:80)m φ , where φ = φα ∈ C1(Ω ,Rn).
i=0 i i=0 i i i c i
Note that |φ | = α |φ| ≤ |φ| ≤ f2d. It follows that
i i X
ˆ ˆ ˆ
m m ∞
(cid:88) (cid:88) (cid:88)
gdiv(φ)dx = gdiv(φ )dx = gdiv(φ )dx ≤ PEACE (X| → Y).
i i d Ωi
Ω
i=0
Ω
i=0
Ωi
i=0
Therefore, we have that
∞
(cid:88)
PEACE (X → Y) ≤ PEACE (X| → Y).
d d Ωi
i=0
Proof of Proposition 4.3. Let φ ∈ C1(Γ,Rn) with |φ| ≤ f2d. Then, we define
c X
ψ : Ω → Rn with ψ| = φ and ψ| ≡ 0. Then, ψ ∈ C1(Ω,Rn), and we have that
ˆ Γ ˆΩ\Γ c
gdiv(φ)dx = gdiv(ψ)dx ≤ PEACE (X → Y),
d
Γ Ω
39which implies that
PEACE (X| → Y) ≤ PEACE (X → Y).
d Γ d
Proof of Theorem 4.4. Clearly, µ(∅) = 0. Now, we show that µ is monotone. Let
E,F ∈ P(Ω) with E ⊆ F. Let ε > 0 be arbitrary. Then, there exists V ∈ τ with
F ⊆ V in such a way that µ(F) + ε > λ(V). We have that E ⊆ V, since E ⊆ F
and F ⊆ V. It follows that λ(V) ≥ µ(E). Therefore, µ(F)+ε > µ(E), and hence
µ(F) ≥ µ(E).
Now, we show the countable subadditivity of µ. Let {E }∞ be a countable family
i i=0
in P(Ω) and E =
(cid:83)∞
E . If there exists i with µ(E ) = ∞, then there is nothing
i=0 i 0 i0
to prove. Otherwise, let µ(E ) < ∞ for any i. Let ε > 0. Then, for any i, there
i
exists V ∈ τ containing E in such a way that µ(E ) + ε/2i+1 > λ(V ). It follows
i i i i
that ε +
(cid:80)∞
µ(E ) >
(cid:80)∞
λ(V ), while by Proposition 4.2,
(cid:80)∞
λ(V ) > λ(V),
i=0 i i=0 i i=0 i
where V =
(cid:83)∞
V . Hence, ε +
(cid:80)∞
µ(E ) > λ(V). We note that E ⊆ V ∈ τ,
i=0 i i=0 i
which implies that µ(E) ≤ λ(V). Therefore, we have that µ(E) <
ε+(cid:80)∞
µ(E ),
i=0 i
and hence µ(E) ≤
(cid:80)∞
µ(E ).
i=0 i
Now, we show that µ is a Borel measure. By Caratheodory’s criterion (see [6,
Section 1.1]), it is enough to show that µ(A∪B) = µ(A)+µ(B) for any A,B ∈ P(Ω)
with δ = dist(A,B) > 0. First, we note that µ(A ∪ B) ≤ µ(A) + µ(B) by the
subadditivity of µ. Now, first, assume that µ(A),µ(B) < ∞, and let ε > 0. Then,
there exists Γ ∈ τ with A∪B ⊆ Γ that µ(A∪B)+ε > λ(Γ). For any x ∈ A, there
exists r > 0 with B(x,r ) ⊆ Γ. Set r′ = min{r ,δ}. Consider similar notations
x x x x
for points in B. Now, assume that U = (cid:83) B(x;r′ ) and V = (cid:83) B(x;r′ ).
x∈A x x∈B x
Then, U,V ∈ τ with A ⊆ U and B ⊆ V, while U ∩V = ∅ and U ∩V ⊆ Γ. Thus,
µ(A∪B)+ε > λ(U ∪V). It follows from the latter and Proposition 4.2 that
µ(A∪B)+ε > λ(U ∪V) = λ(U)+λ(V) ≥ µ(A)+µ(B),
and hence µ(A∪B) ≥ µ(A)+µ(B). Now, assume that one of µ(A) and µ(B) is ∞.
Then, it follows from the monotonicity of µ that µ(A∪B) = ∞, and hence again
the equality µ(A)+µ(B) = µ(A∪B) holds.
Finally, we show that µ is Borel regular. Let E ∈ P(Ω). First, assume that
µ(E) < ∞. For any positive integer k, there exists V ∈ τ with E ⊆ V and
k k
µ(E)+1/k > λ(V ). Set U =
(cid:84)k
V for any positive integer k. Then, ··· ⊆ U ⊆
k k i=0 i 3
U ⊆ U are in τ, and λ(U ) ≤ λ(V ) for any k. Since, µ is a Borel measure, we have
2 1 k k
that (see Remark 4.5):
(cid:32) (cid:33)
∞
(cid:92)
µ U −µ(E) = lim (µ(U )−µ(E)) = lim (λ(U )−µ(E)) = 0,
k k k
k→∞ k→∞
k=0
whichimpliesthatµ(E) =
µ((cid:84)∞
U ). Now, ifµ(E) = ∞, thenµ(E) = µ(Ω) = ∞.
k=0 k
Therefore, µ is Borel regular.
Proof of Proposition 4.9. (1) Let Γ = π(Ω), where π : Rn+m → Rn defined by
setting π(x,z) = x. Then, Γ = π (Ω). Assume that h : Γ → Γ is a diffeomorphism.
1 ∗
40Denote the probability density functions of X given Z, and W given Z by f and f(cid:101),
respectively. Define g(W,Z) = g(h(W),Z). One could see that
(cid:101)
∂g ∂g
(cid:101)in in
(w,z) = Jac(h)(w) (h(w),z).
∂w ∂x
By the change of variable formula for probability density functions [5, Section 5.4],
we have that
f(cid:101)(w|z) = |det(Jac(h)(w))|f(h(w)|z).
´
We note that PIEVz(W → Y) = |(∂g /∂w)(w,z)|f(cid:101)(w|z)2ddw. Thus, by the
d Γ∗ (cid:101)in
change of variable formula, we have that
ˆ
(cid:12) (cid:12)
PIEVz(W → Y) = (cid:12) (cid:12)Jac(h)(w)∂g in (h(w),z)(cid:12) (cid:12)(|det(Jac(h)(w))|f(h(w)|z))2d dw
d (cid:12) ∂x (cid:12)
ˆΓ∗
(cid:12) (cid:12)
=
(cid:12) (cid:12)Jac(h)(h−1(x))∂g in (x,z)(cid:12) (cid:12)(cid:0)(cid:12) (cid:12)det(cid:0) Jac(h)(h−1(x))(cid:1)(cid:12) (cid:12)f(x|z)(cid:1)2d
dw
(cid:12) ∂x (cid:12)
Γ
(2) Now, assume that h is an affine map of the form of h(w) = Aw +a. Then,
Jac(h)(h−1(x)) = AT for any x, which implies the claimed equality in the proposi-
tion.
(3) As we explained in the preliminaries, each onto isometry of Rn is of the form of
an affine map h(w) = Aw+a, where A is an orthogonal matrix. Thus, |ATv| = |v|
for any vector v ∈ Rn and |det(A)| = 1. It follows that
ˆ
(cid:12) (cid:12)
PIEVz(W → Y) = (cid:12) (cid:12)∂g in (x,z)(cid:12) (cid:12)f(x|z)2ddw = PIEVz(X → Y),
d (cid:12) ∂x (cid:12) d
Γ
and hence PEACE (W → Y) = PEACE (X → Y).
d d
Proof of Proposition 5.1. Let
 
1  (cid:88) g(x)−g(x′)
ψ(i) :=  , i = 1,...,n.
j1,...,jn 2n−1  ∆x 

x∈F(x1j1,...,xnjn;xiji)
iji 
x′ i=xi,ji−1,∀k̸=ix′ k=x
k
Let φ(i) := ψ(i) /|ψ | for ψ ̸= 0, and φ(i) := 0 for ψ = 0,
j1,...,jn (cid:16)j1,...,jn j1,...,jn (cid:17)j1,...,jn j1,...,jn j1,...,jn
where ψ = ψ(1) ,...,ψ(n) . Then, for ψ ̸= 0, we have that
j1,...,jn j1,...,jn j1,...,jn j1,...,jn
(cid:16) (cid:17)2
ψ(i)
Flux(i)(x ,...,x ) =
j1,...,jn
Vol(C(x ,...,x )), i = 1,...,n,
φ 1j1 njn |ψ | 1j1 njn
j1,...,jn
and for ψ = 0, we have that Flux(i)(x ,...,x ) = 0. Hence,
j1,...,jn φ 1j1 njn
Flux (x ,...,x ) = |ψ |Vol(C(x ,...,x ))
φ 1j1 njn j1,...,jn 1j1 njn
(cid:113)
= Flux(1)(x ,...,x )2 +···+Flux(n)(x ,...,x )2
1j1 njn 1j1 njn
= Flux(x ,...,x ).
1j1 njn
41Now, assume that η : Γ → Rn with |η| ≤ 1 is arbitrary. Then, it follows from the
Cauchy–Schwarz inequality that
n
(cid:88)
Flux (x ,...,x ) = Flux(i)(x ,...,x )η(i)
η 1j1 njn 1j1 njn j1,...,jn
i=1
≤ Flux (x ,...,x )|η | ≤ Flux (x ,...,x ).
φ 1j1 njn j1,...,jn φ 1j1 njn
It follows that TV(g) = TV (g), and consequently, the proof is complete.
φ
Proof of Theorem 6.2. Let φ ∈ C1(Ω,Rn) with |φ| ≤ f2d, and let ε > 0. Also,
c X
let {C }∞ be an admissible compact cover for Ω. There exists a positive number
j j=0
N for which j ≥ N yields that Supp(φ) ⊆ C ⊆ In(C ). Let j ≥ N + 1.
0 0 j j+1 0
It follows from g ∈ C1(Ω,R) and the continuity of φ that there exists 0 < δ <
dist(Supp(φ),Bd(C )) in such a way that |x−x′| < δ implies that |φ(x)−φ(x′)| < ε
j
and |∂g/∂x (x) − ∂g/∂x (x′)| < ε for any 1 ≤ i ≤ n. Now, let C ⊆ C, where
i i j
C = (cid:81)n [a ,b ]. Let g : C → R defined by setting g| = g and g| ≡ 0.
i=1 i i (cid:101) (cid:101)Ω (cid:101)C\Ω
Similarly, we can define φ. Let P ∈ P(C) with ∥P∥ = max{x(P) − x(P) : 1 ≤
(cid:101) √ ij i,j−1
i ≤ n, 2 ≤ j ≤ n(P)} < δ/ n. Let x(P) be a fixed point in C(x(P),...,x(P)).
i j1,...,jn 1j1 njn
First, assume that C(x(P),...,x(P)) ⊆ C . By the mean value theorem, for any
1j1 njn j
x ∈ F(x(P),...,x(P);x(P)) and x′ ∈ F(x(P),...,x(P);x(P) ) with x′ = x(P) and
1j1 njn iji 1j1 njn i,ji−1 i i,ji−1
x′ = x for k ̸= i, there exsits θ(P) ∈ (x(P) ,x(P)) in such a way that g(x)−g(x′) =
k k iji i,ji−1 i,ji
(∂g/∂x )(x(P),...,x(P) ,θ(P),x(P) ,...,x(P))∆x(P). It follows that
i 1j1 i−1,ji−1 iji i+1,ji+1 njn iji
((∂g/∂x )(x(P) )−ε)∆x(P) ≤ g(x)−g(x′) ≤ ((∂g/∂x )(x(P) )+ε)∆x(P),
i j1,...,jn iji i j1,...,jn iji
which implies that
∂g
PFlux(i)(x(P),...,x(P);x(P) ) ≤ (x(P) )φ(i)(x(P) )Vol(C(x(P),...,x(P)))
φ 1j1 njn j1,...,jn ∂x j1,...,jn j1,...,jn 1j1 njn
i
(cid:12) (cid:12)
+ε(cid:12)φ(i)(x(P) )(cid:12)Vol(C(x(P),...,x(P))),
(cid:12) j1,...,jn (cid:12) 1j1 njn
∂g
PFlux(i)(x(P),...,x(P);x(P) ) ≥ (x(P) )φ(i)(x(P) )Vol(C(x(P),...,x(P)))
φ 1j1 njn j1,...,jn ∂x j1,...,jn j1,...,jn 1j1 njn
i
(cid:12) (cid:12)
−ε(cid:12)φ(i)(x(P) )(cid:12)Vol(C(x(P),...,x(P))).
(cid:12) j1,...,j ´n (cid:12) 1j1 njn
Let M be a bound for f2d. Now, set M = M dx. Then, we have that
f X f Ω
∂g
PFlux(i)(x(P) ,...,x(P) ;x(P)
) ≤
(x(P) )φ(i)(x(P) )Vol(C(x(P) ,...,x(P)
))+Mε.
φ 1j1 njn j1,...,jn ∂x j1,...,jn j1,...,jn 1j1 njn
i
Similarly, we have that
∂g
PFlux(i)(x(P) ,...,x(P) ;x(P)
) ≥
(x(P) )φ(i)(x(P) )Vol(C(x(P) ,...,x(P)
))−Mε.
φ 1j1 njn j1,...,jn ∂x j1,...,jn j1,...,jn 1j1 njn
i
It follows that
(P) (P) (P) (P) (P) (P)
PFlux (x ,...,x ;x ) ≤ (∇g·φ)(x )Vol(C(x ,...,x ))+nMε,
φ 1j1 njn j1,...,jn j1,...,jn 1j1 njn
(P) (P) (P) (P) (P) (P)
PFlux (x ,...,x ;x ) ≥ (∇g·φ)(x )Vol(C(x ,...,x ))−nMε.
φ 1j1 njn j1,...,jn j1,...,jn 1j1 njn
42Now, assume that C(x(P) ,...,x(P) ) ⊈ C . Then, x(P) ∈/ Supp(φ). Otherwise, for a
1j1 njn j j1,...,jn
(P) (P)
point a ∈ C(x ,...,x )\C , we have that
1j1 njn j
(P) (P)
dist(Supp(φ),Bd(C )) ≤ dist(x ,Bd(C )) ≤ |x −a| ≤ δ,
j j1,...,jn j j1,...,jn
that contradicts with dist(Supp(φ),Bd(Ω)) > δ. Thus, in this case, for each 1 ≤ i ≤ n,
(i) (P) (P) (P) (P)
PFlux (x ,...,x ) = 0, which implies that PFlux (x ,...,x ) = 0. Therefore,
φ 1j1 njn φ 1j1 njn
by taking a summation over all discrete-like n-cubes of P(C) and ∥P∥ → 0, we have that
ˆ ˆ
∇g·φdx−nMε ≤ PEACEφ,dis(X → Y) ≤ ∇g·φdx+nMε.
(cid:101) (cid:101) d (cid:101) (cid:101)
C C
Since, ε > 0 is arbitrary, we have that
ˆ ˆ ˆ
PEACEφ,dis(X → Y) = ∇g·φdx = ∇g·φdx = ∇g·φdx.
d (cid:101) (cid:101)
C Cj Ω
Now, by Equation 5,
ˆ ˆ
PEACEφ,dis(X → Y) = − gdiv(φ)dx = gdiv(−φ)dx.
d
Ω Ω
Finally, the theorem is a consequence of Theorem 4.6.
Proof of Theorem 8.1. We prove the theorem only for ε = +. The case ε = − is
similar. Wenotethatitfollowsfromthecontinuityof(∂g /∂x)(·,z)andr+ = (|r|+r)/2
in
that ((∂g /∂x)(·,z))+ is continuous. Since f(·|z) is continuous on [a,b], it is uniformly
in
continuous as well. Let us assume that 0 < ε < 1 is arbitrary. Then, there exists δ > 0
1
for which
∀α,β ∈ [a,b] (|α−β| < δ =⇒ |f(α|z)−f(β|z)| < ε).
1
Now, assume that ∥P∥ < δ . For any 1 ≤ i ≤ n , it follows from the mean value theorem
1 P
(P) (P) (P)
that there exists α ∈ (x ,x ) with
i i i−1
∂g
(P) (P) (P) in (P)
g (x ,z)−g (x ,z) = ∆x (α ,z).
in i in i−1 i ∂x i
Also, for any 1 ≤ i ≤ n , we have that
P
(cid:12) (cid:12) (cid:12) (cid:12)
(cid:12)f(x(P) |z)−f(α(P) |z)(cid:12) < ε, (cid:12)f(x(P) |z)−f(α(P) |z)(cid:12) < ε.
(cid:12) i i (cid:12) (cid:12) i−1 i (cid:12)
It follows that
Lz (X → Y)+ =
(cid:88)nP ∆x(P)(cid:18)
∂g
in (α(P)
,z)(cid:19)+
f(x(P) |z)df(x(P) |z)d
P,d i ∂x i i i−1
i=1
<
(cid:88)nP ∆x(P)(cid:18)
∂g
in (α(P)
,z)(cid:19)+
(f(α(P) |z)+ε)2d.
i ∂x i i
i=1
By the mean value theorem for the function u (cid:55)→ u2d, for any 1 ≤ i ≤ n , there exists
P
0 < η < ε with
(f(α(P) |z)+ε)2d−f(α(P) |z)2d = 2dε(f(α(P) |z)+η)2d−1.
i i i
Now, assume that M is an upper bound for f(·|z). Then, for any 1 ≤ i ≤ n ,
f P
(f(α(P) |z)+ε)2d < f(α(P) |z)2d+2dε(M +1)2d−1.
i i f
43Thus, we have that
Lz (X → Y)+ <
(cid:88)nP ∆x(P)(cid:18)
∂g
in (α(P)
,z)(cid:19)+
f2(α(P) |z)
P,d i ∂x i i
i=1
+2dε(M
+1)2d−1(cid:88)nP ∆x(P)(cid:18)
∂g
in (α(P)
,z)(cid:19)+
.
f i ∂x i
i=1
Now, if Mz is also an upper bound for |∂g /∂x(·,z)|, then we have that
g′ in
(cid:88)nP ∆x(P)(cid:18)
∂g
in (α(P)
,z)(cid:19)+
< Mz
(cid:88)nP
∆x(P) = Mz(b−a),
i ∂x i g′ i g′
i=1 i=1
which implies that
Lz (X → Y)+ <
(cid:88)nP ∆x(P)(cid:18)
∂g
in (α(P)
,z)(cid:19)+
f2(α(P) |z)+C ε,
P,d i ∂x i i 1
i=1
where C = 2d(b−a)Mz(M +1)2d−1. Similarly, we have that
1 g′ f
Lz (X → Y)+ > −εC
+(cid:88)nP ∆x(P)(cid:18)
∂g
in (α(P)
,z)(cid:19)+
f2(α(P) |z),
P,d 2 i ∂x i i
i=1
where C is a non-negative constant. Let C be the maximum of C and C . Then, we
2 1 2
have that
(cid:12) (cid:12)
(cid:12)
(cid:12)Lz (X →
Y)+−(cid:88)nP ∆x(P)(cid:18) ∂g
in (α(P)
,z)(cid:19)+
f2(α(P)
|z)(cid:12)
(cid:12) < εC.
(cid:12) P,d i ∂x i i (cid:12)
(cid:12) (cid:12)
i=1
We note that (∂g /∂x(·,z))+f2(·|z) is a continuous function on [a,b], and hence it is
in
Riemann integrable. Thus, there exists δ > 0 such that for any P ∈ P with ∥P∥ < δ ,
2 2
we have that
(cid:12)ˆ (cid:12)
(cid:12)
(cid:12)
b(cid:18) ∂g
in
(t,z)(cid:19)+ f2(t|z)dt−(cid:88)nP ∆x(P)(cid:18) ∂g
in (α(P)
,z)(cid:19)+
f2(α(P)
|z)(cid:12)
(cid:12) < ε.
(cid:12) ∂x i ∂x i i (cid:12)
(cid:12) a (cid:12)
i=1
Now, set δ to be the minimum of δ and δ . It follows that for any P ∈ P with ∥P∥ < δ,
1 2
if
(cid:12) ˆ (cid:12)
(cid:12) b(cid:18) ∂g (cid:19)+ (cid:12)
L = (cid:12)Lz (X → Y)− in (t,z) f2(t|z)dt(cid:12),
(cid:12) P,d ∂x (cid:12)
(cid:12) a (cid:12)
then we have that
(cid:12) (cid:12)
L ≤
(cid:12)
(cid:12)Lz (X →
Y)+−(cid:88)nP ∆x(P)(cid:18) ∂g
in (α(P)
,z)(cid:19)+
f2(α(P)
|z)(cid:12)
(cid:12)
(cid:12) P,d i ∂x i i (cid:12)
(cid:12) (cid:12)
i=1
(cid:12)ˆ (cid:12)
+(cid:12)
(cid:12)
b(cid:18) ∂g
in
(t,z)(cid:19)+ f2(t|z)dt−(cid:88)nP ∆x(P)(cid:18) ∂g
in (α(P)
,z)(cid:19)+
f2(α(P)
|z)(cid:12)
(cid:12)
(cid:12) ∂x i ∂x i i (cid:12)
(cid:12) a (cid:12)
i=1
< εC +ε = ε(C +1).
Therefore, it follows from the arbitrariness of ε > 0 that
ˆ
b(cid:18)
∂g
(cid:19)+
PIEVz(X → Y) = lim L (X → Y)+ = in (t,z) f2(t|z)dt.
d ∥P∥→0 P a ∂x
44Usef Faghihi, Department of Mathematics and Computer Science, The University
of Quebec at Trois-Rivieres, 3351 Bd des Forges, Trois-Rivie`res, QC G8Z 4M3,
Canada
AmirSaki, DepartmentofMathematicsandComputerScience, TheUniversityof
Quebec at Trois-Rivieres, 3351 Bd des Forges, Trois-Rivie`res, QC G8Z 4M3, Canada
Email address: amir.saki@uqtr.ca, amir.saki.math@gmail.com
45
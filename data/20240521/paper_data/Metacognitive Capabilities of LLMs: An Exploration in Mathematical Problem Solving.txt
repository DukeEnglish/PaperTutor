Metacognitive Capabilities of LLMs: An Exploration
in Mathematical Problem Solving
AniketDidolkar1,AnirudhGoyal1,NanRosemaryKe4,SiyuanGuo3,
MichalValko4,TimothyLillicrap4,DaniloRezende4,
YoshuaBengio1,MichaelMozer4,SanjeevArora2
Abstract
Metacognitiveknowledgereferstohumans’intuitiveknowledgeoftheirownthink-
ingandreasoningprocesses. Today’sbestLLMsclearlypossesssomereasoning
processes. Thepapergivesevidencethattheyalsohavemetacognitiveknowledge,
includingabilitytonameskillsandprocedurestoapplygivenatask. Weexplore
thisprimarilyincontextofmathreasoning,developingaprompt-guidedinteraction
proceduretogetapowerfulLLMtoassignsensibleskilllabelstomathquestions,
followedbyhavingitperformsemanticclusteringtoobtaincoarserfamiliesof
skilllabels. Thesecoarseskilllabelslookinterpretabletohumans.
TovalidatethattheseskilllabelsaremeaningfulandrelevanttotheLLM’sreason-
ingprocessesweperformthefollowingexperiments. (a)WeaskGPT-4toassign
skilllabelstotrainingquestionsinmathdatasetsGSM8KandMATH.(b)When
usinganLLMtosolvethetestquestions,wepresentitwiththefulllistofskill
labelsandaskittoidentifytheskillneeded. Thenitispresentedwithrandomly
selectedexemplarsolvedquestionsassociatedwiththatskilllabel. Thisimproves
accuracyonGSM8kandMATHforseveralstrongLLMs,includingcode-assisted
models. Themethodologypresentedisdomain-agnostic,eventhoughthisarticle
appliesittomathproblems.
1 Introduction
Large language models (LLMs) have demonstrated remarkable advancements in recent years at
natural language inference tasks [1–7], as well as scientific and mathematical problems [8–11],
althoughtheirlimitationsonmathematicalproblemsarealsowell-documented[12–17].
AcoreconceptinhumanpedagogyisMetacognition[18],sometimesdescribedasthinkingabout
thinking. It refers to the ability to reason about one’s own cognitive processes as well as about
learning-relevantpropertiesofinformationordata. MetacognitiveKnowledgereferstothelearner’s
accumulatedknowledgeofthistype.Pedagogyresearchshowsthatimprovinglearners’metacognitive
knowledgecanimprovetheircapabilities,forexampleonmath[19,20]. Thecurrentpaperraises
thequestion“DoLLMsalsohavemetacognitiveknowledge?” Andifyes,“Canwebootstrapsuch
knowledgetofurtherimproveLLMcapabilities?”
Atfirstglance,thisquestseemsdifficult. DecipheringLLMs’innerworkingfromtheirhugesetof
parameters–allresultsofnon-linearoptimization—isnotoriouslyhard. Furthermore,theleading
modelsareproprietaryandwelackparameteraccesstomostofthem. Buttherearestillreasonsto
hopewecanunderstandmetacognitionbyinteractingwithLLMs. Theyareknowndisplaysome
humantics,suchasabilitytoimprovetheirmathreasoningviaChainofThought(CoT) [21]and
alsothe“Let’sthinkstepbystep”prompt[22]. Theseweregenerallyperceivedasconvenienttricks
01Mila,UniversityofMontreal,2PrincetonUniversity,3TheUniversityofCambridge,4GoogleDeepMind
Correspondingauthors:adidolkar123@gmail.com, anirudhgoyal9119@gmail.com.
Preprint.Underreview.
4202
yaM
02
]IA.sc[
1v50221.5042:viXraCreating Skill Exemplar Repository
Skill Labelling Skill Clustering Skill Exemplars
Skill-II
Q-1 (Question 1) Skill-1 Q-2 Skill-I Q-1 Q-3
Skill-I
Q-2 (Question 2) Skill-2 Q-5
Q-3 (Question 3) LLM A Skill-3 Q-1 Skill-II Q-2 Q-5
Q-3
Q-4 (Question 4) Skill-4
Q-4 Skill-III
Q-5 (Question 5) Skill-5 Skill-III Q-4
Inference
Inference Skill Labelling Select In-Context Exemplars Compute Answer
TQ (Test Question) LLM A Skill-II Q-2 Q-5 Q-2 Q-5 TQ LLM B A
Figure1: CreatingSkillExemplarRepository: First,apowerfulLLMAlabelseachquestionwith
acorrespondingskill,asdetailedinthepromptprovidedinAppendixFigure2(left). Next,LLMA
isaskedtocombinesimilarfine-grainedskillsintobroaderskillclusters,whichrepresentcomplex
skills. Thisgreatlyreducesthenumberofuniqueskillsfromthefirststage. Thepromptforthisis
depictedinAppendixFigure2(middle). ThentheLLMisaskedtoreclassifyallexamplesfromthe
trainingsetintooneofthepost-clusteringskills. Usingthesewecreatea’SkillExemplarRepository’
whichconsistsofskillexemplarsconsistingofskillnamesandtheircorrespondingquestion/answer
examples. Inference: DuringinferenceonatestquestionusingLLMB(whereBmaybedifferent
fromAornot)weaskLLMBtolabelthetestquestionwithoneoftheskillsfromtheskillexemplar
repository. Next,wefetchexemplarsfromtherepositorywiththesameskilllabelandprovidethem
asin-contextexamplestoLLMBtohelpitsolvethetestquestion.
to get around the limitations imposed by the LLM’s auto-regressive nature. But other pieces of
evidencehaveemergedaboutexistenceofLLMmetacognition. AnotableexampleisAsk-LLM[23],
wherebytheLLMappearstogivesurprisinglyhelpfulanswerstothequestion“Isthisagoodtraining
datapointforanLLM?”ThecurrentpaperreportsonsimilardirectapproachtodecipheringLLM
metacognition: Justgoaheadandaskit!
Specifically,theMetacognitiveKnowledgeofinterestinthispaperisthecatalogofskills(fromthe
LLM’sviewpoint)thatitapplieswhilesolvingmathquestions. Pedagogyresearchhasuncoverex
a rich catalog of skills in humans, ranging from simple ones — operations on variables, solving
equations,graspingtheconceptofafunction—todifficultonessuchasgraspofdifficulttheoremsand
proofstrategies. WeareinterestedinarefinedunderstandingofLLMskills,morefine-grainedthan
thebroadhuman-assignedlabels(suchas“probability”and“algebra”)currentlyusedinmathematical
datasetssuchasMATH[16].
SkillDiscovery: Ourautomatedapproachforthediscoveryofskillsutilizesstate-of-the-artLLMsto
identifytheirowncatalogofmathskills andthenorganizedatasetsusingthatcatalog. Stage1ofour
methodologyinvolvesinstructingthepowerfulLLMtoassignskilllabelstoeachexamplewithin
a given dataset. Usually this results in fine-grained skills, and too many skill labels to be useful.
InStage2, thesameLLMisaskedtoperformsemanticclusteringonthelabeleddata,grouping
examplesbythesimilarityoftheirunderlyingskills(asperceivedbytheLLM).Eachresultingcluster
representsamorecoarse-grainedskillthatisapplicabletoalargersetofexamples. Ourmethod
retainsonlythesecoarseskillsaswellastheirLLM-assignedlabel. (Togiveanexample,forthe
MATHdataset,Stage1identifiedapproximately5000skills,whichStage2reducedto117coarse
skills.) Arandomsubsetofexamplesrepresentingthecoarseskillsareretainedasitsskillexemplars.
(SeeFigure1andAppendix8).
Tosubsequentlyimprove(in-context)mathproblemsolvingbyLLMsweusetherepositoryofskill
exemplars–eachlabeledwithacoarseskill. HeretheLLMbeingtestedisgivenanewquestionand
theabovelistofcoarseskillsandaskedtoidentifytheskillneededtosolvethisnewquestion. Then
theLLMisprovided thepreviouslyidentifiedexemplarsfortheselectedskillasin-contextexamples
to guide its problem-solving. We note that this is reminiscent of how human problem-solving is
2Dataset Topic Skills
GSM8K - multiplicationandaddition,basicarithmetic,additionandmultiplication,arithmeticoperations,multiplica-
tion,percentagecalculations,subtraction,algebra,subtractionanddivision,multiplicationanddivision,
multiplicationandsubtraction,additionandsubtraction,percentagecalculation,additionsubtraction,aver-
agecalculation,subtractionmultiplication,division,addition,linearequations,algebraicreasoning
Table 1: List of Skills for each Dataset This table lists down the skill obtained after the skill
clusteringphaseforeachdatasetandcorrespondingtopics. SkillnameswereprovidedbyGPT-4-
0613. TheskillsoftheothertopicsinMATHcanbefoundinAppendixTable8
taughtby presentingexamplesverycongruentwiththespecificproblemathand. Herewefindthat
LLMproblemsolvingimprovesusingtheskilllabelsandskill-exemplarsprovidedbyanLLMon
thesamedataset. Thisprovisionofskill-exemplarscanbeseenasanewadditiontoontopofknown
promptingmethodssuchasChain-of-thought.
Althoughwedescribeourmethodonlyincontextofmath,itseemsgeneralenoughtobebroadly
applicabletoproblem-solvingofothersorts. Thisisleftforfuturework.
Paper organization and main results: Section 3 describes the method and Section 4 describes
experiments.UsingastrongLLM-GPT-4-toidentifyskills,wevalidatetheusefulnessoftheseskills
bydemonstratesasignificant11.6%enhancementoverCoTontheMATHDatasetusingthemethod
describedinSection3. Furthermore,theidentifiedskillsalsoimprovethegenerationofcode-based
solutionsfortheproblemswithintheMATHdatasetgivinga7.52%improvementoverthebaseline
PALapproach[24],whichalsoinstructsthemodeltogeneratecode. Section4.3showsthatthethe
skillexemplarrepositorycreatedforMATHnoticeablyimprovedin-contextperformanceforweaker
LLMsonthesamedatasetandthattherepositoryforGSM8Khelpedimprovein-contextperformance
forothermathdatasets. ThisshowsthatapowerfulLLMcanbeusedfordeeperunderstandingof
skillsthattranslatesacrossotherLLMsandrelateddatasets.
2 RelatedWorks
Forhumanlearning,statisticalmethodscaninferlatentskillsfromdataandusetheinferredskillsto
moreaccuratelyforecaststudentlearning[25,26]. Inmachinelearning,worksthatstudylearning
via skill induction include [27–30]. These start with some definition of skills in terms of model
parameters,whereasweuseapowerfulLLMinablackboxwaytoidentifyandconsolidateskills. A
discussionofvariouspromptingstrategiesiscoveredinSection4andAppendixSection9.
3 AutomatedSkillDiscovery
WedescribeourautomatedprocessforgettingapowerfulLLMtocategorizemathematicalquestions
accordingtospecificskillsneededtosolvethem. SeeFigure1. Recentworksrelatingskillsand
LLMs[31,32]wereaninspiration.
Conceptually,thestrategyinvolvesthecreationofadetailedskillexemplarrepository,whichcontains
acompilationofskillnamesalongsiderespectiveillustrativeexamples(comprisingbothquestions
andanswers). Duringtheinferencestage,whenpresentedwithaquestion,theLLMinitiallylooks
amongskillexemplarstoidentifytheskillthatisbestsuitedforthequestion. TheLLMthenutilizes
thecorrespondingexemplarsforthatskillasin-contextprompts.
Notation. The proposed setup consist of a training set T = {(qT,aT),(qT,aT),...,(qT,aT)},
0 0 1 1 n n
whereqT andaT arequestionandanswersfromthetrainingset. Thetrainingsetisusedforselecting
i i
in-context examples for inference. Our test set also consists of set of questions and answers -
E ={(qE,aE),(qE,aE),...,(qE,aE)}. Tocreatetheskillexemplars,wefirstlabelthetrainingset,
0 0 1 1 n n
T,withaskillperexampleusingaLLM.Next,welabelthetestsetwithskillstoretrievein-context
exampleswithmatchingskillsfromtheskillexemplarrepository. Theexactprocedureoflabelling
thetrainingandtestsetwithskillsisdifferentandwedetailbothapproachesbelow.
3.1 SkillLabelling: categorizingmathematicalquestionsaccordingtospecificskills
TheprocessisillustratedinFigure1. Ithadthefollowingsteps.
AssignSkillNameforeveryexampleintrainingSetT: Usingacarefullycuratedprompt(given
inAppendixFigure2(left)),weaskedaLLMtolabeleachtraininginstancewithasingleskillname
andareasonforthatassignedskill. Figure1(top)representsthisprocess. ApplyingastrongLLMfor
3thistask-GPT-4-0613-wefoundthatforthe7,000instancesintheGSM8Kdataset[33],itspecified
approximately500uniqueskillnames.Forthe7,500examplesintheMATHdataset[16],itspecified
5,000skillnames. (ThisperhapsreflectsthehardnessanddiversityofMATHcomparedtoGSM8K.)
Althoughtheseskilllabelspreciselyencapsulatethecapabilitiesrequisiteforsolvingeachquestion,
itisclearthatthegranularityisexcessive,raisingissuesreminiscentofclassical“overfitting.”
For example, for the question "In a triangle, the area is numerically
equal to the perimeter. What is the radius of the inscribed circle?
(A) 2 (B) 3 (C) 4 (D) 5 (E) 6" GPT-4 came up with the skill name understand-
ing of triangle properties and circle radius calculation. Despite descriptive accuracy, its
highspecificitymaylimititsutility,asitisimprobablethatanidenticalquestionembodyingthis
preciseskillwillrecur. Toaddressthis, theinitiallabellingphaseisfollowedbyaphaseofskill
clustering,aimingtogeneralizetheskillcategoriesforbroaderapplicability.
SemanticSkillClustering: Inthisphase,theLLMwaspromptedtoaggregatetheskillsidentified
intheskilllabellingstage,specificallytogroupsimilarskillsintobroadercategories(Figure1(top))
andassignadescriptivelabeltoeachcategory. (ThepromptappearsinAppendixFigure2(middle).
) AgainutilizingGPT-4-0613forthis,weobtainedareducedskillsetcomprisingof22skillsfor
GSM-8Kand117skillsforMATH.ThelistofskillsarepresentedinTable1,andAppendixTable
8. Subsequently,weusetheLLMtoreclassifyallexamplesinthetrainingsetT usingthesenew
skillnamesfromtheclusteringphase. Thustheinitialhighlydetailedskilllabelsgetconsolidated
intobroader,moreuniversallyapplicablecategories. Forinstance,thequestioninitiallylabelledas
”understanding of triangle properties and circle radius calculation” is relabeled to have the skill
name”understanding of triangles”. Thismodificationsignificantlyenhancestheapplicabilityofthe
trainingsetforawiderrangeofproblem-solvingscenarios.
SkillExemplarRepository: Followingtheskillclusteringandrelabellingprocessofthetraining
set, weestablisheda‘SkillExemplarRepository.’ Thiscontainsacuratedselectionofskillsand
theircorrespondingexemplars,specificallyquestionsandanswers,derivedfromthetrainingsetT.
Thestructureoftheskillexemplarrepositoryisformalizedasfollows: skillexemplarrepository=
(s ,qT,aT),(s ,qT,aT),...,(s ,qT,aT),wheres denotestheskilllabelassociatedwiththei-th
0 0 0 1 1 1 n n n i
question-answerpair(qT,aT).SeeFigure1(top)foranexampleofsucharepository.Thissystematic
i i
compilationfacilitatesefficientreferencingandapplicationofrelevantexamplescorrespondingto
specificskillsduringinference. App. Tables9,14,and15illustrateexamplesfromtheskillexemplar
repositoriesfortheGSM-8kandMATHdatasetsrespectivelycreatedusingGPT-4-0613. Wecansee
thateachquestionislabelledwithahumaninterpretableandintuitiveskillname.
3.2 Inferenceattesttime
Inthetestingphase,theLLMisgivenamathquestionQ. Itisaskedtofirstselectoneskillfromthe
listofskillsintherepository,says thatismostrelevanttothequestion. (Thepromptemployedfor
i
thisstepappearsinAppendixFigure2(right).) Next,K Exemplarscorrespondingtos ,randomly
i
picked,arethenemployedforfew-shotpromptingasusual. ByprovidingtheLLMwithcontextually
relevant, skill-specific examples from the repository, one expects to enhance its effectiveness at
answeringthequestionQ. ThisprocessisdepictedinFigure1(below).
Transferringskillexemplarstootherdatasets Thebroadrangeofquestions,answersandskill
labelsintheexemplarrepositorymakesitanattractivesourceofrelevantin-contextexamplesfor
solvingvariousmathematicalproblems. Todemonstratesuchadaptabilityandutilityweapplied
theSkillExemplarRepositoryderivedfromGSM8Kdatasettosolvingvariousexistingmathword
problemdatasetsthatweredesignedtoevaluateconcretemathematicalskillsorconcepts. Section4.3
reportsnotableimprovementsinproblem-solvingcapabilitiesacrossdomains.
3.3 SkillsfromstrongLLMsimproveweakerLLMs
Throughthemethodologydescribedabove,wefindthatastrongLLM-suchasGPT-4-0613-isable
assignintuitiveandhumaninterpretableskillnamestoquestions. Theseskillsarearepresentation
ofthemetacognitiveknowledgeoftheLLM.Weconsiderwhetherthisknowledgecanbeapplied
tootherLLMs-specificallyweakerLLMs. Section4.3showsthatskill-basedin-contextexamples,
labeled using a stonger LLM as described earlier, also significantly enhance the performance of
4lessadvancedmodels,suchasMixtral[34]. Thisunderscoresthattheskilllabelsassignedbyone
powerfulLLMisbroadlycomprehensibleandusefultootherLLMstoo.
Skill-exemplarsimprovevariouspromptingmethods Ourapproachisdesignedtobesynergistic
witharangeofpromptingtechniques,therebyofferingbroadapplicabilityacrossvariousmethod-
ologies. Itcanbeseamlesslyintegratedwithnumerousexistingpromptingstrategies,includingthe
ChainofThought(CoT)approach[21],PAL[24],andtheself-consistencymethod[35]. Ineach
oftheseinstances,theproposedmethodenhancestheexistingframeworkbysubstitutingthecon-
ventionalin-contextexampleswiththosemeticulouslyselectedfromtheSkillExemplarRepository.
Thisintegrationnotonlypreservestheinherentstrengthsoftheoriginalpromptingtechniquesbut
alsoaugmentsthembyleveragingthespecificityandrelevanceoftheskill-alignedexamples. This
adaptabilityunderscorestheversatilityandpotentialoftheproposedapproachtoimprovetheefficacy
ofvariouslanguagemodelpromptingstrategies.
Prompting Pre-AlgebraGeometryInter-AlgebraAlgebraProbabilityPre-CalculusNum.TheoryOverall
CoT - - - - - - - 42.2
ComplexCoT 71.6 36.5 23.4 70.8 53.1 26.7 49.6 50.30
CoT+Topic-Based 71.16 39.45 24.14 67.90 54.64 31.13 47.03 50.31
CoT+Skill-Based 74.28 41.75 27.02 73.12 58.01 33.70 51.10 53.88
Table2: Text-basedpromptresultsontheMATHDataset. OurSkill-Basedapproach,employing
CoTprompting,demonstratessuperiorperformanceoverallothermethodsacrossalltopicswithin
theMATHdataset. AllexperimentswereconductedusingGPT-4-0613.
4 Experiments
InSection3,wehavedescribedaproceduretoextractmetacognitiveknowledgefromLLMsinthe
formofskillannotationsformathematicalquestions. Inthissection,weshowthatthisknowledgeof
skillscanbefurtherusedtoimprovereasoninginLLMsbyusingthemtoprovidepertinentin-context
examplesforsolvingnewmathematicalproblemsthroughtheprocessdescribedinSection3.2and
depictedinFigure1(below). Ourevaluationfocusedonthreedistinctareas: Text-basedPrompts:
Weutilizedchain-of-thoughtprompting,asdetailedinSection4.1. Thismethodinvolvesproviding
step-by-stepreasoningintheprompttoguidethemodel’sthoughtprocess,Program-basedPrompts:
Here,weemployedprogram-aidedlanguagemodels(PALs),describedinSection4.2. PALsintegrate
programminglogicwithinthelanguagemodel, aimingtoenhanceitsreasoningcapabilities, and
Transferability: WeinvestigatethegeneralizabilityoftheseskillsacrossdifferentLLMsanddatasets,
aselaboratedinSection4.3.ThisaspecttestshowwelltheskillstransfertodifferentLLMmodelsand
unseendatasets. Ourresultsdemonstratethatknowledgeofskillssignificantlyimprovesperformance
for both text-based and program-based prompting across different datasets. Furthermore, these
skillsexhibitstrongtransferability,boostingmathematicalreasoningcapabilitiesacrossothermaths
datasetsandLLMmodels. Finally,weconductadetailedanalysistogainadeeperunderstanding
howourapproachinfluencethereasoningabilitiesofLLMs.
PromptingMethods Weinvestigatetwoprominenttypesofin-contextpromptingmethodsfor
enhancing mathematical reasoning in LLMs: Text-based Prompting: Utilizes text examples to
demonstrate problem-solving steps, with Chain-of-Thought (CoT) [21] being a prime example.
Program-aidedPrompting:Employsprogramstoshowcasereasoningsteps,asseeninProgram-aided
LanguageModels(PALs)[24].
Toassesstheeffectivenessofthesemethods,wereplacedthestandardin-contextexamplesusedby
CoT[21]andPAL[24]withexamplesfromourskillexemplarrepository. Wethenevaluatedthe
performanceofLLMswithbothtext-basedandprogram-basedprompting,usingourskillexemplars
versusstandardexamples.
Baselines Ourevaluationalsoincludesacomparisonwithfourbaselinestoisolatetheimpactof
ourskill-specificexamples: Random: Thisbaselinerandomlyselectsexamplesfromourrepository
incontrasttoCoT’sfixedexamples,highlightingthenecessityofskill-alignedexampleselection.
Topic-Based: Examplesaregroupedbybroadermathematicaltopics(e.g.,algebra),asintheMATH
dataset[16]. Thistestswhetherfiner-grainedskills(asdetailedinTable8)offeranadvantageover
broadertopiccategorizations. ComplexCOT [36]: Choosescomplexin-contextexamplesforCoT,
allowingustoanalyzewhethercomplexityorskill-specificityhasagreaterimpactonperformance.
5Retrieval-RSD [37]: This selects relevant in-context examples for few-shot tasks similar to the
proposedapproach. Theyfirstmaptheexamplestoalatentspaceandthenselectstop-kin-context
examplesbasedoncosinesimilaritytotheexample. Throughthesecomparisons,weaimtodiscern
therelativebenefitsofskill-specificityandcomplexityinexampleselectionforenhancingLLMs’
mathematicalreasoningcapabilities.
Datasets Weevaluatetheproposedapproachusingavarietyofmathematicalreasoningdatasets.
WestartwiththeGSM8Kdataset[33],whichcomprisesgrade-schoollevelmathproblems. Wethen
moveontothechallengingMATHdataset[16],knownforitscompetition-levelproblems.
To examine the transferability of skills, we apply the skills from the GSM8K dataset to other
math word problem datasets. These include SVAMP [15], ASDIV [38], and the MAWPS suite
(SingleOP,SingleEQ,AddSub,MultiArith)[39]. Eachdatasetpresentsitsuniquesetofchallenges
andcomplexities,allowingustothoroughlyassesstheadaptabilityandeffectivenessofourapproach
acrossdifferentmathematicalcontexts. Fordetailsaboutthesedatasets,pleaserefertotheAppendix
10.1.
LanguageModels InSection10.4oftheAppendix,weconductacomparativeanalysisofGPT-
4-0613, GPT-3.5-Turbo, and Mixtral-8x7B in their proficiency in generating precise skill labels.
Throughexperimentation,weshowthattheskilllabelsannotatedbyGPT-4-0613leadtothestrongest
in-contextlearningperformanceontheMATHdataset[16]. Therefore,weestablishGPT-4-0613
astheprimarymodelforskilllabeling,clustering,andconductingthemajorityofourexperiments.
Fortransferexperiments,asoutlinedinSection3.3andfurtherdetailedinSection4.3,weevaluate
theperformanceoftheMixtral8x7Bmodel[34]. Thisdual-modelapproachallowsustoassessthe
effectivenessofourmethodsacrossdifferentadvancedlanguagemodels.
4.1 Text-basedPrompts
WeconsidertheGSM8Kdataset[33],containinggrade-levelmathwordproblems,andtheMATH
dataset [16], featuring competition-level math problems. These experiments aim to assess the
efficacyofourapproachacrossawiderangeofmathematicalcomplexities,specificallyusingtext-
basedpromptingstrategies. AllexperimentswerecarriedoutusingGPT-4-0613,employing8-shot
promptingandadecodingtemperaturesetto1.0.
ResultsonGSM8K.GSM8Kdataset[33]contains7.5k
trainingproblemsand1ktestproblems. Theskillexemplar
BaseModel Prompting GSM8K
repositoryiscreatedusingthetrainingdataonly,referto RetrievalRSD 76.8
GPT-3.5-Turbo
Section 3.1 for details. See Table 9 in the appendix for CoT+Skill-Based 82.03
examplesfromtheskillexemplarrepository. CoT 93.00
CoT+Random 92.87
We utilize the skill exemplar repository to solve test set GPT-4-0613 CoT+Skill-Based 94.31
problemsfromtheGSM8Kdataset,asoutlinedinSection CoT+Skill-Based(maj@5) 95.38
3.2. The results are shown in Table 3. Our Skill-Based
Table 3: Text-based prompt results
approachoutperformsboththeChain-of-Thought(CoT)
on the GSM8K Dataset. Our Skill-
andRandombaselinesontheGSM8Kdataset,underscor-
Based approach outperforms various
ing the importance of accurate skill assignment and per-
other methods on the GSM8K dataset
tinent in-context examples in effective problem-solving.
across two different models: GPT-3.5
Furthermore,augmentingtheSkill-Basedapproachwith
TurboandGPT-4-0613.Refertotextfor
self-consistency(SC,presentedasmaj@5inTable3)tech-
descriptionofbaselines.
niques[35]leadstoevenbetterperformance,highlighting
theadaptabilityandeffectivenessofourmethod. FortheSCexperiments,wesample5reasoning
chains from the LLM and choose the most frequent answer. Additionally, we provide a detailed
breakdownofper-skillaccuracyforboththeproposedapproachandtheRandomapproachinAp-
pendixFigure3. Tofurtheremphasizetheeffectivenessoftheproposedmethod,wecompareitto
theRetrieval-RSDapproach[37]whichisalsoapertinentin-contextexampleselectionapproachfor
few-shotprompting. TheresultsarepresentedinTable3showthesuperiorityofourapproachas
comparedtotheRetrieval-RSDapproach. WeuseGPT-3.5-Turbobackboneforthiscomparison.
ResultsonMATH.TheMATHdataset,comprisingcompetition-levelmathproblems,coverstopics
like Pre-Algebra, Algebra, Intermediate Algebra, Geometry, Number Theory, Precalculus, and
Probability. Itstrainingsethas7.5kexamplesandthetestsethas5kexamples,eachlabeledbytheir
respectivetopics. FollowingthemethodologydescribedinSection3.1,wecreatedaSkillExemplar
6Prompting InterAlgebraPrecalculusGeometryNum.TheoryProbabilityPreAlgebraAlgebraOverall
PAL(4-shot) 30.9 23.2 31.7 66.1 57.9 73.2 65.3 52.0
PAL+Skill-Based(3Skill-Based+1Code-Based) 35.05 44.64 39.02 70.97 60.53 78.05 72.58 59.32
PAL+Skill-Based(7Skill-Based+1Code-Based) 37.11 53.57 41.46 72.58 65.79 81.70 73.39 62.00
Table 4: Program-aided prompts results on the MATH dataset. This table illustrates the per-
formanceachievedbyemployingtheSkill-Basedapproachtogeneratecodeforproblem-solving
tasksdrawnfromtheMATHdatasetusingGPT-4-0613. Evidently,supplyingpertinentin-context
examplesgroundedinspecificskillsenhancestheprogramgenerationperformanceofGPT-4-0613,
leadingtoanotableimprovementacrossalltopicsencompassedintheMATHdataset.
Prompting SC Pre Geometry Inter- Algebra Probab- Pre- Num. Overall
(maj@n) Algebra Algebra ility Calculus Theory
CoT maj@4 - - - - - - - 28.4
+Topic-Based × 42.94 17.33 11.30 40.78 19.83 14.47 16.85 26.14
+Skill-Based × 47.76 19.42 13.29 43.05 20.04 16.12 18.33 28.44
+Topic-Based maj@4 52.58 20.25 10.68 48.78 24.05 14.65 20.93 30.75
+Skill-Based maj@4 53.96 22.55 13.68 49.70 24.26 18.32 21.48 32.44
Table 5: Transfer of Skill Exemplars to Other Models. All experiments are performed using
theMATHdatasetontheMixtral8×7Bmodel,comparingagainststandardChain-of-Thought
(CoT),CoTwithtopic-basedexemplars,CoTwithskill-basedexemplars,CoTwithself-consistency
(maj@4)usingbothtopicandskill-basedexemplars. SkilllabelsandexemplarsfromGPT-4-0613
wereutilized. TheenhancedperformanceofourSkill-Basedindicateseffectivetransferabilityof
skillsfromGPT-4toanothermodel.
RepositoryusingtheMATHdataset’strainingset. Thisrepositoryisshowcasedthroughexamples
inAppendixTables14and15,providinginsightsintotherangeandnatureofskillscoveredinthe
MATHdataset. Furthermore,inAppendixTable10weshowexamplesoftherelevantin-context
examples selected from the skill exemplar repository to solve a given question. We can see that
selectedexemplarsaresimilartothequestiontobeandcorrectlyillustratetheconceptsrequiredby
thequestion.
ResultsontheMATHdatasetareshowninTable2. Forthisanalysis,ourproposedapproachutilizes
astraightforwardChain-of-Thought(CoT)method,whereinthein-contextexamplesaresourced
fromtheskillexemplarrepository. Ourmethodachievesanotableimprovementinperformance,
surpassingthestandardChain-of-Thought(CoT)byanimpressive11.6%. Wealsooutperform3.5%
overComplexCoT,and3.5%overtheTopic-Basedapproach. Theseresultshighlighttheefficacyof
ourapproach,particularlywithitsfine-grainedskilllabeling. ThefactthatitsurpassesComplexCoT
isespeciallynoteworthy,indicatingtheimportanceofselectingin-contextexamplesthatarehighly
relevanttothespecificproblem,ratherthanusingtheircomplexityasaproxyforquality.
4.2 Program-AidedPrompts
ProgramAidedLanguageModels(PALs),asdevelopedby24,aredesignedtoproduceprogram-
basedsolutionsforproblem-solving,employingPythonastheprogramminglanguage. Thisapproach
addresses the issue of logical or calculation errors in Language Models by translating solutions
intocode,thusleveragingacompilerforfinalanswergeneration. InourintegrationofSkill-Based
promptingwithPALs,wemodifythein-contextexamplestructure: weusethreenon-code-based
examplesfromourskillexemplarrepositorybasedonskillmatching,followedbyonefixedcode-
basedexample, totalingfourin-contextexamples. Thespecificsofthesepromptsaredetailedin
AppendixSection10.5.
Our experiment, results of which are shown in Table 4, tests this modified approach on a subset
of500examplesfromtheMATHtestset,sameasthoseusedin[40]. Thefindingsaresignificant:
despiteonlyonecode-basedin-contextexample(comparedtoPAL’sfour),ourapproachshowsa
7.52%improvementoverPAL.Thishighlightstheimpactofstrategicallychosen,relevantin-context
examples,ontheaccuracyofcodegenerationforproblem-solving.
4.3 TransferofSkillExemplars
StudyingTransferofSkillExemplarstoOtherModels Inthisstudy,weexplorethetransferability
ofskillsfromGPT-4tootherLLMs,particularlyfocusingonMixtral8x7B[34]. Thisexperiment
replicates the setup used for the earlier experiments with GPT-4-0613, utilizing the same skill
exemplar repository and skill labels for the MATH dataset test set examples initially labeled by
7Example1 Example2
Question Computesin210◦. Find(cid:108)√3−25(cid:109)
Tosolvetheproblem,wehavetoknowthat Thecuberootof−25isnotarealnumber,
Topic-BasedSolution thetrigonometricfunctionshaveperiod360◦, henceitcannotbeevaluated.Theceilingfunc-
whichmeanssin210◦ = sin(210◦ − tionisapplicableonlytorealnumbers,therefore
180◦)=sin30◦=1/2. thisexpressionisundefined.
Theangle210◦ is30◦ belowthenegative Thecuberootof-25,√3−25,equals-2.92ap-
Skill-BasedSolution x-axis, sosin210◦ = sin(−30◦) = proximately,sincetheceilingfunctionrounds
−1/2. uptothenearestintegergreaterthanthegiven
SkillUsed:trigonometry. number,thevaluewillbe−2.
SkillUsed:exponentandrootskills
Table7: InstancesBenefitingfromSkill-BasedApproachThistableillustratesinstanceswhere
ourskill-basedapproachempowerstheLanguageModel(LLM)toapplyrelevantskillseffectively.
Red-highlightedtextrevealsconceptualerrorsbytheTopic-Basedbaseline,whileblue-highlighted
textshowcasesskillfulandaccurateskillapplication.
GPT-4-0613. For each problem, 4 in-context examples are chosen based on skill-matching, and
outputsaresampledwithadecodingtemperatureof0.2. TheresultsaredisplayedinTable5. Weuse
1A100LGPUforthisexperiment.
Here, we compare our Skill-Based approach
againsttwobaselines: Chain-of-Thoughtwith
Prompting SVAMPSingleOPSingleEQAddSubMultiArithASDIV
self-consistency (SC) as per [35] and the CoT 91.9 97.2 97.2 93.9 98.0 92.7
PAL 92.2 95.2 96.8 94.9 98.5 90.2
Topic-Basedapproach. Forimplementingself-
CoT+PAL 93.7 97.3 98.6 95.7 99.0 93.5
consistency,wegeneratefourreasoningchains
CoT+Skill-Based 92.6 97.86 99.01 96.71 98.17 94.03
andselectthemostfrequentanswer(notedas
maj@4 in Table 5). The results demonstrate Table6: TransferofSkillExemplarstoOther
that our Skill-Based approach surpasses both Datasets Investigation of skill transfer from
theTopic-BasedandCoTapproaches. Notably, GSM8Ktodifferentmathwordproblemdatasets
our approach, even without self-consistency, using GPT-4-0613. Questions in the target
matchestheperformanceofCoTwithSC,high- datasetarelabeledwithcorrespondingskillsfrom
lighting its efficacy in extracting correct rea- GSM8K, and in-context examples are selected
soningpathsandconcepts. Furthermore,when basedonskill-matching. Theproposedapproach
combinedwithself-consistency,ourapproach achievesthehighestaccuracyin4outof6cases.
showsaremarkable4.0%improvementoverCoTwithSC,affirmingitssuperiorefficacyinskill
applicationandreasoning.
StudyingTransferofSkillexemplarstoOtherDatasetsHere,weinvestigatethetransferability
of skills from the GSM8K training dataset to other math word problem datasets. We apply our
approachtovariousdatasets,includingSVAMP[15],ASDIV[38],SingleOP,SingleEQ,AddSub,
andMultiArith[39],eachcomprisingdistinctproblemtypes. WeutilizetheGSM8K-derivedskill
exemplarrepositoryforthesedatasets,testingskilltransferabilityacrosssimilardatasets. Notably,
weusethepre-clusteringskilllabels,asthesedatasetsfeaturefinergranularityproblemscomparedto
GSM8K,makingpost-clusteringskillslesseffective.
The results, presented in Table 6, demonstrate the effectiveness of our approach. We employ a
CoT-basedmethodwith4-shotpromptingandgreedydecoding,aligningwiththebaselinesettings.
OurSkill-BasedapproachconsistentlysurpassesthebaseCoTacrossalldatasets. Wealsobenchmark
againstaPAL-basedapproachandahybridCoT+PALapproachfrom[41],wherethemodeloutputs
bothCoTandPALsolutionsandselectsthemostaccurate. OurSkill-Basedapproachoutperforms
CoT+PALin4outof6datasets, offeringasimpleryetmoreeffectivesolution. Thesefindings
affirmthepotentialofskillknowledgetransferfromonedatasettoothersimilardatasets.
4.4 Analysis
WedelveintotheimpactofSkill-Basedonpreciseconceptandskillapplication,Firstly,wepinpoint
successfulinstanceswhereSkill-BasedpromptsguidetheLLMinselectingandapplyingthecorrect
skills. Secondly, we investigate cases where, despite pertinent Skill-Based prompts, the LLM
failstoutilizetherightconcepts. Lastly,wequantifytheseinstancesoffailureandcomparethem
againstbaselinemodels,assessingtheefficacyofSkill-BasedpromptinginenhancingtheLLM’s
performance. AllexperimentsareperformedusingGPT-4-0613.
8InstancesofLLMbenefitingfromSkill-BasedApproachInTable7,wecomparetheeffectiveness
oftheSkill-BasedapproachagainsttheTopic-Basedapproachinproblem-solvingscenariosthrough
examples. TheSkill-Basedapproachsignificantlyimprovesthemodel’sreasoningandskillapplica-
tion. WehighlightthereasoningerrorsoftheTopic-Basedapproachinredandthecorrectreasoning
stepsundertakenbytheSkill-Basedapproachinblue.
OuranalysisrevealsthattheTopic-Basedapproachmisappliesessentialskills. Forexample,Table7
showsafundamentalmisunderstandingoftrigonometryinExample1andfailstorecognizenegative
cubesinExample2. TheseerrorsarenotablyabsentintheSkill-Basedapproach,demonstratingits
superiorunderstandingandapplicationofkeyconcepts.
OccurrencesofIncorrectAnswersDespiteEmployingaSkill-BasedApproachWeexaminethe
limitationsoftheskill-basedapproachinTable13(appendix). Thistablehighlightsinstanceswhere
themodel,despiteusingaskill-basedapproach,failstoproducecorrectanswers. Weuseblueto
denotecorrectreasoningstepsandredforerrors.
In Example 1, both the Skill-Based and Topic-Based approaches correctly apply the logarithm
formulabuterrinselectingtheappropriatenumberorinput,categorizingthiserrorasa”mainskill
error” or ”skill error.” This demonstrates a failure in correctly applying the primary skill needed
forthequestion,highlightingalimitationoftheproposedapproach. Example2furtherillustrates
thislimitation. AlthoughtheSkill-Basedapproachcorrectlyusescountingconcepts,iterroneously
calculatesthenumberofdiagonalsinahexagon. Thiserrorindicatesashortfallintheapplication
ofcertainsecondaryskillsrequiredtosolvetheproblemsuchas, inthisinstance, understanding
propertiesofahexagon.
TheseexamplessuggestthatwhiletheSkill-Basedapproacheffectivelyguidestheapplicationof
themainskillrequiredforaquestion,itmayfalterintheapplicationofsecondaryskillsorinthe
comprehensionofspecificquestionproperties. Thisanalysisunderlinestheapproach’sstrengthsin
primaryskillapplicationbutalsoitslimitationsinmorenuancedorcompoundskillscenarios. It
wouldbeworthwhiletoworkwithmorecomplexskills.
AdditionalMetricsWeintroducethreemetricstoevaluatetheeffectivenessoftheproposedapproach,
usingexamplesfromtheMATHdatasetandemployingGPT-4-0613forclassification. Thesemetrics
are: MAIN SKILL ERROR(SKILL ERROR): Thisindicatesafailureinunderstandingorapplying
the primary skill required for a question, SECONDARY SKILL ERROR: This denotes errors in
comprehendingorapplyingsecondaryskillsnecessaryforthequestion, CALCULATION ERROR:
Thisreflectsmistakesinthecalculationprocessduringquestion-solving.
These error types are not mutually exclusive; a single instance may exhibit multiple error types.
Correctlysolvedinstancesshownoneoftheseerrors. GPT-4-0613’sroleinclassifyingexamples
intothesecategoriesisdetailedinAppendix,Section10.7,anditseffectivenessisevidencedbythe
classificationsinTable13. Tocalculatethemetrics,wefirstdetermineerrorratesforeacherrortype
andthenderivesuccessrates. Theseratesindicatehowoftenthemodelcorrectlyappliesmainand
secondaryskills,aswellasperformscalculations,acrossvariousquestions.
AppendixFigure4displaystheSKILLSUCCESSRATE,SECONDARY SKILLSUCCESSRATE,and
CALCULATIONSUCCESSRATEforbothSkill-BasedandTopic-Basedapproaches. Weexpectthe
skill-basedin-contextexampleselectiontobeusefulforreducingmainskillerrors. Ourhypothesis
issupportedbyourfindings,whichshowahigherSKILL SUCCESS RATEforthisapproach. This
suggeststhatthemodelmorefrequentlyusesthecorrectskillwiththeSkill-Basedapproachcompared
totheTopic-Basedbaseline. Additionally,theproposedapproachalsodemonstrateseffectivenessin
reducingsecondaryskillerrorsandcalculationerrors,underscoringitsoverallsuperiorperformance.
5 DiscussionandConclusion
WepresentedaframeworkforextractingmetacognitiveknowledgefromLargeLanguageModels
intheformofskillsthatcategorizequestionsinmathematicaldatasetsbasedonconceptsrequired
tosolvethem. ThisledtoaSkillExemplarRepository,containingalistofmathematicalquestion-
answer pairs annotated with the respective skills needed (in the LLM’s own estimation) for the
solution. Leveragingthisrepository,wefurnishpertinentin-contextexamplestoLargeLanguage
Models (LLMs) for tackling previously unseen mathematical questions. Our experiments show
substantialempiricalenhancementsacrossdiversemathematicaldatasets,rangingfromgrade-level
9mathproblemstointricatecompetition-levelmathchallenges. Theenhancementsinperformancevia
useoftherepositoryalsotransferstoweakerLLMs.
Forsimplicity(andtoallowsimpleclustering)ourmethodologyassignsonlyonenamedskilltoeach
mathquestion. AsdiscussedinSection4.4,mathematicalproblemsoftenrequireacombinationof
aprimaryskillandvarioussecondaryskills. Weleavedesignofamoreadvancedapproach—say,
usinganLLMtocreatehierarchiesofskillstoassignmultipleskillstoeachdatapoint—forfuture
work. Sucharichermapofmetaknowledgewouldbeveryinteresting.
Whilethispaperprimarilyaddressesin-contextlearning,ourfuturegoalistoextendthesemethod-
ologiestoimproveallmodelsthroughfine-tuningprocesses. Presently,ourframeworkreliesonthe
availabilityofadvancedmodelslikeGPT-4. However,theskilldiscoveryprocessimprovedin-context
learningforGPT-4,whichsuggeststhatusingskillstofine-tuneGPT-4mayraiseitscapabilities. This
hintsmorebroadlyatapathtowardsbootstrappingmodelcapabilities–andnotjustinmath—that
seemsworthexploring.
6 Acknowledgements
ThisresearchwasenabledinpartbycomputeresourcesprovidedbyMila(mila.quebec). ADwould
liketothankNandaHarishankarKrishnaforhelpwiththemainfigureinthepaperandVedantShah
forproofreadingandhelpfuldiscussions. AGwillliketothankDaanWierstra,MelvinJohnson,
SiamakShakeri,MurrayShanahan,JohnQuan,TheophaneWeber,OlivierTieleman,DavidSilver,
CharlesBlundell,BehnamNeyshabur,EthanDyerandNicolasHeessforsupportandguidance.
References
[1] TomBrown,BenjaminMann,NickRyder,MelanieSubbiah,JaredDKaplan,PrafullaDhariwal,
ArvindNeelakantan,PranavShyam,GirishSastry,AmandaAskell,SandhiniAgarwal,Ariel
Herbert-Voss,GretchenKrueger,TomHenighan,RewonChild,AdityaRamesh,DanielZiegler,
Jeffrey Wu, Clemens Winter, Chris Hesse, Mark Chen, Eric Sigler, Mateusz Litwin, Scott
Gray,BenjaminChess,JackClark,ChristopherBerner,SamMcCandlish,AlecRadford,Ilya
Sutskever, and Dario Amodei. Language models are few-shot learners. In H. Larochelle,
M.Ranzato, R.Hadsell, M.F.Balcan, andH.Lin, editors, AdvancesinNeuralInformation
ProcessingSystems,volume33,pages1877–1901.CurranAssociates,Inc.,2020.
[2] AakankshaChowdhery,SharanNarang,JacobDevlin,MaartenBosma,GauravMishra,Adam
Roberts, Paul Barham, Hyung Won Chung, Charles Sutton, Sebastian Gehrmann, Parker
Schuh, Kensen Shi, Sasha Tsvyashchenko, Joshua Maynez, Abhishek Rao, Parker Barnes,
Yi Tay, Noam Shazeer, Vinodkumar Prabhakaran, Emily Reif, Nan Du, Ben Hutchinson,
Reiner Pope, James Bradbury, Jacob Austin, Michael Isard, Guy Gur-Ari, Pengcheng Yin,
TojuDuke,AnselmLevskaya,SanjayGhemawat,SunipaDev,HenrykMichalewski,Xavier
Garcia, Vedant Misra, Kevin Robinson, Liam Fedus, Denny Zhou, Daphne Ippolito, David
Luan,HyeontaekLim,BarretZoph,AlexanderSpiridonov,RyanSepassi,DavidDohan,Shivani
Agrawal,MarkOmernick,AndrewM.Dai,ThanumalayanSankaranarayanaPillai,MariePellat,
AitorLewkowycz,EricaMoreira,RewonChild,OleksandrPolozov,KatherineLee,Zongwei
Zhou, Xuezhi Wang, Brennan Saeta, Mark Diaz, Orhan Firat, Michele Catasta, Jason Wei,
KathyMeier-Hellstern,DouglasEck,JeffDean,SlavPetrov,andNoahFiedel. Palm: Scaling
languagemodelingwithpathways. JournalofMachineLearningResearch,24(240):1–113,
2023.
[3] RohanAnil,AndrewMDai,OrhanFirat,MelvinJohnson,DmitryLepikhin,AlexandrePassos,
SiamakShakeri,EmanuelTaropa,PaigeBailey,ZhifengChen,etal. Palm2technicalreport.
arXivpreprintarXiv:2305.10403,2023.
[4] JoshAchiam,StevenAdler,SandhiniAgarwal,LamaAhmad,IlgeAkkaya,FlorenciaLeoni
Aleman,DiogoAlmeida,JankoAltenschmidt,SamAltman,ShyamalAnadkat,etal. Gpt-4
technicalreport. arXivpreprintarXiv:2303.08774,2023.
[5] HugoTouvron,ThibautLavril,GautierIzacard,XavierMartinet,Marie-AnneLachaux,Tim-
othe´eLacroix,BaptisteRozie`re,NamanGoyal,EricHambro,FaisalAzhar,etal. Llama: Open
andefficientfoundationlanguagemodels. arXivpreprintarXiv:2302.13971,2023.
10[6] HugoTouvron,LouisMartin,KevinStone,PeterAlbert,AmjadAlmahairi,YasmineBabaei,
NikolayBashlykov,SoumyaBatra,PrajjwalBhargava,ShrutiBhosale,etal. Llama2: Open
foundationandfine-tunedchatmodels. arXivpreprintarXiv:2307.09288,2023.
[7] GeminiTeam,RohanAnil,SebastianBorgeaud,YonghuiWu,Jean-BaptisteAlayrac,JiahuiYu,
RaduSoricut,JohanSchalkwyk,AndrewMDai,AnjaHauth,etal. Gemini: afamilyofhighly
capablemultimodalmodels. arXivpreprintarXiv:2312.11805,2023.
[8] BernardinoRomera-Paredes,MohammadaminBarekatain,AlexanderNovikov,MatejBalog,
MPawanKumar,EmilienDupont,FranciscoJRRuiz,JordanSEllenberg,PengmingWang,
OmarFawzi,etal. Mathematicaldiscoveriesfromprogramsearchwithlargelanguagemodels.
Nature,pages1–3,2023.
[9] ChengrunYang,XuezhiWang,YifengLu,HanxiaoLiu,QuocVLe,DennyZhou,andXinyun
Chen. Largelanguagemodelsasoptimizers. arXivpreprintarXiv:2309.03409,2023.
[10] MengzhouHu,SaharAlkhairy,IngooLee,RudolfTPillich,RobinBachelder,TreyIdeker,and
DexterPratt. Evaluationoflargelanguagemodelsfordiscoveryofgenesetfunction. Research
Square,2023.
[11] TrieuHTrinh,YuhuaiWu,QuocVLe,HeHe,andThangLuong. Solvingolympiadgeometry
withouthumandemonstrations. Nature,625(7995):476–482,2024.
[12] MohammadJavadHosseini,HannanehHajishirzi,OrenEtzioni,andNateKushman.Learningto
solvearithmeticwordproblemswithverbcategorization.InProceedingsofthe2014Conference
onEmpiricalMethodsinNaturalLanguageProcessing(EMNLP),pages523–533,2014.
[13] Subhro Roy, Tim Vieira, and Dan Roth. Reasoning about quantities in natural language.
TransactionsoftheAssociationforComputationalLinguistics,3:1–13,2015.
[14] Subhro Roy and Dan Roth. Solving general arithmetic word problems. arXiv preprint
arXiv:1608.01413,2016.
[15] ArkilPatel,SatwikBhattamishra,andNavinGoyal. Arenlpmodelsreallyabletosolvesimple
mathwordproblems? arXivpreprintarXiv:2103.07191,2021.
[16] DanHendrycks,CollinBurns,SauravKadavath,AkulArora,StevenBasart,EricTang,Dawn
Song,andJacobSteinhardt. Measuringmathematicalproblemsolvingwiththemathdataset,
2021.
[17] JoyHe-Yueya,GabrielPoesia,RoseEWang,andNoahDGoodman. Solvingmathwordprob-
lemsbycombininglanguagemodelswithsymbolicsolvers. arXivpreprintarXiv:2304.09102,
2023.
[18] JHFlavell. Metacognitiveaspectsofproblemsolving. InTheNatureofIntelligence.Routledge,
1976.
[19] A.Corbett,K.Koedinger,andJ.Anderson. Intelligenttutoringsystems. InM.HelanderT.
LandauerandP.Prabhu,editors,HandbookofHumanComputerInteraction,pages849–874.
ElsevierScience,Amsterdam,1997.
[20] K. Koedinger, A. Corbett, and C. Perfetti. The knowledge-learning-instruction framework:
Bridgingthescience-practicechasmtoenhancerobuststudentlearning,2012.
[21] Jason Wei, Xuezhi Wang, Qixuan Liu, Bingtian Yang, Xinchi Dong, Huang Huang, and
WilliamWang. Chain-of-thoughtpromptingelicitsreasoninginlargelanguagemodels. arXiv,
abs/2201.11903,2022.
[22] TakeshiKojima,ShixiangShaneGu,MachelReid,YutakaMatsuo,andYusukeIwasawa. Large
languagemodelsarezero-shotreasoners. Advancesinneuralinformationprocessingsystems,
35:22199–22213,2022.
[23] NoveenSachdeva,BenjaminColeman,Wang-ChengKang,JianmoNi,LichanHong,EdHChi,
JamesCaverlee,JulianMcAuley,andDerekZhiyuanCheng. Howtotraindata-efficientllms.
arXivpreprintarXiv:2402.09668,2024.
11[24] LuyuGao,AmanMadaan,ShuyanZhou,UriAlon,PengfeiLiu,YimingYang,JamieCallan,
andGrahamNeubig. Pal: Program-aidedlanguagemodels. InInternationalConferenceon
MachineLearning,pages10764–10799.PMLR,2023.
[25] H.Cen,K.Koedinger,andB.Junker. Learningfactorsanalysis: Ageneralmethodforcognitive
modelevaluationandimprovement. InM.Ikeda,K.Ashley,andT.Chan,editors,Intelligent
TutoringSystems(volume4053ofLec.NotesinComp.Sci.),pages164–175.2006.
[26] RobertVLindsey,MohammadKhajah,andMichaelCMozer.Automaticdiscoveryofcognitive
skillstoimprovethepredictionofstudentlearning. Advancesinneuralinformationprocessing
systems,27,2014.
[27] Emma Brunskill. Estimating prerequisite structure from noisy data. In Educational Data
Mining,pages217–222,2011.
[28] Chen Liang, Jianbo Ye, Shuting Wang, Bart Pursel, and C Lee Giles. Investigating active
learningforconceptprerequisitelearning. InProceedingsoftheAAAIConferenceonArtificial
Intelligence,volume32,2018.
[29] LiangmingPan,ChengjiangLi,JuanziLi,andJieTang. Prerequisiterelationlearningforcon-
ceptsinmoocs.InProceedingsofthe55thAnnualMeetingoftheAssociationforComputational
Linguistics(Volume1: LongPapers),pages1447–1456,2017.
[30] Mayee F. Chen, Nicholas Roberts, Kush Bhatia, Jue Wang, Ce Zhang, Frederic Sala, and
ChristopherRe´. Skill-it! adata-drivenskillsframeworkforunderstandingandtraininglanguage
models,2023.
[31] Dingli Yu, Simran Kaur, Arushi Gupta, Jonah Brown-Cohen, Anirudh Goyal, and Sanjeev
Arora. Skill-mix: aflexibleandexpandablefamilyofevaluationsforaimodels,2023.
[32] Sanjeev Arora and Anirudh Goyal. A theory for emergence of complex skills in language
models,2023.
[33] KarlCobbe,VineetKosaraju,MohammadBavarian,MarkChen,HeewooJun,LukaszKaiser,
MatthiasPlappert,JerryTworek,JacobHilton,ReiichiroNakano,ChristopherHesse,andJohn
Schulman. Trainingverifierstosolvemathwordproblems,2021.
[34] AlbertQ.Jiang,AlexandreSablayrolles,AntoineRoux,ArthurMensch,BlancheSavary,Chris
Bamford,DevendraSinghChaplot,DiegodelasCasas,EmmaBouHanna,FlorianBressand,
GiannaLengyel,GuillaumeBour,GuillaumeLample,Le´lioRenardLavaud,LucileSaulnier,
Marie-AnneLachaux,PierreStock,SandeepSubramanian,SophiaYang,SzymonAntoniak,
Teven Le Scao, The´ophile Gervet, Thibaut Lavril, Thomas Wang, Timothe´e Lacroix, and
WilliamElSayed. Mixtralofexperts,2024.
[35] XuezhiWang, JasonWei, DaleSchuurmans, QuocLe, EdChi, SharanNarang, Aakanksha
Chowdhery,andDennyZhou.Self-consistencyimproveschainofthoughtreasoninginlanguage
models,2023.
[36] Yao Fu, Hao Peng, Ashish Sabharwal, Peter Clark, and Tushar Khot. Complexity-based
promptingformulti-stepreasoning,2023.
[37] ZifanXu,HaozhuWang,DmitriyBespalov,PeterStone,andYanjunQi. Latentskilldiscovery
forchain-of-thoughtreasoning,2023.
[38] Shen-Yun Miao, Chao-Chun Liang, and Keh-Yih Su. A diverse corpus for evaluating and
developingenglishmathwordproblemsolvers,2021.
[39] RikKoncel-Kedziorski,SubhroRoy,AidaAmini,NateKushman,andHannanehHajishirzi.
MAWPS:Amathwordproblemrepository. InKevinKnight,AniNenkova,andOwenRambow,
editors,Proceedingsofthe2016ConferenceoftheNorthAmericanChapteroftheAssociation
forComputationalLinguistics: HumanLanguageTechnologies,pages1152–1157,SanDiego,
California,June2016.AssociationforComputationalLinguistics.
12[40] YifanZhang,JingqinYang,YangYuan,andAndrewChi-ChihYao. Cumulativereasoningwith
largelanguagemodels,2023.
[41] James Zhao, Yuxi Xie, Kenji Kawaguchi, Junxian He, and Michael Xie. Automatic model
selectionwithlargelanguagemodelsforreasoning. InHoudaBouamor,JuanPino,andKalika
Bali,editors,FindingsoftheAssociationforComputationalLinguistics: EMNLP2023,pages
758–783,Singapore,December2023.AssociationforComputationalLinguistics.
[42] ChuanyangZheng,ZhengyingLiu,EnzeXie,ZhenguoLi,andYuLi. Progressive-hintprompt-
ingimprovesreasoninginlargelanguagemodels,2023.
13Dataset Topic Skills
GSM8K - multiplicationandaddition,basicarithmetic,additionandmultiplication,arithmeticoperations,
multiplication,percentagecalculations,subtraction,algebra,subtractionanddivision,mul-
tiplicationanddivision, multiplicationandsubtraction, additionandsubtraction, percent-
agecalculation,additionsubtraction,averagecalculation,subtractionmultiplication,division,
addition,linearequations,algebraicreasoning
Pre-Algebra averagecalculations, ratioandproportion, geometry, basicarithmeticoperations, frac-
tionsanddecimals, probabilityandcombinatorics, multiplicationanddivision, count-
ingandnumbertheory, primenumbertheory, multiplesandzeroproperties, solv-
MATH
inglinearequation,circles,exponentiationrules,perimeterandarea
Algebra combinatorialoperationsandbasicarithmetic, functionskills, calcula-
tionandconversionskills, solvingequations, inequalityskills, graphandgeometryskills,
numbertheoryskills, factoringskills, complexnumberskills, sequenceandseriesskills,
quadraticequationskills, geometricsequenceskills, polynomialskills, ra-
tioandproportionskills, logarithmicandexponentialskills, algebraicmanipulationskills,
distanceandmidpointskills, arithmeticskills, exponentandrootskills, alge-
braicexpressionskills,functioncompositionskills
Inter-Algebra solvinginequalities, understandingandapplicationoffunctions, in-
equalitysolvingandunderstanding, quadraticequationsandsolutions,
calculusoptimizationskills, polynomialskills, understand-
ingandapplyingfloorandceilingfunctions, summationandanalysisofseries,
functioncompositionandtransformation, sequenceandseriesanalysisskills,
solvingsystemofequations, understandingandutilizinginfininteseries, recur-
sivefunctionsandsequences, complexnumbermanipulationandoperations,
understandingellipseproperties, complexnumbersrelatedskills, simpli-
ficationandbasicoperations, graphunderstandingandinterpretation, un-
derstandinglogarithmicpropertiesandsolvingequations, understand-
ingandmanipulationofrationalfunctions, propertiesandapplicationofexponents,
algebraicmanipulationandequations, primenumberrecognitionandproperties, abso-
lutevalueskills
Geometry understandingcirclepropertiesandalgebraicmanipulation, othergeometricskills,
pythagoreanskills,quadrilateralandpolygonskills,trianglegeometryskills,calculusskills,
3dgeometryandvolumecalculationskills, circlegeometryskills, areacalculationskills,
coordinategeometryandtransformationskills,ratioandproportionskills,trigonometryskills,
combinatoricsandprobabilityskills,algebraicskills
NumberTheory baseconversion, primenumbertheory, greatestcommondivisorcalculations, modu-
lararithmetic,solvingequations,numbertheory,factorization,divisionandremainders,expo-
nentiation,sequenceanalysis,arithmeticsequences,basicarithmetic,polynomialoperations,
understandingoffractions,numbermanipulation
Precalculus matrixoperations, geometricseriescomprehension, basictrigonometry, vectoroperations,
coordinatesystems, trigonometriccalculations, complexnumbers, geometricrelations,
calculus, algebraandequations, threedimensionalgeometry, arithmeticoperations,
parametricequations, sequencesseriesandsummation, geometrytriangleproperties,
geometryandspacecalculation, determinantcalculation, geometrytransforms, com-
plexnumberoperations
Probability probabilitycalculationwithreplacement, combinatoricsknowledge, probabil-
itytheoryanddistribution, combinatorialmathematics, countingprincipals, per-
mutationandcombinations, probabilityconceptsandcalculations, calculat-
ingandunderstandingcombinations, numbertheoryandarithmeticoperations, factori-
alsandprimefactorization,understandingandapplyingcombinatoricsconcepts
Table8: Thistablelistsdowntheskillobtainedaftertheskillclusteringphaseforeachdatasetand
correspondingtopics.
Appendix
7 ListofSkills
Inthissection, welistdowntheskillsthatmakeuptheskillexemplarrepositoryforeachofthe
GSM8KandMATHDatasetsaftertheskillclusteringphase.
8 PromptsUsedforSkillLabellingandSkillClustering
ThissectionpresentsthepromptsusedforlabellingtheskillsfromthetrainingsetT andthetest
setE aswellasthepromptusedforclusteringtheskills. Thetrainingsetskilllabellingpromptis
showninFigure2(left),theskillclusteringpromptsisshowninFigure2(middle),andthetestset
skilllabellingpromptisshowninFigure2(right).
9 RelatedWorks: PromptingStrategies
PromptingMethods Promptingmethodshelpenhancethereasoningabilitiesoflanguagemodels.
Chain-of-Thought(CoT)prompting,21,providesin-contextmathquestionstogetherwithsolutions
whichincludedetailedreasoningchains. Program-AidedLanguageModels(PAL),24,instructthe
modeltoproduceacode-basedsolutiontothegivenproblembyprovidingin-contextexamplesthat
alsocontaincode-basedsolutions. Ensemblemethods,basedonCoTandPAL[35,42],incorporate
14InputPrompt:
Considerthismathematicalquestion.La-
InputPrompt:
belthisquestionwithamathematicalskill
Hereisalistofskillsrequiredtosolvea InputPrompt:
thatwouldberequiredtosolvetheques-
mathematicalquestion: Hereisalistofskillsrequiredtosolvea
tion.Basically,youshouldbeabletouse
mathematicalquestion:
theskillasadictionarykeyinpython.The
skillnameshouldbelowercaseletters [averagecalculation, propor-
only.Theskillnameshouldbeveryde- tioncalculation, percentages, or- [s0,s1,s2,....,sn]
scriptiveandyoumayusemultiplewords derofoperations,subtraction,addition,
todescribetheskillsrequiredintheques- multiplication,additionoffractions,per-
tion. Ifyoudousemultiplewordsper mutationscombinations,counting, un- Herearesomeexamplesofquestionsthat
question,thenjointhembyanunderscore derstandingfractionsandinequalities] demonstratehowtheseskillsareapplica-
. ble:
Reducethenumberofuniqueskillsby
question: Aprintingpressisprinting groupingsimilarskillsintocategoriesand question:<question0>skill:s0
brochures. Thepressprints20single- giveadescriptivenametoeachcategory. question:<question1>skill:s1
pagespreads,andtwiceasmanydouble- question:<question2>skill:s2
pagespreads. Foreach4pagesprinted .
forthespreads,thepressprintsablockof GPT4Response: .
4ads,eachofwhichtakeupaquarterof 1.basicarithmeticoperations:addition, .
apage.Thebrochurescanbearrangedin subtraction,multiplication question:<questionn>skill:sn
anyorderaslongastheyaremadeupof
5pageseach.Howmanybrochuresisthe
printingpresscreating? 2.fractionsandpercentages: ad- Labelthenewquestionwithoneskill
ditionoffractions, understand- fromthelist.
ingfractionandinqualities,percentages
Youranswershouldbeasfollows:
<nameoftheskill>,reason:<reason question:<question>
fortheskill> 3. averageandproportion: aver-
agecalculation,proportioncalculation
Youranswershouldbeasfollows:
GPT4Response: <nameoftheskill>,reason:<reason
multistepproblemsolving 4. orderofoperations: or- fortheskill>
reason:Theprobleminvolvesmanysteps derofoperations
-firstfindingthetotalnumberofpages GPT4Response:
printed,thenhowmanyofthosepagesare 5:combinatoricsandcounting:counting, si,reason:<reason>
adsorspreads,andfinallydetermining permutationscombinations
howmany5-pagebrochurescanbemade
fromthetotal.
Figure2: PromptsforSkillLabellingandClustering(left)Thepromptwhichisusedforlabelling
all examples in the training set T with skills. (middle) The prompt used for clustering the skills
obtainedafterskilllabelling. (right)Thepromptusedtolabeleachtestsetexamplewithskills.
self-consistency,wherethemostfrequentanswerischosen[35],andprogressive-hint-prompting,
whichutilizesafeedback-basedstrategyforrefiningresponses[42]. Notably,allthesemethodologies
employafixedsetofin-contextexamples.Astrategyforselectingin-contextexampleswasintroduced
inComplexCoT[36], whichprefersin-contextexamplesofhighercomplexity, i.e., lengthofthe
reasoningchains. Ourapproachproposedalsoprovidesdynamicallyselectedin-contextexamples
sourcedfromtheSkillExemplarRepository. Inourcase,examplesareselectedbasedonrelevance
rather than complexity. The proposed approach can seamlessly integrate with any of the above
promptingmethods.
10 ExperimentalDetails
10.1 DescriptionofDatasets
• GSM8KDataset[33]-Thisdatasetconsistsof7.3kmathwordproblemsinthetrainingset
and1.3kmathwordproblemsinthetestset.
• SVAMP Dataset [15] - This dataset consists of 1k grade 4 and lower level math word
problemsbuttheyintroducecertainvariationsineachproblemmakingitmorechallenging
forLLMstosolve.
• ASDIVDataset[38]-Thisisadatasetconsisting2.3kgradelevelmathwordproblems. It
containsalotofdiversityintermsoflanguagepatternsandtypesofproblemsconsidered.
• SingleEQDataset[39]-Thisdatasetconsistsof509singleequationwordproblems.
• SingleOPDataset[39]-Thisdatasetconsistsof562singleoperationmathwordproblems.
• AddSubDataset[39]-Thisdatasetconsistsof295additionandsubtractionwordproblems.
• MultiArithDataset[39]-Thisdatasetconsistsof600multi-steparithmeticproblems.
15Skills Questions Answers
proportionalreasoning Wengearns12anhourforbabysitting.Yesterday,shejust Wengearns12/60=12/60=0.2perminute. Working50
did50minutesofbabysitting.Howmuchdidsheearn? minutes,sheearned0.2x50=0.2*50=10.
percentagecalculations Markhasagardenwithflowers.Heplantedplantsofthree Thereare80/100*10=80/100*10=8morepurpleflowers
differentcolorsinit.Tenofthemareyellow,andthereare thanyellowflowers.SoinMark’sgarden,thereare10+8
80%moreofthoseinpurple.Thereareonly25%asmany =10+8=18purpleflowers.Purpleandyellowflowerssum
greenflowersasthereareyellowandpurpleflowers.How upto10+18=10+18=28flowers.ThatmeansinMark’s
manyflowersdoesMarkhaveinhisgarden? gardenthereare25/100*28=25/100*28=7greenflowers.
SointotalMarkhas28+7=28+7=35plantsinhisgarden.
fractioncalculation Lisa,Jack,andTommyearned$60fromwashingcarsall Lisaearned$60*1/2=$60*1/2=30.Tommyearned$30*
week.However,halfofthe$60wasearnedbyLisa.Tommy 1/2=$30*1/2=15.Lisaearned$30-$15=$30-15=15more
earnedhalfofwhatLisaearned.Howmuchmoremoney thanTommy.
didLisaearnthanTommy?
volumecalculation Nancyisfillinganaquariumforherfish.Shefillsithalfway Firstcalculatethevolumeoftheaquariumbymultiplyingits
andgoestoanswerthedoor. Whileshe’sgone,hercat length,widthandheight:4ft*6ft*3ft=4*6*3=72cubic
knockstheaquariumoverandspillshalfthewaterinit. ftThenfigureoutwhatproportionoftheaquariumisfull
ThenNancycomesbackandtriplestheamountofwaterin afterthecatknocksitover:1/2*1/2=1/4Thenfigureout
theaquarium.Iftheaquariumis4feetlong,6feetwide, whatproportionoftheaquariumisfullafterNancyrefillsit:
and3feethigh,howmanycubicfeetofwaterareinthe 3*1/4=3/4Nowmultiplytheproportionoftheaquarium
aquarium? that’sfullbytheaquarium’svolumetofindouthowmuch
waterisinit:72cubicft*3/4=72*3/4=54cubicft
Table 9: This dataset shows examples from the skill exemplar repository constructed using the
GSM8Ktrainingdataset.
Question In-ContextQ1 In-ContextQ2 In-ContextQ3
Computesin210◦ Computesin510◦. Computetan(−3645◦). FindtanY intherighttriangleshown
below.[asy] pair X,Y,Z; X = (0,0); Y
= (24,0); Z = (0,7); draw(X–Y–Z–
X); draw(rightanglemark(Y,X,Z,23));
label(”X”,X,SW); label(”Y”,Y,SE);
label(”Z”,Z,N);label(”25”,(Y+Z)/2,NE);
label(”24”,Y/2,S);[/asy]
Find√3−25
From the following infinite list
ofRewrite√326·33·113asaninteger. Evaluate√⌈√ 5⌉+⌈√ 6⌉+⌈√
7⌉+
n √2um 4b 0e 9r 6s, ,√3ho 4w 096m ,a √n 4y 40a 9r 6e ,√i 5nt 4eg 0e 9rs 6? ,√64096,... x·· ,· ⌈x+ ⌉⌈ den2 o9 te⌉ sN tho ete s: mF ao llr ea str ie na tl egn eu rm tb he ar
t
isgreaterthanorequaltox.
Table10: Thistableshowsthein-contextexamplesobtainedfromtheskill-exemplarrepositorybased
onskill-matching. Wecanseethattheproposedapproachprovidesrelevantin-contextexamplesthat
illustratetheconceptsrequiredbythequestion.
• MATHDataset[16]-Thisdatasetconsistsof7.5ktrainingand5ktestcompetition-level
math problems. They cover the following mathematical topics - Pre-Algebra, Algebra,
IntermediateAlgebra,Pre-Calculus,Geometry,NumberTheory,andProbability.
10.2 GradeLevelMathWordProblems
WepresentexamplesfromtheGSM8KskillexemplarrepositoryinTable9.
SkillWiseAccuracy Westudyforwhichskillstheproposedapproachismostbeneficialinby
comparingtheper-skillaccuracyoftheproposedSkill-BasedapproachagainsttheRandombaseline.
ThiscomparisonispresentedinFigure3. Wecanseethattheproposedapproachoutperformsthe
RandomBaselinein11/18skills.
10.3 MATHDataset: CompetitionLevelMathProblems
WepresentexamplefromtheMATHskillexemplarrepositoryinTables14and15.
Numberofskillobtained Aftertheskilllabellingphase,weendupwith823skillsforprealgebra,
877foralgebra,805forintermediatealgebra,620forgeometry,492fornumbertheory,525forpre
calculus,and406forprobability. Afterclustering,weendupwith14skillsforprealgebra,21for
algebra,23forintermediatealgebra,14forgeometry,15fornumbertheory,19forprecalculus,and
11forprobability. Tables14and15showexamplesfromtheskillexemplarrepositoryforthemath
dataset.
Examplesofrelevantin-contextexamples InTable10,wepresentexamplesofrelevantin-context
examplesprovidedbytheskillexemplarrepository.
16basic_arithmetic
percentage_calculations
multiplication_and_addition
arithmetic_operations
algebra
addition
multiplication
subtraction
algebraic_reasoning
average_calculation
subtraction_and_addition
multiplication_and_division
division
multiplication_and_subtraction
subtraction_multiplication
subtraction_and_division
subtraction_and_multiplication
Prompting Method
percentage_calculation S Rk ai nll d-B omased
0.70 0.75 0.80 0.85 0.90 0.95 1.00
Accuracy
Figure3: SkillWisePlotInthisFigurewecomparethetheper-skillaccuraciesfortheSkill-Based
approachandtheRandomapproachontheGSM8Kdataset. WecanseethatproposedSkill-Based
approachresultsinbetteraccuraciesfor11/18skills.
10.4 ComparingSkillAnnotationModels
In this section, we compare GPT-4, GPT-3.5, and Mixtral-8x7B as skill annotators for labelling
questionswithskillsandclusteringskills. Forskilllabelingandclusteringwefeedthepromptslisted
inFigure2toallthemodels. WealsotestedLlama-270Bforskillannotationbutwefoundthatitwas
notabletoprovideasensibleskillnameforanyexample. Itstrugglestounderstandtheinstruction
giveninthepromptinFigure2(left). Therefore,wediscardeditastheskillannotationmodel.
Next, we found that Mixtral-8x7B, GPT-3.5, and GPT-4 are able to label question with skills as
expectedbutGPT-4wasmoredescriptiveandinsomecasesmoreaccurateaswellasshowninTable
11.
Next,weperformedskillclusteringwithalltheabove3modelsandfoundthatwhileGPT-4and
GPT-3.5succeedatclustering,Mixtralfailstoperformsensibleclustering. Itputsallskillsinone
cluser.
Therefore, we are left withGPT-4 and GPT-3.5for skill-labeling andskill-clustering. We create
twodifferentskillexemplarrepositoriesforGPT-4andGPT-3.5respectively. Wecomparethese
skill-exemplarrepositoriesbyusingthemtoproviderelevantin-contextexamplestosolvequestions
fromtheMATHdataset. TheresultsforthiscomparisonarepresentedinTable12. Thesuperior
17
emaN
llikSQuestion Mixtral-8x7Bskill GPT-3.5skill GPT-4skill
Therearepositiveintegersthathavetheseproperties:I.Theorderofoperations numbertheory combinatoricsandnumbertheory
sumofthesquaresoftheirdigitsis
andII.Eachdigitislargerthantheoneonitsleft. What
istheproductofthedigitsofthelargestintegerwithboth
properties?
ASenatecommitteehas5Democratsand5Republicans.In combinatorics countingandprobabilitycircularpermutationcombinatorics
howmanywayscantheysitaroundacirculartableifeach
membersitsnexttotwomembersoftheotherparty?
Howmanydifferentpositiveintegerscanberepresented counting countingandprobability countingandsubtraction
as a difference of two distinct members of the set
{1,2,3,4,...,16}?
Table11: SkillLabelsAssignedbyMixtral-8x7B,GPT-3.5,andGPT-4
performance with GPT-4 skills indicates that GPT-4 succeeds at providing higher quality skill
annotationsascomparedtoGPT-3.5.
Topic Pre-AlgebraGeometryInter-AlgebraAlgebraProbabilityPre-CalculusNum.TheoryOverall
CoT+Skill-Based(GPT3.5skills) 74.85 40.70 25.51 69.41 55.06 33.69 46.29 51.9
CoT+Skill-Based(GPT-4Skills) 74.28 41.75 27.02 73.12 58.01 33.70 51.10 53.8
Table12: Inthistable,wecomparetheskillexemplarrepositoriescreatedusingGPT-3.5andGPT-4
ontheMATHdataset. ThehigherperformancewithGPT-4skillsillustratesitssuperiorityastheskill
annotationmodel.
10.5 ProgramAssistedLanguageModels
Inthissection,wefirstpresentthepromptformatusedinPAL[24]:
<question 1> <code solution 1>
<question 2> <code solution 2>
<question 3> <code solution 3>
<question 4> <code solution 4>
<Q>...
Next,weshowhowwemodifythispromptformattoincorporateskillsexemplarsfromtheSkill
ExemplarRepository:
<question 1> <text solution 1>
<question 2> <text solution 2>
<question 3> <text solution 3>
<question 4> <code solution 4>
<Q>...
Here, <question 1> <text solution 1> <question 2> <text solution 2>
<question 3> <text solution 3>areexemplarsfromskillexemplarrepositoryexhibiting
thesameskillas<Q>.
10.6 ExampleswheretheModelmakesMistakesdespiteReceivingSkillExemplars
In Table 13 we present examples where the model makes mistakes despite receiving in-context
examples with the same skill as the question it needs to answer. The discussion regarding each
exampleispresentedinthemainpaper.
10.7 PromptingGPT4toclassifyerrors
ThepromptwhichisgiventoGPT4tocategorizeexamplesintoSKILLERROR,SECONDARYSKILL
ERROR,andCALCULATIONERRORisshowninFigure5.
10.8 PerformanceonAblationMetrics
Wepresenttheperformanceonallthe3newlyintroducedmetricsinFigure4.Weexpecttheproposed
Skill-BasedapproachtobethemostbeneficialinreducingSKILLERRORS. Thisisbecausethethe
18Example1 Example2
Question
Evaluatelog√35125. H cao nw bm eda rn ay wd nis ?tinctdiagonalsofaconvexhexagon
wTh he atex pp or we ess rio mn ul so tg w√3
e5
ra1 i2 se5a
√
3sk 5s tt ohe oq bu tae is ntio 1n 25” ?t ”o
.
A froh mex aag vo ern teh xas to6 av ne yrt oic the es. rA verd ti ea xgo exn ca el pc tan fob re thd era tw won
Topic-BasedSolution Since51 3 = 5,then53x = 125. Recallthat a dd raja wce 3n dt iav ge ort nic ae lss .. TS ho er, ef fr oo rm e,fe oa rc 6h vv ee rr tt ie cx es, ,w we ec ca an n
53 =125.Therefore125isactually53.Hence draw6×3=18diagonals.Wedividethisby2
thelog√35125=3. togetthenumberofdistinctdiagonals.Therefore,
aconvexhexagonhas9distinctdiagonals.
Weknowthatlog b=cmeansac=b.Sowe Aconvexhexagonhas6vertices. Fromeachver-
a
needtofindanumberwhich,whencubed,givesus tex,wecanpotentiallydrawadiagonalto4other
Skill-BasedSolution 125.Weknowthat53=125,soouransweris3. vertices.So,eachvertexgivesus4diagonals,fora
SkillUsed:logarithmicandexponentialskills preliminarycountof6×4=24diagonals.We
mustdivideby2togetthenumberofuniquediago-
nals.Theansweris(6×4)/2=12diagonals.
SkillUsed:countingandnumbertheory
Table13: Incorrectlyansweredexamplesdespiteprovidingskill-basedexemplarsThistable
highlightssituationswherethemodelencountersreasoningerrorsdespitebeingsuppliedwithrelevant
skill-basedexemplarstoaddresstheproblem. Correctreasoningstepsaredenotedinblue,while
errorsarehighlightedinred.
proposedapproachshouldprovidethosein-contextexamplestothemodelwhichhavethesamemain
skillastheprobleminquestion. TheperformanceontheSKILL SUCCESS RATEmetricisin-line
withthishypothesis. WeobservethattheproposedapproachresultsinahigherSKILL SUCCESS
RATEwhichmeansthatthemodelisusingthecorrectskillmorefrequentlyintheproposedapproach
ascomparedtotheTopic-Basedbaseline. Furthermore,wefindthattheproposedapproachisalso
quiteeffectiveinreducingsecondaryskillerrorsandcalculationerrors. Thus,showingtheoverall
superiorityoftheproposedapproach.
19Topic Skill Question Answer
primenumbertheory WhatisthesumofthedistinctprimefactorsofThedistinctprimefactorsof315are3,5,and7,
315? andtheirsumis15.
exponentiationrules Find(44÷43)·28. Performingthearithmeticintheparenthesesfirst,
weobtain44÷43=4,sowehave(44÷
Pre-Algebra 43)·28=4·28.Since4=22,wehave
4·28=22·28=210= 1024 .
ratioandproportion TheratioofirisestorosesinNikki’sgardenisAfteradding20roses,Nikkiwillhave25+
2:5.Shecurrentlyhas25roses.Sheisplanning20 = 45roses. Ifshewillhave2irisesfor
toadd20morerosesandenoughirisestokeepevery5roses,thenshewillhave2(9)= 18
thesameratio.Howmanyiriseswillshehaveirises.
intotalafterthisaddition?
factoringskills Factor9y2−30y+25. Thequadraticisthesquareof3y,theconstant
termisthesquareof−5,andthelinearterm
equals2(3y)(−5),sowehave9y2−30y+
25= (3y−5)2 .
Algebra complexnumberskills Simplify(3−2i)2.(Youranswershouldbe(3−2i)2=(3−2i)(3−2i)=3(3)+
oftheforma+bi.) 3(−2i)−2i(3)−2i(−2i)=9−6i−
6i−4= 5−12i .
quadraticequationskills WhatisthesumofthevaluesofxthatsatisfySubtracting9frombothsidesoftheequation,
theequationx2−5x+5=9? wehavex2−5x−4 = 0. Thesumof
therootsofthisquadraticisnegativeitslinear
coefficient,whichis 5 . (Theaboveistrue
becauseifaquadratichasrootsrands,wehave
(x−r)(x−s)=x2−(r+s)+rs=0.)
polynomialskills Findtheproductofthenonrealrootsofx4−We recognize part of the expansion of
4x3+6x2−4x=2005. (x − 1)4 on the left-hand side. Adding
1 to both sides, we have x4 − 4x3 +
6x2 − 4x + 1 = 2006,whichmeans
(x−1)4 = 2006.Therefore,x−1 =
√42006,i√42006,−√42006,−i√42006.
Sincewewantthenonrealroots,weonlycon-
sidertheroots
x=1±i√42006.
IntermediateAlgebra
The product of these roots is P =
(1 +
i√42006)(1
−
i√42006)
=
√
1+ 2006 .
simplifyingandbasicoperations (cid:16)Le 1t −1(cid:17)(cid:16) 1P −1(cid:17)(cid:16) 1−1(cid:17) ···(cid:16) 1−= 1S(cid:17)im .plifyingeachterminP,
Whatis2 thevalueof3 Pifn=4 2007?Expressn
P
=(cid:18)1(cid:19)(cid:18)2(cid:19)(cid:18)3(cid:19) ···(cid:18)n−1(cid:19)
.
youranswerasacommonfraction. 2 3 4 n
Thedenominatorofeachfractioncancelswith
thenumeratorofthenextfraction,soP = 1.
n
1
Whenn=2007,P = .
2007
√
graphunderstandingandinterpretation FindthedistancebetweentheverticesoftheW√ereadthata2 = 99,soa = 99 =
hyperbolax2 −y2 =1. 3 11.Therefore,thedistancebetweenthever-
99 36 √
ticesis2a= 6 11 .
pythagoreanskills InrighttriangleABC,AB=10,AC=6Thelengthofthemediantothehypotenuse
andBC=8units.Whatisthedistancefromofarighttriangleishalfthelengthofthehy-
CtothemidpointofsegmentAB? potenuse. Therefore,thedesireddistanceis
10/2= 5 .
3dgeometryandvolumecalculationskillsTheareaofonelateralfaceofarightpyramidLetsrepresentthesidelengthoftheequilateral
withanequilateraltriangularbaseis75squaretriangularbase.Eachfaceofthepyramidhasan
Geometry meters.Iftheslantheightis30meters,whatisareaof1 2bh=75,wherebisthesidelength
thelengthofthesideofitsbase,inmeters? ofthebaseandhistheslantheightof30meters.
Wehave
1
75= s(30)=15s.
2
So,s=5andthesidelengthofthebaseis 5
meters.
trianglegeometryskills IntriangleABC,AB = 16,AC = 24,The ratio of the area of triangle ABD to
BC=19,andADisananglebisector.FindtheareaoftriangleACDisBD/CD. By
theratiooftheareaoftriangleABDtothethe angle bisector theorem, BD/CD =
areaoftriangleACD.(Expressyouranswer 2
asafractioninlowestterms.) AB/AC=16/24= .
3
Table14: MathskillexemplarrepositoryThistablepresentsfewexamplesfromtheskillexemplar
repositoryfor5topicsfromtheMATHdataset[16].
20Topic Skill Question Answer
calculus Iftanα = 8andtanβ = 7,thenfindFromtheanglesubtractionformula,tan(α−
tan(α−β). β) = tanα−tanβ = 8−7 =
1+tanαtanβ 1+8·7
1
.
57
(cid:32)1(cid:33) (cid:32)−2(cid:33) (cid:32)1(cid:33) (cid:32)−2(cid:33)
vectoroperations Findysothatthevectors −3 and y Forthevectors −3 and y tobeor-
−4 −1 −4 −1
Precalculus
areorthogonal. thogonal,theirdotproductshouldbe0:
(1)(−2)+(−3)(y)+(−4)(−1)=0.
2
Solving,wefindy= .
3
trignometriccalculations Converte11πi/2torectangularform. We have that e11πi/2 = cos11π +
2
isin11π = −i .
2
factorization Findtheproductofthedivisorsof50. Foreverydivisordof50,then50/disalsoa
divisorof50.Theirproductisd·(50/d)=
50.Itfollowsthateverydivisorcanbepaired
withanotherdivisorof50suchthattheirproduct
is50=2·52.Thereare(1+1)(2+1)=6
divisorsof50:1,2,5,10,25,50.Thus,the
answeris506/2=503= 125,000 .
divisionandremainders Awholenumberissaidtobe”9-heavy”iftheWebeginbycomputingtheresidueofthesmall-
remainderwhenthenumberisdividedby9isestthreedigitnumbermodulo9.Wehave
greaterthan5.Whatistheleastthree-digit9-
NumberTheory heavywholenumber? 100≡1 (mod9).
Therefore100isnot9-heavy.Countingupfrom
100wenoticethatthefirst9-heavythree-digit
numberis 105 ,sinceithasaremainderof6
whendividedby9.
exponentiation CallanintegernoddlypowerfulifthereexistLetusfirstdeterminethenumberofcubesthat
positiveintegersaandb,whereb>1,bisarelessthan2010. Wehave103 = 1000,
odd,andab=n.Howmanyoddlypowerful113 = 1331, and123 = 1728, but
integersarelessthan2010? 133 = 2197. Sothereare12cubesless
than2010.Asforfifthpowers,45=1024,
but55=3125.Thereare4fifthpowersless
than2010,butonly3ofthesehavenotalready
beenincluded,sincewe’vealreadycounted1.
Analyzingseventhpowers,37=2187,sothe
onlynewseventhpowerlessthan2010is27.
Therearenonewninthpowerssincetheyareall
cubes,and211=2048isgreaterthan2010.
Therefore,thereare12+3+1= 16 oddly
powerfulintegerslessthan2010.
combinatoricsknowledge
Alexhas10differentkindsoflunchmeatand9Thereare(cid:16)10(cid:17)
=10waysforAlextochoose
1
differentkindsofcheese.Ifhewantstomakeawhichkindoflunchmeattoputonhissand-
s oa fn cd hw eei sc eh ,w hoi wth mon ae nyki dn id ffeo rf enm te sa at na dn wd ict hw eo sk coin ud lds wich,andthereare(cid:16)9 2(cid:17)
=36waysforAlex
hemake?(Itdoesnotmatterinwhichorderhetochoosewhichkindsofcheesetoputonhis
choosesthetwotypesofcheese.) sandwich.Thetotalnumberofdifferentsand-
wichesAlexcanmakeis10·36= 360 .
permutationsandcombinationsAbagcontains10redmarblesand6bluemar-Therearethreewaystodrawtwobluemarbles
Probability bles.Threemarblesareselectedatrandomandandaredone:RBB,BRB,andBBR.Sincethere
withoutreplacement. Whatistheprobabilityarenooverlappingoutcomes,thesearedistinct
thatonemarbleisredandtwoareblue?Expresscasesandtheirsumisthetotalprobabilitythat
youranswerasacommonfraction. twoofthethreedrawnwillbeblue.Thedesired
probabilitythereforeis
10 6 5 6 10 5 6 5 10 15
· · + · · + · · = .
16 15 14 16 15 14 16 15 14 56
countingprincpals Howmanythreedigitnumbersarethere? Thethree-digitnumbersstartwith100andend
with999.Thereare999−100+1= 900
three-digitnumbers.
Table15: Mathskillexemplarrepository(Continued)Thistablepresentsfewexamplesfromthe
skillexemplarrepositoryfor5topicsfromtheMATHdataset[16].
21Prompting Method
Skill-Based Topic-Based
0.8
0.6
0.4
0.2
0.0 AlgebraPrecalculuGseometrPyrealgebPrarobabNiluitmyb Ienrt eTrhmeo erdy iate Algebra
Topic
(a) SkillSuccessRate
Prompting Method Prompting Method
Skill-Based Topic-Based Skill-Based Topic-Based
0.7
0.8
0.6
0.6 0.5
0.4
0.4 0.3
0.2
0.2
0.1
0.0 AlgebraPrecalculuGseometrPyrealgebPrarobabNiluitmyb Ienrt eTrhmeo erdy iate Algebra 0.0 AlgebraPrecalculuGseometrPyrealgebPrarobabNiluitmyb Ienrt eTrhmeo erdy iate Algebra
Topic Topic
(b) SecondaryConceptSuccess (c) CalculationSuccessRate
Rate
Figure4: AblationMetricsThisFigurecomparestheSKILLSUCCESSRATE,SECONDARYSKILL
SUCCESSRATE,andCALCULATIONSUCCESSRATEoftheTopic-BasedandSkill-Basedapproaches.
Weexpecttheproposedskill-basedapproachtobemainlyusefulinpickingthecorrectskills. Wefind
thatthisisindeedthecaseasitachievesahigherskillsuccessratethantheTopic-Basedapproach.
Moreover,wefindthatproposedapproachalsoresultsinlowercalculationandsecondaryskillerrors.
22
etaR
sseccuS
llikS
yradnoceS
etaR
sseccuS
llikS
etaR
sseccuS
noitaluclaCYouareamathwizardwhoknowsexactlywhatmathematicalconcepttousetosolveanymathquestion.
Iamgoingtogiveyouamathquestionandasolutionandthegroundtruthanswerforthatquestion.YouneedtoanswersomequestionsthatIaskyouaboutit.
Hereareexamplesofquestionsandthecorrespondinganswers:
Question:Wecallanumberadescendingnumberifeachdigitisstrictlysmallerthanthedigitthatcomesbeforeit.Forexample,863isadescendingnumber.
Howmany3-digitdescendingnumbersarethere?
Solution:Since0cannotbetheleadingdigitofthenumber,thereare9optionsforthefirstdigit(1-9).Oncethefirstdigitischosen,thereare10optionsfor
theseconddigit(0plusthedigitslessthanthefirstdigit).Boththesecondandfirstdigitsaredetermined,thisleaves9optionsforthethirddigit(0and1-9,
excludingtheseconddigit).Hence,thereare9∗10∗9=810possible3-digitnumbers.However,thiscountincludesnumberssuchas100,200,etc–where
thethirddigitisnotstrictlylessthantheseconddigit.Thereareexactly9suchnumbers.Soourfinalansweris810−9= 801 descendingnumbers.
Groundtruth:120
Q1:Arethereanycalculationmistakesinthesolution?
Q2:Arethereanymistakesinthemainconceptrequiredtosolvethequestion?
Q3:Arethereanymistakesinanyofthesecondaryconceptsrequiredtosolvethequestion?
A1:no——Therearetwocalculationsinthequestion:9*10*9=810and810-9=801.Botharecorrect.
A2:yes——Themainconceptisunderstandingofdescendingnumbers,butthisunderstandingisnotcorrect.
A3:no——Thesecondaryconceptofpermutationsiscorrectlyused.
Question:HowmanyprimesareintherowofPascal’sTrianglethatstartswitha1followedbya6?
Solution:TherowofPascal’sTrianglethatstartswitha1followedbya6isthesixthrow,whichiscomposedofthenumbers1,6,15,20,15,6,1.The
onlyprimenumberinthisrowis { 2},whichisthenumber2itself.
Groundtruth:0
Q1:Arethereanycalculationmistakesinthesolution?
Q2:Arethereanymistakesinthemainconceptrequiredtosolvethequestion?
Q3:Arethereanymistakesinanyofthesecondaryconceptsrequiredtosolvethequestion?
A1:no——Therearenocalculationsinthesolution.
A2:yes——Themainconceptisunderstandingofprimes,butthisunderstandingisnotcorrect.
A3:no——ThesecondaryconceptofPascal’sTriangleiscorrectlyused.
Question:Twodifferentnumbersarerandomlyselectedfromtheset{1,2,3,4}andtheyaremultiplied.Whatistheprobabilitythattheproductiseven?
Expressyouranswerasacommonfraction.
Solution:Thereareatotalof(cid:16)4(cid:17)
=6pairsofnumbersthatcanbechosen.Thepairsthatyieldanevenproductare(1,2),(2,3),(2,4),(1,4),and(3,4)fora
2
totalof5suchpairs.Therefore,theprobabilityis5.However,eachpaircanbeorderedintwoways(forexample,(1,2)and(2,1)aredifferentorderingsofthe
6
samepair).Soweshouldactuallyconsiderthatthereare2*6=12totaloutcomesand2*5=10successfuloutcomes.Thereforetheprobabilityis{0}{12}=
1
5
.
6
Groundtruth:5/6
Q1:Arethereanycalculationmistakesinthesolution?
Q2:Arethereanymistakesinthemainconceptrequiredtosolvethequestion?
Q3:Arethereanymistakesinanyofthesecondaryconceptsrequiredtosolvethequestion?
A1:no——Therearetwocalculationsinthequestion:5/6and10/12.Botharecorrect.
A2:no——Themainconceptisunderstandingofprobability,andthisunderstandingiscorrect.
A3:no——Thesecondaryconceptofcombinationsiscorrectlyused.
Question:Theasymptotesofahyperbolaarey=2x−3andy=17−2x.Also,thehyperbolapassesthroughthepoint(4,7).Findthedistance
betweenthefociofthehyperbola.
Solution:Thetwolinesy=2x−3andy=17−2xintersectatthepoint(cid:16)20,14(cid:17)
=(5,3.5),whichisthecenterofthehyperbola.Theslopesof
4 4
theasymptotesareequalto±b,whereaandbarethesemi-majorandsemi-minoraxesofthehyperbola,respectively.Therefore, b =2,sob=2a.The
a a
hyperbolapassesthroughthepoint(4,7),sothedistancefromthispointtothecenterofthehyperbolais(cid:112)(4−5)2+(7−3.5)2=a(cid:112) 1+22=
a√ 5.Thus,a=1.5.Thenb=2a=3,sothedistancebetweenthefociis2(cid:112) a2+b2=2(cid:112)(1.5)2+32= 6 .
Groundtruth:2
sqrt{5}
Q1:Arethereanycalculationmistakesinthesolution?
Q2:Arethereanymistakesinthemainconceptrequiredtosolvethequestion?
Q3:Arethereanymistakesinanyofthesecondaryconceptsrequiredtosolvethequestion? A1:no——Therearetwocalculationsinthequestion:
2∗sqrt(1.52+32)andsqrt(1+22).Botharecorrect.
A2:no——Thesolutionusesthecorrectconceptoffindingtheintersectionoftheasymptotestodeterminethecenterofthehyperbola,andcorrectlyidentifies
theslopesoftheasymptotesas±{}{a}.
A3:yes——Thesolutionincorrecb tlyequatesthedistancefromthecenterofthehyperbolatothepointitpassesthroughwitha(cid:112) 1+22=a√
5.Thisis
incorrectbecauseforahyperbola,thedistancefromthecentertoapointonthehyperbolaisnotrelatedtothesemi-majorandsemi-minoraxesinthisway.
Question:<question>
Solution:<solution>
Groundtruth:<groundtruth>
Q1:Arethereanycalculationmistakesinthesolution?
Q2:Arethereanymistakesinthemainconceptrequiredtosolvethequestion?
Q3:Arethereanymistakesinanyofthesecondaryconceptsrequiredtosolvethequestion?
YoushouldanswerQ1,Q2,andQ3basedonthegivenexamples.
Figure5: AblationPromptThisfigureshowsthepromptwhichisgiventoGPT4tocategorizeeach
examplefromtheMATHdatasetintoSKILLERROR,SECONDARYSKILLERROR,orCALCULATION
ERROR
23
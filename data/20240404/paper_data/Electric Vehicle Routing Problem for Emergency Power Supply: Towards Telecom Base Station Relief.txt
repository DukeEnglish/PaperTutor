Electric Vehicle Routing Problem for Emergency Power Supply:
Towards Telecom Base Station Relief∗
DaisukeKikuta†,HirokiIkeuchi†,KengoTajiri†,
YutaToyama‡,MasaskiNakamura‡,YuusukeNakano†
†NTTCorporation,‡NTTDOCOMO
{daiuske.kikuta,hiroki.ikeuchi,kengo.tajiri,yuusuke.nakano}@ntt.com
{yuuta.toyhama.zg,masaki.nakamura}@nttdocomo.com
ABSTRACT
Asatelecomprovider,ourcompanyhasacriticalmissiontomain-
taintelecomservicesevenduringpoweroutages.Toaccomplish
themission,itisessentialtomaintainthepowerofthetelecom
basestations.Hereweconsiderasolutionwhereelectricvehicles
(EVs)directlysupplypowertobasestationsbytravelingtotheir
locations.ThegoalistofindEVroutesthatminimizeboththetotal
traveldistanceofallEVsandthenumberofdownedbasestations.
Inthispaper,weformulatethisroutingproblemasanewvariantof
theElectricVehicleRoutingProblem(EVRP)andproposeasolver
thatcombinesarule-basedvehicleselectorandareinforcement
learning(RL)-basednodeselector.Theruleofthevehicleselec-
torensurestheexactenvironmentalstateswhentheselectedEV
startstomove.Inaddition,thenodeselectionbytheRLmodel
enablesfastroutegeneration,whichiscriticalinemergencies.We
evaluateoursolveronbothsyntheticdatasetsandrealdatasets.
Figure1:Anillustrationoftelecombasestationrelief.EVs
Theresultsshowthatoursolveroutperformsbaselinesintermsof
directlysupplypowertobasestationsbytravelingtotheir
theobjectivevalueandcomputationtime.Moreover,weanalyze
locations.EachEVreturnstoachargestationlocatedoutside
thegeneralizationandscalabilityofoursolver,demonstratingthe
theblackoutareabeforetheEVpowerrunsout.
capabilitytowardunseensettingsandlarge-scaleproblems.Check
alsoourprojectpage:https://ntt-dkiku.github.io/rl-evrpeps.
powersourceforauxiliaryservices.Inthecontextofemergency
KEYWORDS
powersupply,EVsaresuperiortoconventionalpower-supplyvehi-
ElectricVehicleRoutingProblem,EmergencyPowerSupply,Deep clesinthefollowing:CompaniescanuseEVsascompanyvehicles
ReinforcementLearning,Multi-AgentSystem innormaltimes,therebyreducingwasteofresources;MoreEVs
canbedispersedoverawiderareabecausethecostperEVisless
1 INTRODUCTION expensive.AlthoughtheamountofelectricitytransportedperEV
inasinglerouteislessthanthatofapower-supplyvehicle,EVs
Asthefrequencyofnaturaldisastersincreases[24],maintaining
aremoresuitableinourproblemsettings,giventheneedtopower
infrastructuresduringadisasterisbecomingmorecritical.Inpartic-
manydispersedbasestationsindividually.
ular,telecomservicesareoneofthemostimportantinfrastructures
Recently,variousapproacheshaveemergedthatapplyvehicle-
tobealwaysmaintainedastheInternetisnowadaysalifelinefor
to-grid(V2G)orvehicle-to-home(V2H)technologiesforemergency
people.Asatelecomprovider,ourgroupcompanyiscommittedto
powersupply[37–39].However,duetoitshighinstallationcost,
initiativestokeepprovidingtelecomservicesevenduringadisaster.
introducingthegridsystemtonumerousexistingbasestationsis
Inthispaper,weintroduceaninitiativetomaintainthepowerof
impracticable.Furthermore,one-to-onedispatchin[37]isineffi-
telecombasestationsduringpoweroutages,whichisoneofthe
cientinthebasestationreliefwherethenumberofEVsissmaller
fundamentaltasksofmaintainingtelecomservicesduringadisaster
thanthenumberofbasestationstoberescued.Hence,apartfrom
withpoweroutages.Eachbasestationpossessesasparebattery
theseexistingapproaches,aroutingapproachwhereEVsmaintain
forshort-timebackup(e.g.,aroundthreehours),butanadditional
thepowerofthebasestationsbygoingaroundtopowerthebase
powersupplyfromsomeexternalsourcesisrequiredtomaintain
stationsdirectlyshouldalsobeconsidered.
thebasestationbatteriesoveralongertime.
Inthispaper,weformulatethisroutingproblemasavariantof
Electricvehicles(EVs)arepromisingcandidatesforthoseexter-
theElectricVehicleRoutingProblem(EVRP)andproposeasolver
nalsources.EVscansupplytheirpowertoobjectsusingvehicle-to-
everything(V2X),1whichhasrecentlygainedattentionasamobile thatcombinesarule-basedvehicleselectorandareinforcement
learning(RL)-basednodeselector.Figure1illustratesourproblem
(wenameitEVRPforEmergencyPowerSupply(EVRP-EPS)).The
∗Preprint.Workinprogress.
1V2Xhererefersto"electricitytransfer"fromEVstoeverything,not"communication". goalistofindEVroutesthatminimizeboththetotaltraveldistance
4202
rpA
3
]CO.htam[
1v84420.4042:viXraTable1:Notation.
Notation Description Unit
𝑁bs,𝑁cs,𝑁,𝑁ev Thenumberofbasestations,chargestations,nodes,andEVs -
𝑁=𝑁bs+𝑁cs
𝑖,𝑗,𝑘,𝑛 Theindicesofbasestations,chargestations,EVs,andnodes -
𝑛=1,...,𝑖,...,𝑁bs,𝑁bs+1,...,𝑁bs+𝑗,...,𝑁
bs𝑖,cs𝑗,ev𝑘 𝑖-thbasestation,𝑗-thchargestation,and𝑘-thEV -
𝑎𝑘 Theindicesofactionstakenbythe𝑘-thEV -
Π𝑘(𝑎𝑘),𝜋𝑘(𝑎𝑘) Therandomvariableandobservedvalueofindicesofnodes -
visitedby𝑘-thEVat𝑎-thaction
𝑡,𝑇 Continuoustimeandtimehorizon h
𝐵(bs𝑖,𝑡) 𝑖-thbasestation’sbatteryatthetime𝑡 kWh
𝐶(bs𝑖) 𝑖-thbasestation’spowerconsumption kWh/h
𝑄(bs𝑖) 𝑖-thbasestation’scapacity kWh
𝐷(cs𝑗) 𝑗-thchargestation’sdischargerate kWh/h
𝐵(ev𝑘,𝑡) 𝑘-thEV’sbatteryatthetime𝑡 kWh
𝐶 𝑄( (e ev v𝑘 𝑘)
)
𝑘𝑘 -- tt hh EE VV’ ’s scd ari pv ai cn ig typowerconsumption kkW Whh/km Figure2:AnillustrationoftheEVactioncycle:move→pre-
𝐷(ev𝑘) 𝑘-thEV’sdischargerate kWh/h pare→(dis-)charge→clean-up→move→···
ofallEVsandthenumberofdownedbasestationsinasituation
whileminimizingthetotaltraveldistanceofallEVs.Formally,the
wherethebasestationbatteriescontinuouslydepleteovertime.
objectivefunctionbelowisminimized.
ComparedtoexistingEVRPs,whichconsiderbatteryconsumption
a dn isd chre ac rh gear og fin Eg Vsof anE dVs s, oE mV eR dP e- tE aP ilS smad ad nit di ao tn oa rl yly inco pn rasi cd te icr es .t Ohe urb sa ott le vr ey
r
∑︁𝐴 ∑︁𝑘−1d(𝒙𝜋𝑘(𝑎𝑘),𝒙𝜋𝑘(𝑎𝑘+1)) +𝛼1 ∫ 𝑇 (cid:205) 𝑖I(𝐵(bs 𝑖,𝑡)=0)
𝑑𝑡,
generatesEVroutesbyalternatelyrepeatingthetwocomponents: 𝑘 𝑎𝑘
𝑁ev 𝑇
𝑡=0
𝑁
bs
(1)
ThevehicleselectorselectstheEVthatcanmakethenextmove
theearliest;Thenodeselectorthendeterminesthenextdestination
where𝐴
𝑘
thenumberof𝑘-thEV’sactions,d(·,·) isthedistance
oftheselectedEVwiththecentralizedstochasticpolicy.Therule between two points, 𝒙𝑛 is the 2d coordinates of the𝑛-th node,
ofthevehicleselectorensurestheexactenvironmentalstateswhen 𝜋 𝑘(𝑎 𝑘) istheindexofnodevisitedby𝑘-thEVat𝑎-thaction,𝛼
theselectedEVstartstomove.Furthermore,theRL-basednode
isthepositiveweightingfactor,andI(·)istheBooleanindicator
function.ThefirstandsecondtermsofEq.(1)correspondtothe
selectionenablesfastroutegeneration,eveninlarge-scaleproblems,
traveldistanceofallEVsandthenumberofdownedbasestations,
whichiscriticalduringemergencies.
respectively.
Weevaluateoursolveronsyntheticandrealdatasetsthatinvolve
actuallocationsandspecificationsofbasestations,chargestations,
2.2 (Sub-)ActionsandActionSpace
andEVs.Theresultsshowthatoursolveroutperformsbaselines
(twonaiveapproachesandaconventionalheuristic)intermsof EVs/driverscyclethroughanaction:moveandthreesubsequent
boththeobjectvalueandcomputationtime.Moreover,weanalyze sub-actions:prepare,(dis-)charge,andclean-up (Figure2).First,
thegeneralizationandscalabilityofoursolver,demonstratingthe eachEVmovestoanode(i.e.,basestation/chargestation).After
capabilitytowardsunseensettingsandlarge-scaleproblems. arriving at the node, it prepares the equipment to (dis-) charge
Contributionsofthispaperareorganizedasfollows. power.Thenit(dis-)chargepoweratabasestation/chargestation.
• Wearethefirsttoformulatebasestationreliefasanew
Lastly,itclean-upstheequipmentandmovestoanothernode,and
soon.EVskeepthiscycleduringagiventimehorizon.
EVRPthatadditionallyconsidersthedischargingofEVs.
Here,theactionspaceissolelyaboutdeterminingwhichnode
• Weproposeasolverthatcombinesarule-basedvehicle
selector,anRL-basednodeselector,andanewobjective
eachEVmovestofromthecurrentnodeinthemovephase.The
sub-actions(i.e.,howlong(much)EVs(dis-)chargepowerandhow
functionthatconsidersbothtraveldistanceandthenumber
longpreparation/cleanuptakes)areincidentallydeterminedbythe
ofdownedbasestations.
environmentstateswhentheEVvisitsthatnodeandconstraints.
• We demonstrate the effectiveness of our solver on real
datasets that involve actual locations and specifications
2.3 BatteryFluctuationModel
ofbase/chargestationsandEVs.
Thebatteryofbasestations/EVslinearlyandcontinuouslychanges
2 PROBLEMSETTING withtime.Let𝜏becontinuouselapsedtime,thebatteryof𝑖-thbase
stationchangesdependingonconditions,asfollows:
Inthissection,wedescribetheEVRP-EPS,includingtheobjective
f su tan tc ioti no sn a, nth de Ea Vc st ,io ann dsp oa thc ee r,t ch oe nsb ta rt at ie nr ty s.fl Ou uc rtu na ot ti ao tn iom no isd oe rl go af nb iza es de
𝐵(bs
𝑖,𝑡+𝜏)=
𝐵(bs 𝑖,𝑡)+(𝐷(ev 𝑘)−𝐶(bs 𝑖))𝜏 i pf oe wv
𝑘
erd ai tsc bh sa 𝑖,rges
inTable1.  𝐵(bs 𝑖,𝑡)−𝐶(bs 𝑖)𝜏 otherwise,

(2)
2.1 ObjectiveFunction
where𝐷(ev 𝑘)−𝐶(bs 𝑖) >0alwaysholds,meaningthattheamount
Givenatimehorizon𝑇 (e.g.,expectedblackoutduration)andaset ofpowersupplyfromanEVtoabasestationalwaysexceedsthe
ofbasestations,chargestations,andEVs,thegoalistomaintain powerconsumptionofthatbasestation.Duringthe𝑘-thEVdis-
asmanybasestationbatteriesaspossibleduringthetimehorizon charges power at the𝑖-th base station, the battery of that baseFigure3:Anoverviewofoursolver.ItfirstselectstheEVthatwillbetheearliestavailableforthenextmove.Then,itdetermines
thenextdestinationoftheselectedEVwithacentralizedstochasticpolicy,whichisparameterizedbyatwo-towerTransformer.
stationincreasesinproportiontotheelapsedtimewiththe𝑘-th ofdischargeisthetimeittakesforthebasestationbatterytobe
EVdischargerateminusthe𝑖-thbasestationpowerconsumption chargedupto𝛾 ∈ [0,1]×100%ofitscapacityiftheEVbatteryis
asacoefficient.Otherwise(i.e.,duringnoEVarrivesatoranEV sufficient.Otherwise,thetimeittakesfortheEVtodischargeuntil
prepares/clean-upsat𝑖-thbasestation),thebatteryofthatbase itsdischargelimitisreached.Asthechargespeeddecreasesafter
stationdecreasesinproportiontotheelapsedtimewiththepower exceeding80%ofthebattery,weusuallyset𝛽and𝛾to0.8.The𝑘-th
consumptionasaconstant. EVdischargelimitat𝑖-thbasestation𝐿𝑖𝑚(ev 𝑘,bs 𝑖)iscalculated
Ontheotherhand,thebatteryof𝑘-thEVchangesasfollows: as,
𝐵(ev
𝑘,𝑡+𝜏)=

𝐵
𝐵
𝐵
𝐵(
(
(
(e
e
e
ev
v
v
v𝑘
𝑘
𝑘
𝑘,
,
,
,𝑡
𝑡
𝑡
𝑡)
)
)
)−
−
+𝐷𝐶 𝐷( ((e cev sv𝑘
𝑗𝑘
))
)
𝜏𝑉 𝜏𝜏 oi
i
if
f
f
the
e
ev
v
v
e𝑘
𝑘
𝑘
rwm
d
c
ihi
sso
a
ecv
r
,he gas
er sg ae ts cp so 𝑗wer
w ityh .e
Ere𝐿 q𝑖 𝜇𝑚
(5∈
)(e e[v n0𝑘 s,, u1b
]
rs e𝑖
i
ss) tt=
hh
aem tda
ti
hx
s
ec(cid:18) h𝜇 Ea𝑄 Vrg( se
e
tv ol𝑘
o
p)
w
s,𝑉
e dr
is·
l
cim
m
h𝑗i ain
t
rgr(cid:16) iad nt(
i
g𝒙 ob pts oo𝑖, wt𝒙
h
ec
e
rs𝑗
E
w) V(cid:17) h(cid:19) ec,
nap
ta( h5
c
e)
-
 (3) dischargelimitisreached,sothatitisabletoreturntoatleastone
where𝑉 istheconstantEVdrivingspeed(km/h).During𝑘-thEV depotwithoutrunningoutofitsbatteryontheway.
moves,itsbatterydecreasesproportionatelytothetraveldistance
𝑉𝜏 with the driving power consumption as a constant. During 2.5 OtherConstraints
𝑘-th EV charges power from 𝑗-th charge station, its battery in-
ThestatesofbasestationsandEVsalwayssatisfythefollowing
creasesproportionatelytotheelapsedtimewiththedischargerate
constraints:
ofthatchargestationasaconstant.Otherwise(i.e.,during𝑘-thEV
prepares/clean-ups),theEVbatterydoesnotchange. 0≤𝐵(bs 𝑖,𝑡) ≤𝑄(bs 𝑖), (6)
2.4 DurationofEV(Sub-)Actions 𝐶(ev 𝑘)·(cid:18) d(𝒙𝑡,𝒙𝑛)+m 𝑗in(cid:16) d(𝒙𝑛,𝒙cs𝑗)(cid:17)(cid:19) ≤𝐵(ev 𝑘,𝑡) ≤𝑄(ev 𝑘),
ThedurationofeachEV(sub-)action𝜏′isdeterministicallycom- (7)
putedasfollows:
Theotherunformulatedconstraintsaresummarizedbelow.
𝜏′
= md 𝛽𝑄(cid:16) i𝒙 n(𝜋 e𝑘 (cid:16)v(
𝛾𝑘
𝐷𝑎 𝑄)) 𝑉 (, −𝒙
c
(𝐵
bs𝜋
𝑗
s𝑘
(
𝑖)e( )𝑎
v
−+ 𝑘1 𝐵,𝑡)
s
((cid:17)
t b)
s𝑖,𝑡st),
i
i
if
f
fe
e
ev
v
v𝑘
𝑘
m
c dh
iso
a
cv
r
he
g
as
e
r,
s ga et sc ps
o𝑗
w,
er
•
•
I a
b
I
tn
f
hn
a
emsoth et sohe
as
re mtm ear eto E tiv
ho
tVe
ian
mnp s at eh a
t
t
,a wy
t
Es hse
o
V, e, si EE . se cV
a
V. h, ms
s
and
re
so go
tt
a
em in
ym
io o
ne
at r
.
te tc hh tt ehho eo a ons rse da2 eb
m
rEa es iV ne s cs whst t aa hat
r
iyi
g
co hean ts
s
tht ta h
a
et te yw ios hh a
n
amic vah ee
t


Δ𝑡pre,𝐵
Δ(𝐷
𝑡e
cv( l𝑘e nv ,𝑡𝑘 st) 𝐷)−
−
(𝐶
𝐿
ev𝑖(
𝑚
𝑘bs )𝑖 (e)
v 𝑘,bs𝑖)(cid:17)
ia ft eb vs 𝑘𝑘 𝑖,
prepares/clean-ups,
3
MEa nr Tor ti Hhv ie
n
Od g, D)w
u
Oi nth
t
Lilt Oh the Ge(𝑞 Y𝑞-+ th1) E- Vth hE aV sfiin nit sh he eq du ce hu ae rgst ia ny gi .ng(doing
(4)
where𝑡stisthetimeatwhicheachactionstarts,andΔ𝑡 pre/clnisapre- Here,weintroduceoursolverfortheEVRP-EPS,whichhasbeen
definedconstanttimeforEVspreparing/cleanuping.Theduration definedintheprevioussection.OursolvergeneratesEVroutesby
ofmove(traveltime)iscalculatedassumingthatthevehiclespeed repeatingthetwocomponents,vehicleselectorandnodeselector
isconstant.ThedurationofchargeisthetimeittakesfortheEV (Figure3).Inthevehicleselector,anEVisselectedthatfinishes
tobechargedupto𝛽 ∈ [0,1]×100%ofitscapacity.Theduration clean-upthesoonestfromthecurrenttime.Inthenodeselector,thenextdestinationnodeoftheselectedEVisdeterminedbyatwo- ItthenproducesthefinalembeddingsofnodesandEVsbystack-
towerTransformer-basedmodel,whichparameterizesastochastic ing𝐿ofthefollowingTransformerencoders[32].
p deo sl tic iny a. tA iof nte nr ot dh ee ,as ne ole thct ee rd EVEV wis lt la br ets set lo ecm teo dv te hato tfit nh ie shd ee st ce lr em anin -ued p 𝒉 n(𝑙 o) de𝑛 =Xfmr n(𝑙 o) de𝑛 (cid:16) 𝒉 n(𝑙 o− d1 e) 1,...,𝒉 n(𝑙 o− d1 e) 𝑁(cid:17) , (13)
t eh ae chso co on me pst o, na en nd t,s ho oo wn. toIn trt ah ie nf oo ull row soi ln vg e, r,w ae ndde hs oc wrib te ot gh ee nd ee rt aa teils tho ef 𝒉e(𝑙 v)
𝑘
=Xfmr e(𝑙 v)
𝑘
(cid:16) 𝒉e(𝑙 v− 11),...,𝒉e(𝑙 v− 𝐾1)(cid:17) , (14)
finalroutes. whereXfmr(𝑙) ,Xfmr(𝑙) arethe𝑙-thTransformerencodersfor
node𝑛 ev 𝑘
nodes and EVs, of which subscript indicate the output element.
3.1 VehicleSelector
NotethatnopositionalencodingisusedhereasnodesandEVsare
IntheEVactioncycle,EVscanmovetothenextdestinationnode permutation-invariant.
onlyafterfinishingtheclean-up.Therefore,weemployarule-based Finally, the (conditional) probability of visiting each node is
vehicleselectorthatalwaysselectsanEVthatfinishesclean-upthe computedfromthescaleddot-productattentionbetweenthefinal
soonestfromthecurrenttime.Formally,theindexoftheselected embeddingsofnodesandtheselectedEVs,asfollows.
vehicle𝑘¯isobtainedbytheArguminfunctionoftheunmovable
durationofallEVs: 𝑢(𝑘,𝑛)= 𝜂·tanh(cid:18) 𝒒⊤ ev𝑘√𝒌 𝑑n kode𝑛(cid:19) ifnode 𝑛isvisitable,
(15)
𝑘¯ =argmin[𝑈(ev 𝑘,𝑡)], (8)  −∞ otherwise,
𝑘 
w timhe ere 𝑡.𝑈 It( ie sv u𝑘 p,𝑡 d) ai ts et dh weu hn em no thv eab 𝑘l -e thdu Er Vati so tn aro tsf𝑘 m-t oh viE nV ga at st fh oe llc ou wrr se :nt 𝑝 𝜃
(cid:16)
Π 𝑘¯(𝑎
𝑘¯)=𝑛|S𝑡𝑎𝑘¯,𝑘¯(cid:17)
=
(cid:205)
𝑚𝑒𝑢 𝑒( 𝑢𝑘¯, (𝑛 𝑘¯)
,𝑚), (16)
𝑈(ev 𝑘,𝑡)=

𝜏 𝜏m m′ ′o ov ve e+ +Δ Δ𝑡 𝑡p pr re e+ +𝜏 𝜏d c′
′
his ac rh ga erg +e Δ+ 𝑡Δ cln𝑡 cln I a
I
af fb ce
e
hav vs a𝑘 𝑘e rgm ms eto oa sv vt tie
e
aos
s
tn it
t
o,o
o
n,
w k
a
coreh
e
nye str 𝒌 ire sn
a
t𝜂 o
i
snd( oe a= 𝑛 fb1
l
t=
e
h0) e𝑊 pi
r
ss o𝐾 tat j𝒉h
e
tee cn( s𝐿 toc id) ol oei fnp 𝑛 ap ,
m
l𝑑i ln k
a
bg
t
ai rw s
si
ecti hd
e
sst e th
,
ad,
a
ti it nm oh
d
ne e sSnq ,u s
𝑡
cie ho ir
s
any
rt
go𝒒
h
efe ev t s𝑘 h
g
tale=
o
tk ib𝑊 oe
a
ny l𝑄 s,
s
,𝑊𝒉
t
aae( nt𝑄𝐿 v
e
d𝑘) ,, 𝑊
t
Eht Vh a𝐾e
st
 (9) at𝑡.Regardingtheconditionalbranch,abasestationisvisitableif
where𝜏 m′ ove,𝜏 d′ ischarge,and𝜏 c′
harge
arethedurationofmove,dis- theselectedEVcanreturntoachargingstationwithoutrunning
charge,andchargecomputedinEq.(4).Atothertimesitdecreases outofbatteryaftervisitingthatbasestation,andnootherEVsvisit
withtimeas: it.AchargestationisvisitableiftheselectedEVscanreachitfrom
thecurrentnodewithoutrunningoutofbatteryontheway.
𝑈(ev 𝑘,𝑡+𝜏)=𝑈(ev 𝑘,𝑡)−𝜏. (10)
3.3 Training
3.2 NodeSelector
WetrainthestochasticpolicywithREINFORCE[35],apolicygra-
Here,weaimtoobtainacentralizedstochasticpolicythatoutputs
dient algorithm. As the baseline, we employ the greedy rollout
theprobabilityofvisitingeachnode,giventheglobalenvironment
baselinesimilarto[15].Thegradient𝑔iscomputedasfollows,
stateandtheindexofaselectedEV.Inthispaper,weparameterize
thisstochasticpolicywithatwo-towerTransformer-basedmodel 𝑔=∑︁(cid:16) L(𝝅𝑏)−L(𝝅 𝑏𝐺𝑅 )(cid:17) ∇𝜃log𝑝 𝜃(𝝅𝑏), (17)
(ther.h.sofFigure3). 𝑏
Ourmodelfirstcomputestheinitialembeddingsofnodesand whereListhecostfunctionofEq.(1),𝝅𝑏 istheroutegenerated
EVswithlinearprojections: bysamplingrolloutonthecurrenttrainingpolicy,𝝅GRistheroute
𝑏
𝒉(0) =(cid:26) 𝑊 bs𝒔(bs 𝑛,𝑡 𝑎 𝑘¯)+𝒃bs if𝑛∈{1,...,𝑁 bs}, g pe on lie cyra it se rd epb ly acg er dee wd iy thr to hl elo cu ut ro ren ntth tre ab ina is ne gli pn oe lip co yl aic ty t. hT eh ee ndba os fe el ain che
node𝑛 𝑊cs𝒔(cs 𝑛−𝑁bs,𝑡 𝑎 𝑘¯)+𝒃cs if𝑛∈{𝑁 bs+1,...,𝑁},
epochonlyiftheimprovementbetweenthetwopoliciesismore
(11)
than5%inapairedt-testonvalidationinstances.Thesubscript
𝒉e(0 v 𝑘) =𝑊ev𝒔(ev 𝑘,𝑡 𝑎 𝑘¯)+𝒃ev, (12) 𝑏 indicatestherouteisfor𝑏-thinstanceofabatch.𝑝 𝜃(𝝅)isthe
where𝑊 bs,𝑊cs,𝑊ev,𝒃bs,𝒃cs,𝒃evaretrainableprojectionmatrices
probabilityofgeneratingtheroute𝝅,whichisfactorizedas:
𝑡a 𝑎n 𝑘¯d isbi ta hs ee ts imfo er wba hs ee ns tt ha eti so en les, ctc eh da Erg Ve ts at ka eti so tn hs e, 𝑎a -n td haE cV tis o, nre (s rp ige hc tti av fe tely r. 𝑝 𝜃(𝝅)=(cid:214)
𝑘
(cid:214)
𝑎𝑘
𝑝 𝜃(𝜋 𝑘(𝑎 𝑘)|S𝑡𝑎𝑘,𝑘). (18)
finishingclean-up).Theinputbase-stationstate𝒔(bs 𝑛,𝑡)includes2d
3.4 Decoding(RouteGeneration)
coordinates,capacity,consumptionrate,remainingbatteryat𝑡,and
expectedtimetobedowned(i.e.,thefeaturedimension𝑑 =6).The Wecangeneratethefinalroutebysamplingwiththetrainedsto-
charge-stationstate𝒔(cs 𝑛−𝑁bs,𝑡)includes2dcoordinates,discharge chasticpolicy.Thesamplingtechniqueincludesgreedydecoding,
rate,andbooleanofwhetherbeingvisitedbyanEV(i.e.,𝑑 =3).The samplingdecoding,beamsearch,andMonteCarlotreesearch.In
EVstate𝒔(ev 𝑘,𝑡) includes2dcoordinates,abooleanofwhether thispaper,weemploythesamplingdecoding,whichissimpleyet
beingatachargestation,currentphaseintheEVcycle,durationof effective. It first samples around 1k - 10k routes with sampling
eachphase,unmovableduration,capacity,andremainingbattery rollout,thenselectstheroutethatminimizesthecostfunctionthe
at𝑡 (i.e.,𝑑 =12). mostasthefinalroute.Table2:Thestatisticsanduseofthesyntheticdatasetsand RandomNodeSelector(Rand). Itreplacesthenodeselectorof
realdatasets. oursolverwitharandomselection.GivenaselectedEV,itrandomly
selectsavisitablenodeasthenextdestinationofthatEV.Thefinal
Name 𝑁ev 𝑁
bs
𝑁cs Area(km2) Use routeisthebestrouteamong12.8ksampledroutes,similartothe
Real-ev-6 6 33 62 46 Eval samplingdecodingofoursolver.
Real-ev-12 12 46 117 66 Eval
GreedyNodeSelector(Greed). Itreplacesthenodeselectorof
Syn-ev-6 6 50 12 100 Train/Valid/Eval
oursolverwithagreedyselection.GivenaselectedEV,itselectsa
Syn-ev-12 12 50 12 100 Train/Valid/Eval
visitablebasestationwiththelowestcurrentbatteryasthenext
Syn-ev-12S 12 25 12 100 Train/Valid
destinationofthatEV.Ifthereisnovisitablebasestation,itselects
thenearestchargestationfromthecurrentposition.
4 EXPERIMENTALSET-UPS ConstraintProgrammingonTime-SpaceNetwork(Cp-Tsn).
TheTime-SpaceNetwork(TSN)[25]duplicatesnodesalongthe
4.1 Datasets
discrete-timedirectionandconnectstwonodesatdifferentdiscrete
We evaluate our solver on synthetic datasets and real datasets. timeswithanarc.TheConstraintProgramming(CP)[9]thenfinds
Thesyntheticdatasetsaredividedintotraining,validation,and theoptimalchainofthearcs,whichcorrespondstoanEVroute.
evaluationsplits.Wetrainoursolveronthetrainingsplitandselect Asthecomputationofthevanillamodelistooexpensivetoderive
the weights of the epoch where the cost function is the lowest asolutionwithinthetimelimit,wefirstassignnodesgroupedby
onthevalidationsplit.Notethatweusegreedydecodinginthis abalancedk-meanstoeachEVandapplyCp-Tsntoeachofthe
validationphase.Wethenevaluateitontheevaluationsplitand dividedproblemsseparately.Notethatsolvingdividedproblems
realdatasets. restrictsthesearchspaceandmaypreventderivingtheoriginal
problem’soptimalsolution(settlingforanear-optimalsolution).
Therealdatasets(Real-ev-6,12). Theyincludeactualdataof
TheOR-ToolsCP-SATsolver3isusedhere.Wereporttheresultsof
twodifferentregions2:theareasof Real-ev-6andReal-ev-12are
twodifferenttimeresolutions,1hand0.5h,denotedbyCp-Tsn
around46and66km2,respectively.Table2organizesthestatistics 1.0
andCp-Tsn ,respectively.
ofthesedatasets.Thelocationsandspecificationsofnodesand 0.5
EVsareactualvalues.Basestationsaredistributedinthecenter 4.3 HyperparametersandDevices
andchargestationssurroundit,emulatingtheactualsituation.We √ √
assumethattheinitialbatteriesofbasestationsandEVsare80% TrainableparametersareinitializedwithU(−1/ 𝑑,1/ 𝑑),𝑑isthe
oftheircapacities. inputdimension.Training,validation,andevaluationsplitsforthe
syntheticdatasetshave1.28M,1000,and100instances,respectively.
Thesyntheticdatasets(Syn-ev-6,12). Theyaregeneratedbased WeevaluateasolvertrainedwiththesamenumberofEVsand
on the distribution of the real datasets. Table 2 organizes their 𝑇 = 12astheevaluationdata.Themaximumepochis100,the
statistics.Thelocationsofnodesareuniformlysampledwithin mini-batchsizeis256,andtheconstantlearningrateis10−4.The
thesquarearea[0,100]2km2.Thespecificvaluesofbasestations,
numberofTransformerencoderlayersissetas𝐿=2,thedimension
chargestations,andEVsaresampledfromthedistributionofreal inhiddenlayers𝐻 = 128,andthenumberofheads𝑀 = 8.The
datasets.Theinitialbatteriesofbasestationsarerandomlysam- weightingfactorissetas𝛼 =100.Therandomseedissetto1234
pledwithin50-100%ofthecapacity,andthoseofEVsareset unlessotherwisestated.AsingleGPU(RTXA6000:48G)andtwo
to80%ofthecapacity.Syn-ev-6Sisusedonlyforscalabilityand CPUs(XeonPlatinum8380(2.30GHz))areusedintheexperiments.
generalizationtests,whichisdiscussedlater.
5 EXPERIMENTALRESULTS
Parametersofbasestations,chargestations,andEVs. Wehere
considertheNissanLeafe+series,ofwhichthecapacity𝑄(ev 𝑘) 5.1 PerformanceComparisonwithBaselines
=60kWh,drivingpowerconsumption𝐶(ev 𝑘)=161Wh/km,dis- Table3showsthecomparisonresultsonthesyntheticdatasetsand
chargelowerlimit𝜇=0.1.ThedischargerateofEVsissetas𝐷(ev 𝑘) realdatasetswith𝑇=12,24h.Metricsareaveragedtraveldistance
=10kWh/h.Theconstantvehiclespeedissetas𝑉 =41km/h.The perEV(dist(km)),thetimeaverageofthenumberofdownedbase
chargeupperlimitissetto80%,i.e.,𝛽,𝛾=0.8.Thedischargerateof stations(down),theobjectivevalue(obj),andtotalcomputation
chargestationsiseither3(normalcharging)or50kWh/h(rapid time(time).Here,wesetthetimelimitto30minutes,whichisthe
charging),i.e.,𝐷(cs 𝑗)=3,50kWh/h.Prepare/cleanupduration(i.e., requirementfromthesiteworkers.Whencalculationsexceedthe
Δ𝑡 pre/cln)atbasestationsandchargestationsaresetto0.5hand timelimit,wereporttheintermediateresultsobtainedatthatpoint.
10m,respectively.Eachbasestationhasitsowncapacityandcon- Inthiscomparison,objandtimearetheprimarymetrics,with
sumptionrate,detailsofwhichareomitted.Thedistancebetween distanddownconsideredasreferenceinformation.4
nodesisapproximatedbyEuclideandistance.
Oursolver(Ours). Oursconsistentlyoutperformsbaselineson
4.2 Baselines alldatasetsintermsofbothobjandtime.Notably,oursprovides
thebestobjevenonrealdatasets,wherethedistributionofnodes
Wecompareoursolverwiththefollowingsolvers.
3https://developers.google.com/optimization/cp/cp_solver
2Thenamesoftheregionsandspecificvaluesareomittedforprivacyreasons. 4Thisisbecauseobjalreadyconsidersthetrade-offsbetweendistanddown.Table3:Oursolver(Ours)v.s.baselines.MetricsareaveragedtraveldistanceperEV(dist(km)),thetimeaverageof#downed
basestations(down),theobjectivevalue(obj),andtotalcomputationtime(time).Forallvalues,smallerisbetter.
Syn-ev6(100samples) Syn-ev12(100samples)
𝑇 =12h 𝑇 =24h 𝑇 =12h 𝑇 =24h
Model dist down obj time dist down obj time dist down obj time dist down obj time
w/oEVs - 20.1 - - - 33.3 - - - 20.1 - - - 33.3 - -
Greed 189 17.7 37.2 1s 312 29.8 62.8 1s 192 15.5 32.9 1s 317 26.6 56.4 2s
Rand(S=12800) 142 15.3 32.0 1m 263 26.5 55.5 2m 157 11.8 25.1 3m 283 21.1 45.1 6m
Ours(G) 81 12.5 25.9 1s 125 25.2 51.7 1s 78 6.63 14.0 1s 131 18.2 37.8 2s
Ours(S=1280) 78 12.4 25.5 51s 125 24.6 50.4 1m 75 6.41 13.6 1m 129 17.4 36.0 3m
Ours(S=12800) 78 12.4 25.5 9m 126 24.5 50.2 15m 74 6.38 13.5 15m 129 17.2 35.7 28m
Real-ev6(1sample) Real-ev12(1sample)
𝑇 =12h 𝑇 =24h 𝑇 =12h 𝑇 =24h
Model dist down obj time dist down obj time dist down obj time dist down obj time
w/oEVs - 8.25 - - - 17.5 - - - 11.3 - - - 25.9 - -
Greed 30 5.87 19.4 1s 37 13.5 42.8 1s 88 9.34 21.7 1s 107 20.9 47.1 1s
Rand(S=12800) 32 3.74 13.1 1s 63 10.0 33.8 2s 120 4.98 12.8 5s 215 14.2 34.2 8s
Cp-Tsn1.0 16 5.62 17.9 1m 24 12.6 39.37 30m 47 4.54 10.62 22s 98 14.2 32.44 30m
Cp-Tsn0.5 16 3.40 11.2 11m 31 11.6 36.7 30m 53 3.32 8.06 1m 105 15.0 34.25 30m
Ours(G) 17 2.53 8.61 1s 26 8.46 27.1 1s 59 1.06 3.26 1s 99 11.1 25.6 1s
Ours(S=1280) 21 2.03 7.27 1s 35 8.37 27.3 2s 61 0.65 2.41 4s 101 10.8 25.2 6s
Ours(S=12800) 19 1.96 6.97 9s 33 8.15 26.5 15s 61 0.48 2.03 28s 100 10.6 24.7 47s
significantlydiffersfromthatofthetrainingdatasets(i.e.,uniform stations,thetimevariationinbasestation/EVbatteries,andthe
distributionv.s.twoclusters:onelocatedatthecenterandtheother routenetworkformedbyEVs’traveltrajectory.
surroundingtheperimeter).Theseresultsdemonstratethatourshas Thetimevariationinthenumberofdownedbasestationspro-
thegeneralizationabilityfornodedistributionandcanbeappliedto videsmorefine-grainedperspectivesofdown,whichcorresponds
anyregion.Incomparisonbetweenthedecodingtypesofours,the to(theareaboundedbelowthecurveandbythe𝑥-axis)/(time
samplingdecoding(Ours(S=#samples))outperformsthegreedy horizon𝑇)here.Oursmaintainsthelowestnumberofdownedbase
decoding(Ours(G)).Furthermore,Weobserveanimprovement stationscomparedtoothersolversformostofthetimehorizon.
in obj asthesample sizeincreases. Thecomputationtime also ThereductionbyoursisgreaterinReal-EV12,wheretheratio
increasesatthattime,butthereisenoughmarginforthetimelimit. ofbasestationstoEVsissmallerthaninReal-EV6(3.8v.s.5.5).
Thisindicatesoursworksmoreeffectivelywhenthetheoretical
Greed&Rand. Greedalwaysprovidestheworstobj,indicating maximumnumberofbasestationsthatcanbemaintainedisgreater.
thatasimplerule-basedroutingisineffectiveinEVRP-EPS.By Regardingtheincreaseinthatnumbertowardstheendofthetime
contrast,Randprovidesrelativelyreasonableobj.Asthesenaive horizon,itispreferabletoamid-periodrise,aswehereassume
solversdonotconsiderminimizingtraveldistance,disttendsto poweroutagesareresolvedimmediatelyaftertheendofthetime
belongerthanothersolvers.ThecomparisonbetweenRandand horizon.
oursinthesamesamplesizedemonstratesthatourseffectively Thetimevariationinbasestationbatteriesshowsthatthere
samplesbetterroutes,guidedbythetrainedstochasticpolicy. arefourdistinctbasestationcapacities,andsmall-capacitybase
stationsarevisitedmanytimesinashortspanoftime.Wealso
Cp-Tsn. Itprovidesthesecond-bestobjonrealdatasets.Weob-
observethatEVsdonotvisitbasestationsthatwillnotbedown
serveanimprovementinobjasthetimeresolutionincreases.This
duringthetimehorizon,evenwithoutapowersupplyfromEVs.
isbecausehighertimeresolutionapproximatescontinuoustime
InthetimevariationinEVbatteries,weobservetwodistinct
moreclosely,therebyreducingtheredundantwaitingperiodsthat
dischargepatterns:onerepeatsasmallamountofdischargenu-
arisebetweendiscretetimeticksandthecompletionofanaction.
merous times, while the other performs a relatively substantial
However,asthesearchspacegrowsexponentiallywiththeincrease
dischargearoundtwotofivetimes.Theformercanbeassociated
intimeresolution,weshouldkeepitatareasonablevalue(e.g.,0.5-
withdischargingtosmall-capacitybasestationsthatrequirefre-
1h)tofindareasonablesolutionwithinthetimelimit.Furthermore,
quentcharging,whilethelattercorrespondstodischargingtoother
Cp-Tsnsolvessub-problemsthatarenotguaranteedtorecover
middletolarge-capacitybasestations.Despitetheabsenceofex-
theoriginalproblemfully,andthereforethatmaybewhyitsper-
plicitlysetroles,thesetworolesarisebecauseonceanEVvisitsa
formanceisinferiortoours.Overall,thepoorscalabilityofthis
small-capacitybasestation,itbecomesrationalforittocontinue
solverisamajorlimitationtoderiveareasonableroutewithina
visitingothersmall-capacitystations:Theshorterdurationofdis-
constrainedtimeframe.
charging at small-capacity basestations allows the EV there to
moveontothenextnodesoonerthanotherEVs;Itisanatural
Visualization. Figure4showsfourtypesofvisualresultsonthe
choiceforthatEVtovisitothersmall-capacitybasestationsatthat
realdatasets:ThetimevariationinthenumberofdownedbaseFigure4:Fourvisualresultsforeachrealdataset:Thetimevariationinthenumberofdownedbasestations(1strow),thetime
variationinbasestation/EVbatteries(2nd-3rdrows),andtheroutenetwork(4throw).Eachcolumncorrespondstoeachofthe
realdatasetsandincludesthosecorrespondingresults.
timeastheyarelikelydownwithinashorttime;Asaresultofthis withsmall-capacitybasestationsashubsalsoconfirmthatthese
repeated,thatEVvisitssmall-capacitybasestationsmanytimes stationsarevisitedfrequently.
whileotherEVscontinuetodischargeatonebasestation.
Thevisualizationofroutenetworksshowstwonodedistinct
5.2 ComputationalScalabilityTest
distributionsof Real-EV6,12andthetraveltrajectoryofeachEV
withdifferentcolors.Intuitively,therearenoobviouslyinefficient OneofthebiggestreasonswhyweemployaRL-basedapproach
visits,andallroutesareconsideredreasonable.Theroutenetworks isitsfastcomputationforlarge-scaleproblems.Toconfirmthis,Table4:Thestatisticsofadditionalevaluationdatasets(100
samples/dataset)forscalabilityandgeneralizationtests.Note
thatSyn-Th-*areallthesamedataset,whereonlythetime
horizonduringinferenceissetdifferently.
Name 𝑁ev 𝑁bs 𝑁cs 𝑇
Syn-Th-12,24,36,48 12 25 12 {12,24,36,48}
Syn-Bs-25,50,75,100 12 {25,50,75,100} 12 12
Syn-Ev-6,12,18,24 {6,12,18,24} 50 𝑁ev 12
wehereevaluatethecomputationalscalabilityofoursolver:How
muchthecomputationtimeincreaseswithrespecttotheincrease
inthetimehorizonandthenumberofbasestationsandEVs.We
prepareadditionalevaluationdatasets,whichareorganizedinTable
Figure5:Resultsofscalabilitytest(toprow)andgeneraliza-
4.Theyaregeneratedwiththerandomseed0andthesamplesize
tiontest(bottomrow).Thepointsrepresentaveragevalues.
100.ThetrainingdatasetforSyn-Th-*andSyn-Bs-*isSyn-ev-12S,
Thefilledareaindicatesthestandarddeviation.Thedotted
whileforSyn-Ev-*,itisSyn-ev-6.ThetoprowofFigure5shows
linerepresentsthelinearincreasefromthestartingpoint.
thecomputationtimeineachdataset.Assumingactualsituations,
thecomputationtimeherereferstotheaveragetimepersample
whenderivingonerouteatatime(i.e.,thebatchsizeis1).We
Besides,theyconfirmthatinthepreviousscalabilitytest,oursolver
observedifferentbehaviorsintheincreaseofeachparameter.The
providednotonlyfastcomputationbutalsoadequateperformance.
computationtimeincreasesapproximatelyinproportiontothe
timehorizons.Thisisbecausethelengthoftheactionsequence𝐴
𝑘 6 RELATEDWORK
increasesinproportiontothetimehorizons.Withrespecttothe
increaseinthenumberofbasestations,thecomputationtimeiskept 6.1 VehicleRoutingProblem
belowthelinearincrease.Thisindicatesthatbatchparallelization
TheVehicleRoutingProblem(VRP)isacombinatorialoptimization
withGPUsandotheroptimizationssuppress,onthis(practical)
problemthataimstofindtheoptimalroutesforafleetofvehicles
scale,thequadratictimecomplexitywithrespecttothenumber
tovisitagivensetofdestinations.SinceDantzigandRamser[7]
of nodes. The computation time with respect to the number of
introduceditsconcept,numerousvariantsofVRPshavebeenpro-
EVsincreasesrapidlycomparedtootherparameters.Itappears
posedalongwiththeirsolvers.WewilldiscussrelatedvariantVRPs
that the length of the action sequence increases proportionally
(i.e.,EVRP)later,andherewefocusonthetypesofsolvers.
withthenumberofEVs,butthisisnotactuallythecase.Infact,
Thereexistsatrade-offbetweentheroutequalityandcomputa-
moreEVsleadtofrequentsmalldischargesofeachEV,resulting
tiontime,therefore,theappropriatesolvermustbechosenbased
inmorecomputationtime(i.e.,actions)thanexpected.However,
onthesituation.ExactsolverssuchastheBranch-and-Cut(-and-
thereisstillenoughmarginforthetimelimit(30minutes).Overall,
Price)algorithm[1,27]providethestrictlyoptimalroutes,while
theseresultsdemonstratethatoursolvergeneratesarouteatevery
theyhavedifficultysolvinglarge-scaleVRPsquickly.Ontheother
conceivablepracticalscalewithenoughspeedforthetimelimit.
hand,heuristics[2,12,21,33]providenear-optimalrouteswithina
reasonabletime,eveninlarge-scaleVRPs.Recently,neuralnetwork-
5.3 GeneralizationTest
basedsolvershavebeenexplored[5,13,15,23,34],whichprovide
ThetimehorizonandthenumberofEVs/nodesvarydepending fastercomputationthanheuristics.Inaddition,theycangeneratea
onthesituation.However,itisimpracticabletotrainoursolver heuristicoptimizedtoaspecificVRPfromtheVRPdata,thereby
for each case. Therefore, our solver requires the generalization overcomingthedifficultysuchthatconstructingspecializedhueris-
abilityforunseensettings.Wehereusethesamedatasetsandour ticsrequiresdeepdomainknowledge.Inthispaper,weemployan
solversasthescalabilitytest.ThebottomrowofFigure5showsthe NN-basedsolverduetothescaleandtimelimitofEVRP-EPS.The
objectivevaluesineachdataset,whichareevaluatedatthesame lackofspecializedheuristicsforEVRP-EPSalsojustifiesourchoice.
timeasthecomputationtimeinthescalabilitytest.Wereportthe AmongtheNN-basedsolvers,Transformer-basedmulti-agentRL
comparisonbetweenoursolverandnaiveapproaches(Greedand (TMARL)solversaremostrelevanttooursolver.SeveralTMARL
Rand).5Oursolverconsistentlyoutperformsthenaiveapproaches solvershavebeenproposedformulti-vehiclesettings[6,18,40,
ateveryparametersetting,whereoursolveristrainedonthemost- 43].However,theyarenotdesignedforoursituation,wherenode
leftparametersettingineachgraph.Notably,weobservethatour property(i.e.,battery)changescontinuouslyovertime,andthese
solvereffectivelyincreasestheimprovementratiointheunseen changesareinfluencedbythetimingatwhichthenodeisvisited
settingsof18and24EVs.Theseresultsdemonstratethatoursolver (multiplevisitspernodearepossible).Oursolveraddressesthisby
possessesreasonablegeneralizationcapabilitiesforunseensettings. introducingtherule-basedvehicleselector,whichallowsittofollow
theexactglobalstateinourcomplicatedsituation.Decentralized
learningisanotherchoicetoaddressthis,butweemploycentralized
5WehereexcludeCp-Tsn becauseitexceedstheindexlimitofOR-Tools(i.e.,outputs
IndexError:listinde∗ xoutofrange)inthemiddleofincreasingtheparameters. learningwiththerule-basedguidebecausewehereassumetheuseofourcentralizedsystemthatmonitorsthestatusofEVsand Theresultsshowthatoursolverconsistentlyoutperformsbaselines
nodes.Regardingthenodeselector,weproposethesimplesttwo- intermsoftheobjectivevalueandthecomputationtime.Wealso
towermodelamongexistingTMARLsolvers,ofwhichperformance analyzedthescalabilityandgeneralizationperformance,demon-
remainssufficient. stratingoursolver’scapabilityforlarge-scaleproblemsandunseen
situations.
6.2 ElectricVehicleRoutingProblem Ontheotherhand,oursolvercurrentlyfacestwolimitations:un-
balancedworkamongEVsandonlyconsideringEuclideandistance.
TheElectricVRP(EVRP)isaVRPthatadditionallyconsidersEV
Balancingtheamountofwork(e.g.,thetraveldistanceandthe
batteryconsumptionbytravelandrechargingofEVbattery.Antici-
countofvisitingnodes)amongEVsiscriticalforimprovingtheir
patingtheintroductionofEVsinlogistics,variousworksrelatedto
fairnessifthedriversarehumans.Moreover,theeffectivenessofour
EVRPhaveappearedlately(referto[16,28]formorecomprehen-
methodwouldbereducediftheactualdistancebetweentwopoints
sivereviewsonthistopic).Here,wefocusontheproblemformu-
differssignificantlyfromtheEuclideandistance.Infuturework,
lation.TherearemanyvariantsofEVRP,wheretheconventional
wewilladdresstheseproblemsbyleveragingroute-balancingtech-
VRPvehiclesarereplacedwithEVs,andtheircharacteristicsare
niquesandavariantofTransformersthatconsidersedgefeatures,
considered.TheyincludetheElectricTravelingSalesmanProblem
whichrepresenttheactualtraveldistance.
withTimeWindows(ETSPTW)[29],EVRP[20],EVRPwithTime
Windows(EVRPTW)[8,14,30],andElectricPickupandDelivery
ProblemwithTimeWindows(EPDPTW)[10].Frommoredetailed REFERENCES
perspective,batteryconsumptionestimationaccordingtotheEV’s
[1] J.R.AraqueG,G.Kudva,T.L.Morin,andJ.F.Pekny.1994.Abranch-and-cut
loadhasalsobeenstudiedtomaketheproblemmorerealistic:lin- algorithmforvehicleroutingproblems. AnnalsofOperationsResearch50,1
eardeterministic[3,36,42],non-lineardeterministic[11,19],and (1994),37–59. https://doi.org/10.1007/BF02085634
[2] BarrieM.BakerandM.A.Ayechew.2003.Ageneticalgorithmforthevehicle
stochasticestimation[4,26,31,41].Ourformulation,EVRP-EPS, routingproblem.Computers&OperationsResearch30,5(2003),787–800. https:
canbeconsideredavariantoftheInventoryRoutingProblem(IRP) //doi.org/10.1016/S0305-0548(02)00051-5
[3] RafaelBasso,BalázsKulcsár,BoEgardt,PeterLindroth,andIvanSanchez-Diaz.
[17],whichhasnotyetbeenstudiedinthecontextofEVRP.That
2019.EnergyconsumptionestimationintegratedintotheElectricVehicleRouting
is,theinventorycorrespondstothebasestationbattery.Regarding Problem.TransportationResearchPartD:TransportandEnvironment69(2019),
batteryconsumptionestimationinEVRP-EPS,linearmodelsare 141–167. https://doi.org/10.1016/j.trd.2019.01.006
[4] RafaelBasso,BalázsKulcsár,andIvanSanchez-Diaz.2021.Electricvehiclerouting
used,butwefoundthemsufficientbasedonactualdrivingdatain
problemwithmachinelearningforenergyprediction.TransportationResearch
oursetting. PartB:Methodological145(2021),24–55. https://doi.org/10.1016/j.trb.2020.12.007
[5] IrwanBello,HieuPham,QuocV.Le,MohammadNorouzi,andSamyBen-
gio.2017. NeuralCombinatorialOptimizationwithReinforcementLearning.
6.3 EVsforEmergencyPowerSupply
arXiv:1611.09940[cs.AI]
[6] GuillaumeBono,JillesS.Dibangoye,OlivierSimonin,LaëtitiaMatignon,and
SeveralapproachesleveragingtheV2Xtechnologyforemergency
FlorianPereyron.2021. SolvingMulti-AgentRoutingProblemsUsingDeep
powersupplyhavebeenproposed.Xuetal.[37]proposeda(dis-) AttentionMechanisms.IEEETransactionsonIntelligentTransportationSystems
chargeschedulingapproachassumingthateachhouseholdpos- 22,12(2021),7804–7813. https://doi.org/10.1109/TITS.2020.3009289
[7] G.B.DantzigandJ.H.Ramser.1959.TheTruckDispatchingProblem.Manage-
sessesanEV,whichmovesbackandforthbetweenthehousehold mentScience6,1(1959),80–91. https://doi.org/10.1287/mnsc.6.1.80
andachargestation/anotherhousehold.Yangetal.[39]consider [8] GuyDesaulniers,FaustoErrico,StefanIrnich,andMichaelSchneider.2016.
ExactAlgorithmsforElectricVehicle-RoutingProblemswithTimeWindows.
publicEVparticipantsandhaveproposedatwo-stageapproach
OperationsResearch64,6(2016),1388–1405. https://doi.org/10.1287/opre.2016.
thatdeterminestheparticipants’dischargeschedulingandrewards 1535arXiv:https://doi.org/10.1287/opre.2016.1535
(i.e.,money).Incontrasttotheseworks,EVRP-EPSisarouting [9] ThomFruewirthandSlimAbdennadher.2003.EssentialsofConstraintProgram-
problem (not discharge time scheduling) and ignores discharge
ming.Springer-Verlag,Berlin,Heidelberg.
[10] DominikGoeke.2019.Granulartabusearchforthepickupanddeliveryprob-
rewardingaswehereassumethatmaintainersofthebasestations lemwithtimewindowsandelectricvehicles.EuropeanJournalofOperational
(ourcompany’sworkers)operateEVs. Research278,3(2019),821–836. https://doi.org/10.1016/j.ejor.2019.05.010
[11] DominikGoekeandMichaelSchneider.2015.Routingamixedfleetofelectric
AlthoughitdoesnotuseEVs,theapproachin[22]sharesour andconventionalvehicles.EuropeanJournalofOperationalResearch245,1(2015),
motivationthatvehiclessupplyelectricitytotheaffectedbuilding 81–99. https://doi.org/10.1016/j.ejor.2015.01.049
[12] KeldHelsgaun.2017.AnExtensionoftheLin-Kernighan-HelsgaunTSPSolver
during/afteradisaster.Itusespowersupplyvehiclestosupplyelec-
forConstrainedTravelingSalesmanandVehicleRoutingProblems:Technical
tricitytobatteriesequippedwithshelters.Theauthorsformulated report.
thisproblemasavariantofVRPTW,wherethegoalistominimize [13] ChaitanyaK.Joshi,ThomasLaurent,andXavierBresson.2019. AnEfficient
GraphConvolutionalNetworkTechniquefortheTravellingSalesmanProblem.
thesumofarrivaltimeandwaitingtimeforeachshelter.Onthe
CoRRabs/1906.01227(2019).arXiv:1906.01227 http://arxiv.org/abs/1906.01227
otherhand,EVRP-EPSisavariantofIRP,wherethereisnoexplicit [14] MerveKeskinandBülentÇatay.2016.Partialrechargestrategiesfortheelectric
timewindow,andmultiplevisitstothesamenodeareallowed.This vehicleroutingproblemwithtimewindows. TransportationResearchPartC:
EmergingTechnologies65(2016),111–127. https://doi.org/10.1016/j.trc.2016.01.
isbecausebasestationbatteriesaredepletedrelativelyquicklyand 013
requiremultiplesuppliesduringatimehorizon. [15] WouterKool,HerkevanHoof,andMaxWelling.2019. Attention,Learnto
SolveRoutingProblems!.InInternationalConferenceonLearningRepresentations.
https://openreview.net/forum?id=ByxBFsRqYm
7 CONCLUSIONANDFUTUREWORK [16] IlkerKucukoglu,ReginaldDewil,andDirkCattrysse.2021.Theelectricvehicle
routingproblemanditsvariations:Aliteraturereview.Computers&Industrial
Inthispaper,weformulatedabasestationreliefbyEVsasavariant Engineering161(2021),107650. https://doi.org/10.1016/j.cie.2021.107650
oftheEVRPsandproposedasolverthatcombinesarule-based [17] Felipe Lagos, Natashia Boland, and Martin Savelsbergh. 2020. The
vehicleselectorandanRL-basednodeselector.Wecomparedour Continuous-Time Inventory-Routing Problem. Transportation Sci-
ence 54, 2 (2020), 375–399. https://doi.org/10.1287/trsc.2019.0902
solverwithbaselinesonbothsyntheticdatasetsandrealdatasets. arXiv:https://doi.org/10.1287/trsc.2019.0902[18] JingwenLi,YiningMa,RuizeGao,ZhiguangCao,AndrewLim,WenSong,and [39] ZexinYang,TianGao,YuLiu,XueliangHuang,ShanGao,QiZhao,andHongen
JieZhang.2022.DeepReinforcementLearningforSolvingtheHeterogeneous Ding.2023.Atwo-stagepricingstrategyforelectricvehiclesparticipatingin
CapacitatedVehicleRoutingProblem.IEEETransactionsonCybernetics52,12 emergencypowersupplyforimportantloads.ElectricPowerSystemsResearch
(2022),13572–13585. https://doi.org/10.1109/TCYB.2021.3111082 218(2023),109239. https://doi.org/10.1016/j.epsr.2023.109239
[19] JinLi,FengWang,andYuHe.2020. ElectricVehicleRoutingProblemwith [40] KeZhang,FangHe,ZhengchaoZhang,XiLin,andMengLi.2020.Multi-vehicle
BatterySwappingConsideringEnergyConsumptionandCarbonEmissions. routingproblemswithsofttimewindows:Amulti-agentreinforcementlearning
Sustainability12,24(2020). https://doi.org/10.3390/su122410537 approach. TransportationResearchPartC:EmergingTechnologies121(2020),
[20] JaneLin,WeiZhou,andOuriWolfson.2016.ElectricVehicleRoutingProblem. 102861. https://doi.org/10.1016/j.trc.2020.102861
TransportationResearchProcedia12(2016),508–521. https://doi.org/10.1016/j. [41] ShuaiZhang,MingzhouChen,WenyuZhang,andXiaoyuZhuang.2020.Fuzzy
trpro.2016.02.007TenthInternationalConferenceonCityLogistics17-19June OptimizationModelforElectricVehicleRoutingProblemwithTimeWindows
2015,Tenerife,Spain. andRechargingStations.ExpertSyst.Appl.145,C(may2020),12pages. https:
[21] S.LinandB.W.Kernighan.1973. AnEffectiveHeuristicAlgorithmforthe //doi.org/10.1016/j.eswa.2019.113123
Traveling-SalesmanProblem.OperationsResearch21,2(1973),498–516. https: [42] MengtingZhaoandYuweiLu.2019. AHeuristicApproachforaReal-World
//doi.org/10.1287/opre.21.2.498arXiv:https://doi.org/10.1287/opre.21.2.498 ElectricVehicleRoutingProblem.Algorithms12,2(2019). https://doi.org/10.
[22] QixingLiu,PengXu,YuhuWu,andTielongShen.2023.Atwo-stagealgorithm 3390/a12020045
forvehicleroutingproblemwithchargingreliefinpost-disaster.IETIntelligent [43] ZefangZong,MengZheng,YongLi,andDepengJin.2022.MAPDP:Cooperative
TransportSystems17,8(2023),1525–1543. https://doi.org/10.1049/itr2.12344 Multi-AgentReinforcementLearningtoSolvePickupandDeliveryProblems.
arXiv:https://ietresearch.onlinelibrary.wiley.com/doi/pdf/10.1049/itr2.12344 ProceedingsoftheAAAIConferenceonArtificialIntelligence36,9(Jun.2022),
[23] MohammadRezaNazari,AfshinOroojlooy,LawrenceSnyder,andMartinTakac. 9980–9988. https://doi.org/10.1609/aaai.v36i9.21236
2018. ReinforcementLearningforSolvingtheVehicleRoutingProblem.In
Advances in Neural Information Processing Systems, S. Bengio, H. Wallach,
H.Larochelle,K.Grauman,N.Cesa-Bianchi,andR.Garnett(Eds.),Vol.31.Cur-
ranAssociates,Inc. https://proceedings.neurips.cc/paper_files/paper/2018/file/
9fb4651c05b2ed70fba5afe0b039a550-Paper.pdf
[24] VisionofHumanity.2022.Ecologicalthreatreport2022:AnalysingEcological
Threats,Resilience&Peace.(2022). https://doi.org/wp-content/uploads/2022/
10/ETR-2022-Web-V1.pdf
[25] DimitriPapageorgiou,AhmetKeha,GeorgeNemhauser,andJoelSokol.2014.
Two-StageDecompositionAlgorithmsforSingleProductMaritimeInventory
Routing.INFORMSJournalonComputing26(112014),825–847. https://doi.org/
10.1287/ijoc.2014.0601
[26] SamuelPelletier,OlaJabali,andGilbertLaporte.2019.Theelectricvehiclerouting
problemwithenergyconsumptionuncertainty.TransportationResearchPartB:
Methodological126(2019),225–255. https://doi.org/10.1016/j.trb.2019.06.006
[27] ArturAlvesPessoa,RuslanSadykov,EduardoUchoa,andFrançoisVanderbeck.
2020.AGenericExactSolverforVehicleRoutingandRelatedProblems.Mathe-
maticalProgramming183(2020),483–523. https://doi.org/10.1007/s10107-020-
01523-z
[28] HuQin,XinxinSu,TengRen,andZhixingLuo.2021.Areviewontheelectric
vehicleroutingproblems:Variantsandalgorithms. FrontiersofEngineering
Management8(052021). https://doi.org/10.1007/s42524-021-0157-1
[29] R.RobertiandM.Wen.2016. TheElectricTravelingSalesmanProblemwith
TimeWindows. TransportationResearchPartE:LogisticsandTransportation
Review89(2016),32–52. https://doi.org/10.1016/j.tre.2016.01.010
[30] MichaelSchneider,AndreasStenger,andDominikGoeke.2014. TheElectric
Vehicle-RoutingProblemwithTimeWindowsandRechargingStations.Trans-
portationScience48,4(2014),500–520. http://www.jstor.org/stable/43666939
[31] MehmetSoysal,MustafaÇimen,andSedatBelbağ.2020.Pickupanddelivery
withelectricvehiclesunderstochasticbatterydepletion.Computers&Industrial
Engineering146(2020),106512. https://doi.org/10.1016/j.cie.2020.106512
[32] AshishVaswani,NoamShazeer,NikiParmar,JakobUszkoreit,LlionJones,
AidanNGomez,ŁukaszKaiser,andIlliaPolosukhin.2017.AttentionisAllyou
Need.InAdvancesinNeuralInformationProcessingSystems,I.Guyon,U.Von
Luxburg,S.Bengio,H.Wallach,R.Fergus,S.Vishwanathan,andR.Garnett
(Eds.),Vol.30.CurranAssociates,Inc. https://proceedings.neurips.cc/paper_
files/paper/2017/file/3f5ee243547dee91fbd053c1c4a845aa-Paper.pdf
[33] ThibautVidal.2022.HybridgeneticsearchfortheCVRP:Open-sourceimple-
mentationandSWAP*neighborhood. Computers&OperationsResearch140
(2022),105643. https://doi.org/10.1016/j.cor.2021.105643
[34] Oriol Vinyals, Meire Fortunato, and Navdeep Jaitly. 2015. Pointer Net-
works. In Advances in Neural Information Processing Systems, C. Cortes,
N.Lawrence,D.Lee,M.Sugiyama,andR.Garnett(Eds.),Vol.28.Curran
Associates,Inc. https://proceedings.neurips.cc/paper_files/paper/2015/file/
29921001f2f04bd3baee84a12e98098f-Paper.pdf
[35] RonaldJ.Williams.1992.SimpleStatisticalGradient-FollowingAlgorithmsfor
ConnectionistReinforcementLearning.Mach.Learn.8,3–4(may1992),229–256.
https://doi.org/10.1007/BF00992696
[36] YiyongXiao,XiaorongZuo,IkouKaku,ShenghanZhou,andXingPan.2019.
Developmentofenergyconsumptionoptimizationmodelfortheelectricvehicle
routingproblemwithtimewindows.JournalofCleanerProduction225(2019),
647–663. https://doi.org/10.1016/j.jclepro.2019.03.323
[37] NingZhouXu,KaWingChan,ChiYungChung,andMingNiu.2020.Enhancing
AdequacyofIsolatedSystemsWithElectricVehicle-BasedEmergencyStrategy.
IEEETransactionsonIntelligentTransportationSystems21,8(2020),3469–3475.
https://doi.org/10.1109/TITS.2019.2929767
[38] N.Z.XuandC.Y.Chung.2016.ReliabilityEvaluationofDistributionSystems
IncludingVehicle-to-HomeandVehicle-to-Grid. IEEETransactionsonPower
Systems31,1(2016),759–768. https://doi.org/10.1109/TPWRS.2015.2396524
Approximating the Core via Iterative Coalition Sampling
IanGemp MarcLanctot LukeMarris
GoogleDeepMind GoogleDeepMind GoogleDeepMind
London,UnitedKingdom Montreal,Canada London,UnitedKingdom
imgemp@google.com lanctot@google.com marris@google.com
YiranMao EdgarDuéñez-Guzmán SarahPerrin
GoogleDeepMind GoogleDeepMind GoogleDeepMind
London,UnitedKingdom London,UnitedKingdom Paris,France
yiranm@google.com duenez@google.com sarahperrin@google.com
AndrasGyorgy RomualdElie GeorgiosPiliouras
GoogleDeepMind GoogleDeepMind GoogleDeepMind
London,UnitedKingdom Paris,France London,UnitedKingdom
agyorgy@google.com relie@google.com gpil@google.com
MichaelKaisers DanielHennes KaleshaBullard
GoogleDeepMind GoogleDeepMind GoogleDeepMind
Paris,France Zürich,Switzerland London,UnitedKingdom
mkaisers@google.com hennes@google.com ksbullard@google.com
KateLarson YoramBachrach
GoogleDeepMind GoogleDeepMind
Montreal,Canada London,UnitedKingdom
katelarson@google.com yorambac@google.com
ABSTRACT ACMReferenceFormat:
Thecoreisacentralsolutionconceptincooperativegametheory, IanGemp,MarcLanctot,LukeMarris,YiranMao,EdgarDuéñez-Guzmán,
SarahPerrin,AndrasGyorgy,RomualdElie,GeorgiosPiliouras,Michael
definedasthesetoffeasibleallocationsorpaymentssuchthatno
Kaisers,DanielHennes,KaleshaBullard,KateLarson,andYoramBachrach.
subsetofagentshasincentivetobreakawayandformtheirownsub-
2024.ApproximatingtheCoreviaIterativeCoalitionSampling.InProc.
grouporcoalition.However,ithaslongbeenknownthatthecore
ofthe23rdInternationalConferenceonAutonomousAgentsandMultiagent
(andapproximations,suchastheleast-core)arehardtocompute.
Systems(AAMAS2024),Auckland,NewZealand,May6–10,2024,IFAAMAS,
Thislimitsourabilitytoanalyzecooperativegamesingeneral,and 15pages.
tofullyembracecooperativegametheorycontributionsindomains
suchasexplainableAI(XAI),wherethecorecancomplementthe
Shapleyvaluestoidentifyinfluentialfeaturesorinstancessupport-
ingpredictionsbyblack-boxmodels.Weproposenoveliterative 1 INTRODUCTION
algorithmsforcomputingvariantsofthecore,whichavoidthe Coalitionalgametheorystudiesgamesplayedbyself-interested
computationalbottleneckofmanyotherapproaches;namelysolv- playerswhereincentivesarealignedandfully-bindingcontracts
inglargelinearprograms.Assuch,theyscalebettertoverylarge aresupported[21].Theutilityachieveddependsonwhichgroup,
problemsaswedemonstrateacrossdifferentclassesofcoopera- i.e.,whichcoalition,ofplayersisformedtosolvethegame.The
tivegames,includingweightedvotinggames,inducedsubgraph keyproblemthatresearchershavefocusedonishowthistotal
games,andmarginalcontributionnetworks.Wealsoexploreour utility should be divided among the individual members of the
algorithmsinthecontextofXAI,providingfurtherevidenceofthe team.Severalsolutionconceptshavebeenproposedtoaddressthis
powerofthecoreforsuchapplications. question,withthecore[40]andtheShapleyvalue[70]beingamong
thebestknown.TheShapleyvaluequantifiesthecontributionof
KEYWORDS eachindividualplayerviathedifferencesinvalueobtainedover
allpossiblesubgroupswhichincludeandexcludethatplayer.In
CooperativeGameTheory;Core;ExplainableAI
contrast, the core is a rough cooperative analogue of the Nash
equilibrium:autilitydivisionthatisstable,i.e.,nosubsetofplayers
hasincentivetodeviatefromthechosencoalition.
Proc.ofthe23rdInternationalConferenceonAutonomousAgentsandMultiagentSystems Cooperativegametheoryhasfoundmanyapplications,ranging
(AAMAS2024),N.Alechina,V.Dignum,M.Dastani,J.S.Sichman(eds.),May6–10,2024, fromanalyzingpowerindecisionmakingbodiesandpoliticalset-
Auckland,NewZealand.©2024InternationalFoundationforAutonomousAgentsand
MultiagentSystems(www.ifaamas.org). tings[71],throughpredictinghowplayersmayshareteampayoffs
4202
beF
6
]TG.sc[
1v82930.2042:viXraorcosts[32,53]toriskattribution[73].Oneprominentapplica- 2 BACKGROUND
tionofcooperativegametheoryisinanalyzingwhatdrivesthe Thecentralconceptincooperativegametheoryisthatofacoalition.
predictionsofmachinelearningmodels.Asmoreofourdecisions Givenasetof𝑛agents,𝐼 ={1,2,...,𝑛},acoalitionisasubsetof
arenowinformedbylearnedmodels,itiscrucialtounderstand agents,𝐶 ⊆𝐼,wherethegrandcoalitionisthecoalitioncontaining
whyourmodelsoutputwhattheydo,whichisthemaingoalof allagentsin𝐼.Acoalitionalgame,𝐺,isfurthercoupledwitha
explainableAI(XAI)[13].TheShapleyvaluehasbeenadoptedin characteristicfunction,𝑣 :2𝐼 →Rthatassignsarealvaluetoeach
themachinelearningcommunitytoexplainmodelpredictions[54]: coalitionofagents,representingthetotalutilitythatthecoalitionof
thefeaturesaretreatedasplayers,andthepayofftoacoalitionis agentsachievetogether.Westudytransferableutilitygames,where
theoutputofthemodelwhentrainingexclusivelyonthesubsetof 𝑣(𝐶) isinterpretedasvaluethatistobesharedandtransferred
inputfeaturesinthecoalition.TheShapleyvaluethencomputes betweenmembersofthecoalition𝐶.Asisstandard,𝑣(∅)=0.
themarginalcontributionofeachfeaturetotheoutput,offering Thecharacteristicfunctiononlydefinesthegainsacoalitioncan
additiveexplanationsfortheeffectofeachfeatureonprediction. achieve;itdoesnotdefinehowthesegainsaredistributedamong
However,therearesomelimitationsregardingShapleyvalues:it thecoalitionmembers.Animputation(alsocalledpayoffvector)
mayproducecounter-intuitiveexplanations[72],behavioralstudies 𝑝 = (𝑝1,...,𝑝 𝑛)isadivisionofthegainsofthegrandcoalition𝐼
h dia vv ie siosh no sw ,an ndth ae cc co ur re atc ea en stb ie mm ato iore np rere qd ui ic rt ei sve mo af nh yu sm aman plp ea sy [m 6,e 5n 5t
,
𝑝am to hn eg pt ah ye oa ffge on ft as g, ew nh te 𝑖r ,e an𝑝 𝑖 d≥ de0 n, os tu ec th ht eh pat ay(cid:205) o𝑛 𝑖 ff=1 o𝑝 f𝑖 a= co𝑣 a(𝐼 li) t. ioW ne 𝐶ca al sl
𝑖
56]1.Assuch,thecorehasbeenrecentlymotivatedasapossible
𝑝(𝐶)=(cid:205) 𝑖∈𝐶𝑝 𝑖.
alternativetoShapleyvaluesforXAI[78].UnlikeShapleyvalues, Abasicrequirementforagoodimputationisindividualrational-
thecorefocusesonstability[21]:apaymentdivisionisstableif ity,whichstatesthatforallagents𝑖 ∈𝐶,wehave𝑝
𝑖
≥𝑣({𝑖});oth-
noplayerhasincentivetodeviatefromthecoalitionandforma erwise,someagenthasincentivestoworkaloneinstead.Similarly,
differentoneontheirown.Consequently,corepaymentsmaybetter wesayacoalition𝐵blocksimputation(𝑝1,...,𝑝 𝑛)if𝑝(𝐵) <𝑣(𝐵),
reflecteachplayer’s“marketvalue”[25,68]. sincethemembersof𝐵cansplitfromtheoriginalcoalition,derive
Akeybarriertoapplyingcooperativegametheoryinpracticeis thegainsof𝑣(𝐵)byworkingtogetherandthenreallocatethisex-
thehighcomputationalcostassociatedwithcalculatingthevarious cess,𝑣(𝐵)−𝑝(𝐵) >0,toagentsin𝐵.Thisincentivetobreakaway
solutionconcepts,whichmaybehardtocomputeevenforvery andformnewcoalitionsleadstoinstabilityandhaslongbeena
restricted forms of cooperative games [21]. For some solutions, focusofcooperativegametheory.Themostprominentsolution
such as the Shapley value and other power indices, there exist conceptisthatofthecore[40].
efficientapproximationalgorithms[16,20],e.g.,anapproximate
formoftheShapleyvaluecanbecomputedusingMonteCarlo Definition1. Thecoreofacoalitionalgame𝐺 isthesetofall
sampling[6,39,56],whichmightexplainitswideadoption. imputationsthatarenotblockedbyanycoalition.Thatisitcontains
Incontrast,solutionsbasedonthecorehaveprovedtobemore imputation𝑝 =(𝑝1,...,𝑝 𝑛)ifandonlyifforall𝐶 ⊆𝐼,𝑝(𝐶) ≥𝑣(𝐶).
elusive;thereexistmultipleapproachesthatcanapproximateor
Unfortunately,thecorecanbeempty,meaningthatforevery
exactlysolveforthecore,butcanonlybeappliedtoveryrestricted
imputation,thereexistsablockingcoalition.Thus,relaxationsof
classesofcoalitionsgames[5,35,48,49].Computingthecoreex-
thecoreareoftenstudiedby,forexample,assumingthatthegains
actlyrequiressolvingalinearprogram(LP)withanexponential
madebyformingablockingcoalitionaresmall.The𝜖-coreallows
numberofconstraints(onepereachpossiblesubsetoftheagents).
forsuchslightrelaxationsoftheinequalitiesinthecoredefinition.
Alternatively,assumingaccesstoincrementallysampledcoalition
values,boundscanbegivenforlikelystablepaymentsthatrelateto Definition2. Given𝜖,the𝜖-coreofcoalitionalgame𝐺 isthe
thecore[11].Arecentbreakthroughinapproximatingthecoreisa setofallimputationssuchthatforany𝐶 ⊆𝐼,𝑝(𝐶) ≥𝑣(𝐶)−𝜖,i.e.,
MonteCarloalgorithmthatsamplescoalitionsinthisway,yielding 𝜖-cored=ef{(𝑝1,...,𝑝 𝑛) | 𝑝(𝐶) ≥𝑣(𝐶)−𝜖 ∀𝐶 ⊆𝐼}.
probabilisticboundsonapproximationquality[78].Thisapproach
significantlyexpandsthesetofgamesforwhichonecantractably Clearly,forlargeenoughvaluesof𝜖,the𝜖-coreisnon-empty.
approximatethecore,albeititstillrequiressolvingLPs,wherethe Furthermore,if𝜖 =0,thedefinitionofthe𝜖-coreisequivalentto
sizeoftheLPgrowslinearlyinthenumberofsamples. thecore.Anaturalquestioniswhatisthesmallest𝜖suchthatthe
Ourcontribution:Inthispaper,weintroducenoveliterative 𝜖-coreisnon-empty.Givenagame𝐺 weconsidertheset{𝜖|the
algorithmsforthecore.Noneofouralgorithmsrequiresolving 𝜖-coreofGisnotempty}.Itiseasytoseethatthissetiscompact,
alinearprogram:assuch,theyenjoygreaterscalingpotentialto andthushasaminimalelement𝜖 𝑚𝑖𝑛.
verylargeproblems.Wedemonstratethisefficiencyinpractice
Definition3. Givencoalitionalgame𝐺,define𝜖
min
=min{𝜖|
acrossseveralclassesofcoalitiongamesincludingweightedvoting
𝜖-coreof𝐺 isnon-empty}.Theleastcoreof𝐺 isthe𝜖 𝑚𝑖𝑛-coreof𝐺,
games[35],inducedsubgraphgames[28],marginalcontribution
andthisvalue𝜖 𝑚𝑖𝑛iscalledtheLeast-CoreValue(LCV)of𝐺.
networks [45], and apply them to feature-importance and data-
valuationproblemsarisinginXAI[13].
3 APPROXIMATINGTHECORETHROUGH
ITERATIVEPAYOFFADJUSTMENTSVIA
COALITIONSAMPLING
Earlierworkhasshownthatgivenagame𝐺,checkingifthecoreis
1SeeAppendixBforamorecomprehensivediscussionofthedifferencesbetweenthe
Shapleyvalueandthecore. non-emptyis𝑁𝑃-hard[28]and,furthermore,thatcomputingtheleast-coreexactlyisimpossible[12].Thisopensupthequestionwe Algorithm1𝜖-CoreviavonNeumann-Halperin
addressinthissection;howtobestapproximatetheleastcore. Input: Numberofiterations𝑇
Theleast-corecanbeformulatedasalinearprogramming(LP) 𝑝0= 𝑛1 1𝑛
problem.Let𝑐beabinarycoalition-membershipvectorforcoalition for𝑡 =1≤𝑇 do
𝐶 suchthat𝑐 𝑖 =1if𝑖 ∈𝐶 and0otherwise.Whenclearfromthe Selectcoalition𝐶(cyclically)asbinaryvector𝑐
contextwesometimesuse𝑐torepresentcoalition𝐶.Furthermore, 𝑑
𝑐
=max(0,𝑣(𝐶)−𝜖−𝑝⊤𝑐)
w fai ct th oo rut 1loss ifo nf eg ce en se sr aa rl yi .ty T, ha es nsu tm hee lt eh aa st t𝑣 -c( o𝐼) re= p1 ro,r be le-s mca il sin tg o𝑣 sow lvit eha 𝑝 𝑡 ←𝑝 𝑡−1+ |𝑑 𝐶𝑐 |𝑐
𝑣(𝐼) 𝑝 𝑡 ←ProjΔ(𝑝 𝑡)
endfor
min 𝜖 (1) Output: 𝑝 𝑇
𝑝,𝜖
𝑠.𝑡. 𝑣(𝑐)−𝜖−𝑝⊤𝑐 ≤0 ∀𝑐 (2)
𝑛 formsolutionthatcanbecomputedefficiently:
∑︁
𝑝 𝑖 =1 (3) (cid:40) 𝑝 𝑣(𝐶)−𝜖−𝑝⊤𝑐 ≤0
𝑝𝑖 𝑖=1
≥0 ∀𝑖 ∈𝐼. (4)
Proj𝑐,𝜖(𝑝)=
𝑝−(𝑝⊤𝑐+𝜖−𝑣(𝐶))/||𝑐||2𝑐 otherwise
𝑑
=𝑝+ 𝑐 𝑐 where|𝑐|=thesizeofthecoalition (5)
ThechallengeisthattheConstraint2relatesto2𝑛coalitions,mak- |𝑐|
ingitinfeasibletosolveforgameswithmanyplayers.Arecent andwhere𝑑
𝑐
=max(0,𝑣(𝐶)−𝜖−𝑝⊤𝑐)isthedeficit.If𝑣(𝐶)−𝜖−
methodtoapproximatingtheleast-corerandomlysamplessome 𝑝⊤𝑐 <0,playersincoalition𝐶arebeingpaidmorethantheyare
numberoftheconstraintsimposedonthecoalitionsandsolves actuallycontributing(wherethepaymentis𝜖+𝑝⊤𝑐).Intuitively,
theresultingLP[78].However,evenwhenonlyusingsub-sampled playersareincentivizedtoremaininacoalitionif𝑑
𝑐
=0,otherwise,
constraints,solvingLPsisstilltimeconsuming.2Wepresentalter-
thecoalitionisunstable.Algorithm1formalizesthismethod.
nativeiterativealgorithmsthatavoidtherequirementofsolving
theLP,circumventingasignificantcomputationalbottleneck.
Theorem1. Let𝑣 :2𝐼 →Rbeacharacteristicfunction.Givenan
Ouralgorithmsarepresentedinincreasingcomplexity.Ourfirst
𝜖andassumingthe𝜖-coreexists,Algorithm1convergestoan𝜖-core
twoalgorithms,IterativeProjections(Section3.1)andStochastic
imputationasymptotically,i.e.:lim 𝑇→∞𝑝
𝑇
→𝜖-core(𝑣).
SubgradientDescent(Section3.2)takeagivenvalueof𝜖andseek Proof. Wecanappealdirectlytoclassicalconvergenceresultsof
animputationinthe𝜖-core(assumingthe𝜖-coreisnon-empty).In thevonNeumann-Halperincyclicprojectionsalgorithm[10]. □
ordertocomputetheleast-core,onemayapplyanouterloopthat
callsthesemethodssoastoperformabinarysearchfortheminimal
value𝜖 yieldinganon-empty𝜖 -core.OurCoreLagrangian 3.2 The𝜖-CoreviaStochastic(Sub)Gradient
𝑚𝑖𝑛 𝑚𝑖𝑛
method(Section3.3)directlyreturnstheleast-core,includingboth Descent
the𝜖 𝑚𝑖𝑛(least-corevalue),andanimputationinthe𝜖 𝑚𝑖𝑛-core.Our Whileprojectinganimputation𝑝ontoahyperplanecanbecom-
empiricalresultsinSection4arereportedforthisalgorithmalone. putedefficiently,cyclingthroughallconstraintsisnot,anditisalso
computationallyexpensivetoupdate𝑝 onabatchofconstraints
3.1 The𝜖-CoreviaIterativeProjections asthatinvolvesprojecting𝑝intotheintersectionofasetofhalf-
spaces. Instead, we propose a new approach that re-formulates
WeobservethateachConstraint2on𝑝 representsahalf-space,
theprojectionproblemasanoptimizationproblemandadmitsan
namelyaconvexset.Assumingthatthereexistssome𝑝suchthat
efficientbatchalgorithm.
allconstraintscanbesatisfiedforagiven𝜖,thecorresponding
Wedefinealossfunction,ℓ 𝑐(𝑝,𝜖) foreachcoalition𝐶 (repre-
constraintsatisfactionproblemistofind𝑝suchthatConstraint2is
sentedbyvector𝑐):
satisfied.Thisisequivalenttosolvingaconvexfeasibilityproblem
byfindinga𝑝onthe(𝑛−1)-dimensionalsimplexΔthatlieswithin ℓ 𝑐(𝑝,𝜖)= 1 (cid:0)max(0,𝑣(𝐶)−𝜖−𝑝⊤𝑐)(cid:1)2 = 𝑑 𝑐2 . (6)
theintersectionofalltheseconvexsets,aproblemthatcanbesolved 2|𝑐| 2|𝑐|
viavonNeumann-Halperinmethodofcyclicalternatingprojec- Observethatif𝑣(𝐶)−𝜖−𝑝⊤𝑐 ≤ 0,ℓ 𝑐 =0,otherwise,weaccrue
tions[10,14,30].Westartwithaninitialguessfor𝑝andthencycle somepositivelossfornotsatisfyingtheconstraintforcoalition𝑐.
throughtheconstraints(foreachcoalition,𝐶),iterativelymodifying Furthermore,avalidnegative(sub)gradientofℓ withrespectto𝑝
𝑐
theguessbyprojectingitontothefeasiblesetrepresentedbyeach isexactlytheupdatedirectioncomputedbytheprojectionProj𝑐,𝜖
individualconstraint.Weobservethattheprojection,Proj𝑐,𝜖(𝑝), fromequation(5):
ofanimputation𝑝ontoahalf-space𝑝⊤𝑐 ≥𝑣(𝐶)−𝜖hasaclosed
𝑑
−∇𝑝ℓ 𝑐 = 𝑐 𝑐. (7)
|𝑐|
Therefore, if we run stochastic gradient descent (SGD) with
2MethodsthatguaranteepolynomialruntimeforsolvingLPs[47]havearuntime
learning rate equal to 1 on (cid:205) 𝑐ℓ 𝑐(𝑝), sampling one coalition at
a time, we recover Algorithm 1. However, it is also possible to
thatiscubicinthenumberofparameters.AnefficientimplementationoftheSimplex
method[22]ismuchfasterinpractice,butisstilltimeconsumingforlargeLPs. increasetheminibatchsize,samplingmultiplecoalitionsatonetime,asshowninAlgorithm2.Theorem2showsthatifAlgorithm2 objectiveandconstraintissufficientforoptimalityofthesolution
returnsanimputationthatisapproximatelyinthe𝜖-core,thenit tothecorrespondingLagrangianformulation(seeSec5.5of[18]):
p for uo nv dab il ny Ali pe ps ei nn dt ih xe A𝜖 .′ 1- .core,albeitwith𝜖′ >𝜖.Theproofcanbe
min max
L(𝑝,𝜖,𝜇)=𝜖+𝜇(cid:16)∑︁
ℓ
𝑐(𝑝,𝜖)−𝛾2(cid:17)
. (10)
𝑝∈Δ,𝜖∈[𝜖,𝜖]𝜇∈[0,𝜇]
𝐶⊆𝐼
Wecanboundboth𝜖and𝜇whichensuresthefunctionvaluesand
Algorithm2𝜖-CoreviaSGD
Input: Numberofiterations𝑇 g cora ad lii te in ot ns aa lr ce ob no su tn rad ie nd ta is sw tre ivll i. aL le lyt𝑣 sm aa tx isfi= em da ifx 𝐶 𝜖⊆ ≥𝐼𝑣 𝑣( m𝐶 a) x. ,T whe hn ile ev te hry e
Input: Batchsize𝐵 constraintassociatedwiththegrandcoalitioncannotbesatisfiedif
In 𝑝pu =t: 𝑛1S 1t 𝑛epsizeschedule𝜂 𝑡 𝜖 on< e0 c. oT nh ste rr ae if no tre i, sw ve ioc laa tn edbo ,u thn ed n𝜖 w∈ e[ w𝜖, a𝜖 n] t= 𝜇[ t0 o,𝑣 bm ea lx a] r. gF eo er n𝜇 o, uif go hn tl oy
for𝑡 =1≤𝑇 do forceanincreasein𝜖.Therefore,foranysingleviolatedcoalitional
Samplebatch𝐶 containing𝐵coalitions
Computeaverag𝐵 egradientoverbatch:∇𝑝 = 𝐵1 (cid:205) 𝐶∈𝐶𝐵∇𝑝ℓ 𝑐 1co −ns 𝜇tr (𝛾ai /n |𝐶t |a )ss to oc bia ete sd triw cti lt yh l𝐶 e, ssw te haw nan zet r∇ o.𝜖L Thi= s i1 m− pl𝜇 ie( s𝑑 𝑐 t/ h| a𝐶 t|) if< 𝜇
𝑝 ←𝑝−𝜂 𝑡∇𝑝 isatleast|𝐶|/𝛾,then𝜖 willincreaseinresponsetoanyviolated
𝑝 ←ProjΔ(𝑝)
constraint.Hence,weset𝜇=𝑛/𝛾 asanupperbound.
endfor WeobservethattheLagrangianformulationisconvexinthepri-
Sample𝑡∗ ∈{0,...,𝑇}accordingto𝑃(𝑡∗=𝑡)=
(cid:205)
𝑡𝜂 ′𝑡
𝜂
𝑡′.
malvariables(𝑝,𝜖)andconcaveinthedualvariable𝜇,henceequa-
Output: 𝑝 𝑡∗ tion(10)istypicallyreferredtoasaconvex-concavesaddle-point
problemwhichcanbeequivalentlyformulatedasamonotonevari-
√ ationalinequalityproblem[38],forwhichstochasticalgorithms
Theorem2. Ifℓ 𝑐(𝜖,𝑝) ≤𝛾2 forall𝑐,then𝑝isinthe(𝜖+ 2𝑛𝛾)- existincludingextragradient[51]andStochasticMirrorProx[46].
core. Algorithm4providespseudocodefortheprocess.Thekeystepis
Theorem3. Let𝑣 :2𝐼 →Rbeacharacteristicfunction.Givenan theUpdatefunction(Algorithm3)whichrequiresaProx𝑥 oper-
𝜖andassumingthe𝜖-coreexists,Algorithm2convergestoan𝜖-core atorandamonotonemapoperator𝐹.5 Invariationalinequality
imputationinexpectationatarateofO(𝑇−1/4). formulations𝑉𝐼(𝐹,X),theproblemistofind𝑥∗ ∈ X suchthat
⟨𝐹(𝑥∗),𝑥 −𝑥∗⟩ ≥ 0forall𝑥 ∈ X,andthemap𝐹 : X → R𝑛+2
Proof. Wecanappealdirectlytoconvergenceratesofstochas- istypicallywrittenasasinglevectorvaluedmapcontainingthe
ticprojectedsubgradientalgorithmsforconvexoptimization[24]. “descent”directionsofallvariables.Foroursetting,wecandefine
TheseratesproveAlgorithm2convergestoastationarypointwith 𝐹 asfollows:
√
d t 3O he .( e 3t1 e v/ rm io𝑇 Ti ln a) t he ie ot ex h np a Lote efc tht t ae he sd es tqs c -uq o Cau rr e oa er c rde o ed g nr asg a tr sd ra aid e ainnie St tn si a,st 𝑑 dpn 𝑐r do ,or d lpm eeo c. r PatR i y ooe snc iaa na sl ll tt Ooe Pq (𝑑 𝑇u r𝑐2a o−.t T 1 bi /o h l4n e e)r . m( e7 f) ort □eo , 𝐹(𝑥)=      −∇ ∇ ∇𝑝 𝜖 𝜇LL L      =        −(cid:16)1 (cid:205)− −𝜇 𝐶(cid:16) 𝜇 ⊆(cid:205) (cid:16) 𝐼(cid:205) ℓ𝐶 𝑐⊆ 𝐶 (𝑝𝐼 ⊆ ,𝐼| 𝜖𝑑 𝐶𝑐 )|𝑑| 𝐶 −𝑐 𝑐 |(cid:17) (cid:17) 𝛾2(cid:17)        (11)
 
Algorithms1and2assumean𝜖isprovidedsuchthatallconstraints where𝑥 = [𝑝,𝜖,𝜇] ∈X =Δ×[𝜖,𝜖]×[0,𝜇].Observethatwecan
representedbyConstraint2aresatisfied.3However,wearereally usesamplingofminibatchesofcoalitionstoMonteCarloestimate
interestedinfindingthesmallestsuch𝜖forwhichtheconstraints thesumsin𝐹(𝑥),e.g.,(cid:205) 𝐶⊆𝐼ℓ 𝑐(𝑝,𝜖)= 2 𝐵𝑛E 𝐶𝐵∼𝐼[(cid:205) 𝐶∈𝐶𝐵ℓ 𝑐(𝑝,𝜖)].
stillhold,i.e.theleast-corevalue(LCV).Tothisend,wereformulate
Lemma1. Themap𝐹 inequation(11)ismonotone,i.e.,⟨𝐹(𝑥)−
theoriginalLP,makinguseofasinglenon-linearconstraint:
𝐹(𝑥′),𝑥−𝑥′⟩ ≥0overall𝑥,𝑥′ ∈X.
min 𝜖 (8)
𝑝∈Δ,𝜖 TheproofofLemma1canbefoundintheAppendix.
𝑠.𝑡. ∑︁ ℓ 𝑐(𝑝,𝜖) ≤𝛾2 (9) Theorem4. Let𝑣 : 2𝐼 → Rbeacharacteristicfunction.Algo-
forsomeconstant𝛾
>0.Not𝐶 e⊆ t𝐼
hatif𝛾 =0,wewouldrecoverthe
r ai tth am ra4 tere od fu Oce (s 1t /h √e 𝑇du )a .litygapmax 𝜇′L(𝑝,𝜖,𝜇′)−min 𝑝′,𝜖′L(𝑝′,𝜖′,𝜇)
solutiontotheleast-coreLPin(1)-(4).For𝛾 >0,wecanrecoveran
approximatesolutionviaTheorem2.Whilethisformisnolonger Proof. Wecanappealdirectlytoconvergenceratesofmirror
anLP,itretainsacrucialproperty:convexity.Eachℓ 𝑐(𝑝,𝜖)isconvex proxalgorithmsformonotonevariationalinequalities[46]given
in𝑝and𝜖,andhencethenonlinearconstraint(cid:205) 𝐶⊆𝐼ℓ 𝑐(𝑝,𝜖)−𝛾2 wehavealreadyarguedabovethatthenormofthemap𝐹 andits
remainsconvexin𝑝and𝜖.SimilarlyObjective8isconvexasitis variancearebothfiniteandthemap𝐹 ismonotone(Lemma1). □
linearin𝜖and𝑝.Thisallowsustoviewtheoptimizationproblem
asasaddle-pointproblemusingLagrangemultipliers.4 Wefirst
Inexperiments,weuseatailoredProxoperator,specifically,
observethatviaKarush-Kuhn-Tuckerconditions,convexityinthe softmax(log(𝑝)−𝜂𝐹 𝑝(𝑦)),

43 NRe oc ta el tl ht ah ta wts eu ic nh tra on du𝜖 ci es tg hu ea cr oa nn ste tae nd tt 𝛾oe >xi 0st s.
oastoensureSlater’sconditionholdsso
Prox𝑥(𝜂𝐹(𝑦))=   

c cl li ip p( (𝜖 𝜇− −𝜂 𝜂𝐹 𝐹𝜖 𝜇( (𝑦 𝑦) ), ,𝜖 0, ,𝜖 𝜇) ),   

(12)
 
astomeetthenecessaryandsufficientconditionsforoptimalityofthesubsequent
saddlepointsolution[18]. 5See[58]forproximalpointapproachestosaddlepointproblems.Algorithm3Update availableforthatagent,andthethresholdisthetotalamountof
Input: Initialiterate𝑥,mapevaluationiterate𝑦,batchsize𝐵,step pooledresourcesrequiredtoaccomplishsometaskofinterest.
size𝜂,Proxoperator Inourexperiments,eachagent𝑖hasaweight𝑤 𝑖 ∈{1,2,···,100}
Samplebatch𝐶 containing𝐵coalitions drawnuniformlyatrandomandwesetthequota𝑞 = 𝜉𝑛E[𝑤 𝑖],
𝐵
Compute𝐹(𝑦)usingbatchofcoalitions where𝜉istheproportionalthreshold(fractionoftheexpectedtotal
𝑥′ ←Prox𝑥(𝜂𝐹(𝑦)) weight).Weuseproportionalthresholds𝜉sampleduniformlyatran-
Output: 𝑥′
domintherange[0.1,0.9].Thereare2100coalitionsandthus2100
constraintsintheLPformulationoftheleastcore(Constraint2),
soexactlysolvingfortheleast-coreiscomputationallyinfeasible.
Algorithm4Least-CoreviaMirrorProx(CoreLagrangian) WecomparedourmethodtoYanandProcaccia’srecentalgo-
rithmforapproximatingtheleastcore[78].Theiralgorithmsamples
Input: Numberofiterations𝑇,batchsize𝐵,stepsizeschedule𝜂 𝑡
𝑝0= 𝑛1 1𝑛 a strs au ib ns te st bo uf ilc to oa nl li ytio frn os man thd er se at mur pn ls edth se ubL sP ets .o Wlu itt hio hn igb has pe rd obo an bic lo itn y-
,
𝜖0=𝜖
thismethodisguaranteedtoreducetheapproximationerrorasthe
𝜇0=𝜇
numberofcoalitionssampledincreases[78,Theorem1].
𝑥0= [𝑝0,𝜖0,𝜇0]
ItisdifficulttocompareiterationsofCLtothenumberofsampled
for𝑡 =1≤𝑇 do
𝑥′ ←Update(𝑥 𝑡−1,𝑥 𝑡−1,𝐵,𝜂) coalitionsusedinLP;instead,wechoseanumberofsampledcoali-
𝑥
𝑡
←Update(𝑥 𝑡−1,𝑥′,𝐵,𝜂) tions𝑘andrecordedthewallclocktimetakenbytheLPmethod
for each value of𝑘, say𝑡 seconds. Then, we let CL run for𝑡
endfor 𝑘 𝑘
Computeweightedaverageofimputations:𝑝∗= 𝜂𝑡𝑝𝑡 . secondsandretrievedthesolutionafterthatamountofelapsed
(cid:205) 𝑡′𝜂 𝑡′ time.TheLPmethodusedCVXPY[31]whileourCLcodeusedJAX
Output: 𝑝∗
andoptax[4].Foreach𝑡 ,bothmethodsreturnedanimputation,
𝑘
𝑝 and𝑝 ,respectively.Foreachimputationwecomputedits
𝐿𝑃 𝐶𝐿
respective(average)𝜖value.Duetothesizeofthegametheerrorof
where𝐹 𝑧(𝑦)retrievesthepartofthevectoroutput𝐹(𝑦)correspond-
thesolutioncannotbecomputedexactly,soweapproximatedthe
ingtothevariable𝑦andsoftmax(𝑠)= [ (cid:205)𝑒𝑠 𝑒1 𝑠𝑗,..., (cid:205)𝑒𝑠 𝑒𝑛 𝑠𝑗]. valueof𝜖bysamplingasetof50,000coalitions,𝐶˜,andcomputing
𝑗 𝑗
InstructionsforacceleratingourproposedalgorithmsonGPUs/T- 𝜖ˆ(𝑝,𝐶ˆ )=max 𝑐∈𝐶ˆ(𝑣(𝑐)−𝑝⊤𝑐).Figure2summarizesourfindings.
PUsareinAppendixA.2.Hyperparametersincluding,e.g.,learning Inparticular,weobservedasignificantimprovementinthecore
rateschedules,usedinexperimentsarefoundinAppendixA.3. approximationwhenusingourmethod(CL)asopposedtotheLP-
basedmethod.Wedidobserve,however,thatthethresholdaffects
4 EMPIRICALANALYSIS thedegreetowhichCLoutperformstheLP-basedmethod.Inpar-
Wetestedouralgorithm,CoreLagrangian(CL)(Alg.4),onarange ticular,whenthethresholdwascloseto50%ofthetotalexpected
ofcooperativegamesandreportourfindingshere.Inourfirstsetof weight,theLP-basedmethodwouldsometimesoutperformCL.
experimentswecomparedtheperformanceofCLtothatofarecent
state-of-the-artalgorithmforapproximatingtheleast-corewhich 4.2 AnalyzingStabilityinCompactGame
reliesonsolvingtheLPusingsampledcoalitions[78](Section4.1). Representations
Wethenuseouralgorithmasatooltostudythestabilityproperties
Aftervalidatingthatouralgorithmcaneffectivelysolvelargeco-
ofanumberofprominentcooperative-gameclasses,illustrating
operativegames,showingimprovementsoverastrongbaseline,
thebenefitsofhavingalgorithmsforapproximatingthecorefor
wefurtherillustrateitsvaluebymakingarigorousstudyacross
largegames(Section4.2).Finally,weexamineapplicationsofour
prominentclassesofcooperativegamestobetterunderstandhow
algorithmsforexplainableAI(XAI)purposes(Section5).
differentgame-featuresaffectstability.
4.1 TimingSampledLPsvs.CoreLagrangian 4.2.1 WeightedVotingGames. Inourfirstsetofexperimentswe
studiedhowstabilitywasimpactedbydifferentparameterizations
TotesthowefficientCLisinpractice,weevaluateitsperformance
ofweightedvotinggames,definedinSection4.1.Sincewewere
acrossverylarge(𝑛=100)instancesofweightedvotinggames.
runningmultipleexperiments,wesetthenumberofagentstobe𝑛=
Definition4. ([21,Definition4.1])Aweightedvotinggame𝐺 15,butdrewagents’weightsfromdifferentdistributionsandvaried
isatuple (𝐼,w,𝑞) where𝐼 = {1,2,···,𝑛} isasetofagents,w = theproportionalquota,𝜉.Figure1presentsourresults.Wesample
(𝑤1,𝑤2,···,𝑤 𝑛) ∈ℜ𝑛 isavectorofweights(oneperplayer),and 10,000gamesforeachparameterconfiguration,andexaminethe
𝑞 ∈ℜisaquota.Thecharacteristicfunctionis averageleast-corevalueinthesegames.Wefirstnotethatregions
thathavealowleast-corevalue(blue)arestableorverycloseto
𝑣(𝐶)=(cid:26) 1 if(cid:205) 𝑐∈𝐶𝑤
𝑐
≥𝑞;
beingstable,whereashigh𝜖-coreindicateregionsofinstability.
0 otherwise.
Second,weobservethatthethresholdgreatlyaffectedthestability
Weightedvotinggamesarewellstudiedintheliterature(e.g.,[3, ofaninstance.Ifthethresholdwaslow,manycoalitionsformand
34,66,69,74,80])andcanmodelreal-worldscenariossuchasthe achievethemaximumcoalitionalvalueof1.Ifthethresholdwas
EuropeanUnionvotingsystem[17,64],ormultiagentresourceal- veryhigh,inexpectationtheonlysuccessfulcoalitionwasthegrand
locationproblemswhereanagent’sweightcorrespondtoresources coalition,reducingthelikelihoodofblockingcoalitions.4.2.2 GraphGames. Inmanycooperativegames,relationshipsbe-
Core Approximation Quality ( )
tweenagentsaremodelledviaagraph𝐺 = ⟨𝑉,𝐸⟩(e.g.,[7,8,19,
0.50 LP 27,28,61,65,67]).Ininducedsubgraphgames[28],theagentsare
CL representedbyverticesofthegraphandtheedgeweight,𝑤(𝑒)for
0.48
𝑒 =(𝑖,𝑗),indicatesthevaluethatagents𝑖and𝑗accruefrombeingin
0.46 thesamecoalition.Anabsenceofanedgeimpliesthereisnointerac-
tionbetweenapairofagentsandthus,nolossorbenefitfrombeing
0.44
inthesamecoalition.Givengraph𝐺,thecharacteristicfunctionfor
0.42 theinducedcooperativegameis𝑣(𝐶)=(cid:205) 𝑒∈{(𝑖,𝑗)∈𝐸|𝑖,𝑗∈𝐶}𝑤(𝑒).
Weconductanempiricalstudytobetterunderstandhowthe
0.40
underlyinggraphstructureinfluencesthestabilityofthegame.
0 25 50 75 100 125
Wall Clock Time (seconds) Tothisend,weselectacollectionofwell-knownparameterized
randomgraphmodels,eachwithdifferentproperties,andgenerate
Figure 2: Approximate 𝜖 of the linear program (LP) ver- 80cooperativegraphgamesforeachparameterization,measuring
theirstabilitybycomputingtheirleast-corevaluesviaouralgorithm
susthecoreLagrangian(CL)methodasafunctionofcom-
putation time (seconds). The 𝑥-axis corresponds to wall- CL.Weset𝑛 = 32,andgenerateedgeweightswithaGaussian
clocktimetakenbybothalgorithmsrunside-by-sidegiven
distributionwithvariance𝜎 =1.0(unlessspecifiedotherwise)and
𝑘 ∈ {500,1000,2000,4000,8000,16000} sampledcoalitionsfor positivemean𝜇chosensuchthat60%ofedgeweightsarepositivein
theLPmethod,𝑡 𝑘.Abettercoreapproximationqualityis
expectation.6AllgraphsweregeneratedusingtheNetworkXlibrary
reflectedinhavingalower𝜖 forthesameruntime.The𝑦- [41].Wepresentresultsontwograph-classes,Erdős-Rényi[37]and
axisrepresentstheapproximate𝜖oftheleast-coresolution NewmanWattsStrogatz[62],anddiscussfouradditionalmodels
found,𝜖ˆ(𝑝 𝐿𝑃,𝐶ˆ )and𝜖ˆ(𝑝 𝐶𝐿,𝐶ˆ ),computedoverthesamesetof inAppendixC.
50,000coalitions,𝐶ˆ .Eachdatapoint(𝑡 𝑘,𝜖ˆ(𝑝 𝑥,𝐶ˆ ))represents IntheErdős-Rényigraphmodelthereisasingleparameter𝑝,
anaverageoverthesamesetof2,500randomweightedvoting whichindicatestheprobabilitythatforanypairofvertices,𝑥,𝑦,
thereisanedgeconnecting𝑥and𝑦.Inourexperimentswevaried𝑝
gameswithshadingindicatingstandarderrorofthemean.
from0.0to1.0,andvariedthevariance𝜎oftheweightdistribution
from1.0to3.0.OurresultsareshowninFigure1d.Weobservethat
thestabilityofthegamesgenerateddependsonboth𝑝and𝜎.In
particular,gameswithhighweightvarianceforedgeweights,and
In Figure 1(a) we present results where the agents’ weights highuncertaintyastowhetheranedgewouldformbetweenany
weregeneratedbyaGaussiandistributionwith𝜇 = 1.0and𝜎 ∈ pairofvertices(i.e.,for𝑝 ∈ [0.4,0.7])arelessstable.
[0.01,0.3].Weobservethatforafixedquota,highweight-variance TheNewmanWattsStrogatzmodelgeneratesgraphswiththe
leadstolessstablegames.Figure1(b)presentsresultswhenagents’ small-worldpropertyandconsistsoftwoparameters.Aninstance
weightsweredrawnfromanexponentialdistributionwith𝜆 ∈ ofagraphisinitializedasaringandconnectedwithits𝑠⌊𝑘 ⌋nearest
[0.25,2.50].Weobservethatas𝜆increaseswefindlessstablegames. neighbours.Additionaledgesinthegraphareaddedwith2
probabil-
Wehypothesizethatsinceagentweightsaremoreconcentrated
ity𝑝.Figure1epresentsourresultsaswevaried𝑘from4to24,and
aroundlowvalues,possiblesuccessfulcoalitionsoftenshareagents,
𝑝 ∈ [0.0,1.0].Thevarianceoftheedge-weightdistributionwas
openingupthepossibilityoftheformationofblockingcoalitions.
fixedat𝜎 =1.0.Inparticularweobservethatbothparameters𝑝
Finally,inFigure1(c)wepresentresultswhereweusedaBetadis-
and𝑘positivelycorrelatewithstabilityinthesegraphs.
tributionwithparameters(𝛼,𝛽).Wenoticeadifferenceinstability
ofgameswhentheparametersareeitherlessthan1.0orgreater
than1.0.Ifboth𝛼 and𝛽arehigh,gamesarelessstable.However,
6Ifgraphgameshaveonlypositiveedgeweights,thenthecoreisnon-empty,i.e.the
thereisaregionofstabilitywhen𝛼 >1.0and𝛽 <1.0 least-corevalueis0.0[28].
00 .. 55 02 0000 .... 4455 6802 00 .. 57 00 0000 .... 2468 12 .. 00 50 000 ... 345 00001 ..... 24680 123 000 ... 000 1122 2604
8
45 .. 00
0.48 0.44 0.30 0.0 0.10 0.2 0.0 0.0 4 3.0
0.01 0.15 0.30 0.25 1.38 2.50 0.10 1.05 2.00 1.0 2.0 3.0 0.0 0.5 1.0
𝜎 𝜆 𝛼 𝜎 𝑝
(a)Gaussian(𝜇=1.0) (b)Exponential (c)Beta(𝜉=0.25) (d)Erdős-Rényi (e)NewmanWattsStrogatz
(𝜎=1)
Figure1:(a)-(c)Heatmapsillustratingtheimpactofparameteraxesontheleast-corevalue(incolor)inthreeweightedvoting
games.(d)-(e)Meanleast-corevalueforErdős-RényiandNewmanWattsStrogatzwhensweepingovertwohyperparameters.
Constanthyperparametersareshowninparenthesis.
𝜉
etamixorppA
𝜉 𝛽 𝑝 𝑘Moregenerally,theseresults(alongwithfurtherresultsinAp- takingsomeoriginalinstancefromthedataset,fixingthevalues
pendixC)showtheinterplaybetweentheparametersofrandom- ofallfeaturesin𝐶,andreplacingthevaluesoffeaturesnotin𝐶
graphgeneratorsandthestabilityoftheinducedcooperativegame. byrandomlysamplingotherinstances.7Givenadatasetcontain-
Webelievethatfurtherresearchinthisareaiswarranted,butalso ing𝑑 instances,suchananalysisresultsin𝑓 featureimportance
emphasizethatsuch empiricalanalysiscanonly be carriedout measurespereachinstance,resultingin𝑑·𝑓 feature-importance
whenusingalgorithmsfortractablysolvingcooperativegamesat measures,illustratingtheimportanceofhavingscalablesolutions
scale,suchasthealgorithmswehaveproposed. forcomputingboththeShapleyvalueandleast-core.
Figure3presentsresultsshowingthecorrelationbetweenShap-
5 EXPLAINABLEAI leyfeature-importanceandleast-coremeasures,overallthein-
stancesineachdataset.Wepresentthedatausingcontourplots
Cooperative game theory has played an important role in the
duetothesheernumberofdata-points.Similartoourfindingsfor
developmentofexplainableAI(XAI)throughtheapplicationof
theglobalexplainabilityproblem,weobservepositivecorrelation
theShapleyvaluetofeature-attributionanddata-valuationprob-
betweenleast-coreandShapleyvalue.Notethattheleastcorere-
lems[1,2,23,54].Howeverresearchershavealsoidentifieddis-
turnsnon-negativepayoffs,whichexplainsthebendinthetrend
advantagesofShapley-basedanalysis,suchasgeneratingcounter-
attheorigin.
intuitiveexplanationsinvariouscases[72].Arecentpaperargued
thatthecoremayprovideanalternativetotheShapleyvaluefor
XAI applications. In this section we explore this idea, applying 5.3 DataValuation
ouralgorithm,CL,forcomputingtheleast-coreonthreedifferent Inthedatavaluationproblem,theimportanceofeachdatapoint
real-worlddatasets:BostonHousingdataset[42](priceregression), inthetrainingsetismeasured.Thisproblemcanbeformulatedas
Diabetesdataset[33](classification)andtheWisconsinBreastCan- acooperativegamebydefiningacoalition,𝐶,tobeasetofdata
cerdataset[77](classification).Ourgoalistobetterunderstand points,withcharacteristicfunction,𝑣(𝐶),beingthequalityofthe
howtheShapleyvalueandthecorearesimilarordifferentintheir modeltrainedonlyondatapointsin𝐶.Thecore(orleastcore)isa
relativeassessmentoftheimpactofdifferentfeaturesordatapoints particularlycompellingsolutionforthedatavaluationproblemas
haveonthequalityoftrainedmodels,specifically,scikit-learn’s imputationsinthecorecanbeinterpretedaspricesthatmustbe
defaultlinearorlogisticregressionmodels[63]. paidtodataproviderssoastoensurethedataisavailable(e.g.,inthe
samewaythatcore-pricingisusedinpackage-auctions[25,26]).
5.1 GlobalExplainability Weconductedaseriesofdata-valuationstudiesacrossdifferent
datasets.WeusedasimilarmethodolgyasYanandProcaccia[78]:
Intheglobalexplainabilityproblem,afulldatasetisusedtode-
weimposedabudgetof50,000callstothecharacteristicfunction,
termine which features have high impact on the quality of the
limitingthenumberofpermutationssampledfortheShapleyvalue
trainedmodel.Weformulatethisasacooperativegamebydefining
approximationanditerationsforourleast-corealgorithm,CL.We
acoalition,𝐶,tobeasubsetoffeaturesand𝑣(𝐶)tobethequality
thensortedthedatabyimportanceaccordingtotheShapleyvalue
ofthemodeltrainedonlyonfeaturesin𝐶.Qualitymaybemea-
andleast-core,andretrainedthemodelsbyremovingthemost
suredastheaccuracyinclassificationtasks,orasthecoefficient
ofdetermination𝑅2forregressiontasks.ComputingtheShapley importantdatainblocksof5%atatime.
ResultsareshowninFigure4.Inparticular,theseshowdata
valueortheleast-coreforthisgamereturnsindividualvalues,one
pointsdeemedmostimportantbytheleast-corearemorecritical
per each feature, which are can be interpreted as a measure of
tomodelperformancethanthoseselectedaccordingtoShapley
feature-importance.
value.Thesefindingsareconsistentwithpreviousliterature[78].
Figure3presentsascatterplotshowingthecorrelationbetween
However,wealsoappliedthisprocesstootherdatasetsincludingan
thefeature-importancemeasuresreturnedbyapplyingtheShapley
evaluationproblemforlargelanguagemodels(LLMs),presentedin
valueandthoseproducedbytheleastcore(usingouralgorithm).
AppendixD.2.There,theresultsaremorenuancedinthatthereexist
Everypointrepresentsasinglefeature,withthe𝑥-axisreflectingits
scenarioswhereaShapleyvalueapproachisbetteratidentifying
importanceaccordingtotheShapleyvalueandthe𝑦-axisreflecting
key data points. These results open up new research questions
itsimportanceaccordingtotheleastcore.Thetwoimportance
aroundcharacterizationsastowhenShapley-basedorcore-based
measures are correlated, but reflect a different order of feature
datavaluationismoreappropriate.
importance.Interestingly,thecorrelationishighwhentherearea
fewdominantfeatures(Figures3a,3b),butnotasstronginthecase 5.3.1 EloRatingsonChatbotArenadataset. Wenowdescribean-
wherethepredictionsaredrivenbymanyfeatureswherenoneof otherdatavaluationexperimentthatdiffersfromtheothersinthat
thefeaturesisdominant(Figure3c). itisnotatraditionalregressionnorclassificationtask.TheChatbot
Arenadatasetiscomposedofhumansratingthequalityofanswers
5.2 LocalExplainability toquestionsto20differentlargelanguagemodels(LLMs)[79].Each
Inthelocalexplainabilityproblem,thefocusisonthepredictiona datapointconsistsofaquestionandtwoanswers:eachanswer
trainedmodelmakesonanindividualinstance.Itseekstodeter- generatedbytwodifferentLLMs.Thehumanthenpickswhich
minehowthevaluesofindividualfeaturesincreaseordecrease answeristhebestoneandthisisrecordedasawinfortheLLMthat
themodel’spredictionforsomeinstance.Wedefineacooperative
gamewhereacoalition,𝐶,isasetoffeaturesandthecharacteristic
7Inourexperimentswiththeleastcore,weusetheversionwherenon-coalition
featuresaretakenfromarandominstanceselectedfromthe10%oftheinstanceswith
functionisthemodel’spredictiononanewinstance,createdby thelowestprediction.(a)BostonHousing(global/local) (b)Diabetes(global/local) (c)BreastCancer(global/local)
Figure3:CorrelationofShapleyandCoreimportancemeasuresoffeaturesatbothglobaldatasetandindividualinstancelevels.
(a)BostonHousing (b)BreastCancer (c)ChatBotArena
Removal of Most Important Data Points Removal of Most Important Data Points Removal of Most Important Data Points
Boston Housing (Budget = 50000) Breast Cancer (Budget = 50000) Chatbot Arena (Budget = 50000)
0.7 Shapley 0.97 1.10
Least Core 0.6 1.05
0.96
0.5 0.95 1.00
Shapley Shapley
0.4 0.94 Least Core 0.95 Least Core
0 10 20 30 40 50 0 10 20 30 40 50 0 10 20 30 40 50
Data removal percentage Data removal percentage Data removal percentage
Figure4:DataValuationontheBostonHousing,Diabetes,andChatBotArena.Errorbarscorrespondto95%confidence
intervals(1000repeats).
generatedthebetterresponseandalossfortheonethatgenerated 6 CONCLUSION
theworseresponse.Intotal,thedatasetconsistsof33000data Weexaminedthecore,adistributionofpayoffovermembersin
points. acoalitionthatisacentralsolutionconceptincooperativegame
ThesupervisedlearningproblemistolearnanElorating[36] theory.Weproposedascalablesolverfortheleastcorethatcan
foreachLLMthatcanberankedtocomparethe“skilllevel”(in handletheexponentialnumberofpossiblecoalitionsthatdefinethe
thiscontext:propensitytogeneratethebetteranswer)ofeachLLM. coreconstraints.Weprovidedconvergenceratesandguarantees
Eloisclassicratingsystemthatwasproposedforrankingchess forthissolverandshowedempiricallythatitisfasterthanprevious
engines;eachLLMisassignedarating,say𝑟 𝑖 and𝑟 𝑗,thatmodels coresolvers[78].
theprobabilityofLLM𝑖beatingLLM𝑗asalogisticfunctionofthere Ourempiricalanalysisshowsseveralapplicationsofourcore
ratings,Pr(ibeatsj) = 𝜎(cid:0)(𝑟 𝑖 −𝑟 𝑗)/400(cid:1) = 1+𝑒(𝑟𝑗1 −𝑟𝑖)/400,where𝜎 solver,includingstudyingstabilityofprominentformsofcoalitional
isthesigmoidfunction𝜎(𝑥) = (1+𝑒−𝑥)−1.Theratingscanbe gamesandexplainableAI(XAI)problems.ForXAI,wehighlighted
learnedusingonlineupdates,ormorepreciselygivenabatchof thatanalysisbasedonthecorediffersfromthecurrentde-facto
datausinglogisticregressionorminorization-maximization(MM) standardbasedontheShapleyvalue.Further,forthepurposeof
algorithms[44]. dataevaluation,ourresultsindeedshowthatincertaincasesthe
Weapplydatavaluationinasimilarwayasbefore.Foreach coreoutperformstheShapleyvalueasawayofselectingthedata
experiment,wefirstsampleatrainingsetandtestsetpair(D𝑅,D𝑇), instancesfortrainingmachinelearningmodels.
with|D𝑅|=1000and|D𝑇|=10000.Acoalitionisthenasubsetof Severalproblemsremainopenforfutureresearch.First,could
datapointsfromthistrainingset,𝑐 ⊆D𝑅,leadingtoa1000-player onederiveevenfasteralgorithmsforapproximatingthecore(in
coalitionalgame.Asintheothersettings,thecharacteristicfunction termsoftheworst-caseperformance,orintermsofempiricalper-
isameasureofhowwellthemodellearnedon𝑐performsonthetest formanceonproblemsofinterest)?Second,couldbetterapproxima-
setD𝑇.Foreachcoalition,𝑐,weruntheMMmethod[44]for20000 tionalgorithmsforthecorebetailoredtospecificclassesofgames?
iterationstolearnEloratingsofthebatchofdata𝑐 ⊆D𝑅.Giventhe Third,couldoneextendouranalysistootherknownformsofcoop-
learnedratings𝑟(cid:174)𝑐,wecomputetheaveragecrossentropylossover erativegamestodeterminethekeyfeaturesthataffectcoalitional
thetestset,𝐿 𝐶𝐸(𝑟(cid:174)𝑐,D𝑇).Finally,wedefinethethecharacteristic stabilityinthem?Fourth,ouranalysishasidentifiedwaysofse-
functionforas𝑣(𝑐)=2−𝐿 𝐶𝐸(𝑟(cid:174)𝑐,D𝑇).Asbeforewesetabudget lectingdatafortrainingmodels.Couldoneleveragesuchresultsto
of50000callstothecharacteristicfunctionforbothShapleyand speedupthetrainingorruntimeperformanceofmachinelearning
theleastcorecomputations.Figure4cshowsthatincontrasttothe models?Finally,whenisitbettertousethecoreandwhenisitbet-
otherdatasetsandexperimentsin[78],theShapleyvaluesattribute tertousetheShapleyvalueforfeatureimportancemeasurements
importancesthataremorecriticaltomodelperformancethanthe ordataselection?
leastcore.
erocs
ledoM
erocs
ledoM
erocs
ledoMREFERENCES 2016IEEESymposiumonSecurityandPrivacy(SP).IEEE,598–617.
[1] LiatAntwarg,RonnieMindlinMiller,BrachaShapira,andLiorRokach.2019. [24] DamekDavisandDmitriyDrusvyatskiy.2018.Stochasticsubgradientmethod
ExplaininganomaliesdetectedbyautoencodersusingSHAP. arXivpreprint convergesattherateO(𝑘−1/4)onweaklyconvexfunctions. arXivpreprint
arXiv:1903.02407(2019). arXiv:1802.02988(2018).
[2] AlejandroBarredoArrieta,NataliaDíaz-Rodríguez,JavierDelSer,AdrienBen- [25] RobertDayandPaulMilgrom.2008.Core-selectingpackageauctions.interna-
netot,SihamTabik,AlbertoBarbado,SalvadorGarcía,SergioGil-López,Daniel tionalJournalofGameTheory36(2008),393–407.
Molina,RichardBenjamins,etal.2020.ExplainableArtificialIntelligence(XAI): [26] RobertW.DayandPeterCramton.2012. QuadraticCore-SelectingPayment
Concepts,taxonomies,opportunitiesandchallengestowardresponsibleAI.In- RulesforCombinatorialAuctions.OperationsResearch60,3(2012),588–603.
formationFusion58(2020),82–115. [27] GabrielleDemange.2004. OnGroupStabilityinHierarchiesandNetworks.
[3] HarisAziz,YoramBachrach,EdithElkind,andMikePaterson.2011.False-name JournalofPoliticalEconomy112,4(2004),754–778.
manipulationsinweightedvotinggames.JournalofArtificialIntelligenceResearch [28] XiaotieDengandChristosH.Papadimitriou.1994.Onthecomplexityofcooper-
40(2011),57–93. ativesolutionconcepts.Math.Oper.Res.19,2(1994),257–266.
[4] IgorBabuschkin,KateBaumli,AlisonBell,SuryaBhupatiraju,JakeBruce,Peter [29] G.d’EonandK.Larson.2020.TestingAxiomsAgainstHumanRewardDivisions
Buchlovsky,DavidBudden,TrevorCai,AidanClark,IvoDanihelka,Antoine inCooperativeGames.InProceedingsoftheNineteenthInternationalConference
Dedieu,ClaudioFantacci,JonathanGodwin,ChrisJones,RossHemsley,Tom onAutonomousAgentsandMulti-AgentSystems(AAMAS).
Hennigan,MatteoHessel,ShaoboHou,StevenKapturowski,ThomasKeck,Iurii [30] FrankDeutsch.1995.Dykstra’scyclicprojectionsalgorithm:therateofconver-
Kemaev,MichaelKing,MarkusKunesch,LenaMartens,HamzaMerzic,Vladimir gence.ApproximationTheory,WaveletsandApplications(1995),87–94.
Mikulik,TamaraNorman,GeorgePapamakarios,JohnQuan,RomanRing,Fran- [31] StevenDiamondandStephenBoyd.2016.CVXPY:APython-embeddedmodeling
ciscoRuiz,AlvaroSanchez,LaurentSartran,RosaliaSchneider,ErenSezener, languageforconvexoptimization.JournalofMachineLearningResearch17,83
StephenSpencer,SrivatsanSrinivasan,MilošStanojević,WojciechStokowiec, (2016),1–5.
LuyuWang,GuangyaoZhou,andFabioViola.2020.TheDeepMindJAXEcosystem. [32] PradeepDubey.1982.TheShapleyvalueasaircraftlandingfees–revisited.Man-
http://github.com/deepmind agementScience28,8(1982),869–874.
[5] YoramBachrach.2011.Theleast-coreofthresholdnetworkflowgames.InInter- [33] BradleyEfron,TrevorHastie,IainJohnstone,andRobertTibshirani.2004.Least
nationalSymposiumonMathematicalFoundationsofComputerScience.Springer, angleregression.(2004).
36–47. [34] EdithElkind,LeslieAnnGoldberg,PaulWGoldberg,andMichaelWooldridge.
[6] YoramBachrach,EvangelosMarkakis,EzraResnick,ArielDProcaccia,JeffreyS 2009. Onthecomputationalcomplexityofweightedvotinggames. Annalsof
Rosenschein,andAminSaberi.2010.Approximatingpowerindices:Theoretical MathematicsandArtificialIntelligence56(2009),109–131.
andempiricalanalysis.AutonomousAgentsandMulti-AgentSystems20(2010), [35] E.ElkindandD.Pasechnik.2009.Computingthenucleolusofweightedvoting
105–122. games.InProceedingsoftheNineteenthAnnualACM-SIAMSymposiumonDiscrete
[7] YoramBachrachandElyPorat.2010.Pathdisruptiongames.InProceedingsof Algorithms.SocietyforIndustrialandAppliedMathematicsPhiladelphia,PA,
USA,327–335.
the9thInternationalConferenceonAutonomousAgentsandMultiagentSystems:
volume1-Volume1.1123–1130. [36] ArpadE.Elo.1978.TheRatingsofChessPlayers,PastandPresent(2nded.).Arco
[8] YoramBachrachandJeffreySRosenschein.2007.ComputingtheBanzhafpower Publishing,Inc.
indexinnetworkflowgames.InProceedingsofthe6thInternationalJointConfer- [37] LászlóErdős,AnttiKnowles,Horng-TzerYau,andJunYin.2013.Spectralstatistics
enceonAutonomousAgentsandMultiagentSystems.1–7. ofErdős–RényigraphsI:Localsemicirclelaw.(2013).
[9] Y.;BachrachandJ.S.Rosenschein.2008.CoalitionalSkillsGames.InProceedings [38] FranciscoFacchineiandJong-ShiPang.2003. Finite-DimensionalVariational
ofthe7thInternationalConferenceonAutonomousAgentsandMulti-AgentSystems
InequalitiesandComplementarityProblems.Springer.
(AAMAS).1023–1030. [39] ShaheenSFatima,MichaelWooldridge,andNicholasRJennings.2008.Alinear
[10] CatalinBadeaandDavidSeifert.2016. Rittoperatorsandconvergenceinthe approximationmethodfortheShapleyvalue.ArtificialIntelligence172,14(2008),
methodofalternatingprojections.JournalofApproximationTheory205(2016), 1673–1699.
133–148. [40] DonaldBruceGillies.1953.Sometheoremsonn-persongames.Ph.D.Dissertation.
[11] Maria-FlorinaBalcan,ArielProcaccia,andYairZick.2015.LearningCooperative PrincetonUniversity.
Games.InProceedingsoftheTwenty-FourthInternationalJointConferenceon [41] AricA.Hagberg,DanielA.Schult,andPieterJ.Swart.2008.ExploringNetwork
ArtificialIntelligence(IJCAI2015).475–481. Structure,Dynamics,andFunctionusingNetworkX.InProceedingsofthe7th
[12] U.;Balkanski,E.;SyedandS.Vassilvitskii.2017. StatisticalCostSharing.In PythoninScienceConference,GaëlVaroquaux,TravisVaught,andJarrodMillman
(Eds.).Pasadena,CAUSA,11–15.
Proceedingsofthe31stAnnualConferenceonNeuralInformationProcessingSystems
(NeurIPS).6221–6230. [42] DavidHarrisonJrandDanielLRubinfeld.1978.Hedonichousingpricesandthe
[13] AlejandroBarredoArrieta,NataliaDíaz-Rodríguez,JavierDelSer,AdrienBen- demandforcleanair.JournalofEnvironmentalEconomicsandManagement5,1
netot,SihamTabik,AlbertoBarbado,SalvadorGarcia,SergioGil-Lopez,Daniel (1978),81–102.
Molina,RichardBenjamins,RajaChatila,andFranciscoHerrera.2020. Ex- [43] PetterHolmeandBeomJunKim.2002.Growingscale-freenetworkswithtunable
plainable Artificial Intelligence (XAI): Concepts, taxonomies, opportunities clustering.Phys.Rev.E65(Jan2002),026107.Issue2. https://doi.org/10.1103/
andchallengestowardresponsibleAI. InformationFusion58(2020),82–115. PhysRevE.65.026107
https://doi.org/10.1016/j.inffus.2019.12.012 [44] DavidR.Hunter.2004.MMAlgorithmsforGeneralizedBradley-TerryModels.
[14] HeinzHBauschkeandJonathanMBorwein.1996.Onprojectionalgorithmsfor TheAnnalsofStatistics32,1(2004),384–406.
solvingconvexfeasibilityproblems.SIAMRev.38,3(1996),367–426. [45] SamuelIeongandYoavShoham.2005.Marginalcontributionnets:acompact
[15] UmangBhatt,AliceXiang,ShubhamSharma,AnkurTalyAdrianWeller,Yunhan representationschemeforcoalitionalgames.InProceedingsofthe6thACM
Jia,JoydeepGhosh,RuchirPuri,JoséM.F.Moura,andPeterEckersley.2020.Ex- ConferenceonElectronicCommerce.193–202.
plainableMachineLearninginDeployment.InProceedingsoftheACMConference [46] AnatoliJuditsky,ArkadiNemirovski,andClaireTauvel.2011.Solvingvariational
onFairness,Accountability,andTransparency. inequalitieswithstochasticmirror-proxalgorithm.StochasticSystems1,1(2011),
[16] JMBilbao,JRFernandez,AJiménezLosada,andJJLopez.2000. Generating 17–58.
functionsforcomputingpowerindicesefficiently.Top8,2(2000),191–213. [47] NarendraKarmarkar.1984. Anewpolynomial-timealgorithmforlinearpro-
[17] JMBilbao,NJiminéz,andJJLópez.2002.VotingpowerintheEuropeanUnion gramming.InProceedingsoftheSixteenthAnnualACMSymposiumonTheoryof
enlargement.EuropeanJournalofOperationsResearch143(2002),181–196. Computing.302–311.
[18] StephenPBoydandLievenVandenberghe.2004.Convexoptimization.Cambridge [48] WalterKernandDaniëlPaulusma.2003.Matchinggames:theleastcoreandthe
universitypress. nucleolus.MathematicsofOperationsResearch28,2(2003),294–308.
[19] SiminaBranzeiandKateLarson.2011.SocialDistanceGames.InProceedingsof [49] AlfKimmsandIgorKozeletskyi.2016.Core-basedcostallocationinthecoopera-
theTwenty-SecondInternationalJointConferenceonArtificialIntelligence(IJCAI
tivetravelingsalesmanproblem.EuropeanJournalofOperationalResearch248,3
2011). (2016),910–916.
[20] JavierCastro,DanielGómez,andJuanTejada.2009.Polynomialcalculationof [50] DiederikPKingmaandJimmyBa.2014.Adam:Amethodforstochasticopti-
theShapleyvaluebasedonsampling. Computers&OperationsResearch36,5 mization.arXivpreprintarXiv:1412.6980(2014).
(2009),1726–1730. [51] GalinaMKorpelevich.1976.Theextragradientmethodforfindingsaddlepoints
[21] GeorgiosChalkiadakis,EdithElkind,andMichaelWooldridge.2012.Computa- andotherproblems.Matecon12(1976),747–756.
tionalAspectsofCooperativeGameTheory.Morgan&ClaypoolPublishers. [52] I.E.Kumar,Venkatasubramanian,S.,Scheidegger,andC.Friedler.2020.Prob-
[22] GeorgeDantzig.1963.Linearprogrammingandextensions.PrincetonUniversity lemswithShapley-value-basedexplanationsasfeatureimportancemeasures.In
Press. Proceedingsofthe37thInternationalConferenceonMachineLearning(ICML).
[23] AnupamDatta,ShayakSen,andYairZick.2016.Algorithmictransparencyvia [53] StephenCLittlechildandGFThompson.1977. Aircraftlandingfees:agame
quantitativeinputinfluence:Theoryandexperimentswithlearningsystems.In theoryapproach.TheBellJournalofEconomics(1977),186–204.[54] ScottMLundbergandSu-InLee.2017.Aunifiedapproachtointerpretingmodel [80] MichaelZuckerman,PiotrFaliszewski,YoramBachrach,andEdithElkind.2012.
predictions.AdvancesinNeuralInformationProcessingSystems30(2017). Manipulatingthequotainweightedvotinggames. ArtificialIntelligence180
[55] SasanMaleki,LongTran-Thanh,GregHines,TalalRahwan,andAlexRogers.2013. (2012),1–19.
Boundingtheestimationerrorofsampling-basedShapleyvalueapproximation.
arXivpreprintarXiv:1306.4265(2013).
[56] RoryMitchell,JoshuaCooper,EibeFrank,andGeoffreyHolmes.2022.Sampling
permutationsforshapleyvalueestimation. TheJournalofMachineLearning
Research23,1(2022),2082–2127.
[57] RoryMitchell,JoshuaCooper,EibeFrank,andGeoffreyHolmes.2022.Sampling
PermutationsforShapleyValueEstimation.JournalofMachineLearningResearch
23(2022),2082–2127.
[58] AryanMokhtari,AsumanOzdaglar,andSarathPattathil.2020.Aunifiedanalysis
ofextra-gradientandoptimisticgradientmethodsforsaddlepointproblems:
Proximalpointapproach.InInternationalConferenceonArtificialIntelligenceand
Statistics.PMLR,1497–1507.
[59] DmitryMoor,SvenSeuken,TobiasGrubenmann,andAbrahamBernstein.2016.
Core-SelectingPaymentRulesforCombinatorialAuctionswithUncertainAvail-
abilityofGoods.InProceedingsoftheTwenty-FifthInternationalJointConference
onArtificialIntelligence(IJCAI-16).
[60] Niema Moshiri. 2018. The dual-Barabási-Albert model.
arXiv:1810.10538[physics.soc-ph]
[61] RogerB.Myerson.1977. GraphsandCooperationinGames. Mathematicsof
OperationsResearch2,3(1977),225–229.
[62] M.E.J.NewmanandD.J.Watts.1999. Renormalizationgroupanalysisofthe
small-worldnetworkmodel. PhysicsLettersA263,4(1999),341–346. https:
//doi.org/10.1016/S0375-9601(99)00757-4
[63] F.Pedregosa,G.Varoquaux,A.Gramfort,V.Michel,B.Thirion,O.Grisel,M.
Blondel,P.Prettenhofer,R.Weiss,V.Dubourg,J.Vanderplas,A.Passos,D.Cour-
napeau,M.Brucher,M.Perrot,andE.Duchesnay.2011.Scikit-learn:Machine
LearninginPython.JournalofMachineLearningResearch12(2011),2825–2830.
[64] TapioRaunioandMattiWiberg.1998.WinnersandLosersintheCouncil:Voting
PowerConsequencesofEUEnlargements.JournalofCommonMarketStudies
(JCMS)38(1998),549–562.Issue4.
[65] EzraResnick,YoramBachrach,ReshefMeir,andJeffreySRosenschein.2009.The
costofstabilityinnetworkflowgames.InMathematicalFoundationsofComputer
Science2009:34thInternationalSymposium,MFCS2009,NovySmokovec,High
Tatras,Slovakia,August24-28,2009.Proceedings34.Springer,636–650.
[66] AnjaReyandJörgRothe.2010. Complexityofmergingandsplittingforthe
probabilisticBanzhafpowerindexinweightedvotinggames.InECAI2010.IOS
Press,1021–1022.
[67] AnjaReyandJörgRothe.2011.Briberyinpath-disruptiongames.InInternational
ConferenceonAlgorithmicDecisionTheory.Springer,247–261.
[68] DovSametandEitanZemel.1984.Onthecoreanddualsetoflinearprogramming
games.MathematicsofOperationsResearch9,2(1984),309–316.
[69] AbigailSee,YoramBachrach,andPushmeetKohli.2014.Thecostofprinciples:
analyzingpowerincompatibilityweightedvotinggames.InProceedingsofthe
2014InternationalConferenceonAutonomousAgentsandMulti-AgentSystems.
Citeseer,37–44.
[70] LloydS.Shapley.1951.Notesonthen-PersonGame–II:TheValueofann-Person
Game. RANDCorporation.
[71] LloydSShapleyandMartinShubik.1954.Amethodforevaluatingthedistribution
ofpowerinacommitteesystem.AmericanPoliticalScienceReview48,3(1954),
787–792.
[72] MukundSundararajanandAmirNajmi.2020.ThemanyShapleyvaluesformodel
explanation.InInternationalConferenceonMachineLearning.PMLR,9269–9278.
[73] NikolaTarashev,KostasTsatsaronis,andClaudioBorio.2016.Riskattribution
usingtheShapleyvalue:Methodologyandpolicyapplications.ReviewofFinance
20,3(2016),1189–1213.
[74] AlanTaylorandWilliamZwicker.1992.Acharacterizationofweightedvoting.
ProceedingsoftheAmericanmathematicalsociety115,4(1992),1089–1094.
[75] HildeJ.P.Weerts,WernervanIpenburg,andMykolaPechenizkiy.2019.AHuman-
GroundedEvaluationofSHAPforAlertProcessing.InProceedingsoftheKDD
WorkshoponExplainableAI2019(KDD-XAI).
[76] M.A.Williams.1988.Anempiricaltestofcooperativegamesolutionconcepts.
BehavioralScience33,3(1988),224–237.
[77] WilliamWolberg,OlviMangasarian,NickStreet,andW.Street.1995. Breast
CancerWisconsin(Diagnostic). UCIMachineLearningRepository. DOI:
https://doi.org/10.24432/C5DW2B.
[78] TomYanandArielD.Procaccia.2021.IfYouLikeShapleyThenYou’llLovethe
Core. ProceedingsoftheAAAIConferenceonArtificialIntelligence35,6(May
2021),5751–5759. https://doi.org/10.1609/aaai.v35i6.16721
[79] LianminZheng,Wei-LinChiang,YingSheng,SiyuanZhuang,ZhanghaoWu,
YonghaoZhuang,ZiLin,ZhuohanLi,DachengLi,Eric.PXing,HaoZhang,
JosephE.Gonzalez,andIonStoica.2023. JudgingLLM-as-a-judgewithMT-
BenchandChatbotArena. arXiv:2306.05685[cs.CL]Seealsohttps://lmsys.org/
blog/2023-05-03-arena/andhttps://huggingface.co/spaces/lmsys/chatbot-arena-
leaderboard.AccessedAugust13th,2023.A ALGORITHMS Wefurtherboundthefollowingquantitiesastheymaybeof
interesttoothersforfurtherfollow-upalgorithmicdevelopment.
A.1 ProofsofTheoreticalResults
WecanboundtheresultinLemma1.First,recognize
WerestateTheorem2andLemma1andincludetheirproofs.
√
Theorem. Ifℓ 𝑐(𝜖,𝑝) ≤𝛾2 forall𝑐,then𝑝isinthe(𝜖+ 2𝑛𝛾)-core.
Proof.
ℓ 𝑐(𝜖,𝑝)=
21
|𝑐 =| ⇒(cid:0)ma √︁x( 210 |𝑐,𝑣 |(( 𝑣𝐶 () 𝐶− )𝜖 −− 𝜖−𝑝⊤ 𝑝𝑐 ⊤) 𝑐(cid:1)2
)
≤ ≤𝛾 𝛾2 ∀∀ 𝑐𝑐 ∈∈ 𝐶𝐶 ( (1 13 4)
)
(𝑑
𝑐
−𝑑 𝑐′)2
= 0(cid:0)(cid:0)
(cid:0)
𝑣𝑣(𝜖
((
𝐶𝐶+ ))𝑐 −−⊤𝑝
𝜖𝜖
′)
−
−−
𝑐
𝑐⊤( ⊤𝜖 𝑝′ 𝑝(cid:1)+
′2
(cid:1)𝑐 2⊤𝑝′)(cid:1)2 eiii fff ls𝑑𝑑𝑑 e<≥≥ 000 aaa nnn dd
d
𝑑𝑑𝑑 ′′′ ≥<≥ 000

√ (31)
=⇒ 𝑣(𝐶)−𝜖−𝑝⊤𝑐 ≤ 2𝑛𝛾 ∀𝑐 ∈𝐶 (15)
√ ≤ (cid:0)(𝜖+𝑐⊤𝑝)−(𝜖′+𝑐⊤𝑝′)(cid:1)2 (32)
=⇒ 𝑣(𝐶)−(𝜖+ 2𝑛𝛾)−𝑝⊤𝑐 ≤0∀𝑐 ∈𝐶. (16)
□
+max(cid:110) (cid:0)𝑣(𝐶)−𝜖−𝑐⊤𝑝(cid:1)2,(cid:0)𝑣(𝐶)−𝜖′−𝑐⊤𝑝′(cid:1)2(cid:111)
(33)
Lemma. Themap𝐹 inequation(11)ismonotone,i.e., ⟨𝐹(𝑥) − ≤ (cid:0)(𝜖+𝜖′)+(𝑐⊤𝑝−𝑐⊤𝑝′)(cid:1)2 +4𝑉(𝐼)2 (34)
𝐹(𝑥′),𝑥−𝑥′⟩ ≥0overall𝑥,𝑥′ ∈X. =||𝑥−𝑥′||2 +4𝑉(𝐼)2 (35)
𝑀
Proof. First,forany𝑥 ∈Xand𝑥′ ∈X,wefindthat𝐹(𝑥)⊤𝑥′
=𝜖′+𝜇(cid:16)∑︁ 𝑑 𝑐 (−𝑐⊤𝑝′−𝜖′)(cid:17) −𝜇′(cid:16)∑︁ ℓ 𝑐(𝑝,𝜖)−𝛾2(cid:17) (17)
|𝐶|
𝑐∈𝐶 𝑐∈𝐶 1 𝑐⊤ 0

=𝜖′+𝜇(cid:16) 𝑐∑︁
∈𝐶
|𝑑 𝐶𝑐 |(𝑑 𝑐′−𝑣(𝐶))(cid:17) −𝜇′(cid:16) 𝑐∑︁ ∈𝐶ℓ 𝑐(𝑝,𝜖)−𝛾2(cid:17) . (18) where𝑀 =  


𝑐
0
𝑐𝑐 0⊤ 00 

 
⪯2𝑛𝐼.Therefore,
Therefore,(𝐹(𝑥)−𝐹(𝑥′))⊤(𝑥−𝑥′)
=𝜖+𝜇(cid:16)∑︁ 𝑑 𝑐 (𝑑
𝑐
−𝑣(𝐶))(cid:17) −𝜇(cid:16)∑︁ ℓ 𝑐(𝑝,𝜖)−𝛾2(cid:17) (19)
|𝐶|
𝑐∈𝐶 𝑐∈𝐶 0≤ (𝐹(𝑥)−𝐹(𝑥′))⊤(𝑥−𝑥′) (36)
−𝜖−𝜇′(cid:16) 𝑐∑︁
∈𝐶
|𝑑 𝐶𝑐′ |(𝑑 𝑐 −𝑣(𝐶))(cid:17) +𝜇(cid:16) 𝑐∑︁ ∈𝐶ℓ 𝑐(𝑝′,𝜖′)−𝛾2(cid:17) (20) = 1 2(cid:16) 𝑐∑︁
∈𝐶
|𝐶1 |(𝜇+𝜇′)(𝑑′−𝑑)2 )(cid:17) (37)
−𝜖′−𝜇(cid:16)∑︁ |𝑑 𝐶𝑐 |(𝑑 𝑐′−𝑣(𝐶))(cid:17) +𝜇′(cid:16)∑︁ ℓ 𝑐(𝑝,𝜖)−𝛾2(cid:17) (21) ≤ (cid:16)∑︁ |𝐶1 |𝜇(||𝑥−𝑥′|| 𝑀2 +4𝑣(𝐼)2 )(cid:17) . (38)
𝑐∈𝐶 𝑐∈𝐶 𝑐∈𝐶
+𝜖′+𝜇′(cid:16)∑︁ |𝑑 𝐶𝑐′
|(𝑑
𝑐′−𝑣(𝐶))(cid:17) −𝜇′(cid:16)∑︁
ℓ
𝑐(𝑝′,𝜖′)−𝛾2(cid:17)
(22)
𝑐∈𝐶 𝑐∈𝐶
= (cid:16)∑︁ |𝐶1 |(cid:2)𝜇𝑑 𝑐(𝑑 𝑐 −𝑣(𝐶))−𝜇′𝑑 𝑐′(𝑑 𝑐 −𝑣(𝐶)) (23) Wecanalsobound||𝐹(𝑥)−𝐹(𝑥′)||2.First,wecanrewriteitas
𝑐∈𝐶
−𝜇𝑑 𝑐(𝑑 𝑐′−𝑣(𝐶))+𝜇′𝑑 𝑐′(𝑑
𝑐′−𝑣(𝐶))(cid:3)(cid:17)
(24)
−(cid:16) 𝑐∑︁ ∈𝐶(𝜇′−𝜇)(ℓ 𝑐(𝑝′,𝜖′)−ℓ 𝑐(𝑝,𝜖))(cid:17) (25) =||𝜇′(∑︁𝑑 𝐶′ 𝑐)−𝜇(∑︁𝑑 𝐶′
𝑐)||2 (39)
= (cid:16) 𝑐∑︁
∈𝐶
|𝐶1 |(𝑑 𝑐′−𝑑 𝑐)(𝜇′𝑑 𝑐′−𝜇𝑑 𝑐)(cid:17) (26) +(cid:16) 𝜇′(∑︁𝑐∈𝐶 𝑑′ )−𝜇(∑︁𝑐∈𝐶 𝑑′ )(cid:17)2
(40)
𝐶 𝐶
−(cid:16)∑︁ (𝜇′−𝜇)(ℓ 𝑐(𝑝′,𝜖′)−ℓ 𝑐(𝑝,𝜖))(cid:17) (27) 𝑐∈𝐶 𝑐∈𝐶
𝑐∈𝐶
+(cid:16) (∑︁
ℓ
𝑐(𝑝′,𝜖′))−(∑︁
ℓ
𝑐(𝑝,𝜖))(cid:17)2
(41)
= (cid:16) 𝑐∑︁
∈𝐶
|𝐶1 |(𝑑 𝑐′−𝑑 𝑐)(𝜇′𝑑 𝑐′−𝜇𝑑 𝑐)(cid:17) (28) =||𝑐 ∑︁∈𝐶
𝑐
(𝜇′𝑑′−𝜇𝑑)𝑐 ||∈ 2𝐶
(42)
𝐶
−(cid:16) 𝑐∑︁
∈𝐶
|𝐶1 |1 2(𝜇′−𝜇)(𝑑 𝑐′2 −𝑑 𝑐2 ))(cid:17) (29) +(cid:16)∑︁𝑐∈𝐶
1 (𝜇′𝑑′−𝜇𝑑)(cid:17)2
(43)
𝐶
= 1 2(cid:16) 𝑐∑︁
∈𝐶
|𝐶1 |(𝜇+𝜇′)(𝑑 𝑐 −𝑑 𝑐′)2 )(cid:17) ≥0 (30) +(cid:16)𝑐 ∑︁∈𝐶 1
(𝑑′2 −𝑑2
)(cid:17)2
(44)
2𝐶
confirmingthat𝐹 isindeedmonotone. □ 𝑐∈𝐶andthenupperbounditas LearningRateSchedule𝜂 𝑡 0.1→0.01over1000steps
CoalitionBatchSize𝐵 100
(45) LagrangeMutiplierInitialValue𝜇0 1000
ConstraintViolationThreshold𝛾 0.001
≤ ∑︁ ||𝑐 (𝜇′𝑑′−𝜇𝑑)||2 +∑︁(cid:16)1 (𝜇′𝑑′−𝜇𝑑)(cid:17)2 (46) NumberofIterations𝑇 10,000
𝐶 𝐶
𝑐∈𝐶 𝑐∈𝐶 Table 1: Algorithm 4 Hyperparameters: Runtime Experi-
+∑︁(cid:16) 1 (𝑑′2 −𝑑2 )(cid:17)2 (47) ment.Alternatively,thelinearschedulecanbewrittenas
𝑐∈𝐶 2𝐶 𝜂 𝑡 =max(cid:0)0.01,0.1·(1− 10𝑡 00)+0.01( 10𝑡 00)(cid:1) .
≤ ∑︁ 1 (𝜇′𝑑′−𝜇𝑑)2 +∑︁(cid:16)1 (𝜇′𝑑′−𝜇𝑑)(cid:17)2 (48)
𝐶 𝐶
𝑐∈𝐶 𝑐∈𝐶
+∑︁(cid:16) 21 𝐶(𝑑′2 −𝑑2 )(cid:17)2 (49) repF lao cr et dhe 𝑝r wem ita hin soin ftg mex axpe (𝑠r )im we hn et rs e,w 𝑠,e ou us red nea wch da en cg ise ioo nfv va ar ri ia ab bl le es ,a isnd a
𝑐∈𝐶 vectorof𝑛real-valuedlogits.Thisthenallowedustousethemore
≤ ∑︁ 1(cid:16) 2(𝜇′𝑑′−𝜇𝑑)2 + 1 (𝑑′2 −𝑑2 )2(cid:17) (50) sophisticatedupdateoperatorAdam[50].NotethattheJAX[4]
𝑐∈𝐶𝐶 4 autodifflibrarymakesittrivialtocompute𝐹 𝑠 = ∇𝑠L(𝑝(𝑠),𝜖,𝜇)
≤ ∑︁ 1(cid:16) 2(𝜇′𝑑′−𝜇𝑑)2 + 1 (𝑑′+𝑑)2 (𝑑′−𝑑)2(cid:17) . (51) a infte Tr at bh leec 2h .angeofvariables.Weusedthehyperparametersreported
𝐶 4
𝑐∈𝐶
LearningRateSchedule𝜂 0.1
𝑡
A.2 DeploymentwithAccelerators CoalitionBatchSize𝐵 1000
ItispossibletoaccelerateAlgorithm4onGPU/TPUs.Theother LagrangeMutiplierInitialValue𝜇0 1000
algorithmsweproposedcanreusethesetechniquesaswell.Thisis ConstraintViolationThreshold𝛾 0.01
akeyadvantageofiterative,stochastic(MonteCarlo,minibatch) NumberofIterations𝑇 10,000
algorithms.Thekeysteptoparallelizeis𝑑 𝑐 =max(0,𝑣(𝑐)−𝜖−𝑝𝑇𝑐) Table2:Algorithm4Hyperparameters:OtherExperiments
forabatchofconstraints.
Let𝐶bea𝐵×𝑛matrixrepresentingabatchof𝐵coalitionswitha
singlecoalition𝑐representedoneachrow(weareabusingnotation
fromearlierwhere𝐶representsasinglecoalition).Eachentryof B SHAPLEYVALUEVERSUSTHECORE
𝐶indicateswhetherplayer𝑖isincludedincoalition𝑐.Therefore,
TheShapleyvalueisanintuitivesolutionconceptforquantify-
thismatrixissparse(andbinary).Let𝑑beavectorcontaining𝑑
𝑐 ingtheexpectedmarginalcontributionofaplayer.Themarginal
foreachcoalition𝑐.Let𝑣beavectorcontainingthevalueofeach
contribution of agent 𝑖 to a coalition𝐶 such that 𝑖 ∉ 𝐶 is the
coalition.TheninJAX[4],𝑑 =jax.nn.relu(𝑣−𝜖−jnp.dot(𝐶,𝑝)).
increase in utility the coalition𝐶 achieves when 𝑖 joins it, de-
Thisisquitesimilartotheoperationofprocessingtheoutput
fined as𝑚𝐶 = 𝑣(𝐶 ∪{𝑖}) −𝑣(𝐶). We can define a similar con-
ofasingleneuralnetworklayerfollowedbyaReLUnonlinearity. 𝑖
ceptforpermutationsofagents.Wedenotethepredecessorsof𝑖
𝐶 playstheroleofthetypicalweightmatrix𝑊.𝑝 playstherole
inthethepermutation𝜋 as𝑏(𝑖,𝜋),i.e.theagentsappearingbe-
ofthetypicalinput𝑥 toaneuralnetworklayer.Theoffsetofthe
fore𝑖inthepermutation𝜋.Wedenotethesetofallpermutations
neuralnetworklayeris𝑣−𝜖.Andjax.nn.reluisthenonlinearity.
over the agents as Π. The marginal contribution of player𝑖 in
Wenowdescribehowtousetheresultingoutput𝑑tocompute
thepermutation𝜋 istheincreaseinutility𝑖provideswhenjoin-
theupdatesofAlgorithm4.Theupdatein𝐹(𝑥)(seeequation(11))
ingtheteamofagentsappearingbeforetheminthepermutation,
canthenbeeasilycomputedfrom𝑑.Noteℓ(𝑝,𝜖) =𝑑2 ⊘(2𝐶1𝑛)
𝑚𝜋 =𝑣(𝑏(𝑖,𝜋)∪{𝑖})−𝑣(𝑏(𝑖,𝜋)).TheShapleyvalueofagent𝑖is
where1𝑛isthelength-𝑛onesvector.𝐹(𝑥)isthenusedtoconstruct de𝑖
finedastheirmarginalcontribution,averagedacrossallpermu-
theUpdateintheforloopofAlgorithm4.
tations:
Whenthebatchsize𝐵isverylarge,theoperationjnp.dot(𝐶,𝑝)
cantakeadvantageofGPUs/TPUstoprocessthismatrix-vector 1 ∑︁
operationquickly.𝐶issparse,whichcanalsospeedupcalculations
Φ 𝑖(𝑣)=
𝑁!
𝑣(𝑏(𝑖,𝜋))∪{𝑖})−𝑣(𝑏(𝑖,𝜋)) (52)
usingsparsematrixmultiplicationlibraries. 𝜋∈Π
The Shapley value uniquely exhibits four axiomatic proper-
Furthermore,ifthebatchsize𝐵 istoolargetofit𝐶 onasin-
gle device, the batches can be split up across devices, say𝑑𝑗 =
ties[21]:efficiency:(cid:205)𝑛 𝑖=1Φ 𝑖(𝑣) =𝑣(𝐼),nullplayer:if𝑖contributes
jax.nn.relu(𝑣𝑗−𝜖−jnp.dot(𝐶𝑗,𝑝)).Theupdatein𝐹(𝑥)canbe nothing,thenΦ 𝑖(𝑣) = 0,symmetry:∀𝐶 ⊆ 𝐼 −{𝑖,𝑗},𝑣(𝐶∪{𝑖}) =
computedsimilarlytobeforeoneachdevice(givingus𝐹𝑗(𝑥))and
𝑣(𝐶∪{𝑗}) ⇒Φ 𝑖(𝑣) =Φ 𝑗(𝑣),andadditivity:fortwogames𝑣1,𝑣2,
thenaggregatedacrossdevicestoproducethefinalresult.
theShapleyvalueofthecombinedgameΦ 𝑖(𝑣1+𝑣2) = Φ 𝑖(𝑣1)+
Φ 𝑖(𝑣2).OneadvantageoftheShapleyvalueisthatitcanalsobe
computedusingMonteCarlosampling[6,57].TheShapleyvalue
A.3 AlgorithmHyperparameters hasbecomewidely-usedasameansofquantifyingtheeffectsof
WereportthehyperparametersweusedforAlgorithm4below. individualfeaturesinXAI[54].
FortheruntimeexperimentinFigure2,weusedthosereportedin Asdiscussedinthemainpaper,therearesomecomputational
Table1. andconceptuallimitationsoftheShapleyvalue.Computationally,therearesomegameswherenopolynomial-timealgorithmcan
Imputation Approximation Quality
obtainsufficientlysmallconfidenceintervals[9]andothersfor
whichitcannotbecomputedusingauniformdistribution[12]. 8 Shapley LP
CL 25
For XAI applications, the Shapley value has been criticized for
7 CL (1.5x LR)
several reasons. Firstly, the Shapley value does not necessarily 20
CL (0.2x LR)
reflectwhathumanendusersreallywanttoexplainaboutmodels 6
15
in deployment [15]. As such, it has been labeled “not a natural
5 solutiontothehuman-centricissuesofexplainability”[52].Second, 10
whenfeaturesarecorrelated,itisnotclearhowShapleyvalues 4
5
shouldattributerelativeimportance[52].Third,theusefulnessof 0 20 40 60 80 100
theadditivityaxiomisquestionable[78]andcanbeuninformative Wall Clock Time (seconds)
fornon-additivemodels[52].Finally,whenhumansaidedwitha
modelwereevaluatedonalertprocessing,therewasnosignificant Figure5:Approximationqualityofthelinearprogram(LP),
differenceintaskutilitymetricswhentheShapleyvalueswere coreLagrangian(CL),andShapleymethodasafunctionof
providedversusnotprovided[75]. computationtime(seconds).The𝑥-axiscorrespondstowall-
Incontrast,thecorefocusesonthestabilityoftheimputations. clocktimetakenbyallalgorithmsrunside-by-sidegiven
Inparticular,utilitysubdivisionsdiscoveredbythecorecanbe 𝑘 ∈ {500,1000,2000,4000,8000,16000} sampledcoalitionsfor
interpretedas“economicallyplausiblepaymentsinacompetitive theLPmethod,𝑡 𝑘.Abettercoreapproximationqualityis
marketinthesensethateverycoalitionshouldbecompensatedfor reflectedinhavingalower𝜖forthesameruntime.Theleft
itsmarketvalue”[78].Imputationsoutsidethecorewouldleadto 𝑦-axisrepresentstheapproximate𝜖 oftheleast-coresolu-
someagentshavingincentivetoformdifferentcoalitionsforhigher tionfound,𝜖ˆ(𝑝 𝐿𝑃,𝐶ˆ )and𝜖ˆ(𝑝 𝐶𝐿,𝐶ˆ ),computedoverthesame
valueandredistributetheextrapayoffamongthemselves.Insome setof225 coalitions,𝐶ˆ .AstheShapleysolutionisnotmoti-
contexts,approximationsoftheleastcorecanattributeimportance vatedbystability,wemeasuretheapproximatesolution’s
morereliablythanShapleyvalueinXAI[78].OutsideofXAI,the qualitybyeuclideandistancetotheShapleyvalueestimated
coreisusedtoselectpaymentrulesincombinatorialauctionsdue with10millionMonte-Carlosamples.EachShapleyapproxi-
toproblemswiththecommonly-usedmechanisms[26,59]. mationisestimatedusing125×𝑘samples.Eachdatapoint
Lastly,thereisevidencethattheShapleyvaluehasweakerempir- (𝑡 𝑘,𝜖ˆ(𝑝 𝑥,𝐶ˆ ))representsanaverageoverthesamesetof2,500
icalsupportthanthecoreforpredictinghumanpaymentdivisions randomweightedvotinggameswithshadingindicatingstan-
inbehavioralstudies[76].Inamorerecentstudy,behaviorofplay- darderrorofthemean.
ersdeviatedfromtheShapleyvaluepredictionsandviolatedtwoof
itsaxioms[29]:nullplayerandadditivity.Forallthesereasons,we
believethattheleastcoreisaworthyalternativesolutionconcept aregeneratedbyconnectingeachnewvertexwitheither𝑚1edges
ingeneralandalsoforXAI. withprobability𝑝 or𝑚2 edgeswithprobability1−𝑝 [60](with
edgetargetsselectedatrandomfromthecurrentvertices).Pow-
B.1 AdditionalTimingExperiment
erlawClustersaregraphswithapowerlawdegreedistribution
andapproximateaverageclustering[43],where𝑚isthenumber
InFigure5,wereplicatetheweightedvotinggamestimingexper-
ofedgestorandomlyaddtoeachnodeand𝑝 istheprobability
imentfromFigure2butnowforaweightedgraphgame,specif-
ofaddingatriangleafteraddingeachedge.RandomUniform
icallytheNewmanWattsStrogatzgameinFigure1ewithgame
IntersectionArandomsubsetof𝑚elementsisassignedtoevery
parameters𝑝 and𝑘 sampledfrom [4,24] and [0,1] asindicated
vertexinagraph,eachelementbeingassignedindependentlywith
inthefigure.WealsodisplaytwoadditionalrunsoftheCoreLa-
probability𝑝.Anedgebetweentwoverticesexistsiftheirelement
grangianapproachwithtwodifferentlearningrates(LR)aroundthe
subsetsintersect.
baselearningrate:learningrateschedule=linear_schedule(2×
WeobserveinFigure6thatsimilarlytoErdős-Rényi,partition
𝐿𝑅,0.1×𝐿𝑅,103) withbase𝐿𝑅 = 0.5.Lastly,wereportapproxi-
graphshavetheoppositephenomenonofasmallcornerofthe
mationqualityfortheMonte-CarloShapleyvalueasmeasuredby
spacewithstablegames(low𝑝 and𝑝 ),withthegameswith
euclideandistancetoitsapproximategroundtruthvalue.Inthis 𝑖𝑛 𝑜𝑢𝑡
moderatevaluesofthetwoparametersbeinglessstable.Incon-
case,theLPmethodoutperformstheCLmethodsuggestingitis
trast,DualBarabasiAlbertgraphshavestablegameswhenboth
importantkeepbothapproachesinmindwhenattemptingtosolve
parametershavemediumvalues,withlessstabilityaseitherof
newproblemdomains.
theparametersdeviatingfromthesevalues.Finally,similarlyto
NewmanWattsStrogatz,Intersectiongraphsindicateaspectrum
C GRAPHGAMES
betweenstableandunstablegames(withthe𝑝parameterhaving
C.1 Othergraphgames stronginfluenceinIntersectiongraphs,and𝑘 parameterhaving
Wepresent4moregraphgamestocomplementSection4.2.2: thestrongerinfluenceonstabilityinNWSgraphs).
PartitionGrapharegraphswheretheverticesaresplitinto
𝑛partitions.SimilartotheErdős-Rényigraph,anedgeoccursbe- C.2 ExampleGraphs
tween vertices within a partition with probability𝑝 𝑖𝑛 and with Figure7presentsanexampleofaninducedsubgraphgame,de-
probability𝑝
𝑜𝑢𝑡
acrosspartitions.DualBarabasiAlbertgraphs scribinghowthecharactersiticfunctioniscalculatedinthisgame.
etamixorppA
rorrE
yelpahS
2L
)shtdnasuoht
ni(1.0 24 0.5 6 23 10
0.8 4 20 5.0 8
0.6 16 4.8 4
0.3 12 6 0.4 2 12 4.6 2 4
0.2 8
4.4 2
0.0 0 4 0.1 3
0.00.20.40.60.81.0 2 14 26 38 50 62 0.1 0.3 0.5 2 11 22
𝑝 𝑜𝑢𝑡 𝑚2 𝑝 numberofrules
(a)Partition (b)DualBarabasiAlbert (a)Varysamplingprobability (b)Varyrulesandplayers
(𝑛=4,𝜎=1) (𝑝=0.25,𝜎=1)
24 24 Figure8:Meanleast-corevalueover200randomlygenerated
5.0
20 20 4 MCNs(10players,𝑘 =10rules).
4.8
16 16
12 4.6 12 2 Dataset #ofFeatures #ofSamples Task
BreastCancer 569 30 Classification
8 4.4 8
Diabetes 442 10 Regression
4 4 0 Wine 178 13 Classification
0.00.20.40.60.81.0 0.00.20.40.60.81.0
BostonHousing 506 13 Regression
𝑝 𝑝
Table3:StatisticsofMLTasksinXAIExperiments
(c)PowerlawCluster (d)Intersection
(𝜎=1) (𝜎=1)
TogeneraterandomMCNs,wegenerate𝑘rules,eachusingthe
Figure 6: Mean LCV for different classes of graphs when
followingsamplingprocess:foreachplayer,theyareincludedin
sweepingovertwohyperparameters.Constanthyperparam-
𝑃 withprobability𝑝,andin𝑁 withprobability𝑞.Ifanagentis
etersareshowninparenthesis.
selectedforboth𝑃 and𝑁 theruleisdiscardedandre-sampled.
Figure8showstheimpactoftheparametersontheexpected
a b least-corevalue.InFigure8awevary𝑝and𝑞whileinFigure8b
1 2 3
wechangeboththenumberofrulesandthenumberofplayers.In
e g h particular,weobservethattheexpectedleast-corevalue(andhence,
c
4 5 6 theexpectedstabilityofthegame)dependsonallfourparameters.
Forexample,gameswithlow𝑝buthigh𝑞(i.e.coalitionsaremore
f i
j d likelytonothaveanyrulesapplytothem)areverystable,butso
7 8 9
aregameswithfewrulesandmanyagents.Theseinsightsopenup
newresearchquestionssuchasthepossibilityfordesigningspecial-
purposealgorithmsforMCNsunderspecificparameter-regimes.
Figure7:Examplegraphgamewith9players.Thecoalition
withplayers{1,2,4,5,7,8}haspayoff𝑎+𝑒+𝑔+𝑓+𝑗,thecoalition
withplayers{3,6}haspayoffℎ,andthecoalitionwithplayers D XAI:DATASETSANDADDITIONAL
{9}haspayoff0(asdoallsingletoncoalitions).Intuitively, EXPERIMENTS
theedgescorrespondtosynergiesbetweenplayersthatare D.1 Datasets
onlyrealisediftheyareinthesamecoalition.
WeliststatisticsofourXAIdatasetsinTable3.Weused80%ofthe
datafortrainingandkept20%asidefortestingandmeasuringthe
performanceoftheAImodel.
Figures9showexamplesofrandomlygeneratedgraphs,ofthe
variousclassesconsideredinthepaper,alongwiththeirrepresen-
D.2 AdditionalDataValuationExperiments
tationasweightedadjacencymatrices.
WerepeatedthedatavaluationexperimentdescribedinSection5
C.2.1 MarginalContributionNetworks. Thefinalclassofgameswe onallthedatasetspresentedintheglobalandlocalexperiments.
studyarethemarginalcontributionnetworks(MCNs)[45].Inan Recallthatdatavaluationassignsimportancestoeachdatapoint
MCN,thecooperativegameisdefinedbyasetofrules{𝑟1,...,𝑟 𝑘} ratherthanfeatures.Figure10showsasimilartrendthatremoving
suchthateachruletakestheform𝑟 =(𝑃,𝑁)where𝑃,𝑁 ⊆𝐼 refer thetopdatapointstheleastcoreseemstobemorecriticalformodel
tothepositiveandnegativepartsrespectively.Givenacoalition performancethanShapleyvalues.Thetrendsometimesswitches
𝐶 ⊆ 𝐼, a rule𝑟 = (𝑃,𝑁) applies to𝐶 if and only if𝑃 ⊆ 𝐶 and after40-50%ofdataremoved.
𝐶∩𝑁 =∅.Clearlymultiplerulescanapplytoacoalitionandsowe
let𝑅 bethesetofrulesthatapplyto𝐶.Theresultingcharacteristic
𝐶
functionisthus𝑣(𝐶)=(cid:205) 𝑟∈𝑅𝐶𝑤(𝑟).
𝑝
𝑚
𝑛𝑖 1𝑚
𝑚
𝑞
sreyalpforebmun(a)Erdős-Rényi (b)Partition (c)DualBarabasi (d)PowerlawCluster (e)Intersection (f)NewmanWatts
𝑝=0.4 𝑝𝑖𝑛=0.9,𝑝𝑜𝑢𝑡 =0.1 Albert 𝑚=8,𝑝=0.8 𝑚=8,𝑝=0.4 Strogatz
𝑚1=8,𝑚2=8, 𝑘=8,𝑝=0.4
𝑝=0.2
(g)Erdős-Rényi (h)Partition (i)DualBarabasi (j)PowerlawCluster (k)Intersection (l)NewmanWatts
Albert Strogatz
Figure9:Exampleadjacencymatricesandvertexandedgeplotsofdifferentgraphclasses.
(a)Wine (b)Diabetes
Removal of Most Important Data Points Removal of Most Important Data Points
Wine (Budget = 50000) Diabetes (Budget = 50000)
0.5
0.975
Shapley Shapley
Least Core 0.4 Least Core 0.950
0.3
0.925
0.2
0.900
0.1
0.875
0 10 20 30 40 50
0 10 20 30 40 50
Data removal percentage
Data removal percentage
Figure10:DataValuationExperimentsfromSection5.3ontheWineandDiabetesdatasets.
erocs
ledoM
erocs
ledoM
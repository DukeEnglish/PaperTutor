Digital Twin Mobility Profiling: A Spatio-Temporal
Graph Learning Approach
Xin Chen∗, Mingliang Hou∗, Tao Tang†, Achhardeep Kaur† and Feng Xia†((cid:66))
∗School of Software, Dalian University of Technology, Dalian 116620, China
†School of Engineering, IT and Physical Sciences, Federation University Australia, Ballarat, VIC 3353, Australia
{xin.chen.jx; teemohold; tau.tang}@outlook.com; achhardeepkaur@students.federation.edu.au; f.xia@ieee.org
Abstract—Withthearrivalofthebigdataera,mobilityprofil- provide accurate predictions or projections, and increase the
ing has become a viable method of utilizing enormous amounts efficiency of government or policymakers’ decision-making.
of mobility data to create an intelligent transportation system. However, due to the high complexity of the industrial
Mobility profiling can extract potential patterns in urban traffic
processofmobilitydata,directlyemployingmobilityprofiling
from mobility data and is critical for a variety of traffic-related
applications.However,duetothehighlevelofcomplexityandthe inITSsufferssignificantchallenges.ExistingITSapplications,
huge amount of data, mobility profiling faces huge challenges. in particular, are unable to capture the possible association
Digital Twin (DT) technology paves the way for cost-effective retained in mobility data [4]. It’s essential to use mobility
and performance-optimised management by digitally creating a
profiles to find urban mobility trends based on data acquired
virtual representation of the network to simulate its behaviour.
byIoTdevicesandtoprovidepreciseandreliablepredictions.
In order to capture the complex spatio-temporal features in
traffic scenario, we construct alignment diagrams to assist in These predictions can be utilized to provide reliable recom-
completing the spatio-temporal correlation representation and mendations to human planners and to carry out transportation
design dilated alignment convolution network (DACN) to learn management autonomously.
the fine-grained correlations, i.e., spatio-temporal interactions.
Weproposeadigitaltwinmobilityprofiling(DTMP)framework
tolearnnodeprofilesonamobilitynetworkDTmodel.Extensive Physical twin Virtualtwin
Data
experimentshavebeenconducteduponthreereal-worlddatasets.
Experimental results demonstrate the effectiveness of DTMP.
G6
Index Terms—digital twin, mobility profiling, spatio-temporal G5/
g gr ra ap ph
h
cle oa nr vn oi ln ug ti, ot nra nn es tp wo or rt kation network, cyber-physical system, tenretnI/
I. INTRODUCTION Prediction
Diagnostic Inf po rr om cea sti son
With the emergence of industrial revolution Industry 4.0, Optimization
Industrial Internet-of-Things (IIoT) and smart city, Intelligent
Fig. 1. Virtual replica of physical transportation network using mobility
Transportation System (ITS) is anticipated to satisfy various
networkDTmodel.
technical demands and diverse, realistic requirements con-
cerning accuracy, environment friendly and reliability [1], The recent advancement in Digital Twin (DT) technology
[2]. Nowadays, ITSs are an essential topic from both a opens up a lot of possibilities for cyber-physical integration.
technological and a business standpoint. They mostly rely on Cyber-Physical System (CPS) is transformational technology
Transportation Engineering models and algorithms, which are that manage integrated systems between their physical assets
profoundly affecting human travel habits. Furthermore, the and computing capability [5]. DT is a technology that creates
proliferationmobilitydatabringustotheeraoftransportation reflection of a physical net in the digital world. We agree that
big data. To efficiently leverage mobility data, the concept mobility profiling can greatly benefit from a mobility network
of mobility profiling has been proposed as a promising way DT. Firstly, a mobility DT creates a virtual replica of the
to design and virtualized ITS for urban traffic management physicaltransportationnetwork,asshowninFig.1andcanbe
and planning. Mobility profiling offers an effective simulation usedtodoavarietyofdataanalysesonvariouswhat-ifscenar-
approach to meet the diverse use case requirements. It is a ios without disrupting the physical transportation network [6].
critical enabler for realising ITS application with rigorous Secondly,amobilitynetworkDTcangenerateaccuratemobil-
accuracy requirements on a cloud computing platform. ity profiles to support downstream prediction tasks after any
Mobility profiles are a summary of mobility-specific char- configuration changes. A DT of the transportation network
acteristics such as average speed and mobility flow [3]. The is crucial to achieve cost-efficient and performance-optimal
process of extracting an entity’s mobility patterns from data, transportation management, as well as to continue monitoring
such as a user’s mobility interest and the crowd flow of a bus ITS performance under a set of operational circumstances
stop, is referred to as mobility profiling. Effective mobility without modifying the physical network.
profiling may aid our understanding of urban transportation, Artificial Intelligence (AI) techniques have recently ad-
4202
beF
6
]GL.sc[
1v05730.2042:viXravancedtothepointwheretheycannowmeettherequirements platform. In particular, we develop a learning mechanism
of mobility network development [4], [7]. When it comes that is capable of learning complex mobility patterns without
to processing and analyzing large amounts of transportation relying on domain knowledge of network structure. A super-
data, cloud computing stands out as the most efficient method vised end-to-end learning process can be used to create the
available [8]–[10]. However, an intelligent DT system can adaptive station profiles from the data collected. Furthermore,
only be developed by applying advanced AI techniques to we design an unique alignment graph to help express fine-
the collected data. The Internet of Things (IoT) is used to grained spatio-temporal interactions and propose a dilated
collect massive mobility data from the physical world, and alignment convolution network (DACN) to learn it. Finally,
then use the data as input into an AI model to construct We employ gated Temporal Convolution Network (TCN) [11]
a digital twin. As a last phase, the developed DT can be toassisttheadaptiveDACNtolearnthetemporalcorrelations.
used to optimize the performance of the ITS. On the other In this paper, we present the spatio-temporal mobility net-
hand, transportation networks are fundamentally represented work DT based on mobility data collected by automatic fare
in graphs, many adaptive graph approaches [11]–[13] have collection system deployed on buses. The mobility profiles
emerged to learn the spatio-temporal features based on Graph refer to the learned virtual representations of bus stations,
Neural Network (GNN). These approaches have achieved which can be utilized to support downstream analytical tasks.
outstanding performance by introducing graph learning into A summary of this paper’s major contribution is given below:
their frameworks without a priory knowledge. In contrast to 1) We propose to use spatial and alignment graphs to rep-
this, most existing approaches employ a graph to depict the resentfine-grainedspatio-temporalinteractionsandpro-
interactionbetweennodes,whichmaynotbesuitedtocapture posetoalignmentgraphconvolutionalnetwork(AGCN)
finely grained data-source specific patterns. As shown in Fig. tocapturespatio-temporaldependenciesinurbanmobil-
2, node relationships include sequence similarity relationships ity.
as well as temporal delay or lead relationships. Aside from 2) We propose a novel framework digital twin mobility
that,currentapproaches[14]–[16]alwaysseektolearnspatial profiling (DTMP) to learn node profiles on a mobility
and temporal dependencies individually, ignoring interactions network DT. To develop accurate node profiles, the
between them. As a result, these models are limited in their DTMP employs DACN and parallelizes gated TCN.
ability to provide reliable profiling results on graph-structured 3) Weundertake comprehensiveexperimentson threereal-
datawhilecapturingcomplicatedspatio-temporalconnections. world data sets. Experimental results demonstrate the
This constraint limits the creativity of a mobility network DT effectiveness of the proposed framework. We have re-
and its implementation in ITS. leased the code on GitHub1.
Theremainderofthepaperissetoutasfollows.Webriefly
spatio-temporal cover related work in Section 2. The details of the proposed
spatio-temporal
frameworkDTMParegiveninSection3.Performanceevalua-
Aspatial B C A B C A B C tion will be presented in Section 4 where experimental results
are analyzed. Finally, we conclude the paper in Section 5.
spatial
t-2 t-1 t II. RELATEDWORK
temporal
temporal Thisworkiscloselyrelatedtodigitaltwins,mobilityprofil-
(a) Stationsdependencyunderspatialandtemporal. ing and spatio-temporal graph learning. We briefly introduce
previous work in this section.
250
230 StationA
12 91 00 S St ta at ti io on nB C A. Digital Twins
wolF1117 350
00 Digitaltwinscanbedefinedasmachinesorcomputer-based
110
90 models that are mirroring, emulating, simulating, or ‘twining’
70
50 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 the life of a physical entity [17], [18]. Specifically, a Digital
Time-step
Twin can be any of the following three types: 1) Digital
(b) FlowfromA,BandCstations.StationsA,BandCareonthesame TwinPrototype(DTP);2)DigitalTwinInstance(DTI);and3)
lineandstationChassomesimilarityinflowtostationsAandB,with
Digital Twin Aggregate (DTA) [19]. A DTP is a completely
BhavingasmallertemporalshiftandAhavingalargertemporalshift.
digital model of a not been created thing, whereas a DTI is a
Fig.2. Anillustrativeexampleofspatio-temporaldependency. virtual twin of an existing object that focuses on only one of
its properties. A DTA is a collection of DTIs that may be an
To address the aforementioned limitations, we design a
exact digital replica of a previously existing physical object.
mobility network profiling model (called DTMP) based on
Various types of digital twins are developed in ITS, includ-
the Spatio-Temporal Graph Neural Network to discover the
ing DT for automobile components, vehicles, vehicular net-
complicatedandfine-grainedspatialandtemporalcorrelations
works,androadinfrastructures.Forexample,Wangetal.[20]
in physical transportation networks and generate the accurate
node profiles to support downstream analytical tasks in cloud 1https://github.com/chenxino/DTMPproposedaframeworkforprovidingadvisoryspeedassistance designed the diffusion convolutional layer to extract the spa-
to the driver by vehicle-to-cloud (V2C) communication net- tial features and adopted the Gated Recurrent Unit (GRU)
workDT.Cioroaicaetal.[21]developedadigitaltwin,called to capture the temporal dependency. Ye et al. [30] design
hardware-in-the-loop(vHiL)testedmodeltoevaluatethetrust- the coupling mechanism to perform graph convolution in
building capability of smart systems within an ecosystem. different layers using different graphs, and then parasitize
Chen et al. [22] proposed a framework to allocate comple- GCN to GRU to capture spatio-temporal dependencies. Yu
mentary computation resources for mobile users in an mo- et al. [31] proposed stacked ST-Conv blocks for learning the
bile edge computational environment by utilizing unmanned spatio-temporalcorrelationsonthepredefinedspatio-temporal
aerial vehicles (UAVs). They developed a deep reinforcement graphs. The gated Convolutional Neural Networks (CNN) is
learning(DRL)techniquefortaskschedulingontheUAVand utilized to learn the temporal dependency. However, prede-
decreasing response time from the UAV to mobile users. The fined spatio-temporal graph learning could not capture the
DRLmodelistrainedbyconstructingadigitaltwinofthefull complex spatio-temporal patterns preserved in mobility data.
mobile edge computational system. Kumar et al. [23] created Wu et al. [11] proposed incorporating adaptive graph learning
an entire virtual model via digital twin to replicate the real- mechanism into fixed predefined graph learning to learn the
worldscenario.Deeplearningalgorithmswereusedtopredict spatio-temporal dependencies. Bai et al. [12] presented a
driver behaviour. full adaptive learning architecture, including node adaptive
As per best of our knowledge, we are the first to develop a parameter learning and data adaptive graph generation, to
station-based mobility network DT in order to extract precise learn the task-specific spatio-temporal features from mobility
bus station profiles to be used in downstream analytical data. Li et al. [32] constructed a spatio-temporal fusion graph
operations. The DT we developed in this research can be to model the spatio-temporal correlations explicitly. Then,
classified as DTI because it only focuses on mobility-related it adopts gated dilated CNN to learn the local and global
aspects (spatio-temporal relations) of bus stations. spatio-temporal correlations on the fusion graph. Oreshkin et
al. [33] proposed a framework for learning spatio-temporal
B. Mobility Profiling dependencies without using predefined graphs and relying
only on learn able fully connected layers and gated graph
Mobility profiling refers to the effort of extracting char-
architecture.
acteristics and features for a specific entity (user, station,
To learn station representations from mobility data, we use
area, etc.) [3], [24]. Generally speaking, mobility profiling
an adaptive graph learning technique, which is different from
can be categorized into two classes: (1) static profiling and
prior spatio-temporal graph learning research. Moreover, in
(2) dynamic profiling. Static profiling seeks to learn entity
order to learn the spatio-temporal interactions, we create and
representations relying on varied mobility data that varies
design a convolutional alignment graph network. Temporal
depending on the temporal perspective. For example, Ermal
dependency can be further learned with gated TCN in parallel
et al. [25] proposed a subway station crowd flow prediction
with DACN.
framework by integrating time-invariant station profiles such
as remoteness from the downtown area, and mean flow, etc.
TABLEI
Xia et al. [26] presented a framework to rank the station im-
Frequentlyusednotations
portancebyconsideringthestaticsubwayprofilessuchascen-
trality,connectivity,etc.Dynamicprofiling,ontheotherhand,
Symbol Description
relatestomodelingtheentityrepresentationswhiletakinginto
G(V,A) atrafficnetwork
account the temporal elements that the profiles may alter over
V ={1,2,...,N} setofnodesinthetrafficnetworkG
time.Zhaoetal.[27]proposedaspatio-temporallatentranking
A∈RN×N predefinedgraphdependsonpriorknowledge
framework called STELLAR, capturing temporal impact on
W θ ={W,b,Θ} setoflearnableparametersinthemodel
successive PoI (Point of Interest) recommendations. Wang et XG ∈RT×N×C T-stephistoricalfeaturematrix
al. [28] proposed an adversarial substructured representation YG ∈RT′×N×C nextT′-steptrafficfeaturematrix
learning method to extract mobility user profiles on mobile X(i)∈RN×C featurematrixintheG attimestepi
G
activity graphs. Wang et al. [29] proposed a framework by H∈RT×N×F outputofmiddlelayer
incorporating reinforcement learning into spatial knowledge A(S)∈RN×N spatialadjacencymatrix
graphrepresentationlearningtogeneratethedynamicmobility A(T)∈RN×N alignmentadjacencymatrix
user profiles. A(Si)∈RN×N spatialadjacencymatrixwithishift
E1,E2∈RN×e adaptivenodeembeddings
C. Spatio-temporal Graph Learning
The basic process of spatio-temporal learning is to model III. DESIGNOFDTMP
the spatial dependency in a set of spatial graphs with dif-
A. Spatio-temporal Prediction Problem Formulation
ferent time slots and then learn the temporal dependency
of these spatial graphs by a temporal learning architecture, In the transportation system, we define a graph G(V,A) to
e.g., Recurrent Neural Networks (RNN) [14]. Li et al. [15] representatrafficnetwork,where|V|=N isthesetofnodes,Assist
Physical Space Virtual Space
Prediction Model
Diagnostic
Design policy Train model
Control
Data transmission
Mapping Mapping
E1,E2 E1,E2 . . . . . . E1,E2
DACN DACN DACN
X
tupnI
raen
iL Gat 1e Dd
C
T NNCN
φ
 Linear   Linear  . . . . . .  Linear 
raen
iL
raen
iL
tuptuO
 Gated TCN Gated TCN
1D CNN σ Linear Spatial-Temporal Module Linear Spatial-Temporal Module Linear

Fig.3. DTMP’sframework.Themodelconsistsofmultiplespatio-temporalmodulesandanoutputlayer.Eachspatial-temporalmoduletransmitstheresult
totheoutputlayerthroughskip-connected.
N denotes the number of vertices. A ∈ RN×N is the matrix C. Alignment Convolution Module
showing the proximity between the nodes. At time step i, the The spatial correlation between nodes has always been
graph G has a feature matrix X G(i) ∈RN×C, also called graph regarded as the key factor and research hotspot in the traffic
signals. X(i) records the C types of traffic features (such as prediction problem. With the popularity of GNN, existing
G
flow,speed)ofeachnodesobservedattimestepi.Wedescribe work mainly focuses on constructing an appropriate spatial
the traffic prediction problem as having T-step historical data graph and using GNN to capture the spatial dependencies
X , finding a mapping function F to predict the the next T′- in the traffic sequence [34]. Relatively rare is the temporal
G
step traffic condition Y , formulated as: relationship between the nodes taken into account. However,
G
X =(X1,X2,...,X(T)) graphsignalsaretime-seriesdata.Thereshouldbeatemporal
G G G G relationship between two time series. We propose two types
Y G =(X G(T+1),X G(T+2),...,X G(T+T′)) (1) of graphs in the transportation network to better characterize
Y =F (X ) the temporal and spatial relationships, spatial graph A(S) and
G Wθ G
alignment graph A(T). It’s a spatial graph that describes the
where W denotes all the learnable parameters in the model.
θ similarity of temporal patterns between nodes, similar to the
Table I lists frequently used notations in this paper.
priorworkinthisareaaswell,whereas,nodesinthealignment
B. Framework of DTMP graph are sorted according to how far ahead or behind they
We present the DTMP’s framework in Fig. 3. The model is are in the temporal pattern between them.
mainlycomposedoffullyconnectedlayersandstackedspatio-
1 2 … b … a … N
temporal modules. Each spatio-temporal module is mainly
1
includedofparallelDACNandgatedTCN.Furthermore,cou-
pling mapping transforms node embedding vectors between …2 t n no od de e a b
spatio-temporal modules, resulting in each module having
b t
its own graph structure. The node embedding is the station … w o lF
portrait learned by the model. By using skip-connected, each a 0
module transfers the result to the output layer. The spatio- …
temporal module’s output is combined in the output layer, N Time
which translates it to the target dimension through two fully
connectedlayerswithactivationfunctions.Spontaneousspatial Fig.4. Alignmentgraph.Nodeb’strafficflowstatusisttimestepsbehind
nodea.
and temporal information are extracted using DACN in the
spatio-temporal module. Temporal dependencies are further a) Alignment Graph: To design a time alignment graph,
captured using the gated TCN. we use the temporal shift between graph signals. Nodes inthe alignment graph can only be connected to their neighbors spatial graph is assigned to the sub-graphs according to the
in the spatial graph since the alignment graph is dependent alignment graph.
on the spatial graph. When two nodes are connected in a
s sp iga nti aa ll s,ne bt uw tor thk i, sw ie sc oan nlycon trc ul eud ae ft th erat tt eh mey poh ra av le ls ai gm sil oa rr g lr ea ap dh
s
 AA (( SS 10 )) ,, II ff AA (( i, TT j )) == 10 ,, AA (i( , SS j 10 )) == AA (i( , SS j ))
have been formed. Therefore, we build the alignment graph A(S) = . i,j i,j i,j
.
A as(T sh) o∈ wnR iN n× FN ig.ba 4s .e Td ho ern eA is(S a) nw ali it gh nmea ec nh
t
e vl ae lm ueen ot nla y( i,T
j
fo) r⩾ tw0 o, .
A(S(n−1)), If A(T) =n−1,A(S(n−1)) =A(S),
i,j i,j i,j
points with edges in spatial graph. The a(T) represents the (4)
i,j
leading alignment of node j relative to node i. The alignment TheoriginalAGCNcanbereplacedbyseveralAGCNsafter
graph is directed, if a(T) >0 is true, then a(T) =0. the spatial graph has been decomposed. After decomposition,
i,j j,i
we construct a new DACN that uses spatial graphs produced
b) AGCN: We present a novel GNN titled alignment
fromdecomposition,asshowninFig.5.Withacertaindilation
graph convolution network (AGCN), which implements graph
rate k, we pick the spatial graph every k step to apply AGCN
convolution using the spatial graph and the alignment graph.
to reduce the complexity of the model. Then, we connect
General graph convolution does not employ alignment opera-
AGCN in series according to the shift from small to large,
tion on the neighbor information, the spatial adjacency matrix
and each AGCN is skip-connected to the output layer. After
to determine aggregated neighbors and aggregation pattern,
merging the outcomes of each AGCN(using concatenation-
whereas AGCN does. Here’s how to calculate it:
based fusion in the paper), the output layer converts each
result to the relevant dimension. For each AGCN in DACN,
shift(H,d)=H >>d (2) since each spatial graph contains only one shift method, we
can directly perform an overall shift on the input data and
n then conduct message propagation. So the formula (3) can be
H i(l+1) =σ((cid:88) (A˜( i,S j)×shift(H j(l),A( i,T j)))×W +b i), (3) simplified as:
j=1
H(l+1) =σ(A˜(Sd)×shift(H(l),d)×W(l)+b(l)) (5)
i i i
where H(l+1) is the output of node i through AGCN, A˜(S)
i where A˜(Sd) is the normalized spatial adjacency matrix with
is the normalized spatial adjacency matrix, W is learnable
d shift. H(l), H(l+1) represents the input and output of the l
parameters and b is bias. Shift operation is for rolling the
i layer respectively. H(l+1) is the output of node i.
graph signals along the time dimension. Elements that are i
shifted beyond the last position are discarded. As the formula
(2), where >> is right-shift operator and d is the number of
Input
times the elements of H have been shifted in time.
In traffic prediction, the convolution module can capture
𝐴𝑠0
the temporal and spatial dependency concurrently, rather than
𝐸10,𝐸20 AGCN, shift = 0
learning them separately. There are, however, a couple of
drawbacks to using AGCN on two graphs at the same time.
Mapping 𝐴𝑠2
Such graph convolution requires high computational costs 𝐸11,𝐸21 AGCN, shift = 2
because only one layer of the convolution network needs to Mapping
completeN×N shiftoperations.Theoverheadcausedbythe 𝐸12,𝐸22 AGCN, shift = 4
shift operation makes the calculation speed extremely slow 𝐴𝑠4
with limited computing resources. Another is the generation Adaptive Graph Generation Fusion
methodofthegraph.Throughthedistancebetweennodes,we
can only get an inaccurate and incomplete alignment graph. Output Linear
It’snotpossibleforastatic,establishednetworktoincludeall
the alignment information between nodes. Meanwhile, due to
the discontinuous nature of the alignment graph, the adaptive Fig.5. Dilatedalignmentconvolutionnetworkandadaptivegraphgeneration.
Withkernelsize3anddilationrate2,itpicksspatialgraphsevery2stepand
generation method is likewise ineffective for producing the
appliestheAGCN.
alignment graph during training.
c) DACN: Weproposeanimprovedconvolutionnetwork Compared with the original alignment graph convolution,
withadilatedalignedstructure(DACN).First,wedecompose the number of shift operations performed in DACN based on
the spatial graph according to the temporal alignment graph. graph decomposition is reduced from the O(N2) to O(1),
Sincethevaluesofthealignmentgrapharediscrete,thespatial significantly reducing the computational overhead. On the
graph is decomposed into multiple spatial graphs with the other hand, time alignment graph information is allocated to
same shift value, which is expressed by the formula (4). Each each spatial graph, making it possible to obtain alignment
sub-graph is initialized as an all-zero matrix, and then the graphinformationthroughlearning.Weovercometheproblemof generating the discrete alignment graph. The graph gener- module better cooperate. The gated temporal convolution
ation problem has changed from constructing an alignment module is defined as follows:
adjacency matrix and a spatial adjacency matrix to generating (cid:16) (cid:17) (cid:16) (cid:17)
H(l+1) =ϕ Θ ×H(l)+b ⊙σ Θ ×H(l)+b (9)
a series of spatial adjacency matrices with different alignment 1 1 2 2
values.
where H(l) ∈RT×N×C is the output of upper layer network,
d) Adaptive Graph Generation: There are three main
ϕ(·), σ(·) are activation and sigmoid function respectively.
methods to generate the spatial graph: predefined graph by
Θ , Θ , b , and b are model learnable parameters, ⊙ is the
distance, predefined graph by time sequence similarity, adap- 1 2 1 2
Hadamard product.
tive generation graph by learn able parameters. The method
of the predefined graph depends on prior knowledge, often E. Loss Function
unabletoincludeallspatialinformation.Spatialcorrelationin
We trained DTMP for traffic prediction using the Mean
the predefined graph has a deviation. Therefore, a new trend
Absolute Error (MAE). Hence, the loss function of the model
appearsusinganadaptivegraphtodescribespatialdependency
can be formulated as:
information. For large data sets with many nodes, however,
utilizingadirectadaptivemethodtogeneratenumerousgraphs
(cid:80)T′ |Y(cid:98)(i)−Y(i)|
L(W )= i=1 G G , (10)
can rapidly lead to an increase in parameters, which makes it θ T′×N ×C
more difficult to train the network and execute tests. So we
whereW denotesthesetoflearnableparametersinthemodel,
θ
use a coupled adaptive matrix generation method to generate Y(cid:98)(i) and Y(i) denote the predicted and true values in graph
a series of spatial adjacency matrices. G G
G at time i, respectively.
For zero-aligned spatial adjacency matrice, we randomly
Algorithm 1 illustrates the whole training procedure.
initialize two learnable node embedding vectors E0,E0 ∈
1 2 Linear(·) represents a transformation on the feature dimen-
RN×e for all node (for the dataset with prior knowledge, E0
1 sion C by fully connected layer.
and E0 can be obtained through the singular value decompo-
2
sition of a given adjacency matrix), where e is the embedding
Algorithm 1 DTMP Training Process
dimension of the node. The zero-aligned spatial graph can be
Require: ThedatasetsD,thenumberofspatio-temporalmod-
calculated and normalized by the following formula:
ules L, batch size is B;
(cid:16) (cid:17) Ensure: Well Trained DTMP;
A(S0) =ReLU E E(T) (6)
1 2 1: Initialize embedding vectors E 1,E 2.
(cid:16) (cid:17) 2: repeat
A˜(S0) =SoftMax A(S0) (7) 3: sampleabatch(X ∈RB×T×N×C,Y ∈RB×T′×N×C)
from D.
For the spatial graphs of other layers, we use the same
generation method. Instead of using randomly generated node 4: Expand the feature dimension of X from C to F to
get H ∈RB×T′×N×F.
embedding, we use the previous layer of node embedding
couplingmappingtoobtainnewnodeembedding.Thecoupled 5: Initialize temporary variable S to be null.
mapping formula is as follows: 6: for i=1,2,··· ,L do
7: Through formula (5) and (9), calculate Temp =
El 1+1 =El 1×W +b
(8)
DACN(H,E 1,E 2)+GatedTCN(H)
El+1 =El ×W +b 8: H =H +Linear(Temp)
2 2
9: S =S+Linear(Temp)
where W ∈ Re×e are learnable parameters and b ∈ Re are
10: Convert E 1,E 2 through formula (8)
bias. The coupling mapping of E ,E shapes parameters.
1 2 11: end for
There are O(N ×N) parameters in the randomly generated
12: Obtain the prediction result Y(cid:98) by executing two fully
graph, while the coupled graph only adds O(2 × N × e)
connected layers on S.
parameters for each graph. In DACN, the adaptive graph
13: Optimize the parameters by minimizing the loss (10)
generation method is shown in the right part of Fig. 5
between Y and Y(cid:98).
D. Gated Temporal Convolution Module 14: until convergence
According to the DACN module, a sequence of spatial
graphs would be used to capture temporal and spatial depen-
IV. EXPERIMENTS
dencies, as well as similarity and shift information. However,
A. Datasets
adaptive learning is limited and the temporal dependence of
the nodes themselves is also critical to traffic prediction. We We conduct experiments on three real-world traffic datasets
employ the gated temporal convolution [11] to extract the toevaluatetheperformanceofDTMP.PeMSD4andPeMSD8
temporal dependency. We set DACN and gated TCN modules are collected from the Caltrans Performance Measurement
in the same layer to use the same dilation rate to make the System (PeMS). They refer to the San Francisco Bay Area
gatedtemporalconvolutionmoduleandalignmentconvolution and San Bernardino, California. After linear interpolation,the records are grouped into 5-minute windows. The Huaian 7) AGCRN (NIPS 2020) [12]: Adaptive Graph Convolu-
dataset is generated in the City of Huaian, Jiangsu Province, tional Recurrent Network, which fusings node adaptive
China,byPandaBusCompany.Wetakethestationasthenode parameter learning and adaptive graph generation with
toextracttheSpatio-temporaltrafficdatafrombustransaction GRU.
records and the corresponding bus arrival time records, then 8) STFGNN (AAAI 2021) [32]: Spatial-Temporal Fusion
aggregated into 15-minute windows. Since the bus operating Graph Neural Network, which combines fusion graph
time is from 5 to 23 o’clock, a day contains 72-time steps in module of various spatial and temporal graphs with a
traffic flow. The detailed information is shown in Table II. novel gated convolution module.
TABLEII
D. Results and Analysis
Datasetdescriptionandstatistics.
1) Overall Comparison: Table III shows the performance
Data nodes timesteps period
of DTMP and baseline models on PeMSD4, PeMSD8, and
PeMSD4 307 16692 1/Jan/2018-28/Feb/2018
Huaian datasets. DTMP outperform in three datasets in terms
PeMSD8 170 17856 1/Jul/2016-31/Aug/2016
Huaian 721 2160 1/Apr/2020-30/Apr/2020 of all evaluation metrics. It includes classic temporal methods
including HA, ARIMA, and GRU with a large margin. Com-
paredwithotherGCN-basedspatio-temporalmethods,DTMP
B. Experimental Setup surpasses predefined graphs (STGCN, DCRNN) and further
improves the method of adaptive graphs (Graph WaveNet,
We divide the three datasets into training sets, validation
AGCRN)withasignificantmargin.InPeMSD4andPeMSD8
sets, and test sets with a ratio of 6:2:2. The prediction
datasets, compared with AGCRN and STFGNN, our method
problem chooses to use the 12-time steps historical data to
achieves small promotion, but we obtain the bigger improve-
predict the traffic conditions in the next 12- time steps. We
ment in Huaian datasets. We consider the Huaian dataset has
implemented the code for DTMP traffic prediction in Python
morenodesthanthePeMSDdatasets,andthenodeshavemore
3.7withPyTorch1.5.0.Themodeluses6layersofthespatio-
complex dependencies. DTMP has learned multiple adaptive
temporal module, and the corresponding dilation rate is 1,
graphsandhastheabilitytocapturethiscomplexrelationship.
2, 4, 1, 2, 4, respectively. DACN’s kernel size is set to 2,
In Fig. 6, we also display the evaluation measures at each
indicatingthateachDACNcontainstwogeneralconvolutions.
horizon in the PeMSD4 dataset. Although AGCRN balances
Dropout with 0.3 is applied to the outputs of the DACN.
long-term and short-term predictions, our method’s forecast
Gated TCN’s kernel size is set to 2. We initialize two sets
errors are smaller than those on the 12 horizons.
of node embeddings randomly, and each embedding size is
set to 10. In the training process, we optimize the model by 2) Effect of Station Profiling: We use station 0 in the
Adamoptimizerwithalearningrateof0.003.MeanAbsolute Huaian dataset as the research object and exhibit the relation-
Error (MAE), Root Mean Square Error (RMSE), and Mean ships between it and other stations in 12 graphs to evaluate
Absolute Percentage Error (MAPE) are used to evaluate the the efficacy of station profiling in DACN. These graphs are
performance of predictive models. calculatedbythestationprofiles(nodeembedding)andrelated
modelparametersaftertraining.AsshownintheFig.7(a),the
C. Baselines i-th row represents the correlation strength with each station
in the i-th graph. The X-axis represents station number. A
We compare DTMP with the following models:
stronger correlation with station 0 is found at stations 28 and
1) HA: Historical Average model, which calculates the
342.Fig.7(b)showstheflowofstations0,28and342.Wecan
average of historical values to predict the future values.
see that compared with station 0, the flow at stations 28 and
2) ARIMA[35]:Auto-RegressiveIntegratedMovingAver-
342 have the same trend, but station 342 has a leading shift
agemodel,whichisastrategyforpredictingtimeseries.
different from station 28. It demonstrates how station profiles
3) GRU [36]: Gate Recurrent Unit model, a sequence-
capture the complex relationships between stations.
to-sequence model that utilizes GRUs in encoder and
3) Ablation Study: We perform DTMP ablation experi-
decoder.
ments on PeMSD4 and Huaian datasets by eliminating many
4) DCRNN (ICLR 2018) [15]: Diffusion Convolution Re-
components. We design three variant models of DTMP as
current Neural Network, which incorporates diffusion
follows:
graph convolutions with GRU.
5) STGCN (IJCAI 2018) [31]: Spatio-Temporal Graph 1) Nocouplingmapping:DTMPwithoutthecouplingmap-
Convolutional Network, which integrates graph convo- ping between the spatio-temporal modules and between
lutions with gated dilated convolutions. AGCNs. We utilize the same graph in different spatio-
6) GraphWavenet (IJCAI 2019) [11]: Graph WaveNet, temporal modules.
which uses adaptive adjacency to conduct graph convo- 2) No alignment: DTMP without DACN module. We re-
lutions and combines diffusion graph convolutions with placed the DACN with a ordinary GCN based on adap-
gated dilated convolutions. tive graph.23
30 DCRNN DCRNN 45 DCRNN
4DSM
eP no
EAM2222 2468 S G A S DT Tr G TaG F MCp GC h R PNWN N Navenet 4DSM
eP no
)%(EPAM1112 5791 S G A S DT T Tr GaG F MCp GC h R PNWN N Navenet 4DSM
eP no
ESM
R
333344 357913 S G A S DT Tr G Ta FG MCp GC h R PNWN N Navenet
20
31
13
18
29
16 11 27
1 2 3 4 5 6 7 8 9 10 11 12 1 2 3 4 5 6 7 8 9 10 11 12 1 2 3 4 5 6 7 8 9 10 11 12
Horizon Horizon Horizon
(a) MAE (b) MAPE (c) RMSE
Fig.6. ComparisonofpredictionperformanceforeachhorizononthePeMSD4dataset.
TABLEIII
PerformanceonPEMSD4,PEMSD8andHuaiandatasets.
dataset PeMSD4 PeMSD8 Huaian
model
metrics MAE RMSE MAPE MAE RMSE MAPE MAE RMSE MAPE
HA 38.30 56.76 39.63% 31.98 47.49 21.46% 127.4137 227.13 107.41%
ARIMA 26.10 34.40 41.70% 23.11 26.43 26.80% 82.54 94.69 68.85%
GRU 26.93 42.42 18.00% 20.72 32.28 15.05% 89.38 204.57 51.75%
DCRNN 24.66 37.76 17.71% 18.82 28.84 13.49% 80.22 148.44 52.03%
STGCN 24.80 38.69 17.42% 19.86 30.72 13.93% 72.96 134.92 43.50%
GraphWavenet 20.40 32.41 13.83% 16.27 25.74 10.33% 56.86 100.27 38.42%
AGCRN 19.83 32.26 12.97% 15.95 25.22 10.09% 70.92 168.63 41.72%
STFGNN 19.83 31.88 13.02% 16.64 26.22 10.06% 74.73 128.81 45.66%
DTMP 19.07 30.93 12.59% 15.11 24.15 9.63% 54.83 95.68 35.48%
GCN, can capture temporal dependency. The introduction of
DACN allows information to flow directly between different
nodesatdifferenttimes.Itsignificantlyimprovesperformance
on datasets with a large number of nodes. Gated TCN assists
DACN to capture the temporal dependency further.
(a) Graphofstation0forDACN.
TABLEIV
AblationexperimentsonthePeMSD4andHuaiandatasets.
dataset modelelements MAE RMSE MAPE
Nocouplingmapping 19.50 31.44 13.02%
Noalignment 19.95 32.00 13.31%
PeMSD4
NogatedTCN 21.54 35.07 14.63%
(b) Flowofstations0,28,342
All 19.07 30.93 12.59%
Fig.7. Thecaseofstation0.(a)Theadaptivelylearnedrelationshipsbetween Nocouplingmapping 59.74 106.62 39.79%
nodes, with 28 and 342 being the two most relevant station. (b) The traffic Noalignment 61.77 114.30 38.97%
flowbetweenthesetwostationsandstation0. Huaian NogatedTCN 57.83 103.79 36.40%
All 54.83 95.68 35.48%
3) NogatedTCN:DTMPwithoutgatedTCN.Wepassthe
4) Parameter Sensitivity: To further investigate the model,
outputsof DACNto fullyconnectedlayers ignoregated
we conduct parameter experiments on the PeMSD4 dataset,
TCN.
as shown in the Table V. In DACN, kernel size is one key
The results are shown in Table IV, and we could conclude parameter. It determines the number of adaptive graphs used
that the complete model possesses the best performance. in each DACN and the number of convolution operations
Coupling mapping contributes to the model capture more performed. The table shows the model performance results
complexSpatio-temporalrelationships.DACN,comparedwith when the kernel size is 1, 2, 3, and 4. The evaluationmetricsfirstfallasthekernelsizegrowslarger,indicatingthat [5] J. Lee, B. Bagheri, and H.-A. Kao, “A cyber-physical systems archi-
expanding the kernel size can capture more full and intricate tecture for industry 4.0-based manufacturing systems,” Manufacturing
Letters,vol.3,pp.18–23,2015.
dependencies. When the kernel size exceeds 2, therewith, the
[6] G.Bhatti,H.Mohan,andR.RajaSingh,“Towardsthefutureofsmart
metrics begin to rise. The reason for this is that the model electricvehicles:Digitaltwintechnology,”RenewableandSustainable
has grown in complexity, making training more difficult. The EnergyReviews,vol.141,p.110801,2021.
[7] M.Hou,J.Ren,D.Zhang,X.Kong,D.Zhang,andF.Xia,“Network
node embedding records the dependencies between nodes and
embedding:Taxonomies,frameworksandapplications,”ComputerSci-
its dimension is another important parameter. The larger the enceReview,vol.38,p.100296,2020.
dimension, the more information can be stored, but the more [8] M. R. Rahimi, N. Venkatasubramanian, S. Mehrotra, and A. V. Vasi-
lakos,“Onoptimalandfairserviceallocationinmobilecloudcomput-
difficultitistotrainthemodel.Therefore,themodelperforms
ing,”IEEETransactionsonCloudComputing,vol.6,no.3,pp.815–828,
bestwhenthedimensionis10.Ingeneral,themodelmaintains 2018.
a high performance under different parameters and shows the [9] F. Xia, K. Sun, S. Yu, A. Aziz, L. Wan, S. Pan, and H. Liu, “Graph
learning:Asurvey,”IEEETransactionsonArtificialIntelligence,vol.2,
robustness of the model.
no.2,pp.109–127,2021.
[10] X.Kong,K.Wang,M.Hou,X.Hao,G.Shen,X.Chen,andF.Xia,“A
TABLEV federatedlearning-basedlicenseplaterecognitionschemefor5g-enabled
ParameterexperimentsonthePeMSD4dataset. internetofvehicles,”IEEETransactionsonIndustrialInformatics,2021.
[11] Z. Wu, S. Pan, G. Long, J. Jiang, and C. Zhang, “Graph wavenet
for deep spatial-temporal graph modeling,” in Proceedings of the 28th
dataset PeMSD4
Hyperparameter InternationalJointConferenceonArtificialIntelligence(IJCAI),2019.
metrics MAE RMSE MAPE [12] L. Bai, L. Yao, C. Li, X. Wang, and C. Wang, “Adaptive graph
convolutionalrecurrentnetworkfortrafficforecasting,”inProceedings
1 19.43 31.29 12.94% of the 34th Conference on Neural Information Processing Systems
KernelsizeofDACN 2 19.07 30.93 12.59% (NeurIPS),2020.
3 20.01 32.02 13.15%
[13] Z. Wu, S. Pan, G. Long, J. Jiang, X. Chang, and C. Zhang, “Con-
2 19.82 31.79 13.61% nectingthedots:Multivariatetimeseriesforecastingwithgraphneural
5 19.65 31.54 13.16% networks,” in Proceedings of the 26th ACM SIGKDD International
Embeddingdimension 10 19.07 30.93 12.59% ConferenceonKnowledgeDiscovery&DataMining(KDD),2020,pp.
15 19.36 31.15 12.65% 753–763.
20 19.21 30.96 12.71% [14] W. De Mulder, S. Bethard, and M.-F. Moens, “A survey on the appli-
cation of recurrent neural networks to statistical language modeling,”
ComputerSpeech&Language,vol.30,no.1,pp.61–98,2015.
[15] Y.Li,R.Yu,C.Shahabi,andY.Liu,“Diffusionconvolutionalrecurrent
V. CONCLUSION neural network: Data-driven traffic forecasting,” in Proceedings of the
6thInternationalConferenceonLearningRepresentations(ICLR),2018.
For learning interactive spatio-temporal relationships, this
[16] S.Guo,Y.Lin,N.Feng,C.Song,andH.Wan,“Attentionbasedspatial-
paper has proposed a novel graph convolution network based temporal graph convolutional networks for traffic flow forecasting,” in
on a spatio-temporal graph. Furthermore, we have designed Proceedings of the 33rd AAAI Conference on Artificial Intelligence,
vol.33,no.1,2019,pp.922–929.
an adaptive approach to generating alignment and spatial
[17] K.-J. B. Bin He, “Digital twin-based sustainable intelligent manufac-
graphs based on mobility profiling and have proposed dilated turing: a review.” Advances in Manufacturing, vol. 9, no. 3, p. 1–21,
alignment convolution network to simplify the calculation. It 2021.
[18] W.J.SteynandA.Broekman,“Developmentofadigitaltwinofalocal
iscombinedwithgatedTCNandstackedtoobtainthespatio-
roadnetwork:Acasestudy,”JournalofTestingandEvaluation,vol.51,
temporalgraphlearningframeworkDTMPfortrafficforecast- no.1,2021.
ingandmobilityprofiling,anddigitaltwintechnologyisused [19] Y.Wu,K.Zhang,andY.Zhang,“Digitaltwinnetworks:Asurvey,”IEEE
InternetofThingsJournal,vol.8,no.18,pp.13789–13804,2021.
as a cost-effective tool. Extensive experiments and analysis
[20] Z. Wang, X. Liao, X. Zhao, K. Han, P. Tiwari, M. J. Barth, and
haveconfirmedthemodel’simprovedforecastingperformance G.Wu,“Adigitaltwinparadigm:Vehicle-to-cloudbasedadvanceddriver
compared to other techniques, as well as its ability to extract assistancesystems,”in2020IEEE91stVehicularTechnologyConference
(VTC2020-Spring),2020,pp.1–6.
station information. An entirely new perspective on graph
[21] E.Cioroaica,T.Kuhn,andB.Buhnova,“(donot)trustinecosystems,”in
convolutionnetworkswasgainedthroughtheuseofalignment 2019 IEEE/ACM 41st International Conference on Software Engineer-
procedures in order to discover time-dependent correlations. ing:NewIdeasandEmergingResults(ICSE-NIER),2019,pp.9–12.
[22] X.Chen,T.Chen,Z.Zhao,H.Zhang,M.Bennis,andY.JI,“Resource
REFERENCES awareness in unmanned aerial vehicle-assisted mobile-edge comput-
ing systems,” in 2020 IEEE 91st Vehicular Technology Conference
[1] S. Ruan, J. Bao, Y. Liang, R. Li, T. He, C. Meng, Y. Li, Y. Wu, and (VTC2020-Spring),2020,pp.1–6.
Y.Zheng,“Dynamicpublicresourceallocationbasedonhumanmobility [23] S.A.Kumar,R.Madhumathi,P.R.Chelliah,L.Tao,andS.Wang,“A
prediction,” Proc. ACM Interact. Mob. Wearable Ubiquitous Technol., novel digital twin-centric approach for driver intention prediction and
vol.4,no.1,p.22,2020. traffic congestion avoidance,” Journal of Reliable Intelligent Environ-
[2] F.Xia,A.Rahim,X.Kong,M.Wang,Y.Cai,andJ.Wang,“Modeling ments,vol.4,no.4,pp.199–209,2018.
and analysis of large-scale urban mobility for green transportation,” [24] X.Kong,M.Li,K.Ma,K.Tian,M.Wang,Z.Ning,andF.Xia,“Big
IEEETransactionsonIndustrialInformatics,vol.14,no.4,pp.1469– trajectory data: A survey of applications and services,” IEEE Access,
1481,2018. vol.6,pp.58295–58306,2018.
[3] L. Amichi, A. C. Viana, M. Crovella, and A. F. Loureiro, “Mobility [25] E.Toto,E.A.Rundensteiner,Y.Li,R.Jordan,M.Ishutkina,K.Clay-
profiling:Identifyingscoutersinthecrowd,”inProceedingsofthe15th pool,J.Luo,andF.Zhang,“Pulse:Arealtimesystemforcrowdflow
International Conference on Emerging Networking EXperiments and prediction at metropolitan subway stations,” in Joint European Con-
Technologies. AssociationforComputingMachinery,2019,p.9–11. ferenceonMachineLearningandKnowledgeDiscoveryinDatabases,
[4] F.Xia,J.Wang,X.Kong,Z.Wang,J.Li,andC.Liu,“Exploringhuman 2016,pp.112–128.
mobilitypatternsinurbanscenarios:Atrajectorydataperspective,”IEEE [26] F.Xia,J.Wang,X.Kong,D.Zhang,andZ.Wang,“Rankingstationim-
CommunicationsMagazine,vol.56,no.3,pp.142–149,2018. portancewithhumanmobilitypatternsusingsubwaynetworkdatasets,”IEEETransactionsonIntelligentTransportationSystems,vol.21,no.7,
pp.2840–2852,2020.
[27] S. Zhao, T. Zhao, H. Yang, M. R. Lyu, and I. King, “Stellar: spatial-
temporal latent ranking for successive point-of-interest recommenda-
tion,” in Proceedings of the Thirtieth AAAI Conference on Artificial
Intelligence,2016,pp.315–321.
[28] P. Wang, Y. Fu, H. Xiong, and X. Li, “Adversarial substructured
representationlearningformobileuserprofiling,”inProceedingsofthe
25thACMSIGKDDInternationalConferenceonKnowledgeDiscovery
&DataMining,2019,pp.130–138.
[29] P. Wang, K. Liu, L. Jiang, X. Li, and Y. Fu, “Incremental mobile
userprofiling:Reinforcementlearningwithspatialknowledgegraphfor
modeling event streams,” in Proceedings of the 26th ACM SIGKDD
International Conference on Knowledge Discovery & Data Mining
(KDD),2020,pp.853–861.
[30] J.Ye,L.Sun,B.Du,Y.Fu,andH.Xiong,“Coupledlayer-wisegraph
convolution for transportation demand prediction,” Proceedings of the
AAAI Conference on Artificial Intelligence, vol. 35, no. 5, pp. 4617–
4625,2021.
[31] B. Yu, H. Yin, and Z. Zhu, “Spatio-temporal graph convolutional net-
works:adeeplearningframeworkfortrafficforecasting,”inProceedings
of the 27th International Joint Conference on Artificial Intelligence
(IJCAI),2018,pp.3634–3640.
[32] M. Li and Z. Zhu, “Spatial-temporal fusion graph neural networks for
traffic flow forecasting,” in Proceedings of the AAAI Conference on
ArtificialIntelligence,vol.35,no.5,2021,pp.4189–4196.
[33] B. N. Oreshkin, A. Amini, L. Coyle, and M. Coates, “Fc-gaga: Fully
connected gated graph architecture for spatio-temporal traffic forecast-
ing,” Proceedings of the AAAI Conference on Artificial Intelligence,
vol.35,pp.9233–9241,2021.
[34] X.Wang,Y.Ma,Y.Wang,W.Jin,X.Wang,J.Tang,C.Jia,andJ.Yu,
“Traffic flow prediction via spatial temporal graph neural network,” in
ProceedingsofTheWebConference2020. AssociationforComputing
Machinery,2020,p.1082–1092.
[35] W. Min and L. Wynter, “Real-time road traffic prediction with spatio-
temporalcorrelations,”TransportationResearchPartC:EmergingTech-
nologies,vol.19,no.4,pp.606–616,2011.
[36] J.Chung,C.Gulcehre,K.Cho,andY.Bengio,“Empiricalevaluationof
gatedrecurrentneuralnetworksonsequencemodeling,”inNIPS2014
WorkshoponDeepLearning,2014.
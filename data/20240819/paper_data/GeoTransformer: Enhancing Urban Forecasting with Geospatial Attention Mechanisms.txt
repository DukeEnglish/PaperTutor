GeoTransformer: Enhancing Urban Forecasting with
Geospatial Attention Mechanisms
YuhaoJia1,ZileWu2,ShengaoYi3,YifeiSun4,
1IndividualResearcher
yuhaojia98@ucla.edu
2IndividualResearcher
3UniversityofPennsylvania
4TheHongKongUniversityofScienceandTechnology(Guangzhou)
Abstract chitectureandattentionmechanismshaveprovenhighlyef-
fectiveindecodinghigh-dimensionalrepresentationsofnat-
Recent advancements have focused on encoding urban spa-
urallanguage(Vaswanietal.2017a;Devlinetal.2018;Rad-
tial information into high-dimensional spaces, with notable
fordetal.2018)andimages(Dosovitskiyetal.2020a;Rom-
efforts dedicated to integrating sociodemographic data and
satelliteimagery.Theseeffortshaveestablishedfoundational bach et al. 2022). Urban representations, characterized by
models in this field. However, the effective utilization of highdimensionalityandspatialcorrelations,arewell-suited
these spatial representations for urban forecasting applica- for applying similar decoding methods. Some studies have
tions remains under-explored. To address this gap, we in- explored the use of attention mechanisms to capture spa-
troduce GeoTransformer, a novel structure that synergizes tialdependencies,particularlythroughGraphAttentionNet-
the Transformer architecture with geospatial statistics prior. works(GAT)(FengandTassiulas2022;Zhengetal.2020).
GeoTransformer employs an innovative geospatial attention
However,theseapproachesprimarilydependongraphstruc-
mechanism to incorporate extensive urban information and
turesandspatialembeddings.Infact,incorporatinggeospa-
spatialdependenciesintoaunifiedpredictivemodel.Specif-
tial statistical priors might be more effective in encoding
ically, we compute geospatial weighted attention scores be-
spatialdependencies,potentiallyreducingtheneedforcom-
tween the target region and surrounding regions and lever-
agetheintegratedurbaninformationforpredictions.Exten- plexdatastructuringandsimplifyingthesystemdesign.
siveexperimentsonGDPandride-sharedemandprediction Toaddressthisissue,weproposeGeoTransformer,adeep
tasksdemonstratethatGeoTransformersignificantlyoutper- architectureakintoTransformer(Vaswanietal.2017b)that
forms existing baseline models, showcasing its potential to combines geospatial characteristics prior to the attention
enhanceurbanforecastingtasks. mechanism.Thenovelgeospatialattentionmechanismcal-
culates attention between different urban regions weighted
Introduction bydistance,incorporatinginformationfromsurroundingar-
eas.Thisapproachimplicitlyincludesspatialdependencies
Inurbanforecastingtasksinvolvingpredictingeconomicin-
intheattentionmechanism.Extensiveexperimentsdemon-
dicatorsandhumanmobility,classicalmethodsusuallyrely
stratethatourmodelsignificantlyoutperformsseveralbase-
on low-dimensional numeric data, which includes Point of
linemethodsinpredictingGDPandride-sharedemand.
Interest(POI)data(Lietal.2022),surveydata(Roskamand
Ourmaincontributionscanbesummarizedasfollows:
Kunst 2008; DHS et al. 2013), GPS records (Wang et al.
2023a;Moreira-Matiasetal.2013;Pappalardoetal.2013), • WeproposeGeoTransformer,atransformer-akindeepar-
demographiccensus,geospatialfeaturesandsoforth. chitecturedesignedfordecodinghigh-dimensionalurban
Recently, many researchers have explored using high- representationsandenhancingpredictionaccuracy.
dimensionalinformationtofullycapturethecomplexitiesof
• Weintroduceageospatialattentionmechanismthatpri-
urbandynamics.Amaindirectionisutilizingurbanimagery
oritizes attention between regions weighted by spatial
for feature extraction and prediction (Ayush et al. 2020; Li
proximity,assigninghigherweightstocloserregions.
etal.2022;Yehetal.2020;AbdelhalimandZhao2024).A
moreadvanceddirectionisencodingtheurbaninformation • Experiments demonstrate that our method significantly
to a high-dimensional space representation, either through outperforms baseline models in tasks of GDP and ride-
spatialrepresentationlearning(Mai,Li,andLao2023;Wu sharedemandprediction.
etal.2024)orfusingsatelliteimagesandsociodemographic
data(Wangetal.2024).Whilethesestudieshaveestablished RelatedWork
frameworksforencodingurbaninformation,therehasbeen
HighDimensionalInputforUrbanForecasting
limitedinvestigationintooptimizingthesehigh-dimensional
dataforurbanforecasting. Urban forecasting leverages multiple data sources and ad-
Numerous established methods in natural language pro- vanced computational techniques to address challenges
cessing (NLP) and computer vision have effectively har- faced by cities. Traditional methods usually adopt low-
nessedhigh-dimensionaldata.Particularly,Transformerar- dimensional numeric data for prediction. In recent years,
4202
guA
61
]IA.sc[
1v25880.8042:viXrawiththeneedrisingforcomplexpredictiontasksandthede- these models incorporate spatiotemporal attention mecha-
velopmentofdeeplearningtechniques,researchershaveex- nisms, their reliance on graph structures and spatial em-
ploredvariouswaystoleveragehigh-dimensionalurbanin- beddings remains significant for capturing spatial depen-
formation.Onedirectionisdirectlyusingvariousurbanim- dencies. Integrating spatial statistical priors could simplify
ageryforfeatureextractionandprediction.Albert,Kaur,and themodel’srelianceoncomplexdatastructuresandstream-
Gonzalez employ Convolutional Neural Networks (CNNs) linesystemdesign.Tobler’sFirstLawofGeography(Tobler
to detect land-use patterns from satellite images. Ayush 1970),whichpositsthatcloserentitiesaremorelikelytobe
et al.; Li et al.; Yeh et al. utilize urban imagery to predict related, could provide a valuable framework for capturing
socioeconomicstatus.AbdelhalimandZhaoleverageroad- spatial dependency. Despite its potential, the integration of
sideimagerytopredicttransittraveltime. spatial statistical priors with attention mechanisms remains
Recently, encoding urban information into a high- unexplored.
dimensional representation marks a new direction in en- Therefore, in this study, we aim to introduce an atten-
hancing flexibility and prediction accuracy for different ur- tionmechanismguidedbyspatialstatisticalpriorsasanew
banforecastingtasks.Mai,Li,andLaodevelopspatialrep- paradigmforeffectivelyleveraginghigh-dimensionalurban
resentation learning (SRL), utilizing deep neural networks representationdata.
(DNNs) to encode and feature spatial data in the forms of
points,polylines,polygons,graphs,etc.Wangetal.propose EconomicandMobilityIndicatorsPrediction
a theoretical framework deep hybrid model (DHM) fusing GrossDomesticProduct(GDP)isacriticalindicatorinur-
demographic numeric data and satellite images into urban banstudies,offeringvitalinsightsintotheeconomichealth,
latentrepresentations.However,howtoleveragetheseurban developmental patterns, and sustainability of cities(Ribeiro
representationsmoreeffectivelyinpredictiontasksremains et al. 2021; Mahtta et al. 2022; Brilhante and Klaas 2018).
unexplored. Leveraging Nighttime Light (NTL) data to estimate GDP
Transformerandattentionmechanism(Vaswani2017)has asaneconomicindicatorhasbecomeawidelyadoptedap-
beenwidelyadoptedforitsefficiencyincapturingrelation- proach(Liuetal.2021;Sunetal.2020).Thereissubstantial
shipswithinhigh-dimensionalrepresentations.Theyarefirst research indicating a strong association between GDP and
proposed to solve natural language understanding and then urban spatial characteristics (Zhang, He, and Yuan 2020;
visualmodelslikeViT(Dosovitskiyetal.2020b)andStable Zhaoa and Chenb 2023), with numerous studies employ-
Diffusion(Rombachetal.2022)alsoutilizeattentionmech- ingmachinelearningmethodstomodelandpredictregional
anisms to comprehend images and the spatial relationships GDP using structured urban information or urban imagery
betweenimagepatches.Givenitsstrengthinhandlinghigh- data(Kopczewska 2022; Chen et al. 2022b). For example,
dimensionaldataandcapturingspatialrelationships,theat- Chenetal.utilizedeeplearningmethodstopredictcounty-
tentionmechanismiswell-suitedforadaptationinmodeling levelGDPgrids.Whilesubstantialresearchhasestablished
urbanhigh-dimensionalrepresentations. the relationship between GDP and urban spatial character-
istics,theapplicationofhigh-dimensionalurbanrepresenta-
ApproachestoModelingSpatialDependency
tionsforGDPpredictionremainsunderexplored.Giventhe
Spatial dependency has traditionally been addressed using critical role of GDP in validating urban prediction models,
two primary approaches. First, feature engineering meth- we selected GDP estimates derived from Nighttime Light
odslikek-nearestneighbors(KNN)areemployedtoconvert (NTL)dataasabenchmarkforevaluatingourapproach.
surrounding spatial information into features. Second, spa- In addition to economic indicators, mobility indicators
tialstatisticalmethodssuchasspatialerrorregression,spa- such as ride-share demand serve as a critical indicator for
tiallagmodels(Anselin2013),andgeographicallyweighted urban forecasting, and it has significant implications for
regression (GWR) (Fotheringham, Charlton, and Brunsdon transportation planning, economic activity, and population
1998)havebeenwidelyusedtoaccountforspatialautocor- behavior (Komanduri et al. 2018; Ma and Hanrahan 2020;
relation. Zhang and Zhang 2018). For instance, Shaheen et al. em-
Inrecentyears,GraphNeuralNetworks(GNNs)havebe- phasizethatride-shareservicescaninfluencetrafficpatterns,
comeawidelyadoptedmethodforcapturingspatialdepen- reduce private vehicle ownership, and improve accessibil-
dencies,especiallyinspatiotemporalprediction(Wangetal. ityinurbanenvironments.Researchershavedevelopeduti-
2023b;Zhuangetal.2023;Caietal.2020).Urbanbuiltenvi- lizing deep learning methods to predict ride-share demand
ronmentdatasuchasroadnetworks,areinherentlysuitable from urban spatial information(Mu¨hlematter et al. 2023;
forrepresentationasgraphstructuresduetotheirtopologi- Zhao et al. 2022; Zhang and Zhao 2022). Zhao et al. cou-
calproperties.However,grid-basedhigh-dimensionalurban plegraphneuralnetworks(GNNs)withthespatial-temporal
representations often lack clear graph-like structures, mak- influenceofthebuiltenvironment.ZhangandZhaopropose
ing graph construction particularly challenging. Moreover, aClustering-aidedEnsembleModeltoimproveridesourcing
the intrinsic complexity of such high-dimensional data can demandforecasting.Similarly,fewstudieshaveexploredus-
furtherhindertheeffectivetrainingofmodels. ing high-dimensional urban representations to predict ride-
Recent advancements have seen the integration of graph sharedemand.Giventhesignificanceofride-sharedemand
structures with attention mechanisms (Zheng et al. 2020; asakeyindicatorwithstrongspatialdependencies,itserves
Feng and Tassiulas 2022), particularly through Graph At- asanidealbenchmarkforevaluatingtheefficacyofourpro-
tentionNetworks(GATs)(Zhang,Yu,andLiu2019).While posedmethod.Methodology (yˆ Il n,hw,yˆ Il
ˆ
n,hw
∈RHl×Wl×Cl),andscalingbyvectorw lbe-
AsillustratedinFigure1,ourframeworkadoptsanencoder- forecomputingtheL2distance.
decoder structure. The encoder leverages existing state-of- The mixing operator allows for the fusion of sociode-
the-artmethodstoprocessnumericandimageryinputs,rep- mographics and satellite imagery information in a high-
resentingcityregionsinalatentspacethroughamixingop- dimensional latent space. Each region of a city is then en-
erator. Our novel GeoTransformer decoder model then uti- coded into a latent representation using the encoder of the
lizesthislatentrepresentationtopredictGDPandride-share trainedSAE.
demand.
Demographics
Urban Latent Prediction
Representation Encode Latent Decode
E(In) Space D(zn)
zn
Urban Mixing Operator GeoTransformer
Satellite Images SAE Encoder Decoder
Input ImageIn Reconstructed
Trained SAE Image
Figure 1: Our urban forecasting framework uses a mix- Encoder
ing operator to fuse information into latent representations
whicharethenpassedtoGeoTransformerforprediction. Figure 2: The mixing operator is trained by extracting so-
ciodemographic information and reconstructing the input
satelliteimagesfromlatentspace.
Encodethecity:MixingOperator
Tofusesatelliteimageryandsociodemographicinformation
into a high-dimensional latent representation, we adopt a GeoTransformer:Geospatial-weightedAttention
mixingoperatorM,whichcanberepresentedas: Mechanisms
WeproposeanovelapproachGeoTransformertodecodethe
z =M(x ,I ) (1)
n n n
urbanlatentrepresentationsfordownstreamtasksincluding
in which x and I represent the sociodemographics and GDPandride-sharedemandprediction.
n n
satellite imagery inputs, and z n represents the latent repre- AsshowninFigure3,ourmethodadoptsastructureakin
sentationofanurbanarea. totheTransformer(Vaswani2017)decoder.Sincethedown-
Following the work Deep Hybrid Model (Wang et al. stream tasks do not involve sequence prediction, the self-
2024),weadoptasupervisedautoencoder(SAE).TheSAE attention module is optional in this study. We introduce a
maps the imagery into latent variables through the encoder geospatial attention mechanism to capture the spatial de-
E(I n),andreconstructsimagesthroughthedecoderD(z n) pendencies and provide location information between city
andsociodemographicthroughasupervisionnetworkF(z n) regions. The outputs of the decoder layers are then passed
(Figure 2 ). It is trained by optimizing the sum of au- throughafullyconnectedlinearlayer.ThewholesystemG
toencoderlossL AE andsociodemographicsupervisionloss canberepresentedas:
L :
sup
L SAE =(1−λ)L AE +λL sup (2) y n =G(z n,kNN(z n,Z)) (5)
where L sup denotes the absolute error of the sociodemo- inwhichtheinputincludesthelatentrepresentationofare-
graphic variables x . L AE represents the sum of L1 image gion z n and its k-nearest neighbors’ latent representations
reconstruction loss L rec, the KL divergence loss L kl, and kNN(z n,Z)fromallregionsZ,andy nisthepredictedout-
thelearnedperceptualimagepatchsimilaritylossL lpipis: put.
The geospatial attention mechanism is the core compo-
L =α |x−xˆ| (3)
sup 0 nent of our method. It computes attention scores between
L =α L +α L +α L (4) cityregionsandappliesgeospatialweightingtothesescores.
AE 1 rec 2 kl 3 lpipis
Theattentioncalculationisrepresentedas:
in which all the α terms are the adaptive hyperparameters
usedforscalingeachloss. QKT
For each autoencoder loss, L measures the L1 dis- GeoAtt(Q,K,V)=W ⊙softmax( √ )V (6)
rec d
tance between the input images I and reconstructed im- k
n
ages Iˆ in the pixel space, L measures the distance be- wherethequerymatrixQcontainsthelatentrepresentation
n kl
tweentheestimatedlatentdistributionandthestandardnor- ofthequeryregionz forwhichthetargetvariableisbeing
n
mal prior distribution, and L is calculated by extract- predicted,whilethevaluematrixV consistsofz itselfand
lpips n
ing feature stacks from L layers of a pre-trained neural the latent representations of its neighbors as value regions.
network, unit-normalizing them in the channel dimension d denotes the dimension of the key vectors. Intuitively, as
kthe similarity between two city regions is not directly re- Prediction Value
latedtotargetvariables,wesetthekeymatrixKastrainable
weightsratherthanbeingidenticaltoV. Linear
W isthespatialweightingfactor,computedbasedonthe
Add & Norm
spatial distance between query regions in Q and value re- N x
gionsinV.Ourmodelprovideslinearandnon-linearspatial Feed Forward
weightingoptionsbasedontheassumptionofTobler’sFirst
Law of Geography (Tobler 1970), suggesting that regions Add & Norm
closertothequeryregionareassignedhigherweights.
City Regions Multi-Head
LinearNormalization scalesthedistanceswithin0to1, Geospatial
Value Regions Attention
inverselytransformingshorterdistancesintohigherweights:
encode V K Q
d
W j =1− maxj (d) (7) Query Region Add & Norm
Self Attention
whered isthedistancetothejthvalueregion,andmax(d) (Optional)
j
arethemaximumdistancesobserved.
InverseDistanceWeighting(IDW)(Shepard1968) cal- encode Urban Latent
culatesweightsinverselyproportionaltothedistance: Representation
1
W = (8) Figure3:TheGeoTransformerstructureincludesageospa-
j dp+ϵ
j tialattentionmodulethatcalculatesthegeospatialweighted
attentionscoresbetweenthequeryregionanditsneighbor-
where d is the distance to the jth value region, the power
j ingvalueregions.
valuepissetto2instandardapplications,andϵisasmall
constant to prevent division by zero. The weights are then
subsequentlynormalizedtoensuretheysumtounity.
GDPandRide-shareDemandModeling
Gaussian Weighting applies a Gaussian function to the
For the GDP modeling, we use the Global 1km×1km grid-
distances,providingagradualdecreaseinweightasdistance
dedreviseddata(Chenetal.2022a)whichisbasedonnight-
increases:
time light data from DMSP/OLS and NPP/VIIRS sensors.
W
j
=e−( 2d σ2 j 2) (9) The data is calibrated across different years and sensors to
produce a consistent high-resolution dataset. A regression
whered j isthedistancetothejthvalueregion,andσdeter- model is constructed by linking night-time light intensity,
minesthespreadoftheweights.Theweightsarethensub- populationdensity,andotherauxiliaryvariableswithactual
sequentlynormalizedtoensuretheysumtounity. GDP.thegriddedrealGDPcanbecalculatedusing:
Adhering to the established multi-head attention mecha-
nism(Vaswani2017),ourmodelemploysmultipleattention (cid:40) RGY i∗ j,t+1, ifDN ̸=0
heads to capture various spatial relationships concurrently. RGY i∗ j,t = 1+gyij,t ij,t (12)
0, ifDN =0
Thecalculationcanberepresentedas: ij,t
MultiHead(Q,K,V)=Concat(head 1,...,head h)WO whereRGY i∗ j,t denotesthejth gridintheith country’sreal
(10)
GDPintheperiodoftbasedontherevisedrealgrowthrate.
wherehead =GeoAtt(QWQ,KWK,VWV) (11) Thecalculationsarebasedonthehypothesisthatthereisno
i i i i GDP when the DN value is zero. The original GDP data,
whereWQ,WK,WV andWO aretheprojectionmatrices. griddedat1km×1kmresolution,isresampledusingbilinear
i i i
The amount of heads and layers of the decoder module is interpolation.
alsoadaptive. For the ride-share demand modeling, we utilize taxi trip
The GeoTransformer architecture is designed to extract datafromChicagothatisconstantwiththetimeframeofthe
geospatialinformationinhigh-dimensionallatentspace,and remotesensingimagery.Focusingonthepickuplocationsto
itisalsoadaptabletovariousgeospatialpredictiontasksdue represent ride-share demand, we aggregate the demand for
totheflexibilityoftheoutputlayers.Thedesignofgeospa- eachcensustractbycalculatingthetotalnumberofpickups
tialattentionallowsthemodeltocaptureandintegratespa- withineachtract.Subsequently,weapplyarea-weightedav-
tial dependencies, utilizing local context from both the tar- eragingtoestimatetheride-sharedemandcorrespondingto
get region and its surroundings for more accurate predic- eachimagery.Thearea-weightedaverageride-sharedemand
tions. Leveraging high-dimensional urban information and Dforeachimageryiscalculatedasfollows:
deep architectures, our GeoTransformer represents a novel
approachtogeospatialanalysisandurbanplanningapplica- D =
(cid:80)n
i=1D i·A i (13)
tions. (cid:80)n A
i=1 iPanel1Baselineswithonlynumericorimageryinput
Model1:LinearRegression sociodemographicnumericinput(12dim)
Model2:ViT satelliteimageryinput(4*512*512dim),heads=12,layers=12
Panel2Baselineswithurbanlatentrepresentationsinput
Model3:PolynomialRegression latentinput(reduceddimfrom4096to128usingPCA),polyde-
gree=2,l regularizationwithλ=0.5
2
Model4:GAT latentinput(4096dim),layers=4
Panel3GeoTransformerwith3geospatialweightingmethods
Model5:LinearWeighting latentinput(4096dim),heads=16,layers=4,neighbors=49/81
Model6:IDWWeighting latentinput(4096dim),heads=16,layers=4,neighbors=49/81
Model7:GaussianWeighting latentinput(4096dim),heads=16,layers=4,neighbors=81/169
Table1:TrainingsettingsofbaselinesandGeoTransformermodels.
where D is the ride-share demand (number of pickups) detailed information at the census tract level, including
i
inthei-thcensustract,A istheareaofthei-thcensustract, variables such as median rent, racial composition, median
i
and n is the total number of census tracts. This approach householdincome,theGiniindex,andsoon.
allowsustoalignthespatialresolutionofthetaxitripdata
Mixing Operator Training. We utilize the VAE compo-
with the remote sensing imagery, facilitating accurate and
nent from Stable Diffusion (Rombach et al. 2022) as the
effectivemodelingofride-sharedemand.
initial weights for the mixing operator. To accommodate
a 4096-dimensional latent space, linear layers are intro-
Experiment
ducedatboththeencoder’soutputandthedecoder’sinput.
In this section, we provide our method’s results in GDP Thedecoderreconstructsimagesusingmeanabsoluteerror
and ride-share demand prediction and compare them with (MAE) as the reconstruction loss. An annealing strategy is
baseline methods. Ablation experiments are conducted to adoptedfortheKLdivergenceloss,graduallyincreasingits
demonstrate the effectiveness of the geospatial attention weightratio.Additionally,thelatentspacerestoressociode-
componentandmodelarchitecturedesign. mographicinformationthroughafeed-forwardmodule,em-
ploying mean squared error (MSE) as the loss metric. The
ExperimentSetup trainingprocessspans100epochsintotal.Thelatentrepre-
DataPreparation. Forthesatelliteimagerydata,weuti- sentation for each region is inferred using the encoder part
lized the National Agriculture Imagery Program (NAIP) ofthemixingoperator.
four-band remote sensing imagery for the Greater Chicago
Baselines. Wetrainvariousbaselinemodelsforcompari-
Area,acquiredinSeptember2019.Theimageryhasahigh
son.AsdetailedinTable1,modelsinPanel1utilizeeither
spatialresolutionof0.6meters.UsingGoogleEarthEngine,
directnumericorimageryinput.Specifically,Model1em-
wedownloadthedatasetandsubsequentlydivideitintotiles
ploysalinearregressionconfiguredwith12-dimensionalso-
ofsize512x512tofacilitateouranalysis.
ciodemographicdataasinput.Model2utilizesapre-trained
For spatial correspondence between structured and un-
VisualTransformer(ViT)(Dosovitskiyetal.2020a),which
structuredinformation,wecreatedafishnetgridwithacell
is subsequently fine-tuned on the prediction tasks with the
size of 500m×500m, aligned it with the same geospatial
last4encoderlayersandtheoutputlayerunfrozen.Panel2
location as the maptile data, and resampled the 1km×1km
presents models that utilize latent representations as inputs
griddedGDPdatatomatchthefishnet.
toperformpredictions.FollowingDHM(Wangetal.2024),
Fortheride-sharedemand,weusetheTaxiTripsdataset
model3employsapolynomialregression.Model4adoptsa
obtainedfromtheCityofChicago.Thedatasetincludesfun-
GraphAttentionNetwork(GAT)(Zhang,Yu,andLiu2019)
damental trip information such as unique ID, pickup and
modelwitheachcityregionasanodeconnectedtoitsneigh-
drop-offtimestamps,latitudeandlongitudecoordinates,trip
bors, forming the graph structure. All hyperparameters for
miles, fare, and other relevant details. To align the spatial
training the baseline models are optimized through a grid
resolution of the taxi trip data with the satellite imagery
searchtoensurepeakperformanceonthetestset.
tiles,weperformedaspatialjoin.Thisprocessallowsusto
calculate the ride-share demand corresponding to each tile, GeoTransformerTraining. AsshowninTable1panel3,
ensuring accurate and effective integration of the two data wetraintheGeoTransformer(model5-7)usingthreespatial
sources. weighting methods. The number of decoder layers is set to
In addition to the imagery and ride-share data, we in- 4, and the number of attention heads is set to 16. For each
corporatesociodemographicdatafromtheAmericanCom- model variant and task, the L2 regularization decay weight
munity Survey (ACS) 2015-2019. This dataset provides wasoptimized,witharangeof0.0001to0.1,whilethenum-GDP Ride-shareDemand
Model
MSE↓ MAE↓ R2 MSE×107↓ MAE×103↓ R2
Panel1Baselineswithonlynumericorimageryinput
1LinearRegression 3.22/3.13 1.44/1.43 0.159/0.151 8.45/6.11 8.36/5.99 0.668/0.720
2ViT 0.616/0.828 0.595/0.703 0.822/0.759 15.6/22.5 4.10/4.16 0.526/0.315
Panel2Baselineswithurbanlatentrepresentationsinput
3PolynomialRegression 2.19/3.25 1.17/1.46 0.429/0.118 12.8/19.5 5.05/6.00 0.494/0.335
4GAT 0.469/0.726 0.476/0.602 0.866/0.805 7.21/9.51 2.01/2.35 0.750/0.575
Panel3GeoTransformerwith3geospatialweightingmethods
5LinearWeighting 0.081/0.216 0.210/0.346 0.979/0.944 1.62/7.26 0.98/2.53 0.934/0.779
6IDWWeighting 0.570/0.686 0.537/0.585 0.849/0.822 0.172/3.02 0.491/1.16 0.993/0.908
7GaussianWeighting 0.448/0.567 0.486/0.533 0.882/0.852 0.263/9.78 0.469/3.97 0.989/0.703
Table2:PredictiveperformanceofbaselinesandGeoTransformermodels.Eachentryisrepresentedastraining/testingperfor-
mance.
berofneighboringregionsissetto49,81,or169.Allparam- fluencedbysociodemographicfactors.Bothpolynomialre-
eters are grid-searched to ensure the best performance. For gressionandGATmodelsstruggletoeffectivelydecodela-
bothGDPandride-sharedemandpredictions,meansquared tent representations for accurate predictions. However, our
error(MSE)isemployedasthelossfunction.Allmodelsare GeoTransformer model with IDW weighting outperforms
trainedonanRTX4090GPUrunningUbuntu22.04. the best baseline by 18% in R2 on the test set. Addition-
ally,amongtheGeoTransformervariants,itisobservedthat
Evaluation Metrics. We employ commonly used statis-
the IDW model not only achieves the highest performance
tical metrics that evaluate the accuracy of the predictions,
butalsoexhibitsthefastestconvergence.
including Mean Squared Error (MSE), Mean Absolute Er-
ror (MAE), and R-squared (R2). MSE evaluates the aver-
age squared differences between predicted and actual val-
ues, MAE measures the average absolute differences, and
(R2) assesses the proportion of variance explained by the
model.
EvaluationResults
Table 2 summarizes the predictive performance evaluation
of baselines and GeoTransformer models in both GDP and
ride-sharedemandpredictiontasks.
(a) northwest area of Gresham community (b) a(cid:425)en(cid:415)on map of query region
GDP Prediction. As shown in Table 2, all three Geo-
Transformer models surpass every baseline model. Com-
paredtoRandomForestandViTinpanel1,ourbestmodel Figure 4: An example of the attention map between the
(linear weighting) outperforms by 27% and 18% respec- queryregionanditsneighboringvalueregions.
tivelyinR2.InPanel2,theGATmodelexhibitsrobustde-
coding capabilities for urban latent representations and de-
Qualitative Analysis. To investigate the functionality of
livers the best predictive accuracy among baseline models,
the geospatial attention mechanism, we visualize several
while our GeoTransformer with linear weighting surpasses
it by 14% in R2. This demonstrates that our geospatial at- query regions’ attention maps with their neighboring value
regions. We present an example in Figure 4, which (a) in-
tention mechanismeffectively models spatial dependencies
cludessatelliteimagesofthenorthwestareaoftheGresham
without the need for predefined graph structures. In panel
community, with the query region marked by a red marker
3,amongthethreeGeoTransformermodelsoperatingunder
(Figure 4), and its attention map for GDP prediction. The
identicalparametersandtrainingepochs,thelinearweight-
query region focuses on its own community area, nearby
ingapproachexhibitsthebestpredictiveperformance.
amenities (the park in the lower left and the supermarket
Ride-shareDemandPrediction. TheresultsinPanel1of and church in the upper right), and critical road infrastruc-
Table2indicatethatride-sharedemandismorestronglyin- ture (the freeway entrance in the upper left). These resultsvalidatetheeffectivenessofthegeospatialattentionmecha- Model MSE↓ MAE↓ R2
nisminaccuratelycapturingurbanfeaturesrelevanttoGDP. FixedK 0.241/0.410 0.364/0.464 0.936/0.893
TrainableK 0.081/0.216 0.210/0.346 0.979/0.944
AblationStudy
Toinvestigatethenecessityandeffectivenessofeachdesign
Table3:ComparisonwithlinearweightingGeoTransformer
in GeoTransformer, we conduct ablation experiments for
withfixedK matrixortrainableK matrix.
geospatial weighting, trainable key matrices, and the num-
berofneighboringvalueregions.
and expanding outward in a square, k is determined by the
squareofthesidelength.Welinearlyincreasethesidelength
10 Linear
toidentifytheoptimalkthatmaximizesmodelperformance.
IDW
Gaussian ForGDPprediction,providingthemodelwithabroader
8
No Weighting
rangeofurbaninformationinitiallyleadstoanimprovement
6 inaccuracy.However,askincreasesfurther,themodelmay
becomeoverwhelmedbyexcessiveinformation,resultingin
4 adeclineinaccuracy(Figure6).
Asimilartrendisobservedintheride-sharedemandpre-
2 diction, where increasing k initially enhances model accu-
racy. The model performs best when k is set to 49 or 81.
0
0 10 20 30 40 50 However, further increasing k by incorporating additional
Epoch neighboringinformationleadstoadeclineinaccuracy(Fig-
Figure 5: The GDP prediction accuracy comparison on ure6).
the test set between no weighting attention and geospatial
weightedattentionduringthetrainingprocess.
1e8
Ride-share demand Prediction GDP Prediction
1.2
GeospatialAttentionModule. Todemonstratetheeffec-
1.0
tiveness of the geospatial attention module, we conducted 1.0
a controlled experiment by training an alternative version
0.8 0.8
ofthemodeldevoidoftheweightingattentionmechanism.
This baseline model maintained the same architecture and 0.6
0.6
training parameters as the GeoTransformer models, featur- 0.4
ing 16 heads, 81 neighbors, 4 layers, and an L2 regular-
0.4 0.2
izationdecayweightof0.0001,trainedover50epochs.As
shown in Figure 5, the comparative analyses illustrate that 0.0
0 50 100 150 200 250
allthreegeospatialattentionvariantssignificantlyenhanced k Nearest Neighbors
theGDPpredictionaccuracy.
Figure 6: Prediction accuracy comparison across k nearest
Trainable Key Matrices. Intuitively, the correlation be- neighbors.
tween different regions in urban forecasting is not directly
determined by the similarity between these regions. There-
fore, we set the key matrix in the attention mechanism as ConclusionandDiscussion
trainable parameters to flexibly adjust the correlation be-
We propose a GeoTransformer structure to extract infor-
tween the value regions and the query region. To validate
mationfromhigh-dimensionalurbanlatentrepresentations.
theeffectivenessofthisdesign,wetrainaGeoTransformer
ThenovelgeospatialattentionmechanismallowsGeoTrans-
modelbysettingkeymatricesKfixedandidenticaltovalue
former to capture extensive urban information and its spa-
matrices V, while keeping all other settings constant. As
tial dependency. The experimental results demonstrate the
shown in Table 3, linear weighting GeoTransformer with
capacity of our method in urban forecasting tasks. An ab-
trainableK achieveshigherpredictionaccuracyover5%in
lationstudyisconductedtovalidatetheeffectivenessofthe
R2.ItisalsoobservedthatthefixedKGeoTransformercon-
geospatialattentionmechanismandthedesignofGeoTrans-
verges faster during training, which is reasonable given its
former.
smallernumberoftrainableparameters.However,theflexi-
Self-attention module in Transformer (Vaswani 2017) is
bilityofatrainableKallowsthemodeltoultimatelyachieve
primarily intended for sequence prediction tasks. In urban
higheraccuracy.
forecasting, spatiotemporal prediction tasks also resemble
k-Nearest Neighbors. The spatial extent of surrounding sequence prediction. Although this study does not activate
information required by the query region may vary for dif- theself-attentionmodule,weretainitintheGeoTransformer
ferenturbanforecastingtasks.Therefore,wesearchforthe as it holds the potential for adapting to spatiotemporal se-
optimalnumberofneighboringregionskforGDPandride- quence prediction tasks. This merits further exploration in
sharedemandpredictions.Bycenteringonthequeryregion subsequentresearch.
ssoL
ESM
tseT
)erahs-ediR(
ssoL
ESM
tseT
)PDG(
ssoL
ESM
tseTReferences Komanduri,A.;Wafa,Z.;Proussaloglou,K.;andJacobs,S.
Abdelhalim, A.; and Zhao, J. 2024. Computer vision for 2018. Assessingtheimpactofapp-basedridesharesystems
transit travel time prediction: an end-to-end framework us- in an urban context: Findings from Austin. Transportation
ingroadsideurbanimagery. PublicTransport,1–26. ResearchRecord,2672(7):34–46.
Albert,A.;Kaur,J.;andGonzalez,M.C.2017. Usingcon- Kopczewska, K. 2022. Spatial machine learning: new op-
volutionalnetworksandsatelliteimagerytoidentifypatterns
portunitiesforregionalscience.TheAnnalsofRegionalSci-
inurbanenvironmentsatalargescale.InProceedingsofthe ence,68(3):713–755.
23rdACMSIGKDDinternationalconferenceonknowledge Li,T.;Xin,S.;Xi,Y.;Tarkoma,S.;Hui,P.;andLi,Y.2022.
discoveryanddatamining,1357–1366. Predictingmulti-levelsocioeconomicindicatorsfromstruc-
Anselin,L.2013. Spatialeconometrics:methodsandmod- turalurbanimagery. InProceedingsofthe31stACMinter-
els,volume4. SpringerScience&BusinessMedia. national conference on information & knowledge manage-
ment,3282–3291.
Ayush, K.; Uzkent, B.; Burke, M.; Lobell, D.; and Ermon,
S.2020. Generatinginterpretablepovertymapsusingobject Liu,H.;He,X.;Bai,Y.;Liu,X.;Wu,Y.;Zhao,Y.;andYang,
detectioninsatelliteimages. IJCAIInternationalJointCon- H. 2021. Nightlight as a proxy of economic indicators:
ferenceonArtificialIntelligence,2021-Janua:4410–4416. Fine-grained GDP inference around Chinese mainland via
attention-augmented CNN from daytime satellite imagery.
Brilhante,O.;andKlaas,J.2018. Greencityconceptanda
RemoteSensing,13(11):2067.
methodtomeasuregreencityperformanceovertimeapplied
tofiftycitiesglobally:InfluenceofGDP,populationsizeand Ma,N.F.;andHanrahan,B.V.2020. Unpackingsharingin
energyefficiency. Sustainability,10(6):2031. the peer-to-peer economy: The impact of shared needs and
backgrounds on ride-sharing. Proceedings of the ACM on
Cai, L.; Janowicz, K.; Mai, G.; Yan, B.; and Zhu, R. 2020.
Human-ComputerInteraction,4(CSCW1):1–19.
Traffictransformer:Capturingthecontinuityandperiodicity
of time series for traffic forecasting. Transactions in GIS, Mahtta,R.;Fragkias,M.;Gu¨neralp,B.;Mahendra,A.;Reba,
24(3):736–755. M.;Wentz,E.A.;andSeto,K.C.2022. Urbanlandexpan-
sion: the role of population and economic growth for 300+
Chen, J.; Gao, M.; Cheng, S.; Hou, W.; Song, M.; Liu, X.;
cities. NpjUrbanSustainability,2(1):5.
andLiu,Y.2022a. Global1km×1kmgriddedrevisedreal
gross domestic product and electricity consumption during Mai, G.; Li, Z.; and Lao, N. 2023. Spatial Representation
1992–2019basedoncalibratednighttimelightdata. Scien- Learning in GeoAI. In Handbook of Geospatial Artificial
tificData,9(1):202. Intelligence,99–120.BocaRaton,FL:CRCPress.
Chen,Y.;Wu,G.;Ge,Y.;andXu,Z.2022b. Mappinggrid- Moreira-Matias, L.; Gama, J.; Ferreira, M.; Mendes-
dedgrossdomesticproductdistributionofChinausingdeep Moreira,J.;andDamas,L.2013. Predictingtaxi–passenger
learning with multiple geospatial big data. Ieee Journal of demandusingstreamingdata. IEEETransactionsonIntel-
SelectedTopicsinAppliedEarthObservationsandRemote ligentTransportationSystems,14(3):1393–1402.
Sensing,15:1791–1802. Mu¨hlematter,D.J.;Wiedemann,N.;Xin,Y.;andRaubal,M.
Devlin,J.;Chang,M.-W.;Lee,K.;andToutanova,K.2018. 2023.Spatially-awarecar-sharingdemandprediction.arXiv
Bert:Pre-trainingofdeepbidirectionaltransformersforlan- preprintarXiv:2303.14421.
guageunderstanding. arXivpreprintarXiv:1810.04805. Pappalardo,L.;Rinzivillo,S.;Qu,Z.;Pedreschi,D.;andGi-
DHS, M.; et al. 2013. Demographic and health surveys. annotti, F. 2013. Understanding the patterns of car travel.
Calverton:MeasureDHS. TheEuropeanPhysicalJournalSpecialTopics,215:61–73.
Dosovitskiy, A.; Beyer, L.; Kolesnikov, A.; Weissenborn, Radford, A.; Narasimhan, K.; Salimans, T.; Sutskever, I.;
D.; Zhai, X.; Unterthiner, T.; Dehghani, M.; Minderer, M.; et al. 2018. Improving language understanding by gener-
Heigold,G.;Gelly,S.;etal.2020a.Animageisworth16x16 ativepre-training.
words: Transformers for image recognition at scale. arXiv Ribeiro,H.V.;Oehlers,M.;Moreno-Monroy,A.I.;Kropp,
preprintarXiv:2010.11929. J. P.; and Rybski, D. 2021. Association between popula-
Dosovitskiy, A.; Beyer, L.; Kolesnikov, A.; Weissenborn, tion distribution and urban GDP scaling. Plos one, 16(1):
D.; Zhai, X.; Unterthiner, T.; Dehghani, M.; Minderer, M.; e0245771.
Heigold, G.; Gelly, S.; et al. 2020b. An image is worth Rombach,R.;Blattmann,A.;Lorenz,D.;Esser,P.;andOm-
16x16 words: Transformers for image recognition at scale. mer,B.2022. High-resolutionImageSynthesiswithLatent
arXivpreprintarXiv:2010.11929. DiffusionModels. InProceedingsoftheIEEE/CVFConfer-
Feng, A.; and Tassiulas, L. 2022. Adaptive graph spatial- enceonComputerVisionandPatternRecognition(CVPR),
temporaltransformernetworkfortrafficforecasting.InPro- 10684–10695.NewOrleans,LA:IEEE.
ceedingsofthe31stACMinternationalconferenceoninfor- Roskam, A.-J. R.; and Kunst, A. E. 2008. The predictive
mation&knowledgemanagement,3933–3937. valueofdifferentsocio-economicindicatorsforoverweight
Fotheringham, A. S.; Charlton, M. E.; and Brunsdon, C. innineEuropeancountries. Publichealthnutrition,11(12):
1998. Geographically weighted regression: a natural evo- 1256–1266.
lutionoftheexpansionmethodforspatialdataanalysis. En- Shaheen, S.; Chan, N.; Bansal, A.; and Cohen, A. 2015.
vironmentandplanningA,30(11):1905–1927. Shared mobility: Definitions, industry developments, andearlyunderstanding.TransportationSustainabilityResearch Zhang, Y.; and Zhang, Y. 2018. Exploring the relation-
Center,InnovativeMobilityResearch. shipbetweenridesharingandpublictransituseintheUnited
Shepard,D.1968.Atwo-dimensionalinterpolationfunction States. Internationaljournalofenvironmentalresearchand
forirregularly-spaceddata. InProceedingsofthe196823rd publichealth,15(8):1763.
ACMnationalconference,517–524. Zhao,T.;Huang,Z.;Tu,W.;He,B.;Cao,R.;Cao,J.;andLi,
Sun,J.;Di,L.;Sun,Z.;Wang,J.;andWu,Y.2020. Estima- M.2022.Couplinggraphdeeplearningandspatial-temporal
tionofGDPusingdeeplearningwithNPP-VIIRSimagery influenceofbuiltenvironmentforshort-termbustravelde-
and land cover data at the county level in CONUS. IEEE mandprediction. Computers,EnvironmentandUrbanSys-
Journal of Selected Topics in Applied Earth Observations tems,94:101776.
andRemoteSensing,13:1400–1415. Zhaoa, L.; and Chenb, B. 2023. Analysis and Forecast of
Tobler, W. R. 1970. A computer movie simulating ur- GDPinShaoguanCityBasedonARIMAModel. Academic
ban growth in the Detroit region. Economic geography, JournalofBusiness&Management,5(21):117–122.
46(sup1):234–240. Zheng, C.; Fan, X.; Wang, C.; and Qi, J. 2020. GMAN: A
Vaswani,A.2017. Attentionisallyouneed. arXivpreprint Graph Multi-Attention Network for Traffic Prediction. In
arXiv:1706.03762. Proceedings of the AAAI Conference on Artificial Intelli-
Vaswani, A.; Shazeer, N.; Parmar, N.; Uszkoreit, J.; Jones, gence,1234–1241.MenloPark,Calif.:AAAIPress.
L.;Gomez,A.N.;Kaiser,Ł.;andPolosukhin,I.2017a. At- Zhuang, D.; Bu, Y.; Wang, G.; Wang, S.; and Zhao, J.
tentionisallyouneed. Advancesinneuralinformationpro- 2023. SAUC: Sparsity-Aware Uncertainty Calibration for
cessingsystems,30. SpatiotemporalPredictionwithGraphNeuralNetworks. In
Vaswani, A.; Shazeer, N.; Parmar, N.; Uszkoreit, J.; Jones, TemporalGraphLearningWorkshop@NeurIPS2023.
L.;Gomez,A.N.;Kaiser,L.;andPolosukhin,I.2017b. At-
tentionIsAllYouNeed. arXiv:1706.03762.
Wang, Q.; Wang, S.; Zheng, Y.; Lin, H.; Zhang, X.; Zhao,
J.; and Walker, J. 2024. Deep hybrid model with satellite
imagery:Howtocombinedemandmodelingandcomputer
visionfortravelbehavioranalysis?TransportationResearch
PartB:Methodological,179:102869.
Wang,Z.;Sun,Y.;Lei,Z.;Zhu,X.;andSun,P.2023a. SST:
ASimplifiedSwinTransformer-basedModelforTaxiDes-
tination Prediction based on Existing Trajectory. In 2023
IEEE 26th International Conference on Intelligent Trans-
portationSystems(ITSC),1404–1409.
Wang,Z.;Zhuang,D.;Li,Y.;Zhao,J.;Sun,P.;Wang,S.;and
Hu, Y. 2023b. ST-GIN: An uncertainty quantification ap-
proachintrafficdataimputationwithspatio-temporalgraph
attentionandbidirectionalrecurrentunitedneuralnetworks.
In 2023 IEEE 26th International Conference on Intelligent
TransportationSystems(ITSC),1454–1459.IEEE.
Wu, N.; Cao, Q.; Wang, Z.; Liu, Z.; Qi, Y.; Zhang, J.; Ni,
J.; Yao, X.; Ma, H.; Mu, L.; Ermon, S.; Ganu, T.; Nambi,
A.; Lao, N.; and Mai, G. 2024. TorchSpatial: A Location
EncodingFrameworkandBenchmarkforSpatialRepresen-
tationLearning. arXivpreprintarXiv:2406.15658.
Yeh,C.;Perez,A.;Driscoll,A.;Azzari,G.;Tang,Z.;Lobell,
D.;Ermon,S.;andBurke,M.2020.Usingpubliclyavailable
satelliteimageryanddeeplearningtounderstandeconomic
well-beinginAfrica. Naturecommunications,11(1):2583.
Zhang,C.;Yu,J.J.Q.;andLiu,Y.2019. Spatial-Temporal
GraphAttentionNetworks:ADeepLearningApproachfor
TrafficForecasting. IEEEAccess,7:166246–166256.
Zhang,J.;He,X.;andYuan,X.-D.2020.Researchonthere-
lationshipbetweenUrbaneconomicdevelopmentleveland
urbanspatialstructure—AcasestudyoftwoChinesecities.
PLoSOne,15(7):e0235858.
Zhang,X.;andZhao,X.2022. Machinelearningapproach
for spatial modeling of ridesourcing demand. Journal of
TransportGeography,100(C).
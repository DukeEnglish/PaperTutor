Draft version August 19, 2024
TypesetusingLATEXtwocolumnstyleinAASTeX631
Accelerating Giant Impact Simulations with Machine Learning
Caleb Lammers ,1 Miles Cranmer ,2,3,4 Sam Hadden ,5 Shirley Ho ,6,1,7 Norman Murray ,5,8 and
Daniel Tamayo 9
1Department of Astrophysical Sciences, Princeton University, 4 Ivy Lane, Princeton, NJ 08544, USA
2Department of Applied Mathematics and Theoretical Physics, University of Cambridge, Wilberforce Road, Cambridge, CB3 0WA, UK
3Institute of Astronomy, University of Cambridge, Madingley Road, Cambridge, CB3 0HA, UK
4Kavli Institute for Cosmology, University of Cambridge, Madingley Road, Cambridge, CB3 0HA, UK
5Canadian Institute for Theoretical Astrophysics, University of Toronto, 60 St. George Street, Toronto, ON M5S 3H8, Canada
6Center for Computational Astrophysics, Flatiron Institute, New York, NY 10010, USA
7Department of Physics & Center for Data Science, New York University, 726 Broadway, New York, NY 10003, USA
8Department of Physics, University of Toronto, 60 St. George Street, Toronto, ON M5S 1A7, Canada
9Department of Physics, Harvey Mudd College, Claremont, CA 91711, USA
ABSTRACT
Constraining planet formation models based on the observed exoplanet population requires gen-
erating large samples of synthetic planetary systems, which can be computationally prohibitive. A
significant bottleneck is simulating the giant impact phase, during which planetary embryos evolve
gravitationally and combine to form planets, which may themselves experience later collisions. To ac-
celerategiantimpactsimulations,wepresentamachinelearning(ML)approachtopredictingcollisional
outcomes in multiplanet systems. Trained on more than 500,000 N-body simulations of three-planet
systems, we develop an ML model that can accurately predict which two planets will experience a
collision, along with the state of the post-collision planets, from a short integration of the system’s
initial conditions. Our model greatly improves on non-ML baselines that rely on metrics from dy-
namics theory, which struggle to accurately predict which pair of planets will experience a collision.
By combining with a model for predicting long-term stability, we create an efficient ML-based giant
impact emulator, which can predict the outcomes of giant impact simulations with a speedup of up
to four orders of magnitude. We expect our model to enable analyses that would not otherwise be
computationally feasible. As such, we release our full training code, along with an easy-to-use API for
our collision outcome model and giant impact emulator.a)
Keywords: exoplanets — extrasolar rocky planets — planet formation — planetary dynamics
1. INTRODUCTION Chambers & Wetherill 1998; Agnor et al. 1999; Cham-
bers 2001; Raymond et al. 2005; Kokubo et al. 2006;
The nebular hypothesis, initially proposed by Im-
Raymond et al. 2008; Hansen & Murray 2012).
manuelKant(Kant1755)andlaterbuiltuponbyPierre
Interest in terrestrial planet formation has been re-
Laplace (Laplace 1796), remains the leading explana-
invigoratedbythediscovery,duetoNASA’sKeplermis-
tion for the formation of planetary systems. In the
sion, that compact multiplanet systems are remarkably
modern picture, terrestrial planets form out of a pro-
common in the galactic neighbourhood (Borucki et al.
toplanetary disk before experiencing a phase of giant
2011; Lissauer et al. 2011; Fressin et al. 2013; Fabrycky
impacts in which planets grow via collisions (see, e.g.,
et al. 2014; Zhu et al. 2018). Planets in these systems
Lissauer 1993). Giant impacts are therefore believed to
typically possess short periods, sub-Neptune radii and
play an important role in shaping the orbital configura-
masses, low eccentricities, and low inclinations. Moti-
tionofplanetarysystems,andtherehasbeensignificant
vated by the tight dynamical spacing of planets in ob-
efforttosimulatethisprocess(e.g.,Kokubo&Ida1998;
served systems (Pu & Wu 2015; Volk & Gladman 2015)
and the inability of these systems to host additional in-
a) https://github.com/dtamayo/spock tervening planets (Fang & Margot 2013; Obertas et al.
4202
guA
61
]PE.hp-ortsa[
1v37880.8042:viXra2 Lammers et al.
2023), it is believed that observed systems are shaped at which a compact planetary system will destabilize.
bydynamicalinstabilitiesarisingovertheirgigayearlife- These tools have enabled investigations into the long-
times. In general, close encounters between planets can term stability of planetary systems that would not oth-
result in planet-planet collisions, planet-star collisions, erwise be computationally feasible (e.g., Tamayo et al.
orejections. However, planetsintypicaltransitingmul- 2021; Yee et al. 2021; Bailey & Fabrycky 2022; Tejada
tiplanet systems orbit with semi-major axes for which Arevalo et al. 2022; Obertas et al. 2023; Sobski & Mill-
dynamical instabilities nearly always result in planet- holland 2023). The development of SPOCKII was also
planet collisions. motivated by the possibility of accelerating giant im-
Numerical simulations of the giant impact phase pact simulations. Towards this end, here we present
have been successful in reproducing many properties of an ML-based approach to predicting the outcomes of
the observed population of multiplanet systems (e.g., planet-planet collisions in N-body simulations.
Hansen & Murray 2013; Izidoro et al. 2017; Poon et al. Thispaperisorganizedasfollows: Section2describes
2020; Goldberg & Batygin 2022; Lammers et al. 2023; our training set and machine learning model. We eval-
Ghosh & Chatterjee 2024). These simulations typi- uate the performance of our model and compare it with
cally begin with a collection of overly packed plan- non-ML approaches in Section 3. Discussion and con-
ets1 and evolve forward in time using a hybrid inte- clusions are presented in Section 4.
grator (e.g., mercury6 Chambers 1999 or MERCURIUS
Rein et al. 2019). Hybrid integrators make long-term 2. MACHINE LEARNING MODEL
integrations computationally feasible by using a rapid
2.1. Training dataset
Wisdom-Holman integrator (Wisdom & Holman 1991)
To train our ML model, we require a large collection
when planets are widely separated, switching to a high-
ofN-bodysimulationsinwhichtwoplanetsexperiencea
precision integrator only when it is necessary to resolve
physical collision. Unfortunately, the SPOCKI training
a close encounter. Before reaching the maximum in-
dataset (which was also used in SPOCKII) is unsuit-
tegration time, systems in these simulations continu-
able for this purpose due to choices made to tailor the
ally destabilize, resulting in collisions between planets
datasetforpredictinglong-termstability(e.g., stopping
(which are typically treated as perfect inelastic merg-
N-body integrations when the Hill spheres of two plan-
ers). Due to the chaotic nature of multiplanet systems,
ets intersect). As a result, for this work, we generate a
outcomesofsuchnumericalexperimentsareonlymean-
new training set of N-body simulations. Motivated by
ingful in a statistical sense, necessitating simulations of
the intention that our model will often be used in tan-
many realizations with different initial conditions.
dem with SPOCKII, we sample initial conditions that
Efforts to numerically model this process are limited
span a similar region of parameter space.
by the computational cost of running large samples of
AsintheSPOCKtrainingset,werestrictourdataset
long-termN-bodysimulations. Inrecentyears,machine
to systems of three planets. This simplification is moti-
learning(ML)techniqueshavebeensuccessfullyapplied
vatedbythefindingthatthereisaqualitativechangein
toaccelerateN-bodysimulations,bothinthecosmolog-
the instability behavior between two- and three-planet
ical(Heetal.2019b;Jamiesonetal.2023)andplanetary
systems, but little change when additional planets are
(Tamayo et al. 2020; Cranmer et al. 2021) contexts. In
included in the system (e.g., Chambers et al. 1996; Pe-
particular, Tamayo et al. (2020) (hereafter, SPOCKI)
tit et al. 2020). Theoretically, this is believed to be due
presented an ML model to predict whether a compact
to the importance of mean motion resonances (MMRs)
planetary system is stable over 109 orbits (here, and
betweenadjacentplanets,andthesecondaryresonances
throughout the paper, the “orbits” unit refers to the
they generate, in driving multiplanet systems to desta-
initial orbital period of the innermost planet), based on
bilize (Quillen 2011; Petit et al. 2020; Lammers et al.
summary statistics calculated over a short 104 orbit in-
2024). Because three-body interactions are believed to
tegration. Extending this work, Cranmer et al. (2021)
drive the instability process, we expect that restricting
(hereafter, SPOCKII) developed a model that, when
the training set to three-planet systems is also a rea-
provided the raw orbital elements of the planets from
sonable assumption for the task of predicting collisional
a 104 orbit integration, can accurately predict the time
outcomes.
We draw planet-to-star mass ratios for each of the
1Low-mass bodies in N-body simulations are sometimes referred threeplanetslog-uniformlyfromtherange[10−7,10−4],
to as “planetary embryos” or “protoplanets.” For simplicity, spanning approximately from the mass ratio of small
throughoutthiswork,wewillrefertothebodiesinourN-body
planetary embryos to larger than that of Neptune. Or-
as“planets”regardlessoftheirmass.
bital inclinations were sampled log-uniformly from theML for Giant Impact Simulations 3
narrow range of [10−3rad, 0.3rad] to reflect that most with the angular momentum vector of the three-planet
observedmultiplanetsystemsarenearlycoplanar(Fang system.
& Margot 2012; Fabrycky et al. 2014; He et al. 2019a). Asinpreviousworks,wetreatcollisionsbetweenplan-
Nonetheless, this choice allows for mutual inclinations ets as perfect inelastic collisions in which mass and mo-
of up to 34◦ in the training set. Initial orbital angles mentum are conserved.2 We integrate systems for 107
(i.e., longitude of the ascending node, longitude of peri- orbits of the innermost planet, stopping the simulation
center, and true longitude) were drawn uniformly from prematurely if two planets merge. Our choice of stop-
[0, 2π]. Eccentricities for each planet were drawn log- ping time is motivated by the typical time required for
uniformly from [10−3, e ], where e is the eccen- a physical merger to occur (Rice et al. 2018) and makes
cross cross
tricity at which the orbit of the planet crosses that of it computationally feasible to generate a training set of
its neighbor: 500,000+ systems. Note that SPOCKI and SPOCKII
were trained to predict stability on timescales up to 109
a −a
e = i+1 i (1) orbits. However, whereas there is a clear advantage to
cross a
i+1 increasing the integration time for stability predictions,
there is less of an advantage for our task; it is unlikely
where i=1 for the innermost planet and i=2 for the
thatmergersthatoccurinsystemswhichtakelongerto
outermost planet. For the middle planet, we take e
cross destabilizediffermeaningfullyfrommergersexperienced
to be the minimum eccentricity required to cross either
by systems that destabilize more quickly.
the orbit of the inner planet or the outer planet (i.e.,
Whileconstructingthetrainingdataset,werejectsys-
e =min{(a −a )/a , (a −a )/a }).
cross 2 1 2 3 2 3 tems that experienced a merger in less than 104 orbits
Thespacingoftheplanetswaschosensothatsystems
(collision outcome predictions are not needed for such
span a range of initial separations, but are nonethe-
systems because short integrations are computationally
less likely to destabilize. It has been shown that in-
inexpensive) or survive 107 orbits without a merger.
stability times in multiplanet systems scale with the
Restricting the training set to systems that experience
spacing unit S =(a − a )/(a µ1/4) where µ =
i i+1 i i+1 mergers allows us to train a model that focuses exclu-
(m + m )/M (Petit et al. 2020; Lammers et al.
i i+1 ∗ sively on predicting collisional outcomes, leaving aside
2024). Leveraging this, we arbitrarily place the inner-
thechallengeofpredictingstability,whichwasthefocus
most planet at a =1.00 and sample S uniformly from
1 1 of SPOCKI and SPOCKII. After removing 1,540 sys-
[0.0, 7.5] and then S uniformly from [0.0, 7.5], to de-
2 tems that experience an ejection (i.e., systems in which
termine the semi-major axes of the outer two planets.
a planet is scattered to a>50a ), the final training set
1
Planet radii were assigned using the mass-radius rela-
consists of 517,016 systems. Note that the distribu-
tionship (M/M )=2.7(R/R )1.3 from Wolfgang et al.
⊕ ⊕ tions of initial orbital elements in the training set are
(2016). Note, however, that we must assume a typical
affected by the requirement that systems must experi-
value of a to convert planet radii from units of R to
1 ⊕ enceamergerbetween104and107orbits(e.g.,compact,
units in which a =1.0; we adopt a nominal value of
1 eccentric systems typically experience a merger in less
a =0.1AU, interior to which the prevalence of super-
1 than 104 orbits and are thereby excluded).
Earths declines. We caution that the predictions of the
model may be inaccurate for systems of planets with
2.2. Model description
densities that differ drastically from the adopted mass-
We break up the task of predicting planet-planet col-
radius relationship.
lision outcomes into two subproblems: (1) predicting
N-body integrations were performed using the
which pair of planets will experience a collision and (2)
MERCURIUS integrator (Rein et al. 2019) from the open-
predicting the orbital configuration of the post-collision
source REBOUND code. MERCURIUS is a hybrid integra-
system. Theformerisaclassificationproblemwiththree
tor, which uses a fixed-timestep Wisdom-Holman in-
possibilities: planet 1 collides with planet 2 (43.3% of
tegrator (WHFast; Wisdom & Holman 1991; Rein &
systemsinthetrainingset),planet2collideswithplanet
Tamayo 2015) when the planets are widely separated
3 (37.4% of systems), or planet 1 collides with planet 3
andswitchessmoothlytoahigh-orderadaptiveintegra-
(19.3% of systems). Predicting the orbital elements of
tor (IAS15; Rein & Spiegel 2015) when planets come
thepost-collisionsystem,ontheotherhand,isaregres-
within three Hill radii of each other. As recommended
byWisdom(2015),weadoptatimestepofT /20,where
p
T p is the minimum perihelion passage timescale of the 2Adopting a more sophisticated merger prescription does not
threeplanets. Forconsistencyacrosssystems,beforein- meaningfully impact the resulting orbital configurations (Poon
tegrating, we align the z-axis of our coordinate system etal.2020;Estevesetal.2022).4 Lammers et al.
Time
N-body
simulation
Two planets Resulting
collide system
Orbital elements
from short integration
Collision
classifier:
Orbital elements
Predict which pair of
planets collide
Orbital outcome
regressor:
Predict post-collision
orbital elements
Figure 1. Schematicofourmachinelearningmodel. Thecollisionclassifiertakesthemeanandstandarddeviationofthethree
planets’orbitalelementsfromashortN-bodyintegrationasinputandpredictswhichpairofplanetswillcollide(intheformof
threecollisionprobabilities). Theorbitaloutcomeregressortakestheorbitalelements,aswellasachoiceforwhichtwoplanets
to combine, and predicts the orbital elements of the two resulting post-collision planets.
sionproblemwithmultipleoutputs. Weexploreddiffer- providetheMLPmodelwiththemeanandstandardde-
entMLmodelarchitecturesfortacklingthesetasks,but viation of the orbital elements of the three planets over
we found a simple multi-layer perceptron (MLP) model a short 104 orbit integration of the system. The time
toworkwellforboth. AschematicofourMLmodel,en- required to perform a 104 orbit integration is approxi-
compassing both collision classifier and orbital outcome matelyequaltotheinferencetimeofthemodel,sothere
regressor parts, is shown in Fig. 1. is no computational gain to generating inputs with a
To address the classification problem, we construct a shorter integration. The classification MLP was trained
model that, when provided information about the sys- to minimize binary cross-entropy loss with the Adap-
tem as input, outputs three numbers: the probability tiveMomentEstimationOptimizer(ADAM;Kingma&
of a collision occurring between planets 1–2, planets Ba 2014) for 1,000,000 optimizer steps. The hyperpa-
2–3, and planets 1–3. Motivated by previous works rameters of the model (network depth=1 hidden layer,
(Tamayo et al. 2016; SPOCKI; SPOCKII), as input, we number of hidden nodes=30, learning rate=7×10−4,ML for Giant Impact Simulations 5
Figure 2. Performance of the collision classifier model on 200 random validation systems. The probabilities of a collision
occurringbetweenplanets1–2,2–3,and1–3,aspredictedbytheMLmodel,areplottedagainstthetruefractionofcollisions
that occur between the planet pairs, determined by performing 250 shadow integrations of each system. The model accurately
predictscollisionprobabilitieswithascatterof∼10%andverylittlebiasaboutthetruefractions(σ istheroot-mean-squared
errorandbisthemeanoftheresiduals). Forcomparison,allbaselinemodelsweconsideredperformedpoorly(seeAppendixB).
weight decay=1×10−4, and mini-batch size=1,000) As input, we provide the regression model with the
were determined prior to training with Bayesian opti- mean and standard deviation of the orbital elements of
mization on a pared-down version of the training set, the three planets, ordered to specify which two planets
and the final model was trained on 80% of the full are involved in the collision. The regression MLP was
training set (413,612 systems). A full description of the trained using a mean-squared-error loss function with a
modelarchitectureandtrainingprocesscanbefoundin correction term to account for the upper limits on the
Appendix A.1. orbital element outputs (see Appendix A.2 for more de-
Toaddresstheregressionproblem,werequireamodel tails). Themodelwastrainedon80%ofthefulltraining
that can predict the post-collision orbital configuration set using the ADAM optimizer for a total of 1,000,000
of the system, given a short integration of the system optimizer steps. Like the classification model, hyper-
and a choice of which two planets are to collide. Al- parameters (network depth=1 hidden layer, number of
though only two of the three planets are involved in the hidden nodes=60, learning rate=7×10−4, weight de-
collision, we find that the state of the third planet can cay=1×10−4, and mini-batch size=3,000) were deter-
also change substantially during the instability phase. mined with Bayesian optimization performed on a sub-
As a result, we require a model that can predict the or- set of the training set.
bitalparametersofthenewlymergedplanet,alongwith
2.3. Giant impact emulator
those of the surviving planet.
In practice, we found it challenging to predict the Combining our collision outcome model with the sta-
orbital angles (longitude of the ascending node, longi- bility predictions provided by SPOCKII allows us to
tude of pericenter, and true longitude) of the two post- create a rapid giant impact simulation emulator. We
collision planets. Further investigation reveals that, outline our iterative emulator model below.
in integrations of the synthetic systems where the ini- Beginningwithasystemofoverlypackedplanets,the
tial conditions have been slightly perturbed (see Sec- giant impact emulator (1) partitions the system into
tion3.1),theorbitalanglesoftheplanetstypicallyspan triosofadjacentplanets,(2)predictstheinstabilitytime
from approximately [0, 2π] across the set of perturbed ofeachtriousingSPOCKII,and(3)predictsthemerger
systems. As a result, we trained the regression model outcome of the trio with the shortest instability time
to predict only semi-major axes, eccentricities, and in- and replaces the planets. This process is repeated until
clinations, and when the orbital angles are needed for a the system is deemed stable by SPOCKII (i.e., the full
particularapplicationofthemodel(e.g.,replacingthree planetary system has an instability time larger than a
planets in a synthetic planetary system with two post- user-chosen maximum). In step (2), we determine each
collision planets), we simply draw them randomly from trio’sinstabilitytimeusingthemedianofSPOCKII’sin-
[0, 2π]. It may prove valuable to work towards a model stabilitytimesamples. Wefindthattheemulator’spre-
that can predict dynamically relevant combinations of dictions compare much more accurately with N-body
the orbital angles (e.g., mutual inclination) in the fu- results (see Section 3.2) when using median instabil-
ture. ity time predictions, as opposed to directly sampling
SPOCKII’s predicted instability time posterior. In step
(3),wefirstpredicttheprobabilitiesofacollisionoccur-6 Lammers et al.
Figure 3. Comparison between the performance of the orbital outcome regressor (top row) and a non-ML baseline model
(bottomrow)onthevalidationsetof103,404three-planetsystems. Predictedorbitalelements(i.e.,semi-majoraxis,eccentricity,
and inclination) for the new, merged planets are plotted against their true orbital elements. The ML model predicts orbital
elements with somewhat less scatter and bias about the true values than the baseline model, approaching the accuracy limits
imposed by chaos (see Table 1).
ring between planets 1–2, 2–3, or 1–3 in the unstable systems represent equally valid possible long-term evo-
planet trio using the collision classifier model. Then, lutionsofthesystem,allowingustoquantifythevariety
we sample the probabilities to determine which pair of of potential outcomes.
planets to combine, and we predict the resulting orbital
elementsusingtheorbitaloutcomeregressormodel. Re-
sults from our giant impact emulator are presented in 3.1.1. Collision classifier
Section 3.2 and caveats are discussed in Section 4.
Applyingourcollisionclassifiermodeltothe20%val-
idation set, we find that the model correctly predicts
3. RESULTS
the planet pair that experiences a collision for 66.5% of
3.1. Performance on validation set
validationsystems. Thisisanimprovementoverchance
In this section, we study the performance of our ML (33.3%accuracy)andalwaysguessingthemostcommon
model,includingbothcollisionclassifierandorbitalout- outcome (collision between planet 1 and 2; 43.3% accu-
come regressor parts, on systems from the 103,404 sys- racy), but further interpreting the model’s performance
tem validation set. Interpreting the performance of our requires quantifying the limits on prediction accuracy
model is complicated by the chaotic nature of multi- imposed by chaos.
planet systems, which can cause systems with indistin- In many instances, shadow realizations of the same
guishable initial conditions to rapidly diverge, resulting systemultimatelyexperiencecollisionsbetweenadiffer-
in different late-time outcomes (e.g., Rice et al. 2018; entplanetpair. Usingoursetofshadowintegrations,we
Hussain & Tamayo 2020). Properly evaluating the per- measure the fractions f of shadow systems in
planetsi−j
formanceofourmodelthereforerequiresquantifyingthe which a collision occurs between planets i and j, which
limits on prediction accuracy imposed by chaos. vary widely depending on the system. In Fig. 2, we
To isolate the influence of chaos, we perform “shadow compare the three collision probabilities predicted by
integrations”of200randomlyselectedsystemsfromthe the ML model with the three true collision fractions for
validation set, in which we slightly perturb the initial eachofthe200validationsystems(wereportσ,theroot-
conditions of the systems and re-integrate it. For each mean-squared error, and b, the mean of the residuals).
validationsystem, weconstruct250shadowrealizations Basedonasingle,shortintegrationofthevalidationsys-
where we have perturbed the initial Cartesian positions tems, the ML model successfully predicts the probabili-
and velocities of the three planets (in the barycentric ties of a collision occurring between the different planet
frame)byrandomfactorsdrawnfromaGaussiandistri- pairs,withascatterof∼ 10%andverylittlebiasabout
butionN(µ=1.0, σ=10−12). Theresulting250shadow the true probabilities. Increasing the number of shadowML for Giant Impact Simulations 7
Figure 4. Same comparison as Fig. 3, now for the three post-collision orbital elements of the surviving planet that is not
involved in the merger. The orbital outcome regressor predicts semi-major axis, eccentricity, and inclination with less scatter
and bias than the non-ML baseline model, approaching the limit imposed by chaos (see Table 1).
runs does not decrease the scatter, indicating that it is inclinationtobetheaverageinclinationofthesurviving
dominated by the error in the ML model’s predictions. planetoverthe104 orbitintegration,thenwedetermine
To help interpret the performance of the ML model, the planet’s semi-major axis and eccentricity by requir-
we considered a variety of non-ML approaches to pre- ing the conservation of energy E and the z-component
dicting the collision probabilities. All baseline models of angular momentum L . Note that E is not perfectly
z
we constructed performed poorly, even when tuned to conserved during collisions, but the loss of energy dur-
fit the true f values (see Appendix B). ing inelastic collisions in our training set simulations is
planetsi−j
small (∼0.05%), so we may use the approximate con-
3.1.2. Orbital outcome regressor servation of E (and the baseline prediction of a ) to
col
Next, we analyze the performance of the orbital out- predict a surv. On the other hand, all components of L
come regression model. We compare the orbital ele- are conserved during collisions, but L x and L y depend
ments of the newly merged planets, as predicted by the on Ω col and Ω surv, which are unknown, so we leverage
orbital regression model, with the true values for the onlytheconservationofL z. Similarlytotheorbitalele-
20%validationsetinFig.3. TheMLmodelpredictions mentsofthenew,mergedplanet(Fig.3),theMLmodel
exhibit little bias about the true values but are other- predictstheorbitalelementsofthesurvivingplanetwith
wise difficult to interpret without a baseline to compare less scatter and bias than the baseline model.
against. Thebestbaselinemodelwefoundforpredicting We may also use the conservation of L z and the near-
the post-collision orbital elements of the merged planet conservation of E as a test of the performance of the
reliedonamass-weightedaverageoftheorbitalelements orbital outcome model. For the set of validation sys-
ofthetwopre-mergerplanetsoverthe104 orbitintegra- tems, the predicted post-collision states have a median
tion. In contrast with the task of predicting collision percent error in L z of 0.3% and a median percent error
probabilities, we find that the baseline model predicts in E of 0.6%. The near-perfect conservation of L z and
post-collision orbital elements relatively well (see bot- E bythemodelonsystemsfromoutsidethetrainingset
tom panel of Fig. 3). Nonetheless, our ML model im- provides additional support for its performance.
proves moderately on the scatter and bias of the base- Lastly, usingoursetofshadowintegrations, wequan-
line model, particularly for the inclination of the newly tify the limits on orbital element prediction accuracy
merged planet. imposed by chaos. To do so, for each of the 200 val-
Figure4showstheorbitalelementsoftheplanetthat idation systems, we first bin the shadow integrations
is not involved in the collision (the “surviving planet”), according to which two planets experienced a collision.
as predicted by our ML-based model and a baseline Then, we measure the scatter in the orbital elements
model, for the 20% validation set. We create a non- about the mean values across the shadow system real-
MLbaselinemodel,inthiscase,bytakingthepredicted izations (which we find to be distributed approximately8 Lammers et al.
Table 1. Root-mean-squared scatter σ and bias b (defined eratively drawing initial adjacent-planet period ratios
as the mean of residuals) of the orbital outcome regressor P /P from the uniform distribution spanning [1.10,
i+1 i
andabaselinemodelonthe103,404validationsystems. For 1.75]. Initial orbital eccentricities and inclinations were
comparison,wereporttheaccuracylimitsimposedbychaos
drawn from Rayleigh distributions with scale param-
(see Section 3.1 for more details).
eters σ=0.01 and σ=0.5◦, respectively. Initial true
longitudes and longitudes of pericenter were drawn uni-
Target Method Scatter σ Bias b
formly over the range [0, 2π]. These initial conditions
a Baseline model 0.046 −0.010
col were chosen to reflect the expected state of multiplanet
a ML model 0.043 −0.005
col systems when the gas disk dissipates, and they resem-
a col Limit from chaos 0.040 0.000 blethoseadoptedwhennumericallymodellingthegiant
log(e col) Baseline model 0.372 0.028 impact process (see, e.g., Poon et al. 2020; Goldberg &
log(e col) ML model 0.270 0.007 Batygin 2022; Lammers et al. 2023). Systems were in-
log(e col) Limit from chaos 0.247 0.000 tegrated for 109 orbits using the MERCURIUS integrator
log(i ) Baseline model 0.510 −0.301 with a timestep of 1/20th of the innermost planet’s ini-
col
log(i ) ML model 0.266 −0.011 tialorbitalperiod,andcollisionsweretreatedasperfect
col
log(i ) Limit from chaos 0.242 0.000 inelastic mergers. After 109P of dynamical evolution,
col 1
a Baseline model 0.564 0.126 thesystemscontainameanof5.5planets(factor∼2re-
surv
a ML model 0.492 0.005 duction), whose orbital properties have been set by the
surv
a Limit from chaos 0.494 0.000 giant impact process.
surv
Figure 6 compares the properties of the 500 plane-
log(e ) Baseline model 0.497 0.138
surv
tary systems from N-body simulations with the out-
log(e ) ML model 0.304 −0.007
surv
comes predicted by our ML-based giant impact emula-
log(e ) Limit from chaos 0.282 0.000
surv
tor,whichis8,700timesfasterinthiscase. Thedistribu-
log(i ) Baseline model 0.339 0.069
surv
tion of planet masses, adjacent-planet spacings, and or-
log(i ) ML model 0.265 −0.008
surv
bitalinclinationsacrosstheML-predictedsystemsagree
log(i ) Limit from chaos 0.243 0.000
surv well with that of the N-body systems (for quantitative
comparisons,wereportthe1D Wassersteindistancebe-
log-normally), thereby isolating the unavoidable scatter tween the ML and N-body distributions in Fig. 6). In
due to the chaotic nature of these simulations. Limits addition to the aggregate properties of the planets, the
onpredictionaccuracyduetochaos,alongwiththeper- system-levelpropertiesoftheML-predictedandN-body
formance of the ML and baseline models are reported systemslargelyagree. Toillustrate,wecomparethetwo
in Table 1. For all six predicted orbital elements, the sets of systems using three metrics: the mass partition-
accuracy of our ML model is approaching the limit im- ing Q, which describes how mass is distributed among
posed by chaos, indicating that there is little room for the planets (Q=0 when planets have equal masses and
improvement. Note, however, that there are likely com- Q=1 when only a single planet is massive; Q is de-
plex correlations between the outputs of the model. finedinGilbert&Fabrycky2020),thegapcomplexityC,
which quantifies the spacing of the planets (C=0 when
planets are equally spaced in log-period space; defined
3.2. Predicting giant impact outcomes
in Gilbert & Fabrycky 2020), and normalized angular
By combining our ML model with SPOCKII, which
momentum deficit (AMD), which describes the dynam-
can rapidly predict instability times, we create an it-
ical excitation of the system (see Chambers 2001; Tur-
erative giant impact emulator for modelling the planet
rini et al. 2020). Comparing such metrics is a more
formation process (see Fig. 5 for a schematic that illus-
stringent test of the ML-based emulator because they
tratesthismodel). Below, weevaluatetheabilityofthe
depend sensitively on which planets are combined (see,
emulatortoreproducetheresultsofcomputationallyex-
e.g., Lammers et al. 2023).
pensive N-body simulations.
ThemasspartitioningandgapcomplexityoftheML-
For comparison with our giant impact emulator, we
predicted systems agree well with that of the N-body
carry out 500 long-term N-body simulations of initially
systems(Fig.6). However,thenormalizedAMDsofthe
overly packed, ten-planet systems. We initialize each
ML-predicted system are typically smaller than that of
system around a solar-mass star, with planet masses
the N-body systems, indicating that the ML systems
drawn randomly from N(3M , 3M ) and planet radii
⊕ ⊕ are less dynamically excited (this is also reflected in the
determined based on the mass-radius relationship from
distribution of orbital inclinations). This discrepancy
Wolfgang et al. (2016). Planets were spaced by it-ML for Giant Impact Simulations 9
Predict collisional (e.g., planet 2 merges
outcome with planet 3)
New planet
Predict collisional (e.g., planet 1 merges
outcome with planet 2)
Repeat until
system is stable
Figure5. Schematicoftheiterativegiantimpactemulator. Ateachstep,instabilitytimesforsub-triosofplanetsarepredicted
usingSPOCKII(Cranmeretal.2021). Then,withthemachinelearningmodelpresentedinthiswork,wepredictthecollisional
outcomeoftheplanettriowiththeshortestinstabilitytime,replacethetriowiththetwonewplanets,andrepeatuntilSPOCKII
identifies the system as long-term stable.
is likely caused by the fact that the ML-predicted sys- whatlessdynamicallyevolvedthanN-bodysimulations
tems have undergone fewer collisions than the N-body run for the same maximum time. More accurate insta-
systems. Even though SPOCKII predicts the final ML- bilitytimepredictionswouldhelpresolvethisissue. We
predicted systems to be stable, they contain a mean of note,additionally,thatpredictinginstabilitytimeswith
6.6 planets, 1.1 planets above the mean of the true N- SPOCKIIisthecurrentcomputationalbottleneckofthe
body systems. We find this trend to hold for other sets model — it is possible to speed up the emulator model
of initial conditions as well, so users of the emulator (by up to a factor of ∼3) with more rapid instability
model should be aware that systems tend to be some- time predictions.10 Lammers et al.
Figure 6. Comparison between the properties of 500 synthetic planetary systems from long-term N-body simulations and
our ML-based giant impact emulator (which is ∼104 faster than full N-body simulations). The masses, spacings, and orbital
inclinationsoftheplanetsintheML-predictedsystemsagreewellwiththosefromN-bodysimulations(toprow). System-level
properties of the ML-predicted systems also agree with the N-body systems (bottom row), although we find the ML-predicted
systemstobesomewhatlessdynamicallyexcited. The1DWassersteindistanceW betweenthetwodistributionsarereportedin
eachpanel. OurML-basedmodeloutperformsanon-MLbaselinemodel,whosepredictionsagreelesswellwiththetrueN-body
distributions (for the quantities shown in the top-left to the bottom-right panels, W=0.281, 0.507, 2.293, 0.038, 0.096, 2.048).
To help interpret the performance of the ML-based that the ML-predicted systems more closely match the
giant impact emulator, and quantify to what extent the N-bodysystemsforallconsideredpropertiesexceptthe
strongagreementwithN-bodysimulationsisduetothe planet masses. The baseline planet masses agree better
tendency of collisions to “average out,” we also predict withtheN-bodyplanetmasseslargelybecausethemul-
giantimpactoutcomesforthe500initialconditionswith tiplicities of the baseline systems (mean of 5.3 planets)
a non-ML baseline model. Our baseline model, in this are closer to that of the true N-body systems (mean of
case,reliesonthesameiterativeprocessastheemulator 5.5planets)thantheML-predictedsystemmultiplicities
(Fig. 5), except that at each step, the unstable trio is are(meanof6.6planets). Note,however,thatthemean
chosenbasedonastabilityheuristic,thecollidingplanet numberofplanetsinthebaselinesystemsdependssensi-
pairisdeterminedusingourbestnon-MLbaselinemodel tivelyontheadoptedstabilityheuristic,anddespitethe
(Appendix B), and mergers are handled with our best similar multiplicities, the other properties of the base-
non-MLbaseline(Figs.3,4). Weadoptthestabilitycri- linesystemsarealllessaccuratethantheML-predicted
terion (Eq. 3) from Tremaine (2015), which attempted systems. We do not otherwise attempt to compare with
to predict the outcomes of the giant impact process an- the model of Tremaine (2015), which avoided modelling
alytically. Systems are identified as stable, and the it- giant impacts directly by adopting the ansatz that sys-
erative process is stopped, once no planet pairs violate temsuniformlyexplorethestableregionofphasespace.
the 109 orbit stability criterion (i.e., all adjacent planet As an additional test of the emulator model, we com-
pairs are separated by more than 10mutual Hill radii). pare the angular momentum L and energy E of the
z
To compare the accuracy of the baseline model finalsystemswiththatoftheinitialconditions. Wefind
with the ML-based emulator, we calculate the 1D that the predicted systems have a median percent error
Wasserstein distance between the properties of the in L of just 0.8% and a median percent error in E of
z
baseline systems and the N-body systems. For 1.8%. In practice, the conservation of L and E can be
z
the properties reported in the top-left to bottom- used as model diagnostics, allowing the user to reject
right panels of Fig. 6, the baseline systems have unphysical systems in which L or E are poorly con-
z
W=0.281, 0.507, 2.293, 0.038, 0.096, 2.048, indicatingML for Giant Impact Simulations 11
served due to hallucinations of the model, which would Firstly,becauseourMLmodelwasrestrictedtothree-
otherwise be challenging to identify. planet systems, collisions cannot occur between planet
pairs separated by more than one intervening planet
4. DISCUSSION AND CONCLUSIONS (e.g.,planets1and4). Secondly,ourmodeldoesnotac-
Inthiswork,wepresentanML-basedapproachtopre- count for the scattering of planets that are not included
dicting the collisional outcomes of multiplanet systems. in the unstable planet trio (e.g., if SPOCKII predicts
Breaking this task into two subproblems, we develop thatplanets1,2,and3formanunstabletrio,acollision
two models: a “collision classifier” that predicts which betweenplanets2and3couldscatterplanet4). Thirdly,
pair of planets will collide, and an “orbital outcome re- insomeinstances,thetimerequiredforplanetstomerge
gressor” that predicts the orbital elements of the two after the system has destabilized can be comparable to
post-collision planets (see Fig. 1). the system’s instability time (Rice et al. 2018), which
Using shadow integrations in which the initial con- could result in the planets being merged in an incorrect
ditions of our synthetic planetary systems are slightly order. Noneoftheseissuesareeasilyaddressedwithout
perturbed, we show that our collision classifier model taking a fundamentally different approach to modeling
canaccuratelypredicttheprobabilitiesofacollisionoc- the giant impact process, but due to their rarity, we do
curringbetweendifferentplanetpairs. Withascatterof not expect neglecting them to significantly impact pre-
∼10% and little bias about the true collision probabili- dicted orbital configurations. We defer more complete
ties, our model significantly outperforms baseline mod- comparisonswithN-bodysimulationsandtheobserved
els constructed based on metrics from dynamics theory. population of exoplanets to future works.
Similarly,wefindthattheorbitaloutcomeregressorout- The substantial computational speed-up provided by
performsnon-MLbaselinesatthetaskofpredictingthe our collision outcome model and giant impact emulator
planets’ post-collision states. The prediction accuracy enablesuniqueanalysesthatwouldnototherwisebefea-
of the outcome regressor is only narrowly below the ac- sible, including the ability to carry out more complete
curacylimitsimposedbychaos,andthemodel’spredic- explorationsoftheparameterspaceofinitialconditions.
tionsconserveenergyandangularmomentumtowithin We release our model with an easy-to-use API through
≲1%. the SPOCK package,3 alongside our full training code.4
By combining our model with SPOCKII (Cranmer
5. ACKNOWLEDGMENTS
et al. 2021), which provides rapid instability time pre-
dictions, we create an efficient giant impact emulator We thank the anonymous referee for a thorough re-
(see the schematic in Fig. 5). We demonstrate that our view that significantly improved the quality of the pa-
ML-basedemulatorcanpredicttheoutcomesofN-body per. We would also like to thank Yubo Su, Amir Siraj,
giant impact simulations with a speed-up of up to four Christian Kragh Jespersen, and Joshua Winn for use-
orders of magnitude. Although powerful, this approach ful discussions. NM acknowledges the support of the
requires caution, and we outline some notable caveats Natural Sciences and Engineering Research Council of
below. Canada (NSERC), [RGPIN-2023-04901].
APPENDIX
A. NEURAL NETWORK ARCHITECTURES
Here, we describe the architecture of our two MLP models, constructed using the open-source PyTorch (Paszke
etal.2019)package. Beforetrainingthemodelspresentedinthemaintext,thehyperparametersforbothmodelswere
determined (independently) with Bayesian optimization, as implemented in the hyperopt code. Specifically, for both
models, we found the combination of hyperparameters (i.e., the learning rate, weight decay, mini-batch size, number
of hidden layers, and number of nodes in the hidden layers) that minimized the loss on a validation set after 10,000
optimizationsteps. Forthis, we useda reducedtrainingset of51,702 systemsrandomly selectedfrom the fulltraining
set, of which 20% were reserved for validation.
3https://github.com/dtamayo/spock
4https://github.com/CalebLammers/ML for collisions12 Lammers et al.
A.1. Collision classifier
Topredictwhetheracollisionwilloccurbetweenplanets1–2,planets2–3,orplanets1–3,weuseafullyconnected
MLP with three output nodes. The model includes one hidden layer with 30 hidden nodes and takes 45 inputs,
corresponding to the three planet masses log(m ), along with the mean and standard deviation of a , log(e ), log(I ),
i i i i
sin(ϖ ), cos(ϖ ), sin(Ω ), and cos(Ω ), where i=1,2,3. We found that providing the model as input the logarithm of
i i i i
the masses, eccentricities, and inclinations improved the performance of both the classification and regression models,
likely because these inputs can span several orders of magnitude.
We use a Rectified Linear Unit (ReLU) activation function on the input and hidden layers and a softmax activation
function on the output layer so that the three outputs sum to unity and can be interpreted as probabilities. We train
the model using the ADAM optimizer, with a learning rate of 7 × 10−4 and a weight decay of 1 × 10−4. The model
wastrainedfor1,000,000optimizerstepsusingabinarycross-entropylossfunction,randommini-batchesofsize1,000,
anda20%validationset. Weexploredtrainingthemodelwithotheroptimizers,includingstochasticgradientdescent,
but found that models trained with ADAM performed best on the validation set.
Beforetraining, we rescaletheinput massesandorbital elementsso thattheinput featureshave amean ofzeroand
astandarddeviationofunityacrossalltrainingsystems(duringinference,inputsaresimilarlynormalizedbeforebeing
passed to the model). We found that normalizing the input features helped to speed up the training of the model.
During training, the model was provided with a random subset of the 100 orbit samples recorded across the 104 orbit
short integration. In detail, we drew n uniformly from [5, 100] and calculated the mean and standard deviation
t
of each orbital element from n samples selected randomly (without replacement) from the 100 recorded states. To
t
reflect the varying number of orbit samples and add a small amount of noise to the input features, we draw the means
and standard deviations that are passed as input to the MLP model, µˆ and σˆ, from their frequentist distributions
√ (cid:112)
µˆ=N(µ, σ/ n ) and σˆ=N(σ, σ/ 2(n −1)), where µ and σ are the mean and standard deviation measured based
t t
on the n orbit samples. Varying the number of orbit samples during training acts as a form of data augmentation,
t
which we found improved generalization to the validation set. During inference, the mean and standard deviation are
calculated from all 100 orbital samples with no added statistical noise.
A.2. Orbital outcome regressor
To predict the orbital elements of the two post-collision planets, we use a fully connected multilayer perceptron
with six output nodes, corresponding to a , log(e ), log(i ), a , log(e ), and log(i ). The model takes 45
col col col surv surv surv
inputs and consists of a single hidden layer with 60 hidden nodes. As input, we provide the regression model with the
same45valuesrequiredbytheclassificationmodel(log(m ),a ,log(e ),log(I ),sin(ϖ ),cos(ϖ ),sin(Ω ),andcos(Ω ),
i i i i i i i i
where i=1,2,3), except that the inputs are ordered in order to encode which two planets are to be combined. The
orbital properties of the two colliding planets (ordered by semi-major axis) are provided first, followed by those of the
survivingplanet. Wefoundthatre-orderingtheinputstotellthemodelwhichtwoplanetsaretobecombinedworked
significantly better than passing a separate input value that specified the two colliding planets.
For the regression MLP, we use a ReLU activation function on the input and hidden layer, and a linear activation
function on the output layer. Similarly to the classification model, we train the model with ADAM (which is, again,
the best-performing optimizer) for 1,000,000 optimizer steps, in this case with a batch size of 3,000, a learning rate of
7 × 10−4, andaweightdecayof1 × 10−4, whichweredeterminedbasedonthehyperparameteroptimizationprocess.
As with the collision classifier model, during training, we varied the number of orbit samples used to calculate the
mean and standard deviation of the orbital elements (n was drawn uniformly from [5, 100]), and drew the inputs
t
passed to the model from their corresponding frequentist distributions.
A complication of the orbital element regression problem is that some of the outputs have strict upper limits
(e.g., log(e )<0.0) and log(e )<0.0). For data points in the training set that are near their upper limit, it is
col surv
no longer reasonable to assume that their error terms are well-described by symmetric Gaussian distributions, and
as a result, the model with minimum mean-squared-error no longer corresponds to the maximum likelihood model.
As a result, when trained with a mean-squared-error loss function, we found that the eccentricities predicted by
the regression model were systematically biased towards low values. To resolve this, we adopt the loss function
L(y |y )= (cid:80)5 (cid:0) (y −y )2+ log(1+erf(y −y ))(cid:1) , where y represents the six outputs of
pred true i=0 pred,i true,i max,i pred,i pred
the model, y represents the true values, and y represents the maximum allowed value of each output. The
true max
first term in L(y |y ) corresponds to the standard mean-squared-error and the second term accounts for the
pred true
penalization of predictions near the upper limits (see the Appendix of SPOCKII for a mathematical derivation of theML for Giant Impact Simulations 13
Figure 7. Performance of three non-ML baseline classification models on the 200 validation systems, for comparison with our
ML model (Fig. 2). From top to bottom, the baseline model predictions rely on the mass ratios of the planets, the amount
of angular momentum required for the planets’ orbits to cross, and the normalized eccentricity of the planets. The baseline
models predict three logits, which are converted to probabilities using a softmax function (see Section B). Despite leveraging
dynamics-inspired metrics, the predictions of all three baseline models are poor.
likelihood for data with lower/upper limits). With this loss function, the model predicts post-collision eccentricities
with little bias (see the middle panel of Figs. 3, 4). For the interested reader, our full training code is available at
https://github.com/CalebLammers/ML for collisions.
B. BASELINE CLASSIFICATION MODEL
Despite extensive theoretical investigation into the destabilization of compact multiplanet systems, there have been
relatively few attempts to predict which planets will be involved in the collision. Any binary criterion based on the
configurationofthesystem(e.g.,nearestplanetpair)inevitablypredictsacollisionfractionofunityforoneplanetpair
and a fraction of zero for the other two, which is a poor prediction (see Fig. 2). Randomly selecting a pair of planets
(resultinginf ≈0.33)isasimilarlyinadequateprediction. Instead,weapproachthistaskbypredictingthree
planetsi−j
logits (logit , logit , and logit ) based on the initial conditions of the systems, which are converted to collision
1−2 2−3 1−3
fractions according to f =softmax(logit ).
planetsi−j i−j
We attempted to predict collision probabilities using several different physical properties of the systems. Firstly,
motivatedbythefindingthatsmallplanetsarepreferentiallyinvolvedincollisions(Lammersetal.2023),weconsidered
amodelthatcalculateslogitsusingtheratiooftheplanetmasses: logit =c log(max(m /m , m /m ))wherec is
i i i+1 i i i+1 i
anarbitraryconstant. Wetunethethreeconstantsc tominimizethebiasb(definedasthemeanoftheresiduals)with
i
respect to the true collision fractions f . Secondly, we construct a model in which logit =c L , where
planetsi−j i i i−j, cross
L is the minimum orbital momentum that, when transferred to planet i or planet j, increases the planets’
i−j, cross
eccentricity enough to allow for crossing orbits. This criteria thereby takes into account the planets’ spacings, masses,
and eccentricities. Lastly, we consider a model that calculates logits using the planets’ normalized eccentricities14 Lammers et al.
(as defined in Tamayo et al. 2021), which depend on the planets’ spacings, eccentricities, and orbital orientations
(logit =c |˜e |).
i i ij
The collision probabilities predicted by the three baseline models are compared with the true collision fractions for
200validationsystemsinFig.7. Allmodelsperformpoorly,withascatteraboutthetruecollisionfractionsofσ≈0.3,
three times larger than that of our ML model (Fig. 2). Predictions are similarly poor when logits are predicted based
on the mean orbital elements over 104 orbits or the state of the system at the end of the 104 orbits, or when using
othercommonstabilitymetrics,likethespacingoftheplanetsinmutualHillradii. Theinabilityofallbaselinemodels
we considered to accurately predict collision probabilities highlights the difficulty of this task.
REFERENCES
Agnor, C. B., Canup, R. M., & Levison, H. F. 1999, Icarus, Hussain, N., & Tamayo, D. 2020, MNRAS, 491, 5258,
142, 219, doi: 10.1006/icar.1999.6201 doi: 10.1093/mnras/stz3402
Bailey, N. A., & Fabrycky, D. C. 2022, MNRAS, 514, 4765, Izidoro, A., Ogihara, M., Raymond, S. N., et al. 2017,
doi: 10.1093/mnras/stac1683 MNRAS, 470, 1750, doi: 10.1093/mnras/stx1232
Borucki, W. J., Koch, D. G., Basri, G., et al. 2011, ApJ, Jamieson, D., Li, Y., de Oliveira, R. A., et al. 2023, ApJ,
736, 19, doi: 10.1088/0004-637X/736/1/19 952, 145, doi: 10.3847/1538-4357/acdb6c
Chambers, J. E. 1999, MNRAS, 304, 793, Kant, I. 1755, Allgemeine Naturgeschichte und Theorie des
doi: 10.1046/j.1365-8711.1999.02379.x Himmels
—. 2001, Icarus, 152, 205, doi: 10.1006/icar.2001.6639 Kingma, D. P., & Ba, J. 2014, arXiv e-prints,
Chambers, J. E., & Wetherill, G. W. 1998, Icarus, 136, 304, arXiv:1412.6980, doi: 10.48550/arXiv.1412.6980
doi: 10.1006/icar.1998.6007
Kokubo, E., & Ida, S. 1998, Icarus, 131, 171,
Chambers, J. E., Wetherill, G. W., & Boss, A. P. 1996,
doi: 10.1006/icar.1997.5840
Icarus, 119, 261, doi: 10.1006/icar.1996.0019
Kokubo, E., Kominami, J., & Ida, S. 2006, ApJ, 642, 1131,
Cranmer, M., Tamayo, D., Rein, H., et al. 2021,
doi: 10.1086/501448
Proceedings of the National Academy of Science, 118,
Lammers, C., Hadden, S., & Murray, N. 2023, MNRAS,
e2026053118, doi: 10.1073/pnas.2026053118
525, L66, doi: 10.1093/mnrasl/slad092
Esteves, L., Izidoro, A., Bitsch, B., et al. 2022, MNRAS,
—. 2024, arXiv e-prints, arXiv:2403.17928,
509, 2856, doi: 10.1093/mnras/stab3203
doi: 10.48550/arXiv.2403.17928
Fabrycky, D. C., Lissauer, J. J., Ragozzine, D., et al. 2014,
Laplace, P.-S. 1796, Exposition du Syst`eme du Monde
ApJ, 790, 146, doi: 10.1088/0004-637X/790/2/146
Lissauer, J. J. 1993, ARA&A, 31, 129,
Fang, J., & Margot, J.-L. 2012, ApJ, 761, 92,
doi: 10.1146/annurev.aa.31.090193.001021
doi: 10.1088/0004-637X/761/2/92
Lissauer, J. J., Ragozzine, D., Fabrycky, D. C., et al. 2011,
—. 2013, ApJ, 767, 115, doi: 10.1088/0004-637X/767/2/115
ApJS, 197, 8, doi: 10.1088/0067-0049/197/1/8
Fressin, F., Torres, G., Charbonneau, D., et al. 2013, ApJ,
Obertas, A., Tamayo, D., & Murray, N. 2023, MNRAS,
766, 81, doi: 10.1088/0004-637X/766/2/81
doi: 10.1093/mnras/stad1921
Ghosh, T., & Chatterjee, S. 2024, MNRAS, 527, 79,
Paszke, A., Gross, S., Massa, F., et al. 2019, arXiv e-prints,
doi: 10.1093/mnras/stad2962
arXiv:1912.01703, doi: 10.48550/arXiv.1912.01703
Gilbert, G. J., & Fabrycky, D. C. 2020, AJ, 159, 281,
Petit, A. C., Pichierri, G., Davies, M. B., & Johansen, A.
doi: 10.3847/1538-3881/ab8e3c
2020, A&A, 641, A176,
Goldberg, M., & Batygin, K. 2022, AJ, 163, 201,
doi: 10.1051/0004-6361/202038764
doi: 10.3847/1538-3881/ac5961
Hansen, B. M. S., & Murray, N. 2012, ApJ, 751, 158, Poon,S.T.S.,Nelson,R.P.,Jacobson,S.A.,&Morbidelli,
doi: 10.1088/0004-637X/751/2/158 A. 2020, MNRAS, 491, 5595, doi: 10.1093/mnras/stz3296
—. 2013, ApJ, 775, 53, doi: 10.1088/0004-637X/775/1/53 Pu, B., & Wu, Y. 2015, ApJ, 807, 44,
He, M. Y., Ford, E. B., & Ragozzine, D. 2019a, MNRAS, doi: 10.1088/0004-637X/807/1/44
490, 4575, doi: 10.1093/mnras/stz2869 Quillen, A. C. 2011, MNRAS, 418, 1043,
He, S., Li, Y., Feng, Y., et al. 2019b, Proceedings of the doi: 10.1111/j.1365-2966.2011.19555.x
National Academy of Science, 116, 13825, Raymond, S. N., Barnes, R., & Mandell, A. M. 2008,
doi: 10.1073/pnas.1821458116 MNRAS, 384, 663, doi: 10.1111/j.1365-2966.2007.12712.xML for Giant Impact Simulations 15
Raymond, S. N., Quinn, T., & Lunine, J. I. 2005, ApJ, 632, Tejada Arevalo, R., Tamayo, D., & Cranmer, M. 2022,
670, doi: 10.1086/433179 ApJL, 932, L12, doi: 10.3847/2041-8213/ac70e0
Rein, H., & Spiegel, D. S. 2015, MNRAS, 446, 1424, Tremaine, S. 2015, ApJ, 807, 157,
doi: 10.1093/mnras/stu2164 doi: 10.1088/0004-637X/807/2/157
Rein, H., & Tamayo, D. 2015, MNRAS, 452, 376, Turrini, D., Zinzi, A., & Belinchon, J. A. 2020, A&A, 636,
doi: 10.1093/mnras/stv1257 A53, doi: 10.1051/0004-6361/201936301
Rein, H., Hernandez, D. M., Tamayo, D., et al. 2019, Volk, K., & Gladman, B. 2015, ApJL, 806, L26,
MNRAS, 485, 5490, doi: 10.1093/mnras/stz769 doi: 10.1088/2041-8205/806/2/L26
Rice, D. R., Rasio, F. A., & Steffen, J. H. 2018, MNRAS, Wisdom, J. 2015, AJ, 150, 127,
481, 2205, doi: 10.1093/mnras/sty2418 doi: 10.1088/0004-6256/150/4/127
Sobski, N., & Millholland, S. C. 2023, ApJ, 954, 137, Wisdom, J., & Holman, M. 1991, AJ, 102, 1528,
doi: 10.3847/1538-4357/ace966 doi: 10.1086/115978
Tamayo, D., Murray, N., Tremaine, S., & Winn, J. 2021,
Wolfgang, A., Rogers, L. A., & Ford, E. B. 2016, ApJ, 825,
AJ, 162, 220, doi: 10.3847/1538-3881/ac1c6a
19, doi: 10.3847/0004-637X/825/1/19
Tamayo, D., Silburt, A., Valencia, D., et al. 2016, ApJL,
Yee, S. W., Winn, J. N., & Hartman, J. D. 2021, AJ, 162,
832, L22, doi: 10.3847/2041-8205/832/2/L22
240, doi: 10.3847/1538-3881/ac2958
Tamayo, D., Cranmer, M., Hadden, S., et al. 2020,
Zhu, W., Petrovich, C., Wu, Y., Dong, S., & Xie, J. 2018,
Proceedings of the National Academy of Science, 117,
ApJ, 860, 101, doi: 10.3847/1538-4357/aac6d5
18194, doi: 10.1073/pnas.2001258117
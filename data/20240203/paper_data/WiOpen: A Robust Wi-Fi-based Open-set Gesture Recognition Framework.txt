JOURNALOFLATEXCLASSFILES,VOL.14,NO.8,AUGUST2023 1
WiOpen: A Robust Wi-Fi-based Open-set
Gesture Recognition Framework
Xiang Zhang Member, IEEE, Jingyang Huang∗ Member, IEEE, Huan Yan, Peng Zhao, Guohang Zhuang,
Zhi Liu Senior Member, IEEE, and Bin Liu∗
Abstract—RecentyearshavewitnessedagrowinginterestinWi-Fi-basedgesturerecognition.However,existingworkshave
predominantlyfocusedonclosed-setparadigms,wherealltestinggesturesarepredefinedduringtraining.Thisposesasignificant
challengeinreal-worldapplications,asunseengesturesmightbemisclassifiedasknownclassesduringtesting.Toaddressthisissue,
weproposeWiOpen,arobustWi-Fi-basedOpen-SetGestureRecognition(OSGR)framework.ImplementingOSGRrequires
addressingchallengescausedbytheuniqueuncertaintyinWi-Fisensing.Thisuncertainty,resultingfromnoiseanddomains,leadsto
widelyscatteredandirregulardatadistributionsincollectedWi-Fisensingdata.Consequently,dataambiguitybetweenclassesand
challengesindefiningappropriatedecisionboundariestoidentifyunknownsarise.Totacklethesechallenges,WiOpenadoptsa
two-foldapproachtoeliminateuncertaintyanddefineprecisedecisionboundaries.Initially,itaddressesuncertaintyinducedbynoise
duringdatapreprocessingbyutilizingtheCSIratio.Next,itdesignstheOSGRnetworkbasedonanuncertaintyquantificationmethod.
Throughoutthelearningprocess,thisnetworkeffectivelymitigatesuncertaintystemmingfromdomains.Ultimately,thenetwork
leveragesrelationshipsamongsamples’neighborstodynamicallydefineopen-setdecisionboundaries,successfullyrealizingOSGR.
ComprehensiveexperimentsonpubliclyaccessibledatasetsconfirmWiOpen’seffectiveness.Notably,WiOpenalsodemonstrates
superiorityincross-domaintaskswhencomparedtostate-of-the-artapproaches.
IndexTerms—Wi-Fi,GestureRecognition,Open-SetRecognition,CSI,UncertaintyReduction.
✦
1 INTRODUCTION
WI-FI based gesture recognition [1] has garnered sig-
nificant attention in recent years due to its advan-
tagesintermsofubiquitousdeploymentandnon-intrusive
sensing. However, current studies in the field all rely on
a closed-set assumption [2]–[4], i.e., each test sample is
assumed to always belong to one of the pre-defined set
ofgestureclasses.Althoughthisconventionalpresumption
often proves untenable in practical applications, as gesture
recognition systems can invariably encounter unseen ges-
ture classes or even non-gestural activities, close-set tech-
niquestendtoforceunknownclasssamplestobeclassified
into one of the known gesture classes. This limitation not Fig. 1. The comparison between different approaches. (a) Close-set
onlyresultsinanpooruserexperiencebutalsoundermines methods; (b) Distance-based methods; (c) Prototype-based methods;
(d)Wiopen.Coloredcirclesrepresentknownclassessamples,gray”x”
thepracticabilityandreliabilityofWi-Figesturerecognition
symbols,colored”x”symbols,andstarsrepresentsunknownsamples,
systems.Therefore,itisimperativetoaddressthisdrawback misclassifiedsamplesandprototypes,respectively.
and develop more robust and flexible open-set gesture
recognition (OSGR) approaches that can handle open-set Theobjectiveofclosed-setgesturerecognitionistomin-
scenarioseffectively.Suchmethodsshouldproperlyclassify imize empirical risk, which relates to the risk associated
unknown-class samples as “unknown” and known-class with misclassifying known classes. In contrast, OSGR not
samplesasoneoftheknownclasses. only focuses on minimizing empirical risk but also ad-
dressesopenspacerisk.Inreal-worldscenarios,eachclass’s
associated feature space is finite, while the area beyond
XiangZhang,andBinLiu,arewithCASKeyLaboratoryofElectromagnetic
Space Information, University of Science and Technology of China, Hefei, these feature spaces is referred to as the open space, as
230026,China. depicted in Figure 1d. Labeling samples within the open
XiangZhang,JinyangHuang,GuohangZhuang,andPengZhao,Schoolof
space as known classes introduces open space risk. Tradi-
Computer and Information, Hefei University of Technology, Hefei, 230601,
China. tional closed-set classifiers [2], [4] usually divide the entire
Huan Yan, School of Big Data and Computer Science, Guizhou Normal feature space into several known classes, and the decision
University,Guiyang,550025,China.
boundariesofsuchsolutionsareshowninFigure1a.These
ZhiLiu,DepartmentofComputerandNetworkEngineering,TheUniversity
methodsacceptdatafrominfinitelywideregions,implying
ofElectro-Communications,Tokyo,1828585,Japan.
∗Correspondingauthors. thattheiropen-spaceriskisunbounded,makingtheminef-
4202
beF
1
]CH.sc[
1v22800.2042:viXraJOURNALOFLATEXCLASSFILES,VOL.14,NO.8,AUGUST2023 2
fectiveinidentifyingunknownsamples.Incontrasttothese domains. With respect to the second challenge, WiOpen
traditionalschemes,someexistingWi-Fi-basedstudieshave suggests employing the sample’s neighborhood structure
brieflytouchedupontheidentificationofunknownclasses. ratherthanthestructureofthesampleandprototypeasthe
Forinstance,Wione[5]constructedprototypesforallusers criterion for decision boundary construction. The decision
for user identification and classified samples as unknown boundariesconstructedbasedondistancesfromsamplesto
when their distance to the prototypes of all known classes a subset of neighbors exhibit greater flexibility compared
wassimilar.Similarly,CAUTION[6]comparedthedistance to those constructed using distances from samples to pro-
between the sample and the two nearest user prototypes, totypes. This approach effectively bounds open space risk.
classifying it as unknown when the distances were similar. Furthermore, by designing both the training and the deci-
Nevertheless, as illustrated in Figure 1b, these distance- sionboundariesmakingmethodbasedontheneighborhood
basedapproachesareonlyeffectiveforunknownsamplesin structure,WiOpencanaddressopenspaceriskinanend-to-
closeproximitytothedecisionboundaries.Inanotherexam- end manner. As illustrated in Figure 1d, WiOpen confines
ples, Tan et al. [7] and Multitrack [8] developed prototypes thedecisionboundariesofknownclasses,successfullymit-
foreachactivityclassandemployedsimilaritycomparisons igatingopen-spaceriskandenhancingOSGRperformance.
foractivityrecognition.Samplesfallingbelowacertainsim- We have implemented WiOpen and conducted a com-
ilaritythresholdwerelabeledasunknown.Whileprototype- prehensive evaluation using public datasets. The exper-
based approaches construct decision boundaries for reject- imental results illustrate the effectiveness of WiOpen in
ing unknowns based on distance, these boundaries cannot open-set scenarios. Furthermore, when compared to state-
flexibly envelop the feature space of each class, leading to of-the-art (SOTA) approaches, WiOpen demonstrates dis-
misjudgments. All of the aforementioned methods assume tinct advantages in cross-domain tasks. In summary, this
the existence of a prototype that can represent a class. paperpresentsthefollowingcontributions:
However, due to the inherent uncertainty in Wi-Fi sensing,
• We introduce WiOpen, the first Wi-Fi-based open-
such an assumption is unrealistic. The uncertainty, arising
setgesturerecognitionsystem,capableofeffectively
frombothnoiseanddomains,givesrisetoahighlyscattered
reject unknown gestures while recognizing known
and irregular distribution in collected Wi-Fi sensing data.
gestures.
The irregularity in data distribution makes it challenging
• We conduct an in-depth analysis of the open-set
to accurately describe the data distribution using a single
challenges within Wi-Fi-based gesture recognition,
prototype,suchasgreenclassinFigure1c.
elucidatingtherelationshipbetweenuncertaintyand
The uncertainty caused by noise and domain are differ-
Wi-FiOSGRperformance.
ent. Noise, such as environmental and device noise, intro-
• Weproposeauncertaintyquantificationmethodand
ducesrandombiasestotheWi-Fisensingsignals,resulting
an OSGR network inspired by uncertainty quantifi-
in random offsets in the data distribution and making the
cation,designedtomitigateuncertaintyandachieve
distribution more discrete. Domain refers to variables such
effectiveWi-FiOSGR.
asusers,thelocationanddirectionofactivities.Accordingto
• We implement WiOpen and conduct extensive ex-
previousstudies[9],[10],variationsinthedomaincancause
periments on public datasets to evaluate its perfor-
different mappings of activities onto Wi-Fi sensing signals,
mance. Evaluations demonstrate the feasibility and
leading to directed shifts in the data. The uncertainty in
effectivenessofoursystem.
Wi-Fisensingpresentstwosignificantchallengesforimple-
mentingOSGRbasedonWi-Fi.Thefirstchallengeemerges
from the high data dispersion caused by uncertainty, lead- 2 RELATED WORKS
ing to confusion between classes with substantial intra-
2.1 Wi-FibasedGestureRecognition
classvariationandlimitedinter-classvariation.Thesecond
challenge arises from the irregularity in data distribution, Gesture sensing and recognition enabled by WiFi [11], [12]
making it more complex to define decision boundaries for can be broadly categorized into two groups: handcraft-
distinguishingunknownfromknownsamples. based and deep learning-based methods. Handcraft-based
In this paper, we present WiOpen, a robust Wi-Fi-based approaches typically involve manual characterization of
OSGR framework. To address the first challenge, WiOpen signal distortions corresponding to different gestures. In
conducts an extensive analysis of the open-set challenges contrast,learning-basedmethodsleveragemachinelearning
encountered in Wi-Fi gesture recognition. It introduces an techniques for gesture recognition. WiGest [13] employs
uncertainty quantification method as a pivotal step. Lever- manual pattern construction for each gesture in received
aging this analysis, WiOpen takes measures to mitigate signalstrength(RSS)andusesasimilaritymatchingmethod
theuncertaintycausedbynoiseduringdatapreprocessing, forrecognition.Whilethisworkisinspiring,itsrelianceon
achieved through the utilization of the CSI ratio. Subse- coarse-grainedRSSindicatorslimitsitsaccuracy.WiMU[14]
quently,theOSGRnetworkinspiredbyuncertaintyquantifi- goesfurtherbyachievingmulti-usergesturerecognitionus-
cationcomesintoplay.Thisnetworklearnstherelationship ingfine-grainedChannelStateInformation(CSI).However,
between sensing data and Doppler frequency shift (DFS), it relies on an exhaustive search among known gestures,
effectively eliminating the influence stemming from static leading to scalability challenges. WiDraw [15] employs
path factors. Simultaneously, it unravels the intrinsic struc- Angle-Of-Arrival (AOA) measurements for hand tracking,
tureofWi-Fidatacharacterizedbyahighlyirregulardistri- allowing users to draw in the air with minimal tracking
bution by analyzing the relationships between neighboring error. Nevertheless, its practicality is limited by the need
samples, thereby reducing the uncertainty associated with for over 25 WiFi transceivers around the user. QGestureJOURNALOFLATEXCLASSFILES,VOL.14,NO.8,AUGUST2023 3
[16] utilizes phase information for similar performance but misclassification when dealing with samples far from the
requiresknowledgeoftheinitialhandpositionfortracking. classificationboundary[31].
Learning-based methods shift the focus to automatic Existing studies on Wi-Fi-based unknown class recog-
pattern recognition through data-driven techniques. This nition have adopted another approach, known as the
category can be further divided into shallow learning [17], prototype-based method [32]–[35]. In the works of Wione
[18] and deep learning [3], [19], [20]. Shallow learning in- [5] and CAUTION [6], a conventional softmax classifier is
volvestrainingashallowlearnerwithhandcraftedfeatures used for user identity classification. After model training,
for gesture classification. Wikey [18] was one of the first theysummarizeaprototypeforeachclass.Whenasample
to explore keystroke recognition based on WiFi sensing is equidistant from prototypes of two or more classes, it is
and machine learning. WiFinger [17] employs WiFi CSI for classifiedasanunknownuser.However,thisapproachfails
recognizing nine sign languages, but it requires users to when an unknown sample is close to one known class but
be positioned in the line of sight between the transmitting farfromothers.Tanetal.[7]andMultitrack[8]directlylearn
and receiving antennas. While shallow learning typically a prototype for each activity class. Activity recognition is
requiresasmalltrainingdataset,itsperformanceislimited. achievedbycomparingthesimilarityofinputsampleswith
Consequently, deep learning has emerged as an effective prototypes of all classes. When the lowest similarity with
alternative. For example, WiSign [19] focuses on American all prototypes falls below a certain threshold, the sample
SignLanguagerecognition,usingamplitudeandphaseCSI is classified as unknown. This method does not consider
profiles processed by a Deep Belief Network (DBN) for compressing the feature space of known classes to reduce
recognition.However,deeplearning-basedapproachesface open space risk. Moreover, these approaches assume that
a critical challenge, namely, their dependence on domain- each class can be represented by a single prototype. While
specifictraining. thisassumptionisapplicableinvisualdomains,theunique
WiDar3 [2] addresses this challenge by introducing uncertainty in Wi-Fi sensing signals results in highly irreg-
a domain-independent feature, BVP, which characterizes ular data distributions. Consequently, prototypes obtained
power distribution across various velocities for cross- throughtraditionalmethodsareinadequaterepresentations
domain gesture recognition. WiDar3 is among the pio- of corresponding classes. Our proposed method, WiOpen,
neers in unveiling and tackling the cross-domain issue in acknowledges the impact of uncertainty, conducts in-depth
gesture recognition. Its meticulously crafted dataset forms analysis,anddesignstargetedsolutions,thusachievingWi-
the basis for fair comparisons among various recognition Fi-basedOSGR.
frameworks.BuildingupontheWiDar3.0dataset,WiHF[3]
derives a domain-independent motion change pattern for 3 PRELIMINARIES
arm gestures, providing unique features for cross-domain
In this section, we first introduce the concepts of open-
recognition. WiSGP [21] employs a data augmentation-
set recognition and open space risk. We then discuss the
based approach to augment data and domain informa-
uncertainty in Wi-Fi based open-set gesture recognition.
tion, achieving a Wi-Fi gesture recognition system with
Finally,weproposethemotivationofWiOpen.
domain-generalization capabilities. WiSR [4] leverages the
differences between subcarriers to accomplish domain-
generalization in Wi-Fi gesture recognition. WiGRUNT [1], 3.1 Open-SetRecognitionandOpenSpaceRisk
PAC-CSI[22]and[23],ontheotherhand,focusonattention Open-set recognition (OSR) pertains to situations where
mechanisms designed to automatically uncover critical in- new, previously unseen classes emerge during testing. In
formation for gesture recognition. Wi-learner [24] utilizes such cases, a classifier should not only accurately classify
autoencoders to enable small-sample cross-domain Wi-Fi known classes but also effectively reject unknown ones.
gesture recognition. However, these approaches have not Considering a training set D L = {(x 1,y 1),...(x n,y n)} of n
taken into account the more practical scenario of open-set labeled gesture samples, where x i represents each sample
gesture recognition, where considering all test samples as and y i ∈ {1...Y} denotes the label of x i, and a testing
knownposessignificantpotentialrisks. datasetD T ={(t 1),...(t u)}wherethelabeloft i belongsto
{1...Y +Q}, with Q representing the number of unknown
classes typical in real-world scenarios. The open space,
2.2 IdentifyUnknowsinWi-Fi
denoted as O, encompasses regions far from the known
In Wi-Fi sensing research, apart from gesture recognition, classes. And the degree of openness, which quantifies the
some efforts have touched upon the challenge of distin- openspaceintheOSR,canbedescribedasP [36]:
guishingunknownclasses.However,theseeffortsareoften (cid:115)
mentioned as a part of a larger study and lack in-depth 2×Y
P =1− (1)
analysis of this specific challenge. The identification of 2∗Y +Q
unknown classes can be achieved by utilizing the scores
Inevitably, designating any sample in the open space
provided by classifiers [25], [26]. For instance, setting a
as a known class introduces risks, known as open space
threshold on classification scores from traditional machine
learning models [27] or deep softmax learners [28]–[30] risk(R o).Qualitatively,R o canbedescribedastherelative
measure of the open space O in comparison to the overall
can be used to determine whether an input sample be-
measurementspaceM[27]:
longs to an unknown class. Nevertheless, this approach
(cid:82)
is most suitable for identifying unknown samples situated f(x)dx
near the classifier’s decision boundary. It can often lead to R O = (cid:82)O f(x)dx (2)
MJOURNALOFLATEXCLASSFILES,VOL.14,NO.8,AUGUST2023 4
Here, f(x) represents the measurable recognition function, open-space risk for potential unknown data. Open-space
where f(x) = 1 denotes that a certain class within the risk, as quantified by Equation 2, and empirical riskcan be
known classes has been recognized, otherwise f(x) = 0. expressedasfollows:
In other words, the more samples from the open space are
clas Is nifi te hd ea cs ok nn teo xw tn ofcl Oas Ss Res a, nth de ch oig nh sie dr eR rinO gb te hc eom coe ns c.
epts of
R E = N1 (cid:88)N L(f(x i),y i) (7)
i=1
openspaceriskandopenness,thefundamentalrequirement
for addressing the OSR problem is to determine a recogni- Here, N signifies the number of training samples, while x i
tionfunction,denotedasf(x),thatminimizesthefollowing and y i denote the i-th sample and its corresponding label.
open-setrisk:
Thelossfunction,L,gaugesthelikelihoodoftheprediction
f(x i)withrespecttothetruelabely i.
argm fin{R O(f,D U)+λ rR E(f,D L)} (3) It is important to note that both R O and R E are in-
herently linked to the misclassification tendencies of the
Here, λ r serves as a regularization constant, and R O and gesture recognition model, f(x). Traditional recognition
R E representtheopenspaceriskandtheempiricalrisk(the models typically transform input data from the data space
risk associated with incorrectly assigning known samples), to a feature space and subsequently establish a decision
respectively. D L denotes the set of known labeled training boundarywithinthisfeaturespacetodifferentiatebetween
data,andD U representsthepotentiallyunknowndata. distinct classes. Consequently, misclassification may be at-
tributed to three key factors: 1. Data confusion in the
3.2 When Wi-Fi Based Gesture Recognition Meets data space, 2. Feature confusion in the feature space, 3.
Open-SetChallenge Overlapping decision boundaries. The extent of data and
feature confusion essentially determines the upper bounds
Current Wi-Fi based sensing solutions predominantly rely
of decision boundary learning. Furthermore, R O is also
onChannelStateInformation(CSI)[37]–[39].CSIcharacter-
influencedbytheestablishmentofdecisionboundariesused
izes the signal attenuation that occurs as signals propagate
for identifying unknowns. R O performs best when this
throughagivenmedium.Thisattenuationcanbeexpressed
boundary only appropriately encompasses all samples of
throughthefollowingequation:
known classes. However, unfortunately, due to the impact
Y =HX+N (4) of the unique uncertainty inherent in Wi-Fi sensing, both
reducing data confusion and determining suitable decision
Where Y and X are the received and transmitted signal boundariesfacesignificantchallenges.
vectors, respectively. N is additive white Gaussian noise, We define uncertainty in Wi-Fi sensing as the intrin-
andH standsforthechannelmatrixrepresentingtheCSI. sic variability, randomness, or ambiguity present in the
CSI can be delineated as the combination of two main availablesensingdata.Inanutshell,uncertaintyintroduces
components: static CSI and dynamic CSI. Static CSI is in- a certain degree of bias to sensory data, resulting in a
fluencedbythesurroundingenvironmentandthepresence spatialdisplacementofsamplesinthedataspace,ultimately
of a Line-of-Sight (LoS) between the transceivers. Dynamic leading to irregular and discrete distributions of collected
CSI, on the other hand, is primarily determined by the CSI samples. We posit that uncertainty in Wi-Fi sensing
reflectionpathfrommovingobjects: arisesfromtwofactors:noiseanddomains(suchasdistinct
usersordifferentgestureexecutionlocations),anditcanbe
H(r,t)=H s(r,t)+H d(r,t) (5)
expressedas:
Where r and t represent the signal frequency and the Ψ=Ψ n+Ψ d (8)
timestamp, respectively. The dynamic CSI can be further
elaboratedas: whereΨ,Ψ n andΨ d representstheoveralluncertainty,the
uncertainty caused by noise and the uncertainty caused by
H d(r,t)=
(cid:88)
h
k(r,t)e−j2πdk λk(t)
(6) domains.
k∈D A portion of the noise present in CSI arises from mul-
Here, h k(r,t), d k(t), and λ k represent the attenuation, the tipath effects. From equations 5 and 6, the received CSI is
thesummationofsignalsfrommultiplepropagationpaths,
pathlengthofthedynamicpath,andthewavelengthassoci-
atedwiththekth path,respectively.ThesetDencompasses which makes the target path signal susceptible to interfer-
ence from unrelated environmental signals [40]. Addition-
dynamic paths. Notably, gestures induce changes in length
ally, noise is also introduced by Wi-Fi devices themselves,
of the dynamic paths, subsequently altering the overall
CSI sequence. Traditional Wi-Fi-based gesture recognition
contributingtoΨ n:
techniques aim to extract gesture-related information from Ψ n =Ψe n+Ψd n (9)
the overall CSI and subsequently interpret and recognize
theoriginalgestures. WhereΨe andΨd representthenoiseuncertaintycausedby
n n
Incontrasttoclose-setmethods,Wi-Fi-basedOSGRaims environment and devices. Noise introduces random biases
to accomplish the dual task of recognizing known gestures to the collected CSI samples, causing an expansion in the
accurately while effectively identifying unknown gestures. distribution range of these samples. This results in larger
Equation 3 highlights that the challenge in solving the Wi- intra-class differences and smaller inter-class differences,
Fi OSGR problem involves the simultaneous minimization ultimately making it easier for confusion to occur between
of empirical classification risk for labeled known data and classes,asshowninFigure2.JOURNALOFLATEXCLASSFILES,VOL.14,NO.8,AUGUST2023 5
Fig.2.Themultipatheffect,variationsintheenvironment,changesinthepositionandorientationoftheperformer,andinterferenceallcontribute
toanincreasedrandomnessinthedistributionofWi-FiCSIdata.
to quantify it. Noise adds random noise to CSI data, and
Before Filter
the data distribution of this random noise should follow a
16 normal distribution with an unknown variance. Therefore,
quantifying noise uncertainty can be transformed into as-
14
sessing the proportion of data in CSI that conforms to this
12 normal distribution and the magnitude of the variance of
thisnormaldistribution.Ontheotherhand,domainuncer-
200 400 600 800 1000 1200 1400 1600
taintyresultsindirectionalbiasesinthedata.Whendomain
After Filter
uncertainty is higher, the distance of an individual CSI
16 sample to other samples of the same class increases, while
the distance to samples of other classes decreases. Thus, it
14
can be transformed into assessing the distances between
12 all samples and other samples. Therefore, we propose the
followingformulatoquantifyuncertainty.
200 400 600 800 1000 1200 1400 1600
Time(ms)
Ψ=Ψ +Ψ
n d
F beig fo. r3 e. fiE lx tea rm inp gle iss 1o .f 9s 2a ,m anp dle Ψs nwi ath fted rif fife ltr ee rn int gno isis 0e .9u 6n .certainty,whereΨn
=
N1 ∗G((cid:88)N ((cid:88)G
(α nk−α¯
n)2+(cid:88)G
σ nk))
n=1 k=1 k=1 (11)
1 (cid:88)N (cid:88)N (cid:88)N (cid:88)N
Domain-induceduncertaintysimilarlyintroducesbiases + ( d(x ,x )− d(x ,x ))
N n i n j
to the collected CSI samples. However, unlike noise un- n=1i=1 n=1j=1
certainty, the biases introduced by domain uncertainty are
directional,closelyrelatedtotheprinciplesofWi-Fisensing. Here,i̸=nandj ̸=n,y i ̸=y n andy j =y n.
The two terms in the formula above serve as measures
When there is no significant change in static paths, CSI
of noise uncertainty and domain uncertainty. For the first
variations are primarily driven by dynamic path changes
caused by activities. According to the Fresnel zone theory
term, we fit a CSI sample, denoted as x n, into a Gaussian
Mixture Model (GMM) with G components, leading to the
[9],[10],[41],eveniftheuser’sgesturesremainunchanged,
followingprobabilitydistribution:
variationsinuserpositionsandorientationsconcerningthe
transmitting and receiving antennas lead to corresponding G
(cid:88)
changes in the dynamic path variations. Wi-Fi sensing is p(x nt)= α nkη(x k,µ nk,σ nk) (12)
highly sensitive to domain changes, and as CSI data repre- k=1
sentsthesuperimpositionofsignalsfrommultiplepaths,it
Whereα nk representstheprobabilitythattheobserveddata
possesses a lower spatial resolution compared to sensory
belongs to the kth component, µ nk and σ nk represent the
data in domains such as vision. Domain changes result
expectationandvarianceofthekthcomponent,respectively.
in substantial data distribution shifts towards the corre-
Here,ηistheGaussianprobabilitydensityfunctionandN is
sponding directions, as illustrated in Figure 2. This type of
uncertaintyisreferredtoasΨ d: t th ime en su tam mb per oo ff thsa em np thle ss a. mx n pk ler .e Wpr hes ee nn xts nt eh xe hr ie ba id tsin lag rga et rth ne ok ist eh
,
Ψ d =Ψu d +Ψl d+...Ψn dd (10) itindicatesstrongerrandomnoise.ThisresultsinoneofK
Gaussiancomponents(representingrandomnoise)havinga
Where Ψu d, Ψd
d
and Ψn dd represent user, location and nd th higherα nk.Moreover,greaternoiseleadstoamorerandom
domain. Such uncertainty is common in Wi-Fi based sens- data distribution, resulting in a larger σ nk. Consequently,
ing,leadingtoawidelyscatteredandirregulardistribution we design the first term to quantify Ψ n, and the effect is
ofCSIdata[2],[3]. showninFigure3.
ItcanbeobservedthataddressingthechallengesofWi- The second term in Equation 11 is used to measure Ψ d.
Fi-based OSGR requires eliminating the effects of uncer- In this term, y n represents the label of x n, and d denotes
tainty, and before eliminating uncertainty, it is advisable the distance metric function. The objective of this term is
edutilpmA
edutilpmAJOURNALOFLATEXCLASSFILES,VOL.14,NO.8,AUGUST2023 6
(a) (b)
Fig.5.WiOpenSystem.
Fig.4.Domainuncertainty.(a)0.0901;(b)0.2659.Coloredpointsrepre-
sentsamplesfromknownclasses,whilegraypointsrepresentsamples
fromunknownclasses.
buttheyhavelimitations.Thedecisionboundarytheyestab-
lishpartitionstheentirefeaturespaceintoregions,equalto
to gauge domain-related uncertainty by considering neigh- the number of known classes. Furthermore, softmax scores
borhood relationships. In essence, when there is a lower normalize measures that quantify the ratio of the distance
probability that closer neighboring samples belong to the between a sample and a class to the sum of distances
same class, uncertainty increases. Conversely, the higher between the sample and all other classes. Thus softmax
the probability that a sample’s neighbors originate from classifiers may not effectively bound open space risk. Even
other classes, the greater Ψ d becomes. We selected some for an unknown sample, if its distance to a known class is
datafromtheWiDar3.0[2]datasetandpresentedtheirdata significantlycloserthantootherknownclasses,thesoftmax
distribution as shown in Figure 4. Figure 4a includes data scores would assign a high probability to it belonging to
from different users, while Figure 4b includes data from theclosestknownclass.Thisresultsinaclassifierthatonly
differentusers,directions,andpositions.Itcanbeobserved rejects sample near the decision boundary, causing regions
that domain factors do increase the irregularity in data ofacceptancetobeinfinitelywide,asillustratedinFigure1.
distribution. Our uncertainty measurement approach can Furthermore,whiletheproposedapproachcaneliminate
alsoquantifydomainuncertainty. a portion of uncertainty, the final samples feature distri-
bution still exhibits irregularity. Therefore, the prototype-
based approaches continues to face challenges in obtaining
3.3 MotivationofWiOpen optimaldecisionboundaries.Toaddressthisissue,building
upontheuncertainty-inspiredOSGRnetwork,weintroduce
Based on the previous analysis, effectively addressing
decision functions constructed based on semantic relation-
the open-set challenge in Wi-Fi-based gesture recogni-
ships between samples and their neighbors. Specifically,
tion hinges on mitigating the impact of uncertainty in
distancesbetweensamplesareusedtodefineaclassification
data/feature space. To mitigate uncertainty, we propose a
distribution based on class labels. Neighbor relationship
method that involves designing strategies in both the data
mining helps overcome the limitation of learning a single
preprocessing and feature learning stages, each serving a
protype for each class, making it more suitable for Wi-
distinct purpose. In the data preprocessing stage, WiOpen
Fi sensing data with significant irregularity. Furthermore,
focusesonthereductionofnoiseinterference.Thisstepises-
employing uncertainty measurement (distance in WiOpen)
sential in eliminating unwanted data variations introduced
directly as the decision boundaries optimization parameter
by environmental factors, device noise, and multipath ef-
makesthenetworkmoreconducivetoreducinguncertainty,
fects.Inthefeaturelearningstage,ourapproachutilizesthe
achieving end-to-end uncertainty reduction, and effective
uncertainty quantification method-inspired OSGR network
decisionboundaryplanning[42].
to facilitate dynamic-related feature extraction and sample
clusteringinthefeaturespace.Thesefeaturesaimtocreate
more compact representations, which in turn significantly 4 METHOD
loweruncertainty,thusenhancingthefinaldecision-making
4.1 OverviewofWiOpen
process. Specifically, according to the uncertainty quantifi-
cation method, the OSGR network assesses the distances As shown in Figure 5, WiOpen is composed of three
between each sample and all other samples, effectively main components: data acquisition, data processing, and
bringing closer the distances between samples of the same the OSGR network. The data acquisition component is
class and pushing away those from other classes during responsible for obtaining data from Wi-Fi sensing devices
training. and performing data preprocessing to eliminate some of
In the decision-making phase, it is essential to learn the noise uncertainty. The data preprocessing component
decision boundaries to effectively bound open space risk involves extracting DFS from CSI and visualizing it along
and empirical risk under the impact of uncertainty. Deep with CSI amplitude and phase as input to the OSGR net-
learningtechniques,havedemonstratedpromiseinvarious work. The OSGR network utilizes the reconstruction from
Wi-Fi-based gesture recognition tasks. Traditional softmax CSItoDFStoeliminateinfluenceofstaticpaths,andlearns
classifiers [2], [3] are efficient at measuring empirical risk, thesemanticneighborhoodstructureofsamplestoeliminateJOURNALOFLATEXCLASSFILES,VOL.14,NO.8,AUGUST2023 7
domain uncertainty and construct decision boundaries for
open-setrecognition.
4.2 DataAcquisition
The CSI is collected from wireless network cards capable
of capturing CSI. As demonstrated in the previous section,
the gesture can be portrayed by the change CSI. However,
with commodity Wi-Fi devices, there’s a challenge due to
unsynchronized transmitters and receivers, leading to a
time-varyingrandomnoisee−jθ n:
Fig.6.Theamplitudeandphasevisualizationforasampleof”push&
H(f,t)=e−jθn(H s(f,t)+H d(f,t)) pull”gesture.
(13)
= e−jθn(H s(f,t)+A(f,t)e−j2πd( λt) )
whereA(f,t),e−j2πd( λt)
andd(t)denotethecomplexatten-
uation,phaseshiftandpathlengthofdynamiccomponents,
respectively. This random phase noise, e−jθ n, hinders the
direct use of CSI phase information and increase noise
uncertainty.
Therefore, we need to eliminate e−jθn. Fortunately, for
commodity Wi-Fi cards, this noise remains constant across
different antennas on the same Wi-Fi Network Interface
(a) (b)
Card (NIC) because they share the same RF oscillator. This
noisecanbeeliminatedusingtheCSI-ratiomodel[43]: Fig.7.TheDFSvisualizationforasampleof”push&pull”gesture.(a)
Previousmethod[2];(b)Ourmethod.
H (f,t)
H (f,t)= 1
q H (f,t)
2
=
e−jθn(H s,1+A 1e−j2πd1 λ(t) ) fromIn dco atn atra ps rt octo essp er devi wou its hm Ce St Iho rd ats i, o,W aiO sp oe pn pod se er dive ts oD CF SS
I
e−jθn(H s,2+A 1e−j2πd2 λ(t) ) (14) conjugate multiplication [2]. The CSI ratio method is ad-
=
A
1e−j2πd1 λ(t)
+H
s,1
v roa tn at ta iog neou ans dbe sc ca au lis ne git ofrep Cr Se Ise in nts thtr ean cs of mor pm lea xtio pn ls ans eu ,ch thuas
s
A
2e−j2πd1(t) λ+△d
+H s,2 avoiding some negative effects introduced by H 2(f,t). To
further mitigate cumulative error effects caused by △d, we
where H 1(f,t) and H 2(f,t) are the CSI of two receiv-
apply an antenna selection coefficient s a to select H 1(f,t)
ing antennas. When two antennas are close to each other,
△d can be regarded as a constant. According to Mobius
andH 2(f,t).Thiscoefficientiscalculatedasfollows:
t sr ua cn hsf ao srm sca at li io nn g[ a4 n4 d], re oq tu ata it oio nn o1 f4 thr eep pr he ase sent ss ht ir fa tn es −fo j2r πm da
1
λ(t ti )on os
f s a =
C1 (cid:88)C mv ea ar n(| (H |Ha(f (fc,t ,) t) )|
|) (15)
antenna 1 in the complex plane, and these transformations c=1 a c
willnotaffectthechangingtrendoftheCSI.Followingthe wherevarandmeandenotethevarianceandmeanvalueof
CSI ratio-processing, we further mitigate noise uncertainty amplitudereadingsfortheathantennaofthecthsubcarrier.
by subjecting the data to a low-pass filter for the removal Weselecttheantennaswiththehighestandlowests avalues
of environmental noise. Subsequently, the processed data as H 1(f,t) and H 2(f,t), respectively. The rationale behind
undergoesfurtherrefinementinthedataprocessingsection. this selection is that CSI with larger variances is generally
more sensitive to motion, while CSI with higher amplitude
typically contains a larger static path component, making
4.3 DataProcessing
H
1(f,t)
lessaffectedby△d.
The data processing section involves visualizing the CSI AfterobtainingdenoisedCSIafterdataacquisition,and
and extracting DFS, which are fundamental for providing to further reduce the impact of the static path (without
high-quality inputs to the OSGR network. Specifically, To introducing DFS), we apply a high-pass filter. Finally, we
ensure that the OSGR network receives normalized and utilize Fast Fourier Transform (FFT) to obtain DFS. A com-
information-rich inputs, we adopt the CSI visualization parisonbetweenthemethodusedtoextractDFSinprevious
technique detailed in [1]. This method visualizes both the approachesandtheoneadoptedbyWiOpenisillustratedin
amplitude and phase of CSI separately and then integrates Figure7.Notably,thelatterproduceshigher-qualityDFS.
them into a single image. The advantage of this approach
is that it consolidates the various dimensions of CSI infor-
4.4 Open-SetGestureRecognitionNetwork
mationintoatwo-dimensionalmatrix,whichissuitablefor
processing using a Convolutional Neural Network (CNN)- TheproposedOSGRnetwork,depictedinFigure8,isstruc-
based network. The visualization results for CSI amplitude tured into two branches, each with specific objectives. The
andphasearedepictedinFigure6. first branch is dedicated to constructing DFS outputs fromJOURNALOFLATEXCLASSFILES,VOL.14,NO.8,AUGUST2023 8
Fig.8.Frameworkoftheproposedopen-setgesturerecognitionnetwork.
the original inputs, while the other is focused on learning distancesbetweensamplesofthesameclasswhilepushing
valuable class-related knowledge. Throughout the training samples from other classes further apart, thus effectively
process, these branches are guided by the neighborhood reducing domain uncertainty. The second branch is specif-
lossandconstructionloss,respectively,tofacilitateeffective ically dedicated to domain uncertainty reduction. Consid-
knowledge acquisition. During testing, a K-Nearest Neigh- ering a training sample x n ∈ [x 1...x N] along with its
bors (KNN)-based decision method is employed to classify correspondinglabely n anditsfeaturevectorv n = f θ1(x n),
knownsamplesandrejectunknownones. we employ similarity as the distance metric. The similarity
Evenafterdatapreprocessing,theCSIretainsinfluences betweenx nandanothersamplex j ∈[x 1...x N]isdefinedas
from static path interference and domain uncertainty. To thecosinesimilarity:
address the former, some existing approaches [2], [3], [24]
vT
advocate using DFS or its derivatives as input for the s nj = ||v ||n ||v || =v nTv j (17)
network, as DFS predominantly captures dynamic path n j
characteristics and effectively mitigates interference from Theprobabilitythatsamplex n selectsx j asitsneighboris:
static paths. However, relying solely on DFS as input may
exp(s /γ)
result in the loss of valuable information. Therefore, our p nj = (cid:80) expn (j s /γ),p nn =0 (18)
approach retains both amplitude and phase as input but k̸=n nk
incorporates a construction loss to guide the network in γ istheparametertocontrolthescaleoftheneighborhood.
leveraging dynamic path-related information and mitigat- During the training process, for each sample x n, the
ing interference from static paths to the fullest extent.
OSGR network computes its probability of being classified
As illustrated in Figure 8, f θ1(x) represents the backbone
correctlyasfollows:
network responsible for feature learning. It extracts low-
dimensionalfeatures,denotedasv n,fromthesample.These p n = (cid:88) p nj (19)
featuresarethentransformedintoDFScorrespondingtothe
j∈Sn
sample through the first branch f θ2(x). During the process
of constructing DFS, a bottleneck structure exists between
S nrepresentstheindicesofallsampleswithlabelsidentical
f θ1(x) and f θ2(x). This structure ensures that the learned
to that of x n. The loss for the second branch, referred to as
neighborloss,isdefinedas:
featuresv n containasmuchinformationrelatedtodynamic
paths as possible to achieve high-quality DFS construction. 1 (cid:88)N 1 (cid:88)N
Therefore, training this branch using the construction loss L e = N Ln e =− N log(p n) (20)
servesthepurposeofeliminatinginfluenceassociatedwith n=1 n=1
staticpaths.Theconstructionlossisdefinedas: The gradient calculation of Loss L e with respect to the
featurevectorsv n isasfollows:
L c =MSE(xd nfs,f θ2(f θ2(x n))) (16) ∂Ln 1 (cid:88) (cid:88)
∂ve = γ( p nkv k− p˜ nkv k) (21)
WhereMSE representsMeanSquaredErrorloss,x n isthe n k∈Sn k∈Sn
inpu Fot rsa am ddp rle e, ssa in nd gx dd n of ms ais inth ue nD ceF rS tac io nr tyre ,s dp ro an wd inin gg into spx in ra.
tion
wherep˜ nk =p nk/(cid:80) j∈Snp nj isthenormalizeddistribution
within the class y n. The overall loss of the OSGR network
from the uncertainty quantification method outlined in
is:
Equation 11, we have devised a scheme based on neighbor
L=L e+λL c (22)
component analysis (NCA) [45]. In this approach, NCA
computes the distance of each training sample to all other Where λ is the hyperparameter controlling the impact of
sampleswithintheembeddingspace.Subsequently,guided the construction branch. Throughout the training process,
by the distance metric and class labels, it minimizes the L induces samples of the same class to converge in theJOURNALOFLATEXCLASSFILES,VOL.14,NO.8,AUGUST2023 9
TABLE1
DescriptionofWidar3dataset
No.of No.of No.ofOri- No.of
Environments Gestures
Users Locations entations Samples
1:PushPull;2:Sweep;3:Clap;4:Slide;5:Draw-O(Horizontal);
1st(Classroom) 9 6:Draw-Zigzag(Horizontal);7:Draw-N(Horizontal);8: 5 5 10125
Draw-Triangle(Horizontal);9:Draw-Rectangle(Horizontal);
1:PushPull;2:Sweep;3:Clap;4:Slide;5:Draw-O(Horizontal);
2nd(Hall) 4 5 5 3000
6:Draw-Zigzag(Horizontal);
1:PushPull;2:Sweep;3:Clap;4:Slide;5:Draw-O(Horizontal);
3rd(Office) 4 5 5 3000
6:Draw-Zigzag(Horizontal);
feature space while simultaneously distancing them from 5 EXPERIMENTAL ANALYSIS
samplesofdifferentclasses.Thisprocessnotonlyeradicates 5.1 Datasets
domainuncertaintybutalsoenableseachsampletoharness
In this section, we introduce two datasets, Widar3.0 and
knowledge associated with all other samples, facilitating
ARIL,whichareusedforexperimentalevaluation.
thelearningofclass-relatedinformation.Consequently,this
Widar3.0: The public dataset WiDar3.0 [2] contains
leads to the formation of a feature space characterized by
16125 samples collected from 3 environments, and its de-
semantic separability. Utilizing this semantic space allows
tailed description is shown Table 1. To verify the perfor-
fortheclassificationofknownclassesandthediscrimination
manceoftheWiOpensystem,insection5.3,weevaluatethe
ofunknownclasses.
know samples recognition and unknow samples rejection
For recognize know gestures and reject unknows, all
performance under different openness P with all the data
feature vectors of training samples are stored in a feature
from1stenvironment(10125samples,9users×5positions
database,referredtoasT.Duringthetestingphase,aquery
× 5 orientations × 9 gestures × 5 instances). In section 5.4,
sample x t has its feature vector v t extracted using the pre- wealsouseallsamplestoevaluatethein-domainandcross-
trained network f θ1(x t). Subsequently, v t is used to query domainperformanceofWiOpensameasotherstate-of-the-
asetofK nearestsamples,referredtoasS k,fromT based
artresearches[21],[22].
onasimilaritymeasure.Themajorityclasswithinthissetis
ARIL: The ARIL dataset [46] comprises six distinct ges-
thendefinedasthecandidatelabel:
tures (namely, hand up, hand down, hand left, hand right,
y tc =max(p c|p c = sum( Ky j =c) ) (23) h 16an dd isc tii nrc cl te, loa cn ad tioh na snd wic tr ho inss) a, e coxe nc fiu nt ee dd sb py aca e.si Nng ol te abu ls ye ,r tha et
ARILdataset,whilefeaturingonlyoneenvironmentalvari-
The final label for x t is determined based on y tc and a able (location), incorporates the use of universal software
thresholdt:
radio peripheral (USRP) devices for CSI data collection.
(cid:40) yc,(cid:80) d(x ,x )<t We employ this dataset to assess the versatility of WiOpen
y t = yt ,(cid:80)j∈S tc d(xt ,xj )≥t (24) underdifferentopennessPacrossdifferentwirelessdevices.
u j∈Sc t j
t Otherwise, we also use ARIL to evaluate the cross-domain
Here,y u signifiesthatx t belongstoanunknownclass.The performance of WiOpen. The ARIL dataset encompasses
thresholdtisdefinedas: 1392samplestotally.
t=ξ∗ B1 (cid:88)B max((cid:88) d(x r,x j)) (25) 5.2 ImplementationDetails
b=1 j∈Sr Inourimplementation,thedataacquisitionandpreprocess-
ingwererealizedusingMatlab,whereastheOSGRnetwork
Where B represents the total number of training batches,
was constructed using the PyTorch framework. Following
x r refers to all the samples in batch b, and ξ is a hyper- extensive experimentation, we determined the optimal hy-
parameter used to control the threshold. In contrast to pre-
perparameters,whichweresetasfollows:ξ =2,λ=1,and
vious approaches, the proposed OSGR network formulates
γ = 0.05. The number of neighbors, K, used for selecting
uncertainty measurement, feature learning objective, and
testsamplelabelswassetto50.Duringtraining,weutilized
classifier decision criteria based on inter-sample neighbor-
an initial learning rate of 0.001, which was reduced by
hood relationships. This approach integrates the optimiza-
a factor of 10 every 15 epochs for a total of 50 epochs.
tionobjectivesforuncertaintyreduction,meaningfulfeature
We employed the Adam optimizer for our model, and the
learning,anddecisionboundarydefinitioninanend-to-end
feature extraction backbone network, f θ1(x), is a ResNet18
manner.Settingdecisionboundariesthroughneighborhood
network, while the f θ2(x) is a 7- layer CNN. The code is
relationships overcomes the limitations of prototype-based
availableathttps://github.com/purpleleaves007/WiOpen.
schemes, allowing for dynamic and flexible determination
of decision boundaries based on the distribution of sur-
5.3 OverallPerformance
roundingsamples.Furthermore,theproposedthresholdde-
termination approach facilitates adaptive threshold setting In this study, we have chosen to assess OSGR performance
duringtraining,therebyenhancingtheflexibilityofdecision usingclose-setaccuracyandtheareaundertheReceiverOp-
boundarydetermination. erating Characteristic curve (AUROC). Close-set accuracyJOURNALOFLATEXCLASSFILES,VOL.14,NO.8,AUGUST2023 10
TABLE2
AUROCcomparisonbetweendifferentmethodsonWidar3.0.Thebest
performancevaluesarehighlightedinbold.
Method\OP 0.11 0.16 0.22 0.29 0.40
Softmax[29] 0.67 0.76 0.73 0.74 0.71
WiGRUNT[1] 0.69 0.76 0.73 0.75 0.72
Wione[5] 0.68 0.75 0.75 0.76 0.69
WiOpen 0.74 0.80 0.81 0.79 0.76
TABLE3
Close-setaccuracycomparisonbetweendifferentmethodson
Widar3.0.Thebestperformancevaluesarehighlightedinbold.
Fig.9.Thedistributionofsamplesinthefeaturespace.
Method\OP 0.11 0.16 0.22 0.29 0.40
TABLE5
Softmax[29] 96.27% 95.11% 95.11% 95.56% 95.33% Close-setaccuracycomparisonbetweendifferentmethodsonARIL.
WiGRUNT[1] 96.81% 95.22% 96.11% 95.85% 96.89% Thebestperformancevaluesarehighlightedinbold.
Wione[5] 96.30% 95.29% 96.22% 96.15% 96.22%
WiOpen 96.59% 95.82% 96.56% 96.59% 97.11%
Method\OP 0.05 0.11 0.18 0.29
Softmax[29] 86.25% 88.02% 93.06% 91.67%
WiGRUNT[1] 87.50% 88.54% 93.75% 92.71%
focuses on evaluating the classification performance with
Wione[5] 87.95% 88.79% 92.96% 90.52%
respect to known classes, while AUROC [35] serves as a WiOpen 89.58% 93.23% 93.75% 94.79%
robust measure for assessing the ability to distinguish un-
knownclasses.AnAUROCvalueof”1”indicatescomplete
separabilitybetweenknownandunknownclasses.Wealso WiGRUNT, to OSGR systems often involves a complex
conducted a comparative analysis between WiOpen and search process to determine the optimal score threshold.
threereferencemodels:abaselinemodelbasedonSoftmax, Incontrast,WiOpendynamicallyadaptsthethresholddur-
aSOTAWi-FigesturerecognitionsystemWiGRUNT[1]and ing the training process. WiOpen’s training and unknown
aprototypebasedmethodWione[5]. rejection strategies, grounded in neighborhood structures,
ResultsonWidar3.0.Toevaluatetheperformanceofthe offer an improvement over prototype-based methods like
WiOpen in open-set scenarios, we conducted experiments Wione. As evident in Tables 2 and 3, WiOpen achieves a
using 10,125 samples from the first environment and per- balanced performance in recognizing known samples and
formedtestingatdifferentopennesslevels(P =0.11−0.40).
rejecting unknown samples. It’s crucial to note that when
When P = 0.29, it indicates that our model was trained P = 0.11, the AUROC for all approaches is notably low.
using 2,700 samples from three known classes. Within the This phenomenon is attributed to the high similarity be-
test set, we allocated 675 samples from these three known tweenthesixthandseventhgestures(ZigzagandN),which
classes as ”known” samples, while the remaining 6,750 can be considered essentially the same gesture rotated in
samplesfromsixotherclasseswereconsidered”unknown.” space. This emphasizes the importance of addressing the
Thissetupmirrorsareal-worldscenariowhereasubstantial distinction between intra-set and extra-set gestures, espe-
numberofunknownsamplesareencountered.ForAUROC cially when they exhibit varying levels of similarity in
calculations, we assigned label ”0” to known classes and open-set scenarios. This presents an intriguing avenue for
label”1”tounknownclasses. future research. To visually represent the impact of the
The experimental results, as outlined in Tables 2 and 3, OSGR network, we plotted the distribution of samples in
underscore the superior performance of WiOpen in open- the feature space after processing, as depicted in Figure
set scenarios compared to traditional methods. WiOpen 9. The figure illustrates that the OSGR network effectively
not only maintains competitive recognition accuracy but mitigates a portion of domain uncertainty compared to the
also excels in identifying unknown samples, demonstrat- statedepictedinFigure4b.
ing a consistently higher AUROC ranging from 0.03 to Results on ARIL. For ARIL, we use all 1,392 samples
0.07 compared to other methods. Notably, the transition to evaluate WiOpen. Testing was conducted across a range
from conventional gesture recognition systems, such as
TABLE6
TABLE4 Close-setaccuracycomparisonbetweendifferentmethodsonARIL.
AUROCcomparisonbetweendifferentmethodsonARIL.Thebest Thebestperformancevaluesarehighlightedinbold.
performancevaluesarehighlightedinbold.
Cross-Ori Cross-Loc
Method
Method\OP 0.05 0.11 0.18 0.29 AUROC Acc AUROC Acc
Softmax[29] 0.64 0.65 0.59 0.71 Softmax[29] 0.70 90.80% 0.76 97.19%
WiGRUNT[1] 0.65 0.66 0.58 0.72 WiGRUNT[1] 0.72 91.70% 0.76 97.33%
Wione[5] 0.66 0.66 0.57 0.70 Wione[5] 0.69 90.80% 0.74 96.87%
WiOpen 0.73 0.67 0.72 0.76 WiOpen 0.78 92.59% 0.81 97.19%JOURNALOFLATEXCLASSFILES,VOL.14,NO.8,AUGUST2023 11
TABLE7
Crossdomaingesturerecognitionresultscomparedwithstate-of-the-artsolutions.(I-D,C-L,C-O,C-EandC-UmeansIn-Domain,CrossLocation,
Orientation,EnvironmentandUser,respectively.6Dand1Dmeansuse6and1pairsoftransmitter-receivers,respectively).
WiDar3.0-6D WiDar3.0-1D ARIL
Method Pub Year
I-D C-L C-O C-E C-U C-E C-L C-O C-U C-L
WiDar3.0[2] IEEETPAMI 2021 92.7% 89.7% 82.6% 92.4% - - - - - -
WiHF[3] IEEETMC 2020 97.65% 92.07% 82.38% 89.67% - - - - - -
WiGRUNT[1] IEEETHMS 2022 99.71% 96.62% 93.85% 93.73% - - - - - -
PAC-CSI[22] IEEEJSAC 2023 99.46% 98.77% 98.90% 96.47% 97.54% - - - - -
SelfReg[47] IEEEICCV 2021 - - - - - 39.11% 76.71% 86.67% 53.10% 44.45%
WiSGP[21] IEEETMC 2023 - - - - - 43.17% 78.49% 88.46% 56.77% 48.74%
WiSR[4] IEEETMC 2023 - - - - - 42.52% 77.51% 88.80% 55.18% 48.64%
WiOpen - 2023 99.78% 98.81% 98.05% 97.99% 98.47% 84.44% 86.40% 77.67% 82.71% 73.61%
of openness levels (P = 0.05−0.29). The parameters and
experimental procedures remained consistent with those 100
employed for the WiDar3.0 dataset. It’s worth noting that 99
whenevaluatingthesoftmaxandWiGRUNTsystems,anew 98
search for the optimal threshold was required, introducing
97
notableinconvenienceandlimitations.
96
The experimental results, presented in Tables 4 and 5,
firmly establish WiOpen’s superiority in both recognizing 95
knownsamplesandeffectivelyrejectingunknownsamples. 94
TheseresultsunderscoreWiOpen’srobustperformance. 93
Results on Open-Set + Cross Domain. To ascertain
92
WiOpen’s performance in more demanding environments,
91
wecombinedopen-setscenarioswithcross-domainscenar-
ios. Specifically, we conducted experiments utilizing data 90
OID WID OCO WCO OCL WCL
fromthe1stenvironmentoftheWiDar3.0dataset,applying Method
open-set setting across different locations and orientations,
allunderanopennesslevelof0.29. Fig.10.Box-plotofWiOpenandWiGRUNT,ID,CLandCOindicatesin-
domain,cross-locationandcross-orientation,respectively,andOandW
The experimental results, as detailed in Table 6, affirm
representsWiOpenandWiGRUNT,OIDmeansin-domainresultswith
thatWiOpenmaintainsitsproficiencyinrecognizingknown
WiOpenmethod.
samplesandeffectivelyrejectingunknownsamples,evenin
cross-domain open-set scenarios. Notably, the introduction performance than the state-of-the-art PCA-CSI [22] in
of domain discrepancies poses additional challenges. The the cross-orientation task. However, it outperforms both
successful performance of WiOpen in cross-domain open- WiGRUNT and PCA-CSI in other settings, showcasing su-
set recognition is especially promising, as it closely aligns perior overall performance. In the WiDar3.0-1D and ARIL
withreal-worldapplicationsandmeritsfurtherexploration. scenarios, WiOpen lags behind WiSGP and WiSR in the
cross-orientation task. Nevertheless, it significantly outper-
5.4 CrossDomainPerformance forms WiSGP [21] and WiSR [4] in other tasks. Particularly
To facilitate a more comprehensive comparison of WiOpen noteworthy is WiOpen’s substantial lead of over 41% in
with other SOTA Wi-Fi based gesture recognition systems cross-environment scenarios. To further assess the system’s
and to underscore the efficacy of our proposed uncertainty robustness, we conducted a comparative analysis between
reductionmethod,weextendedourexperimentsintocross- WiGRUNT[1]andWiOpenundertheWiDar3.0-6Dsetting.
domain tasks. To ensure compatibility with established so- The results are depicted in Figure 10. Clearly, WiOpen not
lutions, we conducted performance evaluations using the only achieves higher accuracy but also demonstrates less
WiDar3.0datasetintwodistinctscenarios:oneinvolvingall performancevarianceacrossdifferentdomainscomparedto
six pairs of transmitter-receivers and the other employing WiGRUNT. These findings underscore the superior robust-
only a single pair of transmitter-receiver. In the case of nessofWiOpen.
utilizingallsixpairsofdevices,ourdatasetsettingsclosely The key to WiOpen’s success in cross-domain tasks lies
align with the SOTA PAC-CSI [22]. It’s noteworthy that initsinnovativeapproachtouncertaintyelimination.While
they opted to select 80% of the testing samples for the test initially designed to address open-set challenges in Wi-
set, a distinction from our approach in which we did not Fi gesture recognition, the domain uncertainty reduction
performanysampleselectionforthetestset.Inthescenario facilitatedbytheOSGRnetworkprovestobeadvantageous
involving just one pair of transmitter-receiver, our dataset for cross-domain applications. The elimination of domain
settings mirror those of WiSR [4]. Furthermore, we also uncertainty induces the convergence of feature spaces for
conductedexperimentsontheARILdatasettoevaluatethe individual classes. The features acquired through OSGR
performanceofWiOpeninabroadercontext. learning remove domain-specific irregularities, fundamen-
The experimental results are summarized in Table 7. In tallyalleviatingdomaindisparitiesandaugmentingdomain
the WiDar3.0-6D setting, WiOpen exhibits slightly lower generalization capabilities. This further underscores the ef-
)%(ycaruccAJOURNALOFLATEXCLASSFILES,VOL.14,NO.8,AUGUST2023 12
100 0.84
100
0.82
98 95 C-O
0.8 C-L
96 90
0.78
94 85
0.76
92 0.74 80
1 1.5 2 2.5 3 75
70
Fig.11.ImpactofThresholdξ.
65
98 60
20 40 60 80 100
0.82
Number of samples (%)
97 0.81
Fig.13.ImpactofDifferentAmountsofTrainingData.
0.8
96
0.79
95 a comprehensive analysis of open-set challenges within
0.78
the realm of Wi-Fi sensing, shedding light on the intrin-
94 0.77
0 0.5 1 1.5 2 siccorrelationbetweenWi-Fi-basedOSGRanduncertainty.
Building upon this correlation analysis, we have put forth
solutions designed to eradicate uncertainty in Wi-Fi sens-
Fig.12.ImpactofConstructionLoss.
ing and establish decision boundaries. Our experimental
results not only underscore the remarkable effectiveness of
fectiveness of WiOpen, highlighting the central role played WiOpen in open-set gesture recognition, but also validate
byitsfoundationalprincipleofuncertaintyreduction. the profound advantages of WiOpen in cross-domain and
small-samplerecognitiontasks.ThissubstantiatesWiOpen’s
5.5 SensitivityAnalysis unique ability to glean meaningful knowledge, making it a
In this section, we conduct sensitivity analyses on WiOpen robustsystemforreal-worldapplications.Forfutureworks,
toassesstheimpactofvariousfactorsonitsperformance. wewillcontinuetoaddresstheintricatechallengesposedby
ImpactofThreshold. the high similarity between unknown and known gestures
ToevaluatethesensitivityofWiOpentothethresholdξ, in open-set scenarios. Furthermore, we aim to tackle the
weconductedexperimentswithξ valuesrangingfrom1to complexities introduced when the target domain contains
3 while keeping P = 0.29. The results, displayed in Figure unknown samples during domain adaptation, further en-
11, demonstrate a clear relationship between the threshold hancingtheirsuitabilityforreal-worldapplications.
and system performance. As the threshold increases, the
close-set accuracy decreases, but the system’s effectiveness
inrejectingunknownsamplesimproves.Tostrikeabalance REFERENCES
betweentheseperformanceaspects,weselectedξ =2.
[1] Y.Gu,X.Zhang,Y.Wang,M.Wang,H.Yan,Y.Ji,Z.Liu,J.Li,and
ImpactofConstructionLoss.
M.Dong,“Wigrunt:Wifi-enabledgesturerecognitionusingdual-
Toanalyzetheinfluenceoftheconstructionloss,weper- attentionnetwork,”IEEETransactionsonHuman-MachineSystems,
formedexperimentswithλvaluesrangingfrom0to2while vol.52,no.4,pp.736–746,2022.
maintaining P = 0.29. The results, as illustrated in Figure [2] Y.Zhang,Y.Zheng,K.Qian,G.Zhang,Y.Liu,C.Wu,andZ.Yang,
“Widar3.0:Zero-effortcross-domaingesturerecognitionwithwi-
12,showthattheconstructionlosssignificantlycontributes
fi,” IEEE Transactions on Pattern Analysis and Machine Intelligence,
to WiOpen’s ability to acquire valuable knowledge. In our vol.44,no.11,pp.8671–8688,2021.
experiments,weoptedforλ=1. [3] C. Li, M. Liu, and Z. Cao, “Wihf: Gesture and user recognition
ImpactofDifferentAmountsofTrainingData. withwifi,”IEEETransactionsonMobileComputing,vol.21,no.2,
pp.757–768,2020.
To evaluate WiOpen’s capability to learn classification
[4] S. Liu, Z. Chen, M. Wu, C. Liu, and L. Chen, “Wisr: Wireless
knowledge with limited training samples, we conducted domaingeneralizationbasedonstylerandomization,”IEEETrans-
experiments by reducing the size of the training set to 20% actionsonMobileComputing,2023.
- 80% of the original training set. The results, depicted in [5] Y.Gu,H.Yan,M.Dong,M.Wang,X.Zhang,Z.Liu,andF.Ren,
“Wione: One-shot learning for environment-robust device-free
Figure 13, reveal that even with a reduced sample size,
userauthenticationviacommoditywi-fiinman–machinesystem,”
WiOpen continues to perform well in cross-location and IEEETransactionsonComputationalSocialSystems,vol.8,no.3,pp.
cross-direction domain recognition tasks. This underscores 630–642,2021.
[6] D.Wang,J.Yang,W.Cui,L.Xie,andS.Sun,“Caution:Arobust
WiOpen’saptitudeforacquiringclassificationknowledge.
wifi-based human authentication system via few-shot open-set
recognition,” IEEE Internet of Things Journal, vol. 9, no. 18, pp.
6 CONCLUSIONS 17323–17333,2022.
[7] S.Tan,J.Yang,andY.Chen,“Enablingfine-grainedfingergesture
In this paper, we have introduced WiOpen, a pioneering
recognition on commodity wifi devices,” IEEE Transactions on
Wi-Fi-based OSGR system. We commenced our study with MobileComputing,vol.21,no.8,pp.2789–2802,2020.
)%(ycaruccA
)%(ycaruccA
CORUA
CORUA
)%(
ycaruccAJOURNALOFLATEXCLASSFILES,VOL.14,NO.8,AUGUST2023 13
[8] S. Tan, L. Zhang, Z. Wang, and J. Yang, “Multitrack: Multi-user [27] W.J.Scheirer,A.deRezendeRocha,A.Sapkota,andT.E.Boult,
trackingandactivityrecognitionusingcommoditywifi,”inPro- “Towardopensetrecognition,”IEEEtransactionsonpatternanalysis
ceedingsofthe2019CHIConferenceonHumanFactorsinComputing andmachineintelligence,vol.35,no.7,pp.1757–1772,2012.
Systems,2019,pp.1–12. [28] D.-W.Zhou,H.-J.Ye,andD.-C.Zhan,“Learningplaceholdersfor
[9] H. Wang, D. Zhang, J. Ma, Y. Wang, Y. Wang, D. Wu, T. Gu, open-setrecognition,”inProceedingsoftheIEEE/CVFconferenceon
and B. Xie, “Human respiration detection with commodity wifi computervisionandpatternrecognition,2021,pp.4401–4410.
devices: Do user location and body orientation matter?” in Pro- [29] A. Bendale and T. E. Boult, “Towards open set deep networks,”
ceedings of the 2016 ACM international joint conference on pervasive inProceedingsoftheIEEEconferenceoncomputervisionandpattern
andubiquitouscomputing,2016,pp.25–36. recognition,2016,pp.1563–1572.
[10] K.Niu,F.Zhang,Z.Chang,andD.Zhang,“Afresneldiffraction [30] D.HendrycksandK.Gimpel,“Abaselinefordetectingmisclas-
modelbasedhumanrespirationdetectionsystemusingcotswi-fi sified and out-of-distribution examples in neural networks,” in
devices,”inProceedingsofthe2018ACMinternationaljointconfer- InternationalConferenceonLearningRepresentations,2016.
ence and 2018 international symposium on pervasive and ubiquitous [31] X.Sun,Z.Yang,C.Zhang,K.-V.Ling,andG.Peng,“Conditional
computingandwearablecomputers,2018,pp.416–419. gaussian distribution learning for open set recognition,” in Pro-
[11] Q.Pu,S.Gupta,S.Gollakota,andS.Patel,“Whole-homegesture ceedingsoftheIEEE/CVFConferenceonComputerVisionandPattern
recognitionusingwirelesssignals,”inProceedingsofthe19thannual Recognition,2020,pp.13480–13489.
internationalconferenceonMobilecomputing&networking,2013,pp. [32] H.-M. Yang, X.-Y. Zhang, F. Yin, Q. Yang, and C.-L. Liu, “Con-
27–38. volutional prototype network for open set recognition,” IEEE
[12] Y. Wang, J. Liu, Y. Chen, M. Gruteser, J. Yang, and H. Liu, Transactions on Pattern Analysis and Machine Intelligence, vol. 44,
“E-eyes:device-freelocation-orientedactivityidentificationusing no.5,pp.2358–2370,2020.
fine-grained wifi signatures,” in Proceedings of the 20th annual [33] G. Chen, L. Qiao, Y. Shi, P. Peng, J. Li, T. Huang, S. Pu, and
international conference on Mobile computing and networking, 2014, Y.Tian,“Learningopensetnetworkwithdiscriminativereciprocal
pp.617–628. points,”inComputerVision–ECCV2020:16thEuropeanConference,
[13] H.Abdelnasser, M.Youssef, andK.A. Harras,“Wigest: Aubiq- Glasgow,UK,August23–28,2020,Proceedings,PartIII16. Springer,
uitouswifi-basedgesturerecognitionsystem,”in2015IEEEcon- 2020,pp.507–522.
ferenceoncomputercommunications(INFOCOM). IEEE,2015,pp. [34] G. Chen, P. Peng, X. Wang, and Y. Tian, “Adversarial reciprocal
1472–1480. points learning for open set recognition,” IEEE Transactions on
[14] R. H. Venkatnarayan, G. Page, and M. Shahzad, “Multi-user PatternAnalysisandMachineIntelligence,vol.44,no.11,pp.8065–
gesture recognition using wifi,” in Proceedings of the 16th Annual 8081,2021.
InternationalConferenceonMobileSystems,Applications,andServices, [35] H.Huang,Y.Wang,Q.Hu,andM.-M.Cheng,“Class-specificse-
2018,pp.401–413. manticreconstructionforopensetrecognition,”IEEEtransactions
onpatternanalysisandmachineintelligence,vol.45,no.4,pp.4214–
[15] L. Sun, S. Sen, D. Koutsonikolas, and K.-H. Kim, “Widraw: En-
4228,2022.
ablinghands-freedrawingintheaironcommoditywifidevices,”
[36] C.Geng,S.-j.Huang,andS.Chen,“Recentadvancesinopenset
inProceedingsofthe21stAnnualInternationalConferenceonMobile
recognition: A survey,” IEEE transactions on pattern analysis and
ComputingandNetworking,2015,pp.77–89.
machineintelligence,vol.43,no.10,pp.3614–3631,2020.
[16] N.Yu,W.Wang,A.X.Liu,andL.Kong,“Qgesture:Quantifying
[37] J.Huang,B.Liu,C.Miao,Y.Lu,Q.Zheng,Y.Wu,J.Liu,L.Su,and
gesturedistanceanddirectionwithwifisignals,”Proceedingsofthe
C. W. Chen, “Phaseanti: An anti-interference wifi-based activity
ACM on Interactive, Mobile, Wearable and Ubiquitous Technologies,
recognitionsystemusinginterference-independentphasecompo-
vol.2,no.1,pp.1–23,2018.
nent,” IEEE Transactions on Mobile Computing, vol. 22, no. 5, pp.
[17] H.Li,W.Yang,J.Wang,Y.Xu,andL.Huang,“Wifinger:talkto
2938–2954,2023.
your smart devices with finger-grained gesture,” in Proceedings
[38] J. Liu, H. Xu, L. Wang, Y. Xu, C. Qian, J. Huang, and
of the 2016 ACM International Joint Conference on Pervasive and
H. Huang, “Adaptive asynchronous federated learning in
UbiquitousComputing,2016,pp.250–261.
resource-constrained edge computing,” IEEE Transactions on Mo-
[18] K. Ali, A. X. Liu, W. Wang, and M. Shahzad, “Keystroke recog-
bileComputing,vol.22,no.2,pp.674–690,2023.
nition using wifi signals,” in Proceedings of the 21st annual inter-
[39] H. Yan, Y. Zhang, Y. Wang, and K. Xu, “Wiact: A passive wifi-
national conference on mobile computing and networking, 2015, pp.
based human activity recognition system,” IEEE Sensors Journal,
90–102.
vol.20,no.1,pp.296–305,2019.
[19] L.Zhang,Y.Zhang,andX.Zheng,“Wisign:Ubiquitousamerican
[40] X.Zhang,Y.Gu,H.Yan,Y.Wang,M.Dong,K.Ota,F.Ren,andY.Ji,
signlanguagerecognitionusingcommercialwi-fidevices,”ACM
“Wital: A cots wifi devices based vital signs monitoring system
Transactions on Intelligent Systems and Technology (TIST), vol. 11,
using nlos sensing model,” IEEE Transactions on Human-Machine
no.3,pp.1–24,2020.
Systems,vol.53,no.3,pp.629–641,2023.
[20] Y. Zheng, Y. Zhang, K. Qian, G. Zhang, Y. Liu, C. Wu, and
[41] F.Zhang,K.Niu,J.Xiong,B.Jin,T.Gu,Y.Jiang,andD.Zhang,
Z.Yang,“Zero-effortcross-domaingesturerecognitionwithwi-fi,”
“Towardsadiffraction-basedsensingapproachonhumanactivity
inProceedingsofthe17thAnnualInternationalConferenceonMobile
recognition,”ProceedingsoftheACMonInteractive,Mobile,Wearable
Systems,Applications,andServices,2019,pp.313–325.
andUbiquitousTechnologies,vol.3,no.1,pp.1–25,2019.
[21] S.Liu,Z.Chen,M.Wu,H.Wang,B.Xing,andL.Chen,“General- [42] W. J. Scheirer, L. P. Jain, and T. E. Boult, “Probability models
izingwirelesscross-multiple-factorgesturerecognitiontounseen foropensetrecognition,”IEEEtransactionsonpatternanalysisand
domains,”IEEETransactionsonMobileComputing,2023. machineintelligence,vol.36,no.11,pp.2317–2324,2014.
[22] J. Su, Q. Mao, Z. Liao, Z. Sheng, C. Huang, and X. Zhang, “A [43] D. Wu, R. Gao, Y. Zeng, J. Liu, L. Wang, T. Gu, and D. Zhang,
real-timecross-domainwi-fi-basedgesturerecognitionsystemfor “Fingerdraw: Sub-wavelength level finger motion tracking with
digital twins,” IEEE Journal on Selected Areas in Communications, wifisignals,”ProceedingsoftheACMonInteractive,Mobile,Wearable
2023. andUbiquitousTechnologies,vol.4,no.1,pp.1–27,2020.
[23] Y. Gu, H. Yan, X. Zhang, Y. Wang, J. Huang, Y. Ji, and F. Ren, [44] Y.Zeng,D.Wu,J.Xiong,E.Yi,R.Gao,andD.Zhang,“Farsense:
“Attention-based gesture recognition using commodity wifi de- Pushingtherangelimitofwifi-basedrespirationsensingwithcsi
vices,”IEEESensorsJournal,vol.23,no.9,pp.9685–9696,2023. ratiooftwoantennas,”ProceedingsoftheACMonInteractive,Mobile,
[24] C.Feng,N.Wang,Y.Jiang,X.Zheng,K.Li,Z.Wang,andX.Chen, WearableandUbiquitousTechnologies,vol.3,no.3,pp.1–26,2019.
“Wi-learner: Towards one-shot learning for cross-domain wi-fi [45] Z. Wu, A. A. Efros, and S. X. Yu, “Improving generalization via
basedgesturerecognition,”ProceedingsoftheACMonInteractive, scalableneighborhoodcomponentanalysis,”inProceedingsofthe
Mobile,WearableandUbiquitousTechnologies,vol.6,no.3,pp.1–27, europeanconferenceoncomputervision(ECCV),2018,pp.685–701.
2022. [46] F.Wang,J.Feng,Y.Zhao,X.Zhang,S.Zhang,andJ.Han,“Jointac-
[25] A. Bendale and T. Boult, “Towards open world recognition,” in tivityrecognitionandindoorlocalizationwithwififingerprints,”
Proceedings of the IEEE conference on computer vision and pattern IEEEAccess,vol.7,pp.80058–80068,2019.
recognition,2015,pp.1893–1902. [47] D.Kim,Y.Yoo,S.Park,J.Kim,andJ.Lee,“Selfreg:Self-supervised
[26] P.R.MendesJu´nior,R.M.DeSouza,R.d.O.Werneck,B.V.Stein, contrastiveregularizationfordomaingeneralization,”inProceed-
D.V.Pazinato,W.R.deAlmeida,O.A.Penatti,R.d.S.Torres,and ings of the IEEE/CVF International Conference on Computer Vision,
A. Rocha, “Nearest neighbors distance ratio open-set classifier,” 2021,pp.9619–9628.
MachineLearning,vol.106,no.3,pp.359–386,2017.
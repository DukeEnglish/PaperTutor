Decentralized Blockchain-based Robust Multi-agent
Multi-armed Bandit
MengfanXu1 DiegoKlabjan1
1DepartmentofIndustrialEngineeringandManagementSciences,NorthwesternUniversity
MengfanXu2023@u.northwestern.edu, d-klabjan@northwestern.edu
Abstract
Westudyarobustmulti-agentmulti-armedbanditproblemwheremultipleclients
orparticipantsaredistributedonafullydecentralizedblockchain,withthepossi-
bilityofsomebeingmalicious.Therewardsofarmsarehomogeneousamongthe
clients, following time-invariant stochastic distributions that are revealed to the
participantsonlywhenthesystemissecureenough. Thesystem’sobjectiveisto
efficientlyensurethecumulativerewardsgainedbythehonestparticipants.Tothis
endandtothebestofourknowledge,wearethefirsttoincorporateadvancedtech-
niquesfromblockchains,aswellasnovelmechanisms,intothesystemtodesign
optimal strategies for honest participants. This allows various malicious behav-
iorsandthe maintenanceofparticipantprivacy. Morespecifically, we randomly
selectapoolofvalidatorswhohaveaccesstoallparticipants,designabrand-new
consensus mechanism based on digital signatures for these validators, invent a
UCB-based strategy that requires less information from participants through se-
curemulti-partycomputation,anddesignthechain-participantinteractionandan
incentive mechanism to encourage participants’ participation. Notably, we are
the first to prove the theoretical guarantee of the proposed algorithms by regret
analyses in the context of optimality in blockchains. Unlike existing work that
integrates blockchains with learning problems such as federated learning which
mainlyfocusesonnumericaloptimality,wedemonstratethattheregretofhonest
participants is upper bounded by logT. This is consistent with the multi-agent
multi-armedbanditproblemwithoutmaliciousparticipantsandthe robustmulti-
agentmulti-armedbanditproblemwithpurelyByzantineattacks.
1 Introduction
Multi-armedBandit(MAB)[Aueretal.,2002a,b]modelstheclassicalsequentialdecisionmaking
processthatdynamicallybalancesbetweenexplorationandexploitationinanonlinecontext.Specif-
ically,inthisparadigm,aplayerengagesinagame,fromwhichtheplayerselectspreciselyonearm
and observes the corresponding reward at each time step, and aims to maximize the cumulative
rewardthroughoutthe game. Thisis also equivalentto the so-called regretminimizationproblem
navigatingthetrade-offbetweenexploration(e.g.,exploringunknownarms)andexploitation(e.g.,
favoringthecurrentlyknownoptimalarm).Therecentemergingadvancementoffederatedlearning,
whereinmultipleclientsjointlytrainasharedmodel,hasspurredasurgeofinterestinthedomain
ofmulti-agentmulti-armedbandit(multi-agentMAB).Inthiscontext,multipleclientsconcurrently
interactwithmultipleMABs,withtheobjectivebeingtheoptimizationofthecumulativeaveraged
rewardacrossalltheclientsthroughcommunications. Significantly,inadditiontotheexploration-
exploitationtrade-off,theseclientsengageincommunicationconstrainedbytheunderlyinggraph
structure,whichnecessitatestheexplorationoftheinformationofotherclientsanddevelopingstrate-
giesaccordingly.
Numerous research has been working on the multi-agent MAB problem, including both central-
izedsettingsasin[BistritzandLeshem,2018,Zhuetal.,3–4,2021,Huangetal.,2021,Mitraetal.,
Preprint.
4202
beF
6
]GL.sc[
1v71440.2042:viXra2021,Rédaetal.,2022,Yanetal.,2022],anddecentralizedsettingsasin[Landgrenetal.,2016a,b,
2021,Zhuetal.,2020,Martínez-Rubioetal.,2019,Agarwaletal.,2022],whereitisassumedthat
rewarddistributionsareuniformamongclients,namelyhomogeneous.Recentattentionhasshifted
towards addressing decentralized, heterogeneousvariants, including [Taoetal., 1546–1574,2022,
Wangetal., 1531–1539,2021, JiangandCheng, 1–33,2023, Zhuetal., 2020, 2021, 3–4,2021,
ZhuandLiu,2023,XuandKlabjan,2023b],whicharemoregeneralandbringadditionalcomplexi-
ties. Inthesescenarios,thesharedassumptionisthatallclientsexhibithonesty,refrainingfromany
maliciousbehaviors,anddiligentlyadheretoboththesharedobjectiveandthedesignedstrategies.
However,real-worldscenariosoftendeviatefromthisideal, featuringinherentlymaliciousclients.
Examples include failed machines in parallel computing or the existence of hackers in the email
system. Consequently,recentresearch, such as [Vialetal., 2021], hasdelvedinto the multi-agent
MABprobleminthecontextofmaliciousclients,whichisformulatedasarobustmulti-agentMAB
problem. Thisline ofworkyieldsalgorithmsthatperformoptimally,providedthatthe numberof
maliciousclients remains reasonablylimited, effectivelycapturingmore generaland practicalset-
tings. More recently, the work of [Zhuetal., 2023] propose a byzantine-resilientframework and
showthatcollaborationinasettingwithmaliciousclientsupgradestheperformanceifateverytime
step, the neighborsetof eachclientcontainsatleast 2 ratio ofhonestclients anddowngradesthe
3
performanceotherwise.
Itisworthnotingthattherearethreemajorconcernsrelatedtotherobustmulti-agentMABframe-
work. Firstly,while[Vialetal.,2021]hasimprovedtheregretbounds,thereremainsthepossibility
ofmaliciousclientsattackingtheestimators. Inessence,thismeanswemightnotbeabletoassert
the correctnessof these estimators, eventhoughthe relative differencesbetweenthe armswith re-
specttothegroundtruthare bounded. Incertainscenarios,estimatorsplaya crucialrolein terms
ofinformation. Forinstance,inthecontextofsmarthome[Zhaoetal.,2020], drivenbytherapid
growth of the Internet of Things (IoT) and machine learning, manufacturers seek to understand
consumerbehaviorswithoutdirectlycollectingtheirdata. Insuchcases, theknowledgeaboutthe
groundtruthaccuratelyisessential,makingthecorrectnessofestimatorsacriticalconcern.Inother
words,therobustmulti-agentMABframeworkmaynotbedirectlyapplicablehere.Secondly,there
isthepossibilityofmaliciousclientsexhibitingvariousbehaviorsbeyondestimatorattacks. These
attack behaviors are not necessarily limited to broadcasting misleading estimators and may have
a impact on the system that honest clients operate in, which might break the agreement between
thesetwogroupsofclients(maliciousandhonest)andultimatelydisrupttheentiresystem. Thispo-
tentiallypreventsthehonestclientsfromobtaininganyrewardsandsignificantlydowngradestheir
performance,whichisafacetnotcoveredinexistingworkonrobustmulti-agentMAB[Vialetal.,
2021,Zhuetal.,2023].Forexample,maliciousclientscouldintentionallycausechannelcongestion
byselectingasinglechannel,disruptingtrafficandpotentiallydestabilizingthesystemthathonest
clients rely on. This has the potential to substantially affect the performance of honest clients in
a systematic manner, serving as a significant motivation for this paper. Thirdly, all these existing
literatureassumesthatclientsarewillingtosharealltheinformationoftheirinteractionswithban-
dits,includingthenumberofpullsofarmsandthecorrespondingrewardestimatorsbasedonthese
numberofpulls. This,however,exposestheclientstotheriskofbeinglessprivate,asitiseasyto
constructmorerewardinformation,suchascumulativereward,actionsequence,basedontheshared
information. Theseriskscanleadtosevereprivacyleakageandthusneedstobeaddressed,which
hasnotyetbeenexploredbytheexistingworkandtherebybeingoneofthemotivationsforthework
herein.
Blockchains are fully decentralized structures where multiple clients can communicate with one
anotherwithoutthe involvementof an authorizedparty. They have demonstratedexceptionalper-
formancein enhancingsystem security and accuracyacross a wide range of domains[Fengetal.,
2023]. This conceptwas initially introducedto facilitate peer-to-peer(P2P) networkingand cryp-
tography,asoutlinedintheseminalworkby[Nakamoto,2008]. Ablockchaincomprisesastorage
systemforrecordingtransactionsanddata,aconsensusmechanismtoensuresecuredecentralized
communicationandupdates,andaverificationstagetoassesstheeffectivenessofupdates,oftenre-
ferredtoasblockoperations[Niranjanamurthyetal.,2019]. Therefore,thisdecentralizedstructure
providespossibilities for addressing the aforementionedconcerns. First, the existence of verifica-
tionguaranteesthecorrectnessoftheinformationbeforeaddingtheblocktothemaintainedchain.
Specifically,itinvolvesscrutinizingtheupdatedblocksanddecidingwhethertoaddtheblockornot
based on the validity of the information. Secondly, the consensusmechanism ensuresthat honest
clientsarelikelytoreachaconsensusevenbeforetheyareawareofeachother’sidentities,leadingtoahigherleveloftrustandsafety.Thismitigatessystematicattacksandthusaddressesthesecond
concern. Meanwhile, enablingcryptographyandfulldecentralizationhasthepotentialto improve
theprivacylevel. However,littleattentionhasbeengiventounderstandinghowblockchainscanbe
incorporatedintothisonlinesequentialcooperativedecision-makingregime,creatingagapbetween
existinglearningtheoryandblockchains.Thisgapisasignificantdepartureofthispaper.
Therehasbeenalineofworkadaptingblockchainsintolearningparadigms,andblockchain-based
federatedlearninghasbeenparticularlysuccessfulasin[Lietal.,2022,Zhaoetal.,2020,Luetal.,
2019,Wangetal.,2022]. Inthiscontext,multipleclientsaredistributedonablockchain,andhon-
est clients aim to optimize the modelweights of a targetmodeldespite the presenceof malicious
clients. Notably,thescale ofthemodelhasledtotheintroductionofanewstoragesystemonthe
blockchain,the InterplanetaryFile System(IPFS),whichoperatesoff-chain,ensuringthestability
andefficiencyofblockoperationsonthechain.However,duetothefundamentallydifferentnatures
of decision making in MAB and federated learning, the existing literature does not apply to the
multi-agentMABsetting. Thisdisparityservesasthemotivationfordevelopinganovelframework
forsecureandtrustworthymulti-agentMABproblems. Moreover,thereislittlestudyonthetheo-
reticaleffectivenessofBlockchain-basedfederatedlearning,asmostoftheexistingliteraturefocus
on their deploymentperformances. Theoreticalvalidityis crucialto ensurecybersecuritybecause
deployingblockchains,eveninanexperimentalsetting,isriskyandhasbeenextremelychallenging.
Henceforth,itremainsunexploredhowtoeffectivelyincorporatetheconceptofblockchainsintothe
robustmulti-agentMABframework. Additionally,thereisa lack ofexplorationregardinghowto
analyzethetheoreticalpropertiesoftheseframeworks.Thishighlightsthepotentialtointroducenew
frameworksandmethodswithprovableoptimalityguaranteesinmulti-agentMABincybersecurity,
whichisoneofthemainfocusesthroughoutthepaper.
However,existingblockchainframeworkshavelimitationsthatmaynotbesuitableformulti-agent
MAB problems due to their online sequential decision-making nature. For instance, the consen-
susprotocoloftenassumesthe existenceofa leader,introducingauthorityrisks. Additionally,the
generalrule is to secure more than 2 of the votes, which can be impracticalin real-world scenar-
3
ios. Furthermore,theonlinedecision-makingproblemnecessitatesthedeploymentofstrategiesfor
real-timeinteractionwithanexogenousenvironment,afeaturenotpresentintraditionalblockchain
frameworks. Consequently,theadaptationspresentedinthispaperrequirecarefulmodificationsto
blockchainsandtheintroductionof newmechanisms. Moreover,little attentionhasbeengivento
understanding the theoretical properties of blockchains, creating a gap between existing learning
theoryand blockchains. This holdsas the currentliterature on blockchainsand related topicshas
not yet explored or addressed the theoretical guarantees, even though empirical examination and
validationhavebeenconductedacrossawiderangeofdomains.
Tothisend,inthispaper,weproposeanovelformulationofrobustMulti-agentMulti-armedBandit
(multi-agentMAB)withintheframeworkofBlockchains.Wearethefirsttostudytherobustmulti-
agentMABproblemwhereclientsaredistributedandoperateonBlockchains.Inthiscontext,clients
canonlyreceiverewardswhenablockisapprovedtoensuresecurityateachtimestep,whichdiffers
largelyfromtheexistingMABframework. Here,clientsareallowedtobemaliciousandcantake
various disruptive actions during the game. Blockchains keep track of everything and guarantee
functionalitythroughchainoperations. Thisintroducesadditionalcomplexities,asclientsnotonly
design strategies for selecting arms but also interact with both the blockchain and the exogenous
environment.Moreover,thepresenceofblockchainalsocomplicatesthetraditionalbanditfeedback,
asdisapprovedblocksintroducenewchallengesinthisonlineandpartialinformationsetting.
Additionally,wedevelopanalgorithmicframeworkforthenewformulationwithBlockchains,draw-
ing from existing literature while introducingnovel techniques given the limitations. This frame-
workincludesthedesignofavalidatorselectionmechanismthateliminatestheneedforanautho-
rized leader, a departure from existing literature. We also incorporate the arm selection strategy
into the framework to perform online sequential decision making. Furthermore, we modify the
consensusprotocolwithoutrelyingonmajorityvoting; instead, we use a digitalsignaturescheme
[Goldwasseretal.,1988]. Moreover,weintroducetheroleofasmartcontract[Huetal.,2020]and
surprisinglyenableinteractionwiththeenvironmentthroughthissmartcontract. Toincentivizethe
participationofmaliciousclientsinthegame,wearethefirsttodesignacostmechanisminspired
bytheareaofmechanismdesign[Murhekaretal.,2023]. Itisworthnotingthattheexistenceofthis
smart contractand cost mechanism also guaranteesthe correctnessof the informationtransmitted
onthechain.Ontopofthisbreakthroughintermsoftheframework,wealsoperformtheoreticalanalysesofthe
proposedalgorithms.Thisinvolvesanalyzingtheregret,whichaimsatfundamentallyunderstanding
theimpactandmechanismsofblockchainswithinthismulti-agentMABsettingwiththeexistence
ofmaliciousbehaviors.Precisely,weshowthatundermildassumptions,theregretofhonestclients
is upper bounded by O(logT), which is consistent with the existing algorithms for robust multi-
agentMABproblems[Zhuetal.,2023,Vialetal.,2021]. Thisistheveryfirsttheoreticalresulton
leveragingBlockchainsforonlinelearningproblems,tothebestknowledgeofus. Furthermore,this
regretboundcoincideswith theexistingregretlower boundsinmulti-agentMABwhenassuming
noclientsaremalicious[XuandKlabjan,2023a],implyingitsoptimality.
The paperis structuredas follows. We startby introducingthe notationsthatare used throughout
and presenting the problem formulation. Following that, we propose an algorithmic framework
for solvingthe proposedproblem. Subsequently,we providea detailedanalysis of the theoretical
guaranteeregardingtheregretassociatedwiththeproposedalgorithms.
2 Problem Formulation
Westartbyintroducingthenotationsusedthroughoutthepaper.ConsistentwiththetraditionalMAB
setting,weconsiderK arms,labeledas1,2,...,K. ThetimehorizonofthegameisdenotedasT,
anditimpliesthetimestep1 ≤ t ≤ T. AdditionallyasinthestandardMulti-agentMABsetting,
wedenotethenumberofclientsasM,andtheclientsarelabeledfrom1toM. Itisworthnoting
that we use the terminologies "client" and "participant" interchangeably for the rest of the paper.
Meanwhile,inournewlyproposedblockchainframework,wedenotethetotalnumberofblocksas
B = T andeachblockattime step t isdenotedasb . Letusdenotethe rewardofarmi atclient
t
minblockbattimesteptas{rm(b,t)} ,whichfollowsastochasticdistributionwithatime-
i i,m,b,t
invariantmeanvalue{µb} . Wedenotethesetofhonestparticipantsandmaliciousparticipantsas
i i,b
M andM ,respectively. Notethattheyaretime-invariant. Wedenotetheestimatorsmaintained
H A
atparticipantmasµ¯ (t),µ˜ (t),andthevalidatorsestimatorsasµ˜ (t).
m,i m,i i
Meanwhile,weintroducesometerminologiesrelevanttothispaper.
CostMechanism Weassumethatiftheestimatorsfromthemaliciousparticipantsareusedinthe
validatedestimators,i.e.
∂µ˜ (t)
i
6=0,
∂µ¯ (t)
m,i
thenthehonestparticipantsincuracostofc ,whichtheyarenotawareofuntiltheendofthegame.
t
ExistentialForgery Followingthedefinitionin [Goldwasseretal.,1988],maliciousparticipants
successfullyperformanexistentialforgeryifthereexistsapairconsistingofamessageandasigna-
ture,suchthatthesignatureisproducedbyanhonestparticipant.
Adaptive Chosen Message Attack Consistent with [Goldwasseretal., 1988], we consider the
mostgeneralformof messageattack, namelytheadaptivechosenmessageattack. Inthiscontext,
a malicious participant not only has access to the signatures of honest participants but also can
determinethemessagelistafterseeingthesesignatures.Thisgrantsthemaliciousparticipantahigh
degreeoffreedom,therebymakingtheattackmoresevere.
Universal Composability Framework For homomorphic encryption, we follow the standard
frameworkasin [Canetti,2001].Specifically,anexogenousenvironment,alsoknownasanenviron-
mentmachine,interactssequentiallywithaprotocol. Theprocessrunsasfollows: theenvironment
sendssomeinputstotheprotocolandreceivesoutputsfromtheprotocolthatmaycontainmalicious
components.Ifthereexistsanidealadversarysuchthattheenvironmentmachinecannotdistinguish
thedifferencebetweeninteractingwiththisprotocolortheidealadversary,theprotocolisdeemed
universallycomposablesecure.
Subsequently,wedefinetheregretasfollows.Formally,thegoalistomaximizethetotalcumulative
(expected)rewardofhonestparticipants,definedas
T T
rm,b(t), µb
at
m
at
m
m X∈MHXt=1 m X∈MHXt=1orequivalently,tominimizetheregret
T T T
R =max rm,b(t)− rm,b(t)+ c
T
i
i at
m
t
m X∈MHXt=1 m X∈MHXt=1 Xt=1
andpseudoregret
T T T
R¯ =max µb− µb + c .
T i at t
i m
m X∈MHXt=1 m X∈MHXt=1 Xt=1
We showtherationalityofthisregretdefinitionasfollows. Itholdstruethatthesetworegretmea-
suresare well-defined,consideringthatM isfixedanddoesnotchangewithtime. Furthermore,
H
these definitions align with those used in the context of Blockchain-based federated learning. In
theseframeworks,theobjectiveistooptimizethemodelmaintainedbyhonestparticipants,regard-
less of the intermediateperformanceand withoutinvolvingonlinedecision making. Additionally,
thisdefinitionisconsistentwiththeexistingmulti-agentMABproblem,exceptthatthecostmech-
anism is introduced given the existence of malicious participants. In the latter case, the regret is
averaged over all participants, which is equivalent to honest participants in both our context and
blockchain-basedfederatedlearning.
3 Methodologies
In this section, we presentthe proposedmethodologieswithin this new framework,as outlinedin
Algorithms 1, 2, and 3. Notably, we develop the first algorithmic framework at the interface of
Blockchainsincybersecurityandmulti-agentMAB,addressingthejointchallengesofsecurity,pri-
vacy, and optimality in online sequential decision making. We leverage the Blockchain structure
whileintroducingnewadvancementstotheexistingones,totheoreticallyguaranteethefunctional-
ityofthechainwithanewconsensusmechanismandcostmechanism.Tothebestofourknowledge,
this is the first workon Blockchainwith such robusttheoreticalguarantees. Additionally,it is de-
signedforonlinesequentialdecision-makingscenarios,distinguishingourworkfromexistinglitera-
tureonfederatedlearning.Moreover,comparedtoexistingworkonByzantine-resilientmulti-agent
MABwithmaliciousparticipants,ourmethodologyoperatesonablockchainwithanaddedlayerof
rewardapprovalandincorporatessecuremulti-partycomputationintothecommunicationprocess,
which largelyimprovesthe security andprivacyof honestparticipantswith minimalrisk of being
compromised. We also introducethe costmechanismto incentivizethe participationofmalicious
participants,drivenbyreal-worldapplications,consistentwithblockchain-basedfederatedlearning,
whilebeingcustomizedforthisonlinedecision-makingregime.
More specifically, the algorithmic framework consists of three algorithms. Algorithms 1 and 2
constitute the core of the methodology,including the sequentialstrategies executedby the honest
participants, black-boxoperationsby the maliciousparticipants,and the chainexecutions. On the
other hand, Algorithm 3 is a sub-algorithm integrated into the validation selection procedure of
Algorithm1toensuretheproperexecutionofthesamplingprocessbasedonthedesiredcriteria.
Themainalgorithmincludesseveralstages,asindicatedinthefollowingorder.
Validator selection At each time step, the entire system first selects a sub-pool of participants
allowed to act on the chain. Specifically, the system samples the set of validators based on the
trustcoefficientsofparticipants,whichareinitializedas1andupdatedsequentially.Wepresentthe
precisealgorithmasAlgorithm3.Thepurposeofthisstepistoguaranteesecurityandefficiency,as
thechainreliesonlyonaproportionofparticipantswhcihhaveaccesstothesystem’sinformation.
Armselection ThisstepiscommonintheMABframework,whereparticipantsdecidewhicharm
to pull sequentially. The strategies depend on whether participants are honest or malicious. For
honest participants, the strategy follows a UCB-like approach. More specifically, for each honest
participant m, it assigns a decision criterion to each arm i and selects the arm with the highest
criterion,whichcanbeformallywrittenas
at =argmaxµ˜ (t)+F(m,i,t)
m m,iwhere µ˜ (t) is the maintainedestimator atparticipantm. Here F(m,i,t) = C1logt with C
m,i nm,i(t) 1
beingspecifiedinTheorem1.Formaliciousparticipantj,however,itselectsarmsqbasedonarbitrary
strategies,whichisalsoknownasByzantine’sattackandwrittenas
at =ft(i)
j j
whereftisanymappingfromaspaceRK toascalarspaceR1.
j
Consensus Theconsensusprotocoliscentraltotheexecutionofthechainandguaranteeingthat
the chain is growing as expected. More specifically, we incorporate the digital signature scheme
[Goldwasseretal., 1988] into the protocolanduse the solutionto the ByzantineGeneralProblem
[Lamportetal.,2019]underanynumberofmaliciousvalidators.Toexpand,maliciousparticipants
broadcasttheirestimatorsµ¯ (t)tothevalidatorsusingpossiblyByzantine’sattackorabackdoor
m,i
attack. Onthecontrary,honestparticipantsbroadcasttheirestimatorsµ¯ (t)tothevalidators.
m,i
Foreachhonestvalidatorh,itdeterminestheset,A ,B asfollows.ThesetA is
t t t
m∈A ⇔k n (t)>n (t)⇔m∈M
t i m,i j,i H
that can be constructed through the secure multi-party computationprotocolas in [Asharovetal.,
2012]andthesetB is
t
{m:µ¯ (t)issmallerthanthetopf valuesandlargerthanthebelowf values}, if|A |>2f
B = m,i t
t tmodK, if|A |≤2f
t
(cid:26) (cid:27)
Alternatively,weusethenotationstop(C,−f)andtop(C,f)todenotevaluesbelowf andthetop
f valuesinsetC,respectively.
Onceagain,themaliciousparticipantschoosethesetsA andB inablack-boxmanner.
t t
Andthen,validatorsbroadcastB toothervalidatorsafterattachingtheirsignatures,repeatingthis
t
processat least M times, based on the algorithmin [Lamportetal., 2019]. The consensusis suc-
cessfulifatleastoneestimatorispresentinB . Otherwise,theconsensusstepfails,resultinginan
t
emptysetofestimators.
GlobalUpdate ThesetB issenttothesmartcontract,whichthencomputestheaverageofthe
t
estimatorswithinB , knownastheglobalupdate. Moreprecisely,foreacharmi, theestimatoris
t
computedas
µ¯ (t)
µ˜ (t)= m∈Bt m,i
i
|B |
P t
ifB isnotempty,and
t
µ˜ (t)=∞
i
otherwise.
Block Verification The smart contract validates the block and assigns b = 1 if the estimator
t
satisfiesthecondition
µ˜ (t)≤2
i
Itdisapprovestheblockotherwise,whichisdenotedasb =0.
t
BlockOperation Thesmartcontractsendstheoutputcontainingthevalidatedestimatorµ˜ (t),the
i
setB ,andtheindicatorb ofwhethertheblockisapprovedtotheenvironment. Subsequently,the
t t
environmentdeterminestherewardstobedistributedtotheparticipantsasfollows.
case1:iftheblockisapprovedwithb =1andB ⊂M ,i.e.
t t H
∂µ˜ (t)
i =0wherem6∈M
H
∂µ¯ (t)
m,i
thentheenvironmentdistributesrm (t)andµ˜ (t)toparticipantmforany1≤m≤M.
at i
mcase2:iftheblockisapprovedwithb =1andB ∩M <|B |,i.e.
t t H t
∂µ˜ (t)
i 6=0wherem6∈M
H
∂µ¯ (t)
m,i
thentheenvironmentdistributesrm (t)−c andµ˜ (t)toanyhonestparticipantm,andrm (t)+c
at t i at t
m m
toanymaliciousparticipant.
case 3: if the blockis disapprovedwith b = 0, the environmentdistributesnothingtothe partici-
t
pants.
Participants’ Update After receiving the information from the environment, the honest partici-
pantsupdatetheirmaintainedestimatorsasfollows. Fortherewardestimatorµ˜m,i(t),theyupdate
itwhentheyreceiveµ˜i(t),i.e.
µ˜ (t)=µ˜ (t),
m,i m,i
andotherwise,
µ˜ (t)=µ¯ (t).
m,i m,i
Forthenumberofarmpulls,theyupdateitas
n (t)=n (t−1)+1 ·1 .
m,i m,i bt=1 at m=i
Forthetrustcoefficients,everyparticipantneedstoupdatethembasedontheirrewards,whichcan
againbeachievedthroughthesecuremulti-partycomputationprotocol.Moreprecisely,letthetrust
coefficientw (t)beupdatedasfollows
m
w (t)=w (t−1)exp{ht }
m m m
whereh (t)=rm (b,t).
m at ,b
m
Next, we present the pseudo code of the aforementionedprocedures, as detailed in the following
Algorithm1,2and3.
4 Regret Analysis
Inthissection,wedemonstratethetheoreticalguaranteeofourproposedframework,byanalyzing
theregretdefinedoverthehonestparticipants.Theformalstatementreadsasfollows.
Theorem 1. Let us assume that the total number of honest participants is at least 2M. Let us
3
assumethatthereisatleastonehonestparticipantinthevalidatorset. Meanwhile,letusassume
thatthemaliciousparticipantsperformexistentialforgeryonthesignaturesofhonestparticipants
withanadaptivechosenmessageattack.Lastly,letusassumethattheparticipantsareinastandard
universalcomposabilityframeworkwhenconstructingA. Thenwehavethat
K 4C logT π2
E[R |A]≤(c+1)·L+ ∆ ([ 1 ]+ )+|M |Kl1−T
T k ∆2 3 H
m X∈MHk X=1 i
whereListhelengthoftheburn-inperiod,cisthecost,C meetstheconditionthat C1 ≥1,
1 2|MH|kiσ2
∆ isthesub-optimalitygap,listhelengthofthesignatureoftheparticipants,andk isthethreshold
i i
parameterusedintheconstructionofA . HerethesetAisdefinedasA = {∀1 ≤ t ≤ T,b = 1}
t t
whichsatisfiesthatP(A)≥ 1 .
lT−1
Proofsketch. ThefullproofisprovidedinAppendix;themainlogicisasfollows. Wedecompose
the regretinto three parts: 1) the length of the burn-in period, 2) the gap between the rewards of
the optimal arm and the received rewards, and 3) the cost induced by selecting the estimators of
themaliciousparticipants. Forthesecondpartoftheregret,webounditintwoaspects. First, we
analyzethetotalnumberoftimesrewardsare received,i.e., whenthe blockisapproved,whichis
of order1−l1−T. Then, we controlthe total numberoftimes sub-optimalarmsare pulledusing
ourdevelopedconcentrationinequalityforthevalidatedestimatorssentforverification.Concerning
the third part, we bound it by analyzing the construction of B , which depends on the presence
t
of malicious clients in A . By demonstrating that A contains only a small number of malicious
t t
participants in comparison to the total number of honest participants, we show that B does not
t
induceadditionalcost. Combiningtheanalysisofthesethreeparts, wederivetheupperboundon
regret.Algorithm1:BC-UCB
1 In Niti mali ,z ia (t 1io )n =:Fo nr mpa ,irt (i 1ci )p ;a cn ut ms1 u, la2 ti, v. e. r. ew,M ard, Var 1m ms =1,. 1. f. o, rK pa, rta it cit pim ane ts 1te ≤p0 m,in ≤blo Mck ;1 pa≤ ramb e≤ terB δ;w the eh na uv me bµ˜ em i ro,b f( h1 o) n, eµ sˆ˜ tb i p( a1 rt) i, cw ipaim nt( s1),
MH ≥ 32M;theexpectednumberofvalidatorsMV;Thedecisiononwhetherparticipantjishonestatvalidatormisinitializedas
Dm,j(0)=1;randomseedr;foranysetS0,majority(S0)referstothemajorityorthemedianofS0;
2 fort=1,2,...,Tdo
3 ParticipantscompetetobethevalidatorofblockbusingProof-of-Work:[Input:wm(t),MV;Output:SV(t)]// Validators
4 Participantm’sprobabilityofbeingavalidatorisproportionaltothetrustcoefficientwm(t),i.e.pm(t)= mwm w( mt)
(t)
;
5 foreachparticipantjdo P
6 SamplewhetheritbelongstothesetofvalidatorsSV(t)basedonpj(t)inadecentralizedmannerusingAlgorithm3
7 end
8 foreachparticipantm∈MHdo // [Input: MH,nm,i(t),Nm,i(t),K,F(m,i,t),SV(t); Output: at m] UCB
9 ifthereisnoarmisuchthatnm,i(t)≤Nm,i(t)−Kthen
10 at m=argmax iµ˜m,i(t)+F(m,i,t)
11 else
12 Randomlysampleanarmat m.
13 end
14 Pullarmat m;
15 Broadcastitsestimatorsµ˜m
i
,b(t)tovalidatorsSV(t)thataredeterminedintheValidatorsstepregardingtheselectarmat m;
16 end
17 foreachparticipantm6∈MHdo // [Input: MH,f,SV(t); Output: at m] Byzantine’s attack
18 BroadcastitsestimatorstovalidatorsSV(t)thataredeterminedintheValidatorstepusingpossiblyByzantine’sattack
regardinganarmat ,i.e.µ˜m,b(t)=f(m,b,t)wherefisanarbitrarymappingfromthespaceofRM×B×T toR;
m i
19 end
20 Validatorsusemajorityvotingtoachieveconsensusontheestimatorsµ˜m,b(t)asfollows: // Consensus;
i
21 foreachvalidatork∈SV(t)∩MHdo // [Input: {µ˜m
i
,b(t)}m≤M,SV(t),MH,δ; Output: Dk,j(t)]
22 foreachparticipantjdo
23 Dk,j(t)=1·1j∈Ak(t)
24 end
25 end
26 foreachvalidatork∈SV(t)andk6∈MHdo // [Input:{µ˜m
i
,b(t)}m≤M,SV(t),MH,δ,f¯;Output:Dk,j(t)]
27 foreachparticipantjdo
28 Dk,j(t)=f¯(µ˜j i,b(t),µ˜k i,b(t),δ)
29 end
30 end
31 foreachvalidatorkdo // [Input: SV(t),{Dk,j(t)}j≤M; Output: {Dk,j(t)}k∈SV(t),j≤M]
32 Broadcasttheestimators{Dk,j(t)}j≤MtovalidatorrsSV(t)\{j}
33 end
34 foreachvalidatork∈SV(t)andk6∈MHdo
35 foreachparticipantjdo // [Input: SV(t),{Dl,j(t)}l∈SV(t); Output: M˜ Hk,t]
36 Arbitrarilydeterminewhetherjismalicious,denotedasj6∈M˜k,torhonest,denotedasj∈M˜k,t
H H
37 end
38 BroadcasttheestimatorsBk(t)=M˜ Hk,ttovalidatorsSV(t)\{k}
39 end
40 foreachvalidatork∈SV(t)∩MHdo
41 foreachparticipantjdo // [Input: SV(t),{Dl,j(t)}l∈SV(t); Output: M˜ Hk,t]
42 ifj∈Ak(t)and|Ak(t)|>2fthen
43 participantjbelongstoBk(t)iftop({µ˜j,i(t)}j,−f)<µ˜j,i(t)<top({µ˜j,i(t)}j,f)
44 else
45 theestimatorfromparticipantjisignored
46 end
47 end
48 BroadcasttheestimatorsBk(t)=M˜ Hk,ttovalidatorsSV(t)\{k}
49 end
50 DenotetheestimatorM˜ Ht =∪kM˜ Hk,t;
51 foreachvalidatork∈SV(t)do
52 forround1≤h≤Mdo // [Input: SV(t),{M˜ Hl,t}l∈SV(t); Output: M˜ Ht]
53 generatethedigitalsignatureasin[Goldwasseretal.,1988];
54 executeAlgorithmSM(M)in[Lamportetal.,2019];
55 derivethesetM˜ Ht
56 end
57 end
58 ThevalidatorsobtainthecorrespondingsubsetofestimatorsS={µ˜j i,b}j iforj∈M˜ Ht;[Input:M˜ Ht,µ˜m
i
,b(t);Output:S]
59 Theverifiedestimators/armsareimmutableandusedforupdatingglobalestimatorsµˆ˜b i(t)bythefollowing:// Global update;
60 ifsetSisnotemptythen
61 foreacharmi,theglobalestimatorinblockbattimesteptistheaveragedlocalestimatorsinsetSwrittenas
62 µˆ˜b i(t)= |M˜1 Ht | Pm∈M˜ Ht µ˜m i ,b(t)
63 else
64 foreacharmi,theglobalestimatorisµˆ˜b i(t)=−∞
65 end
66 endAlgorithm2:BC-UCB
1 fort=1,2,...,Tdo
2 Asmart-contractvalidatesblockb: // [Input: µˆ˜b i(t); Output: approve or disapprove] Verification
3 Approvetheblockiftheglobalestimatorsµˆ˜b i(t)isnot−∞forarmi;
4 Disapprovetheblockotherwise;
5 iftheblockisapprovedthen // Block operation
6 Input:Vt,{µ˜m
i
,b(t),Nm,i(t),nm,i(t)}m≤M;Output:thecorrespondingestimatorsatt+1
7 foreachparticipantmdo
8 Appendthevalidatedblocktothechains;
9 Collecttherewardr am t m(b)(b,t)ofthepulledarminthatblockandaddittothecumulativerewardby
Vt+1=Vt+r am
t
m(b)(b,t);
10 Updateestimatorsµ˜m
i
,b(t),Nm,i(t),andnm,i(t)basedontherewards;
11 µ˜m i ,b(t+1)= µ˜m i ,b(t)·nm n, mi( ,t i) (+ t)r +am 1t m at m(b) (b(b )=,t i)·1at m(b)=i ;nm,i(t+1)=nm,i(t)+1 at m(b)=i;
12 Nm,i(t+1)=Nm,i(t)+1 {∃m,at m(b)=i}·1m∈SV(t)
13 end
14 else
15 Skipthecurrenttimestepbynotcollectingtherewardsandnotupdatingtheestimators;
16 end
17 foreachparticipantmdo// [Input: wm(t),δ,µ˜m,b(t),µˆ˜b i(t),b; Output: wm(t+1),b]Participants’ update
18 ThesmartcontractcomputesDistm(t)=Distance(µ˜m,b(t),µˆ˜b(t))≤δ;
19 Receiverewardwt=δ−Distm(t);
20 Updatewm(t+1)=wm(t)exp{wt}andb=b+1;
21 end
22 end
Algorithm3:Samplingusingsortitionbasedontrustcoefficients
1 Input:timestept;trustcoefficientswmj(t);VRF =(G,F)(verifiablerandomfunctions);thelengthofhashvalueisdenotedas
hashlen;Foranyintegerk<w,theprobabilitydensityfunctionofselectingksamplesoutofwfollowingbinomialdistribution
withsuccessfulprobabilityp,isdenotedasB(k,w,p);
2 fortimesteptdo
3 chooseapublic-privatekeypair(pkj,skj),bothofwhicharebinarystrings,byprobabilisticfunctionG(j);
4 thehashvaluehashandtheproofπ,whicharetwobinarystrings,aregivenby<hash,π>=F(r,skj);
5 pj = mM wV m(t);
6 z=0;P
7 while 2hh aa shsh
len
6∈[ z k=0B(k,wj(t),pj), z k+ =1 0B(k,wj(t),pj))do
8 z=z+1 P P
9 end
10 end
5 Conclusion
Thispaperaddressesthe robustmulti-agentmulti-armedbandit(MAB) problemwithinthe frame-
workofblockchains,representingthefirstworktoexploreonlinesequentialdecision-makingwith
clients distributed on a blockchain. Our approach focuses on ensuring security, privacy, and effi-
ciency from a system perspective in the context of multi-agent multi-armed bandit, distinct from
blockchain-based federated learning or byzantine-resilient multi-agent MAB. To tackle this chal-
lenge, we introducea novelalgorithmicframework. A subsetof participantsformsa validatorset
responsibleforachievingconsensusoninformationtransmittedbyallparticipants,ensuringprivacy.
Validatedinformationisthensenttoasmartcontractforverification,withrewardsdistributedonly
upon successful verification. As part of our contributions, we use trust coefficients to determine
validatorselectionprobabilities,whichdependontheparticipants’rewards. Additionally,weincor-
porateadigitalsignatureschemeintotheconsensusprocess,eliminatingthetraditional 1 assump-
3
tionoftheByzantinegeneralproblem. Furthermore,weintroduceacostmechanismtoincentivize
maliciousparticipantsbyrewardingtheircontributionstotheverificationstep. We provideacom-
prehensive regret analysis demonstrating the optimality of our proposed algorithm under specific
assumptions,markingabreakthroughinblockchain-relatedliterature,whichhasseenlittleanalysis.References
M.Agarwal,V. Aggarwal,andK.Azizzadenesheli. Multi-agentmulti-armedbanditswith limited
communication. TheJournalofMachineLearningResearch,23(1):9529–9552,2022.
G.Asharov,A.Jain,A.López-Alt,E.Tromer,V.Vaikuntanathan,andD.Wichs. Multipartycom-
putationwithlowcommunication,computationandinteractionviathresholdfhe. InAdvancesin
Cryptology–EUROCRYPT2012:31stAnnualInternationalConferenceontheTheoryandAppli-
cationsofCryptographicTechniques,Cambridge,UK,April15-19,2012.Proceedings31,pages
483–501.Springer,2012.
P. Auer, N. Cesa-Bianchi, and P. Fischer. Finite-time analysis of the multiarmed bandit problem.
MachineLearning,47(2-3):235–256,2002a.
P. Auer, N. Cesa-Bianchi, Y. Freund, and R. E. Schapire. The nonstochastic multiarmed bandit
problem. SIAMJournalonComputing,32(1):48–77,2002b.
I.BistritzandA.Leshem. Distributedmulti-playerbandits-agameofthronesapproach. Advances
inNeuralInformationProcessingSystems,31,2018.
R. Canetti. Universally composable security: A new paradigm for cryptographic protocols. In
Proceedings42ndIEEESymposiumonFoundationsofComputerScience,pages136–145.IEEE,
2001.
X.Feng,L.Li,T.Wang,W.Xu,J.Zhang,B.Wei,andC.Luo. Cobc: Ablockchain-basedcollabo-
rativeinferencesystemfortheinternetofthings. IEEEInternetofThingsJournal,2023.
S. Goldwasser, S. Micali, and R. L. Rivest. A digital signature scheme secure against adaptive
chosen-messageattacks. SIAMJournaloncomputing,17(2):281–308,1988.
B.Hu,Z.Zhang,J.Liu,Y.Liu,J.Yin,R.Lu,andX.Lin.Acomprehensivesurveyonsmartcontract
constructionandexecution:Paradigms,tools,andsystems.patterns,2(2),100179,2020.
R.Huang,W.Wu,J.Yang,andC.Shen. Federatedlinearcontextualbandits. AdvancesinNeural
InformationProcessingSystems,34:27057–27068,2021.
F.JiangandH.Cheng. Multi-agentbanditwithagent-dependentexpectedrewards. SwarmIntelli-
gence,1–33,2023.
L.Lamport,R.Shostak,andM.Pease. Thebyzantinegeneralsproblem.InConcurrency:theworks
ofleslielamport,pages203–226.2019.
P.Landgren,V.Srivastava,andN.E.Leonard. Ondistributedcooperativedecision-makinginmul-
tiarmedbandits. In2016EuropeanControlConference.243–248.IEEE,2016a.
P. Landgren, V. Srivastava, and N. E. Leonard. Distributed cooperativedecision-makingin multi-
armedbandits:FrequentistandBayesianalgorithms. In2016IEEE55thConferenceonDecision
andControl.167–172.IEEE,2016b.
P. Landgren, V. Srivastava, and N. E. Leonard. Distributed cooperativedecision making in multi-
agentmulti-armedbandits. Automatica,125:109445,2021.
D. Li, Z. Luo, and B. Cao. Blockchain-basedfederatedlearning methodologiesin smart environ-
ments. ClusterComputing,25(4):2585–2599,2022.
Y.Lu,X.Huang,Y.Dai,S.Maharjan,andY.Zhang. Blockchainandfederatedlearningforprivacy-
preserveddatasharinginindustrialiot.IEEETransactionsonIndustrialInformatics,16(6):4177–
4186,2019.
D. Martínez-Rubio, V. Kanade, and P. Rebeschini. Decentralized cooperative stochastic bandits.
AdvancesinNeuralInformationProcessingSystems,32,2019.
A.Mitra,H.Hassani,andG.Pappas. Exploitingheterogeneityinrobustfederatedbest-armidentifi-
cation. arXivpreprintarXiv:2109.05700,2021.A. Murhekar, Z. Yuan, B. R. Chaudhury, B. Li, and R. Mehta. Incentives in federated learning:
Equilibria,dynamics,andmechanismsforwelfaremaximization. InThirty-seventhConference
onNeuralInformationProcessingSystems,2023.
S.Nakamoto. Bitcoin:Apeer-to-peerelectroniccashsystem. Decentralizedbusinessreview,2008.
M.Niranjanamurthy,B.Nithya,andS.Jagannatha. Analysisofblockchaintechnology: pros,cons
andswot. ClusterComputing,22:14743–14757,2019.
C.Réda,S.Vakili,andE.Kaufmann. Near-optimalcollaborativelearninginbandits. In2022-36th
ConferenceonNeuralInformationProcessingSystem,2022.
Y.Tao,Y.Wu,P.Zhao,andD.Wang. Optimalratesof(locally)differentiallyprivateheavy-tailed
multi-armedbandits. InInternationalConferenceonArtificialIntelligenceandStatistics,1546–
1574,2022.
D.Vial,S.Shakkottai,andR.Srikant. Robustmulti-agentmulti-armedbandits. InProceedingsof
the Twenty-secondInternationalSymposiumon Theory, AlgorithmicFoundations,andProtocol
DesignforMobileNetworksandMobileComputing,pages161–170,2021.
J. Wang, H. Sun, and T. Xu. Blockchain-basedsecure and efficientfederatedlearningwith three-
phase consensusand unknowndevice selection. In InternationalConference on Wireless Algo-
rithms,Systems,andApplications,pages453–465.Springer,2022.
Z. Wang, C. Zhang, M. K. Singh, L. Riek, and K. Chaudhuri. Multitask bandit learning through
heterogeneousfeedbackaggregation. InInternationalConferenceon ArtificialIntelligenceand
Statistics,1531–1539,2021.
M. Xu and D. Klabjan. Regret lower bounds in multi-agent multi-armed bandit. arXiv preprint
arXiv:2308.08046,2023a.
M. Xu and D. Klabjan. Decentralized randomly distributed multi-agent multi-armed bandit with
heterogeneousrewards. 2023b.
Z.Yan,Q.Xiao,T.Chen,andA.Tajer.Federatedmulti-armedbanditviauncoordinatedexploration.
InIEEEInternationalConferenceonAcoustics,SpeechandSignalProcessing.5248–5252.IEEE,
2022.
Y. Zhao, J. Zhao, L. Jiang, R. Tan, D. Niyato, Z. Li, L. Lyu, and Y. Liu. Privacy-preserving
blockchain-basedfederatedlearningforiotdevices. IEEEInternetofThingsJournal,8(3):1817–
1829,2020.
J.ZhuandJ.Liu. Distributedmulti-armedbandits. IEEETransactionsonAutomaticControl,2023.
J. Zhu, R. Sandhu, and J. Liu. A distributed algorithm for sequential decision making in multi-
armed bandit with homogeneousrewards. In 59th IEEE Conference on Decision and Control.
3078–3083.IEEE,2020.
J.Zhu,E.Mulle,C.S.Smith,andJ.Liu. Decentralizedmulti-armedbanditcanoutperformclassic
upperconfidencebound. arXivpreprintarXiv:2111.10933,2021.
J.Zhu,A.Koppel,A.Velasquez,andJ.Liu. Byzantine-resilientdecentralizedmulti-armedbandits.
arXivpreprintarXiv:2310.07320,2023.
Z. Zhu, J. Zhu, J. Liu, andY. Liu. Federatedbandit: A gossipingapproach. InAbstractProceed-
ingsofthe2021ACMSIGMETRICS/InternationalConferenceonMeasurementandModelingof
ComputerSystems,3–4,2021.ProofofResults inSection 4
ProofofTheorem1
Proof. Forregret,wehavethefollowingdecomposition. Letusdenoteb astheindicatorfunction
t
ofwhethertheblockattimesteptisapproved.Likewise,foranytimestept,wedenotewhetherthe
estimatorsfromthemaliciousclientsareutilizedintheintegratedestimatorsash . Letthelengthof
t
theburn-inperiodbeL.
Notethat
T T
R =max µ − (µb −c )
T i at t
i m
m X∈MHXt=1 m X∈MHXt=1
T T T
=max µ − µb + c
i at t
i m
m X∈MHXt=1 m X∈MHXt=1 m X∈MHXt=1
T T T
=max µ − µ 1 + c
i
i at
m
bt=1 t
m X∈MHXt=1 m X∈MHXt=1 m X∈MHXt=1
T T T
=max µ − µ 1 + c1
i
i at
m
bt=1 ht=1
m X∈MHXt=1 m X∈MHXt=1 m X∈MHXt=1
Meanwhile,theregretcanbeboundedasfollows
T T
R ≤L+c·L+ (µ −µ 1 )+ c1
T i∗ at
m
bt=1 ht=1
.
t= XL+1m X∈MH m X∈MHt= XL+1
=(c+1)·L+T +T (1)
1 2
WestartwiththesecondtermT . Notethath =1isequivalentto{m:m∈B ∩m6∈M }=6 ∅.
2 t t H
BytakingtheexpectationoverT ,wederive
2
T
E[T |A]= cE[1 ]
2 ht=1
m X∈MHt= XL+1
T
= cE[1 ]
{m:m∈Bt∩m6∈MH}6=∅
m X∈MHt= XL+1
BasedonLemma2in[Zhuetal.,2023],weobtainthat
1 =1
{m:m∈Bt∩m6∈MH}6=∅ |At|<2f
whichimmediatelyimpliesthat
T
E[T |A]= cE[1 ]
2 ht=1
m X∈MHt= XL+1
T
= cE[1 ]
{m:m∈Bt∩m6∈MH}6=∅
m X∈MHt= XL+1
T
= cE[1 ].
|At|<2f
m X∈MHt= XL+1
In the meantime, we note that for any honest validators, the choice of A guarantees that honest
t
participantsareincludedaftertheburn-inperiod. Morespecifically,thesetofA satisfiesthatfor
t
anyvalidatorj ∈M ,
H
m∈A ⇔k n (t)>n (t)⇔m∈M
t i m,i j,i Hwhere1<k <2. Thisconditionholdsattheendofburn-inperiodwhichisstraightforwardsince
i
eachhonest.Aftertheburn-inperiod,thehonestparticipantshasthesamedecisionrule
at =argmax µ˜ (t)+F(m,i,t)
m i m,i
whereµ˜ (t) = µ˜b(t). Inotherwords,eachhonestclientusesthevalidatedestimatorµ˜b(t).Since
m,i i i
both n (t) and n (t) are larger than L, then we have that there exists k = nj,i(t)K, such as
m,i j,i K i L
k n (t)>n (t)foreverym∈M .
i m,i j,i H
Thisimpliesthat
A >|M |≥2f (2)
t H
bytheassumptionthatthenumberofhonestparticipantsisatleast 2M.
3
Thatistosay,
E[1 ]=1
|At|>2f
andsubsequently,wehave
T
E[T |A]= cE[1 ]
2 |At|<2f
m X∈MHt= XL+1
=0
We notethattheconstructionofA isdonewithoutknowingthenumberofpullsofarmsofother
t
clients. Thisisrealizedbyusingthehomomorphicresults,Theorem5.2asin[Asharovetal.,2012]
undertheuniversalcomposabilityframework.
Next,weproceedtoboundthefirsttermT . Notethat
1
T
E[T |A]≤ (µ −µ 1 )
1 i∗ at
m
bt=1
t= XL+1m X∈MH
T
=(T −L)·|M |·µ − E[µ |b =1]P(b =1)
H i∗ at t t
m
m X∈MHt X=L
Inthemeantime,weobtainthefollowing
E[µ |b =1]
at t
m
K
=E[ µ ·1 |b =1]
k at =k t
m
k=1
X
K
= E[µ 1 |b =1]
k at =k t
m
k=1
X
K
1
≥ µ · ·(E[1 ]−P(b =0)).
k P(b =1) at m=k t
t
k=1
X
Thisimmediatelygivesusthat
E[T |A]
1
T K
1
≤(T −L)|M |µ − ( µ · ·(E[1 ]−P(b =0)))P(b =1)
H i∗ k P(b
t
=1) at m=k t t
m X∈MHXt=L Xk=1
T K
=(T −L)|M |µ − ( µ (E[1 ]−P(b =0))
H i∗ k at =k t
m
m X∈MHXt=L Xk=1
T K T K
=(T −L)|M |µ − µ E[1 ]+ µ P(b =0). (3)
H i∗ k at =k k t
m
m X∈MHXt=L Xk=1 m X∈MHt X=Lk X=1Based on Theorem2 in [Lamportetal., 2019], the consensus is achieved, i.e. b = 1, as long as
t
the digital signatures of the honest participants can not be forged. Based on our assumption, we
have that the malicious participants can only perform existential forgery on the signatures of the
honest participantsand the attacks are adaptive chosen-messageattack. Then based on the result,
MainTheoremin [Goldwasseretal., 1988], theattack holdswithprobabilityatmost 1 forany
Q(l)
polynomialfunctionQandlargeenoughlwherelisthelengthofthesignature.
Moreprecisely,wehavethatwithprobabilityatleast1− 1 ,thesignatureofthehonestparticipants
lT
cannotbeforged,andthus,theconsensuscanbeachieved,i.e.
1
P(b =1)≥1− . (4)
t lT
Subsequently,wederivethat
T K T K
1
(3)≤(T −L)|M |µ − µ E[1 ]+ µ ( )
H i∗ k at m=k k lT
m X∈MHt X=Lk X=1 m X∈MHt X=Lk X=1
T K
≤ (µ − µ E[1 ])+|M |KlT−1
i∗ k at =k H
m
m X∈MHt X=L Xk=1
K
= ∆ E[n (t)]+|M |KlT−1
k m,k H
m X∈MHXk=1
.
=T +|M |KlT−1
21 H
Andforeachhonestparticipant,theyareusingtheestimatorsbasedonthevalidatedestimators,as
longastheblockisapproved.Considerthefollowingevent,A={∀1≤t≤ T,b = 1}. Basedon
t
(4)andtheBonferroni’sinequality,weobtainedthat
P(A)=P(∀1≤t≤T,b =1)
t
=1−P(∃1≤t≤T,b =0)
t
T
≤1− P(b =0)
t
t=1
X
1
≤ .
lT−1
On event A, the blockchain always gets approved, and then all the honest participants follow the
validatedestimatorsfromthevalidators.By(2)andLemma2in[Zhuetal.,2023],wehavethatthe
validatedestimatorµ˜ (t)canbeexpressedas
i
µ˜ (t)= w (t)µ¯ (t)
i j,i j,i
j∈A Xt∩MH
whichisalsoequivalenttoµ˜ (t). Heretheweightw (t)meetsthecondition
m,i j,i
w (t)=1,
j,i
j∈A Xt∩MH
whichimmediatelyimpliesthat
E[µ˜ (t)]=µ .
i iWenotethatthevarianceofµ˜ (t),var(µ˜ (t)),satisfiesthat,
i i
var(µ˜ (t))=var( w (t)µ¯ (t))
i j,i j,i
j∈A Xt∩MH
≤|A ∩M | w (t)2var(µ¯ (t)))
t H j,i j,i
j∈A Xt∩MH
1
≤|A ∩M | w2 (t)σ2
t H j,i n (t)
j,i
j∈A Xt∩MH
k
≤|A ∩M | w2 (t)σ2 i
t H j,i n (t)
m,i
j∈A Xt∩MH
k
=|M | i w2 (t)σ2
H n (t) j,i
m,i
j∈ XMH
k σ2
i
≤|M |
H
n (t)
m,i
where the inequality holds by the Cauchy-Schwarz inequality, the second inequality holds by the
definitionofsub-Gaussiandistributions,thethirdinequalityresultsfromtheconstructionofA ,and
t
thelastinequalityisasaresultof(a+b)2 ≥a2+b2.
Subsequently,wehavethat
C logt
P(µ˜m(t)− 1 >µ ,n (t−1)≥l)
i sn m,i(t) i m,i
( C1logt)2
≤exp{−
nm,i(t)
}
q2var(µ˜m)
i
( C1logt)2
≤exp{−
nm,i(t)
}
2|qM H| nk mi ,σ i(2
t)
C logt 1
=exp{− 1 }≤ (5)
2|M |k σ2 t2
H i
wherethefirstinequalityholdsbyChernoffbound,thesecondinequalityisderivedbypluggingin
the aboveupperboundon var(µ˜m(t)), andthe lastinequalityresultsfromthenchoiceof C that
i 1
satisfies C1 ≥1.
2|MH|kiσ2
Likewise,bysymmetry,wehave
C logt 1
P(µ˜m(t)+ 1 <µ ,n (t−1)≥l)≤ . (6)
i sn m,i(t) i m,i t2
Meanwhile,wehavethat
T
C logt
P(µ +2 1 >µ ,n (t−1)≥l)=0 (7)
i i∗ m,i
sn m,i(t−1)
t=L+1
X
ifthechoiceoflsatisfiesl≥[4C1 ∆lo 2gT]with∆
i
=µ
i∗
−µ i.
iBasedonthedecisionrule,wehavethefollowingholdforn (T)withl ≥[4C1logT],
m,i ∆2
i
T
n m,i(T)≤l+ 1 {am
t
=i,nm,i(t)>l}
t=L+1
X
T
≤l+ 1
t=L+1
{µ˜m
i
− rnmC1 ,il (o tg −t 1)>µi,nm,i(t−1)≥l}
X
T
+ 1
t= XL+1
{µ˜m i∗+ rnmC ,1 i∗lo (g t−t 1)<µ i∗,nm,i(t−1)≥l}
T
+ 1 .
t=L+1
{µi+2 rnmC1 ,il (o tg −t 1)>µ i∗,nm,i(t−1)≥l}
X
Bytakingtheexpectationovern (t),weobtain
m,i
T
C logt
E[n (t)]≤l+ P(µ˜m(t)− 1 >µ ,n (t−1)≥l)
m,i i sn m,i(t) i m,i
t=L+1
X
T
C logt
+ P(µ˜m(t)+ 1 <µ ,n (t−1)≥l)
i sn m,i(t) i m,i
t=L+1
X
T
C logt
+ P(µ +2 1 >µ ,n (t−1)≥l)
i i∗ m,i
sn m,i(t−1)
t=L+1
X
T T
1 1
≤l+ + +0
t2 t2
t=L+1 t=L+1
X X
π2 4C logT π2
≤l+ =[ 1 ]+ (8)
3 ∆2 3
i
wherethesecondinequalityholdsbyusing(5),(6),and(7).
ThenbythedefinitionofT ,wederive
21
K
E[T |A]= ∆ E[n (t)]
21 k m,k
m X∈MHXk=1
K 4C logT π2
1
≤ ∆ ([ ]+ )
k ∆2 3
m X∈MHXk=1 i
wheretheinequalityresultsfrom(8).
Consequently,weobtain
(3)≤E[T |A]+|M |KlT−1
21 H
K 4C logT π2
≤ ∆ ([ 1 ]+ )+|M |KlT−1. (9)
k ∆2 3 H
m X∈MHXk=1 i
Furthermore,wehave
(1)≤(c+1)·L+E[T |A]+E[T |A]
1 2
K 4C logT π2
≤(c+1)·L+ ∆ ([ 1 ]+ )+|M |KlT−1+0 (10)
k ∆2 3 H
m X∈MHk X=1 i
whichcompletestheproof.
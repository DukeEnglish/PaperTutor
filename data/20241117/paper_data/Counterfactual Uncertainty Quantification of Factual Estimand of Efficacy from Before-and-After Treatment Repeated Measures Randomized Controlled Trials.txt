Counterfactual Uncertainty Quantification
of Factual Estimand of Efficacy from
Before-and-After Treatment Repeated
Measures Randomized Controlled Trials
Xingya Wang
Department of Mathematics, The University of Manchester,
Yang Han*
Department of Mathematics, The University of Manchester,
Yushi Liu
Eli Lilly and Company,
Szu-Yu Tang
Pfizer Worldwide Research & Development,
and
Jason C. Hsu*
Department of Statistics, The Ohio State University.
Email: jch@stat.osu.edu; yang.han@manchester.ac.uk.
Abstract
The ideal estimand for comparing a new treatment Rx with a control C is the
counterfactual efficacy Rx : C, the expected differential outcome between Rx and C
if each patient were given both. While counterfactual point estimation from factual
Randomized Controlled Trials (RCTs) has been available, this article shows counter-
factual uncertainty quantification (CUQ), quantifying uncertainty for factual point
estimates butin acounterfactual setting, is surprisinglyachievable. We achieve CUQ
whose variability is typically smaller than factual UQ, by creating a new statistical
modeling principle called ETZ which is applicable to RCTs with Before-and-After
treatment Repeated Measures, common in many therapeutic areas.
We urge caution when estimate of the unobservable true condition of a patient
before treatment has measurement error, because that violation of standard regres-
sion assumption can cause attenuation in estimating treatment effects. Fortunately,
we prove that, for traditional medicine in general, and for targeted therapy with
efficacy defined as averaged over the population, counterfactual point estimation is
1
4202
voN
41
]LM.tats[
1v53690.1142:viXraunbiased. However, for targeted therapy, both Real Human and Digital Twins ap-
proaches should respect this limitation, lest predicted treatment effect in subgroups
will have bias.
Keywords: Variability decomposition; Randomized Controlled Trials, Decision-making pro-
cess, Confirmability.
21 Motivation and scope of application
When comparing a new treatment (which we denote by Rx) with a control (denoted by C),
the ideal estimand is the counterfactual efficacy, the expected differential outcome between
Rx and C if each patient were given both Rx and C. Following the seminal paper Rubin
(1978), causal treatment effect is defined as
“how the outcome of treatment compares to what would have happened to the
same subjects under alternative treatment”
by the 2019 International Council for Harmonization guideline ICHE9(R1) on Estimands.
From a patient’s point of view, indeed what matters is the personal treatment effect, the
differential in outcomes if they switch from a control therapy C to a new therapy Rx. We
denote this as Rx : C efficacy.
Most factual Randomized Controlled Trials (RCTs) are such that each patient is given
either Rx or C but not both. However, counterfactual point estimation of counterfactual
Rx : C efficacyfromfactualstudies isreadilyavailable, asrandomassignment oftreatments
to patients lets one prove that the point estimate of the differential Rx and C effects from
modeling a factual RCT is unbiased for the counterfactual Rx : C efficacy.
Current uncertainty quantification of this point estimate is based on the variability
of differential Rx and C effects between different patients, one treated with Rx and the
other with C, which intuitively is larger than the variability of differential effects if each
patient were treated with both Rx and C. With multiple components of variability, it is
challenging to isolate and remove the person-to-person variability. Previous thinking was
counterfactual uncertainty quantification requires studies with crossover designs and such
which are rarely feasible. This article shows, actually, counterfactual uncertainty quantifi-
cation (which reduces the variance from factual uncertainty quantification) is achievable
for a widely used kind of clinical trials that do not involve crossover designs.
Disease areas listed in Table 1 routinely conduct factual RCTs with each patient having
Before-and-After treatment Repeated Measures (without crossing over). We call such
studies factual BAtRM RCTs. We show, surprisingly, the uncertainty of Rx : C efficacy
point estimation from factual BAtRM RCTs can be quantified counterfactually. We do
3this by creating a new modeling principle, ETZ, to track individual patient outcomes in
BAtRM RCTs and quantify their variability components. Disease areas in which factual
BAtRM RCTs are routine affect half a billion patients worldwide, as shown in Table 1.
Therapeutic Area Number of Patients (in millions) Region
Crohn’s disease and ulcerative colitis 3 U.S.
Rheumatoid arthritis 54 U.S.
Schizophrenia 20 worldwide
Alzheimer’s disease 50 worldwide
Type 2 diabetes 400 worldwide
Table 1: Therapeutic areas with Before-and-After treatment Repeated Measures random
controlled trials benefiting from the ETZ modeling principle.
Efficacy is primarily assessed at what is called the milestone visit. One can assess
efficacybasedoneithertheoutcomemeasuredatthemilestonevisitorchange-from-baseline
defined as the difference between the outcomes at the milestone visit and at baseline. The
current practice in BAtRM RCTs uses change-from-baseline.
To gain insight, we propose a new statistical modeling principle called ETZ which
separates variability of patient outcomes at the milestone visit into three components:
variability in patients’ initial severity of the disease (Z), variability in trajectories (Traj)
of patients’ responses to treatments, and variability in the measurement errors (E). ETZ
is non-standard in that Z is not directly observable.
Our ETZ modeling principle in Section 3.5 shows using change-from-baseline instead of
the milestone visit outcome reduces the uncertainty in efficacy assessment so long as the
measurement error variability is notthe mainsource of variability at thebaseline visit (visit
1), a minimal requirement (for otherwise the outcome scale is of questionable usefulness).
So the ETZ modeling principle validates current practice.
Further, without changing the (unbiased) treatment efficacy point estimation in cur-
rent practice, our ETZ modeling principle allows what we call Counterfactual Uncertainty
4Quantification (CUQ) which calculates a (typically smaller) quantified variability of an ide-
alized counterfactual estimand instead of the factual estimand. We illustrate CUQ using
realistic examples of BAtRM RCTs.
A final insight from the ETZ modeling principle is as follows. Since Z is unobservable,
it needs to be estimated. While standard practice has been to estimate it using baseline,
more generally it can be estimated using values of a set of biomarkers (with baseline as a
special case). What we realized is that, with regression analysis assuming predictors are
measured withouterror, using predictorsmeasured witherrorcauses aso-calledattenuation
in estimating treatment effects. Fortunately, after careful analysis, we discovered that
counterfactual point estimation is always unbiased for traditional medicine. As long as
efficacy is defined as averaged over the population, counterfactual point estimation is also
unbiased for targeted therapies as shown in Section 4.5. However, all approaches (including
our real human self-controlling as well as the “digital twins” approach) should be aware of
the limitation that predicting treatment effect in subgroups may have bias, if one or more
of the biomarker values are measured with error, as shown in Section 4.4.
2 ETZ, a modeling principle
In practice, the differential effect between Rx and C is typically estimated from outcomes
observed with some patients given Rx and the others given C. Rubin (1978) showed that
Randomized Controlled Trials (RCTs) with strongly ignorable assignment of treatments to
patients allow for unbiased counterfactual point estimation of the average treatment effect
from observable outcomes.
2.1 Conceptualizing an ideal counterfactual efficacy
Let Trt be the random variable that assigns the ith patient to either Rx or C. For the
i
ith patient, let Y (Rx) and Y (C) represent potential outcomes if that patient is assigned to
i i
Rx or C respectively. Let X represent relevant covariates in general. The mean effect of a
treatment Trt is the expected potential (possibly counterfactual) outcome if all individuals
in the population had received the treatment Trt.
5What is called an “ignorable” random assignment of patients to Rx and C is one such
that, for each given X = x, the random assignment variable Trt is independent of the
i
potential outcomes Y (Rx) and Y (C).
i i
For the rth patient assigned to Rx, let YRx represent the observed outcome, and for the
r
sth patient assigned to C, let YC represent the observed outcome.
s
Only YRx and YC are observable, not Y (C) or Y (Rx). However, since Trt is inde-
r s r s i
pendent of potential outcomes under ignorable randomization, conditional on Trt being
i
either Trt = Rx or Trt = C, potential outcomes and observable outcomes have the same
i i
expectations:
[Y (Rx)|X = x ]
i i i
= { [Y (Trt )|Trt = Rx,X = x ]}
i i i i i
= [YRx|X = x ],
i i i
[Y (C)|X = x ]
i i i
= { [Y (Trt )|Trt = C,X = x ]}
i i i i i
= [YC|X = x ].
i i i
Assuming the distribution of X is the same for Rx and C, taking expectation over the
distribution of X, if efficacy τ is defined as the expected difference of potential outcomes,
then
τ = [Y(Rx)−Y(C)]
= [ (Y(Rx)−Y(C)|X = x)]
X
= [ (Y(Rx)|X = x)− (Y(C)|X = x)] (1)
X
= [ (YRx|X = x)− (YC|X = x)] (2)
X
= [ (YRx|X = x)]− [ (YC|X = x)] (3)
X X
= [YRx]− [YC] (4)
so this efficacy in the population space with infinitely many patients can be assessed based
on observable outcomes.
6
E
E
E
E
E
E
E
E
E
E
E
E
E
E
E
E
E
E
E
E
E
E
E2.2 Conceptualizing an ideal personal Z covariate
The ETZ modeling principle conceptualizes each patient as having their own random inter-
cept Z before any treatment is given. Trajectory, denoted by Traj, is the random response
from each patient to the treatment Trt given. Within each Trt, trajectory Traj is ran-
domly distributed around a profile of long run average trajectories (without a particular
shape specified). ETZ is a counterfactual modeling principle, with observable outcomes
given the factual treatment, and potential outcomes given the counterfactual treatment.
Compared to the usual baseline predictor, the Z component has two unique features:
it is without measurement error, and it is not observable. As visualized in Figure 1,
neither the intercept Z nor the trajectory curves are directly observable, because there are
measurement errors. Observed and potential outcomes are represented as dots and squares
respectively in Figure 1.
We call ETZ a counterfactual modeling principle because Z is not observable. Each
person has a scalar Z for their covariate X, on the Y outcome scale. The ETZ modeling
principle uses Z to model biological variability among patients, conceptualizing initial
intercept value Z as predictive of outcome.
The ETZ modeling principle reduces the quantified uncertainty of estimated counter-
factual efficacy at the population level by first using each patient as their own control (as
in current practice), then further reduces it by calculating counterfactually under the ETZ
modeling principle. We believe the resulting sample size reduction we achieve is at least as
competitive as any other approaches, perhaps more so.
The ETZ modeling principle cannot be applied directly since Z is unobservable. Model
fitting has to bedone factually, so (for proof-of-concept)we model thedata asMixed Model
Repeated Measures (MMRM) using baseline measurement as a surrogate to Z. We then
make a 1-to-1 transformation between the variability components in MMRM and ETZ. We
call this process Real Human Counterfactual Estimation (RHCE).
2.3 A factual Digital Twins model
Instead of conceptualizing patients as having different (unobservable) initial values Z, one
canalsoaccount forpatient variabilitybytheir havingdifferent observablebiomarker values
7(b ,...,b ) such as age, baseline measurement, severity of disease, sex, etc. An algorithm g
1 p
can be trained to predict an Rx patient’s digital twin’s C outcome and a C patient’s digital
twin’s Rx outcome based on (b ,...,b ). In what we call Digital Twin Counterfactual
1 p
Estimation (DTCE), after calculating the difference between each patient’s factual and its
digital twin’s counterfactual outcome, population Rx : C efficacy is estimated by averaging
them across the patients. DTCE can also potentially reduce uncertainty of estimated
efficacy.
Beware of covariates with measurement error It is important to be cognizant of co-
variatesmeasuredwitherror(e.g, baselineorothermeasuresofdiseaseseverity). Predicting
outcomes based on such covariates violates the standard regression modeling assumption
that predictors are measured without error.
Inference from models with measurement error in predictors, called errors-in-variables
models, will have attenuation bias. Therefore, in Section 4.5, we explain the care that both
RHCE and DTCE need to take to avoid this bias. To place both RHCE and DTCE in
the same framework, we take the algorithm g as being trained to create a digital patient
value B = g(b ,...,b ) similar to baseline, which is used as one predictor for patient’s Y
1 p
outcome, given either Rx or C.
2.4 ETZ notations
Index each of the m visits of a repeated measures study by v, v = 1,...,m. Denote by
YTrt[v] the outcome of a patient given treatment Trt (either Rx or C) measured at visit
v. Values of profiles for Rx and C at times of visits are the fixed effects in the MMRM
model (6). The ETZ modeling principle does not assume a functional form for the profiles,
neither does MMRM.
To be more specific, conceptualize YTrt[v] as having either two or three random compo-
nents. Atvisit 1(v = 1), beforeanytreatmentisgiven, YTrt[1] hastworandomcomponents,
a component Z which is that patient’s intercept (true baseline measurement), and a mea-
surement error component E which is the difference between the true and the observed
baseline. Thereafter, YTrt[v] has three random components, a Z which is that patient’s in-
8tercept (truebaseline measurement), plus arandomtrajectory Traj component (aroundits
mean profile µ) representing that patient’s response to the treatment given up to the time
of visit v (v > 1), and a measurement error component E which is the difference between
the measured outcome and that patient’s true trajectory at each visit v. These components
can be seen in Figure 1. It is assumed that measurement error E is independent of Z and
Traj, and i.i.d. over the visits, across all the patients.
2.5 Independence as a starting point
Our discussion of the ETZ modeling principle starts in the setting where the random
intercept Z and the random trajectory Traj are independent within each treatment arm
and goes toward where the direction of dependence between Z and Traj is known (with
consequence to be discussed in Section 3.4).
Independence means that, a patient’s true severity of illness before they receives either
Rx or C does not inform on whether that patient’s response trajectory is going to be above
or belowthe profileµ (long runaverage of thetrajectories). The concept ofIndependence is
disconnected with whether Z is prognostic of Change or not. The concept of baseline being
prognostic will be defined in Section 4.1. In addition, note that independence between
Z and Traj is within each treatment arm, unrelated to whether baseline and treatment
should have an interaction term in the model or not.
If patient level data is available, then one way to check independence is to see how base-
line measurement is predictive of change-from-baseline. We take an AbbVie Alzheimer’s
disease (AD) data as an example. Schnell et al. (2017) described an Alzheimer Disease
study from AbbVie which compared three doses of a new treatment (doses 1, 2, and 3) with
a negative control (dose 0, a placebo). There was an active control (dose 4) in the study
as well. Outcome measure was ADAS-cog11, and duration of this Phase 2 study was 24
weeks. For the AbbVie AD data, the R-square regressing change-from-baseline (negative
of the “improve” variable in the data set) on baseline (variable “severity” in the data set)
allowing different profiles for the placebo and the 4 doses was 0.17. So it appears severity
is not very predictive of trajectory.
Asubtle concern is, regression modeling assumes predictors aremeasured without error,
9Patient 1’s trajectory given C
Patient 1’s trajectory given Rx
Patient 2’s trajectory given Rx
Patient 1’s baseline outcome (before treatment assignment)
Patient 1’s observed outcomes given C
Patient 1’s potential outcomes given Rx
0.0 0.5 1.0 1.5 2.0 2.5 3.0
Time
Figure 1: Components of the ETZ modeling principle for a RCT with m = 4 visits at Time
= 0, 1, 2, and 3. Black triangle is the baseline of patient 1 before any treatment is taken.
Blue curve is the trajectory of patient 1 who is assigned to C, and the blue dots are the
observed Y. Red curve represents patient 1’s potential trajectory had they been assigned
to Rx, and the red squares are the potential Y (with last value missing). Grey curve is the
trajectory of patient 2 who is assigned to Rx. Measurement errors are differences between
the outcomes and their trajectories.
10
]v[y
0.1
8.0
6.0
4.0
2.0
0.0what if some of them have measurement error? Fortunately, as will be explained in Section
4.5, so long as efficacy is defined as “on average”, estimated Rx : C efficacy is unbiased.
However, that Section 4.4 also shows, in predicting efficacy in subgroups or at particular
biomarker values, ignoring measurement error in predictors will lead to bias.
2.6 Properties of a counterfactual model
If the outcome of ith patient given treatment Trt , Y (Trt ), is thought to only depend
i i i
on the treatment Trt and the covariate X , then the model is said to be deterministic
i i
counterfactual.
In real life, outcome measure on a patient is non-deterministic. Each potential mea-
surement on each patient, if replicated, would be somewhat different. Reason for such
variability includes the patient having a good day or a bad day (if they are asked to per-
form some tasks), rater variability, measurement error in analytic chemistry. If, in addition
to the treatment effect Trt and the covariate effect X , there is random measurement vari-
i i
ability affecting Y (Trt ), then the model is said to be non-deterministic counterfactual. In
i i
standard statistical notations, we write such a model as
Y (Trt ) = h(Trt ,X )+ǫ (5)
i i i i i
where h(Trt ,X ) represents treatment and covariate effects and ǫ represents measurement
i i i
variability with E(ǫ ) = 0, assuming ǫ is independent of (Trt ,X ). Since E(ǫ ) = 0, the
i i i i i
derivation leading to the conclusion (4) that τ = E(YRx)−E(YC) remains valid.
The counterfactual model represents an ideal situation, with the following properties.
Unbiased efficacy Witheachpatient receiving bothRxandC, theX valuesareperfectly
matched between the Rx and C outcomes. So E[Y(Rx) − Y(C)] is not biased by
patients having high X values systematically tending to receive Rx while patients
with low X values tending to receive C (say).
Reduced variability Intuitively, Y(Rx)−Y(C) with both Rx and C given to the same
patient has less variability than YRx −YC giving Rx to one patient and giving C to
a different patient.
11The ETZ modeling principle we propose in this article leads to model (5) that separates
measurement variability ǫ (the “E”) from patient-to-patient variability in h(Trt ,X ) and
i i i
crucially further separates the latter to before treatment (the “Z”) and after treatment (the
“T”) variability.
2.7 BAtRM for counterfactual inference
To achieve counterfactual inference by giving both Rx and C to each patient is unethical
for diseases that cause mortality (e.g., cancer) or irreversible mobility (e.g., arthritis).
Consider instead a factual RCT in which each patient first gets a baseline measurement
Y[1] before being randomized to receive either Rx or C, and then another measurement
Y[m] at the milestone time point when efficacy in the primary endpoint is assessed. We call
such RCTs Before-and-After treatment Repeated Measures (BAtRM) studies.
Therapeutic areas with such RCTs include type 2 diabetes mellitus (T2DM), neu-
rodegenerative diseases such as Alzheimer’s disease (AD), psychiatric diseases such as
schizophrenia, immunological diseases including rheumatoid arthritis, ulcerative colitis,
Crohn’s disease, and psoriasis, afflicting hundreds of millions of patients worldwide in total.
Counterfactual inference includes two aspects: counterfactual (point) estimation and
counterfactual uncertainty quantification. Surprisingly, counterfactual inference is possible
fromfactualbaselineandmilestoneRCTs, followinga3-stepprocess. Thefirststepachieves
counterfactual estimation by Gauss-Markov theorem using factual sample, while the rest
two steps explains the variance reduced by counterfactual uncertainty quantification from
factual case.
Balancing For a finite factual sample (which will not have perfectly balanced, let alone
perfectlymatched, X valuesbetween RxandC), Gauss-Markov covariateadjustment
ensures unbiased counterfactual point estimation by mapping the sample space with
imbalance to an ideal balanced population space, as we demonstrate in Section 4.4.
Baselining In RCTs with baseline and milestone measurements, variability incurred by
giving Rx to one set of patients and C to the other patients can largely be removed
by measuring outcome as change-from-baseline (Y[m] −Y[1]), as we show in Section
3.5.
12Self-controlling Merely providing an unbiased point estimate of efficacy with reduced
variability is insufficient for statistical inference, an accurate assessment of the vari-
ability of the estimate is needed as well. Section 3.4 shows how to transform the
following variabilities from a factual model
σB Standard deviation of baseline measurements
σMile Standard deviation of outcome at the milestone time point
σChange Standard deviation of change-from-baseline
to the three variabilities in the ETZ modeling principle, from which variability of our
counterfactual estimand can be calculated.
ETZ is a modeling principle applicable to any BAtRM data structure, not restricted
to any specific analysis method. How to estimate σB, σMile, and σChange from factual
data is not unique. For proof of concept, we show how they can be obtained from widely
used Mixed Model Repeated Measures (MMRM) analyses introduced in 3.1, and then
transformed 1-to-1 to variabilities in the ETZ modeling principle in Section 3.4.
3 Factual modeling and counterfactual uncertainty
quantification
The setting considered by MMRM is a longitudinal Randomized Controlled Trial in which
there are m planned visits (visit 1, ...,m) for all the patients. The times of these visits
afterrandomizationarethesameforallthepatients, andvisit misthemilestone timepoint
at which efficacy in the primary endpoint is assessed. Denote by
Y[v]
the measurement on
i
patient i during visit v.
3.1 Mixed Model Repeated Measures (MMRM)
The so-called Mixed Model Repeated Measures (MMRM) representation is
Y[v] = µ+α[v] +βTrt +(αβ)Trt[v] +bTrt +wTrt[v], (6)
i i i
v = 1,...,m.
13Fixed effects are represented by µ + α[v] + βTrt + (αβ)Trt[v], the mean response under
treatment Trt at time v, where α[v] is the visit (time) effect, βTrt is the treatment effect,
and (αβ)Trt[v] is the treatment×visit interaction. Random between-subject effect for the ith
patient assigned to treatment Trt is bTrt, while random within-subject effect is represented
i
by
wTrt[v]
.
i
In an MMRM analysis, corresponding to the REPEATED statement in Proc Mixed of
SAS, visit (time) is not considered a continuous variable but rather just a label, a CLASS
variable in SAS or a factor in R. No profile of the response over time is modeled, and
a Type = statement lets the user specify a structure for the m × m variance-covariance
matrix of measurements on the patients across the m visits. Given patient level data, Proc
Mixed provides an estimated variance-covariance matrix R m×m for it, from which
σB = qVar(Y[1] )
i
σMile = qVar(Y[m] ) (7)
i
σChange = qVar(Y[m] )+Var(Y[1] )−2Cov(Y[m],Y[1] )
i i i i
can all be estimated.
3.2 Comparison between MMRM and ETZ modeling
The ETZ modeling principle conceptualizes BAtRM clinical data biologically, with each of
E, Traj, and Z medically interpretable. ETZ separates the between subject effect bTrt in
i
the MMRM model (6) into two parts: a visit 1 before-treatment Z part, and a treatment-
dependent Traj part starting with visit 2. ETZ lets us articulate control of variability.
Specifically, while intercept variability Var(Z) can be reduced by narrowing the patient
entry criterion, trajectory variability Var(Traj) can be reduced by decreasing drug target
heterogeneity among patients. Variability in measurement error Var(E) can be reduced
by using better trained raters, for example.
Mixed Model Repeated Measures (MMRM) is not necessary forthe ETZ modeling prin-
ciple but only one of possible methods which provides ETZ modeling with the information
needed. We use MMRM for proof-of-concept as it is widely used in drug development
14currently. However, other methods such as fitting a random coefficient model (RCM) when
appropriate can be used alternatively.
3.3 Plausibility
Intuitively, variability at the first and milestone visits and of Change may contain all the
information we need to separate the E, Traj, and Z variability components. Baseline
measurements at the beginning of the study (visit 1) have the random intercept Z and
measurement error E components but no random trajectory component Traj since pa-
tients have not been treated yet. Change, or change-from-baseline, measurement at the
milestone visit minus measurement at the first visit, has the random trajectory Traj and
the measurement error E components (two copies of E in fact) but not the random in-
tercept component since that has been subtracted off. Measurements at the end of the
study (visit m) have all three random components. So it seems plausible that1 Var(Y[1] ),
i
Var(Y[m] ), and Var(Y[change] ) are sufficient for us to recover the the E, Traj, and Z vari-
i i
ability components.
3.4 Components of the ETZ decomposition
Our discussion starts without assuming variability of measurement error at visit m is the
same as variability of measurement error at visit 1, or that the random intercept Z is
independent of the random trajectory Traj. As the decomposition proceeds, these two
assumptions will be explicitly added as needed.
With such a conceptualization, outcomes of patient r given Rx and patient s given C
at visit 1 and visit m are represented as
YRx[1] = Z +E[1] (8)
r r r
YRx[m] = Z +TrajRx[m] +E[m] (9)
r r r r
YC[1] = Z +E[1]
s s s
YC[m] = Z +TrajC[m] +E[m].
s s s s
1
with the assumption variability of measurement errors is constant across the visits
15Implicitly, the fixed effects in this model are
(Z ) = α = (Z ) = α (10)
r Rx s C
(TrajRx[m]) = µRx[m] (11)
r r
(TrajC[m]) = µC[m] (12)
s s
with (Z ) = (Z ) because patients are randomly assigned to Rx and C.
r s
Assuming variabilities are the same under Rx and C, for patient r given treatment Trt
which can be Rx or C,
Var(YTrt[1]) = Var(Z )+Var(E[1]) (13)
r r r
Var(YTrt[m]) = Var(Z )+Var(E[m]) (14)
r r r
+2 Cov(Z ,TrajTrt[m])
r r
+Var(TrajTrt[m]),
r
where Z is the random intercept, E[1] is the random visit 1 measurement error, E[m] is the
r r r
random visit m measurement error and
TrajTrt[m]
is the random trajectory.
r
Note
Var(Z )+Cov(Z ,TrajTrt[m]) = Cov(YTrt[m],YTrt[1])
r r r r r
and, at this point, we have five unknown ETZ variability components:
Var(Z ),Cov(Z ,TrajTrt[m]),Var(TrajTrt[m]),Var(E[1]),
r r r r r
and Var(E[m]).
r
Change, or change-from-baseline, is measured by subtracting the baseline (visit 1) mea-
surement from the milestone (visit m) measurement, so it does not have a random intercept
component. Change of patient r given treatment i is then
YTrt[change] = TrajTrt[m] + E[m] −E[1]
r (cid:2) r (cid:3) (cid:2) r r (cid:3)
so
Var(YTrt[change]) = Var(E[1]) (15)
r r
+Var(TrajTrt[m])
r
+Var(E[m])
r
16
E E
E
E
E
Ewhich leads to
Var(Z )+Cov(Z ,TrajTrt[m])
r r r
Var(YTrt[m] )+Var(YTrt[1] )−Var(YTrt[change]
)
r r r
= (16)
2
= Cov(YTrt[m],YTrt[1]) (17)
r r
with the number of unknown ETZ variability components remaining five. Making the
assumption
Var(E[1]
) =
Var(E[m]
), reducing the number of unknowns to four, gives
r r
Var(TrajTrt[m])+2Cov(Z ,TrajTrt[m])
r r r
= Var(YTrt[m])−Var(YTrt[1]). (18)
r r
IfwefurthermaketheassumptionthatZ andTraj areindependent, sothatCov(Z
,TrajTrt[m]
) =
r r
0, reducing the number of unknown variability components to three, then we can estimate
Var(Z ) from (16), and estimate
Var(TrajTrt[m]
) from (18). In turn, we can estimate
r r
variance of measurement error as
Var(E[1]) = Var(YTrt[1])−Var(Z ) (19)
r r r
= Var(E[m]).
r
Note that, if Z and Traj are in fact positively correlated (say), then from (16), (18),
and (19), estimates of Var(Z ) and
Var(TrajTrt[m]
) would be somewhat higher than they
r r
ought to be, while the estimate for
Var(E[1]
) =
Var(E[m]
) would be somewhat lower than
r r
it ought to be.
3.5 Uncertainty reduced by counterfactual uncertainty quantifi-
cation
We now show exactly how counterfactual uncertainty quantification (CUQ), the goal of our
research, is achieved by the ETZ modeling principle, increasing the power of clinical trials,
decreasing the sample size needed.
17HbA1c Dulaglutide + Metformin + Pioglitazone Placebo Exenatide
n 279 141 276
SD(Baseline) 1.3 1.3 1.3
SD(Change) 0.98 0.97 1.02
Table 2: GBDA sub-study: Dulaglutide + Metformin + Pioglitazone vs. Placebo and
Exenatide with baseline HbA1c ∈ [7,11]
HbA1c Dulaglutide Metformin
n 269 268
SD(Baseline) 0.9 0.8
SD(Change) 1.00 0.98
Table 3: GBDC sub-study: Dulaglutide vs. Metformin with baseline HbA1c ∈ [6.5,9.5]
Narrowing patient entry criterion is ineffective There is the thinking that nar-
rowing the patient entry criterion makes patients more homogeneous and thereby makes
clinical trials more likely to succeed. This turns out to not be the case if treatment effects
are measured in terms of change-from-baseline, because (15) in the ETZ decomposition
shows SD(Change) does not involve patients’ baseline measurements Z.
Trulicity® (compoundnamedulaglutide)isaonce-weeklyinjectableprescriptionmedicine
to improve blood sugar (glucose) in adults with type 2 diabetes (mellitus), as measured
by control of haemoglobin A1c (HbA1c). Biologic License Application 125469 for Trulic-
ity/dulaglutide had five studies. Patient entry criteria, SD(Basline), and SD(Change) for
studiesGBDAandGBDC,reportedonpages6and7inFDA center for drug evaluation and research
(2014b) and on pages 58 and 61 of FDA center for drug evaluation and research (2014a),
are reproduced in Tables 2 and 3.
As can be seen, narrowing the HbA1c baseline entry criterion from [7, 11] in GBDA
to [6.5, 9.5] in GBDC decreases SD(baseline) of HbA1c from 1.3 to within [0.8, 0.9], but
hardly affects SD(Change), which remains steady within [0.97, 1.02] for both studies. So
18decreasing variability of intercept Z may not reduce CUQ.
Baselining very effectively reduces uncertainty ETZ pinpoints when baselining
effectively reduces uncertainty.
We show below that baselining effectively replaces the patient-to-patient variability
Var(Z) by the measurement error variability Var(E). Thus, so long as Var(Z) > Var(E),
baselining is beneficial.2
Whichever
treatmentpatientiisassignedto,expressionsforVar(Y[m] )andVar(Y[change]
)
i i
are
Var(Y[m]
) = Var(Z )+Var(Traj
)+Var(E[m]
) (20)
i i i i
Var(Y[1] ) = Var(Z )+Var(E[1] ) (21)
i i i
Var(Y[change]
) =
Var(Y[m] −Y[1]
)
i i i
= Var(Z +Traj +E[m] −Z −E[1] )
i i i i i
= Var(Traj +E[m] −E[1] )
i i i
= Var(Traj)+2×Var(E). (22)
with (22) showing the expression for the variance of change-from-baseline. So the difference
between
Var(Y[m]
) and
Var(Y[change]
) is
i i
Var(Y[m] )−Var(Y[change]
)
i i
= Var(Z)−Var(E) (23)
and
Var(Y[change]
) <
Var(Y[m]
) when Var(E) < Var(Z). Figure 2 in Section 3.6 shows
i i
that baselining can reduce total variability by 73% in an example data set.
Self-controlling CUQfurther reduces uncertainty Beyondbaselining, self-controlling
CUQ further reduces uncertainty by two copies of the measurement error variance, using
ETZ to quantify uncertainty counterfactually instead of factually.
Factual uncertainty quantification considers a randomly selected pair of patients with
patient r given Rx and patient s given C. With
YRx[change]
and
YC[change]
denoting their
r s
2 If measurement variability is larger than patient-to-patient variability, Var(E) > Var(Z), then it is
hopeless for that clinical trial to be informative and a different outcome measure should be chosen.
19change-from-baseline outcomes, factual efficacy Yf is estimated by
Yf = YRx[change] −YC[change].
r s
Self-controlling uncertainty quantification considers the difference between potential
change-from-baseline of the same patient i receiving both Rx and C. With Y[change] (Rx)
i
and Y[change] (C) denoting the potential change-from-baseline outcomes for patient i, truly
i
counterfactual efficacy Ycf is estimated by
Ycf = Y[change] (Rx)−Y[change] (C).
i i
ETZassumesVar(E)remainsconstantandVar(Traj) = Var(TrajRx) = Var(TrajC).
Moreover, E and Traj are independent because how patients respond to treatment is ir-
relevant to measurement error.
Hence, factual variability is
Var(Yf) = Var(YRx[change] −YC[change])
r s
= Var(TrajRx +E[1] +ERx[m]
r r r
−TrajC −E[1] −EC[m])
s s s
= 2×Var(Traj)+4×Var(E), (24)
where TrajRx and TrajC are independent because patients r and s are different patients.
r s
On the other hand, counterfactual variability is
Var(Ycf) = Var(YRx[change] −YC[change] )
i i
= Var(TrajRx +E[1] +ERx[m]
i i i
−TrajC −E[1] −EC[m] )
i i i
= Var(TrajRx +ERx[m] −TrajC −EC[m] )
i i i i
= 2×Var(Traj)+2×Var(E)
−2×Cov(TrajRx,TrajC). (25)
i i
Thus,
Var(Yf)−Var(Ycf)
= 2×Var(E)+2×Cov(TrajRx,TrajC). (26)
i i
20where Cov(TrajRx,TrajC) is non-negative because trajectories from the same patient i to
i i
Rx and C would be independent or positively correlated as explained below.
Biologically, if C is a placebo while Rx is a targeted therapy, then one can expect the
trajectories to be independent. If both Rx and C are targeted therapies but with entirely
different targets, forexample RxisGLP-1while C ismetforminintreating T2DMpatients,
then one would expect the trajectories to be independent.
Trajectories can expect to be positively correlated when Rx and C have similar mech-
anism of action or are upstream and downstream of the same cascade or pathway. For
example, Rx and C for treating schizophrenia may both be dopamine receptor antagonists.
For treatment of Alzheimer’s disease, C might target β-amyloid plaque (upstream) while
Rx targets tau-tangle (downstream).
So self-controlling removes at least two copies of the measurement error variance, and
our claim of CUQ reducing 2 × Var(E) may even be conservative. Figure 2 in Section
3.6 shows that self-controlling CUQ can reduce an additional 17% of uncertainty beyond
baselining in a real example.
3.6 Real data examples of CUQ
In this section, we show the proportion of variance reduced by counterfactual uncertainty
quantification using two real clinical datasets, the AbbVie dataset and the EXPEDITION3
dataset.
Schnell et al. (2017) described an Alzheimer Disease study from AbbVie which com-
pared three doses of a new treatment (doses 1, 2, and 3) with a negative control (dose 0, a
placebo). The AbbVie data set is described in Section 2.5.
Honig et al. (2018) reported on EXPEDITION3, a double-blind, placebo-controlled,
Phase 3 study testing solanezumab on patients with mild dementia due to Alzheimer’s dis-
ease. Among a total of 2129 patients enrolled, 1057 were assigned to receive solanezumab
while 1072 were assigned to the placebo. Score at the initial (Week 0) visit before ran-
domization was considered baseline. Thereafter outcomes were measured at weeks 12, 28,
40, 52, 64, and 80. Change-from-baseline is the difference between milestone outcome (at
Week 80) and baseline (at Week 0). In EXPEDITION 3, the primary endpoint was the 14-
21AbbVie
Variance Reduced Remaining
Baselining Counterfactual Estimation
16.79%
27.41%
72.59%
83.21%
EXPEDITION3
Variance Reduced Remaining
Baselining Counterfactual Estimation
11.67%
31.78%
68.22%
88.33%
Figure 2: Counterfactual uncertainty quantification can reduce the quantified uncertainty
in efficacy estimation. The pie charts on the left show the proportion of total variance
reduced by baselining while the pie charts on the right show the additional proportion
reduced by counterfactual (instead of factual) calculations. The top two pie charts analyze
data from the AbbVie study, while the bottom two pie charts analyze data from the EX-
PEDITION3 study. Overall, counterfactual uncertainty quantification reduces 77.19% and
39.74% of the variances in the AbbVie study and the EXPEDITION3 study, respectively.
item cognitive subscale of the Alzheimer’s Disease Assessment Scale (ADAS-cog14), while
the key secondary endpoint was instrumental Activities of Daily Living (iADL). EXPE-
DITION3 did not demonstrate efficacy in the primary endpoint ADAS-cog14 but showed
promising result in the secondary endpoint iADL. We use iADL for illustration.
4 A broader framework
A broader counterfactual estimation framework includes both Real Human Counterfactual
Estimation (RHCE) and Digital Twin Counterfactual Estimation (DTCE). Our method-
ology is RHCE, baselining and self-controlling in the ETZ modeling principle with each
human serving as their own control to reduce uncertainty quantification.
Another strategy for counterfactual estimation is to collect biomarker data on each
22!"#$%"&’()*+,-".#$+%/0-$.0&0&1"%)$23 45.)6")(+,-".#$+%/0-$.0&0&1"%)$23
70$)+#$,! 70$)+#$,! 70$)+#$,"
%+-+)8)#1,!"# %+-+)8)#1,!"# %+-+)8)#1,+#
$%&’(%))* $%&’(%))* $%&’(%))*
!9".$-"3+, !9,".$-"3+, !9,".$-"3+,
"/,70$)+#$,! "/,70$)+#$,! "/,70$)+#$,"
%+-+)8)#1,+ %+-+)8)#1,+ %+-+)8)#1,!"
4($)30$+,:;<!+//)-0-= 4($)30$+,:;<!+//)-0-=,>)$2)#,+0-2,0%3
0#*,-"3?)#+
Figure 3: Control-side and Equipoise counterfactual efficacy estimation.
!"#$%&’()*%#)+,&-%./)%."$
0&)+,1#/)$, 6.7.%)+,%8.$,
*"#$%&’()*%#)+, *"#$%&’()*%#)+,
&-%./)%."$ &-%./)%."$
203!45 269!45
!"$%’"+:-.;& 4<#.=".-& !"$%’"+:-.;& 4<#.=".-&
03!4 03!4 69!4 69!4
Figure 4: Counterfactual estimation includes Real Human Counterfactual Estimation
(RHCE) and Digital Twin Counterfactual Estimation (DTCE), either can be control-side
or equipoise.
patient, and train Digital Twin (DT) algorithms to predict each patient’s outcome from
their biomarker values. In Digital Twin Counterfactual Estimation (DTCE), population
Rx : C efficacy is estimated by averaging across the patients the difference of their Rx
outcome and C outcome.
To explain potential biases that both RHCE and DTCE need to avoid, we separate
Counterfactual estimation as either on the control-side or equipoise, as illustrated in Figure
3. Control-side counterfactual estimation, CF , takes only patients given Rx and
control
generates counterfactual C outcomes. Equipoise counterfactual estimation, CF , not
equipoise
only takes patients given Rx and generates counterfactual C outcomes but also generates
23counterfactual Rx outcomes for patients given C. While CF has been standard
equipoise
practice, CF is more recent thinking, in the DTCE setting.
control
In Section 4.2 that follows, we define traditional medicine versus modern targeted ther-
apies, and explain how they have different response profiles. First, Figure 5 gives a visual
preview that CF may not even be applicable to traditional medicine, while CF
control equipoise
however is unbiased for traditional medicine, but both CF and CF can be
control equipoise
biased for targeted therapies, as will be shown in Section 4.5.
4.1 Genesis of baseline covariate adjustment
The purpose of including baseline as a covariate in current MMRM analysis is to ad-
just for imbalance in the proportion of Rx and C treated patients in the data, to avoid
bias. It is appropriate for traditional medicine with a baseline which is prognostic of
outcome irrespective of the therapy received in the sense described on pages 19-22 of the
FDA-NIH Biomarker Working Group (2016) BEST document.
If the data contains substantial imbalance, then a real example in Hsu (1992) showed
the marginal analysis implemented in the Means statement of SAS Proc GLM which does
not adjust for the prognostic factor as a covariate can give very biased Rx : C efficacy
estimates.
Subsequently, starting with version 6.12 in 1996, SAS follows Chapter 7 of Hsu (1996)
to provide unbiased multiple comparisons in the LSmeans statement, adjusting for covari-
ate(s) presumed equally prognostic for Rx and C using Gauss-Markov least square means
estimation to map the sample to a “balanced” population.
This practice has served the analysis of traditional medicine well for decades. However,
targeted therapies are becoming quite common, and there is a possibility that for some of
them baseline may be predictive of outcome in the sense described on pages 35-40 of the
FDA/NIH (2016) BEST document, in which case one has to be more cautious.
4.2 From traditional medicine to targeted therapy
Traditional medicine Traditional medicine is “one-drug-fits-all”, prescribing the same
compound with no specific drug target to all patients for a particular indication. For
24example, labelofolanzapine(Zyprexa®),whichisindicatedforpatientswithschizophrenia,
states “The mechanism of action of olanzapine, as with other drugs having efficacy in
schizophrenia, is unknown” (FDA (2009)).
Targeted therapies Targeted therapies are personalized medicine, also called precision
medicine, targeting specific disease pathways.
A monoclonal antibody, an amino acid chain (with compound suffix mab) that binds to
a specific drug target is a targeted therapy. Immunotherapies for cancer such as nivolumab
(Opdivo®) and pembrolizumab (Keytruda®) are examples of targeted therapies.
A tyrosine kinase inhibitor, a small molecule with compound suffix tinib, each intending
to block a specific reaction within cells, is also a targeted therapy. Example of tinibs are
ibrutinib (for chronic lymphocytic leukemia CLL) and baricitinib (for rheumatoid arthritis
RA).
Different patients receiving the same targeted therapy may derive differential benefits,
because the extent to which the drug target presents itself in patients may differ by patient.
For both traditional medicine and targeted therapy, consider the simplest framework
in which there are only two visits, baseline and milestone, and the true profiles are linear
with random before treatment patient intercept Z independent of random milestone mea-
surement error. Referring to the patterns shown in Figure 5, we name the model used for
traditional medicine as parallel traditional medicine model and name the model used for
targeted therapy as non-parallel targeted therapy model.
A parallel traditional medicine model would be
YRx[m] = Zθ +ZηRx +ZβZ +ZεRx[m]
r r r
YC[m] = Zθ +ZηC +ZβZ +ZεC[m], (27)
s s s
where Zθ is the expected outcome at baseline visit before either treatment is given, ZηRx is
the fixed Rx treatment effect, ZηC is the fixed C treatment effect, Zβ is the same coefficient
for Z shared by treatment Rx and C,
ZεRx[m]
and
ZεC[m]
are the measurement error for Rx
r s
and C respectively, so patients sicker at the beginning remain relatively sicker at the end
irrespective of Rx or C.
25Traditional medicine Targeted therapy
5 5
4 4
3 3
Treatment
C
Rx
2 2
1 1
0 0
0 1 2 3 4 5 0 1 2 3 4 5
Biomarker Biomarker
Figure 5: Conceptual plots of response profiles for both traditional medicine and targeted
therapy. The left plot shows a traditional medicine has parallel profiles while the right plot
shows a targeted therapy may well have non-parallel profiles. The Red dashed line in the
topplotpreviews asituationwheretheapparent control-sidecounterfactual outcomeprofile
is not parallel to the teal solid line, even for traditional medicine, in which case control-side
counterfactual outcomes should not be produced, as will be explained in Section 4.4.
26
emoctuO emoctuOFor targeted therapy, a non-parallel targeted therapy model includes an additional
interaction between Z and treatment Rx : C
YRx[m] = Zα +ZγRx +ZβRxZ +ZǫRx[m]
r r r
YC[m] = Zα +ZγC +ZβCZ +ZǫC[m], (28)
s s s
where Zα is the expected outcome at baseline before either treatment is given, ZγRx and
ZγC arethefixed treatment effects forRxandC, ZβRx andZβC aredifferent coefficients for
Z depending onwhether the treatment isRx or C,
ZǫRx[m] andZǫC[m]
arethe corresponding
r s
measurement errors, with patients sicker at the beginning benefiting more from targeted
theory Rx than from non-targeted therapy C expressed as ZβRx being a steeper slope than
ZβC.
Let (B ,B ,...,B ) be a vector of p biomarkers and let B = g(B ,B ,...,B ) be a
1 2 p 1 2 p
biomarker score calculated to be on the same scale as the response (the primary endpoint),
with B potentially predictive of outcome.
Suppose in practice, for patients r and s, B = Z + BE[1] and B = Z + BE[1] with
r r r s s s
measurement errors are used instead of their (not observable) Z values for prediction and
ordinary regression is applied to the models (27) and (28).
Then the parallel traditional medicine model becomes
YRx[m] = Bθ +BηRx +BβB +BεRx[m]
r r r
YC[m] = Bθ +BηC +BβB +BεC[m] (29)
s s s
while the non-parallel targeted therapy model becomes
YRx[m] = Bα +BγRx +BβRxB +BǫRx[m]
r r r
YC[m] = Bα +BγC +BβCB +BǫC[m] (30)
s s s
as if B and B were measured without errors.
r s
4.3 Noisy predictor causes attenuation
Regression modeling assumes predictors are measured without error, so what if some of
(B ,B ,...,B ) have measurement error, and B in turn has measurement error? For
1 2 p
27example, where as age and gender are presumably measured without error, baseline will
have measurement error. Turns out if B has measurement error, then estimated Rx and C
effects will have so-called attenuation, and whether RHCE or DTCE is biased or unbiased
for Rx : C efficacy depends on how exactly that efficacy is defined, as will be shown in
Section 4.4 and Section 4.5. We explain attenuation in the context that a biomarker score
B for each patient is used in RHCE, with B being baseline.
Since parallel traditional medicine model is a special case of non-parallel targeted ther-
apy model in which ZβRx = ZβC, we use non-parallel targeted therapy model to illustrate
attenuation in general.
Model (28) which we take to be true have the predictor Z measured without error, so
Cov(YRx[m],Z
)
Cov(YC[m],Z
)
ZβRx = r r , ZβC = s s .
Var(Z ) Var(Z )
r s
We show intuitively how attenuation occurs.
Substituting Z = B −BE[1] and Z = B −BE[1] into (28), we obtain
r r r s s s
YRx[m] = Zα+ZγRx +ZβRx(B −BE[1])+ZǫRx[m]
r r r r
= Zα+ZγRx +ZβRxB +∗ ǫRx[m]
r r
YC[m] = Zα+ZγC +ZβC(B −BE[1])+ZǫC[m]
s s s s
= Zα+ZγC +ZβCB +∗ ǫC[m]
s s
where error
∗ǫRx[m]
=
ZǫRx[m]
−
ZβRx(BE[1]
) and
∗ǫC[m]
=
ZǫC[m]
−
ZβC(BE[1]
). The two
r r r s s s
errors ∗ǫRx and ∗ǫC are correlated to the covariate B and B because they share the same
r s r s
component
BE[1]
and
BE[1]
.
r s
Take treatment C as an example and similarly for Rx. This correlation between error
and the covariate causes attenuation, because with Z and BE[1] being independent,
s s
Cov(YRx[m],B ) = Cov(YRx[m],Z +BE[1])
s s s s s
= Cov(YRx[m],Z )
s s
Var(B ) = Var(Z +BE[1])
s s s
= Var(Z )+Var(BE[1])
s s
with an extraneous Var(BE[1] ) for Var(B ). Thus, comparing (30) with (28), we see
s s
BβC is attenuated towards zero as emphasized in the measurement error literature (e.g.,
28Carroll et al. (2006), p.43),
Var(Z )
BβC = [B βˆC] = s ZβC,
Var(Z )+Var(BE[1] )
s s
similarly for BβRx.
The attenuation can be quantified by the ETZ modeling principle in one special case
where B stands for baseline, the primary endpoint itself at first visit. In this case,
B = Z +E[1]
= Z +E, and
BβC = [B βˆC]
Var(Z)
= ZβC, (31)
Var(Z)+Var(E)
noting the extra Var(E).
We show below the presence of measurement error BE or E in using baseline or any
other biomarker B score as a surrogate for the true patient effect Z causes attenuation in
estimating the regression coefficient of B, which inturn can cause bias in estimating Rx : C
efficacy. While future ETZ research might mitigate this bias, for now we show estimated
counterfactual efficacy is unbiased so long as efficacy is defined as “on average”.
4.4 Possible bias caused by attenuation
Bias would occur if one predicts efficacy in subgroups of patients (e.g., Alzheimer’s disease
patients with mild or severe symptoms at baseline) when RHCE is modeled (without
stratification) for the entire population or DTCE is trained on the entire population.
These biases can be visualized. We use the outcome instrumental Abilities of Daily
Living (iADL) for Alzheimer’s disease to illustrate. Abilities to manage finances and to
prepare food are some of the items measured by iADL.
We simulate potential Rx and C outcomes at milestone visit for 500 patients in a
counterfactual setting from the ETZ modeling principle with first visit, baseline (before
29
E
Erandomization) measurements
Y[1] = Y[1] (Rx)
i i
= Y[1] (C)
i
= Z +E[1], i = 1,...,500
i i
and milestone visit measurements
Y[m] (Rx) = Z +TrajRx[m] +ERx[m], (32)
i i i i
Y[m]
(C) = Z
+TrajC[m] +EC[m],
(33)
i i i i
i = 1,...,500.
In ETZ modeling, the three components Z, Traj and E follow different Normal, indepen-
dent, distributions. Z is generated from a Normal distribution with mean α and variance
i
Var(Z). TrajRx[m] and TrajC[m] are generated from Normal distributions with means µRx
i i
and µC and common variance Var(Traj), independently. E[1] , ERx[m] and EC[m] are gen-
i i i
erated from Normal distributions with mean 0 and variance Var(E), independently. In the
counterfactual setting, outcomes Rx and C for patient i share the same Z .
i
Summary statistics from the EXPEDITION3 study and ETZ modeling principle in
Table 4 are used for data generation.
Using baseline or, more generally, a biomarker score B to predict outcome is tempting
because Z is not observable. However, as Figures 6 and 7 show, one should be aware that
predicting expected outcome at a B value off-center may incur bias if B has measurement
error.
4.5 Estimated average Rx : C efficacy is unbiased
Population effect of treatment Rx or C is defined as response Y averaged over infinitely
many patients each with their value Z. In the population space, what is of interest is the
value [Y] at [Z].
One intuitive way of seeing why estimated average effect is unbiased is to imagine
regressing Y on Z in (28) versus regressing Y on B in (30), with a rather large number of
patients. Attenuation, which occurs when B is a surrogate of Z but measured with error,
30
E E50
40
Status
B
Z
30
Treatment
C
Rx
20
10
30 40 50 60
Biomarker
Figure 6: Black arrows in the plot show attenuation bias in estimated C effect, due to
measurement error in biomarker score B as a surrogate of the true Z. Treatments are
indicated by color while shape differentiates B from Z. Red represents control C while
teal represents treatment Rx. Red round points are C versus B measurements, with the
red dashed line being the fitted C versus B regression line. Red triangle points are
C versus Z measurements, with the red solid line being the fitted C versus Z regression
line. Teal triangle points are Rx versus Z measurements, with the teal solid line being
the fitted Rx versus Z regression line.
31
tnemerusaeM44
42
Status
B
Z
40
38
36 40 44 48
OutcomeC
Figure 7: The direction of bias in Rx : C efficacy estimation depends on the target value of
outcome C. Efficacy is overestimated when target C value is below average, and underesti-
mated when target C value is above average. For the red points, the (horizontal) abscissa
(coordinate) is outcome C as predicted by B and the (vertical) ordinate (coordinate) is
outcome Rx as predicted by Z. The red line is the the fitted line of Rx as predicted by
true Z regressed on C as predicted by B. For the teal points, both the abscissa outcome
C and the ordinate outcome Rx are as predicted by true Z. The teal line is the fitted
line of Rx as predicted by true Z regressed on C as predicted by true Z. For easier visual
perception, the Rx and C outcome values plotted have been partially denoised using values
predicted by Z after we reduce the standard deviation of Z from the original 7.34 to 3.
32
xRemoctuOVariance SD
visit 1 (baseline) 64.58 8.04
visit 7 (milestone visit) 135.39 11.64
Change-from-baseline 92.37 9.61
Intercept Z 53.802 7.335
Trajectory 70.809 8.415
Measurement Error 10.778 3.283
Table4: Varianceandstandarddeviation(SD)ofiADLofvisit1, visit m, andchange-from-
baseline of the EXPEDITION3 study. Variances of Intercept, Trajectory and Measurement
Error are computed by ETZ transformation.
means the slope regressing Y on B in (30) tends to be closer to zero, compared to the true
slope regressing Y on Z in (28).
Afamiliarexperience insimple linear regression isthefitted regression linegoesthrough
the central point
(X¯,Y¯
) of average predictor and response values. Thus, imagining the
clinical study being repeated, one can visualize the pairs of regression lines from fitting
(28) and (30) pivoting/rotating around the same central point, as depicted in Figure 6.
Since [B] = [Z], even though the two regression lines have different slopes, their values
at [Z] (average value of Z) are the same.
To explain unbiasedness mathematically, we define efficacy more generally as measured
at [Z]±c where c is any non-negative constant. (Population efficacy as described earlier
would be at [Z] with c = 0.) We prove that:
• For traditional medicine, estimated equipoise Rx : C efficacy defined at [Z]±c is
unbiased for all c ≥ 0.
• For targeted therapy, control-side and equipoise Rx : C efficacy estimates are only
unbiased when c = 0, but can be biased when efficacy [Z]±c is defined off-centered
with c > 0.
33
E
E
E
E
E
E
ETraditional medicine has parallel profiles. First, we caution control-side Rx : C efficacy
estimation is biased and should not be done, for the following reason. For traditional
medicine, treatment Rx and treatment C share the same coefficient for baseline in both
model (27) and (29). For control-side estimation, counterfactual C outcomes are predicted
through model (29) with attenuated baseline coefficient Bβ = Var(Z) Zβ, while
Var(Z)+Var(BE)
factual Rx outcomes follow the true model (27) with coefficient of baseline, Zβ. Therefore,
as shown in Figure 5, control-side estimation makes the apparent profiles not parallel for
traditional medicine and should not be done.
Now we prove equipoise Rx : C efficacy estimation is unbiased for traditional medicine
mathematically, no matter what value c ≥ 0 efficacy [Z]±c is defined at. For equipoise
counterfactual estimation, efficacy is measured within each of Rx and C first and then
combined. Efficacy is measured as the difference between a factual measured outcome and
its corresponding counterfactual outcome within each treatment arm which, assuming the
numbers of patients in Rx and C are equal, is
1
[(Zθ +ZηRx +Zβ( [Z]±c))
2
−(Bθ +BηC +Bβ( [Z]±c))]
1
+ [(Bθ +BηRx +Bβ( [Z]±c))
2
−(Zθ +ZηC +Zβ( [Z]±c))]
= [YRx[m]]− [YC[m]].
r s
Hence, equipoise counterfactual estimation is unbiased for traditional medicine.
We discuss both control-side and equipoise counterfactual estimation for targeted ther-
apy. For control-side counterfactual estimation of targeted therapy, efficacy is measured as
the difference between the factual outcome of a patient receiving Rx and the corresponding
counterfactual C outcome:
(Zα +ZγRx +ZβRx( [Z]±c))−
(Bα +BγC +BβC( [Z]±c))
= ( [YRx[m]]− [YC[m]])±
r s
Var(Z)
c(ZβRx − ZβC)
Var(Z)+Var(BE)
so there is bias if c > 0.
34
E
E E
E
E
E
E
E
E
E
EEquipoise counterfactual estimation for efficacy in targeted therapy can be expressed
as:
1
[(Zα+ZγRx +ZβRx( [Z]±c))
2
−(Bα+BγC +BβC( [Z]±c))]
1
+ [(Bα+BγRx+BβRx( [Z]±c))
2
−(Zα+ZγC +ZβC( [Z]±c))]
= ( [YRx[m]]− [YC[m]])
r s
c Var(Z)
± (ZβRx − ZβC)
2 Var(Z)+Var(BE)
c Var(Z)
± ( ZβRx −ZβC)
2 Var(Z)+Var(BE)
so there is bias if c > 0.
5 Going forward
ETZ is a counterfactual uncertainty quantification (CUQ) principle. This article’s default
setting of Z being independent of Traj and the technique of extracting information from
MMRManalysisareproof-of-conceptinnature, verifiablyplausiblefortraditionalmedicine.
Since ETZ is a principle, going forward, it can be applied to other settings, employing
whatever technique suitable for information extraction.
For example, response to targeted therapies for amyotrophic lateral sclerosis (ALS),
typically measured on the ALS Functional Rating Scale–Revised (ALSFRS-R) scale (FDA
(2021)), can be modeled with a random coefficient BAtRM model, in which case one can
estimate the covariance between Z and Traj (e.g., using the RANDOM statement in Proc
Mixed of SAS). Deriving CUQ from (18) allowing Cov(Z,Traj) 6= 0 will be useful future
research.
Likewise, for both targeted therapy and traditional medicine, attenuation bias (31) in
efficacy estimation off-center when B has measurement error can potentially be mitigated
by estimating the attenuation using estimated Var(Z) and Var(E). Working out the
details will also be useful future research.
35
E E
E
E
E
E6 Key messages
• ETZisanuncertaintyquantification(UQ)principle forRandomizedControlled
Trials (RCTs) with Before-and-After treatment Repeated Measures (BAtRM).
•
Conducting RCT with BAtRM is standard practice in therapeutic areas affect-
ing more than half a billion patients worldwide.
• Modeling individual patient outcomes in BAtRM studies, ETZ enables coun-
terfactual uncertainty quantification (CUQ).
• CUQ is typically smaller than current factual uncertainty quantification.
•
Reduction in uncertainty quantification translates to reduction in sample size.
• Statistical ordigital counterfactual point estimation involving abiomarker with
measurement error is unbiased for efficacy in the entire population but biased
in subgroups.
7 Acknowledgement
The ETZ modeling thinking started with Haiyan Xu saying “Dr. Hsu, you only need three
numbers!”
36A Glossary of terminologies
Effect of a treatment: Expected outcome given treatment Rx or C.
Efficacy between treatments: Expected differential outcome between treatments Rx
and C.
Attenuation: Directional bias (within each treatment arm) in estimating slope of
the treatment effect when predictor contains measurement error.
Factual study: A study in which each patient is given either Rx or C (e.g., studies
with parallel designs).
Counterfactual study: A study in which each patient is given both Rx and C
(e.g., a crossover study).
Counterfactual efficacy: Expected differential between Rx and C outcomes of
patients in a counterfactual study.
Counterfactual estimation (CE): Unbiased point estimation of counterfactual
efficacy from a factual study.
Counterfactual uncertainty quantification (CUQ): Quantification of uncer-
tainty (such as variance) of a counterfactual point estimate calculated as if it were
from a counterfactual study.
Targeted therapies: Therapies such as tyrosine-kinase inhibitors and monoclonal
antibodies that target specific pathways, constituting a large portion of “personal-
ized” or “precision” medicine.
Real Human Counterfactual Estimation (RHCE): Counterfactual point esti-
mation (CE) with counterfactual uncertainty quantification (CUQ) using each real
human patient as self-control.
Digital Twins Counterfactual Estimation (DTCE): Counterfactual point es-
timation (CE) using biomarkers to predict for each Rx patient its digital C twin’s
outcome and vice versa, then averaging the outcome differentials.
37References
Carroll, R., D. Ruppert, L. Stefanski, and C. Crainiceanu (2006). Measurement Error in
Nonlinear Models: A Modern Perspective (Second ed.). Chapman and Hall/CRC.
FDA(2009). Zyprexa(olanzapine)label.https://www.accessdata.fda.gov/drugsatfda_docs/nda/2022/2
Accessed: 2024-06-17.
FDA (2021). Amx0035 (phenylbutyrate-taurursodiol) statistical review.
https://www.accessdata.fda.gov/drugsatfda_docs/nda/2022/216660Orig1s000Med_StatR.pdf.
Accessed: 2024-06-14.
FDA center for drug evaluation and research (2014a). Trulicity (dulaglutide) statistical re-
view. https://www.accessdata.fda.gov/drugsatfda_docs/nda/2014/125469Orig1s000StatR.pdf.
Accessed: 2024-06-14.
FDA center for drug evaluation and research (2014b). Trulicity (dulaglutide) summary re-
view. https://www.accessdata.fda.gov/drugsatfda_docs/nda/2014/125469Orig1s000SumR.pdf.
Accessed: 2024-06-14.
FDA-NIHBiomarker Working Group(2016). Best (biomarkers, endpoints, and other tools)
resource. https://www.ncbi.nlm.nih.gov/books/NBK326791/toc/. Accessed: 2024-
06-14.
Honig, L. S., B. Vellas, M. Woodward, M. Boada, R. Bullock, M. Borrie, K. Hager, N. An-
dreasen, E.Scarpini, H.Liu-Seifert, M.Case, R.A.Dean,A.Hake, K.Sundell, V.P.Hoff-
mann, C. Carlson, R. Khanna, M. Mintun, R. DeMattos, K. J. Selzler, , and E. Siemers.
(2018). Trial of solanezumab for mild dementia due to alzheimer’s disease. The new
england journal of medicine.
Hsu, J. C. (1992). The factor analytic approach to simultaneous inference in the general
linear model. Journal of Computational and Graphical Statistics 1, 151–168.
Hsu, J. C. (1996). Multiple Comparisons: Theory and Methods. London: Chapman & Hall.
38International Council for Harmonisation (2019, November). Ich e9
(r1) addendum on estimands and sensitivity analysis in clinical tri-
als to the guideline on statistical principles for clinical trials.
https:/database.ich.org/sites/default/files/E9-R1_Step4_Guideline_2019_1203.pdf.
Accessed: 2024-05-06.
Rubin, D. B. (1978). Bayesian inference for causal effects: The role of randomization. The
Annals of statistics, 34–58.
Schnell, P., Q. Tang, P. Mu¨ller, and B. P. Carlin (2017). Subgroup inference for multiple
treatments and multiple endpoints in an alzheimer’s disease treatment trial. The Annal
of Applied Statistics.
39This figure "App.jpg" is available in "jpg"(cid:10) format from:
http://arxiv.org/ps/2411.09635v1
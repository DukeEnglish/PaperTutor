Private Agent-Based Modeling
AyushChopra ArnauQuera-Bofarull NurullahGiray-Kuru
MassachusettsInstituteofTechnology UniversityofOxford MassachusettsInstituteofTechnology
Cambridge,USA Oxford,UK Cambridge,USA
ayushc@mit.edu arnau.quera-bofarull@cs.ox.ac.uk ngkuru@mit.edu
MichaelWooldridge RameshRaskar
UniversityofOxford MassachusettsInstituteofTechnology
Oxford,UK Cambridge,USA
michael.wooldridge@cs.ox.ac.uk raskar@media.mit.edu
ABSTRACT ishinderedby(1)theneedformicrodatatogeneratetheunderly-
Thepracticalutilityofagent-basedmodelsindecision-makingrelies ingagentpopulationand(2)theoftensubstantialcomputational
ontheircapacitytoaccuratelyreplicatepopulationswhileseam- resourcesrequiredtorun,calibrate,andanalyzeanABM.Recently,
lesslyintegratingreal-worlddatastreams.Yet,theincorporation therehasbeensignificantprogresstowardsdevelopingnewdesign
ofsuchdataposessignificantchallengesduetoprivacyconcerns. patternsforABMs,whichexploittensorization[17,18]anddifferen-
Toaddressthisissue,weintroduceaparadigmforprivateagent- tiability[4,19]ofsimulators.Thishasalleviatedthecomputational
basedmodelingwhereinthesimulation,calibration,andanalysis burdensassociatedwithABMsimulation[18],calibration[19,52],
ofagent-basedmodelscanbeachievedwithoutcentralizingthe andanalysis[51]bygrantingaccesstotechniquessuchasGPU
agents’attributesorinteractions.Thekeyinsightistoleverage computinganddifferentiableprogramming,allowingABMstoscale
techniquesfromsecuremulti-partycomputationtodesignproto- tomillion-sizepopulations[11,53].
colsfordecentralizedcomputationinagent-basedmodels.This Unfortunately,improvementsinthecomputationalefficiency
ensurestheconfidentialityofthesimulatedagentswithoutcom- ofABMsisoflittlevalueifthequalityoftheunderlyingpopula-
promisingonsimulationaccuracy.Weshowcaseourprotocolson tionmicrodataispoor.Currently,prevalentapproachesinvolve
acasestudywithanepidemiologicalsimulationcomprisingover theconstructionofsyntheticpopulationsdesignedtoalignwitha
150,000agents.Webelievethisisacriticalsteptowardsdeploying predefinedsetofsummarystatisticsderivedfromreal-worldob-
agent-basedmodelstoreal-worldapplications. servations.Forinstance,inepidemiologicalABMs,thepopulation
is crafted to replicate summary statistics obtained from census
KEYWORDS data[7,13,16,46,47].However,itisessentialtorecognizethat
thelimitedgranularityofcensusdataarisesprimarilyfrompri-
DifferentiableAgent-basedModeling;Privacy;Multi-partyCompu-
vacyconsiderationsratherthantheactualscarcityofavailabledata.
tation;AutomaticDifferentiation;Epidemiology
AsABMscontinuetoscaletowardsone-to-onerepresentationsof
ACMReferenceFormat: real-worldsystems,thereremainsafundamentallimitationintheir
AyushChopra,ArnauQuera-Bofarull,NurullahGiray-Kuru,MichaelWooldridge, modelingpotentialaslongasprivacyguaranteesarenotinplace.
andRameshRaskar.2024.PrivateAgent-BasedModeling.InProc.ofthe PreviousattemptstoaugmentABMdatawithadditionalinforma-
23rdInternationalConferenceonAutonomousAgentsandMultiagentSys- tion,suchasmobilityorhealthdata,haveresultedindataleaksthat
tems(AAMAS2024),Auckland,NewZealand,May6–10,2024,IFAAMAS, exposedagents’personalinformation[1,22,36].Theseincidents
10pages.
underscoretheneedforadecentralizedapproachtoABM,where
eachagent’ssensitiveinformationiskeptconfidentialthroughout
1 INTRODUCTION
themodelingprocess.
Agent-basedmodeling(ABM)isabottom-upsimulationtechnique Motivatedbythis,weintroduceanewparadigmforagent-based
whereinasystemismodeledthroughtheinteractionofautonomous simulationthatensurestheconfidentialityofeachagent’ssensitive
decision-makingentitiesreferredtoasagents,whichmayrepresent information.Leveragingtechniquesdrawnfromsecuremulti-party
individuals,companies,orotherdecision-makingentities.Dueto computation[40],wedevelopprivacy-preservingprotocolsforthe
theirgranularapproach,ABMsareapromisingtoolforreal-world simulation,calibration,andanalysisofABMs.Theseprotocolsoffer
decision-makingandpolicydesignandconstituteanactivefield robustsecurityguaranteestoagentswhilepreservingtheabilityof
ofresearchacrosseconomics[6,12,15,34],biology[28,44],and ABMstomodelcomplexsystemseffectively.Moreover,ourmethod-
epidemiology[7,33,37,54].ThewideradoptionofABMs,however, ologyenablessecureABMstotakeadvantageofdifferentiablepro-
gramming,allowingthemtobeintegratedintomachinelearning
pipelines,furtherboostingtheirmodelingcapabilities.Wedemon-
ThisworkislicensedunderaCreativeCommonsAttribution
stratethecapabilitiesofthisnewmethodologybyrunningacase
International4.0License.
studyinthecityofOxford,UK.Weshowcasehowourapproach
canprovidethesamelevelofinsightandanalysisastraditional
Proc.ofthe23rdInternationalConferenceonAutonomousAgentsandMultiagentSystems
(AAMAS2024),N.Alechina,V.Dignum,M.Dastani,J.S.Sichman(eds.),May6–10,2024, ABMswhileguaranteeingtheagents’privacy.
Auckland,NewZealand.©2024InternationalFoundationforAutonomousAgentsand
MultiagentSystems(www.ifaamas.org).
4202
rpA
91
]AM.sc[
1v38921.4042:viXraInsummary,thisworkconstitutes,tothebestofourknowledge, 2.2 CalibrationofABMs
thefirstframeworkforprivacy-preservingABMs.Theframework Calibration refers to the process of tuning the set of structural
supportstheirsimulation,calibration,andanalysis.Wehopethis parameters𝜽 sothatABMoutputsxarecompatiblewithgiven
developmentwillpavethewayforthesecureandpracticaluti- observationaldatay.InepidemiologicalABMs,forinstance,this
lizationofABMsasvaluabletoolsforpolicy-makinginreal-world entailsdeterminingvaluesforparameterslikethereproduction
settings. number𝑅0 andmortalityratestoalignwiththeobserveddaily
infectionormortalitydata.
2 AGENT-BASEDMODELS Itisimportanttorecognizethatduetothestochasticityofthe
modelanditspartialobservability,multiplesetsofparameterval-
Inthissection,weformalizetheprocessesofsimulation,calibration,
ues𝜽 maybecompatiblewiththeobserveddatay.Consequently,
andanalysisofABMs.Indoingso,welaythefoundationsforthe
itbecomesessentialtohaveanaccurateestimateofuncertainty
introductionofprivacy-preservingprotocolsinSection4.
aroundthecalibratedparameters.Likewise,itisalsoimportant
tobeabletoincorporateexpertknowledgethatmayindicatea
2.1 SimulationofABMs preferenceforcertainregionsoftheparameterspaceoverothers
ConsideranABMwith𝑁 agents𝐴={1,2,...,𝑁}.Wedenoteby intothecalibrationprocedure.Bothoftheserequirementscanbe
z𝑖(𝑡)thestateofagent𝑖attime𝑡,whichencapsulatesbothfixed metbyadoptingaBayesianframework,whereinparameterinfer-
andtime-evolvingpropertiesofthesimulationagents.Forexample, encecorrespondstodeterminingtheposteriordistributionoverthe
zmightrepresenttheageanddiseasestatusofhumanagentsin parameters,𝜋(𝜽 |y)usingBayes’theorem,
epidemiologicalmodels,ortheaccountbalanceoffirmsinafinan-
𝑝(y|𝜽)𝜋(𝜽)
cialauctionmodel.Asthesimulationproceeds,anagent𝑖updates 𝜋(𝜽 |y)= , (2)
𝑝(y)
theirstatez𝑖(𝑡)byinteractingwiththeirneighborsN𝑖(𝑡)andthe
environmentE(𝑡).Weassumethattheinteractionofagentswith where 𝜋(𝜽) is the prior distribution,𝑝(y | 𝜽) is the likelihood
theirneighborscanbeconceivedasmessagepassingonagraph functionand𝑝(y)isthemarginallikelihood.ForABMs,thelike-
G = (𝑉,𝐸),wherethevertices𝑉 ofthegraphcorrespondtothe lihoodfunctionistypicallyintractable;thus,weneedtoconsider
agents,edges𝑒
𝑖𝑗
∈𝐸connectneighboringagents,andinteractions likelihood-freecalibrationalgorithms.
arerepresentedasmessages𝑀 𝑖𝑗(𝑡)=𝑀(z𝑗(𝑡),𝑒 𝑖𝑗(𝑡),𝜽,𝑡),where WhilemanyBayesiancalibrationmethodsexistforABM(see,
𝜽 aretheABMstructuralparameters.Thisisthecaseforadiverse e.g.,[24,30,49]),wefocusonmethodsthatexploitthedifferen-
classofsocialandbiologicalcontagionmodels[23].Forexample, tiabilityoftheABM.DifferentiableABMs[3,19]areABMsim-
𝑀 𝑖𝑗(𝑡)mayrepresentthetransmissionofinfectionfromagent𝑗 to plementedinframeworksthatallowcomputingthegradientof
agent𝑖,whichmaydependonthesusceptibilityofagent𝑖(z𝑖),the theABMoutputrespecttothestructuralparameters,∇ 𝜽x,inan
infectivityof𝑗 (z𝑗),thepropertiesofthevirus(𝜽),andthenature efficientwayusingtechniqueslikeautomaticdifferentiation[8].
oftheinteraction(𝑒 )[19,33,54];ortransmissionofinformation Gradient-assistedcalibrationmethodsthattakeadvantageofthe
𝑖𝑗
fromagent𝑖to𝑗 whichdependsontheopinionofagent𝑖(z𝑖),and differentiabilityoftheABMhavebeenshowntobemoreefficient,
theassimilationandrejectionthresholdsofagent𝑗(z𝑗)[21,21,25]. scalingtolargerparameterspacesthantheirgradient-freecoun-
Thus,atstep𝑡,eachagentupdatesitsstateasfollows: terparts[19,53],withoutrequiringtheuseofsurrogatemodels.In
mostapplications,theABMoutputxisanaggregateoveragent
statesthroughtime,asisthecaseinepidemiology,whereweare
(cid:202) typicallyinterestedininfectioncurves.Thegradientcanthenbe
z𝑖(𝑡+1)=𝑓 (cid:169) (cid:173)z𝑖(𝑡), 𝑀 𝑖𝑗(𝑡), 𝜽(cid:170) (cid:174), (1)
computedasanaggregation
(cid:171)
𝑗∈N𝑖(𝑡)
(cid:172)
(cid:202)
∇ 𝜽𝑥 𝑡 = ∇ 𝜽(ℎ(z𝑖(𝑡))). (3)
where⊕denotesanaggregationfunctionoverallreceivedmes-
𝑖∈𝐴
sages.Thespecificformof𝑓 canbetailoredtocapturetheunique
Asuitablelikelihood-freeapproachtoconductgradient-assisted
dynamicsofthesystemunderinvestigation.Forinstance,thediver-
BayesiancalibrationinABMsisgeneralizedvariationalinference
sityofcontagionmodelscanbeencapsulatedbydifferentfunctional
[39](GVI).InGVI,weemployavariationalapproachtotargetthe
formsof𝑓 [23].
generalizedposterior,
DuringthesimulationofanABM,acentralagent(themodeler)
collectsatime-seriesofaggregatestatisticsoveragentstates,x𝑡 = 𝜋 𝑤(𝜽 |y)∝𝑒−𝑤·ℓ(y,𝜽)𝜋(𝜽), (4)
ℎ({z𝑖(𝑡) |𝑖 ∈𝐴}),whichcanbeusedtocomparetheoutputofthe
modeltoground-truthdata.Forinstance,inepidemiologicalABMs, whereℓ(y,𝜽)isalossfunctioncapturingthecompatibilitybetween
ℎmaycorrespondtocountingthenumberofinfectedagentsso theobserveddatayandthebehaviouroftheABMatparameter
that{x𝑡}𝑡 isatimeseriesofdailyinfections. vector𝜽,and𝑤 >0isahyperparameter.Thisposteriorcanthen
Aswecansee,bothEquation(1)andthecollectionofthesum- beapproximatedbyfindingadistribution𝑞 insomevariational
marystatisticsrequireagentstocommunicatetheirstatetoother familyQofdistributionsthatminimisestheKullback-Liebler(KL)
agents.Inthefollowingsections,weintroduceamethodologythat divergencetothegeneralisedposteriorgiveninEquation(4),
enablestheseoperationstotakeplacewhilepreservingtheprivacy
ofindividualagents.
𝑞∗=argminL(𝝓), (5)
𝝓where epidemiologicalmodels,thiscancorrespondtothehealthandde-
mographictraitsandmobilitypatternsofindividualagents.Such
L(𝝓)=E
𝑞 𝝓
[ℓ(x(𝜽),y)]+𝑤 KL(𝑞
𝝓
||𝜋(𝜽)). (6)
anattackercanmanifestitselfasthecoordinatingserverthatwants
This optimization problem can be tackled by estimating the tosurveilagentsusingthemobilitytraceora(sub-group)ofad-
gradient∇ 𝝓L(𝝓)andusinganappropriateoptimizationtechnique versarialagents,whichmaybeincentivizedtostealthepersonal
suchasstochasticgradientdescenttominimizeL(𝝓).Giventhe healthinformationofagentcohorts.Inthecontextofagent-based
differentiablityoftheABM,thegradientoftheexpectedlosscanbe modeling,thisinformationcanbeleakedduringmessagepassing
computedthroughapathwiseMonteCarlogradientestimatorvia overper-stepneighborhoods(Equation(1))andduringthecollec-
thereparameterizationtrick(see[43]foracomprehensivereview), tionofsummarystatisticsoverthepopulation.Thegoalofthis
𝑁 workistoalleviatesuchchallengesanddesignaprivacy-preserving
∇ 𝝓E 𝑞
𝝓
[ℓ(x(𝜽),y)] ≈ 𝑁1 ∑︁ 𝑖=1∇ 𝝓ℓ(𝑥(𝜽𝝓(𝑢(𝑖)),y), (7) m ree vc eh aa lin ni gsm prt ih va at teca inn foco rmm ap tu iote nf .unctionsoveragents’stateswithout
where𝑢(𝑖) ∼ 𝑝(𝑢) is a sample from the base density𝑝(𝑢) and 3.2 SecureMulti-partyComputation
𝜽𝜙(𝑢(𝑗))isthetransformedsamplefromthecandidateposterior
Securemulti-partycomputationenablesasetofagentstointeract
𝑞 .Finally,thegradientofthelosscanberelatedtoEquation(3)
𝜙
andcomputeajointfunctionoftheirprivateinputswhilerevealing
viathechain-rule,
nothingbuttheoutput[40].MPCprotocolsarecoordinatedwitha
∇ 𝝓ℓ(x(𝜽,y))=∇ 𝝓𝜽𝝓 ·∇ 𝜽x. (8) server(MPCserver)andaredesignedtoprotectagainstbehaviorof
Inpractice,thevariationalfamilyQwillbeparameterizedbya adversarialparticipants.Theseparticipants,eitheranagentorthe
deepneuralnetwork(i.e,anormalizingflow)thatistrainedusing server,aimtolearnprivateinformation(ofotherentities)orcause
thegradientinEquation(7). thecomputationresulttobeincorrect.Theideawasfirstintroduced
byYaoforthetwo-partycase[58]andgeneralizedtomultiparty
2.3 AnalysisofABMs settingsbyGoldreich,MicaliandWigderson(GMW)[27].Among
OneofthecorestrengthsofABMsistheirgranularity,whichen-
otherproperties,GMWprotocolsguarantee(1)privacy:sothatno
entitycanlearnanythingmorethanitsprescribedoutputand,(2)
ablesABMtoaddressresearchquestionsthatarebeyondreach
for coarser methodologies. For instance, epidemiological ABMs
correctness:sothatagentsreceivethecorrectoutput.Forinstance,in
anepidemiologicalABM,thiswouldensureboththatthepersonal
canhelpanalyzetheobserveddisparitiesofCOVID-19infections
diseasestatusofagentsisnotleakedandthatagentsreceivethe
amongdemographicgroups[38,42,51],planeffectivevaccination
correcttransmissionprobabilityasinacentralizedsimulation.
rolloutplans[59],orassesstheroleoflatenttransmissionfora
certain network structure [41]. All these studies require exami-
3.3 TheGMWprotocol
nationofthedistributionofstatevaluesoftheagentsandtheir
responsivenesstochangesinthemodel’sstructuralparameters. TheGMWprotocolusesadditivesecretsharingtocommunicate
Specifically,weareinterestedincollectingaseriesofsummary (oraggregate)privateinputsacrosstheparticipantentities.The
statisticsovertheagent’spopulation,𝝃𝑘 =ℎ 𝑘({z𝑖(𝑡) |𝑖 ∈𝐴}),and keyinsightistodivideasecretinputintomultiplesharesinsuch
theirsensitivity,∇ 𝜽𝝃𝑘.Forinstance,inanepidemiologicalABM, awaythatthesecretcanbereconstructedonlywhenasufficient
wemightinvestigatethedistributionofinfectionsamongdifferent number of shares are combined together. The scheme supports
agegroupsandassesshowtheseinfectionsreacttovariationsinthe diverseaggregationqueriessuchassecureadditionorsecuremul-
reproductionnumber𝑅0.Sensitivityanalysiscanbeachallenging tiplication[9]ofthesecretsheldbytheparticipatingagents.Here
taskduetothehighcomputationalcostofrunninglargeABMs wefocusontheadditioncaseandweassumethatallparticipating
andthehighdimensionalityoftheparameterspace.Aswiththe agentsarerequiredtocomputethesecret,usuallydenotedby𝑡 =𝑁,
calibrationprocess,differentiableABMsmayhelpmitigatethis butthesamemethodologycanbeextendedtomultiplicationand
computationalbottleneck[51]. compositequeries(see,e.g.,[40]).
Consider𝑁agentsholdingprivatevalues𝑠 .Wewanttocompute
𝑖
3 CHARACTERIZINGPRIVACY the sum (cid:205) 𝑠 without any agent 𝑗 acquiring knowledge about
𝑖 𝑖
𝑠 .Tosetuptheprotocol,theagentsagreeonaninteger𝑛 >
First,weformalizeathreatmodeltosetupconstraintsforaprivacy- {𝑘≠𝑗}
(cid:205) 𝑠 definingthefinitegroupZ onwhichallcomputationswill
preservingsolution.Then,weprovidebackgroundonsecuremulti- 𝑖 𝑖 𝑛
becarried1.Eachagent𝑖 thensamples𝑁 −1randomnumbers,
partycomputationanddescribetheGMWprotocolwhichweuse
todesignalgorithmsforprivacy-preservingsimulation,calibration
𝑟
𝑖𝑗
∼U{0,𝑛−1},suchthattheinputisdividedinto𝑁 shares,𝑠
𝑖𝑗
definedby
andanalysisofagent-basedmodels.
𝑁 𝑁−1 𝑁−1
∑︁ ∑︁ ∑︁
3.1 ThreatModel 𝑠 𝑖 = 𝑠 ij (mod𝑛)= 𝑟 𝑖𝑗 +(cid:169) (cid:173)𝑠 𝑖 − 𝑟 𝑖𝑗(cid:170) (cid:174) (mod𝑛). (9)
Weassumeanhonest-but-curious(a.k.a.semi-honest)attacker[32] 𝑗=1 𝑗=1 𝑗=1
(cid:171) (cid:172)
whichaimstolearnprivateinformationaboutparticipatingagents Eachagentthensendseachshareoftheirsecrettoeachcorrespond-
withoutalteringtheprotocol.Thisprivateinformationisincluded ingagent;agent𝑖 sends𝑠 𝑖1sharetoagent1,𝑠 𝑖2sharetoagent2,
inanagent’sstatez𝑗(𝑡),interactiontrace{N𝑖(𝑡) |∀𝑡},andneigh-
1Thechoicetoperformfinitegrouparithmeticsissothatnoinformationaboutthe
borhoodmessages {𝑀 𝑖𝑗(𝑡) | 𝑖 ∈ 𝐴,𝑗 ∈ N(𝑖)}.Forinstance,in secretcanbegainedbyholding<𝑁shares.etc.Locally,eachagentperformsthesum ℎ(z3)
𝑁 ∇ 𝜽ℎ(z3)
∑︁
𝜎 𝑘 = 𝑠 𝑖𝑘 (mod𝑛). (10) ℎ(z4)
𝑖=1 𝜽 ∇ 𝜽ℎ(z4) SecureSum
Finally, all values𝜎 are shared so that the reconstructed sum, ℎ(z2)
𝑘
𝑆 =(cid:205) 𝑘𝜎 𝑘 (mod𝑛),canbecomputed,correspondingtothesumof ∇ 𝜽ℎ(z2) 𝑥𝑡 =(cid:205) 𝑖ℎ(z𝑖)
theagentinputs𝑠 𝑖 byconstruction.Typically,thisreconstruction ℎ(z1) ∇ 𝜽𝑥 𝑡 =(cid:205) 𝑖∇ 𝜽ℎ(z𝑖)
may be conducted by a central MPC server or a trusted agent. ∇ 𝜽ℎ(z1)
WesummarizetheprotocolinAlgorithm1,andweprovidean
illustratingexamplebelow. Figure1:DiagramillustratingtheSecureSimulationproto-
colforABMparameters𝜽.
3.3.1 Additivesecretsharingexample. Consider𝑁 = 3agents—
Alice,Bob,andCarol—holdingprivatevalues𝑠
𝐴
=2,𝑠
𝐵
=3,and
4 PRIVATEAGENT-BASEDMODELS
𝑠 𝐶 = 5.Theywishtocomputethesumofthesevalueswithout
disclosingtheirindividualinputs.Theyagreeonaninteger𝑛=11, WiththeMPCbackgroundintroducedintheprecedingsection,
definingafinitegroupZ 𝑛.First,theagentsgenerate3shareseachby weformulateprotocolstoconductthesimulation,calibration,and
sampling2randomnumbersfromZ 𝑛.Forinstance,Alicegenerates analysisofABMsinaprivacy-preservingway.
randomnumbers7and5,sothat
4.1 SecureSimulation
𝑠
𝐴
=𝑠 𝐴𝐴+𝑠 𝐴𝐵+𝑠
𝐴𝐶
=7+5+1(mod11)=2, (11)
Inordertoupdatethestateofanagentduringasimulation,Equa-
andsimilarlyforBobandCarolwith𝑠
𝐵
=2+0+1(mod11),and
tion(1)requiresanaggregationovertheagent’sneighbors,reveal-
𝑠 𝐶 = 3+1+1 (mod11).Second,theagentscommunicatewith ingtheirprivateinformation.Asdescribedintheprevioussection,
eachothertokeeponeofthesharesandsendtheothertwoto
MPCiswell-equippedtoperformthiskindofcalculationwithout
theothertwoagentsandperformthesumofthereceivedshares.
revealingtheindividualparties’data.Withoutlossofgenerality,we
Forexample,Alicereceives𝑠 fromBoband𝑠 fromCaroland
𝐵𝐴 𝐶𝐴 presentourprotocolsforthecasewheretheaggregationfunction
computes
⊕isasummationΣ,sothatwecanmakeuseoftheSecureSum
𝜎 𝐴 =𝑠 𝐴𝐴+𝑠 𝐵𝐴+𝑠 𝐶𝐴 =7+2+3(mod11)=1(mod11), (12) protocolintroducedinAlgorithm1.Furthermore,aslongasthe
andsimilarlyforBobandCarolwith𝜎 𝐵 = 5+0+1 (mod11) =
agent’supdatefunction𝑓 isdifferentiablerespecttothestructural
6(mod11)and𝜎
𝐶
=1+1+1(mod11)=3(mod11).Finally,the
parameters𝜽,whichisindeedthecaseformanyABMs[19],each
secretcanbereconstructedbydoing𝑆 =𝜎 𝐴+𝜎 𝐵+𝜎
𝐶
=10(mod11) agentcanstore∇ 𝜽𝑓 foruseduringthecalibrationstep.Withallthis
inmind,wepresentinAlgorithm2,aprivacy-preservingprotocol
asexpected.
forupdatingagentstates.
Inthefollowingsection,weapplytheGMWprotocoltogen-
eralizetheaboveinsighttoshareinformationcontainingagent’s
privateinformationtootheragentsoracentralMPCserver,provid- Algorithm2:SecureAgentUpdate
ingprotocolsforthecomputationofagentupdates(Equation(1)), Data:Agent𝑖withstatez𝑖(𝑡),Neighboringagent’s
and gradients (Equation (3)) in a secure way, enabling privacy- messages{𝑀 𝑖𝑗(𝑡) | 𝑗 ∈N(𝑖)},Integer𝑛,Stateupdate
preservingsimulation,calibration,andanalysisofABMs. rule𝑓,ABMparameters𝜽
Result:Newstatez𝑖(𝑡+1)
Algorithm1:SecureSum 1
Agent𝑖callstheSecureSumprotocolwithneighbors
{𝑗 | 𝑗 ∈N(𝑖)}andinteger𝑛toobtainthesum
Data:A ing tee gn ets r𝑛{1 >,.. (cid:205).,𝑁
𝑠
.}withsecretinputs𝑠1,...,𝑠 𝑛,
𝑀 𝑖(𝑡)=(cid:205) 𝑗∈N(𝑖)𝑀 𝑖𝑗(𝑡).
Result:Thesumofa𝑖 ll𝑖 shares𝑆 =𝑠1+···+𝑠 𝑛. 2 Agent𝑖updatesitsstatez𝑖(𝑡+1)=𝑓 (z𝑖(𝑡),𝑀 𝑖(𝑡),𝜽)and
1 Splittingsecretintosharesanddistributing:
storesthegradient∇ 𝜽𝑓.
2 Eachparty𝑖generates𝑁 shares𝑠 𝑖1,...,𝑠 𝑖𝑁 ∈Z 𝑛which
sumupto𝑠 . Itisworthnotingthat,incontrasttogeneralapplicationsofthe
𝑖
3 Eachparty𝑖distributesalltheirshares𝑠 𝑖1,...,𝑠 𝑖𝑁 ∈Z 𝑛to GMWprotocol,onlytheagentwhostartstheprotocolreceivesthe
1,...,𝑁,includingthemselves. resultofthecomputationsincethereisnoneedfortheneighboring
4 SecureComputation(Addition): agentstohaveaccesstothatinformation.
Toaddtheinputssecurely,partiessimplyaddtheir Next,weintroducetheSecureSimulationprotocolinAlgo-
5
respectiveshares𝜎
𝑖
=𝑠1𝑖 +···𝑠
𝑁𝑖
mod𝑛. rithm3,where,inadditiontoperformingagentupdates,wecollect
6 Reconstruction: atimeseriesofaggregatestatisticsovertheagent’spopulationand
Torevealthefinalresultofthecomputation,parties
itsgradientwithrespecttotheABMstructuralparameters𝜽.
7
collaboratebysummingtheirshares:
4.2 SecureCalibration
8 𝑆 =(𝜎1+𝜎2+···+𝜎 𝑛) mod𝑛.
DuringthecalibrationofanABM,themodeler(centralMPCserver)
requirestheabilitytoevaluatetheABMatdifferentvaluesof𝜽,and,Algorithm3:SecureSimulation Algorithm4:SecureCalibration
Data:MPCserver𝐶,Agents{1,...,𝑁}withstates Data:MPCserver𝐶,Agents{1,...,𝑁}withstates
{z1,...,z𝑁},ABMparameters𝜽,Stateupdaterule𝑓, {z1,...,z𝑁},Stateupdaterule𝑓,Prior𝜋(𝜽),
Numberoftime-steps𝑇 Observedtime-seriesy,Lossfunctionℓ(x,y),
Result:Aggregatestatisticsx=𝑥1,...,𝑥
𝑇
andgradients Numberofepochs𝑁 𝑒,NumberMonte-Carlosamples
∇ x. 𝑁,Numberoftime-steps𝑇,Learningrate𝜂
𝜽
1
𝐶generatesalargeenoughprimenumber𝑃 andthe Result:Trainedcandidateposterior𝑞∗
requestedstatisticscollectingfunctionℎ;andsendsthem 1 𝐶initializescandidateposterior𝑞 𝝓.
toallagentsalongABMparameters𝜽. 2 for1,...,𝑁 𝑒 do
2 fort=1,...,T do 3 for1,...,N do
3 fori=1,...,N do 4 𝐶samplesABMparameters𝜽 ∼𝑞 𝝓(𝜽).
4 Agent𝑖callstheSecureAgentUpdateprotocol 5 𝐶executesSecureSimulationprotocol
(Algorithm2)tocomputez𝑖(𝑡+1). (Algorithm3)toobtainxand∇ x.
𝜽
5 Agent𝑖gathersitsinformationofinterest 6 𝐶usesthechainruletocompute
6
𝐶callℎ s( tz h𝑖 e(𝑡 S+ ec1 u) r) ea Sn ud mgr pa rd oi te on ct ol∇ w𝜽 iℎ th(z a𝑖 l( l𝑡 a+ ge1 n)) ts.
tocollect
∇ 𝜽ℓ(x(𝜽,y))=∇ xℓ(x,y)·∇ 𝜽x
theaggregatestatistics𝑥
𝑡
andtheirgradients∇ 𝜽𝑥 𝑡. ∇ 𝝓ℓ(x(𝜽),y)=∇ 𝜽ℓ(x(𝜽),y)·∇ 𝝓𝜽
usingthereparameterizationtrick(Equation(7)).
7
𝐶returnstheaccumulatedxand∇ 𝜽x.
7
𝐶accumulatesgradienttoestimate
𝑁
1 ∑︁
inthecaseofgradient-assistedcalibration,thegradientoftheout-
∇ 𝝓E 𝑞
𝝓
[ℓ(x(𝜽),y)] ≈
𝑁
∇ 𝝓ℓ(𝑥(𝜃),𝑦).
𝑖=1
putswithrespectto𝜽.Theretrievalofthesequantitiesisenabled
by the SecureSimulation protocol and so classical calibration 8
𝐶computesdivergenceKL(𝑞
𝝓
||𝜋(𝜽))andderivative
algorithms[30,49]canbeseamlesslyappliedtoconductaprivacy-
∇ 𝝓KL(𝑞
𝝓
||𝜋(𝜽)).
preservingcalibration.Here,asoutlinedinSubsection2.2,wefocus 9
𝐶updates𝝓 →𝝓−𝜂∇𝝓L(𝝓),where
onconductingGVIwithadeepneuralnetworktrainedtoapproxi- L(𝝓)=E
𝑞 𝝓
[ℓ(x(𝜽),y)]+KL(𝑞
𝝓
||𝜋(𝜽)).
matethegeneralizedposterior.Thisneuralnetworkseatsonthe
centralMPCserveranditistrainedusingthecollectedgradients. 10
𝐶returnstrainedcandidateposterior𝑞∗.
Tothisend,whatremainstobedetailedisthetransitionfromthe
gradientofaggregatestatistics,∇ x,tothelossgradientrequired
𝜽 Algorithm5:SecureSummaryStatistic
forGVI(Equation(7)).ThisprocessisdetailedinAlgorithm4.
Data:MPCserver𝐶,Agents{1,...,𝑁}withstates
4.3 SecureAnalysis {z1,...,z𝑁},Indicatorfunction1 Ω(z).
As outlined in Subsection 2.3, we require a secure protocol to
Result:Aggregatequantity(cid:201) 𝑖∈𝐴1 Ω(z𝑖).
ℎr he
𝑘
at v(r
{
eie
z
av
𝑖
l(e
r𝑡
e)s au d|m
y𝑖
m
a∈
da
𝐴
dr r}y
e)
s,s sat ea
n
dt di ts htt hi ic ses
ii
sro
ss
uv
e
ee nr
is
nit th
tiv
he
i
eta
y
Sg
,
ee
∇
cn u𝜽t’ r𝝃s
e𝑘
Sp
.
io
W
mp ueu ll
n
aa ot ti
t
io
e
on nt,
h
p𝝃
a
rt𝑘
ow
to=
e
-
21 𝐶 Ea ag l coe hnn age gsr ia ed nt ee ts i 𝑖np cdr oi im c mae pto un r tu efm sun rb ece str uio𝑃 ln ta o1n fΩd 1(s Ωze ) (n . zd 𝑖)s .themtoallagents
colsinceretrievingthetime-seriesxisaparticularcaseofthismore 3
𝐶executesSecureSumprotocoltosecurelyretrieve
generalproblem.Infact,weformulateamoregeneralapproach (cid:201) 𝑖𝑁 1 Ω(z𝑖).
whereinasummarystatistic𝝃 overthepopulationstatescanbe
obtainedbyaggregatingovertheentirepopulationtheoutputsof
5 CASESTUDY:PRIVACY-PRESERVING
anindicatorfunction1 Ω(z)actingontheagent’sstate,
EPIDEMIOLOGY
(cid:202)
𝜉 = 1 Ω(z𝑖), (13) In this section, we illustrate how our methodology may be de-
𝑖∈𝐴 ployedinpracticebydescribingadecentralizedprivacy-preserving
whereΩdenotesthesetofcharacteristicswewanttoaggregateon, agent-basedSIRmodel,whichsupportssimulation,calibration,and
and⊕denotesakindofaggregation,usuallyasum.Forinstance, analysis.
Ωmaycorrespondtothepropertyofbeinginfected,inwhichcase Themodelfollowsastandardparameterizationwhereagents’
taking⊕tobeasumwouldreturnthenumberofinfectedagents. interactionsarespecifiedthroughacontactgraphG,whichinthis
ThealgorithmisformallydescribedinAlgorithm5,whichholds caseisonlylocallydefinedbyeachagenthavingaccesstotheir
thesamesecurityguaranteesastheoneexposedinSubsection4.1. neighbors.Eachagenthas3possiblestates:0(Susceptible),1(In-
Likewise,sensitivityanalysiscanbeperformedsecurelyusingAl- fected),and2(Recovered).Weinitializethesimulationbyinfecting
gorithm6,whereeachagentcomputesthesensitivityoftheirstate a fraction 𝐼0 of agents sampled uniformly from the population,
changetothemodelparameters,andthecentralagentretrieves whiletheremainingagentsareconsideredsusceptible.Following
theaggregationbyemployingtheSecureSumprotocol. the notation introduced in Section 2, at each time-step, agent𝑖5.1 PrivatepolicyassessmentwithABMs
Algorithm6:SecureSensitivityAnalysis
Data:MPCserver𝐶,Agents{1,...,𝑁}withstates WefirstconsidertheapplicationoftheSecureSimulationprotocol
{z1,...,z𝑁},Indicatorfunction1 Ω(z),Stateupdate (Algorithm3).Letusposeasituationwhereapolicymakerwants
rule𝑓 tostudytheefficacyofmask-wearingatdifferentcompliancelevels
Result:Sensitivity∇ 𝜉. usingagent-basedsimulation.Weintroduceaslightmodificationto
𝜽
1
𝐶generatesprimenumber𝑃 andsendsthemtoallagents Equation(16)toincorporateareductionintheinfectionprobability
alongsideindicatorfunction1 Ω(z). duetomask-wearingwithcertaincompliance𝛼,
2
Eachagent𝑖executesSecureAgentUpdatewith
parameters𝜽 toobtain∇ 𝜽𝑓(z𝑖,𝑀 𝑖,𝜽)sothat 𝑝 i( n𝑖 f) (𝑡)=1−exp(cid:169) (cid:173)−𝛽𝑆 𝑛𝑖Δ 𝑡 ∑︁ 𝐼 𝑗(𝑡)(1−𝑐 𝑗)(cid:170) (cid:174), (18)
𝑖
∇ 𝜽𝜉 𝑖 =∇ 𝜽𝑓(z𝑖,𝑀 𝑖,𝜽)·1 Ω(z)
(cid:171)
𝑗∈N(𝑖)
(cid:172)
3 𝐶executesSecureSumprotocoltosecurelyretrieve where𝑐 𝑗 ∼Bernoulli(𝛼),sothat𝛼 𝑖 =1correspondstofullcompli-
∇ 𝜽𝜉 =(cid:201) 𝑖𝑁 ∇ 𝜽𝜉 𝑖. a con mce pw leh teer pe roth tee cr te iois nn ao gat ir na sn ts im ni fs es ci to ion n.N wo ht ee nth wa et aw rie na gr ae mas as su km .Wing
e
proceedtoexecute3simulationsfor3differentvaluesof𝛼.Ateach
simulation,𝛼issenttotheagents,wheretheylocallycomputetheir
updatesitsstatefollowingEquation(1)with
owncompliancetothemeasure.TheSecureSimulationprotocolis
𝑀 𝑖𝑗(𝑡)=𝐼 𝑗(𝑡) (14) thenusedtorunthesimulationandretrievetheaggregatestatistic
ofinterest,x,whichinthiscaseisthenumberofinfectionsover
where𝐼 𝑗(𝑡)istheinfectedstatusoftheneighbor(0or1),sothat
time.TheresultsareshowninFigure2,whereweobservethatlittle
𝑧 𝑖(𝑡+1)=1 {𝑧𝑖=0} ·Bernoulli(cid:16) 𝑝 i( n𝑖 f) (𝑡)(cid:17) + transmissionoccurswhencomplianceisabove⪆75%.
1 {𝑧𝑖=1} ·(cid:16) 1+Bernoulli(cid:16) 𝑝 r( e𝑖 c)(cid:17)(cid:17) + (15) 0.04 Compliance
1
{𝑧𝑖=2}
·2
0.03
0 2%
5%
with 50%
𝑝 i( n𝑖 f) (𝑡)=1−exp(cid:169) (cid:173)−𝛽𝑆 𝑛𝑖Δ𝑡 ∑︁ 𝐼 𝑗(𝑡)(cid:170) (cid:174), (16) 0.02 75%
𝑖
𝑗∈N(𝑖)
(cid:171) (cid:172) 0.01
whereN(𝑖)isthesetofneighborsofagent𝑖,𝑆
𝑖
isthesusceptibility
ofagent𝑖,𝑛
𝑖
=#N(𝑖)isthetotalnumberofneighbors,Δ𝑡 isthe
0.00
durationofthetime-step,and𝛽 isastructuralparameterofthe
0 20 40 60
ABMcalledtheeffectivecontactrate.Infectedagentscanrecover
Timestep[days]
ateachtimestepwithrecoveryrate𝛾,sothat
𝑝 r( e𝑖 c) =1−exp(−𝛾Δ𝑡). (17) F 0%igu (br le u2 e: ),In 25fe %ct (i go rn eec nu )r ,v 5e 0s %fo (or rd ai nff ge er )e ,n 7t 5l %ev (re els d)o .f Tc ho em np uli man bc ee r:
Forthecaseofacompletegraph,themodelreducestothestandard ofinfectionshasbeennormalizedtothenumberofagents
ODE-basedSIRmodelwith𝑅0 = 𝛽/𝛾 asthebasicreproduction 𝑁.Theseplotsaregeneratedwithoutreleasingtheinfection
number.Themodelisrunfor𝑛 𝑡 timesteps. statusorcompliancedecisionofanyindividualagent.
Togroundtheexampleonrealdata,weconsiderthecontact
graphofthecityofOxford,extractedfromtheJuneABMmodel Thus,weobservethatwithinourmethodology,thepolicymaker
[7]todeterminetheneighborhoodofeachagent,N(𝑖).Thiscon- couldstillhaveaccesstothesamelevelofinsightasatraditional
tactgraphincludesagents’interactionsinhouseholds,companies, ABM,allwhileprotectingtheindividualagent’sprivacy.
andschools,anditisbasedonEnglishcensusdata.Thechoiceof
parametervaluesfortheexperimentisgiveninTable1. 5.2 PrivatecalibrationofABMs
Next,weposeasituationwherewewanttocalibrateourABM
Parameter Value withstructuralparameters𝜽 = (𝛽,𝛾) toobservedground-truth
𝛽 0.5day−1 data.Forsimplicity,wepresentthecalibrationofthe𝛽parameter
𝛾 0.1day−1 givenanobservedcurveofinfections(y),obtainedbyrunningthe
𝐼0 0.01 ABMmodelwiththebaselineparametersinTable1.
Δ𝑡 1day Thefirststepistocomputethegradient∇ x,wherexisthe
𝜽
𝑛
𝑡
60 numberofdailyinfectionsand𝜃 =𝛽.Wenotethatthisgradient
G Oxford canbeapproximatedbythegradientoftheaveragenumberofnew
Table1:Parametervaluesfortheagent-basedSIRmodel. infectionswithrespectto𝛽,
𝑁
𝜕𝑥 𝑡 ≈ 𝜕E[Δ𝐼(𝑡)] =∑︁ 𝜒 𝑖(𝑡)exp(−𝜒 𝑖(𝑡)/𝛽), (19)
𝜕𝛽 𝜕𝛽
𝑖=1
snoitcefnifonoitcarfyliaDhave
Flow 0.12 Groundtruth
Prior 0.10 S fri om mul ta rt ae id nes dam flop wles 1 Ω(z)=1 {(𝑧age∈𝑎𝑘)∧(𝑧 inf=1)}(z), (21)
0.08
S fri om mul pa rt ie od rsamples where𝑧age and𝑧
inf
aretheageandinfectedstatusoftheagent,
and𝑎 areeachofthehistogramagebins.Thenumberofcounts
𝑘
0.06 intheparticularagebin𝑎 canthenbeobtaineduponexecuting
𝑘
0.04 SecureSumovertheentirepopulationfollowingAlgorithm5.Fig-
ure4showstheageandethnicityhistogramofinfectionsforthe
0.02
calibratedsimulationobtainedinSubsection5.2,wheretheeth-
0 −.8 0.0 0.8 1.6 0.00 0 20 40 60 nicityhistogramhasbeencomputedanalogouslytoageoneby
β Time[days] consideringtheindicatorfunction
Figure3:Left:Probabilitydensityplotforthetrainednor-
1 Ω(z)=1
{(𝑧 ethnicity=𝑒𝑖)∧(𝑧
inf=1)}(z), (22)
malizingflow(blue)againstthepriordistribution(orange). foreachethnicitycategory𝑒 .Theresultsareinagreementwith
𝑖
Ground-truthvalueismarkedasadashedblackline.Right: theparticulardemographicsofthecityofOxford,dominatedby
Resultsfromsimulating 𝛽 samplesfromthetrainedflow studentsinthe20-30agebinwithasignificantpresenceofnon-
(blue)andprior(orange)comparedtotheground-truthdata Whitegroups.
(black).Thenumberofinfectionshasbeennormalizedto
thenumberofagents𝑁.
8000
20000
where 6000
𝛽𝑆 𝑖Δ 𝑡 ∑︁ 4000
𝜒 𝑖(𝑡)=exp(cid:169) (cid:173)−
𝑛
𝐼 𝑗(𝑡)(cid:170) (cid:174). (20) 10000
𝑖
𝑗∈N(𝑖) 2000
(cid:171) (cid:172)
Acentralagentcansafelyretrievethegradientbyperformingthe
0 0
SecureSumprotocolacrossallagentsasdescribedinAlgorithm3
andAlgorithm4.WethusconductGVIbyconsideringQtobea
masked-autoregressivenormalizingflow[48]andassumetheprior Age Ethnicity
isanormaldistributionwith𝜇 = 0.7and𝜎 = 0.5.Figure3(left)
showsthetrainednormalizingflow,whichcorrectlyassignshigh Figure 4:Age(left)and ethnicity(right) histogramof the
probabilitymasstotheground-truthvalue.Tofurtherevaluatethe infectedpopulation.Thesestatisticsarecomputedwithout
goodnessofthefit,weplotsimulatedrunsfromABMparameters leakingtheinfectionordemographicpropertiesofanyagent.
sampledfromthetrainedflowinFigure3(right),wherewecompare
ittorunssimulatedfrompriorsamples.
Finally,asimilaranalysiscanbedoneatthegeographicallevel,
Thisexperimenthighlightshowprivacy-preservingABMscanbe
whereinfectionscanbecollectedbyZIPcodesectorbyexecuting
integratedintodifferentialandprobabilisticprogrammingpipelines.
ThisopensthedoortointegratingABMinsightintomorecomplex
theSecureSummaryStatisticprotocolwith1
Ω(z)
=1
{𝑧 ZIPcode=𝑟𝑖}
for each ZIP code sector𝑟 . In Figure 5, we show the obtained
MLpipelinesleveragingheterogeneousdatastreamstoboostthe 𝑖
distributionofinfectionsacrossthecityofOxford.
model’sinsightcapabilities.
5.3 PrivatedemographicstudywithABMs
Inthissection,weapplytheSecureSummaryStatisticprotocolto
51.80 3000
analyzeourcalibratedABM.Inparticular,westudythedistribution
ofinfectionsbyage,ethnicity,andgeographicallocation(ZIPcode).
Thisanalysismayberelevantto,forinstance,understandingthe 51.75 2000
causesofasymmetricdistributionofinfectionsamongdifferent
demographicgroups[38,42,51]. 51.70 1000
Forthisexercise,weimportasyntheticpopulationofOxford
fromtheJunemodel,aswedidforthecontactgraph,sothatwe
haveaccesstoapopulationwithrealisticage,sex,andethnicity 1.3 1.2 1.1
− − −
distributions andgeographical location. Note that theethnicity Longitude
categorizationfollowstheEnglishcensus[29].
Figure5:GeographicaldistributionofinfectionsbyZIPcode
Wecanconstructhistogramsthathighlightthedistributionof
sectorwithinthecityofOxford.Thesestatisticsarecom-
infectionamongdifferentethnicgroupsbyconsideringtherelevant
putedwithoutleakingtheinfectionstatusorgeo-locationof
indicatorfunctionssothatwecanapplytheSecureSummaryS-
anyindividualagent.
tatisticprotocol.Forinstance,forthecaseofagedistribution,we
snoitcefnifonoitcarfyliaD
detcefniforebmuN
edutitaL
01-0 02-01 03-02 04-03 05-04 06-05 07-06 08-07 +08 etihW kcalB naisA dexiM rehtO
detcefniforebmuN
NumberofinfectedSummarising, we have illustrated how a detailed analysis of hybridapproachesthatleverageMPCwithtrustedexecutionen-
agentpropertiescanbeperformedinaprivacy-preservingwayby vironmentsfortrainingDNNs[35].Incontrast,thesimplicityof
followingSubsection4.3. mechanisticmodels,likeABMs,allowsleveragingMPCinfully
decentralizedscenarios.RIPPLE[31]introducesaPrivateInforma-
6 RELATEDWORK tionRetrieval(PIR)basedmethodtocollectaggregatestatisticson
contact-tracingsystemswhilepreservinguserprivacy.[26]usesen-
Beforeconcluding,wesurveyrecentworkondata-drivenABMs,
cryptedpersonalinformation,addingalayerofanonymitybetween
withaparticularfocusonrecentadvancesthataimtodeployABMs
thesimulatorandtheagents.However,thereisnomechanismfor
toreal-worldpopulationswithmillionsofagents.Wealsohighlight
privacy-preservingcalibrationandinterventionsonABMs[5].To
theprivacychallengesthatarisefromextendingsuchABMs.
ourknowledge,ourworkconstitutesthefirstprotocolthatenables
simulation, calibration, and analysis of ABMs while preserving
6.1 Data-drivenAgent-basedModeling agentprivacyateverystep.
The push to create highly realistic ABMs has led to a growing
demandformoregranularheterogeneousdatatoconstructthe 7 DISCUSSIONANDCONCLUSION
syntheticpopulationsthatunderliethesemodels.Thisdemandis
Inthispaper,weintroducedaparadigmthatenablesthesimulation,
particularlyevidentinfieldssuchasepidemiology(e.g.,[7,18,37])
calibration,andanalysisofagent-basedsimulationsonreal-world
andeconomics(e.g.,[15,50]),wherethepopulationisconstructed
data,whilesafeguardingtheprivacyoftheinvolvedagents.Our
fromcensusdata,usingtechniquessuchasiterativeproportional
approach leverages MPC techniques to develop robust privacy-
fitting[20,55]anddeepgenerativemodelling[13].Furthermore,
preservingprotocols,withoutcompromisingtheaccuracyofthe
theintegrationofdynamicdatastreams,includingsourceslikeSafe-
ABMoutput.Wedemonstratedtheefficacyofourparadigmby
Graphmobilitydata,CDCgenomicdata,andFacebooksurveydata,
presenting a case study in the city of Oxford, where we evalu-
intotheABMcalibrationprocesshasbecomeessentialforgenerat-
atedmask-wearingpolicies,performedgradient-assistedcalibra-
ingreal-timeinsights.Inaddressingthisneed,thecombinationof
tiontoground-truthdata,andanalyzedsimulationoutcomesusing
differentiableABMsanddeepneuralnetworks(DNN)standsoutas
aprivacy-preservingABM.
aneffectiveapproachtoseamlesslyincorporateheterogeneousdata
Thepresentedconceptmodelcanbefurtherdevelopedbyex-
sourcesduringthecalibrationprocess[19].Extendingbeyondthe
tendingtheMPCprotocolsinmultipleways,including
currentresolutionofABMpopulationsrequiresthedevelopment
ofnewmethodologiesthatsafeguardtheprivacyofstakeholders, (1) Generalizingtohigher-ordernetworkstocapturemorecom-
whichistheobjectiveofthiswork. plexcontagionmodels.Thiscouldhelpunderstandthein-
fluenceofgroupdynamicsonsocialbehavior.
6.2 DataPrivacyforModeling (2) Addressingpracticalengineeringchallenges,suchasmini-
mizingcommunicationoverheads,supportingasynchronous
RecentimprovementsinABMscalabilityhavebeenmatchedbyan
messagepassing,andleveragingdistributedcomputingto
increasedrisktoindividualprivacy[5],whichhasalreadymani-
acceleratecomputation.
festedintheformofdataleaks[1,22,36].Statisticalprivacymeth-
(3) CombiningMPCwithfederatedlearning.WhileMPCen-
odssuchasK-anonymityanddifferentialprivacyhavebeenem-
abledsimulatingwithindividualagents,federatedlearning
ployed[10,57]toprotectindividualinformationonanaggregate
canhelpincorporatesiloedinstitutionalagents.Forexample,
level. Such methods have been used to release US census data
thiswouldhelpprivatelyintegrateCDCgenomicdataor
[14]whilstprotectingindividualinformationatanaggregatelevel.
FEDinsuranceclaimsintoepidemiologicalandeconomics
SimilarmethodswerealsoemployedbyGoogleandSafeGraphin
models.
thereleaseofmobilitytracedata[2].Althoughstatisticalhiding
methodsaregoodathidingidentifiableinformationinaggregate Inthelongterm,privateABMscanbedeployedthroughmobile
statistics,theyhavelimitedcapabilityofachievingprivacywhen devices,enablingpassiveandsecuremonitoringofactionsandin-
appliedatthelevelofindividuals.Thiscreatesadifficultyinsim- teractionswithinlargepopulations.Thiswouldenableconducting
ulatingpopulationnetworks,asstatepropagationreliesonboth digitalexperimentsonthereal-timebehaviorofcomplexsystems
accumulatingindividualagents’states,whilstevaluatingpolicy withactualpopulationswhileensuringrobustsecuritymeasures.
interventionsreliesonaccesstomobilitydataforeachagent.As
a result, statistical hiding methods provide poor privacy-utility
ACKNOWLEDGMENTS
trade-offsinthecontextofABM.
Incontrast,cryptographicprotocolshavebeenusedtoprovide We are grateful to N. Bishop for his very insightful comments
strongprivacyguaranteesatthelevelofindividuals.Recently,MPC onthepaper.ThisresearchwassupportedbyaUKRIAIWorld
hasbeenexploredforsecurefederatedlearning[45]andtraining LeadingResearcherFellowshipawardedtoMWooldridge(grant
ofdistributedgraphneuralnetworks[56].Theseareconstrained EP/W002949/1).M.WooldridgeacknowledgesfundingfromTrust-
byhighcomputationandcommunicationcostofexecutingoper- worthy AI - Integrating Learning, Optimisation and Reasoning
ations on deep neural networks, implementation complexity of (TAILOR)(https://tailor-network.eu/),aprojectfundedbyEuro-
secureaggregation,andintractabilityofsecurebackpropagation peanUnionHorizon2020researchandinnovationprogramunder
throughnon-linearmechanismslikegraphattention.Thisrequires GrantAgreement952215.REFERENCES
onAutonomousAgentsandMultiagentSystems.InternationalFoundationfor
[1] 2021.IndonesiaProbesSuspectedDataBreachonCOVID-19App.Reuters(Aug. AutonomousAgentsandMultiagentSystems.
2021). [22] JosephCox.2019.T-Mobile‘PutMyLifeinDanger’SaysWomanStalkedWith
[2] AhmetAktay,ShaileshBavadekar,GwenCossoul,JohnDavis,DamienDes- BlackMarketLocationData.
fontaines,AlexFabrikant,EvgeniyGabrilovich,KrishnaGadepalli,BryantGip- [23] PeterSheridanDoddsandDuncanJ.Watts.2004.UniversalBehaviorinaGen-
son,MiguelGuevara,etal.2020.GoogleCOVID-19CommunityMobilityReports: eralizedModelofContagion.PhysicalReviewLetters92,21(May2004),218701.
AnonymizationProcessDescription(Version1.1).arXivpreprintarXiv:2004.04145 https://doi.org/10.1103/PhysRevLett.92.218701
(2020).arXiv:2004.04145 [24] JoelDyer,PatrickCannon,J.DoyneFarmer,andSebastianSchmon.2022.Black-
[3] PhilippAndelfinger.2021.DifferentiableAgent-BasedSimulationforGradient- BoxBayesianInferenceforEconomicAgent-BasedModels. https://doi.org/10.
GuidedSimulation-BasedOptimization.arXiv:2103.12476[cs,eess](March2021). 48550/arXiv.2202.00625arXiv:2202.00625[cs,econ,stat]
arXiv:2103.12476[cs,eess] [25] DimitrisFotakis,DimitrisPalyvos-Giannas,andStratisSkoulakis.2016.Opinion
[4] Gaurav Arya, Moritz Schauer, Frank Schäfer, and Chris Rackauckas. DynamicswithLocalInteractions..InIJCAI.279–285.
2022. Automatic Differentiation of Programs with Discrete Randomness. [26] EnriqueFrias-Martinez,GrahamWilliamson,andVanessaFrias-Martinez.2011.
arXiv:2210.08572[cs,math] AnAgent-BasedModelofEpidemicSpreadUsingHumanMobilityandSocial
[5] SamuelA.Assefa,DanialDervovic,MahmoudMahfouz,RobertE.Tillman, NetworkInformation.In2011IEEEThirdInternationalConferenceonPrivacy,
PrashantReddy,andManuelaVeloso.2021. GeneratingSyntheticDatainFi- Security,RiskandTrustand2011IEEEThirdInternationalConferenceonSocial
nance:Opportunities,ChallengesandPitfalls.InProceedingsoftheFirstACM Computing.IEEE,57–64.
InternationalConferenceonAIinFinance(ICAIF’20).AssociationforComputing [27] OdedGoldreich,SilvioMicali,andAviWigderson.2019. HowtoPlayAny
Machinery,NewYork,NY,USA,1–8. https://doi.org/10.1145/3383455.3422554 MentalGame,oraCompletenessTheoremforProtocolswithHonestMajority.
[6] RobertL.AxtellandJ.DoyneFarmer.[n.d.].Agent-BasedModelinginEconomics InProvidingSoundFoundationsforCryptography:OntheWorkofShafiGoldwasser
andFinance:Past,Present,andFuture.JournalofEconomicLiterature([n.d.]). andSilvioMicali.307–328.
https://doi.org/10.1257/jel.20221319 [28] ChangGong,OlegMilberg,BingWang,PaoloVicini,RajeshNarwal,Lorin
[7] JosephAylett-Bullock,CarolinaCuesta-Lazaro,ArnauQuera-Bofarull,Miguel Roskos,andAleksanderS.Popel.2017. AComputationalMultiscaleAgent-
Icaza-Lizaola,AidanSedgewick,HenryTruong,AoifeCurran,EdwardElliott, BasedModelforSimulatingSpatio-TemporalTumourImmuneResponsetoPD1
TristanCaulfield,KevinFong,IanVernon,JulianWilliams,RichardBower,and andPDL1Inhibition.JournalofTheRoyalSocietyInterface14,134(Sept.2017),
FrankKrauss.2021.June:Open-SourceIndividual-BasedEpidemiologySimula- 20170320. https://doi.org/10.1098/rsif.2017.0320
tion.RoyalSocietyOpenScience8,7(July2021),210506. https://doi.org/10.1098/ [29] Gov.uk. [n.d.]. List of Ethnic Groups. https://www.ethnicity-facts-
rsos.210506 figures.service.gov.uk/style-guide/ethnic-groups.
[8] AtilimGunesBaydin,BarakA.Pearlmutter,AlexeyAndreyevichRadul,and [30] JakobGrazzini,MatteoG.Richiardi,andMikeTsionas.2017.BayesianEstimation
JeffreyMarkSiskind.2018.AutomaticDifferentiationinMachineLearning:A ofAgent-BasedModels. JournalofEconomicDynamicsandControl77(April
Survey.JournalofMachineLearningResearch18,153(2018),1–43. 2017),26–47. https://doi.org/10.1016/j.jedc.2017.01.014
[9] DonaldBeaver.1992.EfficientMultipartyProtocolsUsingCircuitRandomization. [31] DanielGünther,MarcoHolz,BenjaminJudkewitz,HelenMöllering,BennyPinkas,
InAdvancesinCryptology—CRYPTO’91:Proceedings11.Springer,420–432. ThomasSchneider,andAjithSuresh.2022.Privacy-PreservingEpidemiological
[10] ClaudioBettini,SergioMascetti,XSeanWang,DarioFreni,andSushilJajodia. ModelingonMobileGraphs. arXiv:2206.00539[cs]
2009.AnonymityandHistorical-AnonymityinLocation-BasedServices.Privacy [32] CarmitHazayandYehudaLindell.2010. ANoteontheRelationbetweenthe
inlocation-basedapplications:researchissuesandemergingtrends(2009),1–30. DefinitionsofSecurityforSemi-HonestandMaliciousAdversaries.Cryptology
[11] ParantapaBhattacharya,JiangzhuoChen,StefanHoops,DustinMachi,Bryan ePrintArchive(2010).
Lewis,SrinivasanVenkatramanan,MandyLWilson,BrianKlahn,Aniruddha [33] RobertHinch,WilliamJ.M.Probert,AnelNurtay,MichelleKendall,Chris
Adiga,BenjaminHurt,etal.2023.Data-DrivenScalablePipelineUsingNational Wymant,MatthewHall,KatrinaLythgoe,AnaBulasCruz,LeleZhao,Andrea
Agent-BasedModelsforReal-TimePandemicResponseandDecisionSupport. Stewart,LucaFerretti,DanielMontero,JamesWarren,NicoleMather,Matthew
TheInternationalJournalofHighPerformanceComputingApplications37,1(2023), Abueg,NeoWu,OlivierLegat,KatieBentley,ThomasMead,KelvinVan-Vuuren,
4–27. DylanFeldner-Busztin,TommasoRistori,AnthonyFinkelstein,DavidG.Bonsall,
[12] EricBonabeau.2002.Agent-BasedModeling:MethodsandTechniquesforSimu- LucieAbeler-Dörner,andChristopheFraser.2021. OpenABM-Covid19—An
latingHumanSystems.ProceedingsoftheNationalAcademyofSciencesofthe Agent-BasedModelforNon-PharmaceuticalInterventionsagainstCOVID-19In-
UnitedStatesofAmerica99,10(2002),7280–7287. arXiv:3057854 cludingContactTracing.PLOSComputationalBiology17,7(July2021),e1009146.
[13] StanislavS.Borysov,JeppeRich,andFranciscoC.Pereira.2019.HowtoGenerate https://doi.org/10.1371/journal.pcbi.1009146
Micro-Agents?ADeepGenerativeModelingApproachtoPopulationSynthesis. [34] JohnH.HollandandJohnH.Miller.1991.ArtificialAdaptiveAgentsinEconomic
TransportationResearchPartC:EmergingTechnologies106(Sept.2019),73–97. Theory.TheAmericanEconomicReview81,2(1991),365–370. arXiv:2006886
https://doi.org/10.1016/j.trc.2019.07.006 [35] YixinJie,YixuanRen,QingtaoWang,YankaiXie,ChiZhang,LingboWei,and
[14] USCensusBureau.[n.d.].WhytheCensusBureauChoseDifferentialPrivacy. JianqingLiu.2022.Multi-PartySecureComputationwithIntelSGXforGraph
https://www.census.gov/library/publications/2023/decennial/c2020br-03.html. NeuralNetworks.InICC2022-IEEEInternationalConferenceonCommunications.
[15] AdrianCarro,MarcHinterschweiger,ArzuUluc,andJDoyneFarmer.2023. 528–533. https://doi.org/10.1109/ICC45855.2022.9839282
HeterogeneousEffectsandSpilloversofMacroprudentialPolicyinanAgent- [36] Bennett Cyphers and Jason Kelley. 2021. Illinois Bought In-
BasedModeloftheUKHousingMarket.IndustrialandCorporateChange32,2 vasive Phone Location Data From Banned Broker Safegraph.
(April2023),386–432. https://doi.org/10.1093/icc/dtac030 https://www.eff.org/deeplinks/2021/08/illinois-bought-invasive-phone-
[16] KevinChapuis,PatrickTaillandier,andAlexisDrogoul.2022. Generationof location-data-banned-broker-safegraph.
SyntheticPopulationsinSocialSimulations:AReviewofMethodsandPractices. [37] CliffC.Kerr,RobynM.Stuart,DinaMistry,RomeshG.Abeysuriya,Katherine
JournalofArtificialSocietiesandSocialSimulation25,2(2022),6. Rosenfeld,GregoryR.Hart,RafaelC.Núñez,JamieA.Cohen,PrashanthSel-
[17] AyushChopra.2022.DecisionMakingforPopulations.Ph.D.Dissertation.Mas- varaj,BrittanyHagedorn,LaurenGeorge,MichałJastrzębski,AmandaS.Izzo,
sachusettsInstituteofTechnology. GreerFowler,AnnaPalmer,DominicDelport,NickScott,SherrieL.Kelly,Car-
[18] AyushChopra,RameshRaskar,JayakumarSubramanian,BalajiKrishnamurthy, olineS.Bennette,BradleyG.Wagner,StewartT.Chang,AssafP.Oron,Ed-
EsmaSGel,SantiagoRomero-Brufau,KalyanSPasupathy,andThomasCKings- wardA.Wenger,JasminaPanovska-Griffiths,MichaelFamulare,andDanielJ.
ley.2021.DeepABM:ScalableandEfficientAgent-BasedSimulationsviaGeomet- Klein.2021.Covasim:AnAgent-BasedModelofCOVID-19DynamicsandIn-
ricLearningFrameworks-aCaseStudyforCOVID-19SpreadandInterventions. terventions. PLOSComputationalBiology17,7(July2021),e1009149. https:
In2021WinterSimulationConference(WSC).IEEE,1–12. //doi.org/10.1371/journal.pcbi.1009149
[19] AyushChopra,AlexanderRodríguez,JayakumarSubramanian,ArnauQuera- [38] KamleshKhunti,AwadheshKumarSingh,ManishPareek,andWasimHanif.
Bofarull,BalajiKrishnamurthy,B.AdityaPrakash,andRameshRaskar.2023. 2020.IsEthnicityLinkedtoIncidenceorOutcomesofCovid-19?BMJ369(April
DifferentiableAgent-basedEpidemiology.InProceedingsofthe2023International 2020),m1548. https://doi.org/10.1136/bmj.m1548
ConferenceonAutonomousAgentsandMultiagentSystems(AAMAS’23).Interna- [39] Jeremias Knoblauch, Jack Jewson, and Theodoros Damoulas. 2022. An
tionalFoundationforAutonomousAgentsandMultiagentSystems,Richland, Optimization-CentricViewonBayes’Rule:ReviewingandGeneralizingVaria-
SC,1848–1857. tionalInference.TheJournalofMachineLearningResearch23,1(2022),5789–5897.
[20] Abdoul-AhadChoupaniandAmirRezaMamdoohi.2016.PopulationSynthesis [40] YehudaLindell.2020.SecureMultipartyComputation(MPC).CryptologyePrint
UsingIterativeProportionalFitting(IPF):AReviewandFutureResearch.Trans- Archive(2020).
portationResearchProcedia17(Jan.2016),223–233. https://doi.org/10.1016/j. [41] YanirMarmor,AlexAbbey,YuvalShahar,andOsnatMokryn.2023.Assessing
trpro.2016.11.078 IndividualRiskandtheLatentTransmissionofCOVID-19inaPopulationwith
[21] AdamCoates,LiangxiuHan,andAnthonyKleerekoper.2018.AUnifiedFrame- anInteraction-DrivenTemporalModel.ScientificReports13,1(Aug.2023),12955.
workforOpinionDynamics.InProceedingsofthe17thInternationalConference https://doi.org/10.1038/s41598-023-39817-9[42] ChristopherA.Martin,DavidR.Jenkins,JatinderS.Minhas,LauraJ.Gray,Julian Review151(Jan.2023),104306. https://doi.org/10.1016/j.euroecorev.2022.104306
Tang,CarolineWilliams,ShirleySze,DanielPan,WilliamJones,RamanVerma, [51] ArnauQuera-Bofarull,AyushChopra,JosephAylett-Bullock,CarolinaCuesta-
ScottKnapp,RupertMajor,MelanieDavies,NigelBrunskill,MartinWiselka, Lazaro,AnisoaraCalinescu,RameshRaskar,andMichaelWooldridge.2023.Don’t
ChrisBrightling,KamleshKhunti,PranabHaldar,andManishPareek.2020.Socio- SimulateTwice:One-shotSensitivityAnalysesviaAutomaticDifferentiation.
DemographicHeterogeneityinthePrevalenceofCOVID-19duringLockdownIs InProceedingsofthe2023InternationalConferenceonAutonomousAgentsand
AssociatedwithEthnicityandHouseholdSize:ResultsfromanObservational MultiagentSystems(AAMAS’23).InternationalFoundationforAutonomous
CohortStudy.eClinicalMedicine25(Aug.2020). https://doi.org/10.1016/j.eclinm. AgentsandMultiagentSystems,Richland,SC,1867–1876.
2020.100466 [52] ArnauQuera-Bofarull,AyushChopra,AnisoaraCalinescu,MichaelWooldridge,
[43] ShakirMohamed,MihaelaRosca,MichaelFigurnov,andAndriyMnih.2020. andJoelDyer.2023.BayesianCalibrationofDifferentiableAgent-BasedModels.
MonteCarloGradientEstimationinMachineLearning. JournalofMachine arXivpreprintarXiv:2305.15340(2023).arXiv:2305.15340
LearningResearch21,132(2020),1–62. [53] ArnauQuera-Bofarull,JoelDyer,AnisoaraCalinescu,andMichaelWooldridge.
[44] AlexanderMordvintsev,EttoreRandazzo,andCraigFouts.2022. Growing 2023.SomeChallengesofCalibratingDifferentiableAgent-BasedModels. https:
IsotropicNeuralCellularAutomata. https://doi.org/10.48550/arXiv.2205.01681 //doi.org/10.48550/arXiv.2307.01085arXiv:2307.01085[cs,q-fin,stat]
arXiv:2205.01681[cs,q-bio] [54] SantiagoRomero-Brufau,AyushChopra,AlexJRyu,EsmaGel,RameshRaskar,
[45] VaikkunthMugunthan,AntigoniPolychroniadou,DavidByrd,andTuckerHy- WalterKremers,KarenSAnderson,JayakumarSubramanian,BalajiKrishna-
binetteBalch.[n.d.]. SMPAI:SecureMulti-PartyComputationforFederated murthy,AbhishekSingh,etal.2021.PublicHealthImpactofDelayingSecond
Learning.([n.d.]). DoseofBNT162b2ormRNA-1273Covid-19Vaccine:SimulationAgentBased
[46] KirillMüllerandKayW.Axhausen.2010.PopulationSynthesisforMicrosim- ModelingStudy.BMJ(Clinicalresearched.)373(2021).
ulation:StateoftheArt.ArbeitsberichteVerkehrs-undRaumplanung638(Aug. [55] LudgerRuschendorf.1995. ConvergenceoftheIterativeProportionalFitting
2010). https://doi.org/10.3929/ethz-a-006127782 Procedure.TheAnnalsofStatistics23,4(1995),1160–1174. arXiv:2242759
[47] MarcoPangallo,AlbertoAleta,R.MariadelRioChanona,AntonPichler,David [56] SongleiWang,YifengZheng,andXiaohuaJia.2023.SecGNN:Privacy-Preserving
Martín-Corral,MatteoChinazzi,FrançoisLafond,MarcoAjelli,EstebanMoro, GraphNeuralNetworkTrainingandInferenceasaCloudService.IEEETrans-
YamirMoreno,AlessandroVespignani,andJ.DoyneFarmer.2022.TheUnequal actionsonServicesComputing16,4(July2023),2923–2938. https://doi.org/10.
EffectsoftheHealth-EconomyTradeoffduringtheCOVID-19Pandemic. https: 1109/TSC.2023.3241615
//doi.org/10.48550/arXiv.2212.03567arXiv:2212.03567[physics,q-fin] [57] ZhiboWang,XiaoyiPang,YahongChen,HuajieShao,QianWang,LibingWu,
[48] GeorgePapamakarios,TheoPavlakou,andIainMurray.2017.MaskedAutoregres- HonglongChen,andHairongQi.2018. Privacy-PreservingCrowd-Sourced
siveFlowforDensityEstimation.InAdvancesinNeuralInformationProcessing StatisticalDataPublishingwithanUntrustedServer.IEEETransactionsonMobile
Systems,Vol.30.CurranAssociates,Inc. Computing18,6(2018),1356–1367.
[49] DonovanPlatt.2020.AComparisonofEconomicAgent-BasedModelCalibration [58] AndrewCYao.1982.ProtocolsforSecureComputations.In23rdAnnualSympo-
Methods.JournalofEconomicDynamicsandControl113(April2020),103859. siumonFoundationsofComputerScience(Sfcs1982).IEEE,160–164.
https://doi.org/10.1016/j.jedc.2020.103859 [59] ShuliZhou,SuhongZhou,ZhongZheng,andJunwenLu.2021.OptimizingSpatial
[50] SebastianPoledna,MichaelGregorMiess,CarsHommes,andKatrinRabitsch. AllocationofCOVID-19VaccinebyAgent-BasedSpatiotemporalSimulations.
2023.EconomicForecastingwithanAgent-BasedModel.EuropeanEconomic GeoHealth5,6(2021),e2021GH000427. https://doi.org/10.1029/2021GH000427
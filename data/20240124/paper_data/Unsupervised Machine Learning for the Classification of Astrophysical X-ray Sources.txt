MNRAS000,1–21(2022) Preprint23January2024 CompiledusingMNRASLATEXstylefilev3.0
Unsupervised Machine Learning for the Classification of Astrophysical
X-ray Sources
VíctorSamuelPérez-Díaz1,2★ ,JuanRafaelMartínez-Galarza1,AlexanderCaicedo3,4
and
RaffaeleD’Abrusco1
1CenterforAstrophysics|Harvard&Smithsonian,60GardenStreet,Cambridge,MA02138,USA
2SchoolofEngineering,ScienceandTechnology,UniversidaddelRosario,Cll.12CNo.6-25,Bogotá,Colombia
3DepartmentofElectronicsEngineering,PontificiaUniversidadJaveriana,Cra.7No.40-62,Bogotá,Colombia
4Ressolve,Cra.42#5Sur-145,Medellín,Colombia
AcceptedXXX.ReceivedYYY;inoriginalformZZZ
ABSTRACT
The automatic classification of X-ray detections is a necessary step in extracting astrophysical information from compiled
catalogsofastrophysicalsources.Classificationisusefulforthestudyofindividualobjects,statisticsforpopulationstudies,as
wellasforanomalydetection,i.e.,theidentificationofnewunexploredphenomena,includingtransientsandspectrallyextreme
sources. Despite the importance of this task, classification remains challenging in X-ray astronomy due to the lack of optical
counterparts and representative training sets. We develop an alternative methodology that employs an unsupervised machine
learningapproachtoprovideprobabilisticclassestoChandraSourceCatalogsourceswithalimitednumberoflabeledsources,
and without ancillary information from optical and infrared catalogs. We provide a catalog of probabilistic classes for 8,756
sources, comprising a total of 14,507 detections, and demonstrate the success of the method at identifying emission from
young stellar objects, as well as distinguishing between small-scale and large-scale compact accretors with a significant level
ofconfidence.Weinvestigatetheconsistencybetweenthedistributionoffeaturesamongclassifiedobjectsandwell-established
astrophysicalhypothesessuchastheunifiedAGNmodel.Thisprovidesinterpretabilitytotheprobabilisticclassifier.Codeand
tables are available publicly through GitHub. We provide a web playground for readers to explore our final classification at
https://umlcaxs-playground.streamlit.app.
Keywords: methods:statistical–methods:dataanalysis–catalogues–X-rays:binaries–galaxies:active–X-rays:stars
1 INTRODUCTION fied.AsoneofNASA’sGreatObservatories,Chandrahascontributed
tonumerousgroundbreakingdiscoveriesinhigh-energyastrophysics
X-rayastronomyisembarkingonapromisingerafordiscovery,fa-
over its 23-year lifespan. The Chandra Source Catalog (CSC) col-
cilitatedbycutting-edgemissionslikeeROSITA.Thismission,which
lectstheX-raysourcesdetectedbytheChandraX-rayObservatory
scanstheentireX-raysky,hasalreadymadeitsinitialdatarelease
throughitshistory(Evansetal.2010).Itrepresentsafertileback-
accessibletothescientificcommunity(Predehletal.2021;Merloni
groundfordiscovery,sincemanyofthissourceshavenotbeenstud-
et al. 2012). Prospective missions such as Athena and Lynx offer
iedindetail.Asignificantproportionofthesesources,whichrange
enhancedcapabilities.Specifically,Athenacombinesthesensitivity
fromyoungstellarobjects(YSO)andbinarysystems(XB)todistant
ofChandrawiththeexpansivecoverageareaofeROSITA(Nandra
active galaxies housing supermassive black holes (AGN), remain
etal.2013).Meanwhile,LynxplanstosurpassChandraintermsof
largelyunexplored.Furthermore,Chandra’sdatacontainstracesof
sensitivityandresolution(Gaskinetal.2019).Thesemissionswill
exceptionalphenomenalikeextrasolarplanettransits,tidaldisruption
provideawealthofnewdataanddetections,catalyzingtheidentifi-
events,andcompactobjectmergers.Despitethepotentialscientific
cationofpreviouslyunrecognizedsources.
wealthwithinChandra’sdata,onlyafractionofCSCsourceshave
TheChandraX-rayObservatoryisoneoftheNASA’sgreatob-
beenclassified.InordertoconductathoroughinvestigationofCSC
servatories and its flagship mission for X-ray astronomy. Since it
sources, and to gear up for forthcoming large-scale X-ray surveys,
waslaunchedtospacein1999,thetelescopehasobservedseveral
weneedtoclassifyasmanycatalogsourcesaspossible.
sources with two instruments, the Advanced CCD Imaging Spec-
trometer(ACIS)andtheHighResolutionCamera(HRC)(Wilkes& Aslargerastronomicalsurveysbecomeavailable,researchersare
Tucker2019).Accretingblackholesinthecenterofgalaxies,super- increasinglyadoptingmoresophisticatedstatisticalmodels,includ-
novaremnants,X-raybinaries,andyoung,rapidlyrotatingmagnetic ing machine learning and data science methods, for classification
starsaresomeofthemostcommontargetsthatChandrahasidenti- tasks.Acomparisonofvarioussupervisedandunsupervisedlearn-
ingmethodsforthestatisticalidentificationofXMM-Newtonsources
waspresentedinPineauetal.(2010).Thisstudyemployedaproba-
★ E-mail:samuelperez.di@gmail.com bilisticcross-correlationoftheXMM-NewtonSerendipitousSource
©2022TheAuthors
4202
naJ
22
]MI.hp-ortsa[
1v30221.1042:viXra2 Pérez-Díazetal.
Catalog (2XMMi) with catalogs such as Sloan Digital Sky Sur- classificationforanumerousamountofsources.Furthermore,weof-
vey(SDSS)DR7andTwoMicronAll-SkySurvey(2MASS).They fernotonlyaclassification,butalsoacomprehensivediscussionon
comparedalgorithmslikek-NearestNeighbors,MeanShifts,Kernel theastrophysicalimplicationsarisingfromtheobservationsmadeat
DensityClassification,LearningVectorQuantization,andSupport eachstageofthepipeline.Weevaluatethestrenghtsandlimitations
VectorMachines. ofthemethod.
In Lo et al. (2014), an automatic classification method for vari- InSection2,wedescribetheprimarydatasetusedinthiswork,
ableX-raysourcesin2XMMi-DR2usingRandomForestwaspre- theChandraSourceCatalog,detailingthequeryandpreprocessing
sented.Theauthorsachievedapproximately97%accuracyfora7- stepsrequiredtomakethedatasuitableforanalysiswithunsupervised
classdataset.InFarrelletal.(2015),acatalogofvariablesourcesin learningmethods.Wealsodiscussthefeatureselectionprocessand
3XMMwasclassifiedusingRandomForest,trainingtheclassifieron finalpropertiesused.InSection3,weexplainthemethodsemployed,
manuallyclassifiedvariablestarsfrom2XMMi-DR2andobtaining includingGaussianMixturesandthedevelopmentofaprobabilistic
approximately92%accuracy. classificationalgorithmbasedontheMahalanobisDistance.Wealso
Asinterestinthisresearchfieldcontinuestogrow,unsupervised introduce Soft/Hard voting classifiers that were used for the final
learningtechniqueshavegainedprominenceinrecentyears.InRos- outputofthisstudy.Thissectionincludesanoverviewofthetech-
tamiOsanlooetal.(2019),anautomatedmachinelearningtoolfor niques,adetailedexplanationofthealgorithms,relevantparameter
classifyingextra-galacticX-raysourcesusingmulti-wavelengthdata, choices,andavalidationapproachforthemethod.InSection4,we
particularly from the Hubble Space Telescope, was proposed. In provideacomprehensiveexplorationofresultsforeachstepoftheal-
Ansari,Zoeetal.(2021),aprobabilisticassignmentwasperformed gorithm.Wereportper-detectionclassifications,finalmasterclasses
usingmixturedensitynetworks(MDN)andinfiniteGaussianmix- for8,756sources,andsignificanttrendsorpatternsobservedduring
ture models to classify objects in the dataset as stars, galaxies, or theanalysis.InSection5,wediscusstheimplicationsofourresults,
quasars,achievinga94%accuratesplit.Thetrainingdataconsisted includingcomparisonswithpreviousworkandcatalogs.Weanalyze
ofmagnitudesfromSDSSDR15andtheWide-fieldInfraredSurvey theastrophysicalnaturerevealedbythedataandevaluatethepossible
Explorer(WISE). limitationsofourstudy,addressingpotentialbiasesandsourcesof
In the same line, in Logan, C. H. A. & Fotopoulou, S. (2020), uncertainty.Wealsosuggestdirectionsforfutureresearch.Finally,in
analternativeunsupervisedmachinelearningmethodforseparating Section6,wesummarizetheconclusionsofthework,highlighting
stars,galaxies,andQSOsusingphotometricdatawaspresented.This themainoutcomesandtheirrelevance.
approachemployedHierarchicalDensity-BasedSpatialClusteringof
Applications with Noise (HDBSCAN) to identify different classes
in a multidimensional color space. Using a constructed dataset of
approximately50,000spectroscopicallylabeledobjects,theauthors
2 DATA
achievedF1scoresof>0.92forstar,galaxy,andQSOclasses.
Inrecentyears,significanteffortshavebeenmadetoimprovethe In this section, we describe the data set used in the work at hand,
classification of X-ray sources using supervised machine learning andthepropertieschosenforthesubsequentanalysis.Ourmaindata
methods. Notably, Yang et al. (2022) developed a novel approach consistsofChandraSourceCatalogversion2per-detectionregisters.
for classifying CSC version 2 (CSC2) sources. They successfully
classified66369CSC2sources(21%oftheentirecatalog)andper-
formed focused case studies, demonstrating the versatility of their
2.1 TheChandraSourceCatalog
machinelearningapproach.Additionally,theyprovidedinsightsinto
thebiases,limitations,andbottlenecksencounteredinthesetypesof The Chandra Source Catalog (CSC) collects and presents summa-
studies.Similarly,Kumaranetal.(2023)aimedtoclassifypointX- rizedpropertiesfortheX-raysourcesdetectedbytheChandraX-ray
raysourcesintheChandraSourceCatalog2.0intocategoriessuch Observatorythroughitshistory.Version2.0(CSC2),whichweuse
as active galactic nuclei (AGN), X-ray emitting stars, young stel- here,isthesecondmajorreleaseofthecatalog,includingproperties
larobjects (YSOs),high-mass X-raybinaries (HMXBs),low-mass for317167X-raysourcesinthesky.Propertiesincludesourcepho-
X-raybinaries(LMXBs),ultra-luminousX-raysources(ULXs),cat- tometry(brightness),spectroscopy(energy),andvariability(change
aclysmicvariables(CVs),andpulsars.Usingmulti-wavelengthfea- overtime).
tures from various catalogs, including CSC2, they used the Light The Chandra Source Catalog includes properties for 928280
GradientBoostedMachinealgorithmandachievedscoresof≥91% source detections, which were detected in 10382 Chandra obser-
inprecision,recall,andMatthew’sCorrelationcoefficient. vationsuntil2014.Thecatalogpresentsinformationthrough1700
Despite the recent efforts, supervised classification of X-ray columnsoftabulardata,distributedacrossfiveenergybands(broad,
sources remains a complex endeavor. Building a reliably labeled hard,medium,soft,andultra-soft)fortheAdvancedCCDImaging
trainingsetofteninvolvesmanualreviewoftheexistingliterature, Spectrometer (ACIS), and a single band for the High Resolution
whichcansometimescontainambiguousresults.Moreover,alarge Camera(HRC)inthewidespectrum.Chandrahasbeenobserving
number of these sources are missing optical or infrared data that the universe in the 0.5-8 KeV band (Wilkes & Tucker 2019). The
could provide additional insights into their physical nature. Thus, mastersourcepropertiespresentsummarymeasurementsofstacked
unsupervisedlearningoffersadistinctadvantageasiteliminatesthe detections.Propertiesfordetectedsourcesaremeasuredforboththe
needforapre-labeledtrainingset.Itcanalsorevealhiddenpatterns stackeddetectionandtheindividualobservationsinallofthebands
inthedatathatmaynotbeimmediatelyapparent.Inthisstudy,we (Wilkes&Tucker2019).
introduceanunsupervisedlearningapproachdesignedtoclassifyas Thisstudyutilizestheindividualpropertiesmeasuredfordetec-
manyCSCsourcesaspossible,leveragingsolelyavailableX-raydata. tionsintheChandraSourceCatalog.Ourinitialclassificationisper-
Byclusteringthesourceobservationsbytheirsimilarities,andthen formedonaper-observationbasis,beforeweevaluatethemostprob-
associatingtheseclusterswithobjectspreviouslyclassifiedspectro- ableclassforeachmastersource.Thisapproachtakesintoaccount
scopically,weproposeanewmethodologytoprovideprobabilistic thatCSCsourcesmayhavemultipledetections.AsubsetoftheCSC2
MNRAS000,1–21(2022)UnsupervisedMachineLearning 3
Table1.Propertiesselectedforouranalysis.Propertiesdenotedwith’_*’ Table2.Preprocessingapproachforeachproperty.Energybandsaredenoted
representthreefeaturesforenergybands:b(broad),h(hard),s(soft).Adapted by*=b,h,s(broad,hard,andsoft).
fromCSCdocumentationwebpage.
propertyname log normalization
propertyname description hard_hm
hard_hm ACIShard(2.0-7.0keV)-medium(1.2-2.0keV)energy hard_hs
bandhardnessratio-basicallytheratiobetweenthehard hard_ms
andmediumenergybands bb_kt • •
hard_hs ACIShard(2.0-7.0keV)-soft(0.5-1.2keV)energyband powlaw_gamma •
hardnessratio-basicallytheratiobetweenthehardand var_prob_*
softenergybands var_ratio_* • •
hard_ms ACISmedium(1.2-2.0keV)-soft(0.5-1.2keV)energy var_newq_b • •
band hardness ratio - basically the ratio between the
mediumandsoftenergybands
and normalization, depending on the distribution and range of the
bb_kt temperature(kT)ofthebestfittingabsorbedblackbody
modelspectrumtothesourceregionaperturePIspec- selected properties. Feature preprocessing was tailored to achieve
trum-temperatureoftheobjectestimatedbyablack scaleuniformity,preventinglarge-scalefeatures,likeoutliers,from
bodymodel. dominatingthelearningprocessandfacilitatingfasterconvergence.
powlaw_gamma photon index of the best fitting absorbed power-law Detailsofthechosenprocessingapproachforeachpropertyarepre-
modelspectrumtothesourceregionaperture sentedinTable2.Whenrequired,thelogtransformationisperformed
var_prob_* intra-observationGregory-Loredovariabilityprobabil- priortonormalization,feedingitsresultintothenormalizationpro-
ity (highest value across all stacked observations) for cess.
eachscienceenergyband-variabilityprobabilityina
singleobservationwithGregory-Loredotechnique.
var_ratio_* theratiooffluxvariabilitymeanvaluetoitsstandard 2.2.1 Normalization
deviation
var_mean_* We employ the MinMaxScaler method from the scikit-learn
var_sigma_* Python library (Pedregosa et al. 2011) for data normalization. Us-
ing this, we scale each selected feature to the range [0,1] based
var_newq_b proportionoftheaverageofminimumandmaximum on its minimum and maximum values. The transformation can be
countrates(i.e.,datapointsinthelightcurve)duringan representedas:
observationrelativetothemeancountrate.
var_max_b+var_min_b
X−X
2·var_mean_b X𝑠𝑐𝑎𝑙𝑒𝑑 = min . (1)
Xmax−X
min
Inequation1,Xdenotestheoriginalfeaturevalues,whileX and
min
per-observationdetectiontablewasextractedusingCSCView1,with Xmaxrepresenttheminimumandmaximumvaluesofthefeature,re-
selectioncriteriarestrictingsourcedetectionstothosewithabroad spectively.TheresultingX𝑠𝑐𝑎𝑙𝑒𝑑maintainstherelativerelationships
bandfluxsignificancegreaterthan5(flux_significance_b>5), betweentheoriginalvalues.
and non-null values for power-law gamma (powlaw_gamma) and
blackbodytemperature(bb_kt).Thesecriteriaaimedtoensureob-
2.2.2 Logtransformation
servationspossessedsufficientsignificancetoallowforfittingtheir
spectratoamodel,therebyenablingtheextractionofstatisticalrela- We apply a natural logarithm to each data point using the numpy
tionshipsfromthedata.Thisprocessyieldedatableof37878unique library(Harrisetal.2020).Tohandlezerovalues,weaddone-tenth
observationalentries. ofthenon-zerominimumvalueofeachpropertytothedatabefore
takingthelogarithm:
2.2 Propertiesandpreprocessing
𝑋∗ =min{𝑥
𝑖
∈X|𝑥
𝑖
≠0,𝑖=1,...,𝑛}
In this subsection, we discuss the properties used in our analy- min
(cid:18) 𝑋∗ (cid:19) (2)
sis. We also outline the preprocessing steps applied to the dataset. X =log X+ min
log
These steps include data cleaning, transformation, and normaliza- 10
tion.Weconductedaniterativeexplorationprocessforfeatureselec- In the equations above, 𝑋∗ represents the minimum non-zero
tion.Weselected12properties,primarilyinvolvingvariabilityand min
valueinthefeaturevaluesX.Thelog-transformedpropertyisrepre-
spectralmeasurements.Mostpropertiesareextracteddirectlyfrom
sentedbyX .
log
theper-observationleveloftheCSC,exceptforvar_ratio_*and
var_newq_b.Thesewerecomputedbyustosummarizesourcein-
formationfromvariabilitymean,standarddeviation,minandmax. 2.3 Featureselection
Table1liststhechosenpropertiesandtheirdescriptions.
The efficacy of our proposed algorithm relies significantly on the
Ourinitialstepwastocleansetheoriginaldata,selectingrowswith
selectionofCSCpropertiesusedasfeatures.Featureselectioninun-
validentries(notNaN)forthechosenproperties.Thisreducedthe
supervisedmachinelearningisanactivefieldofresearch(Solorio-
datasetto29655rows.Followingthis,wecarriedouteithernormal-
Fernández et al. 2020). For this study, we prioritized features that
ization exclusively or a combination of logarithmic transformation
enhance information gain, i.e, those that maximize the separation
betweenclusters.Whiledimensionalityreductiontechniquesareof-
1 http://cda.cfa.harvard.edu/cscview/ tenusedinfeatureselection,wechosetofollowadifferentcriteria
MNRAS000,1–21(2022)4 Pérez-Díazetal.
to prioritize interpretability. Additionally, feature scales vary sig- TheGaussiandistributionsN(x|µ𝑘,𝚺𝑘)thatcomposethemixture
nificantly, adding complexity to the task. Selected CSC properties arecalledcomponents,eachhavingitsowncovariance𝚺𝑘andmean
aredescribedinTable1,andtheywerechosenusingthefollowing µ𝑘. We use maximum likelihood estimation in order to adjust the
criteria: parametersofthemixtureofGaussianstooptimallyrepresentclusters
inthedata.From3,theloglikelihoodfunctionisgivenby
(i) Westartfromastrophysicaldomainknowledge.Featuresthat
aremorelikelytoinformtheclassificationarethoserelatedwiththe
𝑁 𝐾
spectralandtime-domainproperties,becausetheyareassociatedto ∑︁ ∑︁
ln𝑝(X |π,µ,𝚺)= ln 𝜋 𝑘N(x|µ𝑘,𝚺𝑘). (5)
specificastrophysicalprocesses(e.g.accretion).
𝑛=1 𝑘=1
(ii) Besidesusingastrophysicallysignificantfeatures,wealsoem-
ployanempiricalstrategy.Here,weevaluatefeatureimportanceby InthecaseofasingleGaussiandistribution,ananalyticalsolution
the degree to which a given set of features yields distinct clusters. for the maximum likelihood can be obtained easily. Indeed, in the
Wedothisbyobservinghowthepropertiesdistributeineachcluster simplestcase(onedimensional)itcorrespondstothemeanandvari-
forvariousfeatureselectionsandcombinations. anceofthedata.However,maximizingthelikelihoodofaGaussian
(iii) Then,wechoosepropertiesbasedonmaximizingtheamount Mixtureisnotaneasytask,lackingaclosed-formanalyticalsolution.
ofinformationinclusterswhilesimultaneouslyminimizingredun- Abroadlyapplicablemethodsolution,whichweusedinthispaper,
dancies.Byminimizingredundancy,wecanreducethenumberof istheexpectation-maximizationalgorithm,alsoabbreviatedasEM
featuresrequiredtoaccuratelyclassifysources,whichmayleadto algorithm.
simplerandmoreinterpretablemodels.Atthesametime,maximiz- TheEMalgorithmisamethodforestimatingtheparametersthat
ing the amount of information in clusters ensures that the clusters maximize the likelihood in unobserved latent variable dependent
formed are distinct and informative. This approach addresses the models. In this case, the latent variable is the cluster assignment
challengeofdeterminingtheoptimalnumberofastrophysicalx-ray of each data point. The EM algorithm was initially proposed in
properties required for accurate source classification, and provides Dempsteretal.(1977).Acompletereviewofthemethodcouldbe
insightsintothemostimportantpropertiesfordistinguishingbetween foundinMcLachlan&Krishnan(2007).
differentsourcetypes. The EM algorithm consist of two main states, as the name sug-
gests:theexpectation(E)stepandthemaximization(M)step.The
initialparametersoftheGaussianMixturecouldbechosenindif-
ferentapproaches.Themostcommononewoulduserandominitial
3 METHODS parameters.However,amoreconvenientroutineistoassumeidentity
covariancesintheGaussiansandperformK-meansclusteringtofind
Inthissectionwepresenttheunsupervisedlearningandcluster-wise
the means. A summary of the EM algorithm steps is described in
classificationtechniquesemployedinouranalysis.WeuseGaussian
onlineAppendixA.
MixturesModels(GMMs),whichallowdatasetclusteringbasedon
We have provided a general description of the GMM and the
themulti-dimensionaldistributionofdatapoints.Inthisstudy,se-
EM algorithm.Forthemathematicaldetails,wereferthereaderto
lectedCSCcolumnpropertiesserveasthefeaturesforouranalysis.
Bishop (2006); Deisenroth et al. (2020). An analysis of how the
WefirstrunaGMMonthosefeaturestofindinitialclusters.Wethen
log-likelihood increases in each of the steps of the EM routine is
cross-matchourCSCsourceswiththeSIMBADdatabaseinorder
presentedinNeal&Hinton(1998).
to extract any existing labels assigned to the observations. We as-
Inthiswork,weusetheGMMarchitectureprovidedinthescikit-
signprobabilisticclassestoeachunlabelledobservationinsideeach
learnlibrary(Pedregosaetal.2011)forPython.Thereisnodirect
group.Theassignmentisaccomplishedbyexaminingthedistance
evidencesupportingtheassumptionthatourdatacomefromamix-
betweentheunlabelledobservationandthecentroidsoflabeledob-
ture of gaussians. However, GMM is a flexible method capable of
servations(extractedfromSIMBAD)thatsharethesameclasswithin
producingreliableresultsevenwhenthisassumptionisnotstrictly
thecluster.Basedonthedetectionclassifications,weassignafinal
met.Weexpectthisminimizestheimpactofthepossiblemorecom-
classtothemastersource.Thenextsubsectionsofferamoredetailed
plexdistributionspresentinthedata.TheGaussianMixtureserves
accountofeachstepinthisalgorithm.
asafoundationalstepinourclassificationprocess.Throughoutour
analysis,componentsandclusterswillmeanthesame.Theselection
3.1 GaussianMixtureModelsandtheEMalgorithm ofhyperparametersforourstudyisexplainedinSection3.3.
ClustersarefirstidentifiedusingaGaussianMixtureModel(GMM)
in the multi-dimensional space of the chosen CSC properties. In 3.2 Cluster-wiseclassificationalgorithm
ordertounderstandtheassumptionsandlimitationsofthismethod,
3.2.1 Per-detectionclassification
wefirsthavetodescribethebasicsofitsfunctionalityasaclustering
technique.AGaussianMixturerepresentsalinearcombinationof𝐾 The initial clustering serves as a preliminary step towards classi-
differentGaussiandistributions(Bishop2006) fication. Given the complexity of astrophysical classes, they likely
exceedtheoptimalnumberofclusterswewillderive.Thiscanbe
partly attributed to the potential overlap of various astrophysical
𝐾
𝑝(x)=∑︁ 𝜋 𝑘N(x|µ𝑘,𝚺𝑘) (3) classeswithinthefeaturespace,particularlywhenrelyingsolelyon
X-raydata.Consequently,asingleclustermayencompassobjectsof
𝑘=1
multipleclasses.However,itisexpectedthatobjectdetectionswithin
where𝜋 𝑘 arethemixturecoefficientsormixtureweights,and thesameclusterwillexhibitsimilarproperties.
The SIMBAD Astronomical Database, operated at CDS, Stras-
0≤𝜋 𝑘 ≤1, ∑︁ 𝜋 𝑘 =1. (4) bourg,France,(Wengeretal.2000)providesarelativelysolidknowl-
𝑘 edge base source for a systematic class extraction (Oberto et al.
MNRAS000,1–21(2022)UnsupervisedMachineLearning 5
2020a) 2. SIMBAD employs a hierarchical system for classifying forasource,denotedby 𝑑 1,𝑑 2,...,𝑑 𝑁.Foreachdetection 𝑑 𝑖,let
objects,whichreliesoncatalogueidentifiers.SIMBADprovidesa 𝐶 𝑖 bethesetofpossibleclassificationsthatitcanreceive.Then,we
baseforassociatingprobabilisticclasssestounclassifiedobjectde- can define a collection of sets 𝐶 1,𝐶 2,...,𝐶 𝑁, where each set 𝐶 𝑖
tections.Initially,wecross-matchourdatasetwithclassifiedobjects correspondstothepossibleclassificationsfordetection𝑑 𝑖.Thus,the
intheSIMBADdatabase,leadingtoaminorityofclassifiedobjects relationissummarizedas
percluster.Wethencomputethedistancebetweeneachunclassified
𝑑 𝑖 →𝑃(𝐶 𝑖)
object and the classes centroid within the cluster. These distances
facilitateprobabilisticassignment,providinganindicationofthede- where𝑃(𝐶 𝑖) representstheprobabilitythatdetection𝑑 𝑖 belongsto
tection’slikelihoodofbelongingtoagivenclass. eachpossibleclassificationintheset𝐶 𝑖.Thisformalismrepresents
The crossmatch was performed using the CDS Upload X-Match classifications at the per-detection level, treating each detection as
functionalityofTOPCAT(Taylor2005),whichisaninterfaceforthe anindividualtargettoclassify.Werefinethisprocesstoproducea
crossmatchserviceprovidedbyCDS,Strasbourg.Thematchradius singleclassificationforeachsource.
wassetto≤1′′ andtheFindmodewassettoEachtoobtainanew
tablewiththebestmatchfromtheSIMBADdatabase,ifany,within
theselectedradius.Intheabsenceofamatch,theSIMBADcolumns 3.2.2 Sourcemasterclass
in the table would be blank. We specifically looked for the otype
AfractionofthesourcesintheCSChavebeenobservedmorethan
property,whichreferstothemainobjecttypeassignedtothesources
onceduringthelifetimeofChandra.Asourcewithmultipledetec-
(Oberto et al. 2020b). It is expected that a significant number of
tions will appear more than once in the catalog. The classification
sourceswouldnothaveamatchingentryintheSIMBADdatabase
scheme that we have described so far operates on individual de-
or may have an ambiguous otype classification, such as peculiar
tections,whichimpliesthatsourceswithmultipleobservationsget
emitters(Radio,IR,Red,Blue,UV,X,orgamma),assignedwhen
multipleclassifications.Whileyouexpectclassificationsofthesame
nofurtherinformationisavailableaboutthenatureofthesource.
sourcetoagree,thisisnotalwaysthecase,sincedetectionscandiffer
We performed the classification of sources using the extracted
intheirproperties.Wethereforerequireaproceduretoprovidemas-
labels and cluster information. To achieve this, we measured the
terclassificationofsources,thattakesintoaccounttheinformation
similaritybetweentheunlabeledandthelabeledobservationswithin
fromthemultipledetectionclassifications.
aclusterusingtheMahalanobisdistancemetric.
Toobtainthemasterclassforagivensource,weusetwodifferent
TheMahalanobisDistancewasintroducedinMahalanobis(1936),
approaches:softvotingandhardvotingclassifiers.Inthehardvoting
asadistancemetricofapointandadistribution.Itisdefinedas:
approach,alsoknownasmajorityvoting,wesimplychoosethemost
commonclassificationamongthedifferentdetectionsofasource.In
√︃
𝐷 𝑃(x)= (x−µ)𝑇Σ−1(x−µ), (6) thesoft votingapproach,weprofitfromtheprobabilisticnatureof
theclassification:foreachdetectionofasource,weweighteachclass
whereµandΣarethemeanandcovariancematrixofaprobability accordingtotheirprobability,andthenaverageoveralldetectionsin
distribution𝑃respectively,andxisadatapoint.
ordertogettheclasswiththehighestmeanprobability.Bothsoftand
WechosetousetheMahalanobisdistanceasourmetricforanaly- hardvotinghavebeenwidelyusedinensemblemethodsofmachine
sisbecauseittakesintoconsiderationthedistributionsofeachclass learning(Zhou2012).
groupwithineachcluster.Thisfeatureallowsustocalculatethedis- Wethenarrangetheresultsintwotables:atableofuniquelyclas-
tanceofasourcedetectionwithoutalabelwithrespecttoeachclass sifiedsources,andatableofambiguoussourcesthatyielddifferent
groupintheclusterbasedontheshapesoftheirdistributions.The classificationswiththetwodifferentmethods.
computationiscarriedoutusingEquation6. Toformalizetheprocessofobtainingthemasterclassforagiven
Aftermeasuringthedistanceofapoint𝑥toallclassesinacluster
source,weintroducethefollowingmathematicalnotation.
space, we apply the softmin function to convert the distances to Let𝑆beasource,andletD𝑆bethesetofalldetectionsassociated
a probability distribution. The softmin is a variation of the well with𝑆.ThehardvotingclassifierassignstheclassC𝑆 thatappears
knownsoftmaxfunction(Goodfellowetal.2016),anditisdefined mostfrequentlyamongthedetectionsinD𝑆.Thatis,
as:
∑︁
C𝑆 =argmax𝑐∈𝐶 [𝑑→𝑐],
exp(−𝑥 𝑛)
𝑑∈D𝑆
softmin(𝑥 𝑛)=
(cid:205)𝑁
𝑗
exp(−𝑥
𝑗). (7)
where𝐶 isthesetofallpossibleclassifications,and [𝑑 →𝑐] isan
indicatorfunctionthatequals1ifdetection𝑑wasclassifiedas𝑐,and
where 𝑥 𝑛 is a real number in a vector x = {𝑥 1,...,𝑥 𝑁}. 0otherwise.
softmin(𝑥 𝑛) is equivalent to softmax(−𝑥 𝑛). After applying this Wehavethat𝐶 𝑖isthesetofallpossibleclassificationsfordetection
function to a vector, every element will be in the range [0,1] and 𝑑 𝑖 ∈ D𝑆.Foreachdetection 𝑑 𝑖,let 𝑃 𝑐(𝐶 𝑖) betheprobabilitythat
(cid:205) 𝑛𝑁 softmin(𝑥 𝑛) = 1.Weapplythesoftminfunctionforallun- 𝑑 𝑖 belongs to class 𝑐 in 𝐶 𝑖. We can then compute the soft voting
labeledpointsinallclusters,resultinginsmallerdistancesyielding approach. We calculate the mean probability for each class 𝑐 in𝐶
largerprobabilities.Thefinaloutcomeisatableofsourcedetections acrossalldetections,i.e.,
withadistributionofprobabilitiesoverclasses.
c ree
siI
v
et nei ts
m
eduw
l
mo tir apt th
l he
eh
p
mi rg
o
ah
b
til
a
cig
b
ah
i ll
lt
i
yi sn
t
aig
c
st
c
fh olaa llst
os
wa
ifi
ss
c
.i an Stg
i
uol pe
n ps
os .o
sT
eu hr wic se epd hroe
ac
vte
e
ec st
s
𝑁io cn
dan
em teba cey
tir
oer npe s--
𝐶
𝑆
=argmax𝑐∈𝐶𝑁1
𝑖
∑︁𝑁𝑖
𝑃 𝑐(𝐶 𝑖),
𝑖=1
where𝑁 𝑖 =|𝐶 𝑖|.
2 Object types (otypes) description URL: https://simbad.astro. Thefullclassificationprocedurethatwehavedescribedherewill
unistra.fr/guide/otypes.htx be applied to the pre-processed CSC dataset, and their properties.
MNRAS000,1–21(2022)6 Pérez-Díazetal.
ResultsofthisprocessarepresentedinSection4.Asummaryofour
fullpipelineispresentedinAlgorithm1.
BIC =−2log(𝐿ˆ)+log(𝑁)𝑑 (8)
where𝐿ˆisthemaximumlikelihoodofthemodel,𝑑arethedegrees
offreedomornumberofparametersestimatedbythemodel,and𝑁is
A.GaussianMixtureModelandClassExtraction
thenumberofsamplesordatapoints.TheBICmeasureshowmuch
1.Clusteringstep:Assignaclustertoalldatapointsusinga varianceinthedataisexplainedbytheincorporationofadditional
GaussianMixtureModel. components.Additionalcomponentscanhelpincreasethelikelihood,
2.Crossmatchstep:Crossmatchdatawithotherdatabases butbeyondacertaincomplexitynoadditionalinformationisgained,
(inthiscase,SIMBAD)toextractclassesforalldatapoints, as we are overfitting. The BIC balances the goodness of fit of the
ifavailable. modelwiththenumberofparameters.Asthenumberofcomponents
in a GMM increases, the fit to the data improves, but the number
of parameters also increases, leading to a more complex model.
B.Cluster-wiseclassificationalgorithm
Theoptimalnumberofcomponentsistheonethatprovidesagood
1.Distancestep:Foradatapoint(detection)𝑑 𝑖,computethe balancebetweenthefittothedataandthemodelcomplexity.
Mahalanobisdistancetoallpossibleclasses.Storethemas UsuallyalowerBICispreferred.However,BICdecreasesasthe
numberofcomponentsincreases,suggestingthatthemodelisfitting
𝑚(𝑑 𝑖)={𝐷(𝑑 𝑖):∀𝑐∈𝐶 𝑖},
thedatabetter,butitalsomeansthatthemodelisbecomingmore
where𝐶 𝑖 representsallpossibleclassesfordetection𝑑 𝑖. complexandmaybeoverfitting.Weneedtochoosethenumberof
2.Probabilitystep:Convertthedistancestoaprobability componentswiththelowestBICscorewithareasonablenumberof
distributionoverclasseswith parameters.Weexplorethisselectionusingtheelbowmethod.
Theelbowmethodisawell-knownheuristictechniquefordeter-
miningtheoptimalnumberofcomponentsinamodel.Thismethod
softmin(𝑚(𝑑 𝑖))
involvesplottingtheBIC(ororiginally,thedispersion)asafunction
3.Repeatforallregistersinthedataset. ofthenumberofcomponents,andselectingthenumberofcompo-
nents where the decrease in BIC slows down, i.e., the number of
componentsforwhichtheslopeofthetangentchangesdrastically.
C.Masterclassification Thisindicatesthataddingadditionalcomponentsisnotsignificantly
1.Hardvoting:Foreachsource𝑆inthedataset,consider improvingthefittothedata.Theelbowmethodwasfirstintroduced
inThorndike(1953).RecentstudieshaveshownthattheBIC-based
eachofitsdetectionsandassignaclassusingthehard
componentselectionperformsbetterthanthetraditionaldispersion-
votingapproach,whichselectsthemostcommon
basedelbowmethod(Schubert2022).
classificationamongthedetections:
We plot the BIC as a function of the number of components to
∑︁
C𝑆 =argmax𝑐∈𝐶 [𝑑→𝑐], discern where further addition does not substantially improve data
𝑑∈D𝑆 fitting.Figure1showsthattheBICplotlacksaclearelbow;therefore,
2.Softvoting:Foreachsource𝑆inthedataset,consider we employ the gradient function to determine the optimal number
of components. At 𝐾 = 6, we note a considerable change in the
eachofitsdetectionsandassignaclassusingthesoftvoting
gradient’sslope,whichsubsequentlyconvergesto0for𝐾 ≥7.This
approach,whichtakesintoaccounttheprobabilitiesofeach
observationindicatesthataugmentingthecomponentsbeyond𝐾 =6
detectionbelongingtoeachclass:
doesnotnotablyenhancethedatafit.
1
∑︁𝑁𝑖
Inouranalysis,wehaveusedtheBIC-basedelbowmethodasan
𝐶 𝑆 =argmax𝑐∈𝐶𝑁 𝑃(𝐶 𝑖,𝑐), initial step guide. We have also relied on domain knowledge and
𝑖
𝑖=1
agraphicalanalysisofthedatadistributiontoconfirmthenumber
3.Tables:Aggregatethesourcesthatagreedontheir ofcomponents.Weperformedthisanalysisbyexperimentingwith
classificationinboththehardandsoftvotingmethodsintoa several number of components over the same dataset. This multi-
tableofuniquelyclassifiedsources.Aggregatethesources faceted approach allows us to make informed decisions about the
thatwereclassifieddifferentlyineachmethodinatableof number of clusters and to ensure the reliability of our results. We
ambiguoussources. provideananalysisonthestabilityofthisselection,anditsimpact
onthefinalclassificationinonlineAppendixC.
Algorithm1:Ourproposedclassificationmethod.Thistech- Asaresultofthisprocess,weselectedthenumberofcomponents
niquetakesadvantageofapreviousclusteringoutputanduse to be 6. Further graphical and distributional analysis revealed that
ittoboundtheclassificationtoparticularclusterspaces. theformationoftheclusterswasmainlyinfluencedbyasubsetofthe
selectedfeatures(Table1),specificallyvariabilityprobabilitiesand
hardnessratios.ThesefindingsarediscussedindetailinSection4.
Anothercrucialhyperparameteristhetypeofcovarianceparam-
eterstouse.Thesearedefinedbythecovariance_typeparameter
3.3 Hyperparametertuning
intheGaussianMixturemethodofscikit-learn.Itischallengingto
Themostimportanthyper-parametertodetermineisthenumberof determinethepositionandshapefeaturesofthedifferentcomponents
components 𝐾 (n_components in the GaussianMixture scikit- apriori,i.e.,wedonotknowhowthecovariancematricesofeach
learnarchitecture).Inordertoselectthenumberofcomponents,we Gaussianneedtobeinordertooptimallyfitthedatapoints.There-
preliminarilyusetheBayesianInformationCriterion(BIC). fore,wechosethe’full’configuration,whichallowseachcomponent
TheBICwasintroducedinSchwarz(1978)andisdefinedas: to define its own covariance matrix (position and shape) indepen-
MNRAS000,1–21(2022)UnsupervisedMachineLearning 7
1e6 cluster, we assign probabilistic classes for each object detection in
−1.0 the dataset. We summarize classes for each individual object us-
ing hard and soft voting classification. We provide final uniquely
−1.1 classifiedandambiguousclassificationtablesforindividualsources.
We validate our results by constructing confusion matrices for a
−1.2 setofcontroldetections,andbycomparingourresultstocompiled
catalogs of X-ray binaries, AGNs, etc. We also quantify the un-
−1.3 certaintyinourprobabilisticclassificationsbyevaluatingtheshape
ofthe probabilitydistributionover classes,andby evaluatingcon-
sistency in the assigned class for bona-fide CSC sources and re-
2 6 10 15 20
gions.Weprovidethecode,dataandresultsintheGitHubrepository
1e5
0.0 https://github.com/samuelperezdi/umlcaxs.
−0.4 4.1 Clustering
We apply the Gaussian Mixture Model with the hyperparameters
−0.8 describedinSection3.3totheselectedCSCfeatures(§2)inorder
toidentifyaninitialsetofclusters.Membersofagivenclusterhave
−1.2 relativelysimilarfeaturesamongthem,suchashardnessratiosand
2 6 10 15 20 variabilities.Featurestendtobedistinctfromclustertocluster,but
Values of K this does not exclude significant overlap, or implies that all points
withinaclusterbelongtothesameclass.Weappliedtheclustering
Figure1.TheBayesianInformationCriterion(BIC)(top)andthegradient
of the BIC (bottom) as a function of the number of components 𝐾. The toatotalof29655individualCSCsourcedetections.
numberofcomponentsrangesfrom2to20.Thegrayregiondelineatesthe Figure 2 shows a Mollweide projection of the sky, where the
confidence interval as determined by the standard deviation of each 𝐾’s spatialdistributionoftheclustereddetectionsispresented.Wenote
iterationresults.TheBICfunctionissmoothlydecreasing,whileitsgradient acleardifferentiationbetweensourceslocatedonthegalacticplane,
showsaconstantbehaviourforvaluesgreaterthan𝐾 = 6.Thereddashed versusoff-the-planesources,astheytendtorespectivelybeassigned
verticallinehighlightsthefunctionpointat𝐾 =6,whichisthenumberof to different clusters. For instance, clusters 3 and 4 predominantly
componentsthatshowsabetterconfigurationinthistechnique. reside in the galactic plane, with 34.3% and 28.8% of detections
at galactic latitudes |𝑏| < 5◦, respectively. Conversely, clusters 2
and1predominantlyconsistofextragalacticsourcedetections,with
dently (Pedregosa et al. 2011). To ensure reproducibility, we fixed
only 12.6% and 9.8% of detections at galactic latitudes |𝑏| < 5◦,
therandom_seedofourGaussianMixtureModelto423.
respectively.Toalesserextent,cluster5isalsoassociatedwithoff-
planesources,whilecluster0exhibitsastrongerconnectiontothe
3.4 Validation galacticplane.
In Figure 3 we show the hardness-to-hardness diagrams for ob-
Validating unsupervised learning techniques requires a departure jectsindifferentclusters,color-codedbyvariabilityonthehardband.
fromtypicalmethodspredominantlyusedinsupervisedlearningre- Overall,clustermembershiprelatestohardnessandvariabilityprop-
search.Thevalidationofourproposedalgorithmnotonlyconfirmed erties.Cluster4ismadeupalmostentirelyofhighlyvariableobjects
its suitability for our classification problem but also guided us in irrespective of their spectral shape, whereas cluster 3 is predomi-
assigninga’masterclass’touniquesources.Wedothisbyusinga nately made of very low variability objects with a hard spectrum.
70%/30% stratified random split over the set of SIMBAD labeled Other clusters show more dispersion in variability, although with
CSCdetections.Wetreatthe30%splitasabenchmarkset.These discernibledifferencesinboththeoverallvariabilityandthespectral
detectionsaretreatedasiftheywereunlabeledduringtheclassifi- shapes.Clusters1and2occupyanintermediateregioninhardness.
cationprocess,butwethencomparethemodel’spredictionstothe Nosinglefeaturebyitselfcanseparatesourcesofdifferentproperties,
knownSIMBADlabelstoassessitsperformance.Thisoperationis butcombinedtheycanisolatespecificbehaviors.
performedusingthetrain_test_splitfunctionfromthescikit-
learn library. Its effectiveness is evaluated through the analysis of
the resulting confusion matrices, which contrast the ground truth 4.2 Classification
classes(SIMBAD)withourpredictedclassifications.Theseresults
arepresentedin§4.2.2. So far, our clusters contain a mix of SIMBAD-classified objects
and a majority of unclassified objects. We first investigate if there
aredominantclasseswithineachclusterInTable3werankthe10
mostcommonclasseswithineachcluster.Unclassifieddetectionsare
4 RESULTS
markedasNaN,andarethemajorityofdatapointsinallclusters,
Inthissectionwepresenttheresultsofapplyingtheproposedpipeline exceptforcluster4.Someoftheclustersareclearlydominatedby
totheCSCdatasetdescribedin§2.UsingtheGMMresults,aswell object detections of similar astrophysical types. Such is the case
astheclassassociationsusingtheMahalanobisdistancewithineach of cluster 4, for which over 90% of the classified objects are of
types associated with young stars. Clusters 0 and 5 also appear to
be dominated by young stars, whereas for cluster 2 practically the
3 "Theanswertotheultimatequestionoflife,theuniverse,andeverything entiresetofSIMBAD-classifiedobjectscorrespondstoeithersuper-
is42."(Adams1995) massiveblackholes(QSO,AGN,Seyfert),orstellarsizeblackholes
MNRAS000,1–21(2022)
CIB
CIB
darg8 Pérez-Díazetal.
75°
cluster
60°
0
45°
1
30° 2
3
15°
4
-150° -120° -90° -60° -30° 0° 30° 60° 90° 120° 150°
0° 5
-15°
-30°
-45°
-60°
-75°
l
Figure2.SourcedetectionsingalacticcoordinatesoveraMollweideprojection,discriminatedbytheirassignedclusterincolorsandmarkers.Weseeatrend
ofextragalacticorgalacticforpointsinparticularclusters.
Cluster 0 Cluster 1 Cluster 2
1.00 1.00 1.00
0.75 0.75 0.75
0.50 0.50 0.50
0.25 0.25 0.25
0.00 0.00 0.00
−0.25 −0.25 −0.25
1.0
−0.50 −0.50 −0.50
−0.75 −0.75 −0.75 0.8
−1.00 −1.00 −1.00
−1.00 −0.75 −0.50 −0.25 0.00 0.25 0.50 0.75 1.00 −1.00 −0.75 −0.50 −0.25 0.00 0.25 0.50 0.75 1.00 −1.00 −0.75 −0.50 −0.25 0.00 0.25 0.50 0.75 1.00 0.6
hard_hm hard_hm hard_hm
Cluster 3 Cluster 4 Cluster 5
0.4
1.00 1.00 1.00
0.75 0.75 0.75
0.2
0.50 0.50 0.50
0.25 0.25 0.25
0.0
0.00 0.00 0.00
−0.25 −0.25 −0.25
−0.50 −0.50 −0.50
−0.75 −0.75 −0.75
−1.00 −1.00 −1.00
−1.00 −0.75 −0.50 −0.25 0.00 0.25 0.50 0.75 1.00 −1.00 −0.75 −0.50 −0.25 0.00 0.25 0.50 0.75 1.00 −1.00 −0.75 −0.50 −0.25 0.00 0.25 0.50 0.75 1.00
hard_hm hard_hm hard_hm
Figure3.hard_hsvs.hard_hmscatterplotforeachcluster,withvar_prob_hasacolordimension.Noticehowsomeclustersclearlydemonstratemultidi-
mensionalcorrelations,predominantlyinfluencedbyhighlyvariableorlowvariablesourcedetections.
(HMXB, XB). The X-ray properties of accreting compact systems resented by the optimal number of GMM clusters selected (6). It
areexpectedtobesimilar,butwefindclusters(e.g.cluster1)where wouldthereforebemeaninglesstoattemptaclassificationusingall
AGNsandQSOsaresignificantlymorecommonthanX-raybinaries. the125classesthatappearintheSIMBADdatabaseforoursources.
Despitethesetrends,clustersarenotgenerallypopulatedbyobjects Fortraining,weexcludesourcesintheseunderrepresentedclasses.
ofagivenclass. The remaining 10 classes that we use for training, representing a
broadrangeofastrophysicalphenomenaare:QSO,AGN,Seyfert_1,
Seyfert_2,HMXB,LMXB,XB,YSO,TTau*,Orion_V*.Wecanfur-
4.2.1 Classes therseparatetheseclassesin4largergroups,whichwewillreferas
aggregatedclasses:
Some of the classes represented in the SIMBAD database are ex-
tremelyrare,havinglessthan10exampleseach.OurinitialBICtest, • Largeaccretors(AGN):QSOandAGN.
ontheotherhand,indicatesthattheX-raypropertiesalonecontain • Extended Large accretors with optical lines (Seyfert):
only a limited amount of information to separate the objects, rep- Seyfert_1andSeyfert_2
MNRAS000,1–21(2022)
b
sh_drah
sh_drah
sh_drah
sh_drah
sh_drah
sh_drah
h_borp_ravUnsupervisedMachineLearning 9
• Smallaccretors(XB):HMXB,LMXB,andXB groups. X-ray binaries show wider distributions of their hardness
• Youngstars(YSO):YSO,TTau*,andOrion_V* ratios, with low-mass X-ray binaries even showing signs of multi-
modality.Thisisrelevantinthedistinctionbetweenlargeandsmall
Inthecontextofthisstudy,"accretors"refertoaccretingcompact
accretors. Young stars show overall softer spectra with respect to
objects. In "Large accretors", the central object is a super-massive
compact objects, although in the case of YSO there seems to be
black hole, which results in a high luminosity. "Small accretors"
at least two separate populations with different spectral shapes. T-
involve a stellar remnant (a neutron star or black hole) accreting
Tauri stars have consistently lower hardness ratios, whereas Orion
matterfromacompanionstar.
variables,whichtendtoshoweruptivebehavior,appeartooccupya
ForasignificantnumberofX-raysources,SIMBADonlyprovides
regioninbetweenthetwopopulationsofYSOtypes.
ageneralclassthatisnotinformativeasofspecificphysicalproperties
Figure7showsasimilardensitymap,butthistimeforthevariabil-
("Star","X","Radio","IR","Blue","UV","gamma","PartofG").We
itiesinthebroad(0.5keV-7.0keV)andsoft(0.5keV-1.2keV)bands.
assumeobjectsinthoseclassestobeunclassified,andassignthem
We note significant variations in the level of soft-band variability
classesusingouralgorithm.
acrossclasses,withlessvariabilityintheintegratedbroadband.For
Allinall,thetotalnumberofCSCdetectionsforwhichwewill
mostoftheclasses,variabilityisnotcorrelatedbetweenbands,in-
providealabelis14,507.
dicating spectral variability. Among large accretors, QSOs appear
less variable in the soft band with respect to AGN, and Seyfert 2
galaxiesappearmorespectrallyvariablethantheirSeyfert1coun-
4.2.2 Detectionlevelclassification
terparts, which also show more variability in the broad band. For
Usingtheprobabilisticapproachdescribedin§3.2wehaveassigned small accretors, no significant changes in variability is discernible
aprobabilisticclasstoall14,507CSCdetections. betweenHMXBsandLMXBs,whereassourcesclassifiedplainlyas
Figure 4 shows the True vs. Predicted confusion matrix for the XBsshowasmallerdegreeofsoftbandvariability.Finally,foryoung
benchmark set previously described. Each element of the matrix stars,T-Tauristarsareclearlydifferentiatedbyamarkedbimodaldis-
indicatesthefractionoftestobjectswithagivenTrueclassthathave tribution,andthemajorityofobjectshavingasignificantvariability
been correctly classified by the algorithm. At the detection level, probability(var_prob_b ~ 1).Thelattermightberelatedtoflaring
ourX-raybasedclassificationmethodissuccessfulatdistinguishing eventsinthatstageoftheirevolution.
betweenlargeaccretors(QSO,AGN,andSeyferts),smallaccretors
(X-ray binaries), and young stars (YSOs, T-Tauri stars, and Orion
V*variables).However,afairamountofconfusionpersistsbetween
sub-classesofeachmajorclass.
4.2.3 Masterclassification
Forexample,AQSOiscorrectlyclassifiedasasuchabout40%of
thetimes,whereasabout30%ofthetimes,thealgorithmthinksitisa Sofarwehaveobtainedprobabilisticclassificationsforeverydetec-
Seyfert1galaxy.Infact,QSOX-rayspectracanbesimilartoSeyfert tionofasourceinourdataset.Inordertoobtainmoreaccurateclasses
1spectra(Dadinaetal.2016).Lackingadistanceoraredshift,the foragivenCSCsource,wecannowoperateontheprobabilisticlabels
algorithmcannotdistinguishbetweenthetwointhedetectionlevel. assignedtoeachdetectionofasource.Spectralvariability,different
Similarly,aHMXBgetscorrectlyclassifiedover50%ofthetime, exposuretimesorsignaltonoiselevelmighttranslateintodifferent
andincorrectlyclassifiedasaLMXBinabout8%ofthecases.On classificationsindifferentepochs.Fromthe8756uniquesourcesin
theotherhand,LMXBsareclassifiedasHMXBsin44%ofthetest thedata,6802(77.7%)haveonly1detection(forthesesources,the
examples. Among young stars, most confusion occurs for T-Tauri detectionlevelclassificationisourbestguess),1000(11.4%)have
stars,whichareclassifiedassuchonlyathirdofthetimes,withthe 2 detections, 882 (10.1%) have between 3 and 10 detections, and
remainingexamplesclassifiedinequalamountsaseitherYSOsor finallyjust72(0.8%)sourceshavemorethan10detections.Foreach
OrionV*. sourcewenowassignamasterclassusingtheproceduredescribed
LargeaccretorsaremostlikelytobeconfusedwithHMXB,butthat in§3.2.2.
onlyhappensabout20%ofthetime,andsmallaccretorsarealmost Overall, both the hard and soft voting systems agree with each
neverassignedalargeaccretorlabel,withtheexceptionperhapsof other: for a given source, the highest average probability across
theXBclass,whichisconfusedwithQSOsin13%oftheexamples. classes usually aligns with the primary type assigned to the ma-
Themostrobustclassificationisprovidedforyoungstars,whichare jority of a source’s detections. Only 485 sources (6% of the total)
almostneverclassifiedinothergroups.ThisisillustratedinFigure resultindifferentclassifications.TheCohen’sKappacoefficient(Co-
5,wherewehavegroupedindividualclassesintomajorclasses hen1960),ameasurementofagreementbetweenthetwomethods,
Asignificantpartoftheconfusionislikelyduetodifferencesinthe was calculated to be 0.94. We compile a table of uniquely classi-
spectralstatesofthedifferentobjectsduringdifferentepochs.More fied andatableofambiguousclasssourcesdependingonwhether
robustclassificationsresultfromconsideringmultipledetectionsof the class assigned agree between the two methods. We also pro-
asource,butwenotethatsingle-epoch,X-ray-onlyclassificationof vide the mean classification probabilities and their standard de-
CSCsourcesispossibleatsomesignificancelevel. viations. In the uniquely classified sources table, master_class
How do X-ray properties distribute between classes? Figure 6 refers to the class assigned from both the soft and hard classi-
shows a density map of the distribution of hardness ratios for the fier,andagg_master_classdenotesitscorrespondingaggregated
classifieddetections.Weobserverelativelydistinctdistributionsin class. In the ambiguous sources table, soft_master_class and
the spectral shape for each of the different classes, even if there hard_master_class,referrespectivelytoeachofthemethods.We
arealsosimilaritiesanddegeneracies.Forexample,QSOs,AGNs, providethenumberofdetectionspersourceasdetection_count.
and Seyfert 1 galaxies all appear to have a similar mean in their Sampleextractsoftheuniquelyclassifiedandambiguousclassifica-
hardnessratiodistributions,buttheydifferinthestandarddeviations tiontables,sortedbydetectioncount,arepresentedinTableA1and
ofbothhardnessratios.Seyfert2galaxies,ontheotherhand,have TableA2respectively.Fullversionsofthetablesareavailableinthe
aslightlyelevatedhard-to-softratiowithrespecttotheotherthree onlinesupplementarymaterialandtheprovidedGitHubrepository.
MNRAS000,1–21(2022)10 Pérez-Díazetal.
main_type size main_type size main_type size
NaN 884 NaN 2869 NaN 3211
Star 310 QSO 931 X 1093
Orion_V* 310 X 887 QSO 1081
YSO 264 Orion_V* 304 Star 398
QSO 185 YSO 304 HMXB 272
TTau* 165 Star 277 GlCl 255
X 144 AGN 236 Seyfert_1 252
PartofG 105 HMXB 210 XB*_Candidate 238
Seyfert_1 52 Seyfert_1 172 AGN 232
SB* 47 LMXB 141 XB 222
(a)Cluster0. (b)Cluster1. (c)Cluster2.
main_type size main_type size main_type size
NaN 821 Orion_V* 688 NaN 1131
X 307 YSO 562 YSO 563
HMXB 165 NaN 429 Orion_V* 530
YSO 154 Star 312 Star 332
Star 135 TTau* 159 X 313
Seyfert_2 120 X 78 TTau* 196
QSO 115 HMXB 63 QSO 187
Orion_V* 91 YSO_Candidate 62 HMXB 161
Seyfert_1 79 BYDra 62 AGN 86
Pulsar 73 Em* 26 Seyfert_1 71
(d)Cluster3. (e)Cluster4. (f)Cluster5.
Table3.The10mostprevalentsourceclassesineachoftheclusters,rankedbynumberofexamples.Sourcedetectionswithnonmatchingtypesarelabeledas
NaN.
4.2.4 Astrophysicalvalidationoftheclassification withtheAGNandYSObeingequallyprobable.InobservationID
4374,thesourcewasclassifiedasaYSOwithahighprobabilityof
CertaintypesofCSCsourcesareexpectedtooccupyspecificregions 0.99,andinobservationID3744,itwasclassifiedasOrion_V*with
ofthesky.Forexample,weexpectYSOstobeassociatedwithstar- aprobabilityof0.75.Intheremainingtwoobservations,thesource
formingregionsalongthegalacticplane,andAGNsandquasarsto wasclassifiedasAGNwithprobabilitiesaround0.7,whichresulted
be mostly located off the galactic plane. As a way to validate our
inthefinalhard-votingclass.Furthermore,itisworthnotingthatthe
classification,weinvestigatewhetherthisexpectationsaresatisfied standarddeviationishigherfortheYSOclass(0.41)comparedtothe
-inastatisticalsense-fortheobjectsthatwehaveclassified.Figure AGNclass(0.38).Suchhighstandarddeviationsarenotuncommon
8 shows density maps for each aggregated class over Mollweide
inourclassificationscheme.Insummary,thisisaclosecallbetween
projections.WenotethatobjectsassignedtotheYSOclassclearly
YSOandAGNclass,whichwouldstillbeclassifiedasaYoungStar
concentratealongthegalacticplane,whileAGNsaremostlyconfined
ifonlytheaggregatedclassesdefinedin§4.2.1wereused.
totheextragalacticareaofthesky.Objectsthatwehaveclassifiedas
• 2CXOJ053615.0-051530has5CSCdetectionsandisclassified
X-raybinarieshaveatendencytobelocatedalongthegalacticplane,
asSeyfert_1galaxy,withrelativelyhighprobabilitiesalsoassigned
butnotasstarklyasinthecaseofYSOs.Seyfertgalaciesaremostly
to the QSO and AGN classes. The closest match in the SIMBAD
extragalactic,butlessmarkedlythanAGNs.Thesemapsprovidean
database,sourceV*V828Ori,isasanOrionVariablelocatedabout
earlyindicationthatourclassifierisassociatingtherightobjectsto
3arcsectothesouthwestoftheCSCsource.InSzegedi-Eleketal.
therightenvironments,despitenothavingaccesstoanyinformation
(2013),thesourceisincludedintheTTau*group,andothergeneral
about the object’s location in the sky. It is important to note that
variable and proper motion stars catalogs. We cannot rule out the
Chandraisnotanall-skysurvey,andthereforethesemapsshould
possibility that the CSC detection might be in fact a background
notbeinterpretedasproxiesfortheactualsurfacedensitiesofeach
AGN.
class.
Thisassociationbetweenassignedclassesandenvironmentholds We also validate membership for objects classified as X-ray bi-
evenatsmallerscales.Figure9showspreviouslyunclassifiedsources naries.Source2CXOJ193309.5+185902,forexample,isclassified
withintheOrionNebularegion(M42)towhichwehaveassigneda as a HMXB by our method with just one detection and a proba-
masterclass.MostofthesourcesinthisareaareclassifiedasYSO, bility of 95%. This is consistent with other works such as Yang
as expected in this well known star-forming region (O’dell 2001). et al. (2022), in which the source is classified as a HMXB with a
Wealsoobserveafewsourcesclassifieddifferently.Wenowdiscuss probability of 69±14%. More generally, we can look for XB in
twoexamplesofthese: regions where such type of X-ray source is expected, such as the
spiral arms of galaxies. We explored source aggregated classifica-
• 2CXO J053516.0-052353 has 4 CSC detections and is classi- tions over the region of the M33 galaxy, in the outskirts of which
fiedasanAGN.Figure10showsitsprobabilitydistributionacross sources2CXOJ013301.0+304043and2CXOJ013324.4+304402are
aggregatedclasses.Thereissignificantconfusionbetweenclasses, located.BothsourcesareclassifiedasXB,inagreementwithother
MNRAS000,1–21(2022)UnsupervisedMachineLearning 11
1.0
QSO 0.37 0.14 0.28 0.022 0.096 0.028 0.014 0.016 0.016 0.018
AGN 0.23 0.16 0.23 0.04 0.2 0.048 0.04 0.016 0.0079 0.032
0.8
Seyfert_1 0.23 0.063 0.38 0.055 0.11 0.039 0.039 0.024 0.031 0.031
Seyfert_2 0.16 0.082 0.18 0.22 0.22 0.041 0 0.041 0.02 0.02
0.6
HMXB 0.055 0.028 0.061 0 0.51 0.083 0.055 0.13 0.028 0.05
LMXB 0.053 0.095 0.021 0 0.44 0.18 0.12 0.063 0.011 0.021
0.4
XB 0.13 0.078 0.12 0.026 0.27 0.052 0.26 0.013 0.013 0.039
YSO 0 0.015 0.0025 0.0025 0.057 0.044 0.0049 0.51 0.11 0.25
0.2
TTau* 0.024 0.0079 0.024 0.0079 0.048 0.024 0 0.29 0.3 0.28
Orion_V* 0.017 0.0072 0.0072 0.0096 0.055 0.048 0 0.39 0.074 0.39
0.0
Predicted
Figure4.Truevs.Predictedconfusionmatrixforthebenchmarksetusingindividualdetectionsonly,normalizedbyrow.Foreachtrueclasstheproportionof
sourcedetectionsofthatclassassignedtoeachofthepossiblelabelsisshown.
machine-learningbasedclassifications,suchasTraninetal.(2022). clusterislimited,with(Matt,G.etal.2012)beingoneoftheprevi-
SomesourcesarealsomissclassifiedasX-raybinaries,basedoncom- ouslyidentifiedexamples.
parison with independent classification. Source 2CXO J053747.4-
A different test astrophysical environment is provided by NGC
691019, for example, is confidently classified as a HMXB by our
4649anditssurroundings.Thisisanellipticalgalaxylocatedinthe
algorithm.However,ithasbeenclassifiedaspulsarPSRJ0537-6910
VirgoclusterwithapopulationofX-raysourcesdetectedbyChan-
located in the Large Magellanic Cloud (Lin et al. 2012). We note,
dra, the vast majority of which has been classified as Low-Mass
however, that in some X-ray binaries the compact object can be a
X-rayBinaries(Luoetal.2013;D’Abruscoetal.2014).Thisclassi-
pulsar(Wĳnands&VanDerKlis1998).
ficationisbasedontheiroverallX-rayproperties,density,andspatial
Source 2CXO J031948.1+413046 is located at the heart of the coincidencewitharichpopulationofGlobularClustersdetectedin
Perseusgalaxycluster.Itisclassifiedveryconfidently(>0.9proba- Hubble-SpaceTelescopeimages(Straderetal.2012).Allofthepre-
bilityinallthreedetections)asaSeyfert_2galaxycandidate.Other viouslyunclassifiedCSCsourcesnearNGC4649forwhichweare
sourcesinthiscoreregionhavebeenstudiedandsuggestedaseither providing a master class are assigned a XB label by our pipeline,
Type1.5orType2Seyferts,suchas3C84Ranietal.(2018);Véron- asshowninFigure11.TheCSCsourceclosesttotheX-raysource
Cetty, M.-P. & Véron, P. (2006). These specific galaxies typically identifiedbyLuoetal.(2013)astheAGNinthecenterofNGC4649
exhibitabrightlyilluminatedcore,predominantlyatinfraredwave- is 2CXO J124339.9+113309. As a previously classified source, it
lengths. However, the number of Seyfert 2 galaxies in the Perseus wasnotassignedalabelinourclassification,butitislocatedinthe
MNRAS000,1–21(2022)
eurT
OSQ NGA 1_trefyeS 2_trefyeS BXMH BXML BX OSY *uaTT *V_noirO12 Pérez-Díazetal.
5.1 Comparisontoothermethodsandcatalogs
1.0 Wecompareourclassificationresultswiththefollowingindependent
methodsandcompiledcatalogs:
0.49 0.29 0.17 0.051
• ThetrainingdatasetdescribedinYangetal.(2022)inthecontext
0.8
ofsupervisedclassification,containing2947literatureverifiedCSC
X-raysourcesclassifiedasAGN,CataclismicVariable(CV),high-
mass star, HMXB, low-mass star, LMXB, neutron star, and YSO.
0.28 0.43 0.21 0.085
0.6 (MUWCLASSTD)
• The catalog of confidently classified CSC sources presented
from the Yang et al. (2022) pipeline, which contains 31000 CSC
sources,withthesamelabelsasthepreviousitems.(MUWCLASS
0.4
0.13 0.068 0.66 0.15 CCGCS)
• ThemachinelearningclassificationapproachofXMM-Newton
4XMM-DR10 catalog sources, presented in Tranin et al. (2022).
Thismethodassignsfourdifferentlabels:AGN,stars,X-raybinaries
0.2
(XRBs),andcataclysmicvariables(CVs).(4XMM-DR10Classifi-
0.021 0.014 0.1 0.87
cation)
• Thecatalogof224168galaxiespresentedinTobaetal.(2014)
AGN Seyfert XB YSO 0.0 basedonWISEandSDSSdata.(WISE-SDSSGalaxies)
Predicted • Thecatalogof121newredshiftobscuredAGNsoftheChandra
SourceCatalogpresentedinSicilianetal.(2022)(ObscuredAGNs).
Figure5.Truevs.Predictedconfusionmatrixforthebenchmarkset,normal-
izedbyrow.ClasseswerereplacedbytheaggregatedclassesAGN,Seyfert,
To perform the comparison, we cross-matched our catalog of
QSO, YSO. The matrix displays the proportion of source detections in a
uniquely classified sources with eachof the reference catalogs, ei-
specificclassthatwerecorrectlyclassifiedormisclassified.Thedatausedin
thisplotisnotafinalresultofourpipeline.
therusingacoordinateradius(≤1′′)ormatchingexactCSCnames.
Whereappropriate,wemergesimilarclassesintoasingleclassprior
tocomparison.Forexample,wemergetheAGNandSeyfertaggre-
gatedclassesintoaAGN+Seyfertclass.WealsomergeourLMXB
cluster 0, under the GinPair (Galaxy in Pair of Galaxies) category andHMXBclassesintoasingleXBclass.Table4summarizesthe
fromSIMBAD.Thenextclosestsource(2CXOJ124339.8+113307) resultsofthiscomparison.Thetablelistsforeachcasethenumberof
isclassifiedasanX-rayBinaryineachofthetwodetectionsincluded matches,theprecision,andtherecall.ThePrecisioncolumnrefers
intheCSC. totheprecisionwhenalllabelsinthereferencecatalogareincluded,
whereastheRPrecisioncolumnsreferstotheprecisionwhenonly
referencecataloglabelsthatareinbothcatalogsareconsidered.
Wenoteasignificantincreaseintheprecisionwhenonlythere-
strictedsetoflabelsisconsidered.Inparticular,98%oftheobjects
5 DISCUSSION
thatweclassifyasAGN+Seyfertactuallybelongtothatclassaccord-
Theadventofall-sky,time-domainX-raysurveyingmissionssuchas ingto(Yangetal.2022),withprecisioninotherclassesrangingfrom
eROSITA,andtheproposedcapabilitiesofupcomingprobeandflag- 6%toabout80%.ThelowestprecisionisobtainedforX-raybinaries,
shipfacilitiessuchastheAdvancedX-rayImagingSatellite(AXIS), forwhichonly6%oftheobjectsthatweclassifiedasXBsactually
Arcus, and eventually Lynx, underline the importance of a robust belong to that class according to the reference catalog. The recall
method for the classification of X-ray sources. This is important numberstendtobemoreuniformacrossclasses,withpercentages
not only because of the increasing volume of high-energy sources rangingfrom20%to88%.Forexample,ofallAGN+Seyfertobjects
detected,butalsoforthedesignofmulti-wavelengthfollow-upcam- inthe(Yangetal.2022)trainingset,wecorrectlyclassifyassuch
paignsofparticularobjectsofinterest,inparticularthosethatinform 83%ofthem,thesameproportionasforYSOs.Therecallforthe
models of transient behavior and extreme accretion. Classification AGN+Seyfertclassincreasesto88%whentheWISE-SDSScatalog
attemptsareusuallylimitedbytwofactors:thelackofarobustand isconsidered.Weobservetheworstrecallperformancewhentrying
balancedtrainingsetacrossX-rayclasses,andthefactthatasignif- tocorrectlyclassifyobscuredAGNs.Fromthe(Sicilianetal.2022)
icantnumberofX-raysourceslackopticalorinfraredcounterparts catalog,wehaveonlyclassifiedabout20%oftheirobjectsasAGNs
thatcouldprovideusefulinsightsforthecategorizationofsources. orSeyfert.
LeveragingtheinformationcontainedintheChandraSourceCata- In general, most classifications we labelled as AGN+Seyfert are
log,wehavedesignedanunsupervisedclassificationalgorithmthat accuratewithrespecttotheMUWCLASSset,andwealsorecovera
acknowledges those limitations, with the scope of investigating to fairamountofobjectsactuallybelongingtothatclasses.X-raybina-
whatextenttheX-raypropertiesalonecanproviderelevantinsights riesshowcomparativelylowerprecisionandrecall.Wecanrecover
forthelabelingofX-raysources. about50%ofthemfromcontrolcatalogs,butwetendtoassignXB
Wenowdiscussourfindings,focusingonfourmajoraspects:i) labelstoobjectsthatareclassifiedinothercategories(mostlyAGN)
theperformanceofourmethodwithrespecttoexistingclassification incontrolcatalogs.Spectralsimilaritiesbetweenthesetwotypesof
approachesandcuratedcatalogs;ii)theimplicationsforastrophysics accretingobjectsisalikelyreasonforthisdegeneracy,whichcanbe
of the relationship between specific classes and the distribution of brokenifthedistancetothesourcesisknown(Volonterietal.2017).
X-rayproperties;iii)theimpactofmultipledetectionsofasourceon A significant fraction of the objects that we classify as YSOs are
classification,andiv)thelimitationsofourmethod. classified as low-mass stars in the MUWCLASS training set. 62%
MNRAS000,1–21(2022)
eurT
NGA
trefyeS
BX
OSYUnsupervisedMachineLearning 13
QSO AGN Seyfert_1 Seyfert_2 HMXB
1.0 1.0 1.0 1.0 1.0
0.5 0.5 0.5 0.5 0.5
0.0 0.0 0.0 0.0 0.0
0.5 0.5 0.5 0.5 0.5
1.0 AGN 1.0 AGN 1.0 Seyfert 1.0 Seyfert 1.0 XB
1.0 0.5 0.0 0.5 1.0 1.0 0.5 0.0 0.5 1.0 1.0 0.5 0.0 0.5 1.0 1.0 0.5 0.0 0.5 1.0 1.0 0.5 0.0 0.5 1.0
hard_hm hard_hm hard_hm hard_hm hard_hm
LMXB XB YSO TTau* Orion_V*
1.0 1.0 1.0 1.0 1.0
0.5 0.5 0.5 0.5 0.5
0.0 0.0 0.0 0.0 0.0
0.5 0.5 0.5 0.5 0.5
1.0 XB 1.0 XB 1.0 YSO 1.0 YSO 1.0 YSO
1.0 0.5 0.0 0.5 1.0 1.0 0.5 0.0 0.5 1.0 1.0 0.5 0.0 0.5 1.0 1.0 0.5 0.0 0.5 1.0 1.0 0.5 0.0 0.5 1.0
hard_hm hard_hm hard_hm hard_hm hard_hm
Figure6.hard_hsvs.hard_hmdistributiondensityestimationforeachclassgroup,visualizedusingakerneldensityestimate(KDE).Darkerhuesrepresent
areasofhigherconcentrationwithinthedistribution.Eachcorrespondingaggregatedclassdensityisincluded,delineatedbygraycontoursandreferencedinthe
grayboxes.Notethatthedensityestimationmayappeartoexceedthevalidvalueboundariesduetothesmoothingeffect.Thiseffectdoesnotindicateactual
datapointsoutsidethehardnessratiolimitsbutresultsfromthebandwidthchoiceintheestimation.
QSO AGN Seyfert_1 Seyfert_2 HMXB
1.0 1.0 1.0 1.0 1.0
0.5 0.5 0.5 0.5 0.5
0.0 0.0 0.0 0.0 0.0
0.5 0.5 0.5 0.5 0.5
1.0 AGN 1.0 AGN 1.0 Seyfert 1.0 Seyfert 1.0 XB
1.0 0.5 0.0 0.5 1.0 1.0 0.5 0.0 0.5 1.0 1.0 0.5 0.0 0.5 1.0 1.0 0.5 0.0 0.5 1.0 1.0 0.5 0.0 0.5 1.0
var_prob_s var_prob_s var_prob_s var_prob_s var_prob_s
LMXB XB YSO TTau* Orion_V*
1.0 1.0 1.0 1.0 1.0
0.5 0.5 0.5 0.5 0.5
0.0 0.0 0.0 0.0 0.0
0.5 0.5 0.5 0.5 0.5
1.0 XB 1.0 XB 1.0 YSO 1.0 YSO 1.0 YSO
1.0 0.5 0.0 0.5 1.0 1.0 0.5 0.0 0.5 1.0 1.0 0.5 0.0 0.5 1.0 1.0 0.5 0.0 0.5 1.0 1.0 0.5 0.0 0.5 1.0
var_prob_s var_prob_s var_prob_s var_prob_s var_prob_s
Figure7.var_prob_bvs.var_prob_sdistributiondensityestimationforeachclassgroup,visualizedusingakerneldensityestimate(KDE).Darkerhues
represent areas of higher concentration within the distribution. Each corresponding aggregated class density is included, delineated by gray contours and
referencedinthegrayboxes.Notethatthedensityestimationmayappeartoexceedthevalidvalueboundariesduetothesmoothingeffect.Thiseffectdoesnot
indicateactualdatapointsoutsidetheprobabilitylimitsbutresultsfromthebandwidthchoiceintheestimation.
oftheobjectsclassifiedasstarsinMUWCLASS,ontheotherhand, 5.2 Astrophysicalimplications
haveYSOlabelsinSIMBAD.
5.2.1 Accretion-poweredsources
Oneremarkableresultisthatwhenwelimitourselvestotheclasses
Wefind2006matchingsourceswiththe4XMM-DR10classifica- assigned by our algorithm, the confusion between small accretors
tioncatalog.Almost80%ofthesourcesthatweclassifyasAGNor and large accretors is not widespread. Such confusion would be
SeyfertgalaxiesagreewiththeTraninetal.(2022)probabilisticclas- expectedonthebasisofsimilarpropertiesduetotheaccretionnature
sification,andofallAGNsandSeyfertgalaxiesinthe4XMM-DR10 oftheX-rayemission(Padovanietal.2017).Withcertaindegreeof
catalog,werecover62%ofthemwiththecorrectclass.Again,X-ray confidence,however,inouranalysiswecandistinguishX-raybinaries
binariesshowlowerprecisionandrecall,likelyduetoconfusionwith fromAGNs,QSOsandSeyfertswhenonlytheX-raypropertiesare
supermassiveaccretors.Ofthe2006matchedsources,435werecat- considered.AsFigure5shows,largeaccretorsarecorrectlyclassified
egorizedasYSOinourclassificationscheme.Themajorityofthese as such in 75% of the cases, and incorrectly classified as X-ray
sourceswereclassifiedeitherasStarorXRBbythe4XMM-DR10 binariesonlyon19%ofthecases.Ontheotherhand,smallaccretors
classification. We obtain high precision and recall for optically or are correctly classified as X-ray binaries in 66% of the cases, and
IR-selectedgalaxiesinTobaetal.(2014),althoughthesearebased incorrectlyclassifiedaslargeaccretorsin20%ofthecases.
onaverysmallnumberofmatches. The feature distribution maps of Figure 6 and Figure 7 suggest
MNRAS000,1–21(2022)
sh_drah
sh_drah
b_borp_rav
b_borp_rav
sh_drah
sh_drah
b_borp_rav
b_borp_rav
sh_drah
sh_drah
b_borp_rav
b_borp_rav
sh_drah
sh_drah
b_borp_rav
b_borp_rav
sh_drah
sh_drah
b_borp_rav
b_borp_rav14 Pérez-Díazetal.
AGN Seyfert
75° 75°
60° 60°
45° 45°
30° 30°
15° 15°
-150° -120° -90° -60° -30° 0° 30° 60° 90° 120° 150° -150° -120° -90° -60° -30° 0° 30° 60° 90° 120° 150°
0° 0°
-15° -15°
-30° -30°
-45° -45°
-60° -60°
-75° -75°
XB YSO
75° 75°
60° 60°
45° 45°
30° 30°
15° 15°
-150° -120° -90° -60° -30° 0° 30° 60° 90° 120° 150° -150° -120° -90° -60° -30° 0° 30° 60° 90° 120° 150°
0° 0°
-15° -15°
-30° -30°
-45° -45°
-60° -60°
-75° -75°
Figure8.DensitymapfortheuniquelyclassifiedCSCsourcesthatlackedalabelbeforeourstudy,ingalacticcoordinates,overMollweideprojectionsforeach
aggregatedmasterclass.
Catalogname Class #matches Precision RPrecision Recall
MUWCLASSTD(Yangetal.2022) AGN+Seyfert 31 0.32 0.56 0.83
XB 29 0.17 0.62 0.31
YSO 56 0.18 0.74 0.83
MUWCLASSCCGCS(Yangetal.2022) AGN+Seyfert 922 0.94 0.98 0.62
XB 627 0.05 0.06 0.51
YSO 255 0.36 0.51 0.72
4XMM-DR10Classification(Traninetal.2022) AGN+Seyfert 912 0.76 0.78 0.62
XB 659 0.42 0.45 0.42
WISE-SDSSGalaxies(Tobaetal.2014) AGN+Seyfert 8 1 1 0.88
ObscuredAGNs(Sicilianetal.2022) AGN+Seyfert 27 1 1 0.19
Table4.Asummaryofthecomparisonofourclassificationwithpreviousworkandcatalogs.Thenumberofmatchescorrespondstothenumberofsources
belongingtoourassignedclassresultingfromcrossmatchingtheChandraSourceCatalognamesoramatchingcriteriaof≤1′′.
thatthedifferentiationispossiblebasedonawiderrangeofhardness their hardness ratios and variabilities, consistent with the absence
ratiosinX-raybinariescomparedtoAGNsandSeyferts,aswellasa of spectral variability. In particular, they are less variable in the
slightlyincreasedaveragehardnessforX-raybinaries,inparticular softbandwithrespecttoAGNsandSeyferts.Stochasticvariability
HMXBs.Thebroaderrangeofhardnessratioscanbeinterpretedin in the thermal soft band of AGN spectra is usually related to disk
termsofthedifferentspectralstatesofX-raybinaries,whichoccur instabilities,jetactivity,orspottinessofinfallingmatter(Jovanović
inmuchshortertimescalesthaninAGNs(Remillard&McClintock &Popović2009),allofwhichmightbemorestableatthethehigh
2006).Withinthelargeaccretors,AGNandSeyfertgalaxiesareoften accretionratesseeninQSOs,providedthattheydonothaveablazar-
confused, which is likely the result of a nomenclature difference, likeorientation.Hardbandvariability,ontheotherhand,relatesto
SeyfertsbeingaparticulartypeofAGN(Peterson1997).Wenote, thehotcorona(Ballantyne&Xiang2020;Petruccietal.2001;Haardt
however,thatSeyfertsshowmorevariabilitythanAGNs,andSeyfert &Maraschi1991;Galeevetal.1979),andappearsmoreprominent
2 galaxies in particular are more likely to be variable in the soft inSeyfert1galaxies,forwhichthelineofsightintersectsthecorona
band,probablyduetomoreobscurationduetotheirorientationwith moredirectly(Soldietal.2014).Heavyabsorptionbythetoruscan
respecttothelineofsight,inthecontextoftheAGNunifiedmodel. alsoenhancebothsoftbandvariabilitythehardnessratiosinSeyfert
QSOs in our sample, on the other hand, have tighter constrains in 2galaxiesduetopreferentialabsorptionofsoftphotons(Turneretal.
MNRAS000,1–21(2022)UnsupervisedMachineLearning 15
1997;Risalitietal.1999).TheresultsinFigure6andFigure7show
overallagreementwiththisunifiedmodel.
-4°30' AGN ComparedtoQSOsandAGNs,objectsclassifiedasX-raybina-
Seyfert
riesshowalargerrangeofvariabilityinthebroadband,resembling
XB
-5°00' YSO thepatternsobservedinSeyfertgalaxies,withaslightlyincreased
broad band variability. Resolved non-thermal coronal X-ray emis-
sion is likely to be at the root of this similarity between systems
30'
of significantly different masses and physical scales. Recent stud-
ieshaveprovidedevidenceofsimilarspectralstateevolutioninthe
-6°00' luminosity-hardness diagram, related to the accretion processes in
bothXBsandAGNs(Fernández-Ontiveros&Muñoz-Darias2021).
5h40m 36m 32m 28m NodustytorusispresentinX-raybinaries,however.Thismightex-
RA plainwhyinFigure7bothLMXBsandHMXBstendtoresemble
morethevariabilitypatternofSeyfert1galaxies,forwhichtheline
Figure9.AsetofpreviouslyunclassifiedsourcesinM42,overlaidonan
ofsightintersectslessobscuringmaterial,andmoreofthecorona.
AllWISEW1bandimageingrayscale.Thecolorsindicatedifferentclasses
We recognize that the incorporation of multi-wavelength coun-
assignedbyouralgorithm.
terpartscanimprovetheseparationbetweenAGN-typesourcesand
X-raybinaries,inparticularifsourcescanbeassociatedtooptically
derivedredshifts,ashasbeenshownforexampleinYangetal.(2022).
Associationwithhostgalaxiescanalsohelpinbreakingdegenera-
2CXO J053516.0-052353, AGN
1.00 cies between these two types of accretors. We point out, however,
that only a fraction of X-ray sources have optical and IR counter-
parts.Inparticular,lessthanhalfoftheCSCsourceshaveatleast
0.75
oneopticalorIRcounterpartwhenacross-matchisperformedusing
theGaiaDR3,LegacySurveyDR10,PanSTARRS-1,and2MASS
0.50 catalogs4.Thishighlightstheimportanceofassessingthequalityof
theclassificationwithonlyX-rayinformationisused.
0.25
0.00 5.2.2 Youngstars
Objectsclassifiedasyoungstarshaveconsistentlyhighervariabili-
ties,inparticularinthebroadband.T-Tauristarsaretheonlytypeof
Class objectclassifiedbyourpipelineforwhichthemajorityofexamples
havehighvariabilitybothinthebroandansoftbands.Highlevels
Figure10.Probabilitydistributionoverclassesfor2CXOJ053516.0-052353.
ofvariabilitymaybetiedtoirregularitiesintheaccretionprocesses
The red square indicates the final master class. The gray area is the 95%
occurringwithintheseyoungstellarobjects(Testa2010;Preibisch
confidenceintervalandtheblackdottedlineistheaverageprobabilitywhen
alldetectionsareaggregated. etal.2005).Inaddition,itcouldbelinkedtostrongmagneticfields,
whichcouldleadtoprominentmagneticactivitysuchasflaresand
coronal mass ejections (Testa 2010). This high level of variability
observedisconsistentwithourunderstandingofthetheprocesses
occurringatthisstageofstellarevolution.Whileasimilarlevelof
11°35' AGN magneticactivityisexpectedfromOrionV*stars,wedonotobserve
Seyfert itinoursample.
XB
34' YSO Objects classified as YSOs also show a bimodal distribution in
their hardness ratios. Hard X-ray emission during coronal events
might be partly responsible for this behavior, but degeneracy with
33'
other types of hard-emitters, such as HMXBs, can also be associ-
atedtothebimodaldistribution.Infact,missclassificationofother
32' types of objects as YSO (the class with the highest classification
accuracy in validation) is not uncommon, although lower that you
31' would expect from the limited amount of information encoded in
12h43m50s 40s 30s theX-rays.Forexample,source2CXOJ033829.0-352701,located
RA attheheartoftheweaklyactivegalaxyNGC1399withintheFornax
Cluster, was classified very confidently as a YSO by our method,
Figure11.PreviouslyunclassifiedsourcesintheregionofNGC4649overlaid
with a mean probability of 1.0 across six detections. It has been
onaDSSNIRbandimageingrayscale.Thesymbolsindicatethemaster
classifiedasanellipticalgalaxy(DeVaucouleursetal.1991)with
classesassignedbyouralgorithm.
a Seyfert 2 AGN (Véron-Cetty &Véron 2006). The source is soft
(hard_hs<−0.5)andshowsremarkablylowvariabilityprobability
(var_prob_b<0.2).WhileSeyfert2galaxiestendtobeassociated
4 https://cxc.cfa.harvard.edu/csc/csc_crossmatches.html
MNRAS000,1–21(2022)
ceD
ceD
ytilibaborP
OSQ NGA 1_trefyeS 2_trefyeS BXMH BXML BX OSY *uaTT *V_noirO16 Pérez-Díazetal.
withharderspectra(thelineofviewintersectstheobscuringtorus ofambiguouslyclassifiedsourcesshowagreementbetweenthetwo
thatpreferentiallyabsorbssoft-X-rayphotons),thespecificorienta- votingsystems.Thissuggeststhatevenwhenthereisdisagreement
tionofthesystemwithrespecttothelineofsight,aswellasdifferent between the two voting systems for the fine classification between
contributions from scattering and reflection, can result in a softer the labels in Figure 4, a significant fraction of these ambiguous
spectrum. sourcescanstillbesuccessfullyclassifiedinthemoregeneralclasses
WeexaminedthepropertiesofsourcedetectionswithaYSOlabel of Figure 5. Taken all together, the probabilistic elements of our
inSIMBAD,aswellasthoselabelledasYSOsinourclassification, classification can provide insight into the nature of these objects,
andfoundthatthedensitydistributionsofpropertiesareconsistentfor evenintheabsenceofopticalcounterparts.
boththereferencesetandtheclassifiedset.Thereare,however,some
differenceincertainregionsoftheparameterspacethatcouldleadto
5.4 Limitationsandfuturework
misclassifications,becausethereferencesetisnotfullyrepresentative
ofthepopulation. Wehavedemonstratedthataunsupervisedapproachtotheclassifi-
cationofX-raysourcesispossibleevenintheabsenceofanoptical
confirmation.DespiteitsapplicabilitytoX-raycatalogs,theGMM
5.3 Differencesinthehardandsoftvotingclassifiers
approach that we have adopted has a number of limitations that
Our catalog of ambiguously classified objects comprises sources primarilystemfromtwofactors:a)theintrinsicdegeneracyinthe
whosehardandsoftclassificationdisagree.Thatis,forthesesources, observationalfeaturesofsourcesofdifferenttypes,andb)uncertain-
themostcommonclassamongdetectionsisnotthesameclasswith tiesintheknowledgebaseused(i.e.SIMBAD)toassociatecluster
the highest average probability. These are cases in which there is membershiptospecificclasses.
ambiguity between two different classes of similar types, such as Featuredegeneraciescanbemitigatedbyincorporatingancillary
AGNsandSeyferts.Weinvestigatesomeoftheseobjectsinorderto informationaboutindividualsources,suchasenvironmentalproper-
gainadditionalastrophysicalinsightabouthowthealgorithmasigns ties(galaxyhostinformation,amongothers).Whilethisisinprinci-
classes. plepossibleforafractionofX-raysources,itremainsunfeasiblefor
Source2CXOJ004228.2+411222has66detectionsandisclassi- X-ray sources without associated optical counterparts. Limitations
fiedasaLMXBbythehardvotingclassifier,andasHMXBbythesoft ontheknowledgebasecanbeaddressed,inprinciple,byconstruct-
votingclassifier.IndependentworkhasclassifieditasanX-raybi- ing detailed training sets based on spectroscopic classification or
nary/blackholecandidateinM31(Arnasonetal.2020;Barnardetal. otherindependentsignatures.Anexampleofthisisthetrainingset
2014,2013).Ontheotherhand,2CXOJ004246.9+411615,which presentedinYangetal.(2022).However,itisextremelydifficultto
hasalsobeenclassifiedasanX-raybinaryorblackholecandidatein constructsuchtrainingsetswhileensuringthattheyremainrepresen-
M31(Barnardetal.2014,2013)andhas22detections,isclassified tative,balanced,andunbiased.Thisisbothduetoclassimbalance
asaSeyfert_1bythehardvotingclassifier,andasaLMXBbythesoft andlackofindependentclassificationsforX-raysourcesinthema-
voting classifier. In this latter case the mean probabilities are 0.22 jority of cases. Furthermore, we refrain from using coordinates as
for the Seyfert_1 class and 0.23 for the LMXB) class. So, whereas featuresduetheCSC’sskewedandnon-homogeneousskycoverage,
in the case of 2CXO J004228.2+411222 the ambiguity can be in- which could introduce biases. We therefore embrace these limita-
terpretedintermsofadifferenceofspectralhardnessbetweentwo tions as a challenge to push the limits of X-ray only unsupervised
typesofX-raybinariesandourmethodstillassignsageneralclass classification.Inourexperiments,wefoundourmethodtoberobust
thatagreeswithpreviousliterature,inthelattercasethedifferencein againstclassimbalance,outperformingtraditionalclassificational-
probabilitybetweenthetwocandidateclassesisnegligible,andthe gorithms.Toevaluatetheimpactofclassimbalanceandcompareour
ambiguityisunlikelytoberesolvedwithoutadditionalinformation, approach’sperformancewithstandardsupervisedmethods,wede-
suchastheredshiftoftheintrinsicluminosityofthesource.Such tailaclassificationexerciseusingSupportVectorMachinesinonline
differencesbetweensoftandhardclassificationshouldbeconsidered AppendixB.
wheninterpretingtheresultsofourclassificationcatalog. Gaussian Mixture Models are constrained by the assumption of
TheX-raypulsarmagnetar2CXOJ010043.0-721133(Durant& Gaussian-distributedclusters,whichdoesnotholdformostdistribu-
vanKerkwĳk2005,2008)isclassifiedasanOrion_V*bythehard tions.Theirparametricnaturealsorestrictstheirabilitytofitmulti-
votingclassifier,andasaYSObythesoftvotingclassifierwith14 dimensionaldatadistributionsinpracticalproblems(Mallapragada
detections.BothassignedclassesfallintheaggregatedclassYSO. etal.2010).Weusedheuristicmethods(suchastheBICandelbow
Whilethedetectioncouldbeconsistentwithapulsarwithafading methods) and identification of property distribution across multi-
opticalcounterpart(Durant&vanKerkwĳk2005,2008),thereason ple experiments to choose a number of Gaussian components that
thatitgotassignedaYSOclassisthattheclass"pulsar"isnotamong matches the overall behavior of the feature distributions. Alterna-
the classes that we have selected to be assigned to the classified tivemethodsinvolvetheuseofGaussianMixtureswithaDirichlet
objects.Youngstarsandpulsarsmightsharesomeoftheirproperties processprior(Tehetal.2010;Görür&EdwardRasmussen2010),
inthespaceofX-rayfeatures. orothernon-parametricproposals(Mallapragadaetal.2010).Also,
Finally,source2CXOJ020938.5-100847isclassifiedasaTTau* spectralclusteringisageneralizationofclassicalclusteringmethods
by the hard voting classifier, and as an AGN by the soft voting andiscapableofidentifyingnon-convexclusters(Hastieetal.2009).
classifier.Thissourceonlyhas2detections.Meanprobabilitiesare The pipeline proposed here is similar to the cluster-then-label
0.19forTTau*and0.44forAGN,whichfavorthe𝐴𝐺𝑁label.Infact, semi-supervisedmethod,whereinaclusteringalgorithmisfirstem-
thesourceislocatedlessthan2arcsecondsfromthenuclearregionof ployed,followedbyasupervisedlearnertolabeltheunlabeledpoints
galaxyNGC838inthegroupHCG16(O’Sullivanetal.2014),which ineachcluster(Zhu&Goldberg2009).Inourcase,theMahalanobis
has been spectroscopically classified as an active galaxy (LINER distance acts as the supervised learner, although each cluster can
type). In this case, the mean probabilities are more informative of containmultipleclasses,whichjustifiesourprobabilisticapproach.
thetrueclassoftheobjects.Overall,ifthethreeaggregatedclasses Arecurrentversionofthismodelallowsfortherapidclassification
(AGN+Seyfert,XB, YSO)are used,46% ofthe sourcesin thelist of new detections, which would allow for the incorporation of the
MNRAS000,1–21(2022)UnsupervisedMachineLearning 17
modeltodataprocessingpipelinesofChandraorotherobservato- aprobabilitydistributionoverclasses,aswellasameasureoftheun-
ries.Usingourmethod,sourceswithdiverginghardandsoftvoting certaintyinitsassignedclass.Wehavevalidatedourclassificationby
classifications could be used to recognize objects with significant usinganinternalvalidationset,andbycomparingourclassification
spectralorfluxvariabilitybetweenobservations,suchasX-raybina- withthoseperformedusingsupervisedapproaches.
riestransitioningbetweenstates. (iii) Our methodology is particularly successful at identifying
It should be noted that comparisons of probabilities between emissionfromyoungstellarobjects,withan88%overallaccuracy.
source detections in different clusters may not be informative for Whencomparedwithexistingclassificationcatalogs,ourclassifica-
thepurposesofcomparingthosetwoobservations.Thatisbecause tioncanreachalevelagreementabove90%inidentifyingAGNsand
theprobabilitiespresentedinourresultsarerelativetoeachcluster’s Seyfertgalaxies.
individualspace.Forinstance,theassignedprobabilityof100%for (iv) Our method is able to distinguish between small and large
source 2CXO J020938.4-100846 (as presented in Section 4) as an compactaccretors(thatis,X-raybinariesandactivegalacticnuclei)
HMXBimpliesthatwithinitsspecificcluster,thereferenceHMXB withmorethan50%confidence,despitethewidespreadassumption
distributionistheclosesttothesourcedetection. thatsuchaccretingsystemscanbeverysimilarintheirX-rayprop-
We emphasize that our pipeline is not only easily reproducible erties,anddifficulttoseparateintwodifferentclassesintheabsence
butalsoadaptabletoothercatalogclassificationendeavors.Wein- of a redshift or distance measurement. This distinction is possible
vite interested readers to explore the provided GitHub repository duetoawiderrangeofhardnessratiosinX-raybinariescompared
andimplementproposedmodifications.Thiscouldhelpenhancethe toAGNsandSeyferts,alongwithaslightlyhigheraveragehardness
performanceoftheworkorenableexplorationofotherapplications, forX-raybinaries,inparticularHMXBs.
such as the classification of nature-specific types of objects (e.g., (v) ComparedtoQSOsandAGNs,objectsclassifiedasX-raybi-
YSOandnon-YSOclassification). nariesshowalargerrangeofvariabilityinthebroadband,resembling
thepatternsobservedinSeyfertgalaxies,withaslightlyincreased
broad band variability. Resolved non-thermal coronal X-ray emis-
sionislikelytobeattherootofthissimilaritybetweensystemsof
6 SUMMARYANDCONCLUSIONS significantlydifferentmassesandphysicalscales.
(vi) Differencesinspectralvariabilityandhardnessratiosbetween
The automatic classification of X-ray sources is a necessary step
objectsclassifiedasQSOs,Seyfert1and2galaxies,andotherAGNs,
in extracting astrophysical information from compiled source cat-
areconsistentwiththeunifiedAGNmodel.
alogs. Classification is useful for the study of individual objects,
(vii) Broadbandvariabilitystandsasakeyfeaturetodifferentiate
statistics for population studies, as well as for anomaly detection,
XBsfromAGNs,whenrelyingsolelyonX-raydata.
i.e.,theidentificationofnewunexploredphenomena,includingtran-
(viii) Stellar variability due to coronal ejections in young stars
sientsandspectrallyextremesources.ThisistrueforChandradata,
ismanifestedinadistinctdistributionofvariabilitiesandhardness
andforotherX-raymissionsthathavecompiledcatalogsofX-ray
ratiosintheseobjects,thatinformstheirclassification.Short-lived
sourcesandtheirproperties,includingXMM-Newton,eROSITA,etc.
flaresofhardX-rayphotonsarealikelycauseofthisdistributionof
Despite the importance of this task, classification of astronomical
theX-rayfeatures.
X-ray sources remains challenging. This is due to mainly two is-
(ix) Our unsupervised method is similar to a semi-supervised
sues:i)asignificantfractionofX-raysourceslackopticalorinfrared
method,withaprobabilisticmetric(e.g.theMahalanobisdistance)
counterpartsthatcouldprovideusefulancillaryinformation,suchas
replacingaclassicalsupervisedclassifier.
redshift;andii)theconstructionofreliabletrainingsetsthatwouldal-
lowautomaticsupervisedlearningclassificationisnottrivial.These Ourcompleteresultsareaccessibleintheonlinesupplementary
trainingsetsareincompleteandunbalancedatbest,duetothelack material.Reproducibilityisfacilitatedthroughthecodeavailablein
ofspectroscopicconfirmationforasignificantnumberofsources. our GitHub repository: https://github.com/samuelperezdi/
Despitethesedifficulties,supervisedclassificationofX-raysource umlcaxs.Additionally,weprovideanotebookforclassifyingindi-
catalogs has been attempted (Yang et al. 2022; Chen et al. 2023; vidualX-raysources5.Weofferawebappplaygroundfordirectdata
Kumaranetal.2023).Sucheffortsrelyontheabilitytoobtainmulti- interaction: https://umlcaxs-playground.streamlit.app/.
wavelengthpropertiesorobservablesforthesourcestobeclassified, Here,userscanaccessvisualizationsofsourcepositionsinthesky
whichisnotalwayspossible.Inthiswork,wehavedevelopedanal- andtheirproperties,alongwithrespectiveclassifications.
ternativemethodologythatemploysunsupervisedmachinelearning
toprovideprobabilisticclassestoChandraSourceCatalogsources.
ThemethodreliesonclusteringofX-raypropertiessuchashardness
ACKNOWLEDGEMENTS
ratiosandvariabilityusingGaussianMixtures.Itsufferslessfromthe
lackofareliabletrainingset,asclassesareassignedbyassociation WewouldliketoexpressourgratitudetoHuiYang,EliasKrytsis,
withclustermembership,aswellassometopologicalconsiderations. and Andreas Zezas for insightful comments, discussions and sup-
Hereareourmainfindings: port. This research was made possible through the support from
NASA/ChandracontractAR1-22004X"MachineLearningDiscov-
(i) Asanalternativetodirectlylearningfromarepresentativeset
eryofX-RayTransientsintheChandraSourceCatalog2.0"andthe
oflabelledmulti-wavelengthtrainingsources,wehavedemonstrated
CXCResearchVisitorProgram.Theprovidedfundsfacilitatedthe
thatitispossibletoassignprobabilisticclassestoX-raysourcesby
scientific visit of V. S. Pérez-Díaz to the Center for Astrophysics
first clustering them according to the distribution of X-ray proper- (CfA)|Harvard&Smithsonian,whichallowedfurtherexploration
ties,andthenusingametric(theMahalanobisdistance)withineach
oftheresultsandsignificantdiscussions.Thisvisitwasalsopossible
clustertoevaluatetheirprobabilisticclassesbasedontheirdistance
toamuchlessrepresentativesetofindependentlyclassifiedsources.
(ii) Weprovideacatalogofprobabilisticclassesfor8,756sources, 5 https://github.com/samuelperezdi/umlcaxs/blob/main/
comprisingatotalof14,507detections.Foreachsource,weprovide classify_your_source.ipynb
MNRAS000,1–21(2022)18 Pérez-Díazetal.
thankstoUniversidaddelRosario,whichsupportedtravelexpenses HarrisC.R.,etal.,2020,Nature,585,357
throughtheIV-YIG001FONDODEINVESTIGACIÓNPORPRO- HastieT.,TibshiraniR.,FriedmanJ.H.,FriedmanJ.H.,2009,Theelements
DUCCIÓNACADÉMICA.R.D’A.issupportedbyNASAcontract ofstatisticallearning:datamining,inference,andprediction.Springer
NAS8-03060 (Chandra X-ray Center). We acknowledge the use of SeriesinStatisticsVol.2,Springer
JovanovićP.,PopovićL.Č.,2009,arXivpreprintarXiv:0903.0978
Chandra Source Catalog 2.0 data. Thiswork was developed under
the scopeof AstroAI6,a newcenter dedicatedto thedevelopment KumaranS.,MandalS.,BhattacharyyaS.,MishraD.,2023,MonthlyNotices
oftheRoyalAstronomicalSociety,520,5065
of artificial intelligence to enable next generation astrophysics at
LinD.,WebbN.A.,BarretD.,2012,TheAstrophysicalJournal,756,27
the CfA. For the purpose of open access, we have applied a Cre-
LoK.K.,FarrellS.,MurphyT.,GaenslerB.,2014,TheAstrophysicalJournal,
ativeCommonsAttribution(CCBY)licensetoanyAuthorAccepted
786,20
Manuscriptversionresultingfromthissubmission. Logan,C.H.A.Fotopoulou,S.2020,A&A,633,A154
LuoB.,etal.,2013,TheAstrophysicalJournalSupplementSeries,204,14
MahalanobisP.C.,1936,ProceedingsoftheNationalInstituteofSciences
(Calcutta),2,49
DATAAVAILABILITY
MallapragadaP.K.,JinR.,JainA.,2010,inJointIAPRInternationalWork-
Thedatasupportingthisarticlecanbefoundwithinthearticleitself shopsonStatisticalTechniquesinPatternRecognition(SPR)andStruc-
turalandSyntacticPatternRecognition(SSPR).pp334–343
anditsassociatedonlinesupplementalcontent.
Matt,G.Bianchi,S.Guainazzi,M.Barcons,X.Panessa,F.2012,A&A,540,
SupplementaryfilesareavailableatMNRASonline.
A111
appendix.pdf
McLachlanG.J.,KrishnanT.,2007,TheEMalgorithmandextensions.John
Wiley&Sons
MerloniA.,etal.,2012,eROSITAScienceBook:MappingtheStructureof
theEnergeticUniverse(arXiv:1209.3114)
REFERENCES
NandraK.,etal.,2013,arXivpreprintarXiv:1306.2307
AdamsD.,1995,TheHitchhiker’sGuidetotheGalaxy Neal R. M., Hinton G. E., 1998, A View of the Em Algorithm that Jus-
Ansari,ZoeAgnello,AdrianoGall,Christa2021,A&A,650,A90 tifies Incremental, Sparse, and other Variants. Springer Netherlands,
ArnasonR.,BarmbyP.,VulicN.,2020,MonthlyNoticesoftheRoyalAstro- Dordrecht, pp 355–368, doi:10.1007/978-94-011-5014-9_12, https:
nomicalSociety,492,5075 //doi.org/10.1007/978-94-011-5014-9_12
BallantyneD.,XiangX.,2020,MonthlyNoticesoftheRoyalAstronomical O’SullivanE.,etal.,2014,TheAstrophysicalJournal,793,73
Society,496,4255 ObertoA.,etal.,2020a,inBallesterP.,IbsenJ.,SolarM.,ShortridgeK.,
BarnardR.,GarciaM.R.,MurrayS.S.,2013,TheAstrophysicalJournal, eds, Astronomical Society of the Pacific Conference Series Vol. 522,
770,148 AstronomicalDataAnalysisSoftwareandSystemsXXVII.p.105
BarnardR.,GarciaM.R.,PriminiF.,MurrayS.S.,2014,TheAstrophysical ObertoA.,etal.,2020b,inBallesterP.,IbsenJ.,SolarM.,ShortridgeK.,
Journal,791,33 eds, Astronomical Society of the Pacific Conference Series Vol. 522,
BishopC.M.,2006,PatternRecognitionandMachineLearning(Information AstronomicalDataAnalysisSoftwareandSystemsXXVII.p.105
ScienceandStatistics).Springer-Verlag,Berlin,Heidelberg O’dellC.,2001,AnnualReviewofAstronomyandAstrophysics,39,99
ChenS.,KargaltsevO.,YangH.,HareJ.,VolkovI.,RangelovB.,TomsickJ., PadovaniP.,etal.,2017,TheAstronomyandAstrophysicsReview,25,1
2023,TheAstrophysicalJournal,948,59 PedregosaF.,etal.,2011,JournalofMachineLearningResearch,12,2825
CohenJ.,1960,Educationalandpsychologicalmeasurement,20,37 PetersonB.M.,1997,Anintroductiontoactivegalacticnuclei.Cambridge
D’AbruscoR.,FabbianoG.,MineoS.,StraderJ.,FragosT.,KimD.W.,Luo UniversityPress
B.,ZezasA.,2014,ApJ,783,18 PetrucciP.,etal.,2001,TheAstrophysicalJournal,556,716
DadinaM.,VignaliC.,CappiM.,LanzuisiG.,PontiG.,DeMarcoB.,Chartas PineauF.-X.,DerriereS.,MichelL.,MotchC.,2010,inAstronomicalData
G.,GiustiniM.,2016,Astronomy&Astrophysics,592,A104 AnalysisSoftwareandSystemsXIX.p.369
De Vaucouleurs G., De Vaucouleurs A., Corwin J., Buta R., Paturel G., PredehlP.,etal.,2021,Astronomy&Astrophysics,647,A1
FouqueP.,1991,ThirdReferenceCatalogueofBrightGalaxies,Version PreibischT.,etal.,2005,TheAstrophysicalJournalSupplementSeries,160,
3.9.Springer,NewYork,NY 401
DeisenrothM.P.,FaisalA.A.,OngC.S.,2020,MathematicsforMachine RaniB.,MadejskiG.,MushotzkyR.,ReynoldsC.,HodgsonJ.,2018,The
Learning.CambridgeUniversityPress AstrophysicalJournalLetters,866,L13
DempsterA.P.,LairdN.M.,RubinD.B.,1977,JournaloftheRoyalStatistical RemillardR.A.,McClintockJ.E.,2006,Annu.Rev.Astron.Astrophys.,44,
Society.SeriesB(Methodological),39,1 49
DurantM.,vanKerkwĳkM.H.,2005,TheAstrophysicalJournal,628,L135 RisalitiG.,MaiolinoR.,SalvatiM.,1999,TheAstrophysicalJournal,522,
DurantM.,vanKerkwĳkM.H.,2008,TheAstrophysicalJournal,680,1394 157
EvansI.N.,etal.,2010,TheAstrophysicalJournalSupplementSeries,189, RostamiOsanlooM.,RangelovB.,KargaltsevO.,HareJ.,2019,AAS,233,
37 457
FarrellS.A.,MurphyT.,LoK.K.,2015,TheAstrophysicalJournal,813,28 SchubertE.,2022,arXive-prints,p.arXiv:2212.12189
Fernández-OntiverosJ.A.,Muñoz-DariasT.,2021,MonthlyNoticesofthe SchwarzG.,1978,TheAnnalsofStatistics,6,461
RoyalAstronomicalSociety,504,5726 SicilianD.,CivanoF.,CappellutiN.,BuchnerJ.,PecaA.,2022,TheAstro-
GaleevA.,RosnerR.,VaianaG.,1979,TheAstrophysicalJournal,229,318 physicalJournal,936,39
GaskinJ.A.,etal.,2019,JournalofAstronomicalTelescopes,Instruments, SoldiS.,etal.,2014,Astronomy&Astrophysics,563,A57
andSystems,5,021001 Solorio-FernándezS.,Carrasco-OchoaJ.A.,Martínez-TrinidadJ.F.,2020,
GoodfellowI.,BengioY.,CourvilleA.,2016,DeepLearning.MITPress ArtificialIntelligenceReview,53,907
GörürD.,EdwardRasmussenC.,2010,JournalofComputerScienceand StraderJ.,etal.,2012,TheAstrophysicalJournal,760,87
Technology,25,653 Szegedi-ElekE.,KunM.,ReipurthB.,PálA.,BalázsL.,WillmanM.,2013,
HaardtF.,MaraschiL.,1991,AstrophysicalJournal,Part2-Letters(ISSN TheAstrophysicalJournalSupplementSeries,208,28
0004-637X),vol.380,Oct.20,1991,p.L51-L54.,380,L51 TaylorM.B.,2005,inShopbellP.,BrittonM.,EbertR.,eds,Astronomical
SocietyofthePacificConferenceSeriesVol.347,AstronomicalData
AnalysisSoftwareandSystemsXIV.p.29
6 http://astroai.cfa.harvard.edu/ TehY.W.,etal.,2010,Encyclopediaofmachinelearning,1063,280
MNRAS000,1–21(2022)UnsupervisedMachineLearning 19
TestaP.,2010,ProceedingsoftheNationalAcademyofSciences,107,7158
ThorndikeR.L.,1953,inPsychometrika.
TobaY.,etal.,2014,TheAstrophysicalJournal,788,45
TraninH.,GodetO.,WebbN.,PrimoracD.,2022,Astronomy&Astrophysics,
657,A138
Turner T., George I., Nandra K., Mushotzky R., 1997, The Astrophysical
Journal,488,164
Véron-CettyM.-P.,VéronP.,2006,Astronomy&Astrophysics,455,773
Véron-Cetty,M.-P.Véron,P.2006,A&A,455,773
VolonteriM.,ReinesA.E.,AtekH.,StarkD.P.,TrebitschM.,2017,The
AstrophysicalJournal,849,155
WengerM.,etal.,2000,AAPS,143,9
WĳnandsR.,VanDerKlisM.,1998,nature,394,344
Wilkes B., Tucker W., eds, 2019, The Chandra X-ray Observatory. 2514-
3433, IOP Publishing, doi:10.1088/2514-3433/ab43dc, http://dx.
doi.org/10.1088/2514-3433/ab43dc
YangH.,HareJ.,KargaltsevO.,VolkovI.,ChenS.,RangelovB.,2022,The
AstrophysicalJournal,941,104
ZhouZ.-H.,2012,Ensemblemethods:foundationsandalgorithms.CRCpress
ZhuX.,GoldbergA.B.,2009,Synthesislecturesonartificialintelligence
andmachinelearning,3,1
APPENDIXA: MACHINEREADABLETABLES
MNRAS000,1–21(2022)agg_master_class master_class detection_count QSO AGN Seyfert_1 Seyfert_2 HMXB LMXB XB YSO TTau* Orion_V*
name
2CXOJ004231.1+411621 XB HMXB 97 0.056±0.152 0.156±0.209 0.079±0.151 0.04±0.106 0.241±0.215 0.213±0.228 0.142±0.222 0.024±0.066 0.004±0.016 0.044±0.164
2CXOJ004248.5+411521 XB HMXB 93 0.039±0.107 0.113±0.175 0.121±0.174 0.091±0.193 0.274±0.254 0.159±0.185 0.169±0.242 0.012±0.031 0.003±0.014 0.019±0.099
2CXOJ123049.3+122328 Seyfert Seyfert_1 85 0.113±0.249 0.138±0.241 0.467±0.397 0.102±0.251 0.021±0.106 0.017±0.115 0.023±0.121 0.035±0.128 0.024±0.106 0.059±0.184
2CXOJ004254.9+411603 XB HMXB 84 0.053±0.165 0.096±0.147 0.065±0.119 0.093±0.219 0.309±0.256 0.179±0.186 0.152±0.201 0.032±0.125 0.008±0.041 0.013±0.035
2CXOJ004232.0+411314 XB HMXB 80 0.014±0.081 0.059±0.142 0.153±0.262 0.257±0.348 0.335±0.367 0.094±0.192 0.07±0.179 0.006±0.032 0.0±0.001 0.012±0.105
2CXOJ004247.1+411628 XB HMXB 71 0.054±0.177 0.078±0.142 0.076±0.157 0.071±0.185 0.284±0.263 0.179±0.234 0.161±0.235 0.039±0.119 0.002±0.006 0.057±0.196
2CXOJ004213.1+411836 YSO YSO 71 0.0±0.002 0.0±0.0 0.0±0.0 0.0±0.002 0.003±0.014 0.027±0.157 0.0±0.0 0.505±0.374 0.11±0.207 0.355±0.35
2CXOJ004257.9+411104 AGN AGN 60 0.062±0.106 0.194±0.238 0.097±0.16 0.101±0.227 0.183±0.233 0.109±0.173 0.141±0.234 0.028±0.098 0.029±0.097 0.056±0.177
2CXOJ123049.4+122327 AGN AGN 57 0.229±0.279 0.267±0.344 0.188±0.249 0.096±0.244 0.015±0.096 0.035±0.184 0.0±0.003 0.121±0.323 0.009±0.067 0.039±0.172
2CXOJ123048.6+122332 Seyfert Seyfert_1 53 0.109±0.251 0.242±0.361 0.315±0.409 0.035±0.128 0.074±0.219 0.015±0.102 0.004±0.028 0.037±0.122 0.066±0.214 0.104±0.251
TableA1.Asampleoftheuniquelyclassifiedclassificationtable,availableintheonlinesupplementarymaterialandthepaper’sGitHubrepositoryasuniquely_classified.csv.Meanprobabilitiesandstandard
deviationsarehighlightedinboldtextforthemasterclass.Notethatadditionalpropertycolumnsarenotincludedinthissample.
hard_master_class soft_master_class detection_count QSO AGN Seyfert_1 Seyfert_2 HMXB LMXB XB YSO TTau* Orion_V*
name
2CXOJ004228.2+411222 LMXB HMXB 66 0.057±0.136 0.113±0.181 0.128±0.234 0.095±0.217 0.217±0.238 0.171±0.211 0.167±0.25 0.006±0.017 0.004±0.018 0.043±0.17
2CXOJ004246.9+411615 Seyfert_1 LMXB 22 0.074±0.143 0.063±0.088 0.219±0.258 0.118±0.2 0.125±0.148 0.226±0.236 0.115±0.181 0.005±0.013 0.003±0.013 0.051±0.203
2CXOJ004244.3+411608A Seyfert_1 QSO 15 0.24±0.297 0.09±0.126 0.162±0.203 0.092±0.25 0.06±0.125 0.027±0.056 0.012±0.03 0.155±0.284 0.014±0.041 0.147±0.277
2CXOJ004244.3+411608 Seyfert_1 QSO 15 0.24±0.297 0.09±0.126 0.162±0.203 0.092±0.25 0.06±0.125 0.027±0.056 0.012±0.03 0.155±0.284 0.014±0.041 0.147±0.277
2CXOJ010043.0-721133 Orion_V* YSO 14 0.0±0.0 0.0±0.0 0.0±0.0 0.0±0.0 0.009±0.022 0.121±0.29 0.0±0.0 0.423±0.408 0.035±0.101 0.412±0.379
2CXOJ004242.4+411553 XB HMXB 13 0.005±0.007 0.068±0.115 0.135±0.137 0.108±0.188 0.277±0.256 0.153±0.154 0.247±0.269 0.001±0.002 0.0±0.0 0.006±0.022
2CXOJ063354.3+174614 AGN Seyfert_1 11 0.221±0.197 0.348±0.29 0.419±0.33 0.011±0.031 0.001±0.002 0.0±0.0 0.0±0.0 0.0±0.0 0.0±0.0 0.0±0.0
2CXOJ133656.6-294912 LMXB HMXB 11 0.001±0.002 0.034±0.041 0.01±0.016 0.022±0.062 0.373±0.31 0.361±0.24 0.106±0.127 0.001±0.002 0.0±0.0 0.091±0.287
2CXOJ061538.9-574204 YSO HMXB 10 0.0±0.0 0.0±0.0 0.0±0.0 0.0±0.0 0.4±0.49 0.216±0.395 0.0±0.0 0.384±0.472 0.0±0.0 0.0±0.001
2CXOJ053816.3-692331 Orion_V* YSO 10 0.0±0.0 0.0±0.0 0.0±0.0 0.0±0.0 0.0±0.001 0.0±0.0 0.0±0.0 0.505±0.426 0.0±0.0 0.495±0.426
TableA2.Asampleoftheambiguoustable,availableintheonlinesupplementarymaterialandthepaper’sGitHubrepositoryasambiguous_classification.csv.Hardandsoftmasterclassesareprovided.
Notethatadditionalpropertycolumnsarenotincludedinthissample.
MNRAS000,1–21(2022) 20
Pérez-Díazetal.UnsupervisedMachineLearning 21
ThispaperhasbeentypesetfromaTEX/LATEXfilepreparedbytheauthor.
MNRAS000,1–21(2022)
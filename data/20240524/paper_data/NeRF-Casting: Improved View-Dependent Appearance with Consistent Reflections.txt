NeRF-Casting: Improved View-Dependent Appearance with Consistent
Reflections
DORVERBIN,Google,USA
PRATULP.SRINIVASAN,Google,USA
PETERHEDMAN,Google,UK
BENMILDENHALL,Google,USA
BENJAMINATTAL,CarnegieMellonUniversity,USA
RICHARDSZELISKI,Google,USA
JONATHANT.BARRON,Google,USA
Interactivewebpageathttps://nerf-casting.github.io
(a)Zip-NeRF[Barronetal.2023] (b)UniSDF[Wangetal.2023] (c)Ours (d)Groundtruth
Fig.1. Ourmethod,NeRF-Casting,recoversandrenderssceneswithhigher-qualityreflectionsthanpriorwork.Hereweshowcroppedrenderingsanda
ground-truthimageforasceneinourdataset(top),aswellasaslicefromavideorenderingalongasmoothcamerapath(onehorizontalrowofpixelsstacked
verticallyacrossmultiplevideoframes)toemphasizethecontinuityofhigh-frequencyreflectedcontentinourresult(bottom).Pleaseseethevideosprovided
inthesupplementalwebpagetoobservetheaccuratemotionofourrenderedreflections.
1 INTRODUCTION
NeuralRadianceFields(NeRFs)typicallystruggletoreconstructandrender
highlyspecularobjects,whoseappearancevariesquicklywithchangesin NeuralRadianceFields(NeRFs)representa3Dscene‚Äôsunderlying
viewpoint.RecentworkshaveimprovedNeRF‚Äôsabilitytorenderdetailed
geometryandcolorusingneuralnetworks,forthegoalofrender-
specularappearanceofdistantenvironmentillumination,butareunable
ingnovelunobservedviewsofthescene.EarlyvariantsofNeRF
tosynthesizeconsistentreflectionsofclosercontent.Moreover,thesetech-
usedmulti-layerperceptrons(MLPs)tomapfrom3Dcoordinates
niquesrelyonlargecomputationally-expensiveneuralnetworkstomodel
tovolumedensitiesandview-dependentcolors.However,thelarge
outgoingradiance,whichseverelylimitsoptimizationandrenderingspeed.
Weaddresstheseissueswithanapproachbasedonraytracing:insteadof MLPsneededtorepresentdetailed3Dgeometryandcolorareex-
queryinganexpensiveneuralnetworkfortheoutgoingview-dependent tremelyslowtotrainandevaluate.Recentworkhasfocusedon
radianceatpointsalongeachcameraray,ourmodelcastsreflectionrays makingNeRFmoreefficientbyreplacinglargeMLPswithvoxel-
fromthesepointsandtracesthemthroughtheNeRFrepresentationtorender grid-likedatastructuresorcombinationsofgridsandsmallMLPs.
featurevectorswhicharedecodedintocolorusingasmallinexpensivenet- ThesemethodshaveenabledscalingNeRFtorepresentingdetailed
work.Wedemonstratethatourmodeloutperformspriormethodsforview large-scalescenes,buttheirbenefitsarelimitedto3Dgeometryand
synthesisofscenescontainingshinyobjects,andthatitistheonlyexisting
mostlydiffusecolor.
NeRFmethodthatcansynthesizephotorealisticspecularappearanceand
ScalingNeRF‚Äôsabilitytomodelrealisticview-dependentappear-
reflectionsinreal-worldscenes,whilerequiringcomparableoptimization
anceisstillachallenge.State-of-the-artmodelsforviewsynthesis
timetocurrentstate-of-the-artviewsynthesismodels.
ofshinyobjectswithhigh-frequencyview-dependentappearance
CCSConcepts:‚Ä¢Computingmethodologies‚ÜíReflectancemodeling;Ray arelimitedintwoways.First,theyareonlyabletosynthesizeaccu-
tracing;3Dimaging. ratereflectionsofdistantenvironmentilluminationandstruggleto
renderconvincingreflectionsofnearbyscenecontent.Second,they
AdditionalKeyWordsandPhrases:Viewsynthesis,neuralradiancefields,
reflections
4202
yaM
32
]VC.sc[
1v17841.5042:viXra2 ‚Ä¢ Verbinetal.
relyonlargeMLPstorepresenttheview-dependentoutgoingradi- thatarebetterforrenderingsurfacereflection.SpecNeRF[Maetal.
anceatanypointandstruggletoscaletolargerreal-worldscenes 2023]modifiesRef-NeRF‚Äôsencodingofviewdirectionstovaryspa-
withdetailedreflections. tiallyaccordingtoasetofoptimized3DGaussians,whichhelps
Wepresentanapproachthatsolvesbothoftheseissuesbyintro- theview-dependentcolornetworkmodelreflectionsofnearbycon-
ducingraytracingintoNeRF‚Äôsrenderingmodel.Insteadofquerying tent.However,thisencodingdoesnotensureaccuratereflections
anexpensiveMLPfortheview-dependentappearanceateachpoint whenlightsourcesareoccluded.NeAI[Zhuangetal.2024]traces
alongacameraray,ourmethodcastsreflectionraysfromthese reflectionconeswithinanMLP-basedNeRFtocomputespecular
pointsintotheNeRFgeometry,samplesproperlyanti-aliasedfea- appearance,butrequiresground-truthgeometryandmasksthatsep-
turesfromthereflectedscenecontent,andusesasmallMLPto aratetheobjectfromtheenvironmentinordertosupervisetheMLP
decodethesefeaturesintoreflectedcolor.Castingraysintothere- thatrepresentsreflectedlighting.WorkconcurrenttooursbyWu
coveredNeRFnaturallysynthesizesconsistentreflectionsofnearby etal.[2024]proposesaNeuralDirectionalEncodingthatalsotraces
anddistantcontent.Moreover,computingappearancebyraytracing conesthroughtheNeRFmodeltosimulatenear-fieldreflections.
reducestheburdenofrepresentinghighly-detailedview-dependent However,theyrelyonalargeMLPtorepresentgeometry,which
functionsateachpointinthescenewithalargeMLP. isslowtotrainandrendercomparedtomoremoderngrid-based
Ourapproachisbothmoreefficientthanpriorworkforimprov- representations.Furthermore,theyprimarilyfocusonsynthetic
ingNeRF‚Äôsview-dependentappearanceandrendershigherquality sceneswithclearlyseparatednear-fieldanddistantcontent.
specularreflections,particularlyofnearbycontent. Themethodsdiscussedaboveaddressthesameproblemasour
work:improvingview-dependentappearanceinviewsynthesis.An
alternativeapproachtosynthesizingspecularappearanceisinverse
2 RELATEDWORK
rendering:estimatingrepresentationsofscenematerialsandlight-
ANeuralRadianceField[Mildenhalletal.2020]consistsofanMLP ing,alongsidegeometry.ManyexistingworkscombineNeRFwith
thatmapsfroma3Dcoordinatewithinthescenetothecorrespond- inverserenderingandexplicitlymodellighttransportthroughthe
ingvolumedensityandview-dependentcoloratthatposition.NeRF 3Dscenetorecoverrepresentationsthatcanrenderspecularap-
rendersrayspassingthroughascenebyqueryingtheMLPatsam- pearance[Bietal.2020;Jinetal.2023;Maietal.2023;Srinivasan
pledpointsalongeachrayandintegratingthereturnedvolume etal.2021].However,thesetechniquesmustperformexpensive
densitiesandcolorsintoasinglecolor.EvaluatinganMLPhundreds MonteCarlointegrationovertheentirehemisphereofincoming
ofmillionsoftimestorenderasingleimagecanbeprohibitively lighting(usinghundredstothousandsofsampledreflectionrays)to
slow,sorecentresearchhasfocusedonmakingNeRFmoreefficient estimateoutgoingradianceatanypointinthescene,andtheyare
andscalable.Inparticular,manyeffectivemethodstradecompute typicallyordersofmagnitudeslowerthanstandardNeRFmodels.
forstorageandleveragedatastructuresbasedonvoxelgridstoac- Ourproposedmethodspecificallyfocusesonrenderingspecular
celerateNeRF‚Äôsoptimizationandrendering.Theseincludestandard appearanceforviewsynthesisandisabletorenderaccuratereflec-
voxelgrids[Fridovich-Keiletal.2022;Karnewaretal.2022;Sunetal. tionswithlowcomputationaloverheadcomparedtoexistingview
2022],low-ranktensorfactorizations[Chenetal.2022],andvoxel synthesismodels.
pyramidswithhashmaps[M√ºlleretal.2022].Thesemethodsare
primarilyfocusedonscalingNeRF‚Äôsrepresentationof3Dvolume 3 PRELIMINARIESANDNOTATION
densitytorepresentlargerandmoredetailedscenes.However,they
NeuralRadianceFields[Mildenhalletal.2020]usesvolumerender-
donotusuallymodifyNeRF‚Äôsrepresentationofview-dependent
ingtocombinethedensitiesandemittedview-dependentradiance
color,whichisa5Dfunctionofbothpositionandviewingdirection.
valuesatsamplesalongrays:
AseparatelineofworkhasfocusedonimprovingNeRF‚Äôsability
toreconstructandrenderhighlyspecular(orshiny)content.Ref- c¬Ø=‚àëÔ∏Å ùë§(ùëñ)c(ùëñ), (1)
NeRF[Verbinetal.2022]demonstratedthatreparameterizingoutgo- ùëñ
ingradianceasafunctionofthereflectedviewdirectioniseffective
in cases where geometry is estimated accurately. However, Ref- ùë§(ùëñ)=(cid:16) 1‚àíexp(cid:16) ‚àíùúè(ùëñ)(cid:16) ùë°(ùëñ+1) ‚àíùë°(ùëñ)(cid:17)(cid:17)(cid:17) exp(cid:169)‚àí‚àëÔ∏Å ùúè(ùëó)(cid:16) ùë°(ùëó+1) ‚àíùë°(ùëó)(cid:17) (cid:170)
(cid:173) (cid:174)
NeRF‚Äôsparameterizationofoutgoingradianceismosteffectivefor ùëó<ùëñ
(cid:171) (cid:172)
objectsthataremainlyilluminatedbydistantlightsources,whichis
oftenthecaseforsynthetically-generatedscenes.Furthermore,the
whereùë°(ùëñ) istheùëñthsamplealongtheray,andùúè(ùëñ) andc(ùëñ)
arethe
outgoingradianceateverypointmustbeencodedintheweightsof volumedensityandcolor(respectively)attheùëñthsamplelocation,o+
anMLP.Inthecaseofhighlyglossyobjects,thisMLPmusthavea
ùë°(ùëñ)d,whereoistheray‚Äôsoriginandditsdirection.Throughoutthis
largeenoughcapacitytorepresenttheentireenvironmentviewed paperwedenotethevolume-renderedvalueswitha‚Äúbar‚Äù,similar
from any point in the scene, and is therefore costly to evaluate. toc¬ØontheleftofEquation1.
Otherworksthatfocusonrecoveringspecularappearancewith Mip-NeRF[Barronetal.2021]replacesinfinitesimalrayswith
NeRFalsoadoptRef-NeRF‚Äôsreparameterizationofview-dependent pixelconeswithorigino,directiondandradiusùëü(cid:164)(determinedby
appearance.ENVIDR[Liangetal.2023]pre-trainstheMLPthat thepixelfootprintontheimageplane).Castingconesinsteadof
mapsfromreflectiondirectiontocolortoeffectivelyencodeaprior rayspreventsaliasinginthescenerepresentationandasaresult,
onview-dependentappearance.UniSDF[Wangetal.2023]improves preventsaliasingintherenderedimages.Torepresentlarge-scale
Ref-NeRF‚Äôsgeometryrepresentationtoobtainsmoothernormals unbounded scenes, mip-NeRF 360 [Barron et al. 2022] allocatesNeRF-Casting:ImprovedView-DependentAppearancewithConsistentReflections ‚Ä¢ 3
h spig ah tie ar lr ce op nr te rs ae cn tt ioat nio fn ua nl cc ta iop nac ti hty atto mp ao pi sn ats lln pe oa ir nt th se inca Rm 3e tr oas au ss pi hn eg rea o<latexit sha1_base64="TwGJC6/tAJWp4InnfoILVwaRgKI=">AAAEBXicdVNLbxMxEHYbHmV5tXDksmJbiUuj7CY8jitx6bFIpK1Yryqv422s+LGyvTSR5TN/gCv8A26IK7+DH8D/wN4EKeljJEsz3/gbz4xnqoZRbQaDP1vbvTt3793feRA9fPT4ydPdvWcnWrYKkzGWTKqzCmnCqCBjQw0jZ40iiFeMnFaz98F/+pkoTaX4aBYNKTm6ELSmGBkPfYIcmWlVW+nOd5NBf9BJfF1JV0oCVnJ8vrf9F04kbjkRBjOkdZEOGlNapAzFjLgItpo0CM/QBSm8KhAnurRdyi4+8MgkrqXyR5i4Q9cZFnGtF7zyN0OK+qovgDf6MBKYsI3X7SXSCx9sEwxUIyXTm/C8VghfSd7U70pLRdMaIvAy97plsZFxaGk8oYpgwxZeQVhRX36Mp8iHMb7xUeR7PCPI/4zxdgQFucSScyQmFuq2IYryRmriimFZdN8h1aS0SWo7o0Edb/1mbm2SOZsMnZdb4+WuyMpNJPdRnafezslDFvYgimMoJWL0QnSGN6c1ZfuQ52aapEm239kQqxucw3WnO4jc/wZIM/X1bz7uR3OhfcUGKSUvXZGWxTAMUVe7Imz5PJxWcm6hahkp4IRyMm8UDHMTdJFl0JC5CXZ22M8aAz0RzUMPne2PGuPcMgqfESUOR7xdxQvf6El27Kyf34Wz3FnhYBg7yewo7fob+cVIr67BdeUk66dv+q8/jJL8aLUiO+AFeAlegRS8BTk4AsdgDDAQ4Cv4Br73vvR+9H72fi2vbm+tOM/BhvR+/wMdd1gP</latexit> b<latexit sha1_base64="DmyBoOQI9TwoTisFpiuYXZUBi2w=">AAAEKHicdVPLbhMxFHUbHmV4tIUlm4FppSJolJmEx3IEG5ZFIm2l8VB5HE9ixY+R7aGJLH8Ev8EPsIU/YIe6ReI/8ExSqenjWpbuPdfn2vfhomJUm17vbG29c+v2nbsb94L7Dx4+2tzafnyoZa0wGWLJpDoukCaMCjI01DByXCmCeMHIUTH90PiPvhKlqRSfzbwiOUdjQUuKkfHQydZLyJGZFKUt3Be7R184+Ox8vYJ+hbAgBi1cJ1tRr9trJbyqxEslAks5ONle/wdHEtecCIMZ0jqLe5XJLVKGYkZcAGtNKoSnaEwyrwrEic5tm5ULdz0yCkup/BYmbNGLDIu41nNe+JNNDvqyrwGv9WEkMGErt9tTpOc+2CrYUI2UTK/Cs1IhfOnxpnyXWyqq2hCBF28vaxYaGTZVD0dUEWzY3CsIK+rTD/EE+TDG9yYIfBOmBPnmGW8HUJBTLDlHYmShriuiKK+kJi7r51nbL6lGuY1i2xoVankXT6bWRomzUd95uTFe6rIkX0VSH9V56s2ctHmF3Q3CEEqJGB2L1vDmpKRsB/LUTKI4SnZaG2J1jbN/0el2A3deAGkmPv/Vy/30zrXP2CCl5KnL4jzrN0PU5q4IW1wPJ4WcWahqRjI4opzMKgWbuWl0kSTQkJlp7GS/m1QGeiKaNTV0tjuojHOLKHxKlNgf8HoZr2mjJ9mhs35+585yZ4WDzdhJZgdxW9/Af4z48je4qhwm3fhN9/WnQZS+X36RDfAUPAd7IAZvQQo+ggMwBBh8Az/AT/Cr873zu/Onc7Y4ur625DwBK9L5+x9o4GNc</latexit> (,i) (i) DC eco olo dr e r c<latexit sha1_base64="7Lq4+b+RLHaB5/rsB0a6bsBgdqg=">AAAB+XicbVDLSsNAFL3xWesr6tLNYBHqpiQi1WXRjcsK9gFtLJPppB06mYSZSaGE/IkbF4q49U/c+TdO2iy09cDA4Zx7uWeOH3OmtON8W2vrG5tb26Wd8u7e/sGhfXTcVlEiCW2RiEey62NFORO0pZnmtBtLikOf044/ucv9zpRKxSLxqGcx9UI8EixgBGsjDWy7H2I99oOUZE9plV1kA7vi1Jw50CpxC1KBAs2B/dUfRiQJqdCEY6V6rhNrL8VSM8JpVu4nisaYTPCI9gwVOKTKS+fJM3RulCEKImme0Giu/t5IcajULPTNZJ5TLXu5+J/XS3Rw46VMxImmgiwOBQlHOkJ5DWjIJCWazwzBRDKTFZExlphoU1bZlOAuf3mVtC9rbr1Wf7iqNG6LOkpwCmdQBReuoQH30IQWEJjCM7zCm5VaL9a79bEYXbOKnRP4A+vzB3VOk48=</latexit> (i)
ofradius2: x<latexit sha1_base64="mHn6bfYqSH+pjtKKHBG2Kfybuvw=">AAAB+XicbVDLSsNAFL2pr1pfUZduBotQNyURqS6LblxWsA9oa5lMJ+3QySTMTIol5E/cuFDErX/izr9x0mahrQcGDufcyz1zvIgzpR3n2yqsrW9sbhW3Szu7e/sH9uFRS4WxJLRJQh7KjocV5UzQpmaa004kKQ48Ttve5Dbz21MqFQvFg55FtB/gkWA+I1gbaWDbvQDrsecnT+ljUmHn6cAuO1VnDrRK3JyUIUdjYH/1hiGJAyo04ViprutEup9gqRnhNC31YkUjTCZ4RLuGChxQ1U/myVN0ZpQh8kNpntBorv7eSHCg1CzwzGSWUy17mfif1421f91PmIhiTQVZHPJjjnSIshrQkElKNJ8ZgolkJisiYywx0aaskinBXf7yKmldVN1atXZ/Wa7f5HUU4QROoQIuXEEd7qABTSAwhWd4hTcrsV6sd+tjMVqw8p1j+APr8weVtZOk</latexit> (i) ‚åß<latexit sha1_base64="q2XvNx6lry1E6U29/R4Mq6OhILw=">AAAEaHichVNJb9NAFJ60AYrZUjggxMXUrVSkNoqdsBwtuHAsEmkreUw1noybUWaxZsY00Wh+JEd+ABf+AFfGTio1XcSzLL3te/PWomJUm8HgV2djs3vv/oOth8Gjx0+ePuttPz/WslaYjLFkUp0WSBNGBRkbahg5rRRBvGDkpJh9buwnP4jSVIpvZlGRnKNzQUuKkfGqs94MGlR/t/v0rYNvLr8D2H4h5MhMi9LO3R0ecIaqCv0PLlbws1406A9aCm8y8YqJwIqOzrY3fsOJxDUnwmCGtM7iQWVyi5ShmBEXwFqTCuEZOieZZwXiROe27YoL97xmEpZS+V+YsNVeRVjEtV7wwns2ierrtkZ5qw0jgQlbe91eIL3wwdaVDdRIyfS6el4qhK8lb8qPuaWiqg0ReJl7WbPQyLCZWjihimDDFp5BWFFffoinyIcxfrZB4Ds9I8gP33g5gIJcYMk5EhMLdV0RRXklNXHZMM/aoUg1yW0U21aoUIu76plaGyXORkPn6c54qcuSfF2T+qjOQ+/GpE0Wdi8IQyglYvRctIIXpyVlu5CnZhrFUbLbyhCrW4zDq0a3F7jLBkgz9fWvP+63f6F9xQYpJS9cFufZsFmitnZF2PJ5OC3k3EJVM5LBCeVkXinY7E3DiySBhsxNIyeH/aQy0APRvOmhs/1RZZxbRuEzosThiNereM0YPciOnfX7u3CWO38OsFk7yewobvsb+MOIr5/BTeY46cfv++++jqL00+pEtsBrsAP2QQw+gBR8AUdgDDD4Cf52QKez+afb677svlq6bnRWmBdgjbo7/wCjt3N1</latexit> (,i)x‚åß<latexit sha1_base64="q2XvNx6lry1E6U29/R4Mq6OhILw=">AAAEaHichVNJb9NAFJ60AYrZUjggxMXUrVSkNoqdsBwtuHAsEmkreUw1noybUWaxZsY00Wh+JEd+ABf+AFfGTio1XcSzLL3te/PWomJUm8HgV2djs3vv/oOth8Gjx0+ePuttPz/WslaYjLFkUp0WSBNGBRkbahg5rRRBvGDkpJh9buwnP4jSVIpvZlGRnKNzQUuKkfGqs94MGlR/t/v0rYNvLr8D2H4h5MhMi9LO3R0ecIaqCv0PLlbws1406A9aCm8y8YqJwIqOzrY3fsOJxDUnwmCGtM7iQWVyi5ShmBEXwFqTCuEZOieZZwXiROe27YoL97xmEpZS+V+YsNVeRVjEtV7wwns2ierrtkZ5qw0jgQlbe91eIL3wwdaVDdRIyfS6el4qhK8lb8qPuaWiqg0ReJl7WbPQyLCZWjihimDDFp5BWFFffoinyIcxfrZB4Ds9I8gP33g5gIJcYMk5EhMLdV0RRXklNXHZMM/aoUg1yW0U21aoUIu76plaGyXORkPn6c54qcuSfF2T+qjOQ+/GpE0Wdi8IQyglYvRctIIXpyVlu5CnZhrFUbLbyhCrW4zDq0a3F7jLBkgz9fWvP+63f6F9xQYpJS9cFufZsFmitnZF2PJ5OC3k3EJVM5LBCeVkXinY7E3DiySBhsxNIyeH/aQy0APRvOmhs/1RZZxbRuEzosThiNereM0YPciOnfX7u3CWO38OsFk7yewobvsb+MOIr5/BTeY46cfv++++jqL00+pEtsBrsAP2QQw+gBR8AUdgDDD4Cf52QKez+afb677svlq6bnRWmBdgjbo7/wCjt3N1</latexit> ((,,ii))‚á¢<latexit sha1_base64="WVvfe5RLFFsOvI8x88EWUAAI6XI=">AAAB8nicbVBNSwMxEM36WetX1aOXYBEqSNkVqR6LXjxWsB+wXUs2zbah2WRJZoWy9Gd48aCIV3+NN/+NabsHbX0w8Hhvhpl5YSK4Adf9dlZW19Y3Ngtbxe2d3b390sFhy6hUU9akSijdCYlhgkvWBA6CdRLNSBwK1g5Ht1O//cS04Uo+wDhhQUwGkkecErCS39VD9ZhV+NnkvFcqu1V3BrxMvJyUUY5Gr/TV7SuaxkwCFcQY33MTCDKigVPBJsVualhC6IgMmG+pJDEzQTY7eYJPrdLHkdK2JOCZ+nsiI7Ex4zi0nTGBoVn0puJ/np9CdB1kXCYpMEnni6JUYFB4+j/uc80oiLElhGpub8V0SDShYFMq2hC8xZeXSeui6tWqtfvLcv0mj6OAjtEJqiAPXaE6ukMN1EQUKfSMXtGbA86L8+58zFtXnHzmCP2B8/kDm8KQ1A==</latexit>xÔ£ø(((i,,ii))),nÔ£ø((,ii))n(i) <latexit sha1_base64="1/Du5LvyX9bd4ZWwolhiBQ34kIo=">AAACCXicbVDLSsNAFJ34rPUVdelmsAiuSiJSXRbdCG4q2Ac0IUymk3bsZBJmJkIZsnXjr7hxoYhb/8Cdf+OkzUJbD1w4nHMv994TpoxK5Tjf1tLyyuraemWjurm1vbNr7+13ZJIJTNo4YYnohUgSRjlpK6oY6aWCoDhkpBuOrwq/+0CEpAm/U5OU+DEachpRjJSRAht6kUBYezKLvRAJ7cVIjcJIR3lwn+f6Jg/smlN3poCLxC1JDZRoBfaXN0hwFhOuMENS9l0nVb5GQlHMSF71MklShMdoSPqGchQT6evpJzk8NsoARokwxRWcqr8nNIqlnMSh6SwOlfNeIf7n9TMVXfia8jRThOPZoihjUCWwiAUOqCBYsYkhCAtqboV4hEw0yoRXNSG48y8vks5p3W3UG7dnteZlGUcFHIIjcAJccA6a4Bq0QBtg8AiewSt4s56sF+vd+pi1LlnlzAH4A+vzBz8Qm1g=</latexit> f¬Ø j
(cid:40) x if‚à•x‚à• ‚â§1, PK
C(x)= (cid:16) 2‚àí ‚à•x1 ‚à•(cid:17) ‚à•xx
‚à•
if‚à•x‚à• >1. (2) o<latexit sha1_base64="TwGJC6/tAJWp4InnfoILVwaRgKI=">AAAEBXicdVNLbxMxEHYbHmV5tXDksmJbiUuj7CY8jitx6bFIpK1Yryqv422s+LGyvTSR5TN/gCv8A26IK7+DH8D/wN4EKeljJEsz3/gbz4xnqoZRbQaDP1vbvTt3793feRA9fPT4ydPdvWcnWrYKkzGWTKqzCmnCqCBjQw0jZ40iiFeMnFaz98F/+pkoTaX4aBYNKTm6ELSmGBkPfYIcmWlVW+nOd5NBf9BJfF1JV0oCVnJ8vrf9F04kbjkRBjOkdZEOGlNapAzFjLgItpo0CM/QBSm8KhAnurRdyi4+8MgkrqXyR5i4Q9cZFnGtF7zyN0OK+qovgDf6MBKYsI3X7SXSCx9sEwxUIyXTm/C8VghfSd7U70pLRdMaIvAy97plsZFxaGk8oYpgwxZeQVhRX36Mp8iHMb7xUeR7PCPI/4zxdgQFucSScyQmFuq2IYryRmriimFZdN8h1aS0SWo7o0Edb/1mbm2SOZsMnZdb4+WuyMpNJPdRnafezslDFvYgimMoJWL0QnSGN6c1ZfuQ52aapEm239kQqxucw3WnO4jc/wZIM/X1bz7uR3OhfcUGKSUvXZGWxTAMUVe7Imz5PJxWcm6hahkp4IRyMm8UDHMTdJFl0JC5CXZ22M8aAz0RzUMPne2PGuPcMgqfESUOR7xdxQvf6El27Kyf34Wz3FnhYBg7yewo7fob+cVIr67BdeUk66dv+q8/jJL8aLUiO+AFeAlegRS8BTk4AsdgDDAQ4Cv4Br73vvR+9H72fi2vbm+tOM/BhvR+/wMdd1gP</latexit> n<latexit sha1_base64="CULaGwAT5eUU7X4UncqIm+bfO70=">AAAEDXicdVNJbtswFGXiDqk6Oe2yG6FKgG5iWLI7LAV0k2UK1EkAUQgomooJcxBIKrFB8Ay9QLftDboruu0ZeoDeo6TsAnGGDxD4A9+ff9Uwqs1w+Gdru3fv/oOHO4+ix0+ePnve331xrGWrMJlgyaQ6rZAmjAoyMdQwctoognjFyEk1/xjsJxdEaSrFZ7NsSMnRuaA1xch41Vm/DyukLOTIzKraCufO+slwMOwovsmkayYBazo6293+C6cSt5wIgxnSukiHjSktUoZiRlwEW00ahOfonBSeFYgTXdoudRfve800rqXyT5i4015FWMS1XvLK/ww56uu2oLzVhpHAhG1Et5dIL72zTWWAGimZ3lQvaoXwteRN/aG0VDStIQKvcq9bFhsZh9bGU6oINmzpGYQV9eXHeIa8G+MHEEW+yXOC/ISMlyMoyCWWnCMxtVC3DVGUN1ITV4zKopuHVNPSJulqOA3qcFd/5tYmmbPJyHm601/uiqzc1OTeq/PQuzF5yMLuR3EMpUSMnotO8OKspmwP8tzMkjTJ9joZYnWLcXTV6PYj978B0sx8/ZvB/Youta/YIKXkpSvSshiFJepqV4StwsNZJRcWqpaRAk4pJ4tGwbA3gRdZBg1ZmCBnB4OsMdAD0SL00NnBuDHOrbzwOVHiYMzbtb8wRg+yE2f9/i6d5c5fAgxrJ5kdp11/I38Y6fUzuMkcZ4P03eDtp3GSH65PZAe8Aq/BG5CC9yAHh+AITAAGF+Ar+Aa+9770fvR+9n6tvm5vrTEvwQb1fv8D9+hbBA==</latexit>¬Ø x<latexit sha1_base64="cHTCEtFIyH3dYgH0dy3UwuVj/jQ=">AAAB/XicbVDLSsNAFL2pr1pf8bFzEyxC3ZREpLosunFZwT6gjWEynbRjJ5MwMxFrCP6KGxeKuPU/3Pk3TtsstHpg4HDOvdwzx48Zlcq2v4zCwuLS8kpxtbS2vrG5ZW7vtGSUCEyaOGKR6PhIEkY5aSqqGOnEgqDQZ6Ttjy4mfvuOCEkjfq3GMXFDNOA0oBgpLXnmXi9EaugH6X12k1boUealt5lnlu2qPYX1lzg5KUOOhmd+9voRTkLCFWZIyq5jx8pNkVAUM5KVeokkMcIjNCBdTTkKiXTTafrMOtRK3woioR9X1lT9uZGiUMpx6OvJSVY5703E/7xuooIzN6U8ThTheHYoSJilImtShdWngmDFxpogLKjOauEhEggrXVhJl+DMf/kvaR1XnVq1dnVSrp/ndRRhHw6gAg6cQh0uoQFNwPAAT/ACr8aj8Wy8Ge+z0YKR7+zCLxgf3+6rlY0=</latexit> ( ji) ‚åß<latexit sha1_base64="6dB0ekGhTr4c4HTqYxbgTjgYHLk=">AAACDXicbVDLSsNAFJ3UV62vqEs3g1WoICURqS6LblxWsA9oY5hMJ+3YySTMTIQS8gNu/BU3LhRx696df+OkDaitBy4czrmXe+/xIkalsqwvo7CwuLS8Ulwtra1vbG6Z2zstGcYCkyYOWSg6HpKEUU6aiipGOpEgKPAYaXujy8xv3xMhachv1DgiToAGnPoUI6Ul1zzoKRTfJhV6lLrJXXoMewFSQ89P/PRHdc2yVbUmgPPEzkkZ5Gi45mevH+I4IFxhhqTs2laknAQJRTEjaakXSxIhPEID0tWUo4BIJ5l8k8JDrfShHwpdXMGJ+nsiQYGU48DTndmtctbLxP+8bqz8cyehPIoV4Xi6yI8ZVCHMooF9KghWbKwJwoLqWyEeIoGw0gGWdAj27MvzpHVStWvV2vVpuX6Rx1EEe2AfVIANzkAdXIEGaAIMHsATeAGvxqPxbLwZ79PWgpHP7II/MD6+AYN+m94=</latexit> j(i),f j(i)
d<latexit sha1_base64="kQuxrC/uaN9r2g4afDBRkSoO5lo=">AAAEBXicdVPJbtswEGXiLqm6Je2xF6GKgV5iWLK7HAX0kmMK1ElQUQgoirIJcxFIqrFB8Nwf6LX9g96KXvsd/YD+RynZBewsAxCYecM3nBnOFDWj2gyHf3Z2e3fu3ru/9yB4+Ojxk6f7B89OtWwUJhMsmVTnBdKEUUEmhhpGzmtFEC8YOSvm71v/2WeiNJXio1nWJOdoKmhFMTIe+gQ5MrOisqW72I+Gg2En4XUlXisRWMvJxcHuX1hK3HAiDGZI6ywe1ia3SBmKGXEBbDSpEZ6jKcm8KhAnOrddyi7se6QMK6n8ESbs0E2GRVzrJS/8zTZFfdXXgjf6MBKYsK3X7SXSSx9sG2ypRkqmt+FFpRC+kryp3uWWiroxROBV7lXDQiPDtqVhSRXBhi29grCivvwQz5APY3zjg8D3eE6Q/xnj7QAKcokl50iUFuqmJoryWmrislGedd8hVZnbKLadUaOOt3kztTZKnI1Gzsut8VKXJfk2kvqozlNv56RtFrYfhCGUEjE6FZ3hzVlF2SHkqZlFcZQcdjbE6gbnaNPp+oH73wBpZr7+7cf9aC61r9ggpeSly+I8G7VD1NWuCFs9D2eFXFioGkYyWFJOFrWC7dy0ukgSaMjCtHZyNEhqAz0RLdoeOjsY18a5VRQ+J0ocjXmzjtd+oyfZibN+fpfOcmeFg+3YSWbHcdffwC9GfHUNriunySB+M3j9YRylx+sV2QMvwEvwCsTgLUjBMTgBE4CBAF/BN/C996X3o/ez92t1dXdnzXkOtqT3+x/11VgE</latexit>
d<latexit sha1_base64="kQuxrC/uaN9r2g4afDBRkSoO5lo=">AAAEBXicdVPJbtswEGXiLqm6Je2xF6GKgV5iWLK7HAX0kmMK1ElQUQgoirIJcxFIqrFB8Nwf6LX9g96KXvsd/YD+RynZBewsAxCYecM3nBnOFDWj2gyHf3Z2e3fu3ru/9yB4+Ojxk6f7B89OtWwUJhMsmVTnBdKEUUEmhhpGzmtFEC8YOSvm71v/2WeiNJXio1nWJOdoKmhFMTIe+gQ5MrOisqW72I+Gg2En4XUlXisRWMvJxcHuX1hK3HAiDGZI6ywe1ia3SBmKGXEBbDSpEZ6jKcm8KhAnOrddyi7se6QMK6n8ESbs0E2GRVzrJS/8zTZFfdXXgjf6MBKYsK3X7SXSSx9sG2ypRkqmt+FFpRC+kryp3uWWiroxROBV7lXDQiPDtqVhSRXBhi29grCivvwQz5APY3zjg8D3eE6Q/xnj7QAKcokl50iUFuqmJoryWmrislGedd8hVZnbKLadUaOOt3kztTZKnI1Gzsut8VKXJfk2kvqozlNv56RtFrYfhCGUEjE6FZ3hzVlF2SHkqZlFcZQcdjbE6gbnaNPp+oH73wBpZr7+7cf9aC61r9ggpeSly+I8G7VD1NWuCFs9D2eFXFioGkYyWFJOFrWC7dy0ukgSaMjCtHZyNEhqAz0RLdoeOjsY18a5VRQ+J0ocjXmzjtd+oyfZibN+fpfOcmeFg+3YSWbHcdffwC9GfHUNriunySB+M3j9YRylx+sV2QMvwEvwCsTgLUjBMTgBE4CBAF/BN/C996X3o/ez92t1dXdnzXkOtqT3+x/11VgE</latexit>
In order to represent density and color, Zip-NeRF accelerates
x<latexit sha1_base64="Qn0cHsXD6WqDq2CbbbZbrxTiNRg=">AAAEDXicdVNJbtswFGXiDqk6Oe2yG6FKgG5iWLI7LAV0k2UK1EkAUQgomooJcxBIKrFB8Ay9QLftDboruu0ZeoDeo6TsAnGGDxD4/32+zz+xahjVZjj8s7Xdu3f/wcOdR9HjJ0+fPe/vvjjWslWYTLBkUp1WSBNGBZkYahg5bRRBvGLkpJp/DP6TC6I0leKzWTak5Ohc0JpiZDx01u/DCikLOTKzqrYL5876yXAw7CS+qaRrJQFrOTrb3f4LpxK3nAiDGdK6SIeNKS1ShmJGXARbTRqE5+icFF4ViBNd2i51F+97ZBrXUvkjTNyhVxkWca2XvPI3Q476ui+At/owEpiwjdftJdJLH2wTDFQjJdOb8KJWCF9L3tQfSktF0xoi8Cr3umWxkXFobTylimDDll5BWFFffoxnyIcxfgBR5Js8J8hPyHg7goJcYsk5ElMLddsQRXkjNXHFqCy6eUg1LW2SrobToI539WZubZI5m4yclzvj5a7Iyk0k91Gdp97NyUMWdj+KYyglYvRcdIY3ZzVle5DnZpakSbbX2RCrW5yjq063H7n/DZBm5uvffNyv6FL7ig1SSl66Ii2LUViirnZF2Op5OKvkwkLVMlLAKeVk0SgY9iboIsugIQsT7OxgkDUGeiJahB46Oxg3xrlVFD4nShyMebuOF8boSXbirN/fpbPcWeFgWDvJ7Djt+hv5j5Fe/wY3leNskL4bvP00TvLD9RfZAa/Aa/AGpOA9yMEhOAITgMEF+Aq+ge+9L70fvZ+9X6ur21trzkuwIb3f/wAb+1sO</latexit>¬Ø
mip-NeRF360byreplacingitslargeMLPwithahashencoding, <latexit sha1_base64="GmYWlBtyVplNrJjUIcMisAYkE20=">AAAEKnicdVPLbtQwFHU7PEp4tbBkE5FWFImOJpnhsYxAQmyQisS0leKochynY40fke20M7L8FfwGP8AW/oBdxRb+AyczSJ2WXsnSvef6XN+Xi5pRbQaD87X13o2bt25v3Anu3rv/4OHm1qMDLRuFyRhLJtVRgTRhVJCxoYaRo1oRxAtGDovpu9Z/eEqUplJ8NvOa5BydCFpRjIyHjjf3oKyJQkYqgTixpx/fu13IkZkUlS3dsxchLJCycIrqGrnnx5vRoD/oJLyqxEslAkvZP95a/wNLiRtOhMEMaZ3Fg9rkFilDMSMugI0mNcJTdEIyr7ZJ6Nx2dblwxyNlWEnljzBhh15kWMS1nvPC32xT1pd9LfhfH0YCE7byuj1Deu6DrYIt1UjJ9Co8qxTCl5I31ZvcUlE3hgi8yL1qWGhk2PY9LKki2LC5VxBW1Jcf4gnyYYyfThD4nk8J8uMz3g6gIGdYco5EaaFu/IQor6UmLhvmWTceqcrcRrHtjBp1vIs3U2ujxNlo6LxcGy91WZKvIqmP6jz1ek7aZmF3gjCEUiJGT0RneHNSUbYNeWomURwl250NsfqPc3jR6XYC968B0kx8/auP+/2da1+xQUrJM5fFeTZsl6irXRG2eB5OCjmzUDWMZLCknMxqBdu9aXWRJNCQmWntZK+f1AZ6Ipq1PXS2P6qNc4sofEqU2BvxZhmvHaMn2bGzfn/nznJnhYPt2klmR3HX38B/jPjyN7iqHCT9+FX/5adRlL5dfpEN8AQ8BbsgBq9BCj6AfTAGGHwB38B38KP3tfezd977tbi6vrbkPAYr0vv9F60yZq0=</latexit>vMF(d0,Ô£ø¬Ø)
basedonInstantNeuralGraphicsPrimitives[M√ºlleretal.2022], o<latexit sha1_base64="hmFZUePpmjxjuHEljy0UAY6OIoU=">AAAEBnicdVNLbxMxEHYbHmV5tXDksmJbwaVRdhMex5W49Fgk0lZaryqv422s+LGyvSSR5Tt/gCv8A26IK3+DH8D/wN4EqeljJEsz3/gbz4xnqoZRbQaDP1vbvTt3793feRA9fPT4ydPdvWcnWrYKkzGWTKqzCmnCqCBjQw0jZ40iiFeMnFazD8F/+pkoTaX4ZJYNKTm6ELSmGBkPFZAjM61qK92r891k0B90El9X0rWSgLUcn+9t/4UTiVtOhMEMaV2kg8aUFilDMSMugq0mDcIzdEEKrwrEiS5tl7OLDzwyiWup/BEm7tDLDIu41kte+ZshR33VF8AbfRgJTNjG63aO9NIH2wQD1UjJ9Ca8qBXCV5I39fvSUtG0hgi8yr1uWWxkHHoaT6gi2LClVxBW1Jcf4ynyYYzvfBT5Js8I8l9jvB1BQeZYco7ExELdNkRR3khNXDEsV/8h1aS0SWo7o0Ed7/LN3NokczYZOi+3xstdkZWbSO6jOk+9nZOHLOxBFMdQSsTohegMb05ryvYhz800SZNsv7MhVjc4h5ed7iBy/xsgzdTXv/m4n82l9hUbpJScuyIti2EYoq52RdjqeTit5MJC1TJSwAnlZNEoGOYm6CLLoCELE+zssJ81BnoiWoQeOtsfNca5VRQ+I0ocjni7jhe+0ZPs2Fk/v0tnubPCwTB2ktlR2vU38ouRXl2D68pJ1k/f9t98HCX50XpFdsAL8BK8Bil4B3JwBI7BGGAgwVfwDXzvfen96P3s/Vpd3d5ac56DDen9/gfU3lhA</latexit> 0
followedbyasmallerMLP.Topreventaliasing,Zip-NeRFreplaces Fig.2. Ourmodelarchitectureforrenderingasingleraywithoriginoand
pointsamplesofthehashencodinggridwiththeirexpectationover directiond.WesampleùëÅpointsx(ùëñ)alongtherayanduseaspatialencoder
3DGaussians.Sincetheseexpectedvaluescannotbecomputedex- basedonZip-NeRFtoencodeeachpointintodensityùúè(ùëñ),roughnessùúå(ùëñ),
actly,theyareapproximatedusingtwocomponents:multisampling andsurfacenormaln(ùëñ).Thesearealphacompositedtocomputeasingle
anddownweighting.MultisamplingreplaceseachGaussianwith expectedterminationpointx¬Ø,avonMises-Fisherdistribution(vMF)width
multiplesmallerGaussians,anddownweightingmultiplieseachof ùúÖ¬Ø,andsurfacenormaln¬Ø.Thendisreflectedaroundthatsurfacetoconstruct
thegatheredfeaturesatthesesamplesbyamultiplierdesignedto avMFdistributionoverreflectedraysvMF(d‚Ä≤,ùúÖ¬Ø).Wesampleùêæreflected
preventvoxelsmuchsmallerthantheGaussianfromaffectingthe
rays(ùêæ =5)withlocationo‚Ä≤anddirectionsd‚Ä≤
ùëó
(asinFigure3).Theseùêæ
raysarethencast,andpointsalongthemareencodedwiththesamemodel
features.ThecontractionfunctioninEquation2mustbetakeninto
accountwhencomputingtheappropriateamountofdownweight-
astheinitialrayintoùëÅ‚Ä≤densitiesùúè ùëó(ùëñ) andfeaturesfùëó(ùëñ).Thesefeatures
ing: the determinant of the Jacobian of C, detùêΩ C, ‚Äúdeflates‚Äù the arealphacompositedalongeachraytogetper-rayfeaturesf¬Ø ùëó,andthe
Gaussians‚Äôvolumes,soZip-NeRFdownweightsthegridresolution
compositedfeaturesareaveragedintoasinglereflectionfeaturef.This
(cid:16)(cid:16)‚àö (cid:17) (cid:17) featureisbroadcastovertheoriginalray‚Äôssamplesandpassed,alongwith
ùëõ ‚Ñì byerf 8ùúé(x)ùëõ ‚Ñì ‚àí1 ,where: bottleneckfeaturesb(ùëñ),mixingcoefficientsùõΩ(ùëñ),andviewingdirectiond,
ùúé(x)=ùõæ¬∑ùëü(cid:164)‚à•x‚àío‚à•‚àöÔ∏Å 3detùêΩ C(x), (3) t ro ayt .h Te hc eo selo cr od loe rc sod are er ato lpp hr ao cd ou mce poR sG itB edc to olo rr es nc d( eùëñ r) afo pr ixe ea lc ch op loo rin c¬Ø.talongthe
whereùõæ isafixedhyperparameter.
4 MODEL
Wedesignourmethodwiththreegoalsinmind:First,wewantto d<latexit sha1_base64="cp+mvrWg3JL2cVrOYfe49NxW9Cg=">AAAECHicdVPNbtQwEHa7/JTw0xaOXCLSFVy62mSXn2MEF45FYttKcbRyHKdrrX+C7dBdWX4BXoArvAE3xJW34AF4D5zsInX7M5KlmW/8jWfGM0XNqDbD4Z+t7d6t23fu7twL7j94+Gh3b//xsZaNwmSCJZPqtECaMCrIxFDDyGmtCOIFIyfF/F3rP/lMlKZSfDTLmuQcnQlaUYyMh3LIkZkVlS3d82ky3YuGg2En4VUlXisRWMvRdH/7LywlbjgRBjOkdRYPa5NbpAzFjLgANprUCM/RGcm8KhAnOrdd1i7se6QMK6n8ESbs0IsMi7jWS174m22W+rKvBa/1YSQwYRuv23Oklz7YJthSjZRMb8KLSiF8KXlTvcktFXVjiMCr3KuGhUaGbVfDkiqCDVt6BWFFffkhniEfxvjeB4Fv85wg/znG2wEU5BxLzpEoLdRNTRTltdTEZaM8635EqjK3UWw7o0Yd7+LN1NoocTYaOS83xktdluSbSOqjOk+9mZO2Wdh+EIZQSsTomegMb84qyg4gT80siqPkoLMhVtc4Rxedrh+4/w2QZubr33zcT+dS+4oNUkqeuyzOs1E7RF3tirDV83BWyIWFqmEkgyXlZFEr2M5Nq4skgYYsTGsnh4OkNtAT0aLtobODcW2cW0Xhc6LE4Zg363jtN3qSnTjr53fpLHdWONiOnWR2HHf9DfxixJfX4KpynAziV4OXH8ZR+na9IjvgKXgGXoAYvAYpeA+OwARg8Al8Bd/A996X3o/ez96v1dXtrTXnCdiQ3u9/C9JY1A==</latexit>02
m
a al
slo
y
md ee axl llpa nc ec
n
uu
s
mr iva bet ee rMd oLe ft Pa rei el fle
v
ed
a
clr
u
te eafl dtie
o
rc ant yi so s.n .Ss Tecw
ho
ii rnt dh
d
,o
,
wu wt eer we wl oy
o
ui un
ll
dg
d
lo
l ii
kn
k
eec to
t
oom mop nu inlt ya imt cio
a
izsn et- o<latexit sha1_base64="TwGJC6/tAJWp4InnfoILVwaRgKI=">AAAEBXicdVNLbxMxEHYbHmV5tXDksmJbiUuj7CY8jitx6bFIpK1Yryqv422s+LGyvTSR5TN/gCv8A26IK7+DH8D/wN4EKeljJEsz3/gbz4xnqoZRbQaDP1vbvTt3793feRA9fPT4ydPdvWcnWrYKkzGWTKqzCmnCqCBjQw0jZ40iiFeMnFaz98F/+pkoTaX4aBYNKTm6ELSmGBkPfYIcmWlVW+nOd5NBf9BJfF1JV0oCVnJ8vrf9F04kbjkRBjOkdZEOGlNapAzFjLgItpo0CM/QBSm8KhAnurRdyi4+8MgkrqXyR5i4Q9cZFnGtF7zyN0OK+qovgDf6MBKYsI3X7SXSCx9sEwxUIyXTm/C8VghfSd7U70pLRdMaIvAy97plsZFxaGk8oYpgwxZeQVhRX36Mp8iHMb7xUeR7PCPI/4zxdgQFucSScyQmFuq2IYryRmriimFZdN8h1aS0SWo7o0Edb/1mbm2SOZsMnZdb4+WuyMpNJPdRnafezslDFvYgimMoJWL0QnSGN6c1ZfuQ52aapEm239kQqxucw3WnO4jc/wZIM/X1bz7uR3OhfcUGKSUvXZGWxTAMUVe7Imz5PJxWcm6hahkp4IRyMm8UDHMTdJFl0JC5CXZ22M8aAz0RzUMPne2PGuPcMgqfESUOR7xdxQvf6El27Kyf34Wz3FnhYBg7yewo7fob+cVIr67BdeUk66dv+q8/jJL8aLUiO+AFeAlegRS8BTk4AsdgDDAQ4Cv4Br73vvR+9H72fi2vbm+tOM/BhvR+/wMdd1gP</latexit>
d<latexit sha1_base64="kQuxrC/uaN9r2g4afDBRkSoO5lo=">AAAEBXicdVPJbtswEGXiLqm6Je2xF6GKgV5iWLK7HAX0kmMK1ElQUQgoirIJcxFIqrFB8Nwf6LX9g96KXvsd/YD+RynZBewsAxCYecM3nBnOFDWj2gyHf3Z2e3fu3ru/9yB4+Ojxk6f7B89OtWwUJhMsmVTnBdKEUUEmhhpGzmtFEC8YOSvm71v/2WeiNJXio1nWJOdoKmhFMTIe+gQ5MrOisqW72I+Gg2En4XUlXisRWMvJxcHuX1hK3HAiDGZI6ywe1ia3SBmKGXEBbDSpEZ6jKcm8KhAnOrddyi7se6QMK6n8ESbs0E2GRVzrJS/8zTZFfdXXgjf6MBKYsK3X7SXSSx9sG2ypRkqmt+FFpRC+kryp3uWWiroxROBV7lXDQiPDtqVhSRXBhi29grCivvwQz5APY3zjg8D3eE6Q/xnj7QAKcokl50iUFuqmJoryWmrislGedd8hVZnbKLadUaOOt3kztTZKnI1Gzsut8VKXJfk2kvqozlNv56RtFrYfhCGUEjE6FZ3hzVlF2SHkqZlFcZQcdjbE6gbnaNPp+oH73wBpZr7+7cf9aC61r9ggpeSly+I8G7VD1NWuCFs9D2eFXFioGkYyWFJOFrWC7dy0ukgSaMjCtHZyNEhqAz0RLdoeOjsY18a5VRQ+J0ocjXmzjtd+oyfZibN+fpfOcmeFg+3YSWbHcdffwC9GfHUNriunySB+M3j9YRylx+sV2QMvwEvwCsTgLUjBMTgBE4CBAF/BN/C996X3o/ez92t1dXdnzXkOtqT3+x/11VgE</latexit>
n<latexit sha1_base64="CULaGwAT5eUU7X4UncqIm+bfO70=">AAAEDXicdVNJbtswFGXiDqk6Oe2yG6FKgG5iWLI7LAV0k2UK1EkAUQgomooJcxBIKrFB8Ay9QLftDboruu0ZeoDeo6TsAnGGDxD4A9+ff9Uwqs1w+Gdru3fv/oOHO4+ix0+ePnve331xrGWrMJlgyaQ6rZAmjAoyMdQwctoognjFyEk1/xjsJxdEaSrFZ7NsSMnRuaA1xch41Vm/DyukLOTIzKraCufO+slwMOwovsmkayYBazo6293+C6cSt5wIgxnSukiHjSktUoZiRlwEW00ahOfonBSeFYgTXdoudRfve800rqXyT5i4015FWMS1XvLK/ww56uu2oLzVhpHAhG1Et5dIL72zTWWAGimZ3lQvaoXwteRN/aG0VDStIQKvcq9bFhsZh9bGU6oINmzpGYQV9eXHeIa8G+MHEEW+yXOC/ISMlyMoyCWWnCMxtVC3DVGUN1ITV4zKopuHVNPSJulqOA3qcFd/5tYmmbPJyHm601/uiqzc1OTeq/PQuzF5yMLuR3EMpUSMnotO8OKspmwP8tzMkjTJ9joZYnWLcXTV6PYj978B0sx8/ZvB/Youta/YIKXkpSvSshiFJepqV4StwsNZJRcWqpaRAk4pJ4tGwbA3gRdZBg1ZmCBnB4OsMdAD0SL00NnBuDHOrbzwOVHiYMzbtb8wRg+yE2f9/i6d5c5fAgxrJ5kdp11/I38Y6fUzuMkcZ4P03eDtp3GSH65PZAe8Aq/BG5CC9yAHh+AITAAGF+Ar+Aa+9770fvR+9n6tvm5vrTEvwQb1fv8D9+hbBA==</latexit>¬Ø
d<latexit sha1_base64="SDF04j8AU+cE1RFLOZw5l0UVKhU=">AAAEBnicdVPNbhMxEHYbfsry18KRy4ptBJdG2U34Oa7gwrFIpK20XlVer7ex4p+V7aWJLN95Aa7wBtwQV16DB+A98G6ClKTtSJZmvvE3nhnPFDWj2gyHf3Z2e7du37m7dy+4/+Dho8f7B09OtGwUJhMsmVRnBdKEUUEmhhpGzmpFEC8YOS1m71v/6WeiNJXik1nUJOfoQtCKYmQ8lEGOzLSobOlenO9Hw8Gwk/CqEq+UCKzk+Pxg9y8sJW44EQYzpHUWD2uTW6QMxYy4ADaa1AjP0AXJvCoQJzq3Xc4u7HukDCup/BEm7NB1hkVc6wUv/M02R73ta8FrfRgJTNjG6/YS6YUPtgm2VCMl05vwvFIIbyVvqre5paJuDBF4mXvVsNDIsO1pWFJFsGELryCsqC8/xFPkwxjf+SDwTZ4R5L/GeDuAglxiyTkSpYW6qYmivJaauGyUL/9DqjK3UWw7o0Ydb/1mam2UOBuNnJcb46UuS/JNJPVRnafezEnbLGw/CEMoJWL0QnSGN6cVZYeQp2YaxVFy2NkQq2uco3Wn6wfufwOkmfr6Nx/3s7nQvmKDlJKXLovzbNQOUVe7Imz5PJwWcm6hahjJYEk5mdcKtnPT6iJJoCFz09rJ0SCpDfRENG976OxgXBvnllH4jChxNObNKl77jZ5kJ876+V04y50VDrZjJ5kdx11/A78Y8fYaXFVOkkH8evDq4zhK361WZA88A8/BSxCDNyAFH8AxmAAMJPgKvoHvvS+9H72fvV/Lq7s7K85TsCG93/8Aq3JYLw==</latexit> 0
o<latexit sha1_base64="TwGJC6/tAJWp4InnfoILVwaRgKI=">AAAEBXicdVNLbxMxEHYbHmV5tXDksmJbiUuj7CY8jitx6bFIpK1Yryqv422s+LGyvTSR5TN/gCv8A26IK7+DH8D/wN4EKeljJEsz3/gbz4xnqoZRbQaDP1vbvTt3793feRA9fPT4ydPdvWcnWrYKkzGWTKqzCmnCqCBjQw0jZ40iiFeMnFaz98F/+pkoTaX4aBYNKTm6ELSmGBkPfYIcmWlVW+nOd5NBf9BJfF1JV0oCVnJ8vrf9F04kbjkRBjOkdZEOGlNapAzFjLgItpo0CM/QBSm8KhAnurRdyi4+8MgkrqXyR5i4Q9cZFnGtF7zyN0OK+qovgDf6MBKYsI3X7SXSCx9sEwxUIyXTm/C8VghfSd7U70pLRdMaIvAy97plsZFxaGk8oYpgwxZeQVhRX36Mp8iHMb7xUeR7PCPI/4zxdgQFucSScyQmFuq2IYryRmriimFZdN8h1aS0SWo7o0Edb/1mbm2SOZsMnZdb4+WuyMpNJPdRnafezslDFvYgimMoJWL0QnSGN6c1ZfuQ52aapEm239kQqxucw3WnO4jc/wZIM/X1bz7uR3OhfcUGKSUvXZGWxTAMUVe7Imz5PJxWcm6hahkp4IRyMm8UDHMTdJFl0JC5CXZ22M8aAz0RzUMPne2PGuPcMgqfESUOR7xdxQvf6El27Kyf34Wz3FnhYBg7yewo7fob+cVIr67BdeUk66dv+q8/jJL8aLUiO+AFeAlegRS8BTk4AsdgDDAQ4Cv4Br73vvR+9H72fi2vbm+tOM/BhvR+/wMdd1gP</latexit>
d<latexit sha1_base64="kQuxrC/uaN9r2g4afDBRkSoO5lo=">AAAEBXicdVPJbtswEGXiLqm6Je2xF6GKgV5iWLK7HAX0kmMK1ElQUQgoirIJcxFIqrFB8Nwf6LX9g96KXvsd/YD+RynZBewsAxCYecM3nBnOFDWj2gyHf3Z2e3fu3ru/9yB4+Ojxk6f7B89OtWwUJhMsmVTnBdKEUUEmhhpGzmtFEC8YOSvm71v/2WeiNJXio1nWJOdoKmhFMTIe+gQ5MrOisqW72I+Gg2En4XUlXisRWMvJxcHuX1hK3HAiDGZI6ywe1ia3SBmKGXEBbDSpEZ6jKcm8KhAnOrddyi7se6QMK6n8ESbs0E2GRVzrJS/8zTZFfdXXgjf6MBKYsK3X7SXSSx9sG2ypRkqmt+FFpRC+kryp3uWWiroxROBV7lXDQiPDtqVhSRXBhi29grCivvwQz5APY3zjg8D3eE6Q/xnj7QAKcokl50iUFuqmJoryWmrislGedd8hVZnbKLadUaOOt3kztTZKnI1Gzsut8VKXJfk2kvqozlNv56RtFrYfhCGUEjE6FZ3hzVlF2SHkqZlFcZQcdjbE6gbnaNPp+oH73wBpZr7+7cf9aC61r9ggpeSly+I8G7VD1NWuCFs9D2eFXFioGkYyWFJOFrWC7dy0ukgSaMjCtHZyNEhqAz0RLdoeOjsY18a5VRQ+J0ocjXmzjtd+oyfZibN+fpfOcmeFg+3YSWbHcdffwC9GfHUNriunySB+M3j9YRylx+sV2QMvwEvwCsTgLUjBMTgBE4CBAF/BN/C996X3o/ez92t1dXdnzXkOtqT3+x/11VgE</latexit>
n<latexit sha1_base64="CULaGwAT5eUU7X4UncqIm+bfO70=">AAAEDXicdVNJbtswFGXiDqk6Oe2yG6FKgG5iWLI7LAV0k2UK1EkAUQgomooJcxBIKrFB8Ay9QLftDboruu0ZeoDeo6TsAnGGDxD4A9+ff9Uwqs1w+Gdru3fv/oOHO4+ix0+ePnve331xrGWrMJlgyaQ6rZAmjAoyMdQwctoognjFyEk1/xjsJxdEaSrFZ7NsSMnRuaA1xch41Vm/DyukLOTIzKraCufO+slwMOwovsmkayYBazo6293+C6cSt5wIgxnSukiHjSktUoZiRlwEW00ahOfonBSeFYgTXdoudRfve800rqXyT5i4015FWMS1XvLK/ww56uu2oLzVhpHAhG1Et5dIL72zTWWAGimZ3lQvaoXwteRN/aG0VDStIQKvcq9bFhsZh9bGU6oINmzpGYQV9eXHeIa8G+MHEEW+yXOC/ISMlyMoyCWWnCMxtVC3DVGUN1ITV4zKopuHVNPSJulqOA3qcFd/5tYmmbPJyHm601/uiqzc1OTeq/PQuzF5yMLuR3EMpUSMnotO8OKspmwP8tzMkjTJ9joZYnWLcXTV6PYj978B0sx8/ZvB/Youta/YIKXkpSvSshiFJepqV4StwsNZJRcWqpaRAk4pJ4tGwbA3gRdZBg1ZmCBnB4OsMdAD0SL00NnBuDHOrbzwOVHiYMzbtb8wRg+yE2f9/i6d5c5fAgxrJ5kdp11/I38Y6fUzuMkcZ4P03eDtp3GSH65PZAe8Aq/BG5CC9yAHh+AITAAGF+Ar+Aa+9770fvR+9n6tvm5vrTEvwQb1fv8D9+hbBA==</latexit>¬Ø
r<latexit sha1_base64="ITnFSMlK2dlVWaN1ozqi2bu/Zu0=">AAAEAXicdVPNbhMxEHYbfsry18KRy4ptJC6Nspvwc1zBhWORSFppvaocx2lM/LOyvSSR5RMvwBXegBviypPwALwH9iZISdqOZGnmG3/jmfHMqGJUm273z95+69btO3cP7kX3Hzx89Pjw6MlQy1phMsCSSXU+QpowKsjAUMPIeaUI4iNGzkazd8F/9pkoTaX4aJYVKTm6FHRCMTIeGsKxNLG6OEy6nW4j8VUlXSsJWMvpxdH+X8/ENSfCYIa0LtJuZUqLlKGYERfBWpMK4Rm6JIVXBeJEl7ZJ18Vtj4zjiVT+CBM36CbDIq71ko/8TY7MVO/6AnitDyOBCdt63c6RXvpg22CgGimZ3oYXE4XwTvJm8qa0VFS1IQKvcp/ULDYyDu2Mx1QRbNjSKwgr6suP8RT5MMY3PYogRzOC/K8Yb0dQkDmWnCMxtlDXFVGUV1ITV/TKAoakpBqXNkltY1So4W3ezK1NMmeTnvNyY7zcFVm5jeQ+qvPUmzl5yMK2oziGUiJGL0VjeHM6oewY8txMkzTJjhsbYnWNs7fpdO3I/W+ANFNf//bjfiyX2ldskFJy7oq0LHphiJraFWGr5+F0JBcWqpqRAo4pJ4tKwTA3QRdZBg1ZmGBnJ52sMtAT0SL00NlOvzLOraLwGVHipM/rdbzwjZ5kB876+V06y50VDoaxk8z206a/kV+MdHcNrirDrJO+6rz80E/yt+sVOQDPwHPwAqTgNcjBe3AKBgCDT+Ar+Aa+t760frR+tn6tru7vrTlPwZa0fv8DQqRV4Q==</latexit>Àô
d<latexit sha1_base64="cp+mvrWg3JL2cVrOYfe49NxW9Cg=">AAAECHicdVPNbtQwEHa7/JTw0xaOXCLSFVy62mSXn2MEF45FYttKcbRyHKdrrX+C7dBdWX4BXoArvAE3xJW34AF4D5zsInX7M5KlmW/8jWfGM0XNqDbD4Z+t7d6t23fu7twL7j94+Gh3b//xsZaNwmSCJZPqtECaMCrIxFDDyGmtCOIFIyfF/F3rP/lMlKZSfDTLmuQcnQlaUYyMh3LIkZkVlS3d82ky3YuGg2En4VUlXisRWMvRdH/7LywlbjgRBjOkdRYPa5NbpAzFjLgANprUCM/RGcm8KhAnOrdd1i7se6QMK6n8ESbs0IsMi7jWS174m22W+rKvBa/1YSQwYRuv23Oklz7YJthSjZRMb8KLSiF8KXlTvcktFXVjiMCr3KuGhUaGbVfDkiqCDVt6BWFFffkhniEfxvjeB4Fv85wg/znG2wEU5BxLzpEoLdRNTRTltdTEZaM8635EqjK3UWw7o0Yd7+LN1NoocTYaOS83xktdluSbSOqjOk+9mZO2Wdh+EIZQSsTomegMb84qyg4gT80siqPkoLMhVtc4Rxedrh+4/w2QZubr33zcT+dS+4oNUkqeuyzOs1E7RF3tirDV83BWyIWFqmEkgyXlZFEr2M5Nq4skgYYsTGsnh4OkNtAT0aLtobODcW2cW0Xhc6LE4Zg363jtN3qSnTjr53fpLHdWONiOnWR2HHf9DfxixJfX4KpynAziV4OXH8ZR+na9IjvgKXgGXoAYvAYpeA+OwARg8Al8Bd/A996X3o/ez96v1dXtrTXnCdiQ3u9/C9JY1A==</latexit>02
d<latexit sha1_base64="NR7oH+A2FTd3uTP335Xhy8ycfEw=">AAAECHicdVPNbtQwEHa7/JTw0xaOXCLSFVy62mSXn2MEF45FYttKcbRyHKdrrX+C7dBdWX4BXoArvAE3xJW34AF4D5zsInX7M5KlmW/8jWfGM0XNqDbD4Z+t7d6t23fu7twL7j94+Gh3b//xsZaNwmSCJZPqtECaMCrIxFDDyGmtCOIFIyfF/F3rP/lMlKZSfDTLmuQcnQlaUYyMh3LIkZkVlS3d82k83YuGg2En4VUlXisRWMvRdH/7LywlbjgRBjOkdRYPa5NbpAzFjLgANprUCM/RGcm8KhAnOrdd1i7se6QMK6n8ESbs0IsMi7jWS174m22W+rKvBa/1YSQwYRuv23Oklz7YJthSjZRMb8KLSiF8KXlTvcktFXVjiMCr3KuGhUaGbVfDkiqCDVt6BWFFffkhniEfxvjeB4Fv85wg/znG2wEU5BxLzpEoLdRNTRTltdTEZaM8635EqjK3UWw7o0Yd7+LN1NoocTYaOS83xktdluSbSOqjOk+9mZO2Wdh+EIZQSsTomegMb84qyg4gT80siqPkoLMhVtc4Rxedrh+4/w2QZubr33zcT+dS+4oNUkqeuyzOs1E7RF3tirDV83BWyIWFqmEkgyXlZFEr2M5Nq4skgYYsTGsnh4OkNtAT0aLtobODcW2cW0Xhc6LE4Zg363jtN3qSnTjr53fpLHdWONiOnWR2HHf9DfxixJfX4KpynAziV4OXH8ZR+na9IjvgKXgGXoAYvAYpeA+OwARg8Al8Bd/A996X3o/ez96v1dXtrTXnCdiQ3u9/CDpY0w==</latexit>01d<latexit sha1_base64="2Z6oe9pyxg2ATBdNCIHdeLgtWto=">AAAECHicdVPNbtQwEHa7/JTw0xaOXCLSFVy62mSXn2MEF45FYttKcbRyHKdrrX+C7dBdWX4BXoArvAE3xJW34AF4D5zsInX7M5KlmW/8jWfGM0XNqDbD4Z+t7d6t23fu7twL7j94+Gh3b//xsZaNwmSCJZPqtECaMCrIxFDDyGmtCOIFIyfF/F3rP/lMlKZSfDTLmuQcnQlaUYyMh3LIkZkVlS3d8+louhcNB8NOwqtKvFYisJaj6f72X1hK3HAiDGZI6ywe1ia3SBmKGXEBbDSpEZ6jM5J5VSBOdG67rF3Y90gZVlL5I0zYoRcZFnGtl7zwN9ss9WVfC17rw0hgwjZet+dIL32wTbClGimZ3oQXlUL4UvKmepNbKurGEIFXuVcNC40M266GJVUEG7b0CsKK+vJDPEM+jPG9DwLf5jlB/nOMtwMoyDmWnCNRWqibmijKa6mJy0Z51v2IVGVuo9h2Ro063sWbqbVR4mw0cl5ujJe6LMk3kdRHdZ56Mydts7D9IAyhlIjRM9EZ3pxVlB1AnppZFEfJQWdDrK5xji46XT9w/xsgzczXv/m4n86l9hUbpJQ8d1mcZ6N2iLraFWGr5+GskAsLVcNIBkvKyaJWsJ2bVhdJAg1ZmNZODgdJbaAnokXbQ2cH49o4t4rC50SJwzFv1vHab/QkO3HWz+/SWe6scLAdO8nsOO76G/jFiC+vwVXlOBnErwYvP4yj9O16RXbAU/AMvAAxeA1S8B4cgQnA4BP4Cr6B770vvR+9n71fq6vbW2vOE7Ahvd//AA9qWNU=</latexit>03
o<latexit sha1_base64="TwGJC6/tAJWp4InnfoILVwaRgKI=">AAAEBXicdVNLbxMxEHYbHmV5tXDksmJbiUuj7CY8jitx6bFIpK1Yryqv422s+LGyvTSR5TN/gCv8A26IK7+DH8D/wN4EKeljJEsz3/gbz4xnqoZRbQaDP1vbvTt3793feRA9fPT4ydPdvWcnWrYKkzGWTKqzCmnCqCBjQw0jZ40iiFeMnFaz98F/+pkoTaX4aBYNKTm6ELSmGBkPfYIcmWlVW+nOd5NBf9BJfF1JV0oCVnJ8vrf9F04kbjkRBjOkdZEOGlNapAzFjLgItpo0CM/QBSm8KhAnurRdyi4+8MgkrqXyR5i4Q9cZFnGtF7zyN0OK+qovgDf6MBKYsI3X7SXSCx9sEwxUIyXTm/C8VghfSd7U70pLRdMaIvAy97plsZFxaGk8oYpgwxZeQVhRX36Mp8iHMb7xUeR7PCPI/4zxdgQFucSScyQmFuq2IYryRmriimFZdN8h1aS0SWo7o0Edb/1mbm2SOZsMnZdb4+WuyMpNJPdRnafezslDFvYgimMoJWL0QnSGN6c1ZfuQ52aapEm239kQqxucw3WnO4jc/wZIM/X1bz7uR3OhfcUGKSUvXZGWxTAMUVe7Imz5PJxWcm6hahkp4IRyMm8UDHMTdJFl0JC5CXZ22M8aAz0RzUMPne2PGuPcMgqfESUOR7xdxQvf6El27Kyf34Wz3FnhYBg7yewo7fob+cVIr67BdeUk66dv+q8/jJL8aLUiO+AFeAlegRS8BTk4AsdgDDAQ4Cv4Br73vvR+9H72fi2vbm+tOM/BhvR+/wMdd1gP</latexit>
d<latexit sha1_base64="kQuxrC/uaN9r2g4afDBRkSoO5lo=">AAAEBXicdVPJbtswEGXiLqm6Je2xF6GKgV5iWLK7HAX0kmMK1ElQUQgoirIJcxFIqrFB8Nwf6LX9g96KXvsd/YD+RynZBewsAxCYecM3nBnOFDWj2gyHf3Z2e3fu3ru/9yB4+Ojxk6f7B89OtWwUJhMsmVTnBdKEUUEmhhpGzmtFEC8YOSvm71v/2WeiNJXio1nWJOdoKmhFMTIe+gQ5MrOisqW72I+Gg2En4XUlXisRWMvJxcHuX1hK3HAiDGZI6ywe1ia3SBmKGXEBbDSpEZ6jKcm8KhAnOrddyi7se6QMK6n8ESbs0E2GRVzrJS/8zTZFfdXXgjf6MBKYsK3X7SXSSx9sG2ypRkqmt+FFpRC+kryp3uWWiroxROBV7lXDQiPDtqVhSRXBhi29grCivvwQz5APY3zjg8D3eE6Q/xnj7QAKcokl50iUFuqmJoryWmrislGedd8hVZnbKLadUaOOt3kztTZKnI1Gzsut8VKXJfk2kvqozlNv56RtFrYfhCGUEjE6FZ3hzVlF2SHkqZlFcZQcdjbE6gbnaNPp+oH73wBpZr7+7cf9aC61r9ggpeSly+I8G7VD1NWuCFs9D2eFXFioGkYyWFJOFrWC7dy0ukgSaMjCtHZyNEhqAz0RLdoeOjsY18a5VRQ+J0ocjXmzjtd+oyfZibN+fpfOcmeFg+3YSWbHcdffwC9GfHUNriunySB+M3j9YRylx+sV2QMvwEvwCsTgLUjBMTgBE4CBAF/BN/C996X3o/ez92t1dXdnzXkOtqT3+x/11VgE</latexit>
n<latexit sha1_base64="CULaGwAT5eUU7X4UncqIm+bfO70=">AAAEDXicdVNJbtswFGXiDqk6Oe2yG6FKgG5iWLI7LAV0k2UK1EkAUQgomooJcxBIKrFB8Ay9QLftDboruu0ZeoDeo6TsAnGGDxD4A9+ff9Uwqs1w+Gdru3fv/oOHO4+ix0+ePnve331xrGWrMJlgyaQ6rZAmjAoyMdQwctoognjFyEk1/xjsJxdEaSrFZ7NsSMnRuaA1xch41Vm/DyukLOTIzKraCufO+slwMOwovsmkayYBazo6293+C6cSt5wIgxnSukiHjSktUoZiRlwEW00ahOfonBSeFYgTXdoudRfve800rqXyT5i4015FWMS1XvLK/ww56uu2oLzVhpHAhG1Et5dIL72zTWWAGimZ3lQvaoXwteRN/aG0VDStIQKvcq9bFhsZh9bGU6oINmzpGYQV9eXHeIa8G+MHEEW+yXOC/ISMlyMoyCWWnCMxtVC3DVGUN1ITV4zKopuHVNPSJulqOA3qcFd/5tYmmbPJyHm601/uiqzc1OTeq/PQuzF5yMLuR3EMpUSMnotO8OKspmwP8tzMkjTJ9joZYnWLcXTV6PYj978B0sx8/ZvB/Youta/YIKXkpSvSshiFJepqV4StwsNZJRcWqpaRAk4pJ4tGwbA3gRdZBg1ZmCBnB4OsMdAD0SL00NnBuDHOrbzwOVHiYMzbtb8wRg+yE2f9/i6d5c5fAgxrJ5kdp11/I38Y6fUzuMkcZ4P03eDtp3GSH65PZAe8Aq/BG5CC9yAHh+AITAAGF+Ar+Aa+9770fvR+9n6tvm5vrTEvwQb1fv8D9+hbBA==</latexit>¬Ø
r<latexit sha1_base64="ITnFSMlK2dlVWaN1ozqi2bu/Zu0=">AAAEAXicdVPNbhMxEHYbfsry18KRy4ptJC6Nspvwc1zBhWORSFppvaocx2lM/LOyvSSR5RMvwBXegBviypPwALwH9iZISdqOZGnmG3/jmfHMqGJUm273z95+69btO3cP7kX3Hzx89Pjw6MlQy1phMsCSSXU+QpowKsjAUMPIeaUI4iNGzkazd8F/9pkoTaX4aJYVKTm6FHRCMTIeGsKxNLG6OEy6nW4j8VUlXSsJWMvpxdH+X8/ENSfCYIa0LtJuZUqLlKGYERfBWpMK4Rm6JIVXBeJEl7ZJ18Vtj4zjiVT+CBM36CbDIq71ko/8TY7MVO/6AnitDyOBCdt63c6RXvpg22CgGimZ3oYXE4XwTvJm8qa0VFS1IQKvcp/ULDYyDu2Mx1QRbNjSKwgr6suP8RT5MMY3PYogRzOC/K8Yb0dQkDmWnCMxtlDXFVGUV1ITV/TKAoakpBqXNkltY1So4W3ezK1NMmeTnvNyY7zcFVm5jeQ+qvPUmzl5yMK2oziGUiJGL0VjeHM6oewY8txMkzTJjhsbYnWNs7fpdO3I/W+ANFNf//bjfiyX2ldskFJy7oq0LHphiJraFWGr5+F0JBcWqpqRAo4pJ4tKwTA3QRdZBg1ZmGBnJ52sMtAT0SL00NlOvzLOraLwGVHipM/rdbzwjZ5kB876+V06y50VDoaxk8z206a/kV+MdHcNrirDrJO+6rz80E/yt+sVOQDPwHPwAqTgNcjBe3AKBgCDT+Ar+Aa+t760frR+tn6tru7vrTlPwZa0fv8DQqRV4Q==</latexit>Àô
x<latexit sha1_base64="Qn0cHsXD6WqDq2CbbbZbrxTiNRg=">AAAEDXicdVNJbtswFGXiDqk6Oe2yG6FKgG5iWLI7LAV0k2UK1EkAUQgomooJcxBIKrFB8Ay9QLftDboruu0ZeoDeo6TsAnGGDxD4/32+zz+xahjVZjj8s7Xdu3f/wcOdR9HjJ0+fPe/vvjjWslWYTLBkUp1WSBNGBZkYahg5bRRBvGLkpJp/DP6TC6I0leKzWTak5Ohc0JpiZDx01u/DCikLOTKzqrYL5876yXAw7CS+qaRrJQFrOTrb3f4LpxK3nAiDGdK6SIeNKS1ShmJGXARbTRqE5+icFF4ViBNd2i51F+97ZBrXUvkjTNyhVxkWca2XvPI3Q476ui+At/owEpiwjdftJdJLH2wTDFQjJdOb8KJWCF9L3tQfSktF0xoi8Cr3umWxkXFobTylimDDll5BWFFffoxnyIcxfgBR5Js8J8hPyHg7goJcYsk5ElMLddsQRXkjNXHFqCy6eUg1LW2SrobToI539WZubZI5m4yclzvj5a7Iyk0k91Gdp97NyUMWdj+KYyglYvRcdIY3ZzVle5DnZpakSbbX2RCrW5yjq063H7n/DZBm5uvffNyv6FL7ig1SSl66Ii2LUViirnZF2Op5OKvkwkLVMlLAKeVk0SgY9iboIsugIQsT7OxgkDUGeiJahB46Oxg3xrlVFD4nShyMebuOF8boSXbirN/fpbPcWeFgWDvJ7Djt+hv5j5Fe/wY3leNskL4bvP00TvLD9RfZAa/Aa/AGpOA9yMEhOAITgMEF+Aq+ge+9L70fvZ+9X6ur21trzkuwIb3f/wAb+1sO</latexit>¬Ø
d<latexit sha1_base64="NR7oH+A2FTd3uTP335Xhy8ycfEw=">AAAECHicdVPNbtQwEHa7/JTw0xaOXCLSFVy62mSXn2MEF45FYttKcbRyHKdrrX+C7dBdWX4BXoArvAE3xJW34AF4D5zsInX7M5KlmW/8jWfGM0XNqDbD4Z+t7d6t23fu7twL7j94+Gh3b//xsZaNwmSCJZPqtECaMCrIxFDDyGmtCOIFIyfF/F3rP/lMlKZSfDTLmuQcnQlaUYyMh3LIkZkVlS3d82k83YuGg2En4VUlXisRWMvRdH/7LywlbjgRBjOkdRYPa5NbpAzFjLgANprUCM/RGcm8KhAnOrdd1i7se6QMK6n8ESbs0IsMi7jWS174m22W+rKvBa/1YSQwYRuv23Oklz7YJthSjZRMb8KLSiF8KXlTvcktFXVjiMCr3KuGhUaGbVfDkiqCDVt6BWFFffkhniEfxvjeB4Fv85wg/znG2wEU5BxLzpEoLdRNTRTltdTEZaM8635EqjK3UWw7o0Yd7+LN1NoocTYaOS83xktdluSbSOqjOk+9mZO2Wdh+EIZQSsTomegMb84qyg4gT80siqPkoLMhVtc4Rxedrh+4/w2QZubr33zcT+dS+4oNUkqeuyzOs1E7RF3tirDV83BWyIWFqmEkgyXlZFEr2M5Nq4skgYYsTGsnh4OkNtAT0aLtobODcW2cW0Xhc6LE4Zg363jtN3qSnTjr53fpLHdWONiOnWR2HHf9DfxixJfX4KpynAziV4OXH8ZR+na9IjvgKXgGXoAYvAYpeA+OwARg8Al8Bd/A996X3o/ez96v1dXtrTXnCdiQ3u9/CDpY0w==</latexit>01
d<latexit sha1_base64="2Z6oe9pyxg2ATBdNCIHdeLgtWto=">AAAECHicdVPNbtQwEHa7/JTw0xaOXCLSFVy62mSXn2MEF45FYttKcbRyHKdrrX+C7dBdWX4BXoArvAE3xJW34AF4D5zsInX7M5KlmW/8jWfGM0XNqDbD4Z+t7d6t23fu7twL7j94+Gh3b//xsZaNwmSCJZPqtECaMCrIxFDDyGmtCOIFIyfF/F3rP/lMlKZSfDTLmuQcnQlaUYyMh3LIkZkVlS3d8+louhcNB8NOwqtKvFYisJaj6f72X1hK3HAiDGZI6ywe1ia3SBmKGXEBbDSpEZ6jM5J5VSBOdG67rF3Y90gZVlL5I0zYoRcZFnGtl7zwN9ss9WVfC17rw0hgwjZet+dIL32wTbClGimZ3oQXlUL4UvKmepNbKurGEIFXuVcNC40M266GJVUEG7b0CsKK+vJDPEM+jPG9DwLf5jlB/nOMtwMoyDmWnCNRWqibmijKa6mJy0Z51v2IVGVuo9h2Ro063sWbqbVR4mw0cl5ujJe6LMk3kdRHdZ56Mydts7D9IAyhlIjRM9EZ3pxVlB1AnppZFEfJQWdDrK5xji46XT9w/xsgzczXv/m4n86l9hUbpJQ8d1mcZ6N2iLraFWGr5+GskAsLVcNIBkvKyaJWsJ2bVhdJAg1ZmNZODgdJbaAnokXbQ2cH49o4t4rC50SJwzFv1vHab/QkO3HWz+/SWe6scLAdO8nsOO76G/jFiC+vwVXlOBnErwYvP4yj9O16RXbAU/AMvAAxeA1S8B4cgQnA4BP4Cr6B770vvR+9n71fq6vbW2vOE7Ahvd//AA9qWNU=</latexit>03
thecomputationrequiredtoqueryourrepresentationateachpoint x<latexit sha1_base64="Qn0cHsXD6WqDq2CbbbZbrxTiNRg=">AAAEDXicdVNJbtswFGXiDqk6Oe2yG6FKgG5iWLI7LAV0k2UK1EkAUQgomooJcxBIKrFB8Ay9QLftDboruu0ZeoDeo6TsAnGGDxD4/32+zz+xahjVZjj8s7Xdu3f/wcOdR9HjJ0+fPe/vvjjWslWYTLBkUp1WSBNGBZkYahg5bRRBvGLkpJp/DP6TC6I0leKzWTak5Ohc0JpiZDx01u/DCikLOTKzqrYL5876yXAw7CS+qaRrJQFrOTrb3f4LpxK3nAiDGdK6SIeNKS1ShmJGXARbTRqE5+icFF4ViBNd2i51F+97ZBrXUvkjTNyhVxkWca2XvPI3Q476ui+At/owEpiwjdftJdJLH2wTDFQjJdOb8KJWCF9L3tQfSktF0xoi8Cr3umWxkXFobTylimDDll5BWFFffoxnyIcxfgBR5Js8J8hPyHg7goJcYsk5ElMLddsQRXkjNXHFqCy6eUg1LW2SrobToI539WZubZI5m4yclzvj5a7Iyk0k91Gdp97NyUMWdj+KYyglYvRcdIY3ZzVle5DnZpakSbbX2RCrW5yjq063H7n/DZBm5uvffNyv6FL7ig1SSl66Ii2LUViirnZF2Op5OKvkwkLVMlLAKeVk0SgY9iboIsugIQsT7OxgkDUGeiJahB46Oxg3xrlVFD4nShyMebuOF8boSXbirN/fpbPcWeFgWDvJ7Djt+hv5j5Fe/wY3leNskL4bvP00TvLD9RfZAa/Aa/AGpOA9yMEhOAITgMEF+Aq+ge+9L70fvZ+9X6ur21trzkuwIb3f/wAb+1sO</latexit>¬Ø x<latexit sha1_base64="Qn0cHsXD6WqDq2CbbbZbrxTiNRg=">AAAEDXicdVNJbtswFGXiDqk6Oe2yG6FKgG5iWLI7LAV0k2UK1EkAUQgomooJcxBIKrFB8Ay9QLftDboruu0ZeoDeo6TsAnGGDxD4/32+zz+xahjVZjj8s7Xdu3f/wcOdR9HjJ0+fPe/vvjjWslWYTLBkUp1WSBNGBZkYahg5bRRBvGLkpJp/DP6TC6I0leKzWTak5Ohc0JpiZDx01u/DCikLOTKzqrYL5876yXAw7CS+qaRrJQFrOTrb3f4LpxK3nAiDGdK6SIeNKS1ShmJGXARbTRqE5+icFF4ViBNd2i51F+97ZBrXUvkjTNyhVxkWca2XvPI3Q476ui+At/owEpiwjdftJdJLH2wTDFQjJdOb8KJWCF9L3tQfSktF0xoi8Cr3umWxkXFobTylimDDll5BWFFffoxnyIcxfgBR5Js8J8hPyHg7goJcYsk5ElMLddsQRXkjNXHFqCy6eUg1LW2SrobToI539WZubZI5m4yclzvj5a7Iyk0k91Gdp97NyUMWdj+KYyglYvRcdIY3ZzVle5DnZpakSbbX2RCrW5yjq063H7n/DZBm5uvffNyv6FL7ig1SSl66Ii2LUViirnZF2Op5OKvkwkLVMlLAKeVk0SgY9iboIsugIQsT7OxgkDUGeiJahB46Oxg3xrlVFD4nShyMebuOF8boSXbirN/fpbPcWeFgWDvJ7Djt+hv5j5Fe/wY3leNskL4bvP00TvLD9RfZAa/Aa/AGpOA9yMEhOAITgMEF+Aq+ge+9L70fvZ+9X6ur21trzkuwIb3f/wAb+1sO</latexit>¬Ø o<latexit sha1_base64="hmFZUePpmjxjuHEljy0UAY6OIoU=">AAAEBnicdVNLbxMxEHYbHmV5tXDksmJbwaVRdhMex5W49Fgk0lZaryqv422s+LGyvSSR5Tt/gCv8A26IK3+DH8D/wN4EqeljJEsz3/gbz4xnqoZRbQaDP1vbvTt3793feRA9fPT4ydPdvWcnWrYKkzGWTKqzCmnCqCBjQw0jZ40iiFeMnFazD8F/+pkoTaX4ZJYNKTm6ELSmGBkPFZAjM61qK92r891k0B90El9X0rWSgLUcn+9t/4UTiVtOhMEMaV2kg8aUFilDMSMugq0mDcIzdEEKrwrEiS5tl7OLDzwyiWup/BEm7tDLDIu41kte+ZshR33VF8AbfRgJTNjG63aO9NIH2wQD1UjJ9Ca8qBXCV5I39fvSUtG0hgi8yr1uWWxkHHoaT6gi2LClVxBW1Jcf4ynyYYzvfBT5Js8I8l9jvB1BQeZYco7ExELdNkRR3khNXDEsV/8h1aS0SWo7o0Ed7/LN3NokczYZOi+3xstdkZWbSO6jOk+9nZOHLOxBFMdQSsTohegMb05ryvYhz800SZNsv7MhVjc4h5ed7iBy/xsgzdTXv/m4n82l9hUbpJScuyIti2EYoq52RdjqeTit5MJC1TJSwAnlZNEoGOYm6CLLoCELE+zssJ81BnoiWoQeOtsfNca5VRQ+I0ocjni7jhe+0ZPs2Fk/v0tnubPCwTB2ktlR2vU38ouRXl2D68pJ1k/f9t98HCX50XpFdsAL8BK8Bil4B3JwBI7BGGAgwVfwDXzvfen96P3s/Vpd3d5ac56DDen9/gfU3lhA</latexit> 0 <latexit sha1_base64="GmYWlBtyVplNrJjUIcMisAYkE20=">AAAEKnicdVPLbtQwFHU7PEp4tbBkE5FWFImOJpnhsYxAQmyQisS0leKochynY40fke20M7L8FfwGP8AW/oBdxRb+AyczSJ2WXsnSvef6XN+Xi5pRbQaD87X13o2bt25v3Anu3rv/4OHm1qMDLRuFyRhLJtVRgTRhVJCxoYaRo1oRxAtGDovpu9Z/eEqUplJ8NvOa5BydCFpRjIyHjjf3oKyJQkYqgTixpx/fu13IkZkUlS3dsxchLJCycIrqGrnnx5vRoD/oJLyqxEslAkvZP95a/wNLiRtOhMEMaZ3Fg9rkFilDMSMugI0mNcJTdEIyr7ZJ6Nx2dblwxyNlWEnljzBhh15kWMS1nvPC32xT1pd9LfhfH0YCE7byuj1Deu6DrYIt1UjJ9Co8qxTCl5I31ZvcUlE3hgi8yL1qWGhk2PY9LKki2LC5VxBW1Jcf4gnyYYyfThD4nk8J8uMz3g6gIGdYco5EaaFu/IQor6UmLhvmWTceqcrcRrHtjBp1vIs3U2ujxNlo6LxcGy91WZKvIqmP6jz1ek7aZmF3gjCEUiJGT0RneHNSUbYNeWomURwl250NsfqPc3jR6XYC968B0kx8/auP+/2da1+xQUrJM5fFeTZsl6irXRG2eB5OCjmzUDWMZLCknMxqBdu9aXWRJNCQmWntZK+f1AZ6Ipq1PXS2P6qNc4sofEqU2BvxZhmvHaMn2bGzfn/nznJnhYPt2klmR3HX38B/jPjyN7iqHCT9+FX/5adRlL5dfpEN8AQ8BbsgBq9BCj6AfTAGGHwB38B38KP3tfezd977tbi6vrbkPAYr0vv9F60yZq0=</latexit>vMF(d0,Ô£ø¬Ø)
alongthesereflectionrays.
<latexit sha1_base64="GmYWlBtyVplNrJjUIcMisAYkE20=">AAAEKnicdVPLbtQwFHU7PEp4tbBkE5FWFImOJpnhsYxAQmyQisS0leKochynY40fke20M7L8FfwGP8AW/oBdxRb+AyczSJ2WXsnSvef6XN+Xi5pRbQaD87X13o2bt25v3Anu3rv/4OHm1qMDLRuFyRhLJtVRgTRhVJCxoYaRo1oRxAtGDovpu9Z/eEqUplJ8NvOa5BydCFpRjIyHjjf3oKyJQkYqgTixpx/fu13IkZkUlS3dsxchLJCycIrqGrnnx5vRoD/oJLyqxEslAkvZP95a/wNLiRtOhMEMaZ3Fg9rkFilDMSMugI0mNcJTdEIyr7ZJ6Nx2dblwxyNlWEnljzBhh15kWMS1nvPC32xT1pd9LfhfH0YCE7byuj1Deu6DrYIt1UjJ9Co8qxTCl5I31ZvcUlE3hgi8yL1qWGhk2PY9LKki2LC5VxBW1Jcf4gnyYYyfThD4nk8J8uMz3g6gIGdYco5EaaFu/IQor6UmLhvmWTceqcrcRrHtjBp1vIs3U2ujxNlo6LxcGy91WZKvIqmP6jz1ek7aZmF3gjCEUiJGT0RneHNSUbYNeWomURwl250NsfqPc3jR6XYC968B0kx8/auP+/2da1+xQUrJM5fFeTZsl6irXRG2eB5OCjmzUDWMZLCknMxqBdu9aXWRJNCQmWntZK+f1AZ6Ipq1PXS2P6qNc4sofEqU2BvxZhmvHaMn2bGzfn/nznJnhYPt2klmR3HX38B/jPjyN7iqHCT9+FX/5adRlL5dfpEN8AQ8BbsgBq9BCj6AfTAGGHwB38B38KP3tfezd977tbi6vrbkPAYr0vv9F60yZq0=</latexit>vMF(d0,Ô£ø¬Ø)
o<latexit sha1_base64="hmFZUePpmjxjuHEljy0UAY6OIoU=">AAAEBnicdVNLbxMxEHYbHmV5tXDksmJbwaVRdhMex5W49Fgk0lZaryqv422s+LGyvSSR5Tt/gCv8A26IK3+DH8D/wN4EqeljJEsz3/gbz4xnqoZRbQaDP1vbvTt3793feRA9fPT4ydPdvWcnWrYKkzGWTKqzCmnCqCBjQw0jZ40iiFeMnFazD8F/+pkoTaX4ZJYNKTm6ELSmGBkPFZAjM61qK92r891k0B90El9X0rWSgLUcn+9t/4UTiVtOhMEMaV2kg8aUFilDMSMugq0mDcIzdEEKrwrEiS5tl7OLDzwyiWup/BEm7tDLDIu41kte+ZshR33VF8AbfRgJTNjG63aO9NIH2wQD1UjJ9Ca8qBXCV5I39fvSUtG0hgi8yr1uWWxkHHoaT6gi2LClVxBW1Jcf4ynyYYzvfBT5Js8I8l9jvB1BQeZYco7ExELdNkRR3khNXDEsV/8h1aS0SWo7o0Ed7/LN3NokczYZOi+3xstdkZWbSO6jOk+9nZOHLOxBFMdQSsTohegMb05ryvYhz800SZNsv7MhVjc4h5ed7iBy/xsgzdTXv/m4n82l9hUbpJScuyIti2EYoq52RdjqeTit5MJC1TJSwAnlZNEoGOYm6CLLoCELE+zssJ81BnoiWoQeOtsfNca5VRQ+I0ocjni7jhe+0ZPs2Fk/v0tnubPCwTB2ktlR2vU38ouRXl2D68pJ1k/f9t98HCX50XpFdsAL8BK8Bil4B3JwBI7BGGAgwVfwDXzvfen96P3s/Vpd3d5ac56DDen9/gfU3lhA</latexit> 0 o<latexit sha1_base64="hmFZUePpmjxjuHEljy0UAY6OIoU=">AAAEBnicdVNLbxMxEHYbHmV5tXDksmJbwaVRdhMex5W49Fgk0lZaryqv422s+LGyvSSR5Tt/gCv8A26IK3+DH8D/wN4EqeljJEsz3/gbz4xnqoZRbQaDP1vbvTt3793feRA9fPT4ydPdvWcnWrYKkzGWTKqzCmnCqCBjQw0jZ40iiFeMnFazD8F/+pkoTaX4ZJYNKTm6ELSmGBkPFZAjM61qK92r891k0B90El9X0rWSgLUcn+9t/4UTiVtOhMEMaV2kg8aUFilDMSMugq0mDcIzdEEKrwrEiS5tl7OLDzwyiWup/BEm7tDLDIu41kte+ZshR33VF8AbfRgJTNjG63aO9NIH2wQD1UjJ9Ca8qBXCV5I39fvSUtG0hgi8yr1uWWxkHHoaT6gi2LClVxBW1Jcf4ynyYYzvfBT5Js8I8l9jvB1BQeZYco7ExELdNkRR3khNXDEsV/8h1aS0SWo7o0Ed7/LN3NokczYZOi+3xstdkZWbSO6jOk+9nZOHLOxBFMdQSsTohegMb05ryvYhz800SZNsv7MhVjc4h5ed7iBy/xsgzdTXv/m4n82l9hUbpJScuyIti2EYoq52RdjqeTit5MJC1TJSwAnlZNEoGOYm6CLLoCELE+zssJ81BnoiWoQeOtsfNca5VRQ+I0ocjni7jhe+0ZPs2Fk/v0tnubPCwTB2ktlR2vU38ouRXl2D68pJ1k/f9t98HCX50XpFdsAL8BK8Bil4B3JwBI7BGGAgwVfwDXzvfen96P3s/Vpd3d5ac56DDen9/gfU3lhA</latexit> 0
Ourrepresentationof3Dvolumedensityandfeaturesisbasedon (<latexit sha1_base64="fo/wn2H/sRF91z7aS6lHqZMdLq4=">AAAEHHicdVNLbxMxEHYbHmV5tXDkwIptpSLRKLspD3FaiQvHIkhbab2qHMfJWvFjZXtpguUjf4M/wBX+ATfEFYkfwP/A3gSp6WMkSzPf+BvPjGeGNaPa9Hp/1tY7167fuLlxK7p95+69+5tbDw61bBQmAyyZVMdDpAmjggwMNYwc14ogPmTkaDh9E/xHH4nSVIoPZl6TkqOJoGOKkfHQyebjXfQ0fk/FhJFYofmz+BNRMlaymVSCaB2dbCa9bq+V+KKSLpUELOXgZGv9LxxJ3HAiDGZI6yLt1aa0SBmKGXERbDSpEZ6iCSm8KhAnurRtJS7e8cgoHkvljzBxi55lWMS1nvOhv8mRqfR5XwAv9WEkMGErr9tTpOc+2CoYqEZKplfh2VghfC55M35VWirqxhCBF7mPGxYbGYdOxyOqCDZs7hWEFfXlx7hCPozx/xFFkKMpQf7DjLcjKMgplpwjMbJQNzVRlNdSE1f0ywKGpKQalTZJbWvUqOWdvZlbm2TOJn3n5cp4uSuychXJfVTnqVdz8pCF3YniGEqJGJ2I1vBmNaZsG/LcVEmaZNutDbG6xNk/63Q7kfvfAGkqX//q435i59pXbJBS8tQVaVn0wxC1tSvCFs/DaihnFqqGkQKOKCezWsEwN0EXWQYNmZlgZ3vdrDbQE9Es9NDZ7n5tnFtE4VOixN4+b5bxwjd6kh046+d37ix3VjgYxk4yu5+2/Q2LkZ5fg4vKYdZNX3Sfv8uS/PVyRTbAI/AE7IIUvAQ5eAsOwABg8Bl8Bd/A986Xzo/Oz86vxdX1tSXnIViRzu9/6E9fgQ==</latexit>a)S
z<latexit
sha1_base64="jbmlyegU3dWzrLsOkhTUA6l2OqE=">AAAEDHicdVPNbhMxEHYbfsry0xaOXFZsI3FplN20gDitxIVjkUhbab2KHMfJWvHPyvbSBMuvwAtwhTfghrjyDjwA74G9CVLTn5EszXzjbzwznhnXjGrT7//Z2u7cuXvv/s6D6OGjx0929/afnmrZKEyGWDKpzsdIE0YFGRpqGDmvFUF8zMjZeP4u+M8+EaWpFB/NsiYlRzNBpxQj46HR3u5nomSsZDOrBNE6Gu0l/V6/lfi6kq6VBKzlZLS//RdOJG44EQYzpHWR9mtTWqQMxYy4CDaa1AjP0YwUXhWIE13aNnMXdz0yiadS+SNM3KKXGRZxrZd87G9yZCp91RfAG30YCUzYxuv2AumlD7YJBqqRkulNeDFVCF9J3kzflJaKujFE4FXu04bFRsahs/GEKoINW3oFYUV9+TGukA9jfP+jCHI0J8h/kPF2BAW5wJJzJCYW6qYmivJaauKKQVnAkJRUk9ImqW2NGrW8yzdza5PM2WTgvNwaL3dFVm4iuY/qPPV2Th6ysN0ojqGUiNGZaA1vVlPKDiDPTZWkSXbQ2hCrG5yDy07Xjdz/BkhT+fo3H/cTutS+YoOUkheuSMtiEIaorV0RtnoeVmO5sFA1jBRwQjlZ1AqGuQm6yDJoyMIEOzvsZbWBnogWoYfO9o5q49wqCp8TJQ6PeLOOF77Rk+zQWT+/S2e5s8LBMHaS2aO07W9YjPTqGlxXTrNe+qp3/CFL8rfrFdkBz8EL8BKk4DXIwXtwAoYAgwZ8Bd/A986Xzo/Oz86v1dXtrTXnGdiQzu9/VRhZ9Q==</latexit>i en rS<latexit sha1_base64="+V9n5ymQCbf2TO1TPkOQ6J6++wo=">AAAEB3icdVPNbhMxEHYbfsry0xaOXFZsI3GgUXZTfsRpJS4ciyBtpfWqchwnseKfle2lWVl+AF6AK7wBN8SVx+ABeA/sTZCS/oxkaeYbf+OZ8cyoYlSbfv/P1nbn1u07d3fuRfcfPHy0u7f/+ETLWmEyxJJJdTZCmjAqyNBQw8hZpQjiI0ZOR/N3wX/6mShNpfhkmoqUHE0FnVCMjIfgRyqmjMQKNS+i872k3+u3El9V0pWSgJUcn+9v/4VjiWtOhMEMaV2k/cqUFilDMSMugrUmFcJzNCWFVwXiRJe2TdrFXY+M44lU/ggTt+g6wyKudcNH/iZHZqYv+wJ4rQ8jgQnbeN1eIN34YJtgoBopmd6EFxOF8KXkzeRNaamoakMEXuY+qVlsZByaGo+pItiwxisIK+rLj/EM+TDGtz6KIEdzgvzfGG9HUJALLDlHYmyhriuiKK+kJq4YlAUMSUk1Lm2S2taoUMtbv5lbm2TOJgPn5cZ4uSuychPJfVTnqTdz8pCF7UZxDKVEjE5Fa3hzNqHsAPLczJI0yQ5aG2J1jXOw7nTdyP1vgDQzX//m4344G+0rNkgpeeGKtCwGYYja2hVhy+fhbCQXFqqakQKOKSeLSsEwN0EXWQYNWZhgZ4e9rDLQE9Ei9NDZ3lFlnFtG4XOixOERr1fxwjd6kh066+e3cZY7KxwMYyeZPUrb/obFSC+vwVXlJOulr3ovP2RJ/na1IjvgKXgGnoMUvAY5eA+OwRBgUIGv4Bv43vnS+dH52fm1vLq9teI8ARvS+f0PvSJX4g==</latexit>g oilne rg orl uea gyr h,a nzye e,r so sroughness (<latexit sha1_base64="UIAYkA9/aISeCtWVpmCzd9IR0kY=">AAAD/3icdVNLbxMxEHYbHmV5tIUjlxXbSuXQKLsJD3FaiQvHIpG20npVeR2na8WPle2liSwf+ANc4R9wQ1z5KfwA/gf2JkhNHyNZmvnG33hmPFM1jGozGPzZ2OzduXvv/taD6OGjx0+2d3afHmvZKkzGWDKpTiukCaOCjA01jJw2iiBeMXJSzd4H/8lnojSV4pNZNKTk6FzQKcXIBOigehmd7SSD/qCT+LqSrpQErOTobHfzL5xI3HIiDGZI6yIdNKa0SBmKGXERbDVpEJ6hc1J4VSBOdGm7ZF2875FJPJXKH2HiDr3MsIhrveCVv8mRqfVVXwBv9GEkMGFrr9sLpBc+2DoYqEZKptfh+VQhfCV5M31bWiqa1hCBl7lPWxYbGYdmxhOqCDZs4RWEFfXlx7hGPozxLY8iyNGMIP8nxtsRFOQCS86RmFio24YoyhupiSuGZQFDUlJNSpuktjMa1PEu38ytTTJnk6Hzcmu83BVZuY7kPqrz1Ns5ecjC7kdxDKVEjJ6LzvBmPaVsD/Lc1EmaZHudDbG6wTm87HT7kfvfAGlqX//6434oF9pXbJBS8sIVaVkMwxB1tSvCls/DupJzC1XLSAEnlJN5o2CYm6CLLIOGzE2ws8N+1hjoiWgeeuhsf9QY55ZR+IwocTji7Spe+EZPsmNn/fwunOXOCgfD2ElmR2nX37AY6dU1uK4cZ/30df/VxyzJ361WZAs8By/AAUjBG5CDD+AIjAEGNfgKvoHvvS+9H72fvV/Lq5sbK84zsCa93/8ApbhUSw==</latexit>b)
z<latexit
sha1_base64="egZg/huqzJb+2zC16IiQGWloMGE=">AAAEJnicdVNLbxMxEHYbHmV5tXDksmJTqT0QZTflISSklbhwLBJpK61XleM4WSt+rGwvTbD8G/gb/AGu8A+4IcSNC/8DexOkpo+RLM184288M54Z1Yxq0+//3tjs3Lh56/bWnejuvfsPHm7vPDrSslGYDLFkUp2MkCaMCjI01DByUiuC+IiR49HsbfAffyRKUyk+mEVNSo6mgk4oRsZDp9v7n4iSsZLNtBJE63ivC/VEIWxTZ+EM1TVy8Zu4392PTreTfq/fSnxZSVdKAlZyeLqz+ReOJW44EQYzpHWR9mtTWqQMxYy4CDaa1AjP0JQUXhWIE13atiYX73pkHE+k8keYuEXPMyziWi/4yN/kyFT6oi+AV/owEpiwtdftGdILH2wdDFQjJdPr8Dy050LyZvKqtFTUjSECL3OfNCw2Mg49j8dUEWzYwisIK+rLj3GFfBjjfyaKIEczgvzXGW9HUJAzLDlHYmyhbmqiKK+lJq4YlAUMSUk1Lm2S2taoUcs7fzO3NsmcTQbOy7Xxcldk5TqS+6jOU6/n5CELuxvFMZQSMToVreHNakJZF/LcVEmaZN3Whlhd4Rycd7rdyP1vgDSVr3/9cT+7C+0rNkgpeeaKtCwGYYja2hVhy+dhNZJzC1XDSAHHlJN5rWCYm6CLLIOGzE2ws2e9rDbQE9E89NDZ3kFtnFtG4TOixLMD3qzihW/0JDt01s/vwlnurHAwjJ1k9iBt+xsWI724BpeVo6yXvug9f58l+evVimyBJ+Ap2AMpeAly8A4cgiHA4DP4Cr6B750vnR+dn51fy6ubGyvOY7AmnT//AGamY1Q=</latexit>erR<latexit sha1_base64="DGX2kJ4vvl14gHDEto/qCZb4tM0=">AAAED3icdVPLbhMxFHUbHmV4tWXJZsQ0EgsaZSbhIVYjsWFZEGkrjUeVx3EaK36MbA9NZPkj+AG28AfsEFs+gQ/gP7AnQUr6uJKle8/1uS9fVzWj2vT7f7a2O7du37m7cy+6/+Dho8e7e/vHWjYKkxGWTKrTCmnCqCAjQw0jp7UiiFeMnFSzd8F/8pkoTaX4ZBY1KTk6F3RCMTIeOtvd/4gW8djnUbRqAvQiOttN+r1+K/FVJV0pCVjJ0dne9l84lrjhRBjMkNZF2q9NaZEyFDPiIthoUiM8Q+ek8KpAnOjStsW7uOuRcTyRyh9h4hZdZ1jEtV7wyt/kyEz1ZV8Ar/VhJDBhG9ntBdILH2wTDFQjJdOb8HyiEL5UvJm8KS0VdWOIwMvaJw2LjYzDcP0gFcGGhYkirKhvP8ZT5MMY/wRRBDmaEeTfyHg7goJcYMk5EmMLdVMTRXktNXHFoCxgKEqqcWmT1LZGjVre+s3c2iRzNhk4LzfGy12RlZtI7qM6T72Zk4cqbDeKYyglYvRctIY3pxPKDiDPzTRJk+ygtSFW1zgH607Xjdz/AUgz9f1vJvdLutC+Y4OUkheuSMtiEJao7V0RtkwPp5WcW6gaRgo4ppzMawXD3gRdZBk0ZG6CnR32stpAT0TzMENne8PaOLeMwmdEicMhb1bxwjN6kh056/d34Sx3VjgY1k4yO0zb+YaPkV7+BleV46yXvuq9/JAl+dvVF9kBT8Ez8Byk4DXIwXtwBEYAgzn4Cr6B750vnR+dn51fy6vbWyvOE7Ahnd//AOqQWu0=</latexit> oa ry oud gi hst nr eib ssut (i 1o /n Ô£ø,
=0)
(<latexit sha1_base64="7pEBVWJXcKCrsG5ORSiYlyaaVGs=">AAAD/3icdVPNbhMxEHYbfsry0xaOXFZsI5VDo+wm/IjTSlw4Fom0ldarynGcrhX/rGwvTWT5wAtwhTfghrjyKDwA74G9CVKTtiNZmvnG33hmPDOuGdWm3/+ztd25c/fe/Z0H0cNHj5/s7u0/PdGyUZiMsGRSnY2RJowKMjLUMHJWK4L4mJHT8ex98J9+JkpTKT6ZRU1Kji4EnVKMTIAO8cvofC/p9/qtxNeVdKUkYCXH5/vbf+FE4oYTYTBDWhdpvzalRcpQzIiLYKNJjfAMXZDCqwJxokvbJuvirkcm8VQqf4SJW/QqwyKu9YKP/U2OTKU3fQG80YeRwIStvW4vkV74YOtgoBopmV6H51OF8EbyZvq2tFTUjSECL3OfNiw2Mg7NjCdUEWzYwisIK+rLj3GFfBjjWx5FkKMZQf5PjLcjKMgllpwjMbFQNzVRlNdSE1cMygKGpKSalDZJbWvUqOVdvZlbm2TOJgPn5dZ4uSuych3JfVTnqbdz8pCF7UZxDKVEjF6I1vBmNaXsAPLcVEmaZAetDbG6wTm46nTdyP1vgDSVr3/9cT+UC+0rNkgpeemKtCwGYYja2hVhy+dhNZZzC1XDSAEnlJN5rWCYm6CLLIOGzE2ws6NeVhvoiWgeeuhsb1gb55ZR+IwocTTkzSpe+EZPsiNn/fwunOXOCgfD2Elmh2nb37AY6eYaXFdOsl76uvfqY5bk71YrsgOegxfgEKTgDcjBB3AMRgCDCnwF38D3zpfOj87Pzq/l1e2tFecZWJPO73+pUlRM</latexit>c)g<latexit sha1_base64="WKjXcAK/E/zmet12y0xMOXU+Xcc=">AAAEKXicdVNLbxMxEHYbHmV5tXDkYrGpVCQaZTflIQ5oJS4ci0TaSutV5ThOdhU/VraXJrL8J/gb/AGu8A+4AVfE/8DeBKnpYyRLM9/4G8+MZ0Y1q7Tp939tbHZu3Lx1e+tOdPfe/QcPt3ceHWnZKEKHRDKpTkZYU1YJOjSVYfSkVhTzEaPHo9m74D/+RJWupPhoFjUtOJ6KalIRbDx0uv18SgVVmEElm2kpqNZwr4v0RGFiE2fRDNc1dvAt7HefRafbcb/XbwVeVpKVEoOVHJ7ubP5FY0kaToUhDGudJ/3aFBYrUxFGXYQaTWtMZnhKc68KzKkubFuWg7seGcOJVP4IA1v0PMNirvWCj/xNjk2pL/oCeKWPYEEoW3vdnmG98MHWwUA1UjK9Ds9Dey4kbyavC1uJujFUkGXuk4ZBI2FoOxxXihLDFl7BRFW+fEhK7MMY/zlRhDieUex/z3g7QoKeEck5FmOLdFNTVfFaauryQZGjkJRU48LGiW2NGre88zcza+PU2XjgvFwbL3N5WqwjmY/qPPV6ThaysLsRhEhKzKqpaA1vlpOKdRHPTBkncdptbUTUFc7Beafbjdz/BkhT+vrXH/fju9C+YoOVkmcuT4p8EIaorV1RtnwelSM5t0g1jOZoXHE6rxUKcxN0kabI0LkJdrrfS2uDPBHPQw+d7R3UxrllFD6jSuwf8GYVL3yjJ9mhs35+F85yZ4VDYewkswdJ29+wGMnFNbisHKW95GXvxYc0zt6sVmQLPAFPwR5IwCuQgffgEAwBAZ/BV/ANfO986fzo/Oz8Xl7d3FhxHoM16fz5BxPUZJE=</latexit>eneR<latexit sha1_base64="DGX2kJ4vvl14gHDEto/qCZb4tM0=">AAAED3icdVPLbhMxFHUbHmV4tWXJZsQ0EgsaZSbhIVYjsWFZEGkrjUeVx3EaK36MbA9NZPkj+AG28AfsEFs+gQ/gP7AnQUr6uJKle8/1uS9fVzWj2vT7f7a2O7du37m7cy+6/+Dho8e7e/vHWjYKkxGWTKrTCmnCqCAjQw0jp7UiiFeMnFSzd8F/8pkoTaX4ZBY1KTk6F3RCMTIeOtvd/4gW8djnUbRqAvQiOttN+r1+K/FVJV0pCVjJ0dne9l84lrjhRBjMkNZF2q9NaZEyFDPiIthoUiM8Q+ek8KpAnOjStsW7uOuRcTyRyh9h4hZdZ1jEtV7wyt/kyEz1ZV8Ar/VhJDBhG9ntBdILH2wTDFQjJdOb8HyiEL5UvJm8KS0VdWOIwMvaJw2LjYzDcP0gFcGGhYkirKhvP8ZT5MMY/wRRBDmaEeTfyHg7goJcYMk5EmMLdVMTRXktNXHFoCxgKEqqcWmT1LZGjVre+s3c2iRzNhk4LzfGy12RlZtI7qM6T72Zk4cqbDeKYyglYvRctIY3pxPKDiDPzTRJk+ygtSFW1zgH607Xjdz/AUgz9f1vJvdLutC+Y4OUkheuSMtiEJao7V0RtkwPp5WcW6gaRgo4ppzMawXD3gRdZBk0ZG6CnR32stpAT0TzMENne8PaOLeMwmdEicMhb1bxwjN6kh056/d34Sx3VjgY1k4yO0zb+YaPkV7+BleV46yXvuq9/JAl+dvVF9kBT8Ez8Byk4DXIwXtwBEYAgzn4Cr6B750vnR+dn51fy6vbWyvOE7Ahnd//AOqQWu0=</latexit> raay lrd oi us gtr hi nb eu st sio (n 1/,
Ô£ø>0)
Zip-NeRF.AsdescribedinSection3,Zip-NeRFusesamulti-scale
hashgridtostore3Dfeatures,asmallMLP(1layer,width64)to Fig.3. WevisualizethereflectionconetracingproceduredescribedinSec-
decodethesefeaturesintodensity,andalargerMLP(3layers,width tion4.1.(a)Abasicmodelforreflections:araycastfromacamerarayorigin
256)todecodethesefeaturesintocolor.Thismeansthatquerying oalongviewdirectiondthat<latexit sha1_base64="3QmtLBis37D28LRe296U0RjungQ=">AAAF/nicdVTdbhM5FB6yG7bM7kK7XHJjbegWJBpl0u6CuIpAQtwgsdK2IMVR8TiexBv/jGxPm8iyxAtwC2/AHeKWV9kH2PfgeJLSTBssjXT+vs/nHJ8zeSm4db3ef9daP/zYvv7T1o30519+vXlre+e3Y6srQ9kR1UKb1zmxTHDFjhx3gr0uDSMyF+xVPnsa/a9OmbFcq3/comQjSSaKF5wSB6aTnVaCJXHTvPA6oD8e4wcIOzZ3nhLJDEGUKcdMQBin53HjTXGnnJ2hMTeMRtplfE6MPwfNwyaUIQsE9JIrshmmmjBbmYJQhpQ2koi18BkpS7Ix1OhqMlXM2kYNOuytBxtWiGXm6M2bZW57e43adQk2p40Cpz998SzcO6cyAVjWkri/TnwKjC+4ZXb/GbdTZqBF1hmeVxflenTBdPIvws0qiCwFG6O1BL812X7DX2r0FZYVOvI0G15TnGx3et1efdBVIVsJnWR1XsLM/I/HmlYS+kMFsXaY9Uo38sQ4TgULKa4sKwmdkQkbghh7Zke+ntWAdsEyRoU28CmHaus6whNp7ULmEBlLspd90bjRR4miTDRu92fELoCsaYxQp7WwTfO8MIReSt4Vj0aeq7JyTNFl7kUlkNMo7tLqLcQCBEINh/IRnRKggR7bNE7bjBFYSQd6ihU7o1pKosYe2woGistSWxaGB6Nh/XzajEe+ky3fsiQ1bj1y4H2nH3znIMD5Lt8gDPujpmUArAGg38cMYhZ+N0UIa00En6haAXVacHEXy4GbdrJO/26tY2o2OA/WnWE3DecN0A5GP21eDv+khYWKHTFGn4VhNhoexCGqazdMLK/H01zPPTaVYEM85pLNS4Pj3ERZ9fv1fEe9v9/tlw4DkMxjD4PvHpYuhCWLnDGj9g9lteKLzwggfxQ8zO8ieBngV4Pj2GnhD7O6vyksRnZ5Da4Kx/1u9lf3z78PO4MnqxXZSu4kvyf3kix5mAyS58nL5CihrUnrXet960P7bftj+1P78zK0dW2FuZ00TvvLVzdQEJo=</latexit> term do: :c cia anm me ear ra atc vee ien wster da iret ctia oncoordinatex¬Øwithasurfacenor-
thedensityandfeatureforsamplesalongraysischeaprelative
maln¬Øis‚Äúmirrored‚Äùaroundthes nx ¬Ø¬Øu: :c suram rf faea cr eac nrae oy rmtte ar laminnagtioennttoyieldareflected‚Äúcamera
toevaluatingcolor.Consideringtheseconstraints,weproposethe
rayorigin‚Äùo‚Ä≤anddirectiond‚Ä≤.T oÔ£ø¬Ø 0h: :s ri eu flsrf ea cc tme ior noou ‚Äúg cadh mnee es rs al ‚Äùd ceno tee rsnotconsiderthatZip-NeRF
tracespixelconesinsteadovfMFc(ra,Ô£ø¬Øm):veonrMaisers-aFiyshesr,diswtribhutiiocnhweaddressby(b)casting
followingproceduretorenderspecularappearance: areflectionconewithradius{{x¬Ør ùëü(cid:164)j j} }: :is rnea flm sep ctl te ed edr rae afl yde tc et rio mon ind fair te iaoc nti son rs ay,andparameterizingnot
(1) Queryvolumedensityalongeachcameraraytocompute justasinglereflectedraydirectionbutavonMises-Fisherdistributionover
theray‚Äôsexpectedterminationpointandsurfacenormal. reflectedraysvMF(d‚Ä≤,ùúÖ¬Ø),whereùúÖ¬Øistheinverse-roughnessofthesurface.
(2) Castareflectedconethroughtheexpectedterminationpoint Weapproximatethisdistributionwithasmallsetofrays{d‚Ä≤ ùëó}.(c)When
inthereflectiondirection. thesurfaceisnotaperfectmirror,thereflectionconewidensandtheorigin
(3) Use a small MLP to combine the accumulated reflection ofthereflectedrayconemustbepulledclosertothesurfacelocationto
maintainthesameintersectionwiththepixelcone.
featurewithothersampledquantities(suchasthediffuse
colorfeaturesandper-sampleblendingweights)toproduce
acolorvalueforeachsamplealongtheray.
(4) Alphacompositethesesamplesanddensitiesintothefinal smallsetofrayswithinthisconeandcomputesvolumedensityand
color. featuresatsampledpointsalongtheserays.Section4.3presents
ThesestepsareillustratedinFigure2andexplainedinmoredetail thecompleteappearancemodelthatdecodestheaccumulatedre-
below. flectionfeatureintoaspecularcolor.Finally,Section4.4provides
Section4.1describeshowourmethodestimatestheconeofre- additionaldetailsdescribinghowourmodelof3Dgeometryand
flectionraystobetraced.Section4.2detailshowourmodeltracesa featuresdiffersfromthestandardZip-NeRFarchitecture.4 ‚Ä¢ Verbinetal.
4.1 ReflectionConeTracing wheref¬Ø(ùùé)isthefeaturevectoraccumulatedinthedirectionùùé.
Foragivenraywithoriginoanddirectiond,wesampleùëÅ points EstimatingthisintegralusingMonteCarlooverrandomly-sampled
{x(ùëñ)} ùëñùëÅ
=1alongit,andevaluatetheNeRFtogetacollectionof3D
raysisprohibitivelyexpensivesinceeachsamplerequiresvolumet-
ricrenderingalongtheray.InspiredbyZip-NeRF,weapproximate
quantities such as the surface normal (and others to be defined
thisintegralusingasmallsetofrepresentativesamplescombined
shortly).Wethenalphacompositethesequantitiestogettheex-
withfeaturedownweighting.However,unlikeZip-NeRF,weper-
pectedsurfaceterminationpointx¬Ø,andtheray‚Äôsassociatedsurface
formbothoftheseoperationsinthe2Ddirectionaldomainrather
normaln¬Ø,byapplyingthevolumerenderingtypicallyusedforcolor
{c(ùëñ)} ùëñùëÅ =1inEquation1tothesamplepoints{x(ùëñ)} ùëñùëÅ
=1andnormals
thanin3DEuclideanspace.
{n(ùëñ)} ùëñùëÅ
=1: DirectionalSampling. Insteadofsamplingalargenumberofran-
domreflectionrays,weselectarepresentativesetofraysusing
ùëÅ ùëÅ
x¬Ø
=‚àëÔ∏Å ùë§(ùëñ)x(ùëñ),
n¬Ø
=‚àëÔ∏Å ùë§(ùëñ)n(ùëñ).
(4)
unscenteddirectionalsampling[Kurzetal.2016].Weevaluateùêæ
ùëñ=1 ùëñ=1 rays{(o‚Ä≤ ùëó,d‚Ä≤ ùëó)}ùêæ ùëó=1 (inourexperimentswesetùêæ = 5)selectedto
Wethenconstructanewreflectedraywithdirectiond‚Ä≤ byre-
maintainthemeand‚Ä≤andconcentrationùúÖ¬Ø,bysettingd 1‚Ä≤ =d‚Ä≤and
flectingtheinitialrayaboutthesurfacenormal:
{d‚Ä≤ ùëó}ùêæ
ùëó=2
placedonacirclearoundd‚Ä≤ whoseradiusdependsonùúÖ¬Ø.
Duringoptimizationwerandomlyrotatethesamplesrigidlyonthe
d‚Ä≤ =d‚àí2(n¬Ø¬∑d)n¬Ø. (5)
circleandduringevaluationwefixthem.Amoredetaileddescrip-
Tracingasinglereflectionraycannotbeusedtorendermaterials tionofthisprocedureisprovidedinAppendixB.
thatarenotperfectmirrors,anditignoresthefactthatZip-NeRF Foreachoftheùêæ sampledrays(o‚Ä≤ ùëó,d‚Ä≤ ùëó),weevaluatethevolume
tracesconesinsteadofraysforeachpixel.Accordingly,wemodela densityandappearancefeaturesatùëÅ‚Ä≤samplepointsalongtheray,
cone-likedistributionofreflectedrays.Theshapeofthisdistribution andvolumerenderthemintothefeaturef¬Ø(d‚Ä≤ ùëó).Inordertogenerate
isaffectedbytwofactors:theradiusoftheoriginalpixelconecast theseùëÅ‚Ä≤ samplesweusethesameprocedureassamplingtheùëÅ
fromthecamera,andtheroughnessofthesurfaceattheexpected raysonthecamerarays(seesupplementformoredetails).Theùêæ
terminationpointofthecameraray,asvisualizedinFigure3.We featuresarethenaveragedtoyieldasinglefeaturevectorforthe
startbymodelingboththecone-likedistributionofreflectedrays reflectedcone:
andthedistributionofreflectiondirectionsduetosurfaceroughness ùëÅ‚Ä≤ ùêæ
a ds istv ro ibn utM ioi nse ss c- eF nis teh re er d( av tM thF e, mi.e i. rra orn ro er flm ea ctli ioze nd dis rp eh cte ir oi nca dl ‚Ä≤G .Ta hu ess vi Man F) f¬Ø(d‚Ä≤ ùëó)=‚àëÔ∏Å ùëñ=1ùë§ ùëó(ùëñ) f(cid:16) x( ùëóùëñ)(cid:17) , f¬Ø= ùêæ1 ‚àëÔ∏Å ùëó=1f¬Ø(cid:16) d‚Ä≤ ùëó(cid:17) , (9)
width(reciprocalofitsconcentrationparameterùúÖ)forthepixelcone
distributionisthepixelradiusùëü(cid:164),andthevMFwidthforthesurface whereùë§ ùëó(ùëñ) andx( ùëóùëñ) arethe ùëóthreflectedray‚Äôsùëñthsampleweight
roughnessisaquantityùúåthatweparameterizeatanypointinspace. and3Dlocation,respectively,andf(x)isthefeatureatx.
Thereflectedrayconeatthecameraray‚Äôsexpectedtermination
pointismodeledasavMFdistributionvMF(d‚Ä≤,ùúÖ¬Ø),whosewidth ReflectionFeatureDownweighting. Thedirectionalsamplingde-
ùúÖ¬Ø‚àí1isthesumofthepixelraycone‚Äôsradiusùëü(cid:164)andthecomposited scribedabovehelpsselectasmallrepresentativesetofraystoaver-
roughnessùúå¬Øalongtheprimaryray: age.However,forsurfaceswithhighroughness,thesampledrays
canbedistantfromoneanotherrelativetotheunderlying3Dgrid
ùúÖ¬Ø‚àí1=ùëü(cid:164)+ùúå¬Ø. (6) cells.ThismeansthatthefeaturefromEquation9maybealiased,
andsmallvariationsinthereflectedraydirectionscancauselarge
Inordertoensurethatthecross-sectionofthereflectedraycone
variationsinappearance.
atthesurfacematchesthatoftheincidentray,weapplyaroughness-
Inordertopreventthis,weadaptthe‚Äúfeaturedownweighting‚Äù
dependentshifttothereflectedraycone‚Äôsoriginsothatitintersects
x¬Øwhilehavingtheincidentray‚Äôsradiusùëü(cid:164)‚à•o‚àíx¬Ø‚à•(seeFigure3(c) techniquefromZip-NeRFtoourdirectionalsetting.Wedothisby
multiplyingfeaturescorrespondingtovoxelsthataresmallrelative
andAppendixAformoredetails):
tothevMFconebyasmallmultiplier,reducingtheireffectonthe
ùëü(cid:164)
o‚Ä≤ =x¬Ø‚àí‚à•o‚àíx¬Ø‚à• d‚Ä≤. (7) renderingcolor.FollowingZip-NeRF,wedefinethedownweighted
ùëü(cid:164)+ùúå¬Ø
featureatapointxas:
Notethatwhentheaccumulatedroughnessùúå¬Øiszero,o‚Ä≤isnotshifted (cid:16)(cid:16)‚àö (cid:17) (cid:17)
towardsthesurface,andisinsteadperfectlymirroredtotheother
faa(x)=erf 8ùùÇùúé(x) ‚àí1 ‚äôf(x), (10)
sideofthesurface. whereùúé(x)isthe(scalar)scaleoftheconeatthepointx(defined
4.2 ConicalReflectedFeatures below),ùùÇ isavectorofthesamedimensionasf containingthe
scaleofNGPgridresolutioncorrespondingtoeveryentryoff,‚äô
NowthatwehavedefinedavMFdistributionoverreflectedrays, denoteselementwisemultiplication,andthereciprocalanderf(¬∑)
ourgoalistoestimatetheexpectedvolume-renderedfeatureover aretakenelementwise.Thedownweightedfeaturefaa(x)isusedin
thevMFdistribution,whichwecanthendecodetoareflectedcolor. Equation9inplaceoftheoriginalfeaturef(x).
Thisexpectedfeaturecanbewrittenas: Sincewefocusonlargescenes,whichrequireusingacontraction
f¬Ø‚òÖ =E ùùé‚àºvMF(d‚Ä≤,ùúÖ¬Ø)(cid:2) f¬Ø(ùùé)(cid:3) =‚à´ f¬Ø(ùùé)vMF(cid:0) ùùé;d‚Ä≤,ùúÖ¬Ø(cid:1)ùëëùùé, (8) f tu hn ec bti eo hn avC io( rE oq fu ùúéat (i xo )n i2 n), thit eis nop na lr it nic eu al rar rl ey gii om np oo frt ta hn et ct oo nc to ran cs ti id oe nr
.
S2NeRF-Casting:ImprovedView-DependentAppearancewithConsistentReflections ‚Ä¢ 5
Zip-NeRFscalesùúé(x) bythegeometricmeanofthecontraction
function‚Äôs3DJacobian‚Äôseigenvalues(Equation3).Thishastheun-
fortunate effect of causingùúé(x) to approach 0 (i.e., applying no
downweighting)forpointsxfarfromtheorigin,becauseCstrongly
contractsdistantpointstowardstheorigin.Asaresult,usingZip-
NeRF‚Äôsdownweightingfunctionwouldresultinsignificantaliasing
inreflectionsofdistantcontent.WeinsteadusetheJacobiandeter-
minantrestrictedtothe(2D)directionaldomain,anddefine: Inputimage (a)Ourrecoveredsurfacenormals
‚àöÔ∏É
ùúé(x)=ùõæ¬∑(ùëü(cid:164)+ùúå¬Ø)(cid:13) (cid:13)x‚àío‚Ä≤(cid:13) (cid:13) detJdir(x), (11)
C
whereùõæ isafixedscalemultiplierwhichwesetto16inallexperi-
ments,and:
(cid:18) ùúï (cid:18) x (cid:19)(cid:19)
detJd Cir(x)=detJC(x)¬∑
ùúï‚à•x‚à•
C(x)¬∑
‚à•x‚à•
‚àí1 (12)
(cid:18) 2max(1,‚à•x‚à•)‚àí1(cid:19)
= max(1,‚à•x‚à•)2 2. (13) (b)SymmetriclossùúÜùëõ=ùúÜùëõÀú =10‚àí2 (c)SymmetriclossùúÜùëõ=ùúÜùëõÀú =10‚àí3
Notethatwhenthepointxisfarfromtheorigin,thescaleinEqua-
‚à•x‚à•‚Üí‚àû
tion11approachesaconstant,ùúé ‚àí‚àí‚àí‚àí‚àí‚àí‚àí‚Üí2ùõæ(ùëü(cid:164)+ùúå¬Ø),incontrastto
Zip-NeRF‚Äôsscale,whichapproacheszeroandthereforedoesnot
downweightdistantcontent.Whilethismaybelessnoticeablein
Zip-NeRF,properlydownweightingdistantcontentiscrucialforus
topreventaliasinginreflectionsofdistantillumination.
4.3 ColorDecoder (d)Sharedreflectionfeatures (e)Singledilatedcone
Fig.4. Anablationstudyshowingtheeffectofdifferentdesignchoiceson
Theroleofthecolordecoderistoassignacolortoeverysample
ourrecoverednormals.Replacing(a)ourmodel‚Äôsasymmetricpredicted
pointalongaray.InspiredbyUniSDF[Wangetal.2023],ourcolor normalloss(Equation17)withthestandardsymmetriconetendsto(b)
decoderusesaconvexcombinationoftwocolorcomponents: oversmoothor(c)underconstraingeometry,preventingthenormalvectors
c(cid:16) x(ùëñ),d(cid:17) =ùõΩ(ùëñ)cùë£(cid:16) x(ùëñ),d(cid:17) +(cid:16) 1‚àíùõΩ(ùëñ)(cid:17) cùëü(cid:16) x(ùëñ),d‚Ä≤(cid:17)
, (14)
f ar ro em alc soon uv se er dg fin og rot to ht eh re ac po pr er ae rc at ns co elu ct oio mn p. o(d n) eU nts sin sg ucr hef ale sc tt he ed bf oea ttt lu enre es ckf¬Ø vw eh ci tc oh
r
whereùõΩ(ùëñ) ‚àà [0,1]isaweightingcoefficientoutputbythegeometry b,or(e)usingasingleconeinsteadofùêædirectionalsamplingconesalso
oftenresultinpoorrecoveryofsurfacenormals.
encoderfollowedbyasigmoidnonlinearity.Thefirstcolorcompo-
nentcùë£ issimilartothetypicalNeRFview-dependentappearance
model:
cùë£(cid:16) x(ùëñ),d(cid:17) =ùëî(cid:16) x(ùëñ),b(ùëñ),n(ùëñ),d(cid:17)
, (15) andwemakeuseofpredictednormalsnÀú outputbyasmallMLP
appliedtotheNGPfeatures.UnlikeRef-NeRF,weuseanasymmet-
andthesecondcomponentcùëü,designedtomodelglossyappearance,
ricpredictednormallosswhichallowsseparatemultipliersforthe
iscomputedas:
gradientsflowingfromthegeometrynormalsn(i.e.thenormalized
cùëü(cid:16) x(ùëñ),d‚Ä≤(cid:17) =‚Ñé(cid:16) x(ùëñ),b(ùëñ),n(ùëñ),d¬∑n(ùëñ),d‚Ä≤,f¬Ø(cid:17)
, (16) negativegradientofdensity)andrenderingweightsùë§alongtheray
tothepredictednormalsnÀú,andviceversa:
whereùëîand‚ÑéaresmallMLPs(seesupplementformoredetails),and
vf¬Ø ei cs tt oh re br ,efl sie mct ii lo an
r
f te oat ùõΩu ,r ie si an lt sr ood ou uc te pd ui tn bS yec ati so mn a4 l. l2. MT Lh Peb apot pt ll ie en dec tok L pred=ùúÜ ùëõLùëù(ùë§,n,sg(nÀú))+ùúÜ ùëõÀúLùëù(sg(ùë§),sg(n),nÀú), (17)
ùëÅ
g rae to hm eret tr hy anfe ia ntu imre as g.N eso pte act eh ,a at nu dn tli hk ee reU fn oi rS eD thF e,w ree fla ep cp tely dùõΩ fei an tu3 rD ess f¬Øpa ac re
e
where Lùëù(ùë§,n,nÀú)=‚àëÔ∏Å ùë§(ùëñ)(cid:13) (cid:13) (cid:13)n(ùëñ) ‚àínÀú(ùëñ)(cid:13) (cid:13) (cid:13)2. (18)
ùëñ=1
fedintothecolordecoderateverysamplealongthecameraray.We
findthatthisisusefulforconvergencesinceearlyinoptimization, Wheresg(¬∑)isastop-gradientoperator,whichpreventsgradients
whengeometryisstillfuzzy,everypointalongtheraycanmake fromflowingtoitsinput.
useofthereflectedfeature.Seefulldescriptionofthecolordecoder Inallofourexperimentsweusetheasymmetricpredictednormal
inthesupplement. losswithùúÜ ùëõ =10‚àí3andùúÜ ùëõÀú =0.3.Thisstronglytiesthepredicted
normalstotheonescorrespondingtotheNeRF‚Äôsdensity,while
4.4 GeometryRepresentationandRegularization
notoversmoothinggeometry.Thisallowsthepredictednormalsto
OurgeometryrepresentationisbasedonthatofZip-NeRF[Bar- resemblethegeometrynormalswhilebeingsignificantlysmoother,
ronetal.2023].SeeitsfulldescriptioninAppendixC.1.LikeRef- whichmakesthemusefulforcomputingthereflectiondirections
NeRF[Verbinetal.2022],weapplyorientationlosstothenormals, andcreatingaccuratespecularhighlights.6 ‚Ä¢ Verbinetal.
PSNR‚Üë SSIM‚Üë LPIPS‚Üì
maskedmetricsforallofournewly-capturedscenesaswellasthe
UniSDF 33.38 0.961 0.042 threescenesfromtheRef-NeRFrealdataset.Themaskedmetrics
Zip-NeRF 33.09 0.960 0.041 areusedtohighlightthebenefitofourmethodbyfocusingonshiny
Ref-NeRF* 32.59 0.957 0.042 regions of the captured scenes. See supplement for examples of
Ourswithsingledownweightedcone 33.63 0.964 0.038 thesemasks.
Ourswithsingledilatedcone 33.72 0.964 0.038
Ourswithoutdownweighting 33.63 0.964 0.038 5.2 BaselineComparisons
Ourswith3DJacobian 33.65 0.963 0.039
Wecompareourmethodwithpriorworkdesignedforphotorealis-
Ourswithoutnear-fieldreflections 33.30 0.962 0.040
ticviewsynthesisforgeneralsceneswithoutsignificantreflective
Ours 33.91 0.965 0.036
surfaces[Barronetal.2023;Kerbletal.2023],aswellasmethods
Table1. AverageresultsacrossthethreerealscenesfromRef-NeRF[Verbin
etal.2022]andfournewrealsceneswecapturedourselves.Metricsonly specially-designedforsceneswithshinyobjects[Liangetal.2023;
reportperformanceonshinyimageregions.The‚ÄúRef-NeRF*‚Äùbaselineis Verbinetal.2022;Wangetal.2023],aswellasconcurrentworksuch
animprovedversionofRef-NeRFthatusesZip-NeRF‚Äôsgeometrymodel, asNDE[Wuetal.2024]andSpecNeRF[Maetal.2023].Allbase-
samplingandoptimizationprocedure,butwithRef-NeRF‚Äôsappearance lineexperimentsweredonewiththegracioushelpoftheoriginal
model.Seethesupplementformanymorequantitativeresults. authors,orotherwiseusingtheofficialcodebases.
Table1showsacomparisonofourresultswithpriorwork,using
themaskedmetrics,showingthatourmethodisindeedmoreac-
curatethanpriorworkinregionsfeaturingshinysurfaces.Thisis
5 EXPERIMENTSANDRESULTS furtherexemplifiedqualitativelybyourresultsinFigures1,4,5,6,7,
and8.Oursupplementalwebpagealsoshowsaninteractivecom-
Weevaluateourmethodonfourdatasets.First,weusethethree
parisonofourresultswiththoseobtainedbypriorwork.
realscenesfromRef-NeRF[Verbinetal.2022]todemonstratethat
Our supplemental tables also show per-scene breakdowns of
our method decisively outperforms baselines for reconstructing
the metrics in Table 1, as well as their unmasked counterparts,
andrenderinghighlyreflectiveobjects.Second,weusethenine
metricsonthestandardmip-NeRF360dataset[Barronetal.2022]
scenesfrommip-NeRF360[Barronetal.2022]toshowthatour
featuringmostly-diffusescenes,andtheShinyBlenderdatasetfrom
method‚Äôsperformanceisnotlimitedtoshinyscenesandthatweare
Ref-NeRF[Verbinetal.2022],ontopoftwoadditionalshinyscenes
onparwithstate-of-the-arttechniquesforrenderingnovelviewsof
fromthestandardBlenderdataset[Mildenhalletal.2020]).
large-scalemostly-diffusescenes.Third,weusefournewly-captured
scenestodemonstratespecificeffectsandcapabilitiesofourmethod,
5.3 AblationStudies
suchasitsabilitytoaccuratelycapturenear-fieldreflections.Finally,
weshowresultsonthesyntheticShinyBlender datasetfromRef- Inthissectionwecarefullyablatethekeycomponentsofourmethod
NeRF[Verbinetal.2022]. tojustifyourdesigndecisions.Table1,andTables2and3inthe
Throughoutthissectionweprovidequantitativeandqualitative supplementcontainquantitativeresultsfortheseablationstudies,
resultsshowingthebenefitofourmethodsandtheeffectsofitscom- and the supplemental webpage contains video comparisons for
ponents.However,imageerrormetricsarefrequentlydominated them.
byeffectsprevalentinrealdata,suchascameramiscalibration,and
Tracingconesthroughtherecoveredscenesynthesizesmoreaccurate
illuminationandappearancechanges,andbecausethesmoothmo-
reflections. Figure6showsthatreplacingtheconetracingoperation
tionofthereflectionsisakeybenefitofourmethod,wesupplement
withsimplygatheringreflectionfeaturesatinfinity(whichdepends
ourpaperwithaninteractiveprojectpagecontainingmanyvideo
onlyonthereflectiondirection)stillrecoversfar-fieldreflections,
resultsdemonstratingtheseeffects,andencouragethereaderto
butcannotaccuratelyreproducenear-fieldreflections.
viewit.
WeimplementourmethodinJAX[Bradburyetal.2018].Op- Asymmetricpredictednormalloss,separatereflectionfeatures,and
timizationisdoneusing8V100GPUs,whichtakesourmethod multipleconesareallcrucialforrecoveringaccurategeometry. Fig-
approximately100minutestooptimizeforasinglescene,compared ure4(b,c)demonstratestheimportanceofourasymmetricnormal
with50minutesforZip-NeRFand200minutesforUniSDF.Allofour loss(Equation17).UsingRef-NeRF‚Äôsnormallosscanoversmooth
experimentsareperformedusingthesamesetofhyperparameters geometrywhenitsweightistoohigh.Itcanalsoresultinincorrect
(seesupplement). geometrywhenturnedtoolow,sincethepredictednormalscan
greatlydeviatefromtheonescorrespondingtogeometry,whichlets
5.1 EvaluationDetails
themoverfittoeachimage‚Äôsspecularhighlightswithoutproperly
Weevaluateallresultsusingthethreemetricscommonlyusedfor generalizingtounseenviews.
viewsynthesis:PSNR,SSIM[Wangetal.2004],andLPIPS[Zhang Figure4(d)showsthatusingthesameNGPcomponentsforboth
etal.2018].Inadditiontothesemetrics,whicharecomputedover thereflectedfeaturesf¬Øandtheappearancebottleneckvectorbmay
entireimages,wecompute‚Äúmasked‚ÄùPSNR,SSIM,andLPIPS.These alsoresultinpoorly-recoveredgeometry,duetothestrongdepen-
maskedmetricsarecomputedbycompositingtheshinyregions denceofthereflectionfeaturesonthesurfacenormals.Additionally,
(inboththerenderedandgroundtruthimages)ontoawhiteback- inFigure4(e)weshowthatusingasingleZip-NeRFconewithradius
ground,andthencomputingthestandardmetrics.Wecomputethe ùëü(cid:164)‚Ä≤ =ùëü(cid:164)+ùúå¬ØinsteadofourdirectionalsamplingcanleadtoinaccurateNeRF-Casting:ImprovedView-DependentAppearancewithConsistentReflections ‚Ä¢ 7
(a)Singlereflectionray (b)Nodownweighting (c)3DJacobian (d)Ours Groundtruth
Fig.5. Ablationofourreflectionanti-aliasingcomponents.Using(a)asinglereflectionrayinsteadoffive,(b)notdownweightingreflectionfeatures,or(c)
usingZip-NeRF‚Äôs3DJacobianinsteadofrestrictingittothe2DdirectionalJacobian,allresultininaccuratereflections.Evenforlow-roughnessobjectssuch
astheshinyspheresshownhere,aliasinginthereflectionsduringoptimizationpreventsthemodelfromaccuratelyreconstructingboththereflectivesurface
geometryaswellasthereflectedcontent.
6 CONCLUSION
geometry.Thisisbecausethemodelisonlysupervisedatconeradii
correspondingtothepixelfootprintsùëü(cid:164),andthereforeevaluating
Wehavepresentedamethodforrenderingscenescontaininghighly
itwithdilatedradiiùëü(cid:164)‚Ä≤maynotcorrespondtothetrueunderlying
specularobjects,byusinganeuralradiancefield.Ourmethodrelies
geometry,adverselyaffectingreconstruction. onreflectingconesoffofsurfacesinthesceneandtracingthem
throughtheNeRF,andonanovelsetoftechniquesdesignedtoanti-
aliasthesereflections,andisabletosynthesizeaccuratedetailed
Anti-aliasingmethodsimproverecoveredgeometryandreflections.
reflectionsofbothdistantandnear-fieldcontentthatconsistently
Figure5visualizestheimpactofourreflectionanti-aliasingstrate-
andsmoothlymovesacrosssurfaces.Wedemonstratethatourap-
giesonrenderedspecularities.Usingonlyasinglereflectionray,
proachquantitativelyoutperformspriorviewsynthesismodels,and
omittingthereflectionfeaturedownweighting,orusingZip-NeRF‚Äôs
thatitprovidesgreatqualitativeimprovementoverpriorwork‚Äôs
3DJacobianinsteadofour2DdirectionalJacobianfordownweight-
realisminrenderingnovelviews.
ing,alldecreasetheaccuracyofrenderedreflections.Intuitively,
ifreflectionsarealiasedduringoptimization,themodelisunable ACKNOWLEDGMENTS
torecoveraccuratesurfacegeometryoraccurategeometryand
We wish to thank Georgios Kopanas, Christian Richardt, Li Ma,
featuresforthereflectedcontent.
andLiwenWuforhelpingwithcomparisonresultsandfigures.We
wouldalsoliketothankCassidyCurtis,JanneKontkanen,Alek-
5.4 Discussion sanderHo≈Çy≈Ñski,AlexTrevithick,andGeorgiosKopanasforideas
andcommentsonourwork.
Our method quantitatively outperforms existing view synthesis
techniques, particularly for shiny surfaces that display detailed REFERENCES
specularreflections.However,webelievethatthequalitativevisual JonathanT.Barron,BenMildenhall,MatthewTancik,PeterHedman,RicardoMartin-
improvementsubstantiallyoutweighsthequantitativeimprovement Brualla,andPratulP.Srinivasan.2021.Mip-NeRF:AMultiscaleRepresentationfor
inimagemetricsandwestronglyurgereaderstoviewoursupple-
Anti-AliasingNeuralRadianceFields.ICCV(2021).
JonathanT.Barron,BenMildenhall,DorVerbin,PratulP.Srinivasan,andPeterHedman.
mentaryvideos.Mostnotably,thesmoothandconsistentmotionof 2022.Mip-NeRF360:UnboundedAnti-AliasedNeuralRadianceFields.CVPR(2022).
reflectionssynthesizedbyourmethodisstrikinglymorerealistic JonathanT.Barron,BenMildenhall,DorVerbin,PratulP.Srinivasan,andPeterHedman.
2023.Zip-NeRF:Anti-AliasedGrid-BasedNeuralRadianceFields.ICCV(2023).
thantheview-dependentappearancerenderedbybaselinemeth-
SaiBi,ZexiangXu,PratulP.Srinivasan,BenMildenhall,KalyanSunkavalli,Milos
ods.Thissuggeststhatstandardimageerrormetrics(PSNR,SSIM, Hasan,YannickHold-Geoffroy,DavidKriegman,andRaviRamamoorthi.2020.
etc.)arenotadequateforevaluatingthequalityofview-dependent NeuralReflectanceFieldsforAppearanceAcquisition.arXiv(2020).
JamesBradbury,RoyFrostig,PeterHawkins,MatthewJamesJohnson,ChrisLeary,
appearance. DougalMaclaurin,GeorgeNecula,AdamPaszke,JakeVanderPlas,SkyeWanderman-
Milne,andQiaoZhang.2018.JAX:composabletransformationsofPython+NumPy
programs. http://github.com/google/jax.
AnpeiChen,ZexiangXu,AndreasGeiger,JingyiYu,andHaoSu.2022. TensoRF:
5.5 Limitations
TensorialRadianceFields.ECCV(2022).
SaraFridovich-Keil,AlexYu,MatthewTancik,QinhongChen,BenjaminRecht,and
Whileourmethodissuccessfulinitsgoalofaccuratelyreconstruct-
AngjooKanazawa.2022.Plenoxels:Radiancefieldswithoutneuralnetworks.CVPR
ingandrenderingreflectivesurfaces,itisnotabletofullymodel (2022).
certaineffects.Becauseweonlyreflectfromtheexpectedtermi- HaianJin,IsabellaLiu,PeijiaXu,XiaoshuaiZhang,SongfangHan,SaiBi,Xiaowei
Zhou,ZexiangXu,andHaoSu.2023.TensoIR:TensorialInverseRendering.CVPR
nationpointofeachcameraray,ourmethodstrugglestorender (2023).
semi-transparentsurfaces.Additionally,thecameraoperatorisfre- AnimeshKarnewar,TobiasRitschel,OliverWang,andNiloyMitra.2022.ReLUFields:
TheLittleNon-linearityThatCould.SIGGRAPH(2022).
quentlyvisibleinreflectivesurfacesandourmodeldoesnotconsider
BernhardKerbl,GeorgiosKopanas,ThomasLeimk√ºhler,andGeorgeDrettakis.2023.
thispotentialsourceoferror. 3DGaussianSplattingforReal-TimeRadianceFieldRendering.SIGGRAPH(2023).8 ‚Ä¢ Verbinetal.
DiederikP.KingmaandJimmyBa.2015.Adam:Amethodforstochasticoptimization.
ICLR(2015).
GerhardKurz,IgorGilitschenski,andUweDHanebeck.2016.UnscentedvonMises‚Äì
FisherFiltering.IEEESignalProcessingLetters(2016).
RuofanLiang,HuitingChen,ChunlinLi,FanChen,SelvakumarPanneer,andNandita
Vijaykumar.2023.ENVIDR:ImplicitDifferentiableRendererwithNeuralEnviron-
mentLighting.ICCV(2023).
LiMa,VasuAgrawal,HaithemTurki,ChangilKim,ChenGao,PedroSander,Michael
Zollh√∂fer,andChristianRichardt.2023.SpecNeRF:GaussianDirectionalEncoding
forSpecularReflections.arXiv2312.13102(2023).
AlexanderMai,DorVerbin,FalkoKuester,andSaraFridovich-Keil.2023. Neural
microfacetfieldsforinverserendering.ICCV(2023).
BenMildenhall,PratulP.Srinivasan,MatthewTancik,JonathanT.Barron,RaviRa-
mamoorthi,andRenNg.2020.NeRF:RepresentingScenesasNeuralRadianceFields
forViewSynthesis.ECCV(2020).
ThomasM√ºller,AlexEvans,ChristophSchied,andAlexanderKeller.2022. Instant
NeuralGraphicsPrimitiveswithaMultiresolutionHashEncoding. SIGGRAPH
(2022).
KeunhongPark,UtkarshSinha,JonathanT.Barron,SofienBouaziz,DanB.Goldman,
StevenM.Seitz,andRicardoMartin-Brualla.2021. Nerfies:DeformableNeural
RadianceFields.ICCV(2021).
PratulP.Srinivasan,BoyangDeng,XiumingZhang,MatthewTancik,BenMildenhall,
andJonathanT.Barron.2021. NeRV:Neuralreflectanceandvisibilityfieldsfor
relightingandviewsynthesis.CVPR(2021).
ChengSun,MinSun,andHwann-TzongChen.2022.DirectVoxelGridOptimization:
Super-fastConvergenceforRadianceFieldsReconstruction.CVPR(2022).
DorVerbin,PeterHedman,BenMildenhall,ToddZickler,JonathanT.Barron,and
PratulP.Srinivasan.2022.Ref-NeRF:StructuredView-DependentAppearancefor
NeuralRadianceFields.CVPR(2022).
FangjinhuaWang,Marie-JulieRakotosaona,MichaelNiemeyer,RichardSzeliski,Marc
Pollefeys,andFedericoTombari.2023. UniSDF:UnifyingNeuralRepresenta-
tionsforHigh-Fidelity3DReconstructionofComplexSceneswithReflections.
arXiv:2312.13285(2023).
ZhouWang,AlanC.Bovik,HamidR.Sheikh,andEeroP.Simoncelli.2004. Image
qualityassessment:fromerrorvisibilitytostructuralsimilarity.IEEETIP(2004).
LiwenWu,SaiBi,ZexiangXu,FujunLuan,KaiZhang,IliyanGeorgiev,Kalyan
Sunkavalli,andRaviRamamoorthi.2024. NeuralDirectionalEncodingforEffi-
cientandAccurateView-DependentAppearanceModeling.CVPR(2024).
RichardZhang,PhillipIsola,AlexeiA.Efros,EliShechtman,andOliverWang.2018.
TheUnreasonableEffectivenessofDeepFeaturesasaPerceptualMetric. CVPR
(2018).
YiyuZhuang,QiZhang,XuanWang,HaoZhu,YingFeng,XiaoyuLi,YingShan,and
XunCao.2024.NeAI:APre-convolutedRepresentationforPlug-and-PlayNeural
AmbientIllumination.AAAI(2024).NeRF-Casting:ImprovedView-DependentAppearancewithConsistentReflections ‚Ä¢ 9
(a)UniSDF (b)Ourswithouttracedcones (c)Ours Groundtruth
Fig.6. Twoexamplesshowingthat(a)tracingconesandintersectingthemwiththegeometryoftheNeRFallowsourmodeltorecoverandrendernear-field
reflectionssuchasthestatueheadandconereflectedintheballs,andthecordandartworkreflectedinthetoaster.Thisisincontrastto(b)ourmodel
withthefeaturegridonlyqueriedinfinitely-faraway,or(c)UniSDF,bothofwhichonlyusethereflectiondirection.Notethatbothourmodelin(a)andour
ablatedmodelin(b)arecapableofrenderingaccuratefar-fieldreflections,whileUniSDFrendersblurryreflectionsevenforfar-fieldcontent.
(a)Zip-NeRF (b)UniSDF (c)SpecNeRF (d)NDE (e)Ours Groundtruth
Fig.7. Byreflectingraysintothegeometryofthemodel,ourmethod(e)isabletorenderspecularreflectionsthataremoreaccuratethanthoserendered
byexistingtechniques(a-d),whichtendtobelimitedbythecapacityoftheirrepresentationofview-dependentappearance.Noticethehigh-frequency
reflectionsrenderedbyourmodel,includingsharpdetailsinthetreebranchesandbuildingreflectedinthesphereontherightoftheimage.10 ‚Ä¢ Verbinetal.
(a)Zip-NeRF (b)UniSDF (c)Ours Groundtruth
Fig.8. Ourmodelrepresentsdetailedandaccuratereflectionsofnearbycontent.Otherbaselinesthatdonotexplicitlytracereflectionraysareunableto
renderreflectionsofthewindow,bowl,andpaintinginthisexample.Furthermore,noticehowourmethodaccuratelymodelshowthesenear-fieldreflections
moveacrossthetoasterasthecameraviewpointchanges.NeRF-Casting:ImprovedView-DependentAppearancewithConsistentReflections ‚Ä¢ 11
Supplementary material:
Thisapproachisnumericallystableforanyreflectiondirection
NeRF-Casting: Improved View-Dependent d‚Ä≤,sincethedenominatorwhennormalizingt1 isboundedfrom
Appearance with Consistent Reflections below.
C OPTIMIZATIONANDREPRESENTATION
Amajorbenefitofourmethodisthevisualqualityofresults SPECIFICATIONS
andreflectionsasthecameramovesaroundthescene.Thisisbest
Inthissectionwespecifyourmethod‚Äôsarchitectureandparame-
visualized in the set of comparisons included in our interactive
terizations,aswellastheoptimizationprocedureusedtofitittoa
supplementalwebpageathttps://nerf-casting.github.io.
collectionofimages.
A REFLECTEDCONEDERIVATION
C.1 Parameterization
InSection4.2wedescribeourapproachofshiftingtheray‚Äôsorigin
Weusethethree-roundproposalsamplingprocedureusedbymip-
awayfromthesurfacepointinordertomatchthereflectedray‚Äôs
NeRF360andZip-NeRF[Barronetal.2022,2023].Ourùëóthsampling
radiuswiththeincidentradius.Denotetheincidentcamerarayas
r(ùë°)=o+ùë°d,whereitsoriginanddirectionareoanddrespectively, round uses a hash grid with resolution 25,...,2ùëÄùëñ, withùëÄ 1 = 9,
anddenoteitsradiusbyùëü(cid:164).Similarly,denotethereflectedrayfrom ùëÄ 2 = 11,andùëÄ 3 = 13,eachhavingamaximumnumberof221
thepointx¬Ø asr‚Ä≤(ùë°) = o‚Ä≤ +ùë°d‚Ä≤,withoriginanddirectiono‚Ä≤ and elements.Forcamerarays,thefirsttworoundsofsamplinguse64
d‚Ä≤ respectively,anddenoteitsradiusbyùëü(cid:164)‚Ä≤.Asdescribedinmip- sampleseach,andthethirduses32samples.Forreflectedrays,we
onlyusethefirsttworounds,andgenerate64samplesineachone.
NeRF [Barron et al. 2021], the radius of the primary ray at x¬Ø is
ùëü(cid:164)‚à•x¬Ø‚àío‚à•,andtheradiusofthereflectedrayisùëü(cid:164)‚Ä≤‚à•x¬Ø‚àío‚Ä≤‚à•.Inorder
Ourappearancemodelusesahashgridwithresolutions20,...,29
withtwodimensionseach.
toequatethetworadiiattheintersectionpointwemustsatisfy:
Wefindthatusingseparatefeaturegridsforthepredictednor-
ùëü(cid:164)‚à•x¬Ø‚àío‚à•=ùëü(cid:164)‚Ä≤‚à•x¬Ø‚àío‚Ä≤‚à•, (19) malsandforroughnessisbeneficialinourexperiments.Therefore,
whichalongwiththefactthato‚Ä≤mustbeontherayr‚Ä≤(ùë°),andwith thefinalroundofsamplingqueriesthreeseparateNGPfeatures
Equation8canbesolvedtoyieldEquation7. witheighttotaldimensions:oneforroughness,threeforpredicted
normals,andfourforthedensity,bottleneckvector,andmixing
B DIRECTIONALSAMPLING coefficientsùõΩ.Theroughnessvaluesareobtainedbyapplyingto
Asdescribedin[Kurzetal.2016],wechooseùêæ directionsonthe therawNGPfeaturefÀú ùúå atwo-layerMLPwithhiddendimension64,
sphere{d‚Ä≤ ùëó}ùêæ ùëó=1suchthatthemeand‚Ä≤andconcentrationparameter followedbyasoftplusactivation.Wealsoapplyabiasof‚àí1tothe
ùúÖ¬ØofthevMFdistributionaremaintained: features:
(cid:16) (cid:17)
d‚Ä≤ =d‚Ä≤, andforùëó ‚àà{0,...,ùêæ‚àí2}: (20)
ùúå =softplus MLP(fÀú ùúå)‚àí1 . (24)
1
(cid:18) (cid:18) 2ùëóùúã (cid:19) (cid:18) 2ùëóùúã (cid:19) (cid:19) ThepredictednormalsareobtainedfromtherawNGPfeatures
d‚Ä≤ ùëó+2=cos(ùúì)d‚Ä≤+sin(ùúì) cos
ùêæ‚àí1
t1+sin
ùêæ‚àí1
t2 , fÀú ùëõbyapplyinganothertwo-layerMLPwithhiddendimension64,
theoutputofwhichisnormalized:
where (t1,t2,d‚Ä≤) formanorthonormalbasis,andtheangleùúì be- (cid:16) (cid:16) (cid:17)(cid:17)
tweenthemeanreflectiondirectiond‚Ä≤andtheotherùêæ‚àí1offset nÀú =normalize MLP fÀú ùëõ , (25)
reflections{d‚Ä≤ ùëó}ùêæ ùëó=2ischosensuchthat:
wherenormalize(x)=x/‚à•x‚à•.
ùêæ(cid:0) coth(ùúÖ¬Ø)‚àí1/ùúÖ¬Ø(cid:1)‚àí1 Finally,theremainingfeaturesfÀú ùëèareusedtooutputdensityusing
cos(ùúì)= ùêæ‚àí1 . (21) anothertwo-layerMLP,followedbyanexponentialnonlinearity
(withabiasof2):
Notethatthereisrotationalsymmetryinhowthetangentvectors
(cid:16) (cid:16) (cid:17) (cid:17)
t1andt2aredefined.Duringoptimizationwerandomlyrotatethem ùúè =exp MLP fÀú ùëè +2 , (26)
inthetangentplane,andduringevaluationwesetadeterministic
orientation.Seethesupplementforspecificdetails. andtooutputthemixingcoefficients:
theIn reS fle ec cti to ion n4 d.2 irw ece tid oe nfi dn ‚Ä≤e da en fio nr et dho inno Er qm ua al tib oa nsi 5s .( Tt1 h, et2 t, wd o‚Ä≤) ta ar no gu en nd
t
ùõΩ =sigmoid(cid:16) MLP(cid:16) fÀú ùëè(cid:17)(cid:17) , (27)
vectorst1andt2aresymmetricandmayberotatedarbitrarilyabout Theview-dependentcolorMLPùëîfromEquation15takesasinputs
the normal vector, and we do that during optimization. During thepositionx,bottleneckvectorb,normaln,andviewdirectiond.
evaluation,however,weuseadeterministicbasisbyfirstdefining: Thereflection-dependentcolorMLP‚ÑéfromEquation16takesas
u=(cid:40) zÀÜ if|d‚Ä≤¬∑zÀÜ| <0.9
(22)
i tn hp eu nt oth rmep alos ai nti don vix e, wbo dt it rl ee cn te ic ok nb n,n ¬∑o dr ,m tha eln re,t flh ee cd teo dtp raro yd du ic rt eb cte it ow ne den
‚Ä≤,
yÀÜ otherwise andthefeaturevectorf¬Ø.Additionally,wefeedintobothùëì andùëîthe
where(xÀÜ,yÀÜ,zÀÜ)arethestandardbasisforR3.Wethensetthetangent camerapositionwithalow-degreepositionalencodingof2,i.e.,we
input(cos(o),sin(o),cos(2o),sin(o)).Thisisdesignedtoenablethe
vectorsto:
u√ód‚Ä≤ MLPtoaccountforspatialvariationsinappearanceduetotransient
t1= ‚à•u√ód‚Ä≤‚à•, t2=d‚Ä≤√ót1. (23)
effectslikeshadowingandilluminationchanges‚Äîsomethingthat12 ‚Ä¢ Verbinetal.
canbeencodedintoview-dependentappearancebymodelsrelying generallyreducesaliasingbyallowingùëü tobedeterminedadap-
onalarge-capacityMLPlikeZip-NeRF.BothofourMLPsùëîand tivelyduringtrainingandindependentlyforeachinterval(rather
‚Ñéaretwo-layerMLPswithhiddendimension128,followedbya thanasinglevaluebeingusedacrossallintervals).Computingthis
logisticsigmoidnonlinearity. adaptiveradiusisstraightforward:wecomputethelogarithmofthe
Weapplyacoarse-to-finescheduletoallNGPgridscorresponding widthofeachintervalintheproposaldistribution,thenuseZip-
tofÀú ùëõ,fÀú ùëè,andùëìÀú ùëè,similartoUniSDF[Wangetal.2023].UnlikeUniSDF, NeRF‚Äôsresamplingfunctionalitytointerpolateintoastepfunction
weuseanapproachmoresimilartoNerfies[Parketal.2021],which whosevaluesarethoselog-widths,thenexponentiatetheaverage
uses a cosine-shaped windowing function. Every feature f gets log-widthforeachNeRFintervaltoyieldageometricmean.
multipliedbyacosinewindow: LikeinZip-NeRF,weregularizethedensityfieldusingthedis-
tortionlossfrommip-NeRF360[Barronetal.2022].Critically,we
f‚Ä≤ =f ‚äôw(ùùÇ,ùë°), (28) applythedistortionlosstobothcameraraysandreflectedrays.This
preventsthegradientsofthereflectedraydensitiesfromcreating
where‚äôdenoteselementwisemultiplication,ùùÇ isavectorofreso-
‚Äúfloater‚Äùartifactsinregionsthatareunobservedorobservedbya
lutionscorrespondingtothelevelsofthehashgrid(asalsousedin
themainpaper),ùë° ‚àà [0,1]isascalarwhichgrowslinearlyfrom0 smallnumberofcameras.
We also use the orientation loss from Ref-NeRF [Verbin et al.
to1duringoptimization,andthewindowingfunctionisdefinedas:
2022],applieddirectlytothenormalvectorscorrespondingtothe
1‚àícos(ùúãùùÉ(ùùÇ,ùë°)) densityfield,withweight10‚àí3.
w(ùùÇ,ùë°)= , (29)
2 Finally,weapplystop-gradientoperatorstopreventgradients
whereùùÉ(ùùÇ,ùë°)=clip(cid:0) log (ùëö)‚àílog (ùùÇ)‚àí1+ùë†ùë°(cid:1), (30) fromaffectingtheweightswhenaccumulatingthenormalvectors
2 2
andintersectionpointsaccordingtoEquation4ofthemainpaper.
whereùë† andùëö arehyperparameterscontrolingtherateofintro-
ductionofnewscalesandtheinitialscale,respectively,andclipis C.3 DatasetandMasks
afunctionthatclipsitsinputto[0,1].Inourexperimentsweset
‚àö Ournewly-captureddatasetcontainsfournewsceneswithbetween
ùëö=16 2andùë† =25.
231and348imageseach,allwithresolution3504√ó2336(whichwe
downsamplebyafactorof4,asdoneinthemip-NeRF360outdoor
C.2 Optimization
dataset).Likethemip-NeRF360andrealRef-NeRFdatasets,weuse
WeinheritZip-NeRF‚Äôsoptimizationschedule.However,duetothe every8thframeasatestimages,andusetherestfortraining.The
increasedpeakmemoryconsumptionofhavingbothprimaryand per-scenebreakdownisasfollows:
reflectedrays,wehalveourbatchsizefrom216to215,andrunopti-
(1) toaster contains348images,outofwhich44areusedfor
mizationfor50kiterationsinsteadof25ùëò.LikeZip-NeRF,weuse
testing.
theAdamoptimizer[KingmaandBa2015]withùõΩ 1=0.9,ùõΩ 2=0.99,
(2) hatchbackcontains308images,38usedfortesting.
andùúÄ =10‚àí15,andourlearningrateisdecayedlogarithmicallyfrom
(3) grindercontains231images,28usedfortesting.
10‚àí2to10‚àí3forthefirst25kiterationsaftera5kcosinewarmup.
(4) compactcontains332images,41usedfortesting.
UnlikeZip-NeRFwecontinuetrainingforanadditional25kitera-
tionswithaconstantlearningrateof10‚àí3.Becausewedoublethe SeeFigure9forexamplesofimagescapturedfromthesefour
scenes.
numberofiterationswhilehalvingthebatchsize,ourmodel‚Äúsees‚Äú
Additionally,inordertofocusontheappearanceofreflections
roughlyasmanyrays/pixelsasZip-NeRFduringtraining.
inthesescenesaswellasthecapturedscenesfromtheRef-NeRF
Zip-NeRFperformedproposalsupervisionusingaspline-based
dataset,wecalculatemaskedmetricswhichonlytakeintoaccount
lossthatencouragedproposaldistributionsalongeachraytore-
foregroundpixelsbelongingtoshinyobjects.Themasksarecom-
semblethefinalNeRFdistributionalongtheray.Thislossrequires
ahyperparameterùëü foreachproposallevel,whichistheradiusof putedbydefininga3Dboundingboxfortheforegroundreflective
objects,renderingtheopacitywithintheboundingboxforeach
arectangularpulsethattheNeRFdistributionisblurredbywhen
test view, binarizing the resulting accumulated opacity, and fill-
computingthisspline-basedloss.Correctlysettingthishyperpa-
ingsmallholes.Figure9alsoshowsexamplesofimagesandtheir
rameteriscriticaltoavoidaliasingalongrays,andinZip-NeRF
theradiiaremanuallysetto0.03and0.003forthetwoproposal correspondingmasksfromallsevenscenes.
levelsrespectively.Inourmodelweusetheproposalnetworknot
D PER-SCENERESULTS
justforrenderingpixelsusingrayintervalsofconstantlength,but
alsoforrenderingreflectionsusingrayintervalsofvariablelength, Table2presentsourper-sceneresultsforTable1ofthemainpaper.
sousingmanually-tunedhyperparametersfortheseblurradiiis Additionally,Table3presentsthesameresultsforthefull,unmasked
challenging.WethereforemodifyZip-NeRF‚Äôsproposalsupervision images.
proceduretoavoidtheneedforamanually-setùëü value,andinstead
E SYNTHETICRESULTS
blureachintervaloftheNeRFdistributionbyarectangularpulse
whoseradiusistheweightedgeometricmeanoftheintervalsof Table5showssyntheticresultsonthematerialsandhotdogscenes
theproposaldistributionthatoverlapwitheachNeRFinterval.This fromtheBlenderdataset[Mildenhalletal.2020],whichcontain
notonlyavoidstheneedtomanuallyspecifytheùëü hyperparameter strongspecularities,andthesixshinyscenesfromRef-NeRF[Verbin
individuallyforeachprimaryandreflectedproposallevel,butalso etal.2022].TheresultsdemonstratethatdespitebeingdesignedforNeRF-Casting:ImprovedView-DependentAppearancewithConsistentReflections ‚Ä¢ 13
Fig.9. Imagesshowingournewfourscenes(top)alongwiththeirper-imagemasks,andthemasksobtainedfortherealRef-NeRFdata[Verbinetal.2022].
robustnessonrealdata,ourapproachstillobtainsstate-of-the-art
resultsontheseshinysyntheticscenes.14 ‚Ä¢ Verbinetal.
MaskedPSNR Ref-NeRFRealScenes OurShinyScenes
sedan toycar spheres hatchback toaster compact grinder
UniSDF 31.58 28.09 32.33 30.98 37.66 33.95 39.07
Zip-NeRF 30.83 28.04 29.38 31.30 36.85 35.04 40.19
Ref-NeRF* 30.74 28.13 29.08 29.51 37.02 34.42 39.20
Ourswithsingledownweightedcone 33.01 28.87 31.68 31.37 37.41 34.15 38.89
Ourswithsingledilatedcone 32.59 28.88 31.93 32.22 36.90 34.58 38.91
Ourswithoutdownweighting 32.77 28.87 31.79 31.57 37.54 33.97 38.93
Ourswith3DJacobian 33.06 28.77 30.86 31.81 37.61 34.55 38.87
Ourswithoutnear-fieldreflections 31.89 28.91 32.32 31.19 36.69 33.41 38.70
Ours 33.30 28.87 32.80 31.97 37.87 33.55 38.99
MaskedSSIM Ref-NeRFRealScenes OurShinyScenes
sedan toycar spheres hatchback toaster compact grinder
UniSDF 0.941 0.930 0.955 0.952 0.986 0.968 0.994
Zip-NeRF 0.936 0.934 0.944 0.953 0.985 0.972 0.994
Ref-NeRF* 0.936 0.932 0.941 0.943 0.983 0.970 0.994
Ourswithsingledownweightedcone 0.949 0.937 0.952 0.955 0.986 0.972 0.994
Ourswithsingledilatedcone 0.947 0.937 0.956 0.961 0.984 0.972 0.994
Ourswithoutdownweighting 0.948 0.937 0.954 0.956 0.986 0.970 0.994
Ourswith3DJacobian 0.949 0.936 0.946 0.957 0.987 0.972 0.994
Ourswithoutnear-fieldreflections 0.943 0.937 0.956 0.952 0.984 0.967 0.993
Ours 0.950 0.936 0.962 0.959 0.988 0.969 0.994
MaskedLPIPS Ref-NeRFRealScenes OurShinyScenes
sedan toycar spheres hatchback toaster compact grinder
UniSDF 0.083 0.064 0.040 0.046 0.022 0.033 0.007
Zip-NeRF 0.082 0.062 0.045 0.045 0.022 0.027 0.006
Ref-NeRF* 0.082 0.066 0.046 0.052 0.024 0.029 0.006
Ourswithsingledownweightedcone 0.071 0.060 0.039 0.044 0.021 0.027 0.006
Ourswithsingledilatedcone 0.073 0.061 0.037 0.039 0.023 0.027 0.006
Ourswithoutdownweighting 0.072 0.060 0.037 0.044 0.021 0.029 0.006
Ourswith3DJacobian 0.071 0.061 0.045 0.043 0.019 0.027 0.006
Ourswithoutnear-fieldreflections 0.075 0.060 0.036 0.047 0.024 0.032 0.007
Ours 0.070 0.061 0.030 0.040 0.018 0.030 0.006
Table2. Ablationstudyofourmethodaswellascomparisontopriorwork,usingmaskedimages.Themetricsarecomputedonlytakingintoaccountpixels
belongingtotheforegroundobjects.SeeSectionC.3formoreinformationandexamples.NeRF-Casting:ImprovedView-DependentAppearancewithConsistentReflections ‚Ä¢ 15
PSNR Ref-NeRFRealScenes OurShinyScenes
sedan toycar spheres hatchback toaster compact grinder
UniSDF 24.68 24.15 22.27 27.01 32.90 29.72 33.72
Zip-NeRF 25.85 23.41 21.77 27.78 33.41 31.10 34.67
Ref-NeRF* 25.39 22.75 21.12 25.21 32.66 30.55 33.91
Ourswithsingledownweightedcone 26.73 24.22 22.85 27.35 32.89 30.01 33.94
Ourswithsingledilatedcone 26.25 24.26 22.94 27.57 32.51 29.91 33.98
Ourswithoutdownweighting 26.59 24.28 22.89 27.29 33.07 29.87 33.95
Ourswith3DJacobian 26.77 24.18 22.62 27.39 32.92 29.98 33.93
Ourswithoutnear-fieldreflections 26.28 24.27 22.97 27.19 32.54 29.54 33.89
Ours 26.77 24.20 23.04 27.49 32.87 29.73 34.00
SSIM Ref-NeRFRealScenes OurShinyScenes
sedan toycar spheres hatchback toaster compact grinder
UniSDF 0.700 0.639 0.567 0.845 0.937 0.895 0.879
Zip-NeRF 0.733 0.626 0.545 0.870 0.944 0.913 0.887
Ref-NeRF* 0.721 0.612 0.542 0.842 0.932 0.907 0.880
Ourswithsingledownweightedcone 0.741 0.643 0.590 0.841 0.936 0.889 0.881
Ourswithsingledilatedcone 0.722 0.644 0.595 0.834 0.934 0.879 0.881
Ourswithoutdownweighting 0.735 0.643 0.591 0.842 0.937 0.884 0.881
Ourswith3DJacobian 0.741 0.640 0.581 0.834 0.937 0.884 0.881
Ourswithoutnear-fieldreflections 0.731 0.644 0.593 0.843 0.935 0.877 0.881
Ours 0.739 0.641 0.597 0.853 0.938 0.884 0.882
LPIPS Ref-NeRFRealScenes OurShinyScenes
sedan toycar balls hatchback toaster compact grinder
UniSDF 0.309 0.245 0.243 0.160 0.107 0.122 0.132
Zip-NeRF 0.260 0.243 0.238 0.130 0.082 0.096 0.111
Ref-NeRF* 0.270 0.257 0.257 0.156 0.111 0.105 0.123
Ourswithsingledownweightedcone 0.256 0.245 0.242 0.165 0.102 0.142 0.114
Ourswithsingledilatedcone 0.271 0.246 0.240 0.172 0.102 0.155 0.115
Ourswithoutdownweighting 0.260 0.246 0.242 0.166 0.098 0.151 0.114
Ourswith3DJacobian 0.255 0.247 0.251 0.179 0.100 0.155 0.115
Ourswithoutnear-fieldreflections 0.261 0.246 0.243 0.164 0.101 0.161 0.115
Ours 0.254 0.246 0.238 0.155 0.096 0.148 0.114
Table3. Ablationstudyofourmethodaswellascomparisontopriorwork,usingunmaskedimages.16 ‚Ä¢ Verbinetal.
PSNR Mip-NeRF360OutdoorScenes Mip-NeRF360IndoorScenes Ref-NeRFRealScenes
bicycle flowers garden stump treehill room counter kitchen bonsai sedan toycar spheres
3DGS 25.25 21.52 27.41 26.55 22.49 30.63 28.70 30.32 31.98 25.24 23.91 21.95
UniSDF 24.67 21.83 27.46 26.39 23.51 31.25 29.26 31.73 32.86 24.68 24.15 22.27
Zip-NeRF 25.80 22.40 28.20 27.55 23.89 32.65 29.38 32.50 34.46 25.85 23.41 21.77
Ref-NeRF* 24.91 21.63 27.45 25.91 21.79 31.68 26.02 31.61 32.29 25.40 22.75 21.13
Ours 24.92 21.75 27.31 25.64 23.22 31.66 28.84 32.26 33.81 26.77 24.20 23.04
SSIM Mip-NeRF360OutdoorScenes Mip-NeRF360IndoorScenes Ref-NeRFRealScenes
bicycle flowers garden stump treehill room counter kitchen bonsai sedan toycar spheres
3DGS 0.771 0.605 0.868 0.775 0.638 0.914 0.905 0.922 0.938 0.713 0.636 0.573
UniSDF 0.737 0.606 0.844 0.759 0.670 0.914 0.888 0.919 0.939 0.700 0.639 0.567
Zip-NeRF 0.769 0.642 0.860 0.800 0.681 0.925 0.902 0.928 0.949 0.733 0.626 0.545
Ref-NeRF* 0.723 0.592 0.845 0.731 0.634 0.914 0.875 0.922 0.935 0.722 0.612 0.542
Ours 0.747 0.605 0.836 0.749 0.653 0.911 0.887 0.924 0.945 0.739 0.641 0.597
LPIPS Mip-NeRF360OutdoorScenes Mip-NeRF360IndoorScenes Ref-NeRFRealScenes
bicycle flowers garden stump treehill room counter kitchen bonsai sedan toycar spheres
3DGS 0.205 0.336 0.103 0.210 0.317 0.220 0.204 0.129 0.205 0.301 0.237 0.248
UniSDF 0.243 0.320 0.136 0.242 0.265 0.206 0.206 0.124 0.184 0.309 0.245 0.243
Zip-NeRF 0.208 0.273 0.118 0.193 0.242 0.196 0.185 0.116 0.173 0.260 0.243 0.238
Ref-NeRF* 0.256 0.317 0.132 0.261 0.294 0.206 0.213 0.121 0.182 0.270 0.257 0.257
Ours 0.231 0.312 0.142 0.244 0.273 0.216 0.203 0.118 0.176 0.254 0.246 0.238
Table4. Acomparisonontherealcapturesfrommip-NeRF360[Barronetal.2022]andthethreeshinyrealcapturesfromRef-NeRF[Verbinetal.2022].The
‚ÄúRef-NeRF*‚ÄùbaselineisanimprovedversionofRef-NeRFthatusesZip-NeRF‚Äôsgeometrymodel,samplingandoptimizationprocedure,butwithRef-NeRF‚Äôs
appearancemodel.
PSNR BlenderScenes ShinyBlenderScenes
hotdog materials teapot toaster car ball coffee helmet mean
Ref-NeRF 37.72 35.41 47.90 25.70 30.82 47.46 34.21 29.68 35.96
ENVIDR ‚Äî 29.51 46.14 26.63 29.88 41.03 34.45 36.98 35.85
Zip-NeRF 37.16 31.64 45.66 24.84 27.60 25.30 31.05 27.50 30.33
UniSDF ‚Äî ‚Äî 48.76 26.18 29.86 44.10 33.17 38.84 36.82
Ours 38.61 32.02 49.98 26.19 30.45 45.46 33.18 39.10 37.39
SSIM BlenderScenes ShinyBlenderScenes
hotdog materials teapot toaster car ball coffee helmet mean
Ref-NeRF 0.984 0.983 0.998 0.922 0.955 0.995 0.974 0.958 0.967
ENVIDR ‚Äî 0.971 0.999 0.955 0.972 0.997 0.984 0.993 0.983
Zip-NeRF 0.984 0.969 0.997 0.920 0.934 0.928 0.967 0.950 0.949
UniSDF ‚Äî ‚Äî 0.998 0.945 0.954 0.993 0.973 0.990 0.976
Ours 0.988 0.975 0.999 0.950 0.964 0.994 0.973 0.988 0.977
LPIPS BlenderScenes ShinyBlenderScenes
hotdog materials teapot toaster car ball coffee helmet mean
Ref-NeRF 0.022 0.022 0.004 0.095 0.041 0.059 0.078 0.075 0.059
ENVIDR ‚Äî 0.026 0.003 0.097 0.031 0.020 0.044 0.022 0.036
Zip-NeRF 0.020 0.032 0.007 0.092 0.055 0.190 0.088 0.081 0.086
UniSDF ‚Äî ‚Äî 0.004 0.072 0.047 0.039 0.078 0.021 0.044
Ours 0.014 0.027 0.002 0.073 0.033 0.044 0.074 0.018 0.041
Table5. Theper-sceneandaveragemetricsoverthetwoscenesfromtheBlenderdataset[Mildenhalletal.2020]whichcontainstrongspeculareffects,and
thesixshinyscenesfromtheShinyBlenderdataset[Verbinetal.2022].TheaverageistakenonlyoverthesixShinyBlenderscenes.
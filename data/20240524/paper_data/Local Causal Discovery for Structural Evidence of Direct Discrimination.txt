Local Causal Discovery for
Structural Evidence of Direct Discrimination
JacquelineMaasch∗ KyraGan VioletChen
CornellTech CornellTech StevensInstituteofTechnology
AgniOrfanoudaki Nil-JanaAkpinar FeiWang
UniversityofOxford CarnegieMellonUniversity WeillCornellMedicine
Abstract
Fairnessisacriticalobjectiveinpolicydesignandalgorithmicdecision-making.
Identifyingthecausalpathwaysofunfairnessrequiresknowledgeoftheunderlying
structuralcausalmodel,whichmaybeincompleteorunavailable. Thislimitsthe
practicalityofcausalfairnessanalysisincomplexorlow-knowledgedomains. To
mitigatethispracticalitygap,weadvocatefordevelopingefficientcausaldiscovery
methodsforfairnessapplications. Tothisend,weintroducelocaldiscoveryfor
directdiscrimination(LD3): apolynomial-timealgorithmthatrecoversstructural
evidenceofdirectdiscrimination. LD3performsalinearnumberofconditional
independence tests with respect to variable set size. Moreover, we propose a
graphicalcriterionforidentifyingtheweightedcontrolleddirecteffect(CDE),a
qualitativemeasureofdirectdiscrimination. Weprovethatthiscriterionissatisfied
bytheknowledgereturnedbyLD3,increasingtheaccessibilityoftheweighted
CDEasacausalfairnessmeasure. Takinglivertransplantallocationasacasestudy,
wehighlightthepotentialimpactofLD3formodelingfairnessincomplexdecision
systems. Resultsonreal-worlddatademonstratemoreplausiblecausalrelations
thanbaselines,whichtook197×to5870×longertoexecute.
1 Introduction
Fairnessholdsfundamentalimportanceinpolicydesignandalgorithmicdecision-making,especially
inhigh-stakesdomainssuchashealthcare,insurance,andpolicing[85,19]. Variouscriteriahave
beenproposedtomeasureunfairnesswithrespecttoprotectedorsensitiveattributes,suchasgender
andethnicity[93]. Legaldoctrinesgenerallydifferentiatebetweendirectdiscriminationandindirect
or spurious forms of unfairness, codifying the notion that the mechanism of unfairness matters
[6, 13]. However, fairness criteria based solely on statistical associations cannot disentangle the
direct,indirect,andspuriousmechanismsofunfairness[39,50,69],limitingtheirinformativeness
andactionabilityfromapolicyinterventionstandpoint. Consequently,thereisagrowingemphasis
onapplyingcausalreasoningtoquestionsoffairness[39],shiftingthefocusfromassociationsto
interventionsandcounterfactualoutcomes[5].
Causal fairness analysis provides a theoretical framework for disentangling the mechanisms of
unfairness using the language of structural causal models (SCMs) [69]. The decomposition of
observedparitygapsintodirect,indirect,andspuriouseffectsisacenteralobjective[67]. Asaresult,
causalfairnessanalysiscanbeframedasaspecialcaseofmediationanalysis[90].Whenthecomplete
groundtruthSCMisknown,thevariouspathwaysofunfairnesscanbereaddirectlyfromstructural
equationsortheunderlyingcausalgraph(TableA.1). Withthisstructuralknowledgeinhand,points
ofpotentialinterventionaremadeclearandcausalmeasuresofunfairnessareidentifiable.
∗Correspondingauthor:maasch@cs.cornell.edu.
Preprint.Underreview.
4202
yaM
32
]LM.tats[
1v84841.5042:viXraC C C C
X Y X Y X Y X Y
M M M M
STANDARD DIRECT INDIRECT SPURIOUS
FAIRNESSMODEL MECHANISM MECHANISM MECHANISM
Figure1: TheStandardFairnessModel(SFM)isalocalsubgrapharoundaprotectedattributeX
andoutcomeY (Definition2.2)[69]. Variablesthatareirrelevanttofairnessanalysisareabstracted
away,leavingonlythesetofmediators(M)andthesetofconfounders(C). Causalfairnessanalysis
revealswhetherthedottedpathsexist. Direct,indirect,andspuriouspathwaysareinsolidred.
Previous works on effect estimation in causal fairness [98, 67, 69, 68] and mediation analysis
[59, 89, 82, 62] generally assume prior knowledge of the true causal graph. In practice, prior
structuralknowledgeisoftenincomplete,absent,orcontentiousforcomplexdomains,evenamong
experts[65]. Evenwithpriorknowledge,mediationanalysisischallengingterritory. Identifiabilityin
causalmediationhasbeenthesubjectofcomplicateddiscussionanddebateamongtheoreticians[62],
raisingbarrierstoentryforappliedresearchers[89]. Consequently,causalfairnessanalysisisnot
easilyappliedtosystemswithcomplexcausalmodels,posingagapbetweentheoryandpractice.
WhenthetrueSCMisunknown,theunderlyingstructurecanbelearnedfromobservationaldata
throughcausaldiscovery[83,26]. Globaldiscoveryrecoversthefullcausalgraphoritsequivalence
class(e.g.,[84,16,80,64,102]),providingmechanisticinsightsinthenaturalandsocialsciences[73,
46]. However,globaldiscoverycanposemodelingchallenges,includingthecurseofdimensionality
[100],highsamplecomplexity[84,71,42],andexponentialtimecomplexityinunconstrainedsearch
spaces[84,16–18]. Reliabilityisalsoanopenproblem,asglobalmethodscansometimesdisagree
withexpert-definedDAGsincomplexdomains[79,65]. Inthefairnesssetting,comparisonsacross
global discovery methods can yield conflicting fairness conclusions [7]. Additionally, given an
outcomeofinterest,globaldiscoveryisweigheddownbyasortofwastefulness: therelationsamong
allobservedvariablesarelearned,whetherornottheyarecausallyrelevanttotheoutcome[12].
Localcausaldiscovery[25,21]aimstomitigatetheseinefficienciesbyonlylearningthesubstructures
relevantforspecifictargetvariablesordownstreamtasks,suchascausaleffectestimation[77,14,31,
48,78]orfeatureselection[95,96]. AstheStandardFairnessModel(SFM;Figure1)isitselfalocal
subgraphnucleatedaroundanattributeandoutcomeofinterest[69],localcausaldiscoveryoffersa
naturalframeworkforcausalfairnessanalysis. However,task-specificlocaldiscoveryalgorithmsare
definitionallyone-size-does-not-fit-all. Thus,existingmethodsmaynotbeoptimalforfairnesstasks,
particularlywithrespecttotimeefficiencyinthenonparametricsetting.
Contributions Toourknowledge,thisworkpresentsthefirstlocalcausaldiscoverymethodspecifi-
callytailoredforcausalfairnessanalysis. Weexplicitlyaddressthepracticalitygapinapplyingcausal
fairnesstheorytocomplexreal-worlddomainswithunknownSCMs,whileensuringimplementability
andstate-of-the-artcomputationalefficiency.
1. Weintroducelocaldiscoveryfordirectdiscrimination(LD3),2atimeefficientlocalcausal
discoveryalgorithmthatassessesthestructuraldirectcriterion(SDC)fordirectdiscrimina-
tiondetection[69]. LD3performsalinearnumberofindependencetestswithrespectto
variablesetsize,withasymptoticguaranteesoncorrectnessundersufficientassumptions.
2. We define a graphical criterion that is sufficient for identifying the weighted controlled
directeffect(CDE)[59,62],aqualitativeindicatorofdirectdiscrimination[98]. Weprove
thatthiscriterionissatisfiedbythestructuralknowledgereturnedbyLD3,enhancingthe
accessibilityofthiscausalfairnessmeasure.
3. Asareal-worldcasestudyofcausalfairnessanalysisforcomplexdomains,weuseLD3
torecoverevidenceofdirectsex-baseddiscriminationinlivertransplantallocationinthe
2CodeisavailableonGitHub:https://anonymous.4open.science/r/LD3-4440
2UnitedStates. LD3recoveredmoreplausiblecausalrelationsthanlocalandglobalbaselines
[38,31],whichperformed42to1021×moretestsandtook197to5870×longertorun.
PaperStructure Section2definesessentialconceptsincausalfairnessanalysisanddirecteffect
estimation. InSection3,weintroduceLD3anddescribeourtheoreticalandmethodologicalcon-
tributions. Section4contextualizesourcontributionsinthebroaderliterature. Section5presents
numericalvalidation,andSection6highlightsareal-worldcasestudyonlivertransplantallocation.
2 Preliminaries
Let univariate random variables be denoted by capital letters (e.g., X), with specific values in
lowercase(e.g.,X =x). Multivariaterandomvariablesorsetsaredenotedbyboldfacecapitalletters
(e.g.,X),withvectorvaluesinboldlowercase(e.g.,X=x). Graphsorfunctionsetsaredenotedby
calligraphicletters(e.g.,F). Letpa(·),an(·),ch(·),andde(·)denotetheparent,ancestor,child,and
descendantsetsforavariableincausalgraphG,respectively.
2.1 CausalFairnessAnalysis
CausalfairnessanalysiscanbeframedinthelanguageofSCMs[69]. ThoughthetheoryofSCMs
andthepotentialoutcomesframeworkarelogicallyequivalent[24,33,8],thegraphicalintuition
suppliedbySCMsisparticularlysuitedforcausalfairnessanalysis.
Definition2.1(Structuralcausalmodel(SCM),Pearl[59]). ASCMisa4-tuple⟨V,U,F,P(u)⟩
whereU={U }n denotesasetofexogenousvariablesdeterminedbyfactorsoutsideofthemodel,
i i=1
V = {V }n denotesasetofobservedendogenousvariablesthataredeterminedbyvariablesin
i i=1
U∪V,F ={f }n denotesasetofstructuralfunctionssuchthatV =f (pa(V ),U ),andP(u)
i i=1 i i i i
isadistributionovertheexogenousvariablesU.
EverySCMcorrespondstoacausalgraphicalmodel. Tofacilitatecausalfairnessanalysis,thetrue
causalgraphforanSCMcanbeprojectedontotheSFM(Figure1).
Definition2.2(StandardFairnessModel(SFM),Plecˇko&Bareinboim[69]). LetG =(V,E)be
acausalgraphwithverticesVandedgesE. LetG betheprojectionofG ontotheSFM.This
SFM
projectionisobtainedbyselectingaprotectedattribute-outcomepair{X,Y}⊂Vandidentifying
setsM,C⊆V\{X,Y}thatsatisfyaspecificsetofrelationswithrespectto{X,Y}. Thus,G
SFM
isthegraphinducedby{X,Y,M,C}⊆Vthatencodesthefollowingassumptions:
• X isaprotectedattributeandY isanoutcomeofinterest.
• MisasetofmediatorswithrespecttoX andY.
• CisasetofconfounderswithrespecttoX andY,whichmaysharealatentconfounder
withX (perthebidirectededgeinFigure1).
NotethatCandMcanbeofarbitrarydimensionality,includingzero. Probingwhethertheredpaths
inFigure1existandestimatingtheassociatedeffectsizesarecentraltasksincausalfairnessanalysis.
StructuralFairnessCriteria Multiplecriteriahavebeenproposedforevaluatingfairnessfrom
graphicalstructures[69]. Forthepurposesofthiswork,wearefundamentallyinterestedindetecting
graphicalsignaturesofdirectdiscrimination. WesaythatanSCMisfairorunfairwithrespectto
directdiscriminationwhenthefollowingstructuralconditionshold.
Definition2.3(Structuraldirectcriterion(SDC),Plecˇko&Bareinboim[69]). AnSCMisfairin
termsofdirectdiscriminationifandonlyiftheprotectedattributeisnotaparentoftheoutcome.
(cid:26)
1 ifX isaparentofY,
SDC =1(X ∈pa(Y))= (1)
0 ifX isnotaparentofY.
2.2 ControlledDirectEffect(CDE)
TheCDEisavalidtestforidentifyingdirectdiscrimination,asthetruevalueisnon-zeroifandonlyif
thereisadirectpathfromtheprotectedattributetotheoutcome[98]. LetX =xandX =x∗bethe
exposurevaluecorrespondingtotreatmentandnotreatment(i.e.,thereferencevalue),respectively.
3Definition2.4(Controlleddirecteffect(CDE),Vanderweele[89]). TheCDEmeasurestheexpected
changeinoutcomeastheexposurechangesgivencovariatesS,wheremediatorsMareuniformly
fixedtoaconstantvaluemoverthepopulation(assimulatedbyconditioningonM[61]).
CDE(m):=E[Y −Y
]=(cid:88)(cid:2)E[Y|x,s,m]−E[Y|x∗,s,m](cid:3)
P(s). (2)
x,m x∗,m
s
Definition2.5(IdentifiabilityconditionsoftheCDE,Vanderweele[89]). TheCDEisidentifiable
fromobservationaldatawhen,givencovariatesS,thefollowingholdsforallvaluesX =x,M=m:
1. ThereisnolatentconfoundingoftheexposureandoutcomegivencovariatesS,i.e.,Y ⊥⊥X|S.
x,m
2. Thereisnolatentconfoundingofthemediatorsandoutcomegiven{X,S},i.e.,Y ⊥⊥M|X,S.
x,m
Unlikethenaturaldirecteffect,CDEidentificationdoesnotforbidtheexistenceofconfoundersfor
{M,Y}thataredescendedfromX (AppendixCinPearl[62]). Thereexistpathologicalexamples
whereadjustmentforsuchconfoundersinducesbias,butunbiasedCDEestimatescanstillbeobtained
forsuchadjustmentsetswhengiventheappropriateestimator[66,62,35](seeAppendixB).
Wheninteractionbetweenthemediatorandexposureispresent,theCDEdoesnotdisplayeffect
constancy: theCDEwillbenon-unique,takingonasmanyvaluesastherearelevelsofM. Effect
constancyisguaranteedfortheCDEinlinearsystems,butnotinnonlinearsystems[62]. Forthe
nonparametricsetting,weavoidassumptionsabouttheabsenceofinteractionyetstillwishtoobtain
auniqueCDE.Thus,wedefinetheweightedCDEasthefollowingexpectationoverM.
Definition2.6(TheweightedCDEoverM). ForallvaluesofcovariatesSandmediatorsM,
WCDE
:=(cid:88)(cid:88)(cid:2)(cid:2)E[Y|x,s,m]−E[Y|x∗,s,m](cid:3) P(s)(cid:3)
P(m). (3)
m s
AstheweightedCDEisaweightedsumoverelementsthatarewell-definedundertheidentifiability
conditionsinDefinition2.5,theweightedCDEisidentifiableunderDefinition2.5aswell.
AsaFairnessMetric Asshownin[98],ifX hasnodirectpathtoY thenCDE(m)=0. Thus,
CDE(m) ̸= 0qualitativelyimpliesdirectdiscrimination. AstheweightedCDEisasum,itcan
equalzerowhenallelementsarezeroorwhennon-zeroelementssumtozero. However,itcanonly
benon-zeroifatleastoneCDE(m)̸=0. Thus,weencouragecautionininterpretingzerovalues.
Selecting Mediators and Confounders for Weighted CDE Estimation As shown in Pearl
[59], thesubsetofmediatorsthatareparentsofY issufficientforCDEidentification. Similarly,
itissufficienttocontrolonlyforconfoundersthatareadjacenttoX orY, asallbackdoorpaths
definitionallyenterintoX andY. Inthiswork,weoptforidentifyingconfoundersthatareparents
ofY. Notethatdirecteffectsareidentifiablewhentheexactcausalrelationsamongtheselected
confoundersandmediatorsarenotknown[82],whichissupportiveofourlocaldiscoveryapproach.
Definition2.7(ValidadjustmentfortheweightedCDE). AvalidadjustmentsetforweightedCDE
estimation blocks (1) all backdoor paths for {X,Y}, (2) all backdoor paths for {M,Y}, and (3)
allmediatorpathsfor{X,Y}. Thisblocksnon-causalassociationthroughconfoundingpathsand
indirectcausalassociationthroughmediatorpaths,isolatingthedirectcausaleffect.
2.3 MappingCausalPartitionstotheStandardFairnessModel
Tofacilitateefficientstructurelearning,we Exhaustive,DisjointCausalPartitionsw.r.t. {X,Y}
leveragethecausalpartitiontaxonomyde-
finedin[48](Table1). Givenanexposure-
Z1 Confoundersandtheirproxies.
Z2 Collidersandtheirproxies.
outcome pair {X,Y}, any arbitrary vari- Z3 Mediatorsandtheirproxies.
ablesetZcanbeuniquelypartitionedinto Z4 Non-descendantsofY whereZ4⊥⊥XandZ4⊥̸⊥X|Y.
exactlyeightdisjointsubsets(whichmay
Z5 Instrumentsandtheirproxies.
Z6 DescendantsofY.ActivepathswithXarefullymediatedbyY.
beempty)thataredefinedbythetypesof Z7 DescendantsofX.ActivepathswithY arefullymediatedbyX.
causalpathsthattheysharewithXandY.3 Z8 NodesthatsharenoactivepathswithXnorY.
Narrowingthefocusofstructurelearning Table1: AtruepartitioningexistsforanyZ(from[48]).
3See[48]forformaldefinitionsofthesepartitionsandtheirproxies.Notethatthenotionofproxyvariables
isnotrelevantinthissetting,asweareonlyconcernedwithtrueconfoundersandmediators.
4Algorithm1LD3: Learningstructuralevidenceofdirectdiscriminationfromobservationaldata.
Input: ExposureX,outcomeY,variablesetZ,independencetest,significancelevelα.
Output: AdjustmentsetA :=Z ∪Z ∪Z andSDCresults.
DE 1∈pa(Y) 3∈pa(Y) 4∈pa(Y)
Assumptions: (A1)Y hasnoobserveddescendantsand(A2)allparentsofY areobserved.
1: Z′ ←Z
2: for∀Z ∈Z′do
3: ifZ ⊥⊥X∧Z ⊥⊥Y thenZ ∈Z 8
4: ifZ⊥̸⊥Y ∧Z ⊥⊥Y|X thenZ ∈Z 5,7
5: ifZ ⊥⊥X∧Z⊥̸⊥X|Y thenZ ∈Z 4
6: Z′ ←Z′\Z 8∪Z 7∪Z 4
7: for∀Z ∈Z′do
8: ifZ⊥̸⊥Y|X∪Z 4∪{Z′\Z}thenZ ∈Z 1∈pa(Y)∪Z
3∈pa(Y)
9: for∀Z 4 ∈Z 4do
10: ifZ 4⊥̸⊥Y|X∪Z 1∈pa(Y)∪Z 3∈pa(Y)∪{Z 4\Z 4}thenZ 4 ∈Z 4∈pa(Y)
11: A ←Z ∪Z ∪Z
DE 1∈pa(Y) 3∈pa(Y) 4∈pa(Y)
12: ifX ⊥⊥Y|Z ∪Z thenSDC ←0
1∈pa(Y) 3∈pa(Y)
13: elseSDC ←1
14: return A ,SDC
DE
totherelationshipsthatarecausallyrelevanttotheexposureandoutcome[12],thispartitiontaxon-
omyprovidesconvenientbuildingblocksforlocaldiscovery. Mappingthispartitiontaxonomytothe
SFM,Z isasupersetofconfoundersCandZ isasupersetofmediatorsM.
1 3
3 LocalDiscoveryforDirectDiscrimination(LD3) Z Z
1 4
Algorithm 1 provides a constraint-based discovery procedure for
assessingtheSDCandlearningavalidadjustmentsetforweighted X Y
CDEestimationfromobservationaldata. Thenumberofindepen-
dence tests performed scales linearly with the number of nodes.
ProofsofcorrectnessaregiveninAppendixC. Z
3
SufficientConditionsforStructureLearning Weassumecausal Figure2: Thelocalsubgraph
Markov,faithfulness,andacyclicity. Wedonotimposeparametric identifiedbyLD3.Here,mem-
assumptions on causal functions nor distributional forms. As for bers of Z 1, Z 3, and Z 4 are
all constraint-based methods, the independence test selected may parentsofY. Arrows sig-
imposeitsownparametricassumptions. Whenthesearenotwell- nifyadjacencyand signify
justified,werecommendnonparametrictests(e.g.,[28,29,99,71]). pathswitharbitrarilymanyin-
terveningvariables. TheSDC
Asymptoticguaranteesonpartitionlabelcorrectness,SDCcorrect-
indicates whether the dotted
ness,andvalidadjustmentforunbiasedweightedCDEestimation
edgefromX toY exists.
holdunderAssumptions(A1)and(A2).
(A1) Y hasnodescendantsintheobservedvariableset. Thisassumptionisrelativelystraightfor-
wardtojustifyinsettingswhereY isaterminalvariablewithrespecttotemporalordering
(e.g.,whentheoutcomeisdeath,oradecisionmadeataknowntimepoint).
(A2) AllparentsofY areobserved. LatentvariablesthatarenotparentsofY arepermissible.
Remark 3.1 (Notes on (A2)). This assumption is a consequence of the sufficient conditions for
identifiabilityoftheCDE(Definition2.5)[59,62]. Weexploit(A2)inourapproachtoevaluatingthe
SDC[69],asitensuresthatX isconditionallyd-separatedfromY whenthereisnodirectpathfrom
X toY. ItalsoensuresthatnocollidersinZ areretainedforadjustment. Ifsomeparentsof
2∈/de(Y)
Y areunobserved,theSDCmightreturnavalueof1andtheweightedCDEmightbenon-zeroeven
ifthereisnodirectdiscriminationpresent.
WeproveinAppendixCthatlatentvariablesnotadjacenttoY havenoimpactoncorrectness.
Theorem3.2. LatentvariablesthatarenotparentsofY donotaffectAlgorithm1.
5CausalPartitionsinthisSetting Given(A1),therearenodescendantsofY inG. Thus,there
arenoZ norZ . However,theremaybeZ . Thus,G cancontainthefollowingseven
6 2∈de(Y) 2∈/de(Y)
(potentiallyempty)causalpartitionswithrespectto{X,Y}: Z ,Z ,Z ,Z ,Z ,Z ,andZ .
1 2∈/de(Y) 3 4 5 7 8
LD3returnsthesubgraphpicturedinFigure2: allZ ,Z ,andZ thataredirectlyadjacenttoY.
1 3 4
3.1 AGraphicalCriterionforIdentifyingtheWeightedCDE
Definition3.3(GraphicalcriterionforidentifyingtheweightedCDE). WedefinethesetA ,which
DE
containsallparentsoftheoutcome. Underthecausalpartitiontaxonomydefinedin[48],
A :=Z ∪Z ∪Z . (4)
DE 1∈pa(Y) 3∈pa(Y) 4∈pa(Y)
Theorem3.4(A isavalidadjustmentsetfortheweightedCDE). TheadjustmentsetA satisfies
DE DE
theidentificationconditionsfortheweightedCDE(Definition2.5)byblocking(1)allbackdoorpaths
for{X,Y},(2)allbackdoorpathsfor{M,Y},and(3)allfrontdoorpathsfor{X,Y}.
Intuition. A containsonlyandexactlyalltheparentsofY: confoundersfor{X,Y}thatare
DE
adjacenttoY (Z ),mediatorsfor{X,Y}thatareadjacenttoY (Z ),andallparentsof
1∈pa(Y) 3∈pa(Y)
Y thataremarginallyindependentofX (Z ). Thus,atleastonememberofeverybackdoor
4∈pa(Y)
andfrontdoorpathisinA . Thisprovidesconditionald-separationofX andY ifandonlyifthere
DE
isnoedgeX →Y. FullproofsareprovidedinAppendixC.
Remark 3.5 (The role of Z ). Note that Z and Y can be confounded by Z , Z , or Z .
4∈pa(Y) 3 1 3 4
IncludingZ inA helpsguaranteeidentifiabilityoftheweightedCDEwithoutrequiring
4∈pa(Y) DE
exactknowledgeofconfoundingforZ andY. AsZ isnotpost-treatment,itisnotforbiddenfrom
3 4
adjustmentunderthebackdoorcriterion[58]. IthasbeenshownthatadjustingforZ canreduce
4
estimatevarianceinpropensityscoremodels[11],andconventionalintuitiondictatesthatadjustment
shouldminimallyconstraintheexposureandmaximallyconstraintheoutcome[72]. Thus,theremay
bestatisticalbenefitstoincludingZ ,thoughwedonotformallyexplorethishere.
4∈pa(Y)
4 RelatedWorks
Fewworksincausaldiscoveryhavecenteredonfairnessobjectives[9,7]. Toourknowledge,this
workpresentsthefirstlocalcausaldiscoverymethodthatisspecificallytailoredforcausalfairness
analysis. Below,wesummarizetwolinesofliteraturecloselyconnectedtothiswork.
EstimatingDirectCausalEffects Multipleestimandshavebeenproposedfordirecteffectestima-
tion,includingtheCDE[59],theNDE[59],andthecounterfactualdirecteffect(Ctf-DE)[98]. The
CDEisaninterventionalquantity,whiletheNDEandCtf-DEarecounterfactualquantities[62,98].
TheNDEispopularincausalfairnessanalysis[69]asitisguaranteedtoadmitavaliddecomposition
ofthetotalcausaleffectintodirectandindirecteffectsinthenonparametricsetting[59]. However,
whendirectdiscriminationisthequantityofinterest,theCDEisavalidmeasure[98]. Previously,
the CDE has garnered more use in policy evaluation than the NDE [89]. In this work, we favor
theweightedCDEasadirectdiscriminationmetricincomplexdomainsbecauseitrequiresfewer
untestableassumptionsoverthedatageneratingprocess[82]andlesspriorstructuralknowledge
thantheNDE[59,89]. Thispermitsunbiasedestimationinawiderrangeofstructures,andalower
burdenofcausaldiscovery. WeprovideanextendedjustificationinAppendixB.
Graphical Criteria for Direct Effect Identification Sufficient and necessary conditions for
unbiasedidentificationvarybyestimand,butgenerallyrequirecovariateadjustment[91]. Formal
graphicalrulescanallowthevalidadjustmentsettobereaddirectlyfromknowncausalstructures,
eveninthepresenceoflatentconfounding[63,49,72]. Graphicalcriteriaforvalidadjustmenthave
beenproposedfordiversecausalquantities,mostfamouslythebackdoorcriterionfortotaleffect
estimation [58]. Often, multiple valid criteria exist per estimand. These can vary in the amount
ofpriorstructuralknowledgethattheyrequire,andcriteriathatrequirelessknowledgeareeasier
to implement in practice [92, 30]. Shpitser & Pearl [81] present a complete graphical criterion
forconditionalinterventionaldistributions. Pearl[59]definesagraphicalcriterionforidentifying
the NDE from observational data (Corollary 1). Discussion, debate, and confusion around the
sufficientandnecessaryconditionsforNDEidentificationhaveinspiredaflurryofpapers[37,36],
assummarizedinPearl[62]. Shpitser&VanderWeele[82]presentacompletegraphicalcriterionfor
theNDEthatreconcilessomedebate,showingwherecertaincommoncriteriacoincide.
6Figure3: MeanruntimefortheASIAandSACHSbenchmarksfrombnlearn(χ2tests;α=0.001;
95%confidenceintervalsinshadedregions). ForASIA(EITHER→DYSP),|Z|=6and|A DE|=1.
For SACHS (ERK → AKT),|Z| = 11and|A DE| = 1. SeeFigureE.2fortotalindependencetests
performed. RawdataarereportedinTablesE.2andE.4.
Graphicalcriteriafordirecteffectestimationareoftenchallengingforpractitionerstoimplement
[82]. Toincreasethepracticalityofcovariateadjustmentincomplexandlow-knowledgedomains,
weadvocateforthedevelopmentofgraphicalcriteriathatare(1)relativelyintuitiveandpracticalto
implementinappliedresearch,and(2)aresatisfiedbyknowledgethatcanbereliablylearnedthrough
data-drivenmethods. Thus,weapplythecausalpartitiontaxonomyof[48]toprovidelocalgraphical
intuitionforfastandpracticaladjustmentsetdiscovery.
5 EmpiricalValidation
Baselines We compare LD3 against global and local discovery baselines, with two evaluation
methodsperalgorithm(onewithpost-processingadaptedforthissettingandonewithout,asdescribed
inAppendixD):PC(PC andPC )[38],4 LDP(LDPandLDP )[48],andLDECC(LDECC
∩ ∪ pa ∩
andLDECC )[31]. PCisapopularglobaldiscoverymethodthathasspawnedmanyextensions.
∪
LDPisasymptoticallyguaranteedtoreturnavalidadjustmentsetfortotaleffectestimationunder
thebackdoorcriterion[48]. LDECCreturnstheparentsandchildrenofatargetvariable[31]. All
baselinesareconstraint-basedtofacilitatedirectcomparisonsonthenumberofindependencetests
performedandevaluationwithanoracle. Throughout,ndenotesdatasamplesize(abbreviatedwith
k =1000). AllexperimentswereperformedonalocalMacBookPro(M2ProChip;16GBmemory).
AdjustmentSetCorrectness AscorrectassessmentoftheSDCandunbiasedestimationofthe
weightedCDErequirethatallparentsoftheoutcomearecorrectlyidentified,weevaluatedtheability
ofLD3torecoverthetrueparentsetinrandomlygeneratedDAGs. Usinganoracleindependencetest
tosimulateaccesstoinfinitedata,weempiricallyvalidatedLD3ontheadjacencymatricsofrandom
directedacyclicErdo˝s-Rényigraphs[23].5 LD3perfectlyrecoveredparentsetsforrandomlyselected
exposure-outcomepairsin90uniquegraphs. TengraphsweregeneratedperDAGsize,withnode
countsin[5,10,20,30,40,50,100,200,500]. ParentF1,recall,andprecisionwere100%. Runtimes
andtotalindependencetestsasnodeandedgecardinalityscaleareshowninFigureE.1.
Next, we assesed DAGs from the bnlearn Bayesian Network Repository [76]. Results for the
ASIA(LungCancer)dataset[45]arereportedinTablesE.1andE.2. ResultsfortheSACHSprotein
expressiondataset[74]arereportedinTablesE.3andE.4. Foreachbenchmark,weselectedone
exposure-outcomepairforwhichSDC=1andSDC=0. ForASIA,LD3andLDP pahadthehighest
F1scoresforbothexposure-outcomepairs,with100%F1whenSDC=1startingatn=2.5k(Table
E.1). For SDC = 0, LD3 improved with increasing sample size, while other methods decreased
or peaked.6 Notably, neither PC nor PC identified a single causal parent of the outcome. For
∪ ∩
SACHS,onlyLDECC
∪
attained100%F1forbothpairsacrossallsamplesizes,thoughLD3and
LDP were closely behind and still provided valid adjustment sets for the weighted CDE in all
pa
settings(TableE.3). TheprimarybenefitsofLD3wereefficiencyandlaxassumptions:thenumberof
independencetestsperformedbyLDECCandPCisworst-caseexponentialwithrespecttovariable
setsizeforrandomstructures,LDPisworst-casequadratic,andLDPonlyguaranteescorrectness
4https://github.com/keiichishima/pcalg
5https://r.igraph.org/
6SeeTableE.1forelaboration.
7underthesufficientconditionthatatleastonememberofZ andZ areobserved. Efficiencypitfalls
4 5
forbaselinesareemphasizedinFigureE.1andTablesE.2andE.4.
WeightedCDEEstimation ToevaluatetheabilityofLD3toaccuratelyassesstheSDCandenable
weighted CDE estimation, we tested linear-Gaussian instantiations of an 18-node DAG with an
M-structure(i.e.,amemberofZ )[22],amediatorchain,andamemberofZ thatconfounds
2∈/de(Y) 4
amediatorandY (FigureD.1). TheweightedCDEwasestimatedusinglinearregression. A F1,
DE
precision,andrecallandSDCaccuracyconvergedtoward100%assamplesizeincreased,withthe
weightedCDEconvergingtowardthetruedirecteffectwithlowvariance(FiguresE.3,E.4).
6 Real-WorldCaseStudy: FairnessinLiverTransplantAllocation
Weapplyourproposedalgorithmtoareal-worldcasestudyinhealthcareandcompareitsfindings
withpaststudiestoillustratethevaluethatLD3canbringinpractice.
AllocationUnderScarcity Livertransplantationisacriticaltherapeuticoptionforpatientswithend-
stagechronicliverdiseaseandacuteliverfailure. IntheUS,demandforlivertransplantssignificantly
surpassesthesupplyofavailabledonorlivers[55]. Patientswhorequirealivertransplantareplaced
on a national waiting list managed by the United Network for Organ Sharing (UNOS).7 Upon
availabilityofadonorliver,thedistributionpolicysortswaitlistedpatientsbymultipleprioritization
criteria,suchasmedicalurgency,compatibility,andlocation,whilebalancingcompetingobjectives
suchasperceivedpolicyfairness[43]. TheUSlivertransplantsystemhasseenseveralkeypolicy
changesdesignedtooptimizedistributionandimprovepatientoutcomes[57](seeAppendixF).The
modelforend-stageliverdisease(MELD)isonefacetofthispolicy,usedtodetermineprioritybased
onillnessseverity[51]. Despiteeffortstoimprovefairallocation[40],itiswidelyrecognizedthat
USorganallocationsuffersfromdisparitiesonthebasisofrace,sex,andsocioeconomicstatus[101].
Whileathoroughassessmentofunfairnessinlivertransplantationisoutofscope,wetakesex-based
disparitiesasacasestudy. Overtime,womenhavebeenlesslikelythanmentoreceiveatransplant
[52,27,75,1].Womenarelessrepresentedonlivertransplantwaitlistsprimarilyduetolowerchronic
liverdiseaserates[75,56]. Heightdifferences,MELDexceptionpoints,andunderestimatedMELD
scoreshavebeenraisedaspotentialexplanationsforsex-baseddisparities[1]. Priorinvestigations
measurethesedisparitiesviastatisticalassociation[53],whichcannotdisentanglecausalmechanisms
[39]. Tothebestofourknowledge,therehavebeenlimitedresultsonsex-baseddisparitiesusingUS
nationaldatacollectedafterMarch2018[20]. Toaddressthelackofcausalanalysis,weapplyLD3
torecoverstructuralevidenceofdirectsex-baseddiscriminationintransplantallocation.
Detecting Discrimination We utilize the National Standard Transplant Analysis and Research
(STAR)dataset[70]containingpatient-levelinformationonwaitlistedtransplantcandidates,recipi-
ents,anddonorsfromtheOrganProcurement&TransplantationNetwork(OPTN)uptoOctober
2022. Wefiltertoincludeadultpatientsawaitingorhavingundergoneawholelivertransplantfrom
deceaseddonorsin2017-2019and2020-2022,keepingfeaturesrelevantfordiscriminationdiscovery
(AppendixF).TimeframeswereselectedasstableperiodswithoutchangesintheUNOSallocation
policy. Estimation was performed with double machine learning [15].8 Under all experimental
settingsandtimeframes,resultsfromLD3suggestthattheeffectsofsexonreceivingaliverare
notfullyexplainedbyobservedconfoundingandmediation(Table2). Giventheobservedvariables,
causalevidenceofdirectdiscriminationisdetected(SDC=1)andcorroboratedbynon-zeroweighted
CDEestimateswithsignificantp-values. Inallsettings,A containskeyfactorsusedintheliver
DE
distributionpolicy,includinginitialMELD,initialage,region,andactiveexceptioncase[70]. Con-
sistentresultsvalidatethereliabilityofLD3inthiscomplexdomain. Ourresultsareconcordant
withpriorobservationsthatdifferencesinbodysizeandmedicalconditioncontributetosex-based
disparities[54],asweightanddiagnosisareinA inallsettings. Wealsohighlightthatpredicted
DE
A indicate potential discrimination with respect to ethnicity, education, and payment method.
DE
7https://unos.org/
8Doublemachinelearningwasimplementedwitheconml(https://econml.azurewebsites.net)usingrandom
forestclassifierswitha70%/30%train-testsplit(https://scikit-learn.org).Weassumedthatnoconfoundersfor
{M,Y}thataredescendedfromtheexposureopenbackdoorpathswhenconditionedon[66,62,35].
8UNOSPOLICY(2017–2019) UNOSPOLICY(2020–2022)
LD3(α=0.01) LD3(α=0.05) LD3(α=0.01) LD3(α=0.05)
A DE active exception case, di- active exception case, di- active exception case, di- active exception case, di-
agnosis, education, ethnic- agnosis, education, ethnic- agnosis, education, ethnic- agnosis, education, ethnic-
ity, exception type, initial ity, exception type, initial ity, initial MELD, initial ity, initial MELD, initial
MELD,initialage,region, MELD,initialage,recipient age, payment method, re- age, payment method, re-
weight bloodtype,region,weight gion,weight gion,weight
SDC 1 1 1 1
WCDE 0.033[0.016,0.049] 0.025[0.008,0.042] 0.032[0.018,0.047] 0.032[0.018,0.047]
p-value 0.000 0.003 0.000 0.000
Table2: Resultsobtainedwithnonparametricχ2 independencetestsanddoublemachinelearning.
Total features is 18 (Appendix F). For time period 2017-2019, total observations is n = 21101
patients. Fortimeperiod2020-2022,totalobservationsisn = 22807patients. Withnocovariate
control,SDC=1andtheweightedCDEis0.049[0.033,0.066](p-value=0.000).
Thesesocioeconomicfactorsmaywarrantfurtherinvestigationforfuturepolicyinterventions. These
preliminaryresultsareonlyqualitativeindicatorsthatfurtherfairnessanalysesshouldtakeplace.
SDCandweightedCDEresultsforPC [38]andLDECC [31]arereportedinTablesE.5andE.6.
∪ ∪
PCandLDECCqualitativelyagreewithLD3onbothdiscriminationmetrics,thoughattimeswith
higherweightedCDEvalues. However,PC,LDECC,andLD3hadrelativelylowagreementinterms
ofA . AdjustmentsetcardinalitywaslowerforPCandLDECC,andwaszeroforPCin2017-2019
DE
(α = 0.05) and one forLDECC thesame period(α = 0.01). Most settingsfor PCand LDECC
returnedadjustmentsetsthatomittedkeyexpectedvariables, suchasknownpolicycriteria(e.g.,
initialMELDscore,activeexceptioncase,andinitialage). PCresultsforbothsignificancelevels
showmultipleuntrustworthydirectededges(e.g.,weight→sex,height→sex,bloodtype→age,
education→height,bodymassindex→height),underminingthecredibilityofresults. Likewise,
LDECCpredictsthattheoutcomehaschildren,whichisknowntobeuntrue.
Efficiency Gains with LD3 Discovery with sequential independence tests is infamously slow.
Relative to LD3, vanilla PC performed 479–1021× more tests and took 2295–5870× longer to
executeonanAppleM2ProChip(TableE.7). LDECCperformed42–984×moretestsandtook
197–5774× longer to run. Speedups of this magnitude will be impactful for researchers who
requirerelativelyslownonparametrictestswithlargesamplesizes(e.g.,[28,29,99,71])andfor
high-dimensionalfeaturespaces,especiallywhenaccesstocomputeislimited. Speedupsreported
throughoutthisworkmeetorexceedthosereportedinlimitedworkonhardwareaccelerationfor
embarrassinglyparallelconstraint-baseddiscovery,comparingsingle-threadedCPUs,multi-threaded
CPUs,andGPUs[97,32,10]. Fornonparametricdiscoverytoincreaseitsreal-worldimpact,itwill
needtoefficientlyhandleincreasinglylargedatawithinreasonableacademiccomputelimits.
7 Conclusion
Thisworkadvocatesforincreasedpracticalityincausalfairnesspipelines,withamindtocomputa-
tionalefficiencyandimplementability. Weproposeatime-efficientandasymptoticallycorrectlocal
discoverymethodforidentifyingtwoqualitativemeasuresofdirectdiscrimination: thestructural
directcriterionandtheweightedCDE.Thenumberofindependencetestsperformedisworst-case
linearinthenumberofnodes,whilecomparablebaselinesareworst-casequadraticandexponential.
Weillustratetheutilityofourapproachonareal-worldclinicalfairnessproblem,providingcausal
structuralevidenceofdirectsex-baseddiscriminationinthenationallivertransplantallocationpolicy.
LimitationsandFutureDirections FutureworkcouldextendLD3toallowforY withdescendants.
TheassumptionthatallparentsofY areobservedissufficientbutnotnecessaryforCDEidentification
andcouldbereplacedwithadifferentcriterion. TheperformanceofLD3willbeconstrainedbythe
propertiesoftheselectedindependencetest,andanyfutureimprovementsinstatisticalindependence
testing will be of great benefit to the causal discovery community. Future work could consider
discoveryforotherfairnessestimands,suchasthenaturaleffects[62]andpath-specificeffects[3].
9BroaderImpactsandEthicalImplications Mattersofunfairnessanddirectdiscriminationhave
real, profound impacts on human well-being and are often challenging to detect in real-world
retrospective data. Researchers who deploy automated methods like LD3 should be prudent in
interpretingandpubliclycommunicatingthestatisticalsignificanceanduncertaintyoftheirfindings,
whetherevidencefororagainstdiscriminationisfound.
References
[1] Allen, A.M., Heimbach, J.K., Larson, J.J., Mara, K.C., Kim, W.R., Kamath, P.S., and
Therneau, T. M. Reduced access to liver transplantation in women: role of height, meld
exceptionscores,andrenalfunctionunderestimation. Transplantation,102(10):1710–1716,
2018.
[2] Andrews,R.M.andDidelez,V. Insightsintothecross-worldindependenceassumptionof
causalmediationanalysis. Epidemiology,32(2):209–219,2021.
[3] Avin,C.,Shpitser,I.,andPearl,J.Identifiabilityofpath-specificeffects.InIJCAIInternational
JointConferenceonArtificialIntelligence,pp.357–363,2005.
[4] Bareinboim, E. and Plecko, D. Tutorial: Causal Fairness Analysis. In The 38th Interna-
tionalConferenceonMachineLearning,2022. URLhttps://icml.cc/virtual/2022/
tutorial/18435.
[5] Bareinboim,E.,Correa,J.D.,Ibeling,D.,andIcard,T.Onpearl’shierarchyandthefoundations
ofcausalinference. InProbabilisticandcausalinference: theworksofjudeapearl,pp.507–
556.2022.
[6] Barocas,S.andSelbst,A.D. Bigdata’sdisparateimpact. CaliforniaLawReview,104:671,
2016.
[7] Binkyte˙,R.,Makhlouf,K.,Pinzón,C.,Zhioua,S.,andPalamidessi,C. Causaldiscoveryfor
fairness. InWorkshoponAlgorithmicFairnessthroughtheLensofCausalityandPrivacy,pp.
7–22.PMLR,2023.
[8] Bollen,K.A.andPearl,J. Eightmythsaboutcausalityandstructuralequationmodels. In
Handbookofcausalanalysisforsocialresearch,pp.301–328.Springer,2013.
[9] Bonchi, F., Hajian, S., Mishra, B., and Ramazzotti, D. Exposing the probabilistic causal
structure of discrimination. International Journal of Data Science and Analytics, 3:1–21,
2017.
[10] Braun, T., Hurdelhey, B., Meier, D., Tsayun, P., Hagedorn, C., Huegle, J., and Schlosser,
R. GPUCSL:GPU-basedlibraryforcausalstructurelearning. In2022IEEEInternational
Conference on Data Mining Workshops (ICDMW), pp. 1236–1239. IEEE, 2022. ISBN
9798350346091. doi: 10.1109/ICDMW58026.2022.00159. URL https://ieeexplore.
ieee.org/document/10031188/.
[11] Brookhart, M. A., Schneeweiss, S., Rothman, K. J., Glynn, R. J., Avorn, J., and
Stürmer, T. Variable Selection for Propensity Score Models. American Journal of
Epidemiology, 163(12):1149–1156, June 2006. ISSN 1476-6256, 0002-9262. doi:
10.1093/aje/kwj149. URL http://academic.oup.com/aje/article/163/12/1149/
97130/Variable-Selection-for-Propensity-Score-Models.
[12] Cai,H.,Wang,Y.,Jordan,M.,andSong,R. Onlearningnecessaryandsufficientcausalgraphs.
AdvancesinNeuralInformationProcessingSystems,36,2023.
[13] Carey,A.N.andWu,X. Thecausalfairnessfieldguide: Perspectivesfromsocialandformal
sciences. FrontiersinbigData,5:892837,2022.
[14] Cheng,D.,Li,J.,Liu,L.,Zhang,J.,Liu,J.,andLe,T.D. Localsearchforefficientcausal
effectestimation. IEEETransactionsonKnowledgeandDataEngineering,pp.1–14,2022.
ISSN1041-4347,1558-2191,2326-3865. doi: 10.1109/TKDE.2022.3218131. URLhttps:
//ieeexplore.ieee.org/document/9932683/.
10[15] Chernozhukov, V., Chetverikov, D., Demirer, M., Duflo, E., Hansen, C., Newey, W., and
Robins,J. Double/debiasedmachinelearningfortreatmentandstructuralparameters,2018.
[16] Chickering,D.M. OptimalStructureIdentificationWithGreedySearch. JournalofMachine
LearningResearch,3,2002.
[17] Chickering, D. M., Heckerman, D., and Meek, C. Large-Sample Learning of Bayesian
NetworksisNP-Hard. JournalofMachineLearningResearch,5:1287–1330,2004.
[18] Claassen, T., Mooij, J. M., and Heskes, T. Learning Sparse Causal Models is not NP-
hard. ProceedingsoftheTwenty-NinthConferenceonUncertaintyinArtificialIntelligence
(UAI2013),2013.
[19] Corbett-Davies,S.,Gaebler,J.D.,Nilforoshan,H.,Shroff,R.,andGoel,S. Themeasureand
mismeasureof fairness. TheJournalofMachineLearningResearch, 24(1):14730–14846,
2023.
[20] Cron,D.C.,Braun,H.J.,Ascher,N.L.,Yeh,H.,Chang,D.C.,andAdler,J.T. Sex-based
disparitiesinaccesstolivertransplantationforwaitlistedpatientswithmodelforend-stage
liverdiseasescoreof40. AnnalsofSurgery,279(1):112–118,2024.
[21] Dai, H., Ng, I., Zheng, Y., Gao, Z., and Zhang, K. Local causal discovery with linear
non-gaussiancyclicmodels,2024. URLhttp://arxiv.org/abs/2403.14843.
[22] Ding,P.andMiratrix,L. ToAdjustorNottoAdjust? SensitivityAnalysisofM-Biasand
Butterfly-Bias,August2014. URLhttp://arxiv.org/abs/1408.0324. arXiv:1408.0324
[math,stat].
[23] Erdo˝s,P.,Rényi,A.,etal. Ontheevolutionofrandomgraphs. Publ.math.inst.hung.acad.
sci,5(1):17–60,1960.
[24] Galles,D.andPearl,J. Anaxiomaticcharacterizationofcausalcounterfactuals. Foundations
ofScience,3:151–182,1998.
[25] Gao,T.andJi,Q. Localcausaldiscoveryofdirectcausesandeffects. AdvancesinNeural
InformationProcessingSystems,28,2015.
[26] Glymour, C., Zhang, K., and Spirtes, P. Review of Causal Discovery Methods Based
on Graphical Models. Frontiers in Genetics, 10:524, June 2019. ISSN 1664-8021. doi:
10.3389/fgene.2019.00524. URL https://www.frontiersin.org/article/10.3389/
fgene.2019.00524/full.
[27] Gordon, E. J. and Ladner, D. P. Gender inequities pervade organ transplantation access.
Transplantation,94(5):447–448,2012.
[28] Gretton,A.,Bousquet,O.,Smola,A.,andSchölkopf,B. Measuringstatisticaldependence
withhilbert-schmidtnorms. InInternationalconferenceonalgorithmiclearningtheory,pp.
63–77.Springer,2005.
[29] Gretton,A.,Fukumizu,K.,Teo,C.,Song,L.,Schölkopf,B.,andSmola,A. Akernelstatistical
testofindependence. Advancesinneuralinformationprocessingsystems,20,2007.
[30] Guo,F.R.,Lundborg,A.R.,andZhao,Q. ConfounderSelection: ObjectivesandApproaches,
August2022. URLhttp://arxiv.org/abs/2208.13871. arXiv:2208.13871[math,stat].
[31] Gupta, S., Childers, D., and Lipton, Z. C. Local Causal Discovery for Estimating Causal
Effects. InProceedingsofthe2ndConferenceonCausalLearningandReasoning(CLeaR).
arXiv,February2023. URLhttp://arxiv.org/abs/2302.08070. arXiv:2302.08070[cs,
stat].
[32] Hagedorn, C., Lange, C., Huegle, J., and Schlosser, R. Gpu acceleration for information-
theoreticconstraint-basedcausaldiscovery. InTheKDD’22WorkshoponCausalDiscovery,
pp.30–60.PMLR,2022.
11[33] Halpern,J.Y. Axiomatizingcausalreasoning. JournalofArtificialIntelligenceResearch,12:
317–337,2000.
[34] Hernán, M. A. and Robins, J. M. Instruments for Causal Inference: An Epi-
demiologist’s Dream? Epidemiology, 17(4):360–372, July 2006. ISSN 1044-
3983. doi: 10.1097/01.ede.0000222409.00878.37. URL https://journals.lww.com/
00001648-200607000-00004.
[35] Imai, K. Lecture 09-2: Identification of indirect effects. https://www.youtube.com/
watch?v=1WBXsAiU-dk,2023. "AccessedMay2024”.
[36] Imai, K., Keele, L., and Tingley, D. Ageneral approachto causal mediation analysis. 15
(4):309–334, 2010. ISSN 1939-1463, 1082-989X. doi: 10.1037/a0020761. URL https:
//doi.apa.org/doi/10.1037/a0020761.
[37] Imai, K., Keele, L., and Yamamoto, T. Identification, infer-
ence and sensitivity analysis for causal mediation effects. 25(1),
2010. ISSN 0883-4237. doi: 10.1214/10-STS321. URL https://
projecteuclid.org/journals/statistical-science/volume-25/issue-1/
Identification-Inference-and-Sensitivity-Analysis-for-Causal-Mediation-Effects/
10.1214/10-STS321.full.
[38] Kalisch,M.andBuhlmann,P. EstimatingHigh-DimensionalDirectedAcyclicGraphswith
thePC-Algorithm. JournalofMachineLearningResearch,(8):613–636,2007.
[39] Kilbertus,N.,RojasCarulla,M.,Parascandolo,G.,Hardt,M.,Janzing,D.,andSchölkopf,B.
Avoidingdiscriminationthroughcausalreasoning. Advancesinneuralinformationprocessing
systems,30,2017.
[40] Kim,I.K.,Martins,P.N.,Pavlakis,M.,Eneanya,N.D.,andPatzer,R.E. Pastandpresent
policyeffortsinachievingracialequityinkidneytransplantation. CurrentTransplantation
Reports,9(2):114–118,2022.
[41] Kim,W.R.,Mannalithara,A.,Heimbach,J.K.,Kamath,P.S.,Asrani,S.K.,Biggins,S.W.,
Wood,N.L.,Gentry,S.E.,andKwong,A.J. Meld3.0: themodelforend-stageliverdisease
updatedforthemodernera. Gastroenterology,161(6):1887–1895,2021.
[42] Kubkowski,M.,Mielniczuk,J.,andTeisseyre,P. Howtogainonpower: Novelconditional
independencetestsbasedonshortexpansionofconditionalmutualinformation. TheJournal
ofMachineLearningResearch,22(1):2877–2933,2021.
[43] Latt,N.L.,Niazi,M.,andPyrsopoulos,N.T. Livertransplantallocationpoliciesandoutcomes
inunitedstates: Acomprehensivereview. WorldJournalofMethodology,12(1):32,2022.
[44] Lauritzen, S. L. Local computations with probabilities on graphical structures and their
applicationtoexpertsystems(withdiscussion). J.Roy.Statis.,Soc.,B,50(2):251–263,1988.
[45] Lauritzen,S.L.andSpiegelhalter,D.J. LocalComputationswithProbabilitiesonGraphical
StructuresandTheirApplicationtoExpertSystems. JournaloftheRoyalStatisticalSociety:
SeriesB(Methodological),50(2):157–194,January1988. ISSN00359246. doi: 10.1111/j.
2517-6161.1988.tb01721.x. URLhttps://onlinelibrary.wiley.com/doi/10.1111/
j.2517-6161.1988.tb01721.x.
[46] Lee,J.J.,Srinivasan,R.,Ong,C.S.,Alejo,D.,Schena,S.,Shpitser,I.,Sussman,M.,Whitman,
G.J.,andMalinsky,D. Causaldeterminantsofpostoperativelengthofstayincardiacsurgery
usingcausalgraphicallearning. TheJournalofThoracicandCardiovascularSurgery,pp.
S002252232200900X,August2022. ISSN00225223. doi: 10.1016/j.jtcvs.2022.08.012. URL
https://linkinghub.elsevier.com/retrieve/pii/S002252232200900X.
[47] Lousdal,M.L.Anintroductiontoinstrumentalvariableassumptions,validationandestimation.
EmergingThemesinEpidemiology,15(1):1,December2018. ISSN1742-7622. doi: 10.1186/
s12982-018-0069-7. URL https://ete-online.biomedcentral.com/articles/10.
1186/s12982-018-0069-7.
12[48] Maasch, J., Pan, W., Gupta, S., Kuleshov, V., Gan, K., and Wang, F. Local discovery by
partitioning:Polynomial-timecausaldiscoveryaroundexposure-outcomepairs.InProceedings
ofthe40thConferenceonUncertainyinArtificialIntelligence,2024. doi: https://doi.org/10.
48550/arXiv.2310.17816. URLhttps://arxiv.org/abs/2310.17816.
[49] Maathuis, M. H. and Colombo, D. A generalized back-door criterion. The An-
nals of Statistics, 43(3), June 2015. ISSN 0090-5364. doi: 10.1214/14-AOS1295.
URL https://projecteuclid.org/journals/annals-of-statistics/volume-43/
issue-3/A-generalized-back-door-criterion/10.1214/14-AOS1295.full.
[50] Makhlouf, K., Zhioua, S., and Palamidessi, C. Survey on causal-based machine learning
fairnessnotions. arXivpreprintarXiv:2010.09553,2020.
[51] Malinchoc,M.,Kamath,P.S.,Gordon,F.D.,Peine,C.J.,Rank,J.,andTerBorg,P.C. A
modeltopredictpoorsurvivalinpatientsundergoingtransjugularintrahepaticportosystemic
shunts. Hepatology,31(4):864–871,2000.
[52] Mathur,A.K.,Schaubel,D.E.,Gong,Q.,Guidinger,M.K.,andMerion,R.M. Sex-based
disparitiesinlivertransplantratesintheunitedstates. AmericanJournalofTransplantation,
11(7):1435–1443,2011.
[53] Nephew,L.D.andSerper,M. Racial,gender,andsocioeconomicdisparitiesinlivertransplan-
tation. LiverTransplantation,27(6):900–912,2021.
[54] Nephew, L. D., Goldberg, D. S., Lewis, J. D., Abt, P., Bryan, M., and Forde, K. A. Ex-
ceptionpointsandbodysizecontributetogenderdisparityinlivertransplantation. Clinical
gastroenterologyandhepatology,15(8):1286–1293,2017.
[55] ofTransplantRecipients,S.R. Optn/srtr2020annualdatareport: Liver,2020. URLhttps:
//srtr.transplant.hrsa.gov/annual_reports/2020/Liver.aspx. Accessed: 2024-
05-20.
[56] Oloruntoba,O.O.andMoylan,C.A. Gender-baseddisparitiesinaccesstoandoutcomesof
livertransplantation. Worldjournalofhepatology,7(3):460,2015.
[57] Papalexopoulos,T.,Alcorn,J.,Bertsimas,D.,Goff,R.,Stewart,D.,andTrichakis,N. Reshap-
ingnationalorganallocationpolicy. OperationsResearch,2023.
[58] Pearl,J. Causaldiagramsforempiricalresearch. Biometrika,82(4):669–688,1995.
[59] Pearl, J. Direct and indirect effects. In Proceedings of the Seventeenth Conference on
UncertainyinArticialIntelligence,2001.
[60] Pearl,J. Themediationformula: Aguidetotheassessmentofcausalpathwaysinnonlinear
models. Causality: Statisticalperspectivesandapplications,pp.151–179,2012.
[61] Pearl, J. The causal mediation formula—a guide to the assessment of path-
ways and mechanisms. 13(4):426–436, 2012-08. ISSN 1389-4986, 1573-6695.
doi: 10.1007/s11121-011-0270-1. URL http://link.springer.com/10.1007/
s11121-011-0270-1.
[62] Pearl,J. Interpretationandidentificationofcausalmediation. 19(4):459–481,2014. ISSN
1939-1463, 1082-989X. doi: 10.1037/a0036434. URL https://doi.apa.org/doi/10.
1037/a0036434.
[63] Perkovic,E.,Textor,J.,Kalisch,M.,andMaathuis,M.H.ACompleteGeneralizedAdjustment
Criterion. ProceedingsoftheThirty-FirstConferenceofUncertaintyinArtificialIntelligence
(UAI),pp.682–691,2015.
[64] Peters,J.,Mooij,J.,Janzing,D.,andSchölkopf,B.CausalDiscoverywithContinuousAdditive
NoiseModels,April2014. URLhttp://arxiv.org/abs/1309.6779. arXiv:1309.6779
[stat].
13[65] Petersen, A.H., Ekstrøm, C.T., Spirtes, P., andOsler, M. Constructingcausallife-course
models: Comparativestudyofdata-drivenandtheory-drivenapproaches. AmericanJournalof
Epidemiology,192(11):1917–1927,2023.
[66] Petersen,M.L.,Sinisi,S.E.,andVanDerLaan,M.J. Estimationofdirectcausaleffects:.
17(3):276–284,2006. ISSN1044-3983. doi: 10.1097/01.ede.0000208475.99429.2d. URL
http://journals.lww.com/00001648-200605000-00012.
[67] Plecko,D.andBareinboim,E. Causalfairnessforoutcomecontrol. InProceedingsofthe
37thConferenceonNeuralInformationProcessingSystems(NeurIPS2023),2023.
[68] Plecko, D. and Bareinboim, E. A causal framework for decomposing spurious variations.
AdvancesinNeuralInformationProcessingSystems,36,2024.
[69] Plecˇko, D.andBareinboim, E. Causalfairnessanalysis: Acausaltoolkitforfairmachine
learning. 17(3):304–589, 2024. ISSN 1935-8237, 1935-8245. doi: 10.1561/2200000106.
URLhttp://www.nowpublishers.com/article/Details/MAL-106.
[70] Procurement, O. and Network, T. Data request instructions, 2024. URL
https://optn.transplant.hrsa.gov/data/view-data-reports/request-data/
data-request-instructions/. Accessed: 2024-05-20.
[71] Runge,J. Conditionalindependencetestingbasedonanearest-neighborestimatorofcondi-
tionalmutualinformation. InProceedingsofthe21stInternationalConferenceonArtificial
IntelligenceandStatistics(AISTATS),Lanzarote,Spain,2018.
[72] Runge,J. Necessaryandsufficientgraphicalconditionsforoptimaladjustmentsetsincausal
graphical models with hidden variables. Proceedings of the 35th Conference on Neural
InformationProcessingSystems,2021.
[73] Runge, J., Bathiany, S., Bollt, E., Camps-Valls, G., Coumou, D., Deyle, E., Glymour, C.,
Kretschmer, M., Mahecha, M. D., Muñoz-Marí, J., van Nes, E. H., Peters, J., Quax, R.,
Reichstein,M.,Scheffer,M.,Schölkopf,B.,Spirtes,P.,Sugihara,G.,Sun,J.,Zhang,K.,and
Zscheischler,J. InferringcausationfromtimeseriesinEarthsystemsciences. NatureCommu-
nications,10(1):2553,December2019. ISSN2041-1723. doi: 10.1038/s41467-019-10105-3.
URLhttp://www.nature.com/articles/s41467-019-10105-3.
[74] Sachs,K.,Perez,O.,Pe’er,D.,Lauffenburger,D.A.,andNolan,G.P. Causalprotein-signaling
networksderivedfrommultiparametersingle-celldata. Science,308(5721):523–529,2005.
[75] Sarkar,M.,Watt,K.D.,Terrault,N.,andBerenguer,M. Outcomesinlivertransplantation:
doessexmatter? Journalofhepatology,62(4):946–955,2015.
[76] Scutari, M. Learning Bayesian Networks with the bnlearn R Package, July 2010. URL
http://arxiv.org/abs/0908.3817. arXiv:0908.3817[stat].
[77] Shah,A.,Shanmugam,K.,andAhuja,K. FindingValidAdjustmentsunderNon-ignorability
with Minimal DAG Knowledge, February 2022. URL http://arxiv.org/abs/2106.
11560. arXiv:2106.11560[cs].
[78] Shah,A.,Shanmugam,K.,andKocaoglu,M. Front-dooradjustmentbeyondmarkovequiva-
lencewithlimitedgraphknowledge. AdvancesinNeuralInformationProcessingSystems,36,
2024.
[79] Shen,X.,Ma,S.,Vemuri,P.,Simon,G.,andTheAlzheimer’sDiseaseneuroimaginginitiative.
ChallengesandOpportunitieswithCausalDiscoveryAlgorithms: ApplicationtoAlzheimer’s
Pathophysiology. ScientificReports,10(2975),2020.
[80] Shimizu,S.,Hoyer,P.O.,Hyvarinen,A.,andKerminen,A. ALinearNon-GaussianAcyclic
ModelforCausalDiscovery. JournalofMachineLearningResearch,7:2003–2030,2006.
[81] Shpitser,I.andPearl,J. Identificationofconditionalinterventionaldistributions. InProceed-
ingsoftheTwenty-SecondConferenceonUncertaintyinArtificialIntelligence,2006.
14[82] Shpitser,I.andVanderWeele,T.J. Acompletegraphicalcriterionfortheadjustmentformula
inmediationanalysis. 7(1):1–24,2011. ISSN1557-4679. doi:10.2202/1557-4679.1297. URL
https://www.degruyter.com/document/doi/10.2202/1557-4679.1297/html.
[83] Spirtes, P. and Zhang, K. Causal discovery and inference: concepts and recent method-
ological advances. Applied Informatics, 3(1):3, December 2016. ISSN 2196-0089. doi:
10.1186/s40535-016-0018-x. URLhttps://applied-informatics-j.springeropen.
com/articles/10.1186/s40535-016-0018-x.
[84] Spirtes,P.,Glymour,C.,andScheines,R. Causation,prediction,andsearch. MITpress,2001.
[85] Starke,C.,Baleis,J.,Keller,B.,andMarcinkowski,F. Fairnessperceptionsofalgorithmic
decision-making: Asystematicreviewoftheempiricalliterature. BigData&Society,9(2):
20539517221115189,2022.
[86] UNOS. Liver and intestinal organ distribution based on acu-
ity circles implemented feb. 4, . URL https://unos.org/news/
system-implementation-notice-liver-and-intestinal-organ-distribution-based-on-acuity-circles-implemented-feb-4.
Accessed: May2024.
[87] UNOS. Improving liver allocation: Meld, peld, status 1a, status 1b, . URL
https://optn.transplant.hrsa.gov/media/3idbp5vq/policy-guid-change_
impr-liv-alloc-meld-peld-sta-1a-sta-1b_liv.pdf. Accessed: May2024.
[88] UNOS. The policy change of adding serum sodium to
meld score calculation, . URL https://unos.org/news/
policy-and-system-changes-adding-serum-sodium-to-meld-calculation.
Accessed: May2024.
[89] Vanderweele,T.J.Controlleddirectandmediatedeffects:Definition,identificationandbounds.
38(3):551–563,2011. ISSN0303-6898,1467-9469. doi: 10.1111/j.1467-9469.2010.00722.x.
URLhttps://onlinelibrary.wiley.com/doi/10.1111/j.1467-9469.2010.00722.
x.
[90] VanderWeele,T.J. Mediationanalysis: apractitioner’sguide. Annualreviewofpublichealth,
37:17–32,2016.
[91] VanderWeele,T.J. Principlesofconfounderselection. EuropeanJournalofEpidemiology,34
(3):211–219,March2019. ISSN0393-2990,1573-7284. doi: 10.1007/s10654-019-00494-6.
URLhttps://link.springer.com/10.1007/s10654-019-00494-6.
[92] VanderWeele, T. J. and Shpitser, I. On the definition of a confounder. The Annals
of Statistics, 41(1), February 2013. ISSN 0090-5364. doi: 10.1214/12-AOS1058.
URL https://projecteuclid.org/journals/annals-of-statistics/volume-41/
issue-1/On-the-definition-of-a-confounder/10.1214/12-AOS1058.full.
[93] Verma,S.andRubin,J. Fairnessdefinitionsexplained. InProceedingsoftheinternational
workshoponsoftwarefairness,pp.1–7,2018.
[94] Wald,C.,Russo,M.W.,Heimbach,J.K.,Hussain,H.K.,Pomfret,E.A.,andBruix,J. New
optn/unospolicyforlivertransplantallocation: standardizationofliverimaging,diagnosis,
classification,andreportingofhepatocellularcarcinoma,2013.
[95] Yu, K., Guo, X., Liu, L., Li, J., Wang, H., Ling, Z., and Wu, X. Causality-based Feature
Selection: MethodsandEvaluations. ACMComputingSurveys,53(5):1–36,September2021.
ISSN0360-0300,1557-7341. doi: 10.1145/3409382. URLhttps://dl.acm.org/doi/10.
1145/3409382.
[96] Yu,K.,Liu,L.,andLi,J. AUnifiedViewofCausalandNon-causalFeatureSelection. ACM
TransactionsonKnowledgeDiscoveryfromData,15(4):1–46,August2021. ISSN1556-4681,
1556-472X. doi: 10.1145/3436891. URLhttps://dl.acm.org/doi/10.1145/3436891.
15[97] Zarebavani, B., Jafarinejad, F., Hashemi, M., and Salehkaleybar, S. cuPC: CUDA-based
parallel PC algorithm for causal structure learning on GPU. 31(3):530–542, 2020. ISSN
1045-9219, 1558-2183, 2161-9883. doi: 10.1109/TPDS.2019.2939126. URL https://
ieeexplore.ieee.org/document/8823064/.
[98] Zhang,J.andBareinboim,E. Fairnessindecision-making—thecausalexplanationformula.
32(1), 2018. ISSN 2374-3468, 2159-5399. doi: 10.1609/aaai.v32i1.11564. URL https:
//ojs.aaai.org/index.php/AAAI/article/view/11564.
[99] Zhang,K.,Peters,J.,Janzing,D.,andScholkopf,B. Kernel-basedConditionalIndependence
TestandApplicationinCausalDiscovery. ProceedingsoftheTwenty-SeventhConferenceon
UncertaintyinArtificialIntelligence,2011.
[100] Zhang,L.,Wu,Y.,andWu,X. Acausalframeworkfordiscoveringandremovingdirectand
indirectdiscrimination. InProceedingsofthe26thInternationalJointConferenceonArtificial
Intelligence,pp.3929–3935,2017.
[101] Zhang,X.,Melanson,T.A.,Plantinga,L.C.,Basu,M.,Pastan,S.O.,Mohan,S.,Howard,
D. H., Hockenberry, J. M., Garber, M. D., and Patzer, R. E. Racial/ethnic disparities in
waitlistingfordeceaseddonorkidneytransplantation1yearafterimplementationofthenew
nationalkidneyallocationsystem. AmericanJournalofTransplantation,18(8):1936–1946,
2018.
[102] Zheng,X.,Aragam,B.,Ravikumar,P.K.,andXing,E.P. Dagswithnotears: Continuous
optimizationforstructurelearning. Advancesinneuralinformationprocessingsystems,31,
2018.
16Appendix
A SupplementalFiguresandTables
DISPARATETREATMENT DISPARATEIMPACTS
DirectCausalMechanism IndirectCausalMechanism SpuriousAssociation
X Y X Y X Y
Z Z Z
X ∼Bern(0.3) X ∼Bern(0.3) X ∼Bern(0.3+0.1Z)
Z ∼Bern(0.2+0.3X) Z ∼Bern(0.2+0.3X) Z ∼Bern(0.2)
Y ∼Bern(0.1+0.2X) Y ∼Bern(0.1+0.2Z) Y ∼Bern(0.1+0.2Z)
TableA.1: Exampledatageneratingprocessesunderdirect,indirect,andspuriousstructuralmecha-
nismsofunfairness. AdaptedfromBareinboim&Plecko[4]. LetX denoteaprotectedattribute,Y
anoutcomeofinterest,andZ athirdmeasuredvariable.
B FurtherDiscussiononDirectEffectEstimation
B.1 ComparingtheWeightedControlledDirectEffecttotheNaturalDirectEffect
WeprovideadditionaldiscussionontheweightedCDEanditsmostpopularcounterpart,theNDE.
RecallthattheCDEandweightedCDEaredefinedasfollows:
CDE(m):=E[Y −Y ] (5)
x,m x∗,m
=E[Y|do(X =x,M=m)]−E[Y|do(X =x∗,M=m)] (6)
=(cid:88)(cid:2)E[Y|x,s,m]−E[Y|x∗,s,m](cid:3)
P(s). (7)
s
WCDE
:=(cid:88)(cid:88)(cid:2)(cid:2)E[Y|x,s,m]−E[Y|x∗,s,m](cid:3) P(s)(cid:3)
P(m). (8)
m s
DefinitionB.1(AverageNDE,Pearl[62]). TheNDEmeasurestheexpectedchangeinoutcomeas
theexposurechanges,withmediatorsfixedatthevaluesthattheywouldhavebeenperindividual
priortothischangeinexposure. TheNDEcapturestheportionofthetotalcausaleffectthatwould
betransmittedtotheoutcomeifthemediatorsdidnotrespondtochangesintheexposure.
Forvaluesoftheexposurexandx∗,valuessofcovariatesS,andvaluesmofmediatorsM,the
averageNDEis
NDE(x,x∗;Y)=E[Y −Y ]. (9)
x,M∗ x∗,M∗
x x
TheaverageNDEinMarkovianmodelsisidentifiablefromobservationaldataperCorollary2in
Pearl[59],allowingcounterfactualexpressionstobereplacedbyprobabilisticestimands:
NDE(x,x∗;Y)=(cid:88)(cid:88)(cid:2)(cid:2)E[Y|x,m]−E[Y|x∗,m](cid:3) P(m|x∗,s)(cid:3)
P(s). (10)
s m
WenotethattheweightedCDEandNDEdifferonlybythewaythatweweightheCDE:forthe
weightedCDE,weweighbyP(m),andfortheNDE,weweighbyP(m|x∗,s). Thisstemsfrom
thefactthattheCDEisafunctionofinterventionaldistributions,whiletheNDEisacounterfactual
quantity. TheNDErequiresprobabilitiesofnestedcounterfactualsandacross-worldcounterfactual
assumption[82,60,62,2]. Nevertheless,Pearl[59]showedthattheNDEcanbeexpressedwith
do-notation and reduced to a “do-free” expression by valid covariate adjustment, allowing for
identificationandestimation[60]. UnliketheNDE,theCDEdoesnotadmitavaliddecomposition
ofthetotalcausaleffectintodirectandindirecteffectsforthegeneralnonparametricsetting[59].
Conversely,thetotaleffectisalwaysequaltothedifferenceoftheNDEandthereversetransitionofthe
naturalindirecteffect(NIE),eveninthepresenceofnonlinearitiesandexposure-mediatorinteractions
17[62]. However,intheabsenceofexposure-mediatorinteraction,theCDEandNDEareequivalent
andtheCDEcanbeusedfortotaleffectdecomposition[89]. Theguaranteeddecomposabilityofthe
totaleffectintotheNDEandNIEisaprimaryreasonthatthenaturaleffectsareemployedincausal
fairnessanalysis[69]. However,whenonlyevidenceofdirectdiscriminationisneeded,itsufficesto
estimatetheCDE[98]. Inpractice,theCDEhastraditionallybeeninmorefrequentuseinpolicy
evaluationsettingsthantheNDE[89].
Thepresentworkiscentrallyconcernedwithdirectdiscriminationonly. Forourcurrentobjectives,
wefavortheweightedCDEasametricbecauseitrequiresfewerassumptionsoverthedatagenerating
process and requires less prior structural knowledge than the NDE [89]. For example, the NDE
requires that no confounder for {M,Y} is descended from X [62], as the same covariates that
deconfound {M,Y} must also be used to identify the counterfactual quantity P(m|x∗,s). As
explained in Appendix C of Pearl [62], if this covariate set contains a variable that is descended
fromtheexposure,P(m|x∗,s)isnotidentifiableevenunderrandomtreatmentassignment. While
adjustingforconfoundersfor{M,Y}thataredescendedfromtheexposurecaninducebiasinCDE
estimation,thisbiasisaddressablewhengivenanappropriateestimator[66,62,35]. Therefore,the
presenceorabsenceofsuchvariablesissomethingthatcanbeassumedattheestimationstageat
thediscretionoftheuser,butdoesnotimpactthebehaviorofLD3. Theabsenceofconfounders
ofthisformischallengingtoverify[89],andmaybeunrealisticinreal-worlddata. Thislimitsthe
rangeofstructuresforwhichNDEestimatescanbeobtained. Additionally, theidentifiabilityof
theNDErequiresthatSalsodeconfounds{X,M},addinganextraburdenofgraphicalknowledge.
SeeAndrews&Didelez[2]foradiscussionofthecross-worldcounterfactualassumptioninNDE
identification. ThoughtheNDEhasusefulpropertiesforcertainformsofanalysis,werestrictour
attentiontotheweightedCDEinthepresentworkforthesereasons.
C Proofs
C.1 CorrectnessofAlgorithm1
Proof. Weshowthateachsetoftestsiscorrectwhenallstatedassumptionsaremet.
• Z (Line3): Asprovenin[48],theindependencerelationstestedinLine3uniquelydefine
8
partitionZ andarethereforeanasymptoticallycorrecttestforidentifyingthispartition,
8
andthispartitiononly.
• Z (Line4): Asprovenin[48],theindependencerelationstestedinLine4definepartition
5,7
Z inallstructuresandZ instructuresforwhich|Z |=0(i.e.,noconfounders,latentnor
7 5 1
observed,existforX andY). Therefore,thistestisasymptoticallyguaranteedtoreturnall
Z forarbitrarystructures,andallZ ifZ istheemptyset.
7 5 1
• Z (Line5): Asprovenin[48],theindependencerelationstestedinLine5uniquelydefine
4
partitionZ andarethereforeanasymptoticallycorrecttestforidentifyingthispartition,
4
andthispartitiononly.
• Z ∪Z (Line8): Atthisstage,theonlypartitionsremainingunderconsidera-
1∈pa(Y) 3∈pa(Y)
tionareZ ,Z ,Z ,andZ (assumingthatZ isnottheemptyset). Bydefinition,
1 2∈/de(Y) 3 5 1
noZ willeverbeadjacenttoY,asthispartitioncannotshareacausalpathtoY thatis
5
notmediatedbyX [34,47,48]. AllZ aredescendedfromZ ,Z ,and/orZ (i.e.,
2∈/de(Y) 1 3 4
any partition that can enter into Y), but not from Y itself. Thus, all Z and Z will be
2 5
eliminatedbyeliminatingvariablesnotadjacenttoY givenX∪Z ∪{Z′\Z}. Thistest
4
willalsoresultintheeliminationofZ andZ thatarenotadjacenttoY,includingproxy
1 3
confoundersandproxymediatorsasdefinedinMaaschetal.[48].
• Z (Line10):AnyinterveningnodeonthecausalpathfromZ toY (Z →···→Y)
4∈pa(Y) 4 4
mustalsobelongtoapartitionthatcanenterintoY (···→Y). Bydefinition,thisisstrictly
Z ,Z ,andZ . Therefore,toobtaind-separationbetweenY andanymemberofZ that
1 3 4 4
isnotadjacenttoY,acorrectconditioningsetwillcontainmembersofZ ,Z andZ . It
1 3 4
isthereforesufficienttoconditionallZ andZ thatarealreadyknowntobeadjacentto
1 3
Y,unionedwithallknownZ . AnyvariablethatismarginallydependentonY giventhis
4
conditioningsetisamemberofZ thatisadjacenttoY.
4
18• A (Line11): BydefinitionofA .
DE DE
• SDC(Line12): BydefinitionoftheSDC(Definition2.3),SDC =1(X ∈pa(Y)). IfX
isnotaparentofY,itwillalwaysbed-separablefromY whenalltheirconfoundingand
mediatingpathsareblocked. IfX isaparentofY,X andY willbealwaysconditionally
dependentgivenanyconditioningset. Therefore,theSDCwillevaluateto0ifandonlyif
X ⊥⊥Y|Z ∪Z .
1∈pa(Y) 3∈pa(Y)
C.2 ProofofTheorem3.2
WeshowthatlatentvariablesthatarenotparentsofY donotimpacttheasymptoticguaranteesof
Algorithm1.
Proof. Maaschetal.[48]haveshownpreviouslythatthemarginalandconditionalindependence
testsusedtoidentifyZ andZ arenotaffectedbylatentvariables. Intuitionforthisfollowsfromthe
4 8
factthatthesetestsonlyrequireknowledgeof{X,Y}andthecandidatevariableZ. InAlgorithm
1, thetestforZ alsoreliesonlyonknowledgeofX, Y, andZ, andisthereforecorrectinthe
5,7
presenceoflatentvariables. AswedonotrequireidentificationofZ itselffordownstreamresults,
5
thistestsuffices. Otherwise,latentvariablescouldposeidentifiabilityproblemsforZ ,asinprior
5
works[48]. (A2)aloneissufficienttoensured-separationbetweenY anditsnon-parentsatLines
8and10,guaranteeingidentificationofthetrueparentsofY inZ ,Z ,andZ . Therefore,latent
1 3 4
variablesthatarenotparentsofY havenoimpactonAlgorithm1.
C.3 ProofofTheorem3.4
Proof. ThistheoremclaimsthatA :=Z ∪Z ∪Z isavalidadjustmentset
DE 1∈pa(Y) 3∈pa(Y) 4∈pa(Y)
forweightedCDEidentificaiton. PertheidentifiabilityconditionsoftheweightedCDE(Definition
2.5),avalidadjustmentsetmustblockallbackdoorpathsfor{X,Y}and{M,Y}. Asshownin
Pearl[59],knowledgeofallmediatorsfor{X,Y}thatareparentsofY issufficientforidentifying
theCDE(i.e.,knowledgeofeverymediatorinthefullcausalgraphisunnecessary). Thus,weshow
thatadjustingforA blocksallbackdoorpathsfor{X,Y}and{M,Y},doesnotopennon-causal
DE
pathsbyconditioningoncolliders,andblocksallfrontdoorpathsfor{X,Y}byconditioningonall
mediatorsthatareparentsofY (Definition2.6). Weusethelanguageofcausalpartitionsdefinedin
[48]. Weassumethatallassumptionsofthisworkaremet(e.g.,(A2): allparentsofY areobserved
inZ).
1. Backdoor paths for {X,Y} are blocked. Any confounder for {X,Y} will be in causal
partitionZ ,bydefinitionofZ (Table1)[48]. AllbackdoorpathsenterY bydefinition
1 1
(i.e.,···→Y). AsA containsallconfoundersthatareparentsofY,allbackdoorpaths
DE
for{X,Y}willbeblockedwhenconditioningonA .
DE
2. Backdoorpathsfor{M,Y}areblocked. AnyconfounderforMandY willbeinZ ∪
1
Z ∪Z ,asthesearetheonlycausalpartitionswithedgespointingintoY. SetA by
3 4 DE
definitioncontainsallmembersofZ ,Z ,andZ thatareparentsofY. Given(A2),all
1 3 4
backdoorpathsbetweenMandY areguaranteedtobeblocked.
3. Frontdoorpathsareblocked. Anymediatorfor{X,Y}willbeincausalpartitionZ ,by
3
definitionofZ (Table1)[48]. AllfrontdoorpathsenterY bydefinition(i.e.,···→Y). As
3
A containsallmediatorsthatareparentsofY,allfrontdoorpathswillbeblocked.
DE
4. Non-causal paths through colliders are blocked. Though Z can contain colliders in
Z ,A doesnotcontainmembersofZ . Thus,non-causalpathswillnotbeopened
2∈/de(Y) DE 2
by conditioning on A . We show in Section C.1 that Algorithm 1 is asymptotically
DE
guaranteedtoremoveZ fromthefinaladjustmentset.
2∈/de(Y)
19D EmpiricalEvaluationMethods
B B
1 2
B
3
Z Z Z
5 1 4b
X Y
Z 3d Z 4a
Z Z
3a 3c
Z
3b
M M
1 2
M
3
FigureD.1: Eighteen-nodeDAGusedtoevaluatetheabilityofLD3torecoverthetrueA ,assess
DE
theSDC,andestimatetheweightedCDE.
BaselineEvaluation BaselineswereevaluatedonthebasisofF1,precision,andrecallwithrespect
tothetruemembersofA . Amongbaselines,onlyLDECCisdesignedtoreturntheparentsof
DE
Y. Additionally,bothPCandLDECCreturnresultsrelativetoaMarkovequivalenceclass(MEC).
Therefore,weevaluatebaselinesbothwithandwithoutpost-processingtoadjustforthetaskofA
DE
prediction. Thisallowsforout-of-the-boxevaluationandamorecharitableevaluationthatistailored
for the task. In contrast, LD3 only needs to be run out-of-the-box. The two evaluation methods
peralgorithmareasfollows: PC(PC andPC )[38],9 LDP(LDPandLDP )[48],andLDECC
∩ ∪ pa
(LDECC andLDECC )[31]. Wedefinetheevaluationforeachbelow.
∩ ∪
1. PC : Withoutpost-processing,weretaintheparentsofY inallDAGsintheMEC.
∪
2. PC : Withpost-processing,weretaintheparentsofY inanyDAGintheMEC.
∩
3. LDECC : Withoutpost-processing,weretainthevariableslabeledasparentsofthetarget.
∪
4. LDECC : Withpost-processing,weretainthevariableslabeledasparentsofthetarget
∩
unionedwiththevariablesthatareunoriented.
5. LDP:Withoutpost-processing,weretainZ ∪Z ∪Z . Asourexperimentalsetting
1 POST 4
requiresthattherearenodescendantsoftheoutcome,thesupersetZ :=Z ∪
POST 2∈de(Y)
Z ∪Z definedinMaaschetal.[48]willnowonlycontainZ .
3 6 3
6. LDP : Wepost-processtheLDPoutputtoonlyretainthevariablesthatarenotcondition-
pa
allyindependentofY giventheremainingmembersoftheset.
9https://github.com/keiichishima/pcalg
20E EmpiricalResults
FigureE.1: Totalruntimeandtotalconditionalindependencetestsperformedwithrespecttototal
edgesandtotalnodes,usinganoracleonrandomdirectedacyclicErdo˝s-Rényigraphs[23].
Figure E.2: Mean runtime for the ASIA [45] and SACHS [74] benchmarks from bnlearn
(https://www.bnlearn.com/bnrepository/) [76] (χ2 tests; α = 0.001; 95% confidence intervals in
shadedregions). ForASIA(EITHER→DYSP),|Z|=6and|A DE|=1. ForSACHS(ERK→AKT),
|Z|=11and|A |=1. RawdataarereportedinTablesE.2andE.4.
DE
21FigureE.3: MeanweightedCDEestimatesover100replicatespersamplesizeforlinear-Gaussian
instantiationsofFigureD.1(95%confidenceintervalsinshadedregions). Groundtruthweighted
CDE is denoted by the dashed line. LD3 used parametric Fisher-z tests (α = 0.01), as the data
generatingprocesswasknownforthissimulation. Estimateswereobtainedwithlinearregression
(https://scikit-learn.org/). Note: This pipeline is for ease of explication in the illustrative setting
only. Forunknowndatageneratingprocesses,wedonotrecommendthispipelineduetorestrictive
parametricassumptions.
FigureE.4: SDCaccuracy,A F1,precision,andrecallacrosssamplesizeswhenSDC=0and
DE
SDC=1. Valueswereaveragedover100replicatesoflinear-GaussianinstantiationsofFigureD.1,
with95%confidenceintervalsinshadedregions. LD3usedparametricFisher-ztests(α=0.01),as
thedatageneratingprocesswasknownforthissimulation.
22ASIA(LUNGCANCER)
SDC=1:either→dysp SDC=0:xray̸→dysp
F1 Prec Rec F1 Prec Rec
LD3 1.00 1.00 1.00 1.00 1.00 1.00
Oracle
PC∪ 1.00 1.00 1.00 1.00 1.00 1.00
PC∩ 1.00 1.00 1.00 1.00 1.00 1.00
LDECC∪ 1.00 1.00 1.00 1.00 1.00 1.00
LDECC∩ 1.00 1.00 1.00 1.00 1.00 1.00
LDPpa 1.00 1.00 1.00 1.00 1.00 1.00
LDP 0.50 0.33 1.00 0.67 0.50 1.00
LD3 1.00[1.00,1.00] 1.00[1.00,1.00] 1.00[1.00,1.00] 0.80[0.69,0.91] 1.00[1.00,1.00] 0.70[0.54,0.86]
n=2.5k
PC∪ 0.00[0.00,0.00] 0.00[0.00,0.00] 0.00[0.00,0.00] 0.00[0.00,0.00] 0.00[0.00,0.00] 0.00[0.00,0.00]
PC∩ 0.00[0.00,0.00] 0.00[0.00,0.00] 0.00[0.00,0.00] 0.00[0.00,0.00] 0.00[0.00,0.00] 0.00[0.00,0.00]
LDECC∪ 0.75[0.61,0.89] 0.65[0.46,0.84] 1.00[1.00,1.00] 0.67[0.49,0.85] 0.65[0.46,0.84] 0.70[0.54,0.86]
LDECC∩ 0.75[0.61,0.89] 0.65[0.46,0.84] 1.00[1.00,1.00] 0.67[0.49,0.85] 0.65[0.46,0.84] 0.70[0.54,0.86]
LDPpa 1.00[1.00,1.00] 1.00[1.00,1.00] 1.00[1.00,1.00] 0.83[0.72,0.94] 1.00[1.00,1.00] 0.75[0.59,0.91]
LDP 0.26[0.24,0.28] 0.15[0.14,0.16] 0.97[0.90,1.00] 0.14[0.13,0.14] 0.07[0.07,0.08] 1.00[1.00,1.00]
LD3 1.00[1.00,1.00] 1.00[1.00,1.00] 1.00[1.00,1.00] 0.90[0.80,1.00] 1.00[1.00,1.00] 0.85[0.70,1.00]
n=5k
PC∪ 0.00[0.00,0.00] 0.00[0.00,0.00] 0.00[0.00,0.00] 0.00[0.00,0.00] 0.00[0.00,0.00] 0.00[0.00,0.00]
PC∩ 0.00[0.00,0.00] 0.00[0.00,0.00] 0.00[0.00,0.00] 0.00[0.00,0.00] 0.00[0.00,0.00] 0.00[0.00,0.00]
LDECC∪ 0.60[0.47,0.73] 0.47[0.29,0.64] 1.00[1.00,1.00] 0.52[0.36,0.68] 0.47[0.29,0.64] 0.60[0.47,0.73]
LDECC∩ 0.60[0.47,0.73] 0.47[0.29,0.64] 1.00[1.00,1.00] 0.52[0.36,0.68] 0.47[0.29,0.64] 0.60[0.47,0.73]
LDPpa 1.00[1.00,1.00] 1.00[1.00,1.00] 1.00[1.00,1.00] 0.93[0.85,1.00] 1.00[1.00,1.00] 0.90[0.77,1.00]
LDP 0.65[0.62,0.68] 0.48[0.45,0.52] 1.00[1.00,1.00] 0.65[0.62,0.67] 0.48[0.45,0.51] 1.00[1.00,1.00]
LD3 1.00[1.00,1.00] 1.00[1.00,1.00] 1.00[1.00,1.00] 0.90[0.80,1.00] 1.00[1.00,1.00] 0.85[0.70,1.00]
n=10k
PC∪ 0.00[0.00,0.00] 0.00[0.00,0.00] 0.00[0.00,0.00] 0.00[0.00,0.00] 0.00[0.00,0.00] 0.00[0.00,0.00]
PC∩ 0.00[0.00,0.00] 0.00[0.00,0.00] 0.00[0.00,0.00] 0.00[0.00,0.00] 0.00[0.00,0.00] 0.00[0.00,0.00]
LDECC∪ 0.50[0.50,0.50] 0.33[0.33,0.33] 0.00[0.00,0.00] 0.40[0.40,0.40] 0.33[0.33,0.33] 0.50[0.50,0.50]
LDECC∩ 0.50[0.50,0.50] 0.33[0.33,0.33] 0.00[0.00,0.00] 0.40[0.40,0.40] 0.33[0.33,0.33] 0.50[0.50,0.50]
LDPpa 1.00[1.00,1.00] 1.00[1.00,1.00] 1.00[1.00,1.00] 0.90[0.80,1.00] 1.00[1.00,1.00] 0.85[0.70,1.00]
LDP 0.67[0.67,0.67] 0.50[0.50,0.50] 1.00[1.00,1.00] 0.64[0.61,0.67] 0.47[0.44,0.5] 1.00[1.00,1.00]
Table E.1: Empirical performance on the ASIA (Lung Cancer) Bayesian network dataset [44]
from bnlearn [76]. Binary data were evaluated with χ2 independence tests (α = 0.001; 95%
confidence intervals in brackets). Unexpected decreases in baseline performance for increasing
sample size might be due to the difficulty of this dataset for structure learning, as noted in the
bnlearndocumentation: “Standardlearningalgorithmsarenotabletorecoverthetruestructureof
thenetworkbecauseofthepresenceofanode(E)withconditionalprobabilitiesequaltoboth0and
1"(https://www.bnlearn.com/documentation/man/asia.html).
ASIA(LUNGCANCER)
SDC=1:either→dysp SDC=0:xray̸→dysp
Time Tests Time Tests
LD3 0.002 29 0.002 31
PC 0.007 110 0.007 115
Oracle
LDECC 0.003 25 0.004 25
LDP 0.003 43 0.003 50
LD3 0.003[0.002,0.003] 23.4[22.56,24.24] 0.003[0.003,0.003] 27.2[26.56,27.84]
PC 0.032[0.03,0.034] 67.1[63.31,70.89] 0.033[0.031,0.035] 70.5[66.79,74.21]
n=2.5k
LDECC 0.024[0.016,0.033] 35.5[23.78,47.22] 0.018[0.013,0.023] 35.5[23.78,47.22]
LDP 0.003[0.003,0.003] 27.6[24.41,30.79] 0.003[0.003,0.003] 31.0[27.94,34.06]
LD3 0.004[0.003,0.004] 22.9[21.96,23.84] 0.004[0.003,0.004] 26.6[26.0,27.2]
PC 0.056[0.054,0.057] 73.6[72.02,75.18] 0.058[0.057,0.06] 77.1[75.29,78.91]
n=5k
LDECC 0.049[0.044,0.054] 63.5[56.21,70.79] 0.047[0.042,0.053] 63.5[56.21,70.79]
LDP 0.073[0.056,0.091] 214.4[175.9,252.9] 0.039[0.033,0.044] 192.0[167.74,216.26]
LD3 0.004[0.004,0.004] 22.0[22.0,22.0] 0.005[0.005,0.005] 26.6[26.0,27.2]
PC 0.100[0.097,0.103] 77.4[75.9,78.9] 0.105[0.102,0.109] 82.3[80.38,84.22]
n=10k
LDECC 0.096[0.083,0.109] 67.1[65.34,68.86] 0.087[0.084,0.09] 67.1[65.34,68.86]
LDP 0.073[0.056,0.091] 214.4[175.9,252.9] 0.039[0.033,0.044] 192.0[167.74,216.26]
TableE.2: Totalnumberofindependencetestsperformaedandruntimesinseconds(95%confidence
intervalsinbrackets).
23SACHSPROTEINEXPRESSION
SDC=1:ERK→AKT SDC=0:JNK̸→P38
F1 Prec Rec F1 Prec Rec
LD3 1.00 1.00 1.00 1.00 1.00 1.00
Oracle
PC∪ 1.00 1.00 1.00 1.00 1.00 1.00
PC∩ 0.00 0.00 0.00 0.00 0.00 0.00
LDECC∪ 1.00 1.00 1.00 1.00 1.00 1.00
LDECC∩ 0.00 0.00 0.00 0.00 0.00 0.00
LDPpa 1.00 1.00 1.00 1.00 1.00 1.00
LDP 0.29 0.16 1.00 0.50 0.33 1.00
LD3 0.97[0.90,1.00] 0.95[0.85,1.00] 1.00[1.00,1.00] 0.96[0.91,1.00] 0.93[0.85,1.00] 1.00[1.00,1.00]
n=5k
PC∪ 0.00[0.00,0.00] 0.00[0.00,0.00] 0.00[0.00,0.00] 0.77[0.51,1.00] 0.80[0.54,1.00] 0.75[0.49,1.00]
PC∩ 0.00[0.00,0.00] 0.00[0.00,0.00] 0.00[0.00,0.00] 0.73[0.48,0.99] 0.80[0.54,1.00] 0.70[0.44,0.96]
LDECC∪ 1.00[1.00,1.00] 1.00[1.00,1.00] 1.00[1.00,1.00] 1.00[1.00,1.00] 1.00[1.00,1.00] 1.00[1.00,1.00]
LDECC∩ 0.10[-0.1,0.30] 0.10[-0.1,0.30] 0.10[-0.1,0.30] 0.10[-0.1,0.30] 0.10[-0.1,0.30] 0.10[-0.1,0.30]
LDPpa 0.93[0.85,1.02] 0.90[0.77,1.00] 1.00[1.00,1.00] 0.96[0.91,1.00] 0.93[0.85,1.00] 1.00[1.00,1.00]
LDP 0.29[0.29,0.29] 0.17[0.17,0.17] 1.00[1.00,1.00] 0.50[0.50,0.50] 0.33[0.33,0.33] 1.00[1.00,1.00]
LD3 1.00[1.00,1.00] 1.00[1.00,1.00] 1.00[1.00,1.00] 1.00[1.00,1.00] 1.00[1.00,1.00] 1.00[1.00,1.00]
n=10k
PC∪ 0.50[0.17,0.83] 0.50[0.17,0.83] 0.50[0.17,0.83] 1.00[1.00,1.00] 1.00[1.00,1.00] 1.00[1.00,1.00]
PC∩ 0.00[0.00,0.00] 0.00[0.00,0.00] 0.00[0.00,0.00] 0.47[0.16,0.78] 0.50[0.17,0.83] 0.45[0.14,0.76]
LDECC∪ 1.00[1.00,1.00] 1.00[1.00,1.00] 1.00[1.00,1.00] 1.00[1.00,1.00] 1.00[1.00,1.00] 1.00[1.00,1.00]
LDECC∩ 0.10[-0.1,0.30] 0.10[-0.1,0.30] 0.10[-0.1,0.30] 0.30[0.00,0.60] 0.30[0.00,0.60] 0.30[0.00,0.60]
LDPpa 1.00[1.00,1.00] 1.00[1.00,1.00] 1.00[1.00,1.00] 1.00[1.00,1.00] 1.00[1.00,1.00] 1.00[1.00,1.00]
LDP 0.29[0.29,0.29] 0.17[0.17,0.17] 1.00[1.00,1.00] 0.50[0.50,0.50] 0.33[0.33,0.33] 1.00[1.00,1.00]
LD3 0.97[0.90,1.00] 0.95[0.85,1.00] 1.00[1.00,1.00] 1.00[1.00,1.00] 1.00[1.00,1.00] 1.00[1.00,1.00]
n=20k
PC∪ 0.90[0.70,1.00] 0.90[0.70,1.00] 0.90[0.70,1.00] 1.00[1.00,1.00] 1.00[1.00,1.00] 1.00[1.00,1.00]
PC∩ 0.00[0.00,0.00] 0.00[0.00,0.00] 0.00[0.00,0.00] 0.10[-0.1,0.30] 0.10[-0.1,0.30] 0.10[-0.1,0.30]
LDECC∪ 1.00[1.00,1.00] 1.00[1.00,1.00] 1.00[1.00,1.00] 1.00[1.00,1.00] 1.00[1.00,1.00] 1.00[1.00,1.00]
LDECC∩ 0.00[0.00,0.00] 0.00[0.00,0.00] 0.00[0.00,0.00] 0.00[0.00,0.00] 0.00[0.00,0.00] 0.00[0.00,0.00]
LDPpa 0.97[0.90,1.00] 0.95[0.85,1.00] 1.00[1.00,1.00] 1.00[1.00,1.00] 1.00[1.00,1.00] 1.00[1.00,1.00]
LDP 0.29[0.29,0.29] 0.17[0.17,0.17] 1.00[1.00,1.00] 0.50[0.50,0.50] 0.33[0.33,0.33] 1.00[1.00,1.00]
TableE.3: PerformanceontheSACHSproteindataset[74]frombnlearn[76]. Discretedatawere
evaluatedwithχ2independencetests(α=0.001;95%confidenceintervalsinbrackets).
SACHSPROTEINEXPRESSION
SDC=1:ERK→AKT SDC=0:JNK̸→P38
Time Tests Time Tests
LD3 0.013 37 0.013 37
PC 0.077 740 0.079 740
Oracle
LDECC 0.079 653 0.081 646
LDP 0.017 46 0.017 52
LD3 0.005[0.005,0.006] 37.0[37.0,37.0] 0.005[0.005,0.005] 37.0[37.0,37.0]
PC 0.738[0.729,0.747] 715.4[708.08,722.72] 0.757[0.741,0.773] 715.4[708.08,722.72]
n=5k
LDECC 0.699[0.688,0.709] 640.6[638.15,643.05] 0.657[0.596,0.718] 604.7[550.92,658.48]
LDP 0.006[0.006,0.006] 47.2[45.63,48.77] 0.009[0.004,0.015] 52.4[51.88,52.92]
LD3 0.007[0.007,0.007] 37.0[37.0,37.0] 0.007[0.006,0.007] 37.0[37.0,37.0]
PC 1.388[1.374,1.402] 730.4[726.86,733.94] 1.394[1.384,1.405] 730.4[726.86,733.94]
n=10k
LDECC 1.199[1.045,1.353] 605.1[528.14,682.06] 1.041[0.83,1.253] 536.7[428.01,645.39]
LDP 0.008[0.008,0.008] 46.0[46.0,46.0] 0.008[0.008,0.009] 52.0[52.0,52.0]
LD3 0.011[0.011,0.011] 37.0[37.0,37.0] 0.011[0.01,0.011] 37.0[37.0,37.0]
PC 2.718[2.689,2.746] 733.6[732.19,735.01] 2.72[2.676,2.763] 733.6[732.19,735.01]
n=20k
LDECC 2.5[2.451,2.549] 647.4[644.05,650.75] 2.472[2.438,2.506] 644.4[641.0,647.8]
LDP 0.012[0.012,0.013] 46.6[45.42,47.78] 0.013[0.013,0.013] 52.0[52.0,52.0]
TableE.4: Totalnumberofindependencetestsandruntimes(95%confidenceintervalsinbrackets).
24UNOSPOLICY(2017–2019) UNOSPOLICY(2020–2022)
PC(α=0.01) PC(α=0.05) PC(α=0.01) PC(α=0.05)
A education, recipient None activeexceptioncase, activeexceptioncase,
DE
bloodtype intial MELD, recipi- initial age, recipient
entbloodtype bloodtype,region
SDC 1 1 1 1
WCDE 0.046[0.03,0.063] 0.049[0.033,0.066] 0.037[0.023,0.050] 0.028[0.015,0.041]
p-value 0.000 0.000 0.000 0.000
TableE.5:SDCassessmentandweightedCDEestimationwithdoublemachinelearningusingresults
fromPCAlgorithm[84],asimplementedbyKalisch&Buhlmann[38]. WedefineA usingthe
DE
unionmethod(PC ;AppendixD),thoughresultsforA wereexactlythesameusingPC .
∪ DE ∩
UNOSPOLICY(2017–2019) UNOSPOLICY(2020–2022)
LDECC(α=0.01) LDECC(α=0.05) LDECC(α=0.01) LDECC(α=0.05)
A paymentmethod payment method, re- activeexceptioncase, diagnosis, recipient
DE
gion diagnosis, initial bloodtype,region
MELD, initial age,
recipientbloodtype
SDC 1 1 1 1
WCDE 0.049[0.032,0.065] 0.048[0.032,0.064] 0.032[0.019,0.046] 0.032[0.017,0.048]
p-value 0.000 0.000 0.000 0.000
TableE.6:SDCassessmentandweightedCDEestimationwithdoublemachinelearningusingresults
from LDECC using the union method for selection A (LDECC ; Appendix D) [31]. Results
DE ∪
forA werealmostconcordantusingLDECC ,withtheexceptionof2020-2022whenα=0.05
DE ∩
(wheretheintersectionmethodexcludeddiagnosis).
LD3 LDECC PC RATIOPC/LD3 RATIOLDECC/LD3
Policy α Time Tests Time Tests Time Tests Time Tests Time Tests
0.01 0.100 75 20.304 3303 237.324 35943 2373.24 479.24 203.04 44.04
2017-2019
0.05 0.101 75 19.947 3188 231.844 36512 2295.48 486.83 197.50 42.51
0.01 0.107 75 47.402 6959 465.278 63225 4348.39 843.00 443.01 92.79
2020-2022
0.05 0.090 71 519.707 69926 528.372 72517 5870.80 1021.37 5774.52 984.87
TableE.7: TotalnumberofindependencetestsperformedandruntimesinsecondsforLD3vsPC
[38]andLDECC[31]onthelivertransplantallocationdataset. WhilePCisworst-caseexponential
intimecomplexity[84],LDECCisworst-caseexponentialforsomestructuresandpolynomialfor
others[31]. ThiscouldexplainthewidevariationinLDECCruntimesacrossexperimentalsettings.
F LiverFairness
Additional Background The US liver transplant system has seen several key policy changes
designedtooptimizeorgandistributionandimprovepatientoutcomes. In2002,themodelforend-
stageliverdisease(MELD)wasadoptedtodeterminepatients’priorityforlivertransplantsbasedon
theseverityoftheirillness[51]. InJune2013,UNOSimplementedtheShare35policytorequirethat
theregionalsharingofliversforpatientswithaMELDscoreof≥35prioritizesthelocalsharingof
liverstolessseverepatientswithaMELDscoreof<35[94]. InJanuary2016,theMELD-sodium
(i.e. MELD-Na)scorewentintoeffecttoimprovetheoriginalMELDbyincorporatingserumsodium
levelsintothecalculation[88]. InFebruary2020,theacuity-circle(AC)policyfordistributinglivers
replacedthelongstandingdonationserviceareabasedpolicy[86]. TheACpolicyusesaseriesof
concentriccircles,centeredonthedonorhospital,todeterminethedistributionrangeforavailable
livers. InJuly2023,thecalculationformulaforMELDwasupdatedtoincludeadditionalvariables
includingfemalesexandserumalbumin[87]. Thenewmodel,knownasMELD3.0,wasexpectedto
furtherrefinethesortingoftransplantcandidatesbasedontheirmedicalurgencyfortransplant[41].
25FeatureSelection Weusethefollowingfeaturesinthecasestudy. Exceptfortheliverallocation
outcome,allfeaturesaredeterminedattimeofregistrationorlisting. Thus(A1)holds. Thesefeatures
includeallthepossibleparentstotheliverallocationoutcomeavailableintheOPTNdataset,thus
satisfying(A2). Fortimeperiod2017-2019, totalobservationsisn = 21,101patients. Fortime
period2020-2022,totalobservationsisn = 22,807patients. Below,weprovidethedefinitionof
eachvariableincludedinourcausalfairnessanalysis. SummarystatisticsarereportedinTableF.1.
1. Sex(exposure,protectedattribute): Recipientsex.
2. Liverallocation(outcome): Didthecandidatereceivealivertransplant?
3. Recipientbloodtype: Recipientbloodgroupatregistration.
4. Initialage: Ageinyearsattimeoflisting.
5. Ethnicity: Recipientethnicitycategory.
6. Hispanic/Latino: IstherecipientHispanic/Latino?
7. Education: Recipienthighesteducationallevelatregistration.
8. InitialMELD:InitialwaitinglistMELD/PELDlabscore.
9. Activeexceptioncase: Wasthisanactiveexceptioncase?
10. Exceptiontype: Typeofexceptionrelativetohepatocellularcarcinoma(HCC).
11. Diagnosis: Primarydiagnosisattimeoflisting.
12. Initialstatus: Initialwaitingliststatuscode.
13. Numberofprevioustransplants: Numberofpriortransplantsthattherecipientreceived.
14. Weight: Recipientweight(kg)atregistration.
15. Height: Recipientheightatregistration.
16. BMI:Recipientbodymassindex(BMI)atlisting.
17. Paymentmethod: Recipientprimaryprojectedpaymenttypeatregistration.
18. Region: WaitlistUNOS/OPTNregionwhererecipientwaslistedortransplanted.
UNOSPOLICY(2017-2019)
Female(n=7679) Male(n=13422) p-value Test
Activeexceptioncase 0.36(0.73) 0.48(0.83) 7.241e-28 t-test
Diagnosis1(PSC:PrimarySclerosingCholangitis) 0.03(0.18) 0.04(0.2) 0.037 χ2
Diagnosis6(AHF:acutehepaticfailure) 0.06(0.23) 0.02(0.15) 0.004 χ2
Diagnosis7(Cancer) 0.09(0.28) 0.16(0.37) 0.010 χ2
Height 161.9(7.46) 175.91(8.51) 0.000 t-test
InitialMELD 20.5(10.21) 18.83(9.87) 1.588e-31 t-test
Paymentmethod 0.53(0.5) 0.54(0.5) 0.012 χ2
Recipientage 54.46(12.42) 56.03(10.74) 4.091e-22 t-test
Weight 75.97(18.53) 90.63(19.59) 0.000 t-test
UNOSPOLICY(2020-2022)
Female(n=8574) Male(n=14233) p-value Test
Activeexceptioncase 0.39(0.58) 0.43(0.63) 3.629e-07 t-test
Ethnicity9(Multiracial,non-hispanic) 0.01(0.08) 0.0(0.07) 0.022 Fisher’sexact
Exceptiontype1(Unknown) 0.29(0.45) 0.28(0.45) 0.022 χ2
Height 161.96(7.8) 176.36(8.25) 0.000 t-test
InitialMELD 22.13(10.52) 20.99(10.48) 1.862e-15 t-test
Initialstatus 0.04(0.2) 0.02(0.12) 2.858e-31 t-test
Recipientage 53.83(12.75) 54.74(11.64) 3.059e-08 t-test
Weight 75.76(18.71) 91.1(20.32) 0.000 t-test
TableF.1: Meanvalues(standarddeviations)forfeatureswithstatisticallysignificantdifferences
betweenmalesandfemales(α=0.05). SummarystatisticsforallfeaturesareavailableonGitHub
(https://anonymous.4open.science/r/LD3-4440).
26
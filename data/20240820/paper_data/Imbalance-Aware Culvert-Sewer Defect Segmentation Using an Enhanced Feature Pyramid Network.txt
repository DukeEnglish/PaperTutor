JOURNALOFLATEXCLASSFILES,VOL.14,NO.8,AUGUST2024 1
Imbalance-Aware Culvert-Sewer Defect
Segmentation Using an Enhanced Feature
Pyramid Network
Rasha Alshawi∗, Md Meftahul Ferdaus∗, Mahdi Abdelguerfi∗, Kendall Niles†, Ken Pathak†, Steve Sloan†
∗University of New Orleans, New Orleans, Louisiana, USA †US Army Corps of Engineers, Vicksburg,
Mississippi, USA Emails: {rralshaw, mferdaus, gulfsceiDirector}@uno.edu, {Kendall.N.Niles, ken.pathak,
steven.d.sloan}@erdc.dren.mil
Abstract—Imbalanced datasets are a significant challenge in and subtle appearance of many defects complicate the task,
real-world scenarios. They lead to models that underperform requiring models to capture fine details while understanding
on underrepresented classes, which is a critical issue in infras-
the overall pipe structure [7], [8]. Factors such as diverse
tructureinspection.ThispaperintroducestheEnhancedFeature
appearances, occlusions from vegetation or debris, and in-
PyramidNetwork(E-FPN),adeeplearningmodelfortheseman-
tic segmentation of culverts and sewer pipes within imbalanced consistent lighting conditions can significantly impact the
datasets. The E-FPN incorporates architectural innovations like performance of current segmentation models [9]–[13].
sparselyconnectedblocksanddepth-wiseseparableconvolutions Moreover, the scarcity of publicly available datasets for
to improve feature extraction and handle object variations.
culvertandsewerpipeinspectioncomplicatesthedevelopment
To address dataset imbalance, the model employs strategies
and testing of effective models. This limits the ability to
like class decomposition and data augmentation. Experimental
results on the culvert-sewer defects dataset and a benchmark train models that can generalize well to the wide variety of
aerial semantic segmentation drone dataset show that the E- conditions encountered in real-world conditions.
FPN outperforms state-of-the-art methods, achieving an average
Our study involved collecting a specialized dataset for
IntersectionoverUnion(IoU)improvementof13.8%and27.2%,
culvert and sewer pipe inspection in response to this gap.
respectively.Additionally,classdecompositionanddataaugmen-
tationtogetherboostthemodel’sperformancebyapproximately The dataset revealed a significant imbalance in defect types,
6.9% IoU. The proposed E-FPN presents a promising solution withcommondefectslikecracksorjointmisalignmentsbeing
for enhancing object segmentation in challenging, multi-class overrepresented, while rarer but critical defects, such as holes
real-worlddatasets,withpotentialapplicationsextendingbeyond
orcollapses,areunderrepresented.Thisimbalancecanleadto
culvert-sewer defect detection.
models that perform well on frequent issues but struggle with
Index Terms—Imbalanced Datasets, Semantic Segmentation, less common, yet critical, structural problems [14].
Enhanced Feature Pyramid Network (E-FPN), Infrastructure
Addressing these challenges is crucial for developing re-
Inspection.
liable automated systems for infrastructure inspection and
maintenance.Effectivesegmentationenablesprecisedetection
I. INTRODUCTION of deficiencies, ensuring timely repairs.
COMPUTER vision has transformed industries by allow- Deep learning models like U-Net [15], Feature Pyramid
ing machines to analyze visual data. A key aspect of Network(FPN)[16],andVisionTransformers(ViT)[17],[18]
this technology is semantic segmentation, which classifies havebeenusedforsemanticsegmentationtasks.Thesemodels
individual image pixels into predefined categories [1], [2]. have shown promising results in general segmentation tasks
This capability is vital for infrastructure maintenance, par- butstrugglewithchallengesposedbyculvertsandsewerpipes.
ticularly in identifying structural elements like culverts and For example, U-Net and FPN may lack robustness to handle
sewer pipes. Culverts and sewer pipes are essential water appearance variability, while ViTs, although powerful, can be
management structures [3], [4] that need regular inspection computationallyexpensiveandrequireextensivetrainingdata.
for damage like cracks, holes, and encrustation. Traditional Recentadvancesindeeplearningshowpromiseinovercom-
inspectionmethods,likevideopipeinspection,relyonmanual ing these challenges, particularly in improving FPNs [19]–
reviewoffootage,whichistime-consumingandsusceptibleto [23]. FPNs use a hierarchical pyramid of feature maps to
humanerror[5].Automatedsemanticsegmentationtechniques captureinformationatmultiplescales,improvingthedetection
can enhance inspection accuracy and efficiency. Advanced of large pipe features and small defects in culvert and sewer
computervisionalgorithmsenabletimelydeficiencydetection systems.Thismulti-scaleapproachiscrucialforinfrastructure
and repair, improving infrastructure integrity and longevity. inspection, where various feature scales must be accurately
Segmenting culverts and sewer pipes is challenging due identified.However,whileFPNsaddressthemulti-scaleissue,
to their varying shapes, sizes, and environmental conditions. theydonotinherentlyresolvetheclassimbalanceinreal-world
Despite advancements in semantic segmentation, accurately inspection data.
identifying these structures is difficult [6]. The small size Comprehensivesolutionsformanagingobjectvariationsand
4202
guA
91
]VC.sc[
1v18101.8042:viXraJOURNALOFLATEXCLASSFILES,VOL.14,NO.8,AUGUST2024 2
addressing data imbalance in defect detection are needed. The paper is structured as follows: Section II reviews the
This involves adapting existing architectures for underground evolution of semantic segmentation techniques, focusing on
infrastructure inspections, developing new loss functions for the development of FPN and its applications. Section III
class imbalance, and implementing advanced data augmenta- details our methodology, including the design and imple-
tion techniques to represent underrepresented defect classes. mentation of our proposed E-FPN architecture. Section IV
These innovations are crucial for creating robust, reliable presentstheCulvert-SewerDefectsdatasetandthebenchmark
automatedinspectionsystemsforculvertsandsewers,leading Aerial Semantic Segmentation Drone dataset used to evaluate
to more efficient maintenance and improved infrastructure the model’s performance. Section V discusses techniques for
health assessment [24]–[26]. balancing the dataset. Section VI outlines the implementation
In this paper, we introduce an enhanced FPN (E-FPN), a steps and metrics. Section VII provides an analysis of our
novel architecture for semantic segmentation in imbalanced experimentalresultsandcomparativeevaluationsagainststate-
culvertandsewerdatasets.TheE-FPNbuildsonthetraditional of-the-art methods. Finally, Section VIII concludes the paper
FPN by incorporating enhancements to better handle object with a summary of our contributions and potential future
variations and improve feature extraction, addressing both the research directions in infrastructure maintenance and safety.
multi-scale challenges and the issue of class imbalance in
underground infrastructure inspection. Our work makes two II. RELATEDWORK
key contributions: Semantic segmentation has significantly advanced with the
• A customized E-FPN architecture for semantic segmen- development of deep learning techniques. This section pro-
tationofculvertsandsewerpipesinimbalanceddatasets: vides a comprehensive review of these advancements, with a
particular focus on FPNs and their applications in infrastruc-
1) We introduce a sparsely connected block for effi-
ture inspection, especially for culverts and sewer pipes.
cient information flow.
2) We use depth-wise separable convolutions to re-
A. Evolution of Semantic Segmentation Techniques
duceparameterswithoutsacrificingrepresentational
power. Semantic segmentation has progressed from early methods
based on hand-crafted features and conventional classifiers
These architectural innovations reduce computational
[27], [28] to more advanced deep learning approaches. The
complexity while maintaining, and often improving, seg-
advent of Convolutional Neural Networks (CNNs) marked
mentation performance.
a transformative shift, enabling more effective pixel-wise
• Exploring and validating techniques to mitigate data
classification. A key milestone in this evolution was the
imbalance and enhance model performance:
introduction of Fully Convolutional Networks (FCNs) [29],
1) We implemented class decomposition by partition-
[30], which facilitated dense predictions over arbitrary-sized
ing the dataset into smaller, more homogeneous
inputs and laid the groundwork for subsequent semantic
groups based on defect characteristics and sample
segmentation architectures [31]. Among these advancements,
distribution. This strategy allowed the model to
encoder-decoder networks like U-Net [32], bottom-up top-
focus on learning features specific to each type
downnetworkssuchasFPNs[22],andViTsthatleverageself-
of defect more effectively. After training individual
attention mechanisms for capturing long-range dependencies
models on these smaller groups, we combined their
[33] have become prominent in addressing various segmenta-
predictions using ensemble learning techniques, en-
tion challenges.
abling the final model to leverage the strengths
In the following, we will highlight each of these network
of each sub-model. This approach enhanced the
types in detail:
overall prediction accuracy, particularly for under-
1) Encoder-Decoder Architectures and U-Net Variants:
represented classes.
Encoder-decoder architectures, particularly U-Net [32], have
2) We use data augmentation to expand and balance
significantly advanced the field of semantic segmentation.
the dataset, increasing diversity and ensuring fair
U-Net’s innovative use of skip connections enhances seg-
representation of defect classes during training.
mentation accuracy by effectively combining low-level and
Our analysis demonstrates the effectiveness of our methods high-level features, which has proven especially beneficial in
for detecting defects in culverts and sewer systems. We tested medical imaging.
our model on a diverse real-world dataset with nine classes Recent variants of U-Net have further refined its perfor-
of pipe images, varying in material, size, and orientation. To mance. For instance, Su et al. [34] integrated Convolutional
assess its versatility, we evaluated the model on a bench- BlockAttentionModules(CBAM)intoU-Net.Thismodifica-
mark aerial semantic segmentation drone dataset, presenting tionincorporatesChannelAttentionModules(CAM)andSpa-
unique challenges due to varying altitudes, perspectives, and tialAttentionModules(SAM),whichcollectivelyenhancethe
environmental conditions. The E-FPN model demonstrated network’s ability to focus on informative features and salient
exceptionalperformanceandadaptabilityacrossbothdatasets, spatialregions,improvingbothglobalsemanticunderstanding
showcasing its potential for addressing real-world semantic and local detail capture.
segmentation challenges beyond underground infrastructure Further advancements include the Attention Sparse Convo-
inspection. lutional U-Net (ASCU-Net) proposed by Tong et al. [35].JOURNALOFLATEXCLASSFILES,VOL.14,NO.8,AUGUST2024 3
ASCU-Net introduces a tripartite attention mechanism that applications like culvert and sewer pipe defect detection.
combines Attention Gates (AG), Spatial Attention Modules
(SAM), and Channel Attention Modules (CAM). This ap- B. Research gap and motivation
proachspecificallytargetsimportantstructuresandemphasizes
EDNs are effective at semantic segmentation but struggle
crucialspatialandchannel-wiseinformation,resultinginstate-
withvaryingobjectscales.FPNsexcelinhandlingmulti-scale
of-the-art segmentation accuracy across various domains.
objects but may not address class imbalance as effectively
2) FPNs and Multi-Scale Feature Representation: Bottom-
as EDNs. FPNs also present high model complexity. ViTs
up top-down networks, like FPN, have showcased their ver-
offer promising performance but come with their own set of
satility in object detection and semantic segmentation tasks.
drawbacks. They generally require substantial computational
FPN addresses the challenge of multi-scale feature extraction
resources and extensive training data, which can be challeng-
by constructing a hierarchical pyramid of feature maps with
ingwithsmallerdatasets.Additionally,ViTsmaystrugglewith
varying resolutions. By integrating contextual information at
fine-grained details and local features due to their lack of
different scales, FPN facilitates more robust and accurate
inherent inductive biases, which can hinder performance in
segmentation. Its utilization of both bottom-up and top-down
tasks that require high spatial resolution.
pathways allows for effective feature fusion across different
Ourculvert-sewerdefectdatasetpresentsuniquechallenges
levels of abstraction, making it well-suited for tasks with
due to its inherent characteristics, diversity, and class imbal-
significant variations in scale and orientation.
ance. Class imbalance adversely affects the performance of
FPN typically utilizes pretrained networks in the bottom-
EDNs and FPNs. An EDN that excels in precise localization
up pathway. Tsung-Yi Lin et al. [22] applied FPN to object
may struggle with diverse object scales, while an FPN might
detection, using a ResNet backbone to extract hierarchical
bebiasedtowardsoverrepresentedclasses,despiteitsabilityto
features from input images. The bottom-up pathway of the
handle scale variations. Similarly, while ViTs show promise,
FPN starts with a standard ResNet architecture pretrained
their high computational demands and potential difficulties
on the ImageNet dataset [36]. ResNet generates a hierar-
withfinedetailsmakethemlesssuitableforourspecificneeds.
chy of feature maps at various scales. These feature maps
Thechallengesinthisdomain,includingsmallstructuralde-
are then processed through the top-down pathway, where
fects,varyingpipematerialsandsizes,andhighlyimbalanced
higher-resolutionfeaturesareobtainedbyupsamplingspatially
defect classes, necessitate specialized approaches. Existing
coarserbutsemanticallystrongerfeaturemapsfromthehigher
solutions have made progress in semantic segmentation and
levels of the pyramid.
addressing data imbalance, but there is a gap in tailored
The integration of both bottom-up and top-down pathways
solutions for culvert and sewer inspection.
allows for effective feature fusion across different levels of
Given these limitations, directly applying existing EDN,
abstraction. This enables FPN to capture both global context
FPN, or ViT architectures is not ideal for our dataset. We
andfine-graineddetailsintheinputdata,makingitwell-suited
needtoexplorealternativeapproachesthatimproveobjectseg-
for tasks with significant variations in scale and orientation,
mentation and manage class imbalance without adding com-
such as semantic segmentation of complex scenes or, in our
putational overhead. Our work introduces an E-FPN designed
case, culvert and sewer pipe defect detection.
specifically for culvert and sewer defect segmentation. The E-
3) ViT: ViTs are a novel approach to image processing
FPN incorporates enhanced blocks with reduced complexity
that diverge from traditional convolutional neural networks.
for efficient multi-scale feature extraction and integrates ar-
Introduced by Dosovitskiy et al. [33], ViTs adapt the self-
chitectural improvements inspired by recent advancements in
attention mechanisms from natural language processing to
attentionmechanisms.Thisapproachaddressesthemulti-scale
handle visual data. This allows them to capture long-range
natureofdefectsandthechallengeofclassimbalance,aiming
dependencies and global context in images effectively. While
to develop a more robust and accurate segmentation model
ViTs excel at understanding overall image features, they are
tailored to underground infrastructure inspection.
computationally demanding and typically require extensive
datasets for optimal performance. The Swin Transformer [37]
III. PROPOSEDMETHOD:E-FPN
enhancestheViTmodelbyincorporatinghierarchicalfeatures
and local window-based attention. This design improves ef- This section introduces the E-FPN, our proposed archi-
ficiency and scalability, overcoming limitations of standard tecture for semantic segmentation in culvert and sewer pipe
ViTs. Using a shifted windowing scheme across multiple inspection. We describe the E-FPN’s structure and key in-
stages, Swin Transformer captures multi-scale features while novations, followed by a detailed ablation study. This study
maintainingcomputationalefficiency.Itshierarchicalstructure quantifies the impact of each architectural modification, sup-
effectively handles various object scales and feature reso- porting our design choices with empirical evidence. E-FPN
lutions, making it particularly suitable for complex tasks builds on the foundational principles of traditional FPNs,
like semantic segmentation. The Swin Transformer’s ability incorporatinginnovativeenhancementsdesignedtoaddressthe
to capture both local and global features, combined with specific difficulties encountered in this domain. The E-FPN is
its efficient handling of large-scale data, positions it as a structured around two core components:
promising architecture for infrastructure inspection tasks. Its 1) Bottom-up pathway: The bottom-up pathway forms
performance in segmentation tasks, including those involving the foundation of our E-FPN architecture, as illustrated
diverse and intricate features, suggests potential benefits for in the blue dotted block in Figure 1. This pathway isJOURNALOFLATEXCLASSFILES,VOL.14,NO.8,AUGUST2024 4
different scales and defect types.
Throughout the pathway, we used depth-wise separable
convolutions to reduce the parameter count without
compromising performance. The pathway begins with
64 filters and doubles after each max-pooling operation,
balancing network capacity with efficiency to capture
increasinglycomplexfeatureswhilemaintainingaman-
ageable parameter count.
2) Top-down pathway: The top-down pathway, shown
in the orange dotted block in Figure 1, enhances the
bottom-up process by upsampling and merging features
to create higher-resolution images. This maintains spa-
tial details and allows for accurate defect localization.
Fig. 1: E-FPN architecture: Dual-pathway design for multi- The pathway is designed using principles from deep
scale feature extraction. The bottom-up pathway filters and learning,computervision,andsignalprocessing,specif-
down-samples the input image by a factor of 2 at each layer ically for inspecting culverts and sewer pipes.
using enhanced Inception blocks with depth-wise separable Key aspects of the top-down pathway include:
convolutions. The top-down pathway employs upsampling
• Feature fusion: The pathway starts with a 1 × 1
and feature fusion to reconstruct a colored-masked image.
convolution on the final bottom-up layer to reduce
Numbers indicate feature map dimensions and channel depths
channel depth to 128. Each previous layer is up-
at each stage.
sampled by a factor of two and merged with the
corresponding bottom-up feature map. This fusion
low-level and high-level features, crucial for ac-
responsible for extracting multi-scale features from the
curate semantic segmentation. The 1×1 convolu-
inputimagethroughaseriesofconvolutionaloperations
tionreducesdimensionalitywhileretainingessential
and downsampling stages.
information, and the upsampling recovers spatial
To enhance the effectiveness of this pathway for detect-
details lost during downsampling.
ing defects in culverts and sewer systems, we imple-
• Aliasing mitigation: To preserve fine details and
mented several key design modifications. Specifically,
sharp transitions, a 3 × 3 depth-wise separable
wereplacedthestandardbottom-uppathwaylayerswith
convolutionisappliedtoallmergedlayers.Thisap-
a custom Inception-like block, highlighted in the green
proach mitigates aliasing effects during upsampling
dottedblockinFigure1.Thiscustomblockincorporates
and ensures high fidelity in the final segmentation
both 3 × 3 and 5 × 5 filters, along with a parallel
output. The 3×3 depth-wise separable convolution
max-pooling layer. The choice of these filter sizes was
acts as a learnable anti-aliasing filter, which effi-
motivated by the characteristics of culvert and sewer
ciently removes high-frequency artifacts.
imagery. The 3×3 filters capture fine-grained details
• Consistent output configuration:Acommonclas-
and textures crucial for identifying defects like hairline
sifier is shared across all output feature maps,
cracks or early-stage corrosion. These filters help detect
maintaining a 128-dimensional output channel con-
small-scale anomalies indicating structural issues. The
figuration. This uniform representation aids in the
larger5×5filtershelpcapturelarger-scaledefects,such
final segmentation task and ensures consistent de-
as joint misalignments and significant deformations,
fect recognition regardless of scale. This approach
by providing a wider receptive field. This allows the
promotes scale-invariant feature learning, which is
networktounderstandtheoverallstructureandcondition
critical for accurate defect detection across varying
of the pipe.
camera distances.
Additionally,weincorporatedtwoextraspatialdetection
• Efficient upsampling: Depth-wise separable con-
layers compared to traditional Inception blocks. These
volutions in the upsampling process ensure compu-
layersenhancethemodel’scapacitytolearnandlocalize
tational efficiency while generating high-resolution
complex features specific to culvert and sewer defects,
feature maps. This design principle, demonstrated
providing a more robust multi-scale feature representa-
byChollet[38]intheXceptionarchitecture,enables
tion. This is particularly valuable for detecting defects
detailed segmentation without significant computa-
of varying sizes and appearances, depending on the
tional overhead.
camera’s distance and angle.
Theadditionallayersimprovegradientflowduringback- The design of the top-down pathway integrates feature
propagation, leading to better learning of fine-grained fusionacrossabstractionlevels,improvingthenetwork’s
features essential for identifying structural anomalies. abilitytocaptureglobalcontextandfine-graineddetails.
This adaptation helps our custom Inception-like block This is useful for culvert and sewer inspections as it
effectively address the challenges of culvert and sewer facilitatesaccuratesemanticsegmentation.E-FPNoffers
defect detection, enabling more accurate analysis across arobustandefficientsolutionforsemanticsegmentationJOURNALOFLATEXCLASSFILES,VOL.14,NO.8,AUGUST2024 5
in these inspections by combining architectural innova- showed no significant performance improvement. This
tionswithdatabalancingstrategies(explainedinsection limited impact may be due to increased computational
V),ensuringaccuratesegmentationofcommonandrare demands or dataset characteristics that don’t fully lever-
defect types. age self-attention advantages. While promising in other
contexts, self-attention proved less effective for our spe-
cific segmentation task.
A. Progressive Enhancement of FPN Architectures: A Path to
• FPN with Squeeze-and-Excitation Blocks: The en-
E-FPN
hancedSqueeze-and-Excitation(SE)blockisanattention
This subsection provides a detailed examination of the mechanismthatimproveschannel-wisefeatureresponses
modifications made to the original FPN to enhance various through adaptive recalibration. It compresses feature
aspectsoffeatureextractionandrepresentation.Weconducted mapsintoachanneldescriptor,summarizingglobalinfor-
extensive experiments on the model, leading to the evolution mationforeachchannel.Thisdescriptorthenrecalibrates
of our proposed E-FPN. feature responses, emphasizing important features and
• Original FPN with ResNet Backbone: The baseline suppressing less relevant ones. By capturing channel in-
model uses the original FPN architecture with a ResNet terdependencies, SE blocks enhance the network’s focus
backbone. This model serves as the foundation for eval- on crucial features, improving overall performance [42].
uating subsequent modifications, establishing a reference We incorporated an enhanced version of SE blocks [43]
point for performance comparisons. into our feature extraction paths. This version includes
• FPN with Atrous Convolutions: We attempted to en- a learnable recalibration rate, further refining the dy-
hance the FPN architecture with atrous (dilated) con- namic recalibration process. The integration aimed to
volutions to expand the receptive field while maintain- improve information flow between bottom-up and top-
ing spatial resolution. Atrous convolutions insert gaps downpathways.TheseSEblocksdynamicallyrecalibrate
between kernel elements [39], enabling the model to channel-wisefeatureresponsesbasedonlearnedattention
capture broader context and preserve fine details without maps, significantly enhancing feature representation and
increasing computational complexity. Atrous convolu- segmentation accuracy. This improvement demonstrates
tions have improved semantic segmentation in models the effectiveness of enhanced SE blocks in refining fea-
like DeepLab [39] by enhancing multi-scale contextual ture extraction and producing more precise segmentation
understanding. However, our experiments did not show results.
significant performance gains from integrating atrous • FPN with Inception and Residual Blocks: Integrating
convolutionswithFPN.Thisunexpectedresultmaystem Inception blocks and residual connections into models
from compatibility issues between atrous convolutions architectures significantly enhances multi-scale feature
andFPN,orfromdataset-specificfactorsthatdidn’tfully extraction and supports the training of deeper networks
utilize the technique’s advantages. [44],[45].TheInceptionblockscapturefeaturesatmulti-
• FPN with Attention Gates: Attention gates (AGs) were plescalesconcurrently,whileresidualconnectionsallevi-
incorporated into the FPN to enhance feature prioritiza- ate gradient issues, leading to substantial improvements
tion. Introduced by Oktay et al. [40], AGs dynamically in performance and robustness. In this experiment, we
emphasize significant regions while suppressing less rel- replaced FPN botton-up and top-down pathways blocks
evantones.Thismechanismimprovesthemodel’sability with Inception block with residual connections. The new
to differentiate between important and trivial features, modelshows10%improvementovertheoriginalFPN.In
leading to better segmentation performance. AGs work thisexperiment,wereplacedthebottom-upandtop-down
by learning weights that adaptively highlight relevant pathway blocks in FPN with Inception blocks featuring
featuresinfeaturemaps,guidingthenetworktofocuson residualconnections.Thenewmodeldemonstrateda15%
informative areas and ignore noise. In our experiments, improvement over the original FPN.
integrating AGs into the network’s paths significantly • FPN with Factorized Inception Block: To reduce the
improved accuracy in identifying and segmenting critical complexity of the previous experiment, we used a factor-
features. The enhanced ability to highlight key regions ized Inception block, which optimizes by decomposing
andsuppresslessusefulinformationresultedinmorepre- large convolutions into smaller, more manageable opera-
cise segmentation, particularly in complex and cluttered tions [46]. This modification achieves a balanced trade-
scenes. This approach proved effective in improving the off between computational load and model performance,
FPN’sperformanceforsegmentingculvertandsewerpipe leading to notable improvements over the original FPN.
defects. • FPNwith5×5FactorizedConvolution:Theadditionof
• FPN with Self-Attention Mechanisms: We explored a5×5factorizedconvolutionwasaimedatenhancingthe
integratingself-attentionmechanismsintotheFPNarchi- model’s feature extraction capabilities by expanding the
tecture, inspired by Transformer models’ success [41]. receptivefield.Thisadjustmentsuccessfullyimprovedthe
Self-attention allows the network to prioritize relevant model’s ability to capture and process features, leading
inputparts,capturinglong-rangedependenciesandglobal to better overall performance. Both factorized versions
context. Despite its potential to enhance feature rela- of the Inception block improved network performance
tionships and contextual understanding, our experiments over the original FPN. However, using the unfactorizedJOURNALOFLATEXCLASSFILES,VOL.14,NO.8,AUGUST2024 6
Inception block yielded higher performance compared to
the factorized versions.
• FPN with Additional 1×1 Layer: Introducing an addi-
tional 1x1 layer to the convolutional block was designed
to further refine feature representation while maintaining
computational efficiency. This enhancement contributed
to improved feature extraction and model effectiveness,
offeringamorepreciseandnuancedanalysisoftheinput
data[47].However,ourexperimentsshowthataddingthe
additionallayertotheblockresultsinaperformancedrop
Fig. 2: Deficiency distribution in the Culvert-Sewer Defects
of at least 10%.
Dataset. The dataset exhibits significant imbalance, with sam-
• E-FPN (Proposed Model): From these experiments, ple counts ranging from 2,340 in the highest class to 104 in
we observed that incorporating multi-scale block, like
the lowest class.
Inception block, significantly improves the performance
ofFPNbutalsoincreasescomputationaloverhead.Based
on this observation, we developed our proposed E-FPN Intersection over Union (FWIoU) metric. The dataset encom-
model, which integrates an advanced multi-scale block passes a wide range of materials, shapes, and measurements
withreducedcomplexity,asdetailedinthesectionabove. found in culverts and sewer pipes, mirroring real-life inspec-
This study reveals that while several modifications to the tions. This diversity presents a challenge due to the need to
FPN architecture contributed to performance improvements, integrate data from various sources and structures.
the E-FPN model, with its combination of advanced features
TABLE I: Culvert-sewer inspection classes: Deficiency and
andoptimizations,offersthemostsubstantialgainsinaccuracy
corresponding class importance weights (CIW).
and robustness for semantic segmentation tasks, All these
results are detailed in Section VII-C. Deficiency CIW
Cracks 1.0000
Roots 1.0000
IV. DATASETS Holes 1.0000
JointProblems 0.6419
This section is divided into two subsections. Section IV-A
Deformation 0.1622
describes the creation of the Culvert-Sewer Defects dataset, Fracture 0.5100
while Section IV-B discusses the benchmark Aerial Semantic WaterLevel 0.0310
Encrustation/Deposits 0.3518
Segmentation Drone Dataset used to assess model’s accuracy.
LooseGasket 0.5419
A. Culvert-Sewer Defects Dataset 2) Pixel-Wise Annotation for Semantic Segmentation Task:
We compiled our dataset by partitioning each video into
Inthissubsection,wedetailtheacquisitionandpreprocess-
frames captured at intervals of 4 to 10 seconds at key
ing of source videos, which include various defect instances.
classification points within the culvert and sewer inspection
Wealsooutlinethepixel-wiseannotationstrategyemployedto
footage. During the manual annotation process, we referred
create precise ground truth masks for semantic segmentation,
to inspection reports to identify the location and type of
culminating in our dataset of 6,300 images. The process is
each deficiency, assigning pixel-wise annotations in specific
outlined as follows:
colors according to the US NASSCO’s Pipeline Assessment
1) Data Collection and Class Importance Weights: We
CertificationProgram(PACP)guidelines[48].Frameswithout
collected 580 annotated videos of underground infrastructure
any deficiencies were discarded.
inspections from two sources: the U.S. Army Corps of Engi-
Each annotation is timestamped to the exact second of the
neers (USACE) and an industry partner. These videos cover
video and linked to a specific deficiency class. Additionally,
culverts and sewer pipes and include a diverse range of real-
the pipe location for each annotation was recorded. The
world conditions, introducing variations in materials, shapes,
final dataset includes approximately 6,300 annotated frames,
dimensions, and imaging environments. This variety offers a
covering the nine deficiencies listed in Table I and illustrated
comprehensive representation of typical inspection scenarios.
in Figure 2.
Skilled technicians reported the majority of the videos,
As shown in the figure, our dataset exhibits a significant
identifying deficiencies in culverts or sewer pipes by type and
class imbalance, with certain deficiencies, such as cracks, be-
location. This precise reporting facilitated the identification
ing more prevalent than others, such as roots. This imbalance
and annotation process for our task. A professional civil
poses challenges for modeling and is a key aspect of the
engineerassignedimportanceweightstoeachdeficiencyclass,
dataset’s characteristics.
reflecting their economic and safety impacts based on U.S.
industrystandards.Theseweightswerenormalizedtoestablish
B. Aerial Semantic Segmentation Drone Dataset
priorities during the learning process, as shown in Table I.
These class importance weights (CIW) are used to measure The Aerial Semantic Segmentation Drone Dataset is de-
the severity of each deficiency using the Frequency Weighted signed to enhance the safety of autonomous drone flightJOURNALOFLATEXCLASSFILES,VOL.14,NO.8,AUGUST2024 7
and landing by providing detailed semantic annotations of aggregatingtheirpredictions,wecansignificantlyenhanceour
urbanscenes[49].Thisdatasetfeatureshigh-resolutionimages model’s robustness and generalization ability. This technique
captured from a bird’s eye view at altitudes ranging from 5 to helps mitigate individual model weaknesses and provides
30meters,witheachimagemeasuring6000x4000pixels.The a more reliable and stable performance, ultimately leading
datasetisdividedinto400imagestrainingsetand200images to more accurate and dependable results. We evaluate the
for testing. It includes pixel-accurate annotations across 22 enhanced model using the entire test dataset.Our experiments
classes, such as tree, grass, dirt, water, person, car, and show a significant improvement in model performance, vali-
obstacle. Additionally, the dataset offers high-resolution RGB dating the effectiveness of our approach in addressing dataset
images,fish-eyestereoimages,thermalimages,and3Dground imbalance and enhancing predictive accuracy. Detailed results
truth data for specific scenes. Although not officially labeled with these performance metrics are presented in Section VII.
as a benchmark, the dataset’s comprehensive annotations and
diverseimagetypesmakeitavaluableresourceforevaluating
semantic segmentation models. B. Data Augmentation and Sampling Techniques
Weemployedthischallengingdatasettodemonstratethero-
Data augmentation is a pivotal technique in deep learning
bustness and efficiency of our model, confirming its ability to
for improving model performance, particularly when dealing
generalize across different tasks and validate its effectiveness
with imbalanced datasets. By introducing variations and di-
in real-world applications.
versifications into the training data, data augmentation helps
modelsgeneralizebetterandbecomemorerobusttoreal-world
V. IMBALANCEHANDLINGTECHNIQUES scenarios [53]. The key augmentation methods used and their
TheCulvert-SewerDefectsdatasetexhibitssignificantclass impact on model training are outlined below:
imbalance,withsomedefecttypeshavingasubstantiallylarger
• Horizontal Flip: This technique involves flipping images
number of samples compared to others ranging from 2,340
horizontally, effectively doubling the dataset size while
samples for some classes to as few as 104 samples for others,
maintaining the original class distribution. It helps the
as shown in Figure 2. This imbalance poses a challenge for
model generalize better by providing mirrored versions
model training and may lead to biased predictions, especially
of images.
favoringtheoverrepresentedclasses.Insemanticsegmentation
• Gaussian Blur: Applying Gaussian blur introduces a
tasks, such imbalance can result in poor generalization and
smooth,blurredeffecttoimages.Thisreducesoverfitting
accuracy, particularly for minority classes [50]. We explore
to specific details and encourages the model to focus on
twotechniquestomitigatetheeffectofsuchimbalanceonthe
more generalized features, enhancing its robustness.
model’s performance: class decomposition and data augmen-
• Color Jittering: Color jittering involves randomly adjust-
tation.
ingthebrightness,contrast,saturation,andhueofimages.
Thisaddssignificantdiversitytothedatasetandhelpsthe
A. Class Decomposition and Ensemble Learning modellearnfeaturesthatareinvarianttocolorvariations,
improving its adaptability.
Class decomposition is used to address the imbalance issue
by breaking down the multi-class segmentation problem into • Shearing: Shearing applies a shear transformation to
images, distorting them along one axis. This introduces
smaller tasks. This involves splitting the dataset into groups
variability in object orientations, helping the model rec-
based on each class’ characteristics and sample distribution
ognize objects from different perspectives.
[51]. We organize the data into groups consisting of three
classes each, based on the deficiency type features and • Rotation:Rotatingimagesbyspecifiedanglesexposesthe
modeltovariousobjectorientations,aidingingeneraliza-
available samples. For instance, if two classes share similar
tion to unseen views and enhancing overall robustness.
characteristics, like crack and fracture, we assign them to
separate groups to prevent confusion during model training. • RandomNoise:Addingrandomvariationstopixelvalues
simulates real-world image noise. This technique im-
This simplifies the task for the models and improves their
proves the model’s robustness by exposing it to noisy
pattern-learning ability.
data, helping it perform better in diverse conditions.
We train our E-FPN model separately on smaller balanced
datasets. After training, we combine the predictions using • Random Crop: Randomly cropping portions of images
forcesthemodeltofocusondifferentregionsofinterest,
ensemble learning techniques.
enhancing its ability to localize objects and improve
Ensemble learning is a powerful approach where multiple
detection accuracy.
models are combined to enhance overall performance. This
method involves training several models, each of which may Thesetechniquesareappliedtoeachclassinthetrainingset
focusondifferentsubsetsofthedataorspecializeinparticular to ensure a balanced representation. Additionally, for classes
classes. The strength of ensemble learning lies in its ability to withmorethan2000samples,suchasthejointproblemsclass,
aggregate the diverse insights and predictions from these in- under-samplingisusedbyrandomlyremovingexcesssamples
dividualmodels,leadingtoimprovedaccuracyandrobustness to achieve a more balanced class distribution. This combined
[52]. approach of data augmentation and strategic sampling is
In our approach, ensemble learning plays a crucial role in crucial for improving model performance and generalization
leveragingthecollectiveknowledgefrommultiplemodels.By ability.JOURNALOFLATEXCLASSFILES,VOL.14,NO.8,AUGUST2024 8
Measures segmentation accuracy by comparing predicted and
ground-truth masks. 2. Frequency-Weighted IoU (FWIoU):
Accounts for class frequencies using CIW as explained in
IV-A1. 3. F1 Score: Balances precision and recall, useful for
imbalanced datasets. 4. Balanced Accuracy: Averages recall
across classes, effective for imbalanced datasets. 5. Matthews
CorrelationCoefficient(MCC):Assessesclassificationquality
in skewed datasets.
c) Training Procedures: Models are trained for 100
epochs on the Culvert-Sewer Defects dataset and the Aerial
Semantic Segmentation Drone Dataset. The datasets are split
into training (70%), validation (15%), and test (15%) subsets
to evaluate generalization performance. Baseline models are
also established and evaluated under the same conditions for
Fig. 3: Workflow for Mitigating Class Imbalance through comparison.
ClassDecompositionandDataAugmentationTechniques.The d) Hardware and Software: Training is conducted on
figure illustrates the process of applying class decomposition NVIDIAT4GPUsusingKeraswithTensorFlow,providingthe
to group similar classes and the targeted data augmentation to computational power and tools necessary for efficient model
balancethedataset.Modelstrainedonthesebalancedsamples training and evaluation.
have improved performance and generalization.
VII. RESULTS
We evaluated the effectiveness of E-FPN against state-of-
C. Combining Class Decomposition and Data Augmentation
the-art semantic segmentation architectures. Additionally, we
To enhance model performance, we integrate class decom- tested E-FPN on the Aerial Semantic Segmentation Drone
position and data augmentation techniques. Class decomposi- dataset to demonstrate its robustness and adaptability to di-
tionsimplifiesthemulti-classsegmentationproblembygroup- verse imagery types. This section is organized into three
ing classes with similar sample sizes into clusters. Despite subsections:SubsectionVII-Aprovidesacomprehensivecom-
this,minorimbalancesmaystillexistwithintheseclusters.To parison with state-of-the-art models, including quantitative
furtherenhancebalancewithineachcluster,weapplytargeted metrics and visualizations. It highlights E-FPN’s effectiveness
data augmentation techniques. After training the models on in addressing multi-scale feature representation across both
these more balanced clusters, we combine predictions using the Culvert-Sewer Defects and Aerial Semantic Segmentation
ensemble learning, as detailed in Section V-A. This combined Drone datasets. Subsection VII-B discusses the impact of
strategy ensures that each cluster benefits from diverse and data imbalance mitigation techniques on model performance,
balanced training examples, ultimately leading to improved detailing the effects of class decomposition and data augmen-
model performance and generalization. tation. Subsection VII-C presents a detailed ablation study,
Ouranalysisofthecombinedapproachshowsaremarkable analyzing the contribution of individual components and ar-
improvement in performance, demonstrating its effectiveness. chitectural modifications to E-FPN’s performance.
Figure 3 illustrates the workflow of class decomposition and
dataaugmentation,showingthestepsfromdatasetpreparation
A. Comparison with Baseline Architectures
to model evaluation.
To evaluate the efficiency of our proposed E-FPN, we
compared it with several state-of-the-art semantic segmenta-
VI. EXPERIMENTALSETUP
tionarchitectures,includingtheoriginalFPN,U-Net,CBAM-
In this section, we describe the methodologies and parame- enhancedU-Net,ASCU-Net,andSwinTransformer,asshown
tersusedfordeveloping,training,andevaluatingoursemantic in Table II.
segmentationmodel.Wecovertheoptimizationstrategies,loss The original FPN model used in our comparison was built
functions, evaluation metrics, and other key aspects of the on a ResNet backbone, pretrained on the ImageNet dataset to
implementation. leverage learned features, and then fine-tuned on our specific
a) Optimization and Loss Functions: For training our dataset. This fine-tuning process tailored the model to the
semantic segmentation models, we employ the Adam opti- characteristics and requirements of our dataset.
mizer with an initial learning rate of 0.001. Adam is chosen The Swin Transformer used in this experiment is inte-
foritsefficiencyinhandlingsparsegradientsanddynamically grated with the UPerNet framework for semantic segmenta-
adjusting learning rates. The loss function used is Categorical tion. Specifically, the ”upernet-Swin-small” model, which is
Cross-Entropy, which is effective for multi-class pixel classi- hostedonHuggingFace,combinestheSwinTransformerwith
fication tasks by minimizing the difference between predicted UPerNet’s components, including a Feature Pyramid Network
probabilities and ground-truth labels. (FPN)andaPyramidPoolingModule(PPM).Thisintegration
b) Evaluation Metrics: We evaluate model performance enhances the model’s ability to capture multi-scale features
using the following metrics: 1. Intersection over Union (IoU): and context for improved segmentation performance. TheJOURNALOFLATEXCLASSFILES,VOL.14,NO.8,AUGUST2024 9
Swin Transformer was pretrained on the ImageNet dataset,
providing it with general feature representations before being
fine-tuned for the semantic segmentation task.
We evaluated Swin Transformer models under two con-
ditions: with and without pretraining. In the non-pretrained
condition,themodelsweretrainedfromscratchonourdataset.
Fig.5:ComparativevalidationmetricsofE-FPNagainstbase-
This allowed us to evaluate the impact of pretraining on the
line and state-of-the-art models on the culvert-sewer defects
performance of both Swin models and the original FPN.
dataset: (a) Cross-entropy loss, (b) F1-score, and (c) IoU. The
TABLE II: Performance comparison of various models on proposedmodelinthebluecolorshowsthehighestvalidation
culvert-sewerdefectsdataset(w/bg:withbackground,w/obg: IoU and F1-score compared to the other models.
without background)
Model IOUw/bg IOUw/obg FWIoU F1 Bal.Acc MCC model consistently outperforms both the original U-Net and
FPNwithResNet(original) 0.69947 0.66575 0.69657 0.80610 0.81387 0.83922
U-Net 0.58559 0.53906 0.48980 0.69333 0.63078 0.40457 FPN across various metrics. Our model achieves an aver-
CBAMU-Net 0.60501 0.55889 0.67053 0.71269 0.67964 0.71296
ASCU-Net 0.70358 0.67021 0.71491 0.81161 0.79463 0.79451 age IoU improvement of 27.3% over these baseline models,
SwinTransformer 0.58130 0.53244 0.62829 0.66690 0.70790 0.69966
E-FPN(thispaper) 0.77187 0.74601 0.78073 0.86346 0.84264 0.85005 demonstrating its effectiveness and strong performance on
different datasets.
TABLE III: Performance Comparison of Various Models on
Aerial Semantic Segmentation Drone Dataset. w/bg: with
background, w/o bg: without background.
Model IOUw/bg IOUw/obg F1 Bal.Acc MCC
U-Net 0.56269 0.55617 0.63382 0.72782 0.62041
FPNwithResNet(original) 0.58375 0.57148 0.68216 0.73202 0.65047
E-FPN(thispaper) 0.72937 0.71645 0.75059 0.86504 0.76868
Fig. 4: Comparative segmentation results on the culvert-sewer
defects dataset are shown, with the first row illustrating pipe
deformation defects, the second row showing a crack, and the
third row illustrating joint misalignment: (a) Original images
(b) Ground truth (c) U-Net (d) CBAM U-Net (e) FPN with
ResNet (f) ASCU-Net (g) Swin Transformer, (h) E-FPN (this
paper)
Figure 4 presents a visual comparison of the models evalu-
atedinourstudy,highlightingtheirreconstructioncapabilities.
U-NetandCBAMU-Netshowlimitationsinaccuratelyrecon-
structing images. Although these models successfully identify
deficiencies, they struggle to fully represent the fine details, Fig. 6: Comparative segmentation results on the Aerial Se-
leading to incomplete reconstructions. In contrast, the Swin mantic Segmentation Drone Dataset are illustrated, featuring
model, which uses shifted window self-attention mechanisms, threesampleswithdifferenttypesoftrees,buildings,cars,and
exhibits visual artifacts in its outputs. These artifacts could otherclasses.Theresultsarepresentedasfollows:(a)Original
be due to the challenges in capturing complex details with images,(b)Groundtruth,(c)FPNwithResNet,(d)U-Net,and
the Swin model’s hierarchical attention approach. Our model, (e) The proposed E-FPN model.
however,demonstratessuperiorperformancebycapturingand
representing fine details more effectively, resulting in more Figure 6 illustrates that while there is a room for improve-
accurate and visually coherent reconstructions. This is quan- ment across all models, our proposed model stands out by
titatively demonstrated by an average IoU improvement of consistently exceeding the performance of baseline models.
13.8% over other models on the culvert-sewer defects dataset. Thisisevidentinvarioustestcasesfromthedataset,whereour
Figure 5 displays the validation graphs for these models on modelexcelsinaccurately classifyingandsegmentingdiverse
Culvert-Sewer Defects dataset. classes, including trees, grass, dirt, water, people, cars, and
In addition to our primary evaluations, we tested our pro- obstacles.Thiscomparisonemphasizesthesuperiorrobustness
posed model on the Aerial Semantic Segmentation Drone and effectiveness of our model in managing intricate segmen-
dataset.Forthiscomparison,wefocusedonthreebasemodels: tation challenges, outperforming both the original U-Net and
theoriginalU-Net,theoriginalFPN,andourproposedmodel. FPN models.
This allowed us to benchmark our model against established A standout feature of the comparative analysis is our
baseline architectures. As shown in Table III, our proposed model’s exceptional efficiency, achieved with a significantlyJOURNALOFLATEXCLASSFILES,VOL.14,NO.8,AUGUST2024 10
smaller parameter count compared to other architectures. Our particularly in challenging classes. For instance, class decom-
modelutilizesonly1.32millionparameters,resultinginreduc- position alone resulted in a 5.24% improvement in average
tions of approximately 19.40 times, 23.43 times, 23.57 times, IoU,whiledataaugmentationyieldeda3.66%increase.When
24.01 times, and 61.6 times compared to the original FPN, combined, these techniques produced a 6.97% enhancement,
U-Net, CBAM U-Net, ASCU-Net, and Swin Transformer, demonstrating their complementary effects.
respectively, as shown in Table IV. To further illustrate these findings, Figure 7 presents the
validation graphs of these techniques, showing comparative
TABLEIV:Comparisonofthenumberoftrainableparameters
metrics for cross-entropy loss, F1-score, and IoU. These visu-
in different models
alizations reinforce the quantitative results by highlighting the
Model NumberofTrainableParameters consistent performance gains achieved through data balancing
FPN[22] 25,698,557 strategies.
U-Net[32] 31,032,521
CBAMU-Net[34] 31,221,065
ASCU-Net[35] 31,841,202
SwinTransformer[37] 81,367,128
E-FPN (this paper) 1,324,660
B. ImpactofDataImbalanceMitigationTechniquesonModel
Fig. 7: Comparative validation metrics for E-FPN under vari-
Performance
ous data balancing techniques: (a) Cross-entropy loss, (b) F1-
In this subsection, we discuss the results of applying two
score, and (c) Intersection over Union (IoU). Results shown
data imbalance mitigation techniques: class decomposition
for the culvert-sewer defects dataset, with curves representing
and data augmentation. These techniques were employed to
mean values over 5-fold cross-validation.
enhance the model’s performance on imbalanced datasets,
withaspecificfocusonimprovementsobservedforindividual
E-FPN’s enhanced performance, coupled with class de-
classes. We begin by presenting the overall performance of
composition and data augmentation, shows great promise for
the proposed E-FPN model under different data balancing
advancing infrastructure inspection techniques. The model’s
techniques, as summarized in Table V. This table compares
6.97% IoU enhancement using both techniques demonstrates
the model’s performance across various metrics, including
their synergistic effect and the importance of addressing data
IoU with background, IoU without background, FWIoU, F1
imbalance in real-world applications, crucial in infrastructure
score, and balanced accuracy. These results provide a broad
maintenancetopreventcatastrophicfailures.Themodel’sgen-
overview of how each technique impacts the model’s general
eralizationacrossdiversescenariossuggestsitspotentialappli-
performance.
cabilityinvariousinfrastructureinspectioncontexts,shownby
its performance on the Aerial Semantic Segmentation Drone
TABLE V: Performance Comparison of E-FPN for Different
dataset. However, the computational overhead introduced by
Imbalance Mitigation Techniques
classdecompositionandvaryingeffectivenessofdataaugmen-
Model IOUw/bg IOUw/obg FWIoU F1 Bal.Acc MCC
E-FPNtrainedonthefulldataset 0.77187 0.74601 0.78073 0.86346 0.84264 0.85005 tationacrossdefecttypespresentchallengesfordeploymentin
E-FPNtrainedusingclassdecomposition 0.81236 0.79084 0.76147 0.89959 0.85980 0.86158
E-FPNtrainedusingdataaugmentation 0.80120 0.77938 0.86780 0.86271 0.87325 0.87380 resource-constrained environments, highlighting the need for
E-FPNtrainedusingdataaugmentationandclassdecomposition 0.82573 0.80731 0.78472 0.91548 0.89608 0.89222
efficient, adaptive techniques to optimize performance while
Following the overall comparison, we explore the class-
minimizing computational costs.
wise IoU scores to examine the specific impact on individual
classes, as shown in Table VI. This table highlights the
C. AblationStudy:ImpactofArchitecturalComponentsonE-
effectiveness of each technique in improving IoU scores for
FPN Performance
differentdefectclasses,withadetailedanalysisofthebenefits
of using class decomposition, data augmentation, and their We conducted comparative analyses to evaluate the evo-
combination. lution of our E-FPN. we focused on comparing different
architectures within the FPN family. We compared various
TABLEVI:Class-wiseIoUcomparisonofE-FPNfordifferent
modifications of FPN, including the proposed E-FPN, against
databalancingtechniques(CD:classdecomposition,DA:data
the baseline FPN model with a ResNet backbone. These vari-
augmentation).
ations encompassed FPN with atrous convolutions to enlarge
Class E-FPNIoU(FullDataset) E-FPNIoU(CD) E-FPNIoU(DA) E-FPNIoU(DA&CD) receptivefields,FPNwithAGsforenhancedfeatureselection,
Class0-Background 0.97882 0.98454 0.97575 0.99157
Class1-Crack 0.53762 0.62115 0.47168 0.62857 FPNincorporatingInceptionandresidualblocks,self-attention
Class2-Hole 0.95873 0.96988 0.96490 0.96985
Class3-Root 0.87741 0.85661 0.88980 0.90543 mechanismstocapturelong-rangedependencies,enhancedSE
Class4-Deformation 0.79313 0.77772 0.77328 0.82814
C Cl la as ss s5 6- -F Er na cc rt uu sr te ation 0 0. .5 76 26 85 19 7 0 0. .6 85 67 90 76 2 0 0. .6 81 92 19 62 9 0 0. .6 93 06 08 82 3 blocksforchannel-wiseattention,andversionswithfactorized
Class7-JointProblems 0.76837 0.77796 0.73421 0.78870
Class8-LooseGasket 0.73803 0.79659 0.89660 0.80766 convolutions for computational efficiency. Each variant was
Class9-Obstruction 0.76318 0.77401 0.76392 0.79980
AverageIoUw/bg 0.77187 0.81236 0.80120 0.82574 designed to address specific aspects of feature extraction
AverageIoUw/obg 0.74601 0.79084 0.77939 0.80731
and representation. This analysis provides insights into how
Theresultsshowthatapplyingbothclassdecompositionand architectural choices impact performance in culvert and sewer
dataaugmentationleadstothemostsignificantimprovements, defect segmentation. Table VII summarizes the results of theJOURNALOFLATEXCLASSFILES,VOL.14,NO.8,AUGUST2024 11
comparisons, presenting metrics including IoU, FWIoU, F1- Future research will focus on enhancing E-FPN’s capa-
Score, Balanced Accuracy, and MCC, for a detailed assess- bilities and applicability in real-world scenarios. Priorities
ment of each architecture’s strengths and limitations. include integrating temporal information from video streams
forreal-timedetection,exploringunsupervisedpre-trainingon
TABLEVII:PerformancecomparisonofvariousFPNversions
large-scale unlabeled data to enhance feature extraction and
onCulvert-SewerDefectsdataset(w/bg:withbackground,w/o
generalization, and investigating active learning strategies and
bg: without background)
physics-informed neural networks for rare defect detection
Model IOUw/bg IOUw/obg FWIoU F1 Bal.Acc MCC and domain knowledge incorporation. Efforts will be directed
FPNwithResNet(original) 0.69947 0.66575 0.69657 0.80610 0.81387 0.83922
FPNwithAtrousConvolutions 0.67904 0.64233 0.71527 0.79169 0.80171 0.81820 towards developing computationally efficient, adaptive tech-
FPNwithAttentionGates 0.75914 0.73176 0.77205 0.85471 0.81567 0.82716
FPNwithSelfAttention 0.64433 0.60399 0.67169 0.76452 0.71301 0.74522 niques for resource-constrained environments, and expanding
FPNwithEnhancedSqueezeandExcitationBlock 0.74834 0.71971 0.76321 0.84697 0.82925 0.83254
FPNwithInceptionandResidualBlock 0.74932 0.72081 0.76870 0.84705 0.82028 0.83331
FPNwithFactorizedInceptionBlock 0.71863 0.68662 0.74015 0.82435 0.78443 0.80874 the model’s applicability to diverse infrastructure inspection
FPNwith5x5FactorizedBlock 0.72878 0.69784 0.75432 0.80056 0.79095 0.81078
Adding1x1LayertotheBlock 0.68950 0.65404 0.73218 0.80359 0.79132 0.81690 contexts. These advancements aim to establish E-FPN as a
E-FPN(thispaper) 0.77187 0.74601 0.78073 0.86346 0.84264 0.85005
robust solution for automated infrastructure inspection, ad-
While some techniques, such as atrous convolutions and dressing challenges in data scarcity, computational efficiency,
self-attention mechanisms, caused a drop in model perfor- and critical defect detection.
mance, others led to significant improvements. Enhancements
like the enhanced SE blocks and Additive AGs resulted
ACKNOWLEDGMENTS
in noticeable performance gains compared to the original
FPN. Additionally, replacing the model’s layers with Incep- This research was partly supported by the U.S. Department
tion blocks that include residual connections yielded similar of the Army, U.S. Army Corps of Engineers (USACE) under
improvements. contract W912HZ-23-2-0004. The views expressed in this
However, factorized versions of the Inception block did article are solely those of the authors and do not necessarily
not provide the expected benefits. Adding extra layers to reflect the views of USACE.
these blocks also led to a performance drop. This outcome
is consistent with the effect of self-attention mechanisms, REFERENCES
highlighting that increasing model complexity can sometimes
[1] J.Hyun,H.Seong,S.Kim,andE.Kim,“Adjacentfeaturepropagation
negatively impact performance, particularly on our specific
network (AFPNet) for real-time semantic segmentation,” IEEE Trans-
Culvert-Sewer Defects dataset. actionsonSystems,Man,andCybernetics:Systems,vol.52,no.9,pp.
Consequently,wedevelopedtheE-FPNmodel,whichincor- 5877–5888,2021.
[2] X. Peng, J. Cheng, X. Tang, Z. Deng, W. Tu, and N. Xiong, “HSNet:
porates a multi-scale depth-wise separable block. This block
AnIntelligentHierarchicalSemantic-AwareNetworkSystemforReal-
combines the advantages of varying filter sizes, similar to the TimeSemanticSegmentation,”IEEETransactionsonSystems,Man,and
Inception block, while achieving a reduction in computational Cybernetics:Systems,2024.
[3] U.Iqbal,J.Barthelemy,P.Perez,J.Cooper,andW.Li,“Ascaledphys-
complexity by at least 7 times fewer FLOPs. The proposed
ical model study of culvert blockage exploring complex relationships
E-FPN model demonstrates a 10.35% improvement over the between influential factors,” Australasian Journal of Water Resources,
original FPN and approximately 3.1% improvement over the vol.27,no.1,pp.191–204,2023.
[4] N. Wang, D. Ma, X. Du, B. Li, D. Di, G. Pang, and Y. Duan,
FPN models with Inception and attention mechanisms.
“Anautomaticdefectclassificationandsegmentationmethodonthree-
dimensionalpointcloudsforsewerpipes,”TunnellingandUnderground
VIII. CONCLUSIONS SpaceTechnology,vol.143,p.105480,2024.
[5] C. Adams, M. Bias, R. M. Welsh, J. Webb, H. Reese, S. Delgado,
E-FPN is an innovative semantic segmentation architecture
J. Person, R. West, S. Shin, and A. Kirby, “The national wastewater
that enhances the traditional FPN framework. It incorporates surveillance system (NWSS): from inception to widespread coverage,
sparsely connected blocks and depth-wise separable convo- 2020–2022,UnitedStates,”ScienceofTheTotalEnvironment,vol.924,
p.171566,2024.
lutions to address data imbalance issues. The dual-pathway
[6] A.Kuchi,M.T.Hoque,M.Abdelguerfi,andM.C.Flanagin,“Levee-
design and efficient convolution operations improve perfor- crackdetectionfromsatelliteordroneimageryusingmachinelearning
manceonimbalanceddatasetswhileenhancingcomputational approaches,”inIGARSS2020-2020IEEEInternationalGeoscienceand
RemoteSensingSymposium. IEEE,2020,pp.976–979.
efficiency. E-FPN outperformed both traditional and state-
[7] Y. Li, H. Wang, L. Dang, H. Song, and H. Moon, “Attention-guided
of-the-art segmentation models when tested on our Culvert- multiscale neural network for defect detection in sewer pipelines,”
Sewer Defect dataset and a benchmark aerial drone dataset. Computer-AidedCivilandInfrastructureEngineering,vol.38,pp.2163–
2179,2023.
It achieved average IoU improvements of 13.8% and 27.2%
[8] C.Oh,L.Dang,D.Han,andH.Moon,“RobustSewerDefectDetection
respectively, surpassing FPN, U-Net, CBAM U-Net, ASCU- WithTextAnalysisBasedonDeepLearning,”IEEEAccess,vol.10,pp.
Net, and Swin Transformer. 46224–46237,2022.
[9] J. Yi, X. Zhong, W. Liu, Z. Wu, and Y. Deng, “Harmonizing Output
E-FPN demonstrated superior performance on imbalanced
Imbalance for semantic segmentation on extremely-imbalanced input
datasets with improved generalization. Class decomposition data,”ArXiv,vol.abs/2211.05295,2022.
and data augmentation increased IoU by 5.24% and 3.66% [10] M.Wang,H.Luo,andJ.C.P.Cheng,“Towardsanautomatedcondition
assessment framework of underground sewer pipes based on closed-
respectively, with a combined improvement of 6.9%. E-FPN
circuittelevision(CCTV)images,”TunnellingandUndergroundSpace
also achieved a 96.04% reduction in model parameters com- Technology,vol.110,p.103840,2021.
paredtootherevaluatedmodels,showcasingitsefficiencyand [11] Z. Xia, S. Guo, D. Sun, Y. Lv, H. Li, and G. Pan, “Structure-aware
dehazingofsewerinspectionimagesbasedonmonoculardepthcues,”
versatility for real-world applications without compromising
Computer-AidedCivilandInfrastructureEngineering,vol.38,pp.762–
performance. 778,2022.JOURNALOFLATEXCLASSFILES,VOL.14,NO.8,AUGUST2024 12
[12] M.He,Q.Zhao,H.Gao,andX.Zhang,“ImageSegmentationofaSewer [33] D.-K. Nguyen, M. Assran, U. Jain, M. R. Oswald, C. G. Snoek, and
BasedonDeepLearning,”Sustainability,vol.14,no.11,p.6634,2022. X. Chen, “An Image is Worth More Than 16x16 Patches: Exploring
[13] F.P.Rius,M.P.Philipsen,J.M.M.Tur,T.Moeslund,C.AnguloBaho´n, Transformers on Individual Pixels,” arXiv preprint arXiv:2406.09415,
andM.Casas,“AutoencodersforSemi-SupervisedWaterLevelModel- 2024.
inginSewerPipeswithSparseLabeledData,”Water,vol.14,no.3,p. [34] H. Su, X. Wang, T. Han, Z. Wang, Z. Zhao, and P. Zhang, “Research
333,2022. onaU-Netbridgecrackidentificationandfeature-calculationmethods
[14] Y.Li,J.Cao,Y.Xu,L.Zhu,andZ.Y.Dong,“Deeplearningbasedon basedonaCBAMattentionmechanism,”Buildings,vol.12,no.10,p.
Transformer architecture for power system short-term voltage stability 1561,2022.
assessment with class imbalance,” Renewable and Sustainable Energy [35] X.Tong,J.Wei,B.Sun,S.Su,Z.Zuo,andP.Wu,“ASCU-Net:attention
Reviews,vol.189,p.113913,2024. gate, spatial and channel attention u-net for skin lesion segmentation,”
[15] G.Fan,J.Wang,andC.Zhang,“SACA-UNet:MedicalImageSegmen- Diagnostics,vol.11,no.3,p.501,2021.
tationNetworkBasedonSelf-AttentionandASPP,”in2023IEEE36th [36] J.Deng,W.Dong,R.Socher,L.-J.Li,K.Li,andL.Fei-Fei,“Imagenet:
InternationalSymposiumonComputer-BasedMedicalSystems(CBMS), Alarge-scalehierarchicalimagedatabase,”in2009IEEEconferenceon
2023,pp.317–322. computervisionandpatternrecognition. Ieee,2009,pp.248–255.
[16] T. Panboonyuen, K. Jitkajornwanich, S. Lawawirojwong, [37] Z.Liu,Y.Lin,Y.Cao,H.Hu,Y.Wei,Z.Zhang,S.Lin,andB.Guo,
P. Srestasathiern, and P. Vateekul, “Transformer-Based Decoder “SwinTransformer:HierarchicalVisionTransformerusingShiftedWin-
Designs for Semantic Segmentation on Remotely Sensed Images,” dows,” in Proceedings of the IEEE/CVF International Conference on
Remote.Sens.,vol.13,p.5100,2021. ComputerVision(ICCV). Montreal,Canada:IEEE,2021,pp.10012–
[17] E.Bosco,F.Casula,M.Cotogni,C.Cusano,andG.Matrone,“DeepSe- 10022.
manticSegmentationofEchocardiographicImagesusingVisionTrans- [38] F.Chollet,“Xception:Deeplearningwithdepthwiseseparableconvolu-
formers,” in 2023 IEEE International Ultrasonics Symposium (IUS), tions,”inProceedingsoftheIEEEconferenceoncomputervisionand
2023,pp.1–4. patternrecognition,2017,pp.1251–1258.
[18] L.Chalcroft,R.L.Pereira,M.Brudfors,A.S.Kayser,M.D’Esposito, [39] L.-C.Chen,G.Papandreou,I.Kokkinos,K.Murphy,andA.L.Yuille,
C. J. Price, I. Pappas, and J. Ashburner, “Large-kernel Attention “Deeplab: Semantic image segmentation with deep convolutional nets,
for Efficient and Robust Brain Lesion Segmentation,” in ArXiv, vol. atrous convolution, and fully connected crfs,” IEEE transactions on
abs/2308.07251,2023. patternanalysisandmachineintelligence,vol.40,no.4,pp.834–848,
2017.
[19] Y. Wu, J. Jiang, Z. Huang, and Y. Tian, “FPANet: Feature pyramid
aggregation network for real-time semantic segmentation,” Applied In- [40] O.Oktay,J.Schlemper,L.L.Folgoc,M.Lee,M.Heinrich,K.Misawa,
telligence,vol.52,pp.3319–3336,2021. K. Mori, S. McDonagh, N. Y. Hammerla, B. Kainz et al., “Atten-
tion u-net: Learning where to look for the pancreas,” arXiv preprint
[20] V. T. Quyen, J. H. Lee, and M. Y. Kim, “Enhanced-feature pyramid
arXiv:1804.03999,2018.
network for semantic segmentation,” in 2023 International Conference
[41] A.U.Rahman,Y.Alsenani,A.Zafar,K.Ullah,K.Rabie,andT.Shon-
on ArtificialIntelligence in Information andCommunication (ICAIIC),
gwe, “Enhancing heart disease prediction using a self-attention-based
2023,pp.782–787.
transformermodel,”ScientificReports,vol.14,no.1,p.514,2024.
[21] S.Seferbekov,V.Iglovikov,A.Buslaev,andA.Shvets,“Featurepyramid
[42] G.Zhang,D.Choi,andJ.Jung,“Reconstructionofarterialbloodpres-
networkformulti-classlandsegmentation,”inProceedingsoftheIEEE
surewaveformsbasedonsqueeze-and-excitationnetworkmodelsusing
conferenceoncomputervisionandpatternrecognitionworkshops,2018,
electrocardiography and photoplethysmography signals,” Knowledge-
pp.272–275.
BasedSystems,vol.295,p.111798,2024.
[22] T.-Y.Lin,P.Dolla´r,R.Girshick,K.He,B.Hariharan,andS.Belongie,
[43] R. Alshawi, M. T. Hoque, M. M. Ferdaus, M. Abdelguerfi, K. Niles,
“Featurepyramidnetworksforobjectdetection,”inProceedingsofthe
K.Prathak,J.Tom,J.Klein,M.Mousa,andJ.J.Lopez,“DualAttention
IEEEconferenceoncomputervisionandpatternrecognition,2017,pp.
U-Net with Feature Infusion: Pushing the Boundaries of Multiclass
2117–2125.
DefectSegmentation,”arXivpreprintarXiv:2312.14053,2023.
[23] Z.Lu,Y.Bian,T.Yang,Q.Ge,andY.Wang,“Anewsiameseheteroge-
[44] D.Rastogi,P.Johri,V.Tiwari,andA.A.Elngar,“Multi-classclassifi-
neousconvolutionalneuralnetworksbasedonattentionmechanismand
cation of brain tumour magnetic resonance images using multi-branch
featurepyramid,”IEEETransactionsonCybernetics,vol.54,no.1,pp.
networkwithinceptionblockandfive-foldcrossvalidationdeeplearning
13–24,2023.
framework,” Biomedical Signal Processing and Control, vol. 88, p.
[24] Q. V. Toan and M. Y. Kim, “MPNet: Multiscale predictions based on
105602,2024.
featurepyramidnetworkforsemanticsegmentation,”in2023Fourteenth
[45] R.Anand,S.V.Lakshmi,D.Pandey,andB.K.Pandey,“Anenhanced
InternationalConferenceonUbiquitousandFutureNetworks(ICUFN),
ResNet-50deeplearningmodelforarrhythmiadetectionusingelectro-
2023,pp.114–119.
cardiogrambiomedicalindicators,”EvolvingSystems,vol.15,no.1,pp.
[25] X. Hu, L. Jing, and U. Sehar, “Joint pyramid attention network for
83–97,2024.
real-timesemanticsegmentationofurbanscenes,”AppliedIntelligence,
[46] C.Szegedy,V.Vanhoucke,S.Ioffe,J.Shlens,andZ.Wojna,“Rethinking
vol.52,pp.580–594,2021. the inception architecture for computer vision,” in Proceedings of the
[26] J. Ji, S. Li, X. Liao, and F. Zhang, “Semantic Segmentation Based IEEEconferenceoncomputervisionandpatternrecognition,2016,pp.
on Spatial Pyramid Pooling and Multilayer Feature Fusion,” IEEE 2818–2826.
Transactions on Cognitive and Developmental Systems, vol. 15, pp. [47] K.He,X.Zhang,S.Ren,andJ.Sun,“DeepResidualLearningforImage
1524–1535,2023. Recognition,” in Proceedings of the IEEE Conference on Computer
[27] T. Zhou, L. Li, X. Li, C.-M. Feng, J. Li, and L. Shao, “Group- VisionandPatternRecognition(CVPR),2016.
Wise Learning for Weakly Supervised Semantic Segmentation,” IEEE [48] PottawatomieCounty.AppendixD.https://www.pottcounty.org/Docum
TransactionsonImageProcessing,vol.31,pp.799–811,2021. entCenter/View/2383/Appendix-D.Accessed:August20,2024.
[28] C. P. Kushwah and K. Markam, “Semantic Segmentation of Satellite [49] Graz University of Technology, “Aerial Semantic Segmentation Drone
ImagesusingDeepLearning,”Regularissue,2021. Dataset,”2019,version1.1.[Online].Available:http://dronedataset.icg
[29] R. Benkert, O. J. Aribido, and G. Alregib, “Explaining Deep Models .tugraz.at
Through Forgettable Learning Dynamics,” in 2021 IEEE International [50] Z. Li, K. Kamnitsas, and B. Glocker, “Analyzing overfitting under
ConferenceonImageProcessing(ICIP),2021,pp.3692–3696. class imbalance in neural networks for image segmentation,” IEEE
[30] Y.TianandS.Zhu,“PartialDomainAdaptationonSemanticSegmenta- transactionsonmedicalimaging,vol.40,no.3,pp.1065–1077,2020.
tion,”IEEETransactionsonCircuitsandSystemsforVideoTechnology, [51] J.M.JohnsonandT.M.Khoshgoftaar,“Surveyondeeplearningwith
vol.32,pp.3798–3809,2022. classimbalance,”Journalofbigdata,vol.6,no.1,pp.1–54,2019.
[31] J. Cen, P. Yun, J. Cai, M. Y. Wang, and M. Liu, “Deep Metric [52] Z.-H. Zhou, Ensemble methods: foundations and algorithms. CRC
LearningforOpenWorldSemanticSegmentation,”in2021IEEE/CVF press,2012.
InternationalConferenceonComputerVision(ICCV),2021,pp.15313– [53] A. A. Khan, O. Chaudhari, and R. Chandra, “A review of ensemble
15322. learninganddataaugmentationmodelsforclassimbalancedproblems:
[32] O.Ronneberger,P.Fischer,andT.Brox,“U-net:Convolutionalnetworks combination,implementationandevaluation,”ExpertSystemswithAp-
for biomedical image segmentation,” in Medical imagecomputing and plications,p.122778,2023.
computer-assisted intervention–MICCAI 2015: 18th international con-
ference,Munich,Germany,October5-9,2015,proceedings,partIII18.
Springer,2015,pp.234–241.
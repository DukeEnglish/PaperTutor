Optimal Task Assignment and Path Planning using
Conflict-Based Search with Precedence and Temporal Constraints
YuQuanChong JiaoyangLi KatiaSycara
CarnegieMellonUniversity CarnegieMellonUniversity CarnegieMellonUniversity
Pittsburgh,PA,USA Pittsburgh,PA,USA Pittsburgh,PA,USA
yuquanc@andrew.cmu.edu jiaoyangli@cmu.edu sycara@andrew.cmu.edu
ABSTRACT orderandwithincertaintimeframestoavoidproductdefects.Ex-
The Multi-Agent Path Finding (MAPF) problem entails finding istingMAPFalgorithms[3,4,14,24–26,29]donotincorporate
collision-freepathsforasetofagents,guidingthemfromtheir bothprecedenceandtemporalconstraintswhengeneratingpaths
starttogoallocations.However,MAPFdoesnotaccountforseveral aswellastheexecutiontimeofactionsatgoallocations.
practicaltask-relatedconstraints.Forexample,agentsmayneed Furthermore,inmanyreal-worldproblems,theunderlyinggoal
toperformactionsatgoallocationswithspecificexecutiontimes, istomaximizeauser-definedobjectiveinsteadofminimizingthe
adheringtopredeterminedordersandtimeframes.Moreover,goal makespanorsumofpathcosts,whichareusuallyoflowerpriority.
assignmentsmaynotbepredefinedforagents,andtheoptimization Thenotionofauser-definedobjectivecanbequantifiedthrough
objectivemaylackanexplicitdefinition.Toincorporatetaskassign- thereinforcementlearning(RL)frameworkviareturnsfromauser-
ment,pathplanning,andauser-definedobjectiveintoacoherent definedrewardfunction.Forexample,asparserewardfunction
framework,thispaperexaminestheTaskAssignmentandPath wouldonlygiveapositivereward(e.g.+1)whenataskiscompleted
FindingwithPrecedenceandTemporalConstraints(TAPF-PTC) and a reward of zero otherwise. Hence, generating an optimal
problem.WeaugmentConflict-BasedSearch(CBS)tosimultane- taskassignmentthatmaximizes theuser-defined objectivethat
ouslygeneratetaskassignmentsandcollision-freepathsthatadhere is typically unknown is also vital. In addition, task assignment
toprecedenceandtemporalconstraints,maximizinganobjective andpathplanningarehighlycoupledascertaintaskassignments
quantifiedbythereturnfromauser-definedrewardfunctionin couldleadtofewerconflictsduringpathplanning,increasingthe
reinforcementlearning(RL).Experimentally,wedemonstratethat probabilityoffindinganoptimalsolution.
ouralgorithm,CBS-TA-PTC,cansolvehighlychallengingbomb- Ingeneral,manymulti-agentproblemsbasedonreal-worldsce-
defusingtaskswithprecedenceandtemporalconstraintsefficiently narioscanbetheoreticallyframedasmulti-agentreinforcement
relativetoMARLandadaptedTargetAssignmentandPathFinding learning(MARL)problemswithauser-definedrewardfunction.
(TAPF)methods. However,usingMARLmethodstotrainagentstolearntosolve
tasksinvolvingpathplanningpresentsitselfwithmanychallenges
KEYWORDS suchassampleefficiency.Forexample,PRIMAL[23],aframework
thatcombinesRLwithimitationlearning(IL)fromanexpertcen-
Multi-AgentTaskAssignment,Multi-AgentPathFinding,Prece-
tralizedMAPFplannerlikeCBS[24]andODrM*[29]tosolveMAPF
denceConstraints,TemporalConstraints
problems,hadatrainingtimeof20days.Hence,ratherthantraining
ACMReferenceFormat: agentstolearnthepathplanningandadditionalskillsnecessary
YuQuanChong,JiaoyangLi,andKatiaSycara.2024.OptimalTaskAs-
tosolvetasksfromscratch,itwouldbeidealtodeviseasingle
signmentandPathPlanningusingConflict-BasedSearchwithPrecedence
coherentframeworkthatcanincorporatetaskassignment,path
andTemporalConstraints.InProc.ofthe23rdInternationalConferenceon
planning,andauser-definedobjectivetosolvetasks.
AutonomousAgentsandMultiagentSystems(AAMAS2024),Auckland,New
Therefore,weexaminetheTaskAssignmentandPathFinding
Zealand,May6–10,2024,IFAAMAS,9pages.
withPrecedenceandTemporalConstraints(TAPF-PTC)problem,
1 INTRODUCTION wherethegoalistosimultaneouslygeneratetaskassignmentswith
feasibleandcollision-freepathsforagentsthatadheretoprece-
Multi-AgentPathFinding(MAPF)isagrowingfieldwithapplica-
denceandtemporalconstraintstomaximizeauser-definedobjec-
tionsinfieldssuchastransportationandlogistics[19,27,30].Most
tiveandpresenttheConflict-BasedSearchwithTaskAssignment,
MAPFalgorithmsappliedincaseslikewarehousepick-and-place
PrecedenceandTemporalConstraints(CBS-TA-PTC)algorithm.Ex-
operationsgeneratecollision-freeplanstobringagentsfromtheir
perimentalresultsdemonstratethatCBS-TA-PTCcansolvehighly
starttogoallocations.However,inreal-worldscenarios,agentsof-
challengingbomb-defusingtaskswithprecedenceandtemporal
tenhaveinterdependenttasksthatrequireactionstobeperformed
constraintsefficientlyrelativetoMARLandadaptedTargetAssign-
inaspecificorder(precedenceconstraints)and/orwithinaspecific
mentandPathFinding(TAPF)[15]methods.
timeframe(temporalconstraints)atspecificlocations.Forexample,
agentsinmanufacturingplantsneedtoperformvariousinterde-
pendenttaskssuchaswelding,painting,andassemblyinaspecific
Proc.ofthe23rdInternationalConferenceonAutonomousAgentsandMultiagentSystems
2 BACKGROUND
(AAMAS2024),N.Alechina,V.Dignum,M.Dastani,J.S.Sichman(eds.),May6–10,2024,
Auckland,NewZealand.©2024InternationalFoundationforAutonomousAgents
Inthissection,weprovideabriefoverviewofMAPF,CBS,MARL,
andMultiagentSystems(www.ifaamas.org).ThisworkislicencedundertheCreative
CommonsAttribution4.0International(CC-BY4.0)licence. andTAPF.
4202
beF
31
]IA.sc[
1v27780.2042:viXra2.1 Multi-AgentPathFinding(MAPF) 2.4 TargetAssignmentandPathFinding(TAPF)
MAPFischaracterisedbyanundirectedgraph𝐺 = (𝑉,𝐸) anda TAPF is characterised by an undirected graph𝐺 = (𝑉,𝐸) with
setof𝑚agents{𝑎 1,...,𝑎 𝑚},whereeachagent𝑎 𝑖 possessesastart 𝐾 teams {𝑡𝑒𝑎𝑚 1,...,𝑡𝑒𝑎𝑚 𝐾},whereeachteam𝑡𝑒𝑎𝑚 𝑖 consistof
vertex𝑠 𝑖 ∈𝑉 andgoalvertex𝑔 𝑖 ∈𝑉.Eachagentcaneithermove 𝐾 𝑖 agents{𝑎𝑖 1,...,𝑎𝑖 𝐾𝑖}andaregivenuniquetargetgoalvertices
At so
tn
aa rtan
g
te oei ng ith
t
s’b
s
go opr ai an lthg vev
i
rse tr eat xe sx
ae
no
q
dr
u
ter he
n
em
ce
pa ai on
tf
ha
a
ct
c
oi tt sis toc
n
isu sr thr te
h
en
a
ct
t
ov
b
me rr bint ie ngx
es
da it
t
cu ofn
r so
tit
m
oc fo
i
as
t
lst l. m{𝑔 o𝑖 1 v,. e. t. o,𝑔 a𝑖 𝐾𝑖 u} n. iE qa uc eh ta ag re gn ett𝑎 g𝑖 o𝑗 ah la vs ea rtu en xiq 𝑔u
𝑖
𝑗′e .s Ata gr et nv te sr it nex 𝑡𝑒𝑠 𝑎𝑖 𝑗 𝑚an 𝑖d arm eu as st
-
signedtotargetsthroughapermutationbasedone-to-onemapping
a coct ni flo in cs t⟨in
𝑎
𝑖t ,h 𝑎e 𝑗,p 𝑣a ,𝑡th ⟩. iffW 𝑎e 𝑖c ao nn ds 𝑎id 𝑗e ar retw ato thty ep se as mo ef vc eo rn tefl xic 𝑣ts a: t1 t) heVe sart mex
e
𝜙, i.e.𝑔𝑖
𝑗′
= 𝜙𝑖(𝑎𝑖 𝑗). Beyond collisions between agents within a
t si am me est ee dp g𝑡 e,2 ⟨𝑢) ,E 𝑣d ⟩g ie nc oo pn pfl oic st it⟨ e𝑎 𝑖 d, i𝑎 re𝑗, c𝑢 ti, o𝑣 n,𝑡 s⟩ bi eff tw𝑎 𝑖 ea en nd ti𝑎 m𝑗 et sr ta ev pe srs 𝑡e at nh de t i.e ea .m be, tT wA eP eF nc ao gn es nid te 𝑎r 𝑖 𝑗sc inol 𝑡l 𝑒is 𝑎i 𝑚on 𝑖s ab ne dtw ae ge en nta 𝑎g 𝑖e 𝑗′ ′n it nso 𝑡𝑒f 𝑎d 𝑚iff 𝑖e ′.re Tn ht ete team ams,
𝑡+1.Aconstraintisatuple⟨𝑎 𝑖,𝑣,𝑡⟩where𝑎 𝑖 isprohibitedfrom conflicts are adapted from MAPF as follows: 1) Vertex conflict
occupying𝑣attimestep𝑡.AsolutiontoMAPFisasetofconflict- ⟨𝑡𝑒𝑎𝑚 𝑖,𝑡𝑒𝑎𝑚 𝑖′,𝑣,𝑡⟩ iff𝑎𝑖 𝑗 and𝑎𝑖 𝑗′ ′ areatthesamevertex𝑣 atthe
freepathsforallagentsandanoptimalsolutionisasolutionthat sametimestep𝑡,2)Edgeconflict⟨𝑡𝑒𝑎𝑚 𝑖,𝑡𝑒𝑎𝑚 𝑖′,𝑢,𝑣,𝑡⟩iff𝑎𝑖 𝑗 and
givestheminimumforanobjectivefunction,whichistypicallythe 𝑎𝑖′ traversethesameedge ⟨𝑢,𝑣⟩ inoppositedirectionsbetween
𝑗′
sumofpathcosts(sumofthepathcostsofallagents’paths)or timesteps𝑡 and𝑡+1.
themakespan(maximumpathcostofallagents’paths).Finding
anoptimalsolutionforMAPFisknowntobeanNP-hardproblem 3 PROBLEMDEFINITION
evenwhenapproximatingoptimalsolutions[11,14,16].
TAPF-PTC is characterised by an undirected graph𝐺 = (𝑉,𝐸),
asetof𝑁 agents{𝑎 1,...,𝑎 𝑁},andatask𝑇,whichisasetof𝑀
2.2 Conflict-BasedSearch(CBS)
goals{𝑔1,...,𝑔𝑀}withgiventemporalandprecedenceconstraints.
Eachagenthasaninitialstate𝑠 𝑖 ∈ Sconsistingofastartvertex
CBS[24]isacompleteandoptimaltwo-levelMAPFalgorithm.The 𝑣 𝑖 ∈ 𝑉,where𝑣 𝑖 ∈ 𝑠 𝑖.Eachgoal𝑔𝑖 isatuplecomprisingagoal
high-levelsearchisabest-firstsearchwithrespecttothecostofa action𝑔𝑖.𝑎𝑐𝑡 ∈ A\A𝑣 andagoalvertex𝑔𝑖.𝑣 ∈𝑉,whereA and
nodeaboutabinaryConstraintTree(CT),whereeachnodecontains
A𝑣 arethesetofallactionsandactionsforvertexmovements,
asetofpathconstraintsforvariousagents,asetofpathsforeach respectively.Weneedtofindabinary𝑁 ×𝑀matrix𝐸thatassigns
agentconsistentwiththepathconstraints,andacostdepending
goalstoagentsviaamany-to-onemappingsuchthateachagent
o Cn Tt nh oe do eb wje ic thtiv ae no ef mt ph te yM seA tP oF fcp or no sb tl re am in. tsC aB nS ds gta er nt es rw ati et sh pt ah te hsro foo rt 𝑎 𝑖 hasasequenceof𝑙 𝑖 goals [𝑔 𝑖1,...,𝑔 𝑖𝑙𝑖],where(cid:205) 𝑖𝑁𝑙 𝑖 = 𝑀.An
eachagentcomputedusingthelow-levelplanner.Thehigh-level
agent𝑎 𝑖reaches𝑔 𝑖𝑗.𝑣andperforms𝑔 𝑖𝑗.𝑎𝑐𝑡for𝛼(𝑔𝑗)timestepswhile
searchevaluatesthesetofpathsofeachagentforconflicts,where waitingthere.Wefurtheruse𝜇(𝑔 𝑖𝑗 )and𝜏(𝑔 𝑖𝑗 )todenotethetimestep
aconflict-freeCTnodeisreturnedasthegoalnode.Otherwise, whenagent𝑎 𝑖 startandfinishperformingaction𝑔 𝑖𝑗.𝑎𝑐𝑡 atvertex
i st ps lie tl se tc hts ea Cc To nn ofl dic et ib ne tt ow te we on cth he ildpa Ct Ths no of dt ew s,o anco dn afl pi pct ei nn dg sa age nn et ws, 𝑔 𝑖𝑗.𝑣,respectively,so𝜏(𝑔 𝑖𝑗 )−𝜇(𝑔 𝑖𝑗 ) = 𝛼(𝑔 𝑖𝑗 ).Apathsegmentfor
anagent𝑎 𝑖 consistsofthesequenceofstatesandactionsfromthe
c foo rn bs it dra ei in tt ht eo re ca oc nh flc ih cti il nd gC aT gn eo nd tsef fo ror meac uh tia lig ze inn gt. tT hh ee cn oe nw flic co tn ins gtra ei dn gt es completionof𝑔 𝑖𝑗−1 tothecompletionof𝑔 𝑖𝑗 ,withthefullpathbeing
thesequentialconcatenationofthepathsegmentsof𝑙 𝑖 goals.We
orvertexattheconflictingtimestep.Thelow-levelplannerthen
introducetwoadditionaltemporalconstraints:1)Absolutetemporal
recomputesthepathoftheconstrainedagentinthechildCTnodes
tobeconsistentwiththenewconstraintset.
rangeconstraintsT𝑎𝑏𝑠 and2)Inter-goaltemporalrangeconstraints
T𝑖𝑛𝑡𝑒𝑟,inadditiontotheprecedenceconstraintsT𝑝𝑟𝑒𝑐 inCBS-PC
[33] and the vertex/edge constraints in CBS [24]. A solution to
2.3 Multi-AgentReinforcementLearning TAPF-PTCconsistsofagoalassignmentandasetofconflict-free
pathssatisfyingtheaboveconstraints.
(MARL)
MARLisabranchofRLwhoseobjectiveistotrainagentswhocan 3.1 AbsoluteTemporalRangeConstraints
learntocooperateorcompetewitheachotherincomplexenviron- 𝑔𝑗 𝑔𝑗
mentstoachieveacommonorindividualgoal.Inpartiallyobserv- Anabsolutetemporalrangeconstraint⟨𝑡 𝑙𝑜𝑖 𝑤𝑒𝑟,𝑡 𝑢𝑖 𝑝𝑝𝑒𝑟,𝛾⟩ ∈T𝑎𝑏𝑠 is
ableMarkovgame[12]of𝑁 agents,thesetofstates,actionsand 𝑔𝑗 𝑔𝑗
observationsaregivenbyS,A 1,...,A𝑁 andO 1,...,O𝑁 respec- a oftu thp ele rw anh ge ere o𝑡 f𝑙𝑜𝑖 t𝑤 im𝑒𝑟 esa tn ed ps𝑡 𝑢 w𝑖 𝑝𝑝 h𝑒 e𝑟 rere ep ir te hs ee rn tt hlo ew ee xr eca un td iou npp oe rr cb oo mu pn ld es
-
t si tv ae tely s.f Eo ar ce hac ah gea ng te on bt. taA ind sis at nri ob bu st eio rn va𝜌 tio: nS ,𝑜→−
𝑖
:[ S0, →1 −]s Oel 𝑖e ,c fots llt oh we sin ai sti ta ol
-
tiontimestep,denotedby𝛾 ∈ [𝜏,𝜇],foragent𝑎 𝑖 for𝑔 𝑖𝑗 mustfall
chasticpolicy,𝝅𝜃𝑖 :O𝑖×A𝑖→− [0,1]thatgeneratesthenextstate within,i.e.,𝑡 𝑙𝑔 𝑜𝑖𝑗
𝑤𝑒𝑟
≤ 𝛾(𝑔 𝑖𝑗 ) ≤ 𝑡 𝑢𝑔 𝑖 𝑝𝑗 𝑝𝑒𝑟.Itallowstheusertodefine
f ao nl dlo rw ei cn eg ivt eh se ast ra et wet ar ra dn ,s 𝑟i 𝑖ti :o Snf ×un Act 𝑖io →−n, RT .E: aS c× hA ag1 e× nt· a· i· m× sA to𝑁 m→− axS
i-
thetemporalrangewhere𝑔 𝑖𝑗 muststartexecutionorbecompleted.
m thi eze toi tt as lo dw isn cot uo nta tl edex rp ee wc ate rd dfr re otu mrn ti, m𝐺 e𝑡 s= tep(cid:205) 𝑡𝑇 𝑘 ,𝑡 w𝑒𝑟𝑚 he𝛾 r𝑘 e𝑟 𝛾𝑡+ a𝑘 n+ d1, 𝑇w 𝑡𝑒h 𝑟𝑚ich ari es U ras nin gg ecc oo nm flp icle tt oio cn cut ri sm wes ht 𝑔ee 𝑗np ta hs ea r 𝑔n e 𝑗ee xx ia sm tsp 𝑔l 𝑖𝑗e, wa in thab ths eol au bt se ot le um tep to er mal -
thediscountrateandtheterminaltimesteprespectively. poralrangeconstraint⟨𝑡 𝑙𝑜𝑖 𝑤𝑒𝑟,𝑡 𝑢𝑖 𝑝𝑝𝑒𝑟,𝜏⟩ ∈T𝑎𝑏𝑠 andthefollowingoccurs:𝜏(𝑔 𝑖𝑗 ) <𝑡 𝑙𝑔 𝑜𝑖𝑗
𝑤𝑒𝑟
or𝜏(𝑔 𝑖𝑗 ) >𝑡 𝑢𝑔 𝑖 𝑝𝑗 𝑝𝑒𝑟.Amotivatingexamplein Algorithm1TaskpartitionforCBS-TA-PTC
therealworldcouldbeinthecontextofarestaurantwithauto- Input: Graph𝐺,initialstates𝑆,task𝑇,numberofgoalsper𝑇 𝑠𝑢𝑏 𝛽
matedfoodserviceusingrobotwaiters,whereabsolutetemporal Output: Pathforeachagentforgiven𝑇
rangeconstraintscanbeusedtoenforcethetimeinwhichthe 1: solution←∅
ordereditemsmustbeservedtocustomersfromthetimeoftheir 2: 𝑇 ←HeuristicSort(𝐺,𝑆,𝑇)
orderforgoodcustomerservice. 3: 𝑇 ←Partition(𝑇,𝛽)
4: for𝑇 𝑠𝑢𝑏 in𝑇 do
3.2 Inter-GoalTemporalConstraints 5: 𝑇 𝑠𝑢𝑏 solution←CBS-TA-PTC(𝐺,𝑆,𝑇 𝑠𝑢𝑏,solution)
Aninter-goaltemporalconstraintisatupleconsistingoftwogoals 6: solution.append(𝑇 𝑠𝑢𝑏 solution)
𝑔 𝑖𝑗 and𝑔 𝑖𝑗 ′′ withatemporalconstraintbetweentheirrespectiveexe- 7 8:
:
e ren td urf nor
solution
cutionorcompletiontimesteps.Forexample,thefollowingrelation:
𝜏(𝑔 𝑖𝑗 ′′ )−𝜏(𝑔 𝑖𝑗 ) ≤𝑡 𝑖𝑛𝑡𝑒𝑟 isdenotedby⟨𝜏(𝑔 𝑖𝑗 ),𝜏(𝑔 𝑖𝑗 ′′ ),𝑡 𝑖𝑛𝑡𝑒𝑟⟩ ∈T𝑖𝑛𝑡𝑒𝑟.
Itallowstheusertodefinethetemporalrangewhere𝑔𝑗′
.𝑎𝑐𝑡 must Hence,findinganoptimalsolutionwithrespecttomakespanor
𝑖′
beexecutedorcompletedrelativetotheexecutionorcompletionof sumofpathcostsforTAPF-PTCisalsoNP-Hard[11,14,16].
𝑔 𝑖𝑗.𝑎𝑐𝑡.Consideringcompletiontimestepsforboth𝑔 𝑖𝑗 and𝑔 𝑖𝑗 ′′ asan
4 RELATEDWORK
example,aninter-goaltemporalconflictoccurswithinter-goaltem-
poralconstraint⟨𝜏(𝑔 𝑖𝑗 ),𝜏(𝑔 𝑖𝑗 ′′ ),𝑡 𝑖𝑛𝑡𝑒𝑟⟩ ∈T𝑖𝑛𝑡𝑒𝑟 whenthefollowing CBSwithPrecedenceConstraints(CBS-PC)[33],isacompleteand
relation𝜏(𝑔 𝑖𝑗 ′′ )−𝜏(𝑔 𝑖𝑗 ) >𝑡 𝑖𝑛𝑡𝑒𝑟 istrue.Returningtotheautomated o stp rt ai im nta sl ba elg twor ei eth nm gof ao lr s.M CA BP SF wb iu tht Tfa ai sls kt Ao sc so ign ns mid ee nr tte (Cm Bp So -r Ta Al )co [8n ]-
foodservicecontext,inter-goaltemporalconstraintscanbeused
andtheConflict-BasedMin-Cost-Flow(CBM)algorithm[15]are
toensurethatordersforcustomersdiningtogethermustallarrive
completeandoptimalforTAPFbutfailtoconsiderprecedenceand
withinaspecifiedtimeframeuponthearrivalofthefirstitemin
temporalconstraintsbetweengoals.Asenumeratingalltaskas-
theorder.Thiswouldensurethatcustomersdiningtogetherwould
signmentsisunfeasiblecombinatorics-wise,CBS-TA[8]generates
nothavetowaitforlongforeachothermealstoarrivetohave
assignmentsondemandusinganyoptimalassignmentalgorithm
theirmealstogetheraspartofgoodcustomerservice.
(e.g.Hungarianmethod[10])tofindtheoptimalsolution.Using
targetswappingfromaninitialarbitrarytargetassignment,TSWAP
3.3 PrecedenceConstraints
iscompleteandhighlyscalablebutsub-optimalforTAPF[20].An-
Aprecedenceconstraintisatupleconsistingoftwogoals𝑔 𝑖𝑗 and otherframeworkusesamarginal-costassignmentheuristicanda
𝑔𝑗′
wheretheirrespectiveexecutionorcompletiontimestepsare meta-heuristicimprovementstrategybasedonLargeNeighbour-
𝑖′
constrainedprecedence-wise.Forexample,⟨𝜏(𝑔 𝑖𝑗 ),𝜇(𝑔 𝑖𝑗 ′′ )⟩ ∈T𝑝𝑟𝑒𝑐 h mo ino id mS ie za atr ic oh n[ o2 f5 m]t eo trm ici sn si um ci hze asto tt ha el st ura mve ol fd pe al ta hy c[ o2 s] t. sH oo rw me av ke er s, pth ane
assertsthefollowingrelation:𝜏(𝑔 𝑖𝑗 ) <𝜇(𝑔 𝑖𝑗 ′′ ),i.e.theexecutionof
neednotmaximize(andcanevenreduce)thereturningeneral.
𝑔 𝑖𝑗 ′′ .𝑎𝑐𝑡 mustoccurafterthecompletionof𝑔 𝑖𝑗.𝑎𝑐𝑡.Itallowstheuser Hence,theirframeworkscannotbeleveraged.Inaddition,allof
todefinetheorderinwhichactionsatgoalverticesmustbeexe- theabovefailstoconsidertheexecutiontimeofactions.
cutedorcompletedrelativetotheexecutionorcompletionofother
actions,whichexpandsbeyond[33]thataddressesprecedencecon- 5 CBS-TA-PTC
straintsforcompletiontimestepsonly,i.e.⟨𝜏(𝑔 𝑖𝑗 ),𝜏(𝑔 𝑖𝑗 ′′ )⟩ ∈T𝑝𝑟𝑒𝑐, Inthissection,weintroduceCBS-TA-PTCandprovideanoverview
with zero execution time. This is insufficient given many cases ofitshigh-levelconflictresolutionandlow-levelpathplanning.
whereitisnecessaryforanactiontoexecuteonlyafterthecom- Incaseswhere𝑀 issignificantlylargerthan 𝑁,wepartition𝑇
pletionofanotheraction(e.g.assemblingtasks).Consideringcom- intosubtasks {𝑇 𝑠𝑢𝑏} usingAlgorithm1,formingeach𝑇 𝑠𝑢𝑏 asa
pletiontimestepsforboth𝑔 𝑖𝑗 and𝑔 𝑖𝑗 ′′ asanexample,aprecedence TAPF-PTCinstanceandsolvedbyCBS-TA-PTCinAlgorithm2.In
conflictoccurswithprecedenceconstraint⟨𝜏(𝑔 𝑖𝑗 ),𝜏(𝑔 𝑖𝑗 ′′ )⟩ ∈T𝑝𝑟𝑒𝑐 A orl dg eo rri oth fm the1, ga oau ls se fr o-d re thfi ene tad sh ke 𝑇ur ai sst sic hois wu nse ind lt io neso 2rt inth Ae lge ox re ic tu ht mion
1.
whenthefollowingrelation𝜏(𝑔 𝑖𝑗 ) ≥𝜏(𝑔 𝑖𝑗 ′′ )istrue.Notethatprece- Theorderedgoalsarethenpartitionedusingahyperparameter𝛽,
denceconstraintsintroducedhereandin[33]canbeseentobea thenumberofgoalspersubtask,toformasubtask𝑇 𝑠𝑢𝑏 asshown
specialcaseofinter-goaltemporalconstraintsdefinedinSection3.2 inline3toensurecomputationallyfeasibletaskassignments.
giventhat𝑡 𝑖𝑛𝑡𝑒𝑟 canbeanyrealnumber.Returningtotheauto-
matedfoodservicecontext,precedenceconstraintscanbeusedto 5.1 High-LevelofCBS-TA-PTC
ensurethatitemsofaspecificattributearenotservedbeforeothers,
Fromlines1–13inAlgorithm2,thegoalsfromthesubtaskare
e.g.dessertsarenotservedbeforethemaincourse.
usedtogenerateallpossiblecombinationsofassignmentstoagents,
whereeachuniquetaskassignmentcorrespondstoarootCTnode
3.4 TheoreticalOverview
insertedtoOPEN.Animportantpropertyforrootnodeswouldbe
TheMAPFproblemisaspecificsubclassoftheTAPF-PTCproblem thereturnasshowninline7,whichisgeneratedbyevaluating
where𝑁 =𝑀,𝐸isapermutationmatrixandthetimesteprequired
thesolutionfromthelowlevel,withpastsolutionsfromprevious
toexecutetheactionis0,i.e.𝛼(𝑔 𝑖𝑗 )=0,T𝑎𝑏𝑠 =T𝑖𝑛𝑡𝑒𝑟 =T𝑝𝑟𝑒𝑐 =∅. subtasks,onanoraclethatsimulatestheenvironmentbasedonAlgorithm2CBS-TA-PTC() asitislogicaltoensurethatactionsareperformedinthecorrect
Input: Graph𝐺,initialstates𝑆,subtask𝑇 𝑠𝑢𝑏,pastsolutions orderbeforeassertingthattheyarecorrectlyspacedaparttempo-
Output: Pathforeachagentforgiven𝑇 𝑠𝑢𝑏 rally.Inaddition,itisalsolikelyresolvingaprecedenceconflict
1: forassignmentinCombinations(𝑇 𝑠𝑢𝑏)do wouldresolveanyrelatedinter-goaltemporalconflict.
2: R←newnode Thefollowingdetailstheconflictresolutionforinter-goaltem-
3: R.constraints←∅ poralconflictsusingcompletiontimestepsforallactions.Whenan
4: R.assignment←assignment inter-goaltemporalconstraint⟨𝜏(𝑔 𝑖𝑗 ),𝜏(𝑔 𝑖𝑗 ′′ ),𝑡 𝑖𝑛𝑡𝑒𝑟⟩isviolated,i.e.
5: R.solution←PathsfromLowLevel() 𝜏(𝑔 𝑖𝑗 ′′ )−𝜏(𝑔 𝑖𝑗 ) >𝑡 𝑖𝑛𝑡𝑒𝑟,CBS-TA-PTCgeneratestwochildCTnodes
6: R.cost←SumOfPathCost(R.solution) withoneofthefollowinginter-goaltemporalcompletiontimestep
7: R.return←Return(S,R.solution,pastsolutions) constraintsaddedtoeitherchildCTnodes,letting𝜏(𝑔𝑗′ ) =𝑡′ at
8: R.conflicts←Conflicts(R.solution) thecurrentCTnode: 𝑖′
109 :: if rR e.r te ut ru nrn Ris .sm ola ux tii om numreturnthen (1) 𝜏(𝑔 𝑖𝑗 ) ≥ 𝑡′ −𝑡 𝑖𝑛𝑡𝑒𝑟:Agent𝑎 𝑖 istocomplete𝑔 𝑖𝑗 atorafter
11: endif timestep𝑡′−𝑡 𝑖𝑛𝑡𝑒𝑟.Agent𝑎 𝑖’spathinthecorrespondingchild
12: insertRtoOPEN CTnodeisreplannedandtheinter-goaltemporalconflictis
11 43 :: e wn hd ilf eo Or PENnotemptydo (2) 𝜏re (s 𝑔o 𝑖𝑗l )ve <d 𝑡. ′−𝑡 𝑖𝑛𝑡𝑒𝑟:Agent𝑎 𝑖istocomplete𝑔 𝑖𝑗 beforetimestep
15: P←nodefromOPENwiththehighestreturn 𝑡′−𝑡 𝑖𝑛𝑡𝑒𝑟,whichisalreadysatisfied.Giventheinter-goal
16: ifP.returnismaximumreturnthen temporalconstraint,thisforcesagent𝑎 𝑖′ tocomplete𝑔 𝑖𝑗 ′′ at
17: return P.solution leastonetimestepearlierthanbeforewhenreplanningits
18: endif pathinthecorrespondingchildCTnode,i.e.𝜏(𝑔𝑗′ ) ≤𝑡′−1.
𝑖′
19: conflict←conflictinPw.r.tconflictresolutionorder Hence,𝜏(𝑔𝑗′ )inthechildCTnodeisguaranteedtodecrease
20: constraints←ResolveConflict(conflict) 𝑖′
byonetimestep.
21: forconstraintinconstraintsdo
22: Q←newnode Agent𝑎 𝑖′ isunlikelytofindapathfollowinginter-goaltemporal
23: Q.constraints←P.constraints.append(constraint) constraint(2)giventhat𝑡′islikelytobetheearliestpossiblecom-
24: ifQ.constraintsisunsolvablethen pletiontimestepfor𝑔 𝑖𝑗 ′′ foragent𝑎 𝑖′.Hence,thechildCTgenerated
25: continue byitislikelytobepruned.Forconciseness,absolutetemporalrange
26: endif andprecedenceconflictscanbeexplainedsimilarly.Line14–35of
27: Q.assignment←P.assignment Algorithm2highlightsCBS-TA-PTC’sconflictresolutionprocess,
28: Q.solution←P.solution whereline19generatesconflictsbasedonthestatedpriorityor-
29: UpdateQsolutionforagent𝑎 𝑖 inconstraint derandline20resolvestheconflictbygeneratingthenecessary
30: Q.cost←SumOfPathCost(Q.solution) constraintstobeinsertedinchildCTnodestobepushedtoOPEN.
31: Q.return←Return(S,Q.solution,pastsolutions) Thesolutionnodetobereturnedisthenodewiththemaximum
32: Q.conflicts←Conflicts(Q.solution) returnasevaluatedbytheoracle.Thesolutionfortheentiretaskis
33: insertQtoOPEN thencomposedofthesolutionsofthesubtasksequentially.
34: endfor
35: endwhile 5.2 Low-LevelofCBS-TA-PTC
Multi-LabelA*(MLA*)[5]isusedtogenerateaminimumsumof
theuser-definedrewardfunctionanddynamics.Inpractice,the pathcostssolutionforataskassignmentundertheconstraints
oracleistypicallyimplementedasauser-designedRLenvironment ontheCTnode.Tospeedupthelowlevel,alinearprogramming
basedontheGymnasiumAPI[28],wherethesolutionfromthelow moduleusingoneoftheHiGHSsolvers[6,9]isimplementedto
levelwithpastsolutionsfromprevioussubtaskscanberolledout pruneCTnodesthatareunsolvablegiventheirconstraintsfrom
asasingletrajectoryviatheresetandstepfunctionsfromthe thevarioustypesofconflictsbeforetheMLA*searchasshownin
EnvclassinGymnasium.Thereturncanbesimplycalculatedby lines24–26inAlgorithm2.
summinguptherewardsacrosstimestepsandagentsreturnedby
thestepfunction.Notethatasolutionwiththemaximumreturn 5.3 TheoreticalPropertiesofCBS-TA-PTC
impliesaconflict-freesolutionbythedesignoftherewardfunction Byusinguser-definedheuristicstodecomposethetaskintosub-
(rewardispositivelycorrelatedwithconflictresolution). tasks, CBS-TA-PTC is an incomplete and suboptimal algorithm.
CBS-TA-PTCusesthefollowingconflictresolutionpriorityor- However,withtheentiretaskasasinglesubtask,thefollowingwill
dering:1)Absolutetemporalrange,2)Precedence,3)Inter-goal showthatCBS-TA-PTCisacompleteandoptimalalgorithmand
temporal,and4)Vertex/Edge,tomaximizethelikelihoodofgener- presentitsboundedsub-optimalsolver.
atingaCTnodewiththemaximumreturn.Thenaturalfirstorder
ofpriorityistoaddresstheabsolutetemporalrangeconflictsas 5.3.1 OptimalityofCBS-TA-PTC. CBS-TA-PTCenumeratesallpos-
theyarebasedontemporalrangesindependentfromothergoals. sibleassignmentsandaddsthenextbestpossibletaskassignment
Precedenceconflictstakepriorityoverinter-goaltemporalconflicts withrespecttothereturntoOPENwheneverarootCTnodeisexpanded.Unlikethesumofpathcosts,giventhattherewardfunc- Table1:EnvironmentParameters
tionisuser-defined,themaximumreturnthatanoptimalsolution
givesisalwaysknownthroughtheoracle.Naturally,thereturnof Parameters Values
aCTnodeisalowerboundtothemaximumreturn.Itisprovenin MissionLength(min) 15
Lemma2in[24]thatforeachvalidsolution𝑝,thereexistsatleast SecondsperTimestep [1,3]
oneCTnode𝑁 inOPENsuchthat𝑁 permits𝑝,implyingthatthere NumberofBombsperRegion [1,15]
isatleastoneCTnodeinOPENthatpermitstheoptimalsolution BombFuseLength(min) [1,15]
atalltimes.CBS-TA-PTCexpandsCTnodesinabest-firstmanner BombDependencyChainLength [1,4]
withrespecttoreturnandtheMLA*algorithmusedforlowlevel
isoptimal[5].Hence,wecanadaptTheorem1in[24]forCBSto
showthatCBS-TA-PTCreturnsanoptimalsolution. asequence.Eachagenthaswire-cuttertoolswith2outofthe3
colorsthatremovethematchingcolorfromtheorderedsequence
5.3.2 CompletenessofCBS-TA-PTC. Completenessincludesthe
ofabomb.Inaddition,eachbombhasacountdowntimer(e.g.15
followingclaims:1)CBS-TA-PTCwillreturnasolutionifoneexists
seconds)thattriggers/resetsuponacorrectdefusingstep,where
and2)CBS-TA-PTCwillidentifyanunsolvableproblem.Toprove
thenextsequencemustbedefusedbeforethecountdown.Each
the stated claims, we assume that every trajectory is a Markov
bombalsohasafusetimer(e.g.3minutes)thatindicatesthetime
gamethatterminateswithafixedterminaltimestep,whichisa
whenitmustbefullydefused.Furthermore,certainbombshave
reasonableassumptiongiventhatasignificantnumberoftasks
dependencieswithotherbombs,whichdictatesthatthebombitis
intherealworldhavepracticaldeadlines.Asaresult,thesetof
dependentonmustbefullydefusedorhaveexplodedbeforeany
possibleconstraintsthatcanbeaddedtoCTnodesisfinite.Hence,
defusingstepsonitself.Failuretoadheretotheaboveconstraints
there is a finite number of CT nodes with a specific return for
wouldresultinthebombexploding.Afullydefusedbombgives
everyreturn(avariantofTheorem2in[24]).AstheMLA*used
ateamrewardproportionatetothesequencelengthofthebomb
inthelowleveliscomplete[5],Theorem3in[24]canthenbe
(e.g.RGB:3×10=30).Figure1highlightstheenvironmentcom-
easilyadaptedtoshowclaim(1)thatCBS-TA-PTCwillreturnan
prisingthreeregions:Forest,Village,andDesert,derivedfroman
optimalsolutionifoneexists,giventheoptimalityofCBS-TA-PTC
implementationinagamecalledMinecraft[17].Asegmentation
proveninSection5.3.1.NotethatthereturnofeveryCTnodeis
algorithmisimplementedtoobtainagraphrepresentationofthe
notmonotonicallynon-decreasing,unlikethesumofpathcosts,as
mapwithapproximately40nodesperregionofthemapthatare
theresolutionofaconstraintmaygeneratemoreconflictsthatlead
generallyequallyspacedapartandrepresentanequalareaoftra-
toacorrespondingreductioninreturn.
versablegrids.Notethatanodecancontainmultiplebombs.The
Forclaim(2),notethatCBSonitsownisunabletoidentifyan
motivationforagraphrepresentationinsteadofagridworldisto
unsolvableinstanceandrequiresanindependenttestbyYuand
reducethestatespacetoaidlearningforMARLmethods.
Rus[32]todeterminethesolvabilityofagivenMAPFinstance.This
istheconsequenceofalackofaterminaltimehorizon,resultingin
6.2 Setup
aninfinitesetofconstraintsthatcanbeaddedtoCTnodes.Asimple
exampleisprovidedin[24]oftwoagentsattemptingtoswitch 6.2.1 EnvironmentSetup. Table1highlightsthevaluesusedto
locations,wheretheCTgrowsindefinitelythroughtheaddition instantiatetheenvironment.Thesecondspertimestepparameter
of unlimited constraints and the algorithm does not terminate. servestoconvertreal-timeintotimestepstodefinetheunderlying
Fortunately,giventheinitialassumptionofafixedterminaltimestep kinematicsanddynamicsoftheenvironment.Forsimplicity,node
andhenceafinitesetofpossibleconstraintstobeaddedtotheCT, traversalandadefusingsteptakethesamenumberoftimesteps.All
byexhaustivesearchovertheCTandnotfindingasolutionnode agentsstartatthesamerandomlyselectedlocation.Eachbomb’slo-
withthemaximumreturn,CBS-TA-PTCwillbeabletoidentifythat cation,sequence,andfuselengtharerandomlyselected.Anumber
theproblemisunsolvable. ofbombsperregionarerandomlyselectedfromtherangespecified
bythebombdependencychainlengthparametertoformabomb
5.3.3 BoundedSub-OptimalCBS-TA-PTC. Aboundedsub-optimal dependencychain.Notethatarandomlygeneratedenvironment
variantofCBS-TA-PTCcanbesimplyimplementedbysearchingfor instancemaybeunsolvable.Tothebestofourknowledge,thereare
aCTnodewiththemaximumreturnmultipliedbyasuboptimality noefficientoptimal,andcompletesolversfortheTAPF-PTCprob-
factor𝜖. lemtofilterunsolvablecases.Theonlyoptionavailablewouldbe
CBS-TA-PTCwiththeentiretaskasasubtaskaselaboratedinSec-
6 EXPERIMENTS tion5.3,whichisprohibitivelyexpensivetoruncombinatorics-wise
Thefollowingsectionsdetailtheenvironment,experimentalsetup, withanincreasingnumberofbombs.Toincreasethelikelihoodthat
andresults.AllcodeisimplementedinPython. arandomlygeneratedenvironmentissolvable,weallowformulti-
pleagentstoworkonbombsonthesamenodeatthesametimestep.
6.1 Environment Hence,collisionsbetweenagentsarenotconsidered,whichisnot
akeyfactorgiventhesmallnumberofagents.
Intheenvironment,threeagentsaretaskedtodefuseallthebombs
onthemapbyaspecifictimelimit.Eachbombhasanordered 6.2.2 AlgorithmSetup. CBS-TA-PTCparametersareasfollows:1)
sequenceofcolors:red(R),green(G),orblue(B),withasequence Numberofbombspersubtaskand2)Taskallocationheuristic.The
lengthrangingfrom[1,3],(e.g.RGB),withnorepeatedcolorsin numberofbombspersubtaskisaproxyparameterforthenumberFigure1:Aninstanceofthebomb-defusingtaskenvironment
ofgoalspersubtaskinAlgorithm1,asthebombsequencecan
bebrokendownintogoalswithdefusingactionsofasinglecolor
sequence.Tokeepthecombinatoricsoftaskallocationfeasible,the
numberofbombspersubtaskusedwillbeintherange[1,3].The
taskallocationheuristicistheheuristicusedforHeuristicSort()at
line2inAlgorithm1.Weusethefuselengthheuristicthatsorts
thebombsinascendingorderoffuselength.Foreachcombination
ofparameters,5trialsareexecutedwithatimeoutof5minutes,
andthesuccessrate,optimalityratio,andruntimearerecorded.
Successisdefinedasfindinganoptimalsolutionbeforethetimeout.
Theoptimalityratioistheratiobetweenreturnandoptimalreturn.
Theruntimeincludesonlyoptimalsolutionsandallsolutions(with
casesduetotimeoutornooptimalsolutionfound).
Figure2:EvaluatedmeanreturnofMAPPOfrom16rollouts
ForcomparisonswithCBS-TA-PTC,weconsiderastate-of-the-
arton-policyMARLalgorithm,Multi-AgentProximalPolicyOp-
timisation(MAPPO)[31],whichhasshowngenerallybetterper- withvertex/edgeconflictsonly.UnderCBS-TA,upontheexplosion
formanceinenvironmentssuchastheStarCraftMulti-AgentChal- ofabombatagiventimestep,CTnodesaregeneratedinanaive
lenge(SMAC)[22],theHanabichallenge[1]andthemulti-agent mannerwithvertexconflictsforeachagentforthattimestep,i.e.
particle-worldenvironment(MPE)[13,18]relativetovariousstate- atleastoneagentisdoingsomethingwrongatthattimestep.This
of-the-artoff-policyMARLmethodssuchasMADDPG[13]and variantofCBS-TAcanbeseenasCBS-TA-PTCwithoutabsolute
QMIX[21].ThekeymotivationforconsideringMAPPOasabase- temporalrange,inter-goaltemporalandprecedenceconflicts,It
lineistoevaluatewhetherthestate-of-the-artMARLmethodsare attemptstosolvetheTAPF-PTCproblembyrelyingsolelyonver-
capableoflearningthenecessarypathplanningandbomb-defusing texconflictstoresolvetheunderlyingprecedenceandtemporal
skillstosolvetasksinthegivenenvironmentfromscratchandtheir conflictsthroughamoreexhaustiveandinefficientbest-firstsearch
sampleefficiencyintermsofwall-clocktrainingtime.Suchcom- throughtheCTwithmoreCTnodesrelativetoCBS-TA-PTC.Nev-
parisonswouldascertainiftheunderlyingmotivationbehindour ertheless,itisworthhighlightingthatthisvariantofCBS-TAis
workisvalid,thatisMARLmethodscanbehighlysampleineffi- optimalandcompletelikeCBS-TA-PTCaselaboratedinSection5.3,
cientintrainingandanalternativesolutionthatincorporatestask undertheassumptionthattheentiretaskisasinglesubtask.
assignment,pathplanningandauser-definedobjectivetosolve
tasksismorepractical.MAPPOistrainedineachregionandthe 6.2.3 HardwareSetup. MAPPOistrainedusingasingleQuadro
wholemap,whereeachregionhas15bombswithoutfusesand RTX6000GPU.CBS-basedalgorithmsareimplementedonalaptop
dependencies,amissionlengthof15minutes,secondspertimestep withthefollowingspecifications:2.30GHzIntelCorei7-11800H
parameterof1,andfullobservabilityovertheenvironmentforall with16GBRAM.
agents.
6.3 Results
ForcomparisonswithMAPFbaselines,weimplementavariant
ofCBS-TA[8]thatmaximizesreturnunderthesamesubtaskassign- 6.3.1 MAPPO. Given15bombsperregion,theexpectedmaximum
mentframeworkasCBS-TA-PTChighlightedinAlgorithm1but returnis300perregion.Figure2highlightstheevaluatedmean(a)Numberofbombsperregion (c)Secondspertimestep
Figure3:EvaluatedresultsforCBS-basedalgorithms
6.3.2 CBS. Figure3highlightstheresultsobtainedfromtheCBS-
basedalgorithmsaveragedacrossalltrials.CBS-TA-PTCissuperior
to CBS-TA across all parameters in general as CBS-TA-PTC al-
wayshasasignificantlyhighersuccessrateandoptimalityratio
comparedtoCBS-TA.Whilethesuccessrateandoptimalityratio
naturallydecreasewithanincreasingnumberofbombsperregion
forbothCBS-TA-PTCandCBS-TA,thetwometricsdecaylinearly
forCBS-TA-PTCinsteadofexponentiallyforCBS-TAasshown
inFigure3a.Inaddition,CBS-TA-PTC’sruntimescaleslinearly
withrespecttothenumberofbombsperregioningeneralwitha
runtimeofapproximatelyaminuteforsuccessfulinstanceswith
thehighestnumberofbombsperregion,i.e.15.Ontheotherhand,
CBS-TA’sruntimequicklyplateaustowardsthetimeoutof5min-
utes,whichisexpectedgivenitsnaiveandinefficientmannerof
expandingtheCT.
FromFigure3b,thesuccessrateandoptimalityratioimprove
linearlyasthenumberofbombspersubtaskincreasesforCBS-TA-
(b)Numberofbombspersubtask PTC,whichisexpectedasalargersubtaskallowsforCBS-TA-PTC
toproducesubtasksolutionsofhigherqualitybyconsideringmore
constraints.Furthermore,withasmallernumberofsubtasks,given
returnforMAPPOfrom16evaluationrollouts.MAPPOisincapable thefactthatthesolutionfortheentiretaskiscomposedoftheso-
ofsolvingthebomb-defusingtaskoptimallydespitebeinggiven lutionsofthesubtasksequentially,itiseasiertofindagoodquality
asignificantlyeasiertaskwithoutbombfusesanddependencies solutionforagivensubtaskgivenagoodinitializationfrompast
aswellasthesmallestsecondspertimestepparameter.Inaddition, subtasksolutions.Ontheotherhand,CBS-TAdoespoorlyinterms
thewall-clocktrainingtimeforMAPPOwasapproximatelytwo ofsuccessrateandoptimalityratioregardlessofthenumberof
weeksforthestatedresults,highlightingthesampleinefficiencyof bombspersubtaskgivenitsnaiveandinefficientmannerofex-
MARLmethods. pandingtheCT.Nevertheless,itcanbeobservedthattheruntime
increasesexponentiallyingeneralwithrespecttothenumberofbombspersubtaskinFigure3b.Thisisexpectedgiventhecombi- thenextbesttaskassignmentthatmaximizesthereturnisgenerally
natorialenumerationoftaskassignmenttoOPENbeforeanyCT unknown.Therefore,arandomtaskassignmentthathasyettobe
expansionasshowninline1–13ofAlgorithm2. generatedwouldbeused,unlesstask-specificdomainknowledge
FromFigure3c,thesuccessrateandoptimalityrationaturally canbeutilizedtogenerateabiastowardsspecifictypesoftask
decreasewithanincreasingsecondspertimestepparameterfor assignment.Forexample,asimpleheuristicthatcanbeappliedto
bothCBS-TA-PTCandCBS-TAgiventhegrowingdifficultyofthe bothvariantsofCBSmethodswouldbetofavortaskassignments
taskwithshorterbombfusesandcountdownsintermsoftimesteps. wherethenumberofgoalsassignedtoeachagentisapproximately
Bycalculatingtheaverageinter-nodedistanceandusingthedefault equal.Naturally,amajordrawbackwouldbetheincreaseinrun-
walkingspeedof4.317𝑚𝑠−1inMinecraft,wefindthat2seconds timebyexpandingtheCTofunfeasibletaskassignmentsinterms
pertimestepisthebestapproximationoftheMinecraftdynamics, ofoptimality.Hence,thebetteralternativewouldbetoparallelize
towhichwehaveasuccessrateofapproximately0.65forCBS-TA- thegenerationoftherootnodestoOPENfromcombinationsof
PTCcomparedto0.15forCBS-TA.Hence,itisclearthattheusage taskassignmentbyleveragingtheusageofmultipleparalleloracles
ofvertexandedgeconflictsaloneinCBS-TAisinsufficienttosolve thataretypicallyimplementedasauser-designedRLenvironment
TAPF-PTCproblemsefficientlyingeneral. basedontheGymnasiumAPI[28]toevaluatethereturnofagiven
taskassignmentasshowninline7ofAlgorithm2,aroutinethat
consumesthemostruntimeforthetaskassignmentenumeration.
7 DISCUSSION
Givenmoderncomputingresources,theparallelizationcanbeim-
AsCBS-TA-PTCisanincompleteandsuboptimalalgorithmbyde- plementedpracticallyandefficientlyandwouldgreatlyameliorate
composingthetaskintosubtasksusinguser-definedheuristics,we theruntimedrawbackoftheCBS-TA-PTCfromthecombinato-
discussguidelinestoselectgoodheuristicstosorttheorderofthe rialenumerationoftaskassignment,makingCBS-TA-PTChighly
goalsfortheentiretaskasshowninline2inAlgorithm1.Ingeneral, viableforreal-worldapplications.
agoodcriterionwouldbetoselectaheuristicbasedonattributes Lastly, it is important to note that CBS-TA-PTC is unable to
thatdetermineabsolutetemporalrangeconstraints,giventhatthey addressstochasticityinenvironments,whicharebestaddressed
arehardconstraintsthatarethenaturalfirstorderofpriority.In withlearningmethodsthatcanpotentiallygeneralizetonoveland
thecaseofthebomb-defusingenvironment,theattributethatdeter- stochasticevents.DespitethefailureofMARLmethodsforthe
minesabsolutetemporalrangeconstraintsisthebombfuselength. bomb-defusingenvironment,futureworkcouldinvolvetheusage
Hence,thetaskallocationheuristicusedsortsthebombsinascend- ofCBS-TA-PTCasanexpertpolicytogeneratetrajectoriestoassist
ingorderoffuselength.Returningtotheautomatedfoodservice MARLmethodsviaimitationlearninginasimilarmannerasshown
contextasareal-worldmotivationmentionedinSection3,theabso- inPRIMAL[23],alongwithmethodsfromcurriculumlearning(e.g.
lutetemporalrangeconstraintisdeterminedbytheorderinwhich scalingdifficultyofthetaskastrainingprogresses).Webelievethat
customersarrive,leadingtoapracticalfirst-come-first-serveheuris- thestatedtrainingpipelinecangreatlyhelptheMARLmethods
tic.Incasesoftaskswithoutabsolutetemporalrangeconstraints,a becomemoresample-efficientinlearningandhencepotentially
sensibleheuristicwouldbetousetheK-Meansclusteringalgorithm moreviableandpracticalforapplicationsinreal-worldscenarios
[7],where𝑘 =numberofgoalspersubtask//numberofagents,to andtasks.
clustergoalsbasedontheirlocationsandarrangethemsuchthat
agentswouldvisitthenearestclusterfromtheirpreviouslocation. 8 CONCLUSION
AshighlightedinSection6.3.2,akeylimitationofCBS-TA-PTC Inthispaper,weproposetheCBS-TA-PTCalgorithmthatsimulta-
isitscombinatorialenumerationoftaskassignmenttoOPENbefore neouslygeneratestaskassignmentsaswellasfeasibleandcollision-
anyCTexpansionasshowninline1–13ofAlgorithm2thatcauses freepathsthatadheretoprecedenceandtemporalconstraintsfor
itsruntimetoscaleexponentiallytothenumberofbombspersub- agentstomaximizeauser-definedobjectivetosolvereal-world
task.Theunderlyingmotivationistoensurethatanyrootnode problems.WeevaluateCBS-TA-PTCinahighlychallengingbomb-
insertedtoOPENtobeexpandedhasthehighestreturnpossible defusingenvironmentwithprecedenceandtemporalconstraints
byorderingtheentiretaskassignmentbasedonreturnasshown andshowthatitcanefficientlysolvetasksrelativetoMARLand
inline15inAlgorithm2.Hence,thecorrespondingCTgenerated adaptedTAPFmethods.
fromtherootnodeswouldideallyhaveasfewconflictsaspossible
beforetheoptimalsolutionisfoundtohelpreduceruntime.Further- ACKNOWLEDGMENTS
more,itispossibletochanceuponanoptimalconflict-freesolution
ThisworkwaspartiallysupportedbyDARPAawardHR001120C0036
duringtheenumerationasshowninline9–11inAlgorithm2.A
andAFOSRawardFA9550-18-1-0097.WethankInioluwaOguntola
consequenceofthisdesignchoiceforCBS-TA-PTCisthatitpushes
forhiscontributionstothedevelopmentoftheenvironmentfor
thecombinatorialenumerationoftaskassignmentasthekeycon-
thebomb-defusingtask.
tributortotheruntimeratherthantheconflictresolutionprocess
showninline14–35ofAlgorithm2. REFERENCES
Toaddresstheaboveissue,anoptionwouldbetodesignavari-
[1] NolanBard,JakobNFoerster,SarathChandar,NeilBurch,MarcLanctot,HFrancis
antofCBS-TA-PTCwherethetaskassignmentisgeneratedon Song,EmilioParisotto,VincentDumoulin,SubhodeepMoitra,EdwardHughes,
demandsimilartothehighlevelofCBS-TA[8].However,unlike etal.2020. Thehanabichallenge:Anewfrontierforairesearch. Artificial
Intelligence280(2020),103216.
CBS-TAwherethenexttaskassignmentcanbegeneratedusing
[2] ZheChen,JavierAlonso-Mora,XiaoshanBai,DanielDHarabor,andPeterJ
anyoptimalassignmentalgorithm(e.g.Hungarianmethod[10]), Stuckey.2021. Integratedtaskassignmentandpathplanningforcapacitatedmulti-agentpickupanddelivery.IEEERoboticsandAutomationLetters6,3(2021), Intelligence321(2023),103946.
5816–5823. [21] TabishRashid,MikayelSamvelyan,ChristianSchroederDeWitt,GregoryFar-
[3] CorneliaFerner,GlennWagner,andHowieChoset.2013.ODrM*optimalmulti- quhar,JakobFoerster,andShimonWhiteson.2020.Monotonicvaluefunction
robotpathplanninginlowdimensionalsearchspaces.In2013IEEEInternational factorisationfordeepmulti-agentreinforcementlearning.TheJournalofMachine
ConferenceonRoboticsandAutomation.IEEE,3854–3859. LearningResearch21,1(2020),7234–7284.
[4] MeirGoldenberg,ArielFelner,RoniStern,GuniSharon,NathanSturtevant, [22] MikayelSamvelyan,TabishRashid,ChristianSchroederdeWitt,GregoryFar-
RobertCHolte,andJonathanSchaeffer.2014. Enhancedpartialexpansiona. quhar,NantasNardelli,TimG.J.Rudner,Chia-ManHung,PhiliphH.S.Torr,
JournalofArtificialIntelligenceResearch50(2014),141–187. JakobFoerster,andShimonWhiteson.2019.TheStarCraftMulti-AgentChallenge.
[5] FlorianGrenouilleau,Willem-JanvanHoeve,andJohnNHooker.2019.Amulti- CoRRabs/1902.04043(2019).
labelA*algorithmformulti-agentpathfinding.InProceedingsoftheInternational [23] GuillaumeSartoretti,JustinKerr,YunfeiShi,GlennWagner,TKSatishKumar,
ConferenceonAutomatedPlanningandScheduling,Vol.29.181–185. SvenKoenig,andHowieChoset.2019.Primal:Pathfindingviareinforcement
[6] JHall,IGalabova,LGottwald,andMFeldmeier.[n.d.].HiGHS–highperformance andimitationmulti-agentlearning. IEEERoboticsandAutomationLetters4,3
softwareforlinearoptimization. (2019),2378–2385.
[7] JohnAHartiganandManchekAWong.1979. AlgorithmAS136:Ak-means [24] GuniSharon,RoniStern,ArielFelner,andNathanRSturtevant.2015.Conflict-
clusteringalgorithm. Journaloftheroyalstatisticalsociety.seriesc(applied basedsearchforoptimalmulti-agentpathfinding.ArtificialIntelligence219(2015),
statistics)28,1(1979),100–108. 40–66.
[8] WolfgangHönig,ScottKiesel,AndrewTinka,JosephDurham,andNoraAyanian. [25] PaulShaw.1998.Usingconstraintprogrammingandlocalsearchmethodstosolve
2018.Conflict-basedsearchwithoptimaltaskassignment.InProceedingsofthe vehicleroutingproblems.InInternationalconferenceonprinciplesandpracticeof
InternationalJointConferenceonAutonomousAgentsandMultiagentSystems. constraintprogramming.Springer,417–431.
[9] QiHuangfuandJAJulianHall.2018. Parallelizingthedualrevisedsimplex [26] DavidSilver.2005.Cooperativepathfinding.InProceedingsoftheaaaiconference
method.MathematicalProgrammingComputation10,1(2018),119–142. onartificialintelligenceandinteractivedigitalentertainment,Vol.1.117–122.
[10] HaroldWKuhn.1955.TheHungarianmethodfortheassignmentproblem.Naval [27] RoniStern,NathanSturtevant,ArielFelner,SvenKoenig,HangMa,Thayne
researchlogisticsquarterly2,1-2(1955),83–97. Walker,JiaoyangLi,DorAtzmon,LironCohen,TKKumar,etal.2019. Multi-
[11] StevenMLaValle.2006.Planningalgorithms.Cambridgeuniversitypress. agentpathfinding:Definitions,variants,andbenchmarks.InProceedingsofthe
[12] MichaelLLittman.1994.Markovgamesasaframeworkformulti-agentrein- InternationalSymposiumonCombinatorialSearch,Vol.10.151–158.
forcementlearning.InMachinelearningproceedings1994.Elsevier,157–163. [28] MarkTowers,JordanK.Terry,ArielKwiatkowski,JohnU.Balis,Gianlucade
[13] RyanLowe,YiWu,AvivTamar,JeanHarb,PieterAbbeel,andIgorMordatch.2017. Cola,TristanDeleu,ManuelGoulão,AndreasKallinteris,ArjunKG,Markus
Multi-AgentActor-CriticforMixedCooperative-CompetitiveEnvironments. Krimmel,RodrigoPerez-Vicente,AndreaPierré,SanderSchulhoff,JunJetTai,
NeuralInformationProcessingSystems(NIPS)(2017). AndrewTanJinShen,andOmarG.Younis.2023.Gymnasium. https://doi.org/
[14] HangMa,DanielHarabor,PeterJStuckey,JiaoyangLi,andSvenKoenig.2019. 10.5281/zenodo.8127026
Searchingwithconsistentprioritizationformulti-agentpathfinding.InProceed- [29] GlennWagnerandHowieChoset.2015.Subdimensionalexpansionformultirobot
ingsoftheAAAIConferenceonArtificialIntelligence,Vol.33.7643–7650. pathplanning.Artificialintelligence219(2015),1–24.
[15] HangMaandSvenKoenig.2016.Optimaltargetassignmentandpathfinding [30] PeterRWurman,RaffaelloD’Andrea,andMickMountz.2008. Coordinating
forteamsofagents.arXivpreprintarXiv:1612.05693(2016). hundredsofcooperative,autonomousvehiclesinwarehouses.AImagazine29,1
[16] HangMa,CraigTovey,GuniSharon,TKKumar,andSvenKoenig.2016.Multi- (2008),9–9.
agentpathfindingwithpayloadtransfersandthepackage-exchangerobot- [31] ChaoYu,AkashVelu,EugeneVinitsky,JiaxuanGao,YuWang,AlexandreBayen,
routingproblem.InProceedingsoftheAAAIConferenceonArtificialIntelligence, andYiWu.2022.Thesurprisingeffectivenessofppoincooperativemulti-agent
Vol.30. games.AdvancesinNeuralInformationProcessingSystems35(2022),24611–24624.
[17] MojangStudios.2011.Minecraft.https://www.minecraft.net/. [32] JingjinYuandDanielaRus.2015. Pebblemotionongraphswithrotations:
[18] IgorMordatchandPieterAbbeel.2017.EmergenceofGroundedCompositional Efficientfeasibilitytestsandplanningalgorithms.InAlgorithmicFoundationsof
LanguageinMulti-AgentPopulations.arXivpreprintarXiv:1703.04908(2017). RoboticsXI:SelectedContributionsoftheEleventhInternationalWorkshoponthe
[19] RobertMorris,CorinaSPasareanu,KasperSøeLuckow,WaqarMalik,HangMa, AlgorithmicFoundationsofRobotics.Springer,729–746.
TKSatishKumar,andSvenKoenig.2016.Planning,SchedulingandMonitoring [33] HanZhang,JingkaiChen,JiaoyangLi,BWilliams,andSvenKoenig.2022.Multi-
forAirportSurfaceOperations..InAAAIWorkshop:PlanningforHybridSystems. AgentPathFindingforPrecedence-ConstrainedGoalSequences.InProceedingsof
608–614. theInternationalJointConferenceonAutonomousAgentsandMultiagentSystems.
[20] KeisukeOkumuraandXavierDéfago.2023.Solvingsimultaneoustargetassign- 1464—-1472.
mentandpathplanningefficientlywithtime-independentexecution.Artificial
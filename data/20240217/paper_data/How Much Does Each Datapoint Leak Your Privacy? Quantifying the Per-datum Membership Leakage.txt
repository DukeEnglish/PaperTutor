How Much Does Each Datapoint Leak Your Privacy?
Quantifying the Per-datum Membership Leakage
AchrafAzize1 DebabrotaBasu1
Abstract concernsandregulationsregardingtheuseofsensitivedata
ofusersgainedincreasingimportance(Voigt&Vondem
We study the per-datum Membership Inference
Bussche, 2017;Pardau, 2018; Lauxet al.,2024). For ex-
Attacks(MIAs),whereanattackeraimstoinfer
ample,GDPRinEUaskstosecureanyuser’srighttobe
whetherafixedtargetdatumhasbeenincludedin
indistinguishableandforgotten(Voigt&VondemBussche,
theinputdatasetofanalgorithmandthus,violates
2017). Thus, lookingintotheoutputofanMLmodelno
privacy. First,wedefinethemembershipleakage
oneshouldbeabletodetectauserorrecreateherdatum.
ofadatumastheadvantageoftheoptimaladver-
Forexample,regulations,suchasHIPAAinUSA,requires
sarytargetingtoidentifyit. Then,wequantifythe
anyMLmodelusinghealth-relatedinformationofpatients
per-datummembershipleakagefortheempirical
toensureandprotectprivacyofthepatients(Annas,2003).
mean, and show that it depends on the Maha-
lanobisdistancebetweenthetargetdatumandthe Growingbodyofworksonprivacyattackshaveshownthat
data-generatingdistribution.Wefurtherassessthe leakageofsensitiveinformationthroughMLmodelsisa
effectoftwoprivacydefences,i.e. addingGaus- commonissue,andincreaseswiththememorisationlevel
siannoiseandsub-sampling. Wequantifyexactly andthesizeoftheMLmodel(Shokrietal.,2017;Yeom
howbothofthemdecreasetheper-datummember- et al., 2018). For example, an attacker can reconstruct a
shipleakage. Ouranalysisbuildsonanovelproof largeMLmodelonlybyqueryingitandobservingthepre-
techniquethatcombinesanEdgeworthexpansion dictionsenoughnumberoftimes(Fredriksonetal.,2015;
ofthelikelihoodratiotestandaLindeberg-Feller Tramèretal.,2016;Karmakar&Basu,2023). Theattacker
centrallimittheorem. Ouranalysisconnectsthe canalsoviolateprivacyofusersinvolvedinainputdataset
existing likelihood ratio and scalar product at- by inferring whether a particular datum of a user is used
tacks,andalsojustifiesdifferentcanaryselection intheinputdataset. TheseattacksarecalledMembership
strategiesusedintheprivacyauditingliterature. InferenceAttacks(MIAs)(Homeretal.,2008;Shokrietal.,
Finally,ourexperimentsdemonstratetheimpacts 2017;Yeometal.,2018;Carlinietal.,2022),andareidenti-
oftheleakagescore,thesub-samplingratioand fiedasaprivacythreatforandconfidentialityviolationof
thenoisescaleontheper-datummembershipleak- theusersdatabyICO(UK)andNIST(USA)(Murakonda
ageasindicatedbythetheory. &Shokri,2020;Song&Marn,2020). Thus,asacaution,
MIAshasemergedasapopulartooltoempiricallyevaluate
theprivacyleakagebyanMLmodelusedinpracticalap-
1.Introduction plications,likelocationaggregators(Pyrgelisetal.,2017),
languagemodels(Mireshghallahetal.,2022),andothers.
ThesuccessfuldeploymentofMachineLearning(ML)mod-
elsandtheirinfluenceonoursocioeconomiclives(Wiens Related works: Tracing attacks. The study of statisti-
&Shenoy,2018;Petropoulosetal.,2020;OpenAI,2023) calefficiencyanddesignofMIAshasbeganongenomic
arenotonlydrivenbysmartalgorithmicadvancesbutalso data(Homeretal.,2008;Sankararamanetal.,2009;Dwork
use of large corpora of structured and unstructured data etal.,2015). Homeretal.(2008)andSankararamanetal.
acquiredthroughdifferentsources(Jainetal.,2020). As (2009) studied the first attack to detect an individual in
using large volume of data to train larger and larger neu- an exact statistics, i.e. empirical mean, computed on a
ral networks has almost become synonymous to efficient datasetgeneratedbyBernoullidistributions. Whilebothof
AI(Bommasanietal.,2021;OpenAI,2023;Google,2023), themproposetouselog-LikelihoodRatiobasedtests(aka
LRtests)andassumeaccesstotheexactstatistics,Dwork
1Équipe Scool, Univ. Lille, Inria, CNRS, Centrale Lille,
etal.(2015)assumetohaveaccesstoonlyanoisystatis-
UMR9189-CRIStAL,F-59000Lille,France.Correspondenceto:
tics,anddevelopsascalarproducttesttounderstandalign-
AchrafAzize<achraf.azize@inria.fr>.
mentofatargetdatapoint(akadatum)withthemarginals
Thisisapreprintunderreview.
1
4202
beF
51
]GL.sc[
1v56001.2042:viXraQuantifyingthePer-datumMembershipLeakage
Algorithm1Per-datumMembershipInference Table1. Per-datumLeakageindifferentsettings
Input: MechanismM,Data-generatingdistributionD,
SETTING LEAKAGESCORE
Numberofsamplesn,TargetExamplez⋆
Output: (o,b),whereo∈Oandb∈{0,1} EMPIRICALMEAN n1∥z⋆−µ∥2 Cσ−1
SB au mild pla ed ba ∼tas Bet erD no∼
uli
l(cid:78)
=
in
(cid:0)1
1
2D
(cid:1)
G SA UU BS S-S
S
II
A
MA
M
IN
LP
AN
L
RO INI PS
G
OE
I(
N( ργ T<> 10 ))
n1 (cid:0) z t⋆
aσ r2 gσ +2
nρ
−γ ∥2 µzn1
⋆
(cid:1)∥ T−z C⋆
µ
σ−
−∥ 12
Cµ (σ−∥ z12 C
t⋆
rσ− ue1
−µ)
ifb=1then
Samplej ∼U[n]
attackhasalsobeenstudiedunderthename“Membership
D ←Replace(D,j,z⋆){Putz⋆atpositionj inD}
inferencegameforafixedrecord"(Yeetal.,2022,Def3.3).
endif
Forrigourandsimplicity,westudytheper-datumMIattack
Leto∼M(D)
ondifferentempiricalmeansofadataset.
Return(o,b)
Connectionwithprivacyandauditing. Concurrenttothe
ofnoisystatistics. Often, theseattacksarecalledtracing studyofattacksondifferentmechanism,researchershave
attacks (Dwork et al., 2017), and also studied as the fin- workedondefensemechanismstoensureprivacyofusers
gerprintingcodes(Tardos,2008). Here,weaimtodevelop contributingtoinputofanalgorithm,andDifferentialPri-
aunifiedanalysisofthetracingattacksonbothexactand vacy(DP)hasemergedasthegoldstandard(Dwork&Roth,
noisyempiricalmeanstodetectagiventargetdatumwithout 2014). ThoughDPboundstheworstcaseprivacyleakage,
anyparametricassumptionondatageneratingdistribution. it is not always evident how these guarantees bound the
accuracy of privacy attacks, such as MIAs (Zhang et al.,
Related works: MIAs. In ML community, the design
2020;Humphriesetal.,2023). Additionally,Carlinietal.
of MIAs began with (Shokri et al., 2017). Due to a lack
(2022)demonstratethatMLmodelswithverylowornoDP-
ofhomogenousandcomprehensiveevaluationofMIAsin
guarantees(privacybudget[5000,∞))alsoprovidesome
theinitialliterature(Yeetal.,2022),differenttheoretically
defense against MIAs. All these observations have pro-
sound performance metrics, such as the advantage func-
pelledrecentdevelopmentsoftechniquestoauditprivacy
tions (Yeom et al., 2018) and Type-I/Type-II errors (Ye
leakage by different privacy-preserving (and also oblivi-
etal.,2022),areproposedtobeused. Onecentralissueis
ous)MLmodels(Maddocketal.,2022;Nasretal.,2023;
thattheexistingstudiesmostlylookintotheexpectedvalue
Steinkeetal.,2023;Pillutlaetal.,2023;Zanella-Béguelin
ofadvantagefunctionoveradataset(Song&Marn,2020;
etal.,2023). Thesealgorithmsapplydifferenttheoretical
Yeometal.,2018). Butitisknownthatprivacyisnotan
results and heuristics to find the most leaking datapoints
averagecasemetric(Steinke&Ullman,2020),andthus,if
(akacanaries)thatminimiseType-I/Type-IIerrorsinMIAs,
analysedproperly,someinputdatapointsarehardertoinfer
andfurtherusethemtoquantifythemaximumleakageof
aboutthantheothers(Carlinietal.,2022;Yeetal.,2022).
membershipinformationfromtheoutputofamechanism.
Leveragingthisknowledgeofdatumspecifichardnessof
Asweaimtounderstandthehardnessoftarget-dependent
leakageandproperdesignofLRtestsfordatum-adapatively
leakage,itshouldalsoprovideusawaytomeasureleakage
inferringmembershipshaverecentlyledtomoreefficient
throughdifferentmechanismsandquantifytheimpactof
MIAs. Thismotivatesustoaskthisquestion:
privacy-preservingmechanismsonleakage. Thus,weask
Whysomepointsarestatisticallyhardertoattackthan
Canwequantifytheleakageaboutadatumbyamechanism
othersandcanwequantifythishardnessofleakage?
anddoprivacy-preservingmechanismsreducetheleakage?
Per-datummembershipinference. Thus,inthispaper,we
Contributions. Studyingthesequestionsleadsusto:
studytheper-datumMIAs(Algorithm2),whereanattacker
1. Definingtheper-datumleakage. First,weformallydefine
aims to infer membership of a given datum in the input
theper-datumMIgameandshowthattheoptimaladversary
dataset while looking into the output of a mechanism. A
isalog-likelihoodratio(LR)test. Thisyieldsacharacteri-
mechanismcanbeastatisticcomputedonadataset(e.g.em-
sationoftheper-datumadvantagefunctionoftheoptimal
piricalmean)oranMLmodel(e.g. aneuralnetworktrained
adversaryintermsofTotalVariationdistance, andalsoa
with DP-SGD (Abadi et al., 2016).) In a per-datum MI,
definitionofmembershipleakageduetoafixeddatum.
anattackercanquerythemechanismwitheitheradataset
sampled from a data-generating distribution, or a dataset 2. Quantificationofper-datumleakageforempiricalmean.
that includes the target datum and rest of the entries are Now,weinstantiatetheLRtestfortheempiricalmean.First,
sampledfromthesamedata-generatingdistribution. While wefindtheasymptoticdistributionsofLRtestsifthetarget
lookingintothedistributionofoutputsforthesetwotypesof datumisincludedintheempiricalmeanandalsoifnot. Our
queries,theattackertriestoinferwhetherthetargetdatumis novelprooftechniquethatcombinesanEdgeworthexpan-
intheinputsetofthemechanismornot. Theper-datumMI sionwithLindeberg-Fellercentrallimittheoremshowsthat
2QuantifyingthePer-datumMembershipLeakage
theleakageduetoatargetz⋆ dependsonitsMahalanobis Algorithm2Per-datumMembershipInferenceGame
distance from the true mean (Table 1). This allows us to Input: MechanismM,Data-generatingdistributionD,
define a leakage score for a point and the optimal power Number of samples n, Target Example z⋆, Adversary
ofanLRtesttodetectit. Asaby-product, weproposea A ,NumberofroundsT
z⋆
plug-inLRtestforper-datumMIgamesthatbridgestheLR Output: AlistL∈{0,1}T,whereL =1iftheadver-
t
attacksandthescalarproductattacksintheliterature. sarysucceedsatstept.
3. Effects of noise addition, sub-sampling, and misspeci- InitialiseaemptylistLoflengthT
fiedtargetsonleakage. Weshowthattheexactempirical fort=1,...,Tdo
meanhasaninherentprivacylevel. Wefurtherstudythe
Sample(o t,b t)∼Algorithm1,withinputs(M,D,n,
impactofprivacy-preservingmechanisms,suchasGaussian
z⋆)
mechanism and sub-sampling, on the per-datum leakage.
Sampleˆb
t
∼A z⋆(o t)
(cid:110) (cid:111)
AsshowninTable1,bothofthemreducetheleakagescore SetL ←1 b =ˆb
t t t
ofadatumandthus,thepowersoftheoptimalattacks. Fi- endfor
nally,wequantifythemembershipleakageofatargetdatum ReturnL
duetomisspecificationandhowitdependsontheGaussian
geometryoftheLRtests. Wenumericallyvalidatethem. Aper-datumMIgamecanalsobeseenasahypothesis
testing (Yeom et al., 2018; Ye et al., 2022). Here, the
2.Membershipinferencegamesandleakage adversary tries to test the hypothesis “H : The output o
0
observedwasgeneratedfromadatasetsampledi.i.d. from
First, we introduce the per-datum membership inference
D", i.e. b = 0, versus “H : The target datum z⋆ was
game. Then,wediscussdifferentperformancemetricstoas- 1
includedintheinputdatasetproducingtheoutputo", i.e.
sessthepoweroftheadversary. Finally,wecharacterisethe
b = 1. We denote by p (o | z⋆) and p (o | z⋆) the
optimaladversariesusingthetheNeyman-Pearsonlemma. out in
distributionsoftheoutputounderH andH .
0 1
2.1.Background: MembershipInference(MI)games
Remark2.1(Per-datumandaverage-datumMIgames.). Per-
Let M be a randomised mechanism that takes as input a datum MI game is a variation of the average-datum MI
datasetDofnpointsbelongingtoZ andoutputso∈O. In Game proposed in (Yeom et al., 2018). There is a subtle
aMembershipInference(MI)game,anadversaryattempts differencebetweenper-datumandaverage-datumMIgames.
toinferwhetheragiventargetdatumz⋆wasincludedinthe Inper-datumMIgames,theadversaryateachroundtries
inputdatasetofM. Specifically,givenaccesstoanoutput to infer the presence of a fixed z⋆. In average-datum MI
o ∼ M(D), the adversary tries to infer whether z⋆ ∈ D games(Algorithm4),theaverage-datumadversaryisgiven
i.e. the input dataset that generated the output o. This is ateachroundadifferentpairof(z⋆,o)andtriestoinferthe
equivalenttoinferringthebitb≜1{z⋆ ∈D}. Wereferto presenceofz⋆inthedatasetthatgeneratedo. Furthercon-
thisastheper-datummembershipinferenceproblem,and nectionbetweenthetwogamesisdeferredtoAppendixB.
formaliseitinAlgorithm1.
2.2.Background: PerformancemetricsforMI
Algorithm 1 takes as input the mechanism M, the data-
generatingdistributionD,thenumberofsamplesnanda A datum-dependent adversary A z⋆ is a (possibly ran-
targetdatumz⋆. Thealgorithmstartsbysamplingadata- domised)functionthattakesasinputtheoutputogenerated
set D = {z 1,...,z n} of size n independently from the byAlgorithm1andoutputsaguessˆb ∼ A z⋆(o)tryingto
data-generating distribution. Then flips a fair coin b ∼ inferb. TheperformanceofA z⋆ canbeassessedeitherwith
Bern(1/2). Ifb=0,thealgorithmoutputso∼M(D),i.e. aggregatedmetricsliketheaccuracy(Shokrietal.,2017)
thecasewherez⋆ isnotincluded. Otherwiseifb = 1,z⋆ andtheadvantage(Yeometal.,2018),orwithtest-based
is included at a random position j in the dataset D, then metricslikeTypeIerror,TypeIIerror,andtrade-offfunc-
o∼M(D∪{z⋆}\{z }). Thealgorithmthenreturnsthe tions(Yeetal.,2022;Carlinietal.,2022).
j
output-secretbitpair(o,b).
The accuracy of A is defined as Acc (A ) ≜
z⋆ n z⋆
Theper-datumMIgame(Algorithm2)runsAlgorithm1in Pr[A z⋆(o) = b],wheretheprobabilityisoverthegenera-
multiplerounds. Ateachroundt, Algorithm1generates tionof(o,b)usingAlgorithm1withinput(M,D,n,z⋆).
a pair (o ,b ) and an adversary tries to reconstruct b by
t t t Theadvantageofanadversaryisthere-centredaccuracy:
onlyobservingo . Specifically,adatum-dependentadver-
t Adv (A ) ≜ 2Acc (A )−1. An adversary can use a
sary A takes as input only the output o generated from n z⋆ n z⋆
z⋆ threshold over a test function to conduct the MI games,
Algorithm 1 and outputs a guessˆb trying to infer b from
i.e. forA (o)≜1{s(o;z⋆)>τ}wheresisascoring
Algorithm1,i.e. whethertherecordz⋆wasincludedinthe s,τ,z⋆
functionandτ isathreshold. Inthissetting,wecandefine
datasetthatgeneratedoutputo.
twoerrorsfromthehypothesistestingformulation.
3QuantifyingthePer-datumMembershipLeakage
-TheTypeIerror,alsocalledtheFalsePositiveRate,is ThedetailedproofisinAppendixB.4. Asaconsequence
ofThm.2.2,wedefinethemembershipleakageofdatum
α (A )≜Pr[A (o)=1|b=0]. (1)
n s,τ,z⋆ s,τ,z⋆ z⋆,formechanismManddata-generatingdistributionD,
-TheTypeIIerror,alsocalledtheFalseNegativeRate,is
astheadvantageoftheoptimalBayesattackeronz⋆.
β (A )≜Pr[A (o)=0|b=1]. (2) Definition 2.3 (Membership leakage). The membership
n s,τ,z⋆ s,τ,z⋆ leakage of datum z⋆, for mechanism M, under data-
-Thepowerofthetestis1−β (A ). generatingdistributionDis
n s,τ,z⋆
Here, the probabilities are defined over the generation of ξ (z⋆,M,D)≜Adv (A ) (6)
(o,b)usingAlgorithm1withinputs(M,D,n,z⋆). InMI n n Bayes,z⋆
games, we want to design tests that maximise the power
Goal: Our main goal is to quantify the per-datum mem-
underafixedsignificancelevelα,i.e. weaimtoachieve
bershipleakageξ (z⋆,M,D)fordifferentsimplemecha-
n
Pow n(s,α,z⋆)≜ max1−β n(A s,τ,z⋆). (3) nisms,namelytheempiricalmeananditsvariations. The
τ∈Tα
per-datummembershipleakagecanbeintractabletochar-
whereT ≜ {τ ∈ R : α (A ) ≤ α}. Hereafter, we acteriseforanygenericdata-generatingdistribution. Toget
α n s,τ,z⋆
showthatthelog-LikelihoodRatio(LR)test,underdifferent overthislimitation,weusetheasymptoticpropertiesofthe
thresholds,maximisestheaggregatemetricsandachieves empiricalmeanasthemaintool. Westartbycharacterising
the best power under any significance level yielding the theasymptoticdistributionoftheLRtestwhenaspecific
optimaltrade-offbetweenTypeIandTypeIIerrors. targetdatumisincludedandwhenitisnot. Specifically,we
showthattheLRtestisasymptoticallydistributedasaGaus-
2.3.Leakagebyanoptimaladversary sianwhenboththedimensiondandthesamplesizengrow
to infinity. Then, a direct application of testing between
Given two distributions p and p generating the data re-
0 1 Gaussiandistributionsretrievestheoptimaladvantage,and
spectivelyunderhypothesesH andH ,notest,practical
0 1 thetypeI/typeIIerrorsoftheLRadversary.
orabstract,canachievebetterpowerthanthatoftheexact
LikelihoodRatio(LR)test(Neyman&Pearson,1933).
3.Per-datumleakagefromtheempiricalmean
Now, we recall the hypothesis testing formulation of the
per-datumMIgames,wherepout(o|z⋆)isthedistribution Westudytheempiricalmeanmechanism. First, wechar-
n
oftheoutputounderH andpin(o|z⋆)isthedistribution acterise the asymptotic distribution of the LR tests under
0 n
oftheoutputounderH 1. Then,thelog-likelihoodratiotest H 0andH 1. Then,wequantifythemembershipleakageof
forper-datumMIgameis
adatumz⋆,andshowthatitdependsontheMahalanobis
distancez⋆andthedatageneratingdistributionD. Finally,
(cid:18) pin(o|z⋆) (cid:19)
ℓ (o;z⋆)≜log n . (4) wecommentontheconnectionbetweentheapproximate
n pout(o|z⋆) LRtestandthescalarproducttestof(Dworketal.,2015),
n
andtheinherentprivacyoftheempiricalmean.
Now, we express a thresholding attacker deploying a
threshold τ on the log-likelihood test as A (o) ≜ Formulation and asymptotic regime. We denote by
1{ℓ (o;z⋆)>τ}, and A ≜ A ℓ b,τ e,z⋆ the log- Me nmp the empirical mean mechanism. Me nmp takes as
n Bayes,z⋆ ℓ,0,z⋆
input a dataset of size n from a d-dimensional space, i.e.
likelihood adversary with threshold τ = 0. Then, we
D ={Z ,...,Z }∈(Rd)n,andoutputstheexactempir-
getTheorem2.2asaconsequenceoftheNeyman-Pearson 1 n
ical mean µˆ ≜ 1 (cid:80)n Z ∈ Rd. The data-generating
lemma(Neyman&Pearson,1933). n n i=1 i
distributionhasameanµ ≜ (µ ,...,µ ) ∈ Rd andaco-
Theorem2.2(CharacterisingOptimalAdversaries). 1 d
variancematrixC ≜diag(σ2,...,σ2)∈Rd×d. Wealso
σ 1 d
(a)A istheadversarythatmaximisestheadvantage supposethatthedata-generatingdistributioniscolon-wise
Bayes,z⋆
(andaccuracy), i.e. foranyadversaryA z⋆, wehavethat independent,i.e. D =(cid:78)d j=1D
j
andhasafinite(4+δ)-th
Adv n(A Bayes,z⋆)−Adv n(A z⋆)≥0. momentforsomesmallδ,i.e. thereexistsδ >0,suchthat
E[Z4+δ] < ∞. Wedenoteby⇝convergenceindistribu-
(b)TheadvantageoftheoptimalBayesadversaryis
tion: X ⇝ X ifandonlyifPr(X ≤ x) → Pr(X ≤ x)
n n
Adv n(A Bayes,z⋆)=TV(cid:0) po nut(.|z⋆)(cid:13) (cid:13)pi nn(.|z⋆)(cid:1) , (5) forallx. Finally,letΦrepresenttheCumulativeDistribu-
tionFunction(CDF)ofthestandardnormaldistribution,i.e.
whereTVisthetotalvariationdistance. Φ(α) ≜ √1 (cid:82)α e−t2/2dtforα ∈ R. SincetheLRtest
2π −∞
(c) For every α ∈ [0,1], the log-likelihood test is the test canbenon-tractableingeneralcases,westudytheasymp-
thatmaximisesthepowerundersignificanceα,i.e. ∀αand toticbehaviouroftheLRtest,whenboththesamplesizen
anytestfunctions,Pow (ℓ ,α,z⋆)≥Pow (s,α,z⋆). andthedimensiondtendtoinfinitybutd/n=τ >0.
n n n
4QuantifyingthePer-datumMembershipLeakage
AsymptoticdistributionoftheLRtest. Fortheempirical The optimal log-likelihood ratio test is assumed to know
mean,thelog-likelihoodratioscoreis the true mean and covariance matrix. A straightforward
way to covert it into a realistic attack is by replacing
ℓ (µˆ ;z⋆,µ,C
)=(cid:88)d log(cid:32) pi nn ,j(µˆ n,j;z j⋆,µ j,σ j)(cid:33)
,
the true mean µ and co-variance C
σ
in Equation (10)
n n σ pout(µˆ ;z⋆,µ ,σ ) with empirical estimates. We can use a set of reference
j=1 n,j n,j j j j points Dref ≜ {Zref,...,Zref} sampled independently
w bh =er 0e ,µˆ an nd= pi( nµˆ n is,j t) hn j e= d1 i, sp tro n iu , bjt ui ts ioth ne od fi µˆstribu ut nio dn ero bfµ =ˆ n, 1j .u Hn ed re er
,
fr 1om (cid:80)Z n01,n . Z0 . r. e, fZ (Zn r, ez f⋆ )1 Tto
.
getµˆ 0n0 = n1 0 (cid:80)n i=0 1Z iref andCˆ 0 =
n,j n,j n0 i=1 i i
(µˆ ,b)isgeneratedusingAlgorithm1usingthemechanism
n This leads to an approximate log-likelihood ratio score
Me nmp,data-generatingdistributionD,numberofsamples
ℓapp(µˆ ;z⋆,Dref)=(z⋆−µˆ )TCˆ−1(µˆ −µˆ )− 1 ∥z⋆−
n,andthetargetdatumz⋆. n n n0 0 0 n 0 2n
µˆ ∥2 .Sincetheattackusesestimationoftherealmean
0 Cˆ−1
We recall that the Mahalanobis distance (Mahalanobis, andco0 variacnce,theempiricalLRtestisnolongeroptimal.
1936) of z⋆ with respect to D is ∥z⋆ − µ∥ Cσ−1, where ThedropinthepoweroftheempiricalLRtestdependon
∥z⋆ − µ∥2 = (cid:80)d (z j⋆−µj)2 . We denote by m⋆ the theaccuracyoftheestimation. Forexample,forBernoulli
Cσ−1 j=1 σ j2 distribution, (Sankararaman et al., 2009, Section T4.2.3)
limit as n and d grow to infinity of the Mahalanobis dis-
showsthatthedropinpowerofthetestdependsonλ= n0.
tance,dividedbythesamplesizen,i.e. n
(cid:104) (cid:105)
Remark 3.3. Since E ∥z⋆−µ∥2 = d, we have
1 z⋆∼D Cσ−1
m⋆ ≜lim ∥z⋆−µ∥2 (7) E [m⋆] = lim d = τ. Thus, our results retrieve
n,d n Cσ−1 z⋆∼D n,d n
the“average-datum"resultsof(Sankararamanetal.,2009,
whered,n→∞suchthatd/n=τ. SectionT8.1.1). Specifically,forBernoullidata-generating
distributions,Sankararamanetal.(2009)showsthattheLR
Theorem 3.1 (Asymptotic distribution of log-likelihood
testcorrespondingtotheaverage-dataMIgameisasymptot-
ratio). Using an Edgeworth asymptotic expansion of the
icallydistributedasN
(cid:0) −1τ,τ(cid:1)
underH andN
(cid:0)1τ,τ(cid:1)
likelihood ratio test and a Lindeberg-Feller central limit 2 0 2
underH . Toprovetheirresult,Sankararamanetal.(2009)
theorem,weshowthat 1
alsousesaLindeberg-FellerCLT.However,theiranalysisis
-UnderH 0: ℓ n(µˆ n;z⋆,µ,C σ)⇝N (cid:0) −1 2m⋆,m⋆(cid:1) tailoredforonlyBernoullidistributionsasitispossibleto
-UnderH 1: ℓ n(µˆ n;z⋆,µ,C σ)⇝N (cid:0) 21m⋆,m⋆(cid:1) c (cid:80)ha drac zte ⋆ri ls oe g(cid:16)th µˆe ne ,jx (cid:17)ac +t L (R
1
−tes zt, ⋆)i.e lo. gℓ (cid:16)n 1( −µˆ µˆn n; ,jz (cid:17)⋆,µ fo, rC σ ev) er=
y
wheretheconvergenceisaconvergenceindistribution,such j=1 j µ j 1−µ
n(Sankararamanetal.,2009,Sec. T1.2). Theproofalso
that d,n → ∞, while d/n = τ. We call m⋆ the leakage
uses specific concentration results of Bernoulli distribu-
scoreoftargetdatumz⋆.
tions(Sankararamanetal.,2009,Sec. T8.1.2). Ouranalysis
Corollary3.2(Per-datummembershipleakageoftheem- leadstothesameconclusionintheirsetupwithoutassuming
piricalmean). Theasymptoticleakageofadatumz⋆inthe theknowledgespecifictoBernoullidistributions.
empiricalmeanis
Connection to the scalar product attack. Dwork et al.
√ √
(cid:18) m⋆(cid:19) (cid:18) m⋆(cid:19)
(2015) analysed a simple scalar product attack for con-
limξ (z⋆,Memp,D)=Φ −Φ − (8)
n,d n n 2 2 ductingMIAontheempiricalmean. Theproposedadver-
sarythresholdsoverthescorefunctionsscal(µˆ ;z⋆,zref)≜
n
Theoptimalpowerachievableundersignificanceαis (z⋆−zref)Tµˆ . Theanalysisof(Dworketal.,2015)shows
n
(cid:16) √ (cid:17) thatwithonlyonereferencepointzref ∼ D,andevenfor
limPow n(ℓ n,α,z⋆)=Φ Φ−1(α)+ m⋆ (9) noisyestimatesofthemean,theattackisabletotracethe
n,d
data of some individuals. Our asymptotic approximation
√
underthethresholdτ =−m⋆ + m⋆Φ−1(1−α). ofthelog-likelihoodratioshowsthattheLRtestisalsoa
α 2
scalar-product attack but in a curved space of Gaussians.
ThedetailedproofsarepresentedinAppendixC. Thus,theLRtestcorrectsforthegeometryofthedatausing
theinversecovariancematrix. Ifthedata-generatingmatrix
Empirical likelihood ratio test. Following the proof of
hasthesamevarianceoverthecolumns,i.e. C =σI ,the
Theorem3.1,weshowinRemarkC.6thatasymptotically σ d
LR test and the scalar product test are equivalent up to a
innandd,
multiplicativeconstant,andthus,havethesamepower.
ℓ (µˆ ;z⋆,µ,C )
n n σ Inherentprivacyofempiricalmean.Theresultspresented
1 inthissectionshowthattheempiricalmeanalreadyhasan
≈(z⋆−µ)TC−1(µˆ −µ)− ∥z⋆−µ∥2 (10)
σ n 2n Cσ−1 inherent protection against MI attacks trying to infer the
5QuantifyingthePer-datumMembershipLeakage
presenceoftargetdatumz⋆. Anyadversarytryingtoinfer meansthattheresultsofSection3directlyapplytoMγ,by
n
thepresenceofz⋆ willhaveatradeofffunctionbetween replacingDbyD˜.
TypeIandTypeIIerrors. Thustheempiricalmeanhasa
√ The Mahalanobis distance of z⋆ with respect to D˜
m⋆-GaussianDP(Dongetal.,2019)protectionagainst
is ∥z⋆ − µ∥ , where ∥z⋆ − µ∥2 =
anyadversarytargetingz⋆. Thiscorrespondstoaninfinite (Cσ+Cγ)−1 (Cσ+Cγ)−1
collectionof(ϵ,δ)-DPguarantees,whereforforallϵ≥0, (cid:80)d (z j⋆−µj)2 . We denote by the leakage score m˜⋆, i.e.
j=1 σ2+γ2 γ
j j
√ √ thelimitoftheMahalanobisdistancedividedbythesample
(cid:18)
ϵ
m⋆(cid:19) (cid:18)
ϵ
m⋆(cid:19)
δ(ϵ)=Φ −√ + −eϵΦ −√ − . sizen,asnanddgrowtoinfinitybutd/n=τ.
m⋆ 2 m⋆ 2
1
m˜⋆ ≜lim ∥z⋆−µ∥2 (12)
TheresultisaconsequenceofEq.(8)and(Dongetal.,2019, γ n,d n (Cσ+Cγ)−1
Corollary2.13).
AdirectapplicationoftheresultsofSection3forD˜ yields
thefollowingtheorem.
4.ImpactofPrivacyDefensesand
Theorem4.1(Per-datummembershipleakageofthenoisy
MisspecificationonPer-datumLeakage
empiricalmean). Asd,n→∞whiled/n=τ,
Wefirstquantifytheeffectofaddingnoiseandsub-sampling -UnderH ,ℓ˜γ(µ˜ ;z⋆,µ,C )⇝N (cid:16) −m˜⋆ γ,m˜⋆(cid:17) .
0 n n σ 2 γ
on the membership leakage of the empirical mean. Both
defensesactlikecontractionoftheleakagescore. Adding -UnderH ,ℓ˜γ(µ˜ ;z⋆,µ,C )⇝N (cid:16) m˜⋆ γ,m˜⋆(cid:17) .
1 n n σ 2 γ
noiseincreasesthevarianceofthedataandthusdecreases
the Mahalanobis distance, while sub-sambling decreases
Theasymptoticleakageofz⋆inthenoisyempiricalmeanis
theeffectivenumberofsamples. Wealsostudytheeffect (cid:32)(cid:112) m˜⋆(cid:33) (cid:32) (cid:112) m˜⋆(cid:33)
of target misspecification. Finally, we give insights and limξ (z⋆,Mγ,D)=Φ γ −Φ − γ (13)
justificationforprivacyauditingbeyondtheempiricalmean. n,d n n 2 2
Theoptimalpowerachievableundersignificanceαis
4.1.Effectofaddingnoise
(cid:16) (cid:113) (cid:17)
Let us denote by Mγ the mechanism releasing the noisy limPow n(ℓ˜ n,α,z⋆)=Φ Φ−1(α)+ m˜⋆ γ (14)
n n,d
empiricalmeanofadatasetusingtheGaussianmechanism
withnoiseγ(Dwork&Roth,2014). Specifically,Mγ takes underthethresholdτ =−m˜⋆ γ +(cid:112) m˜⋆Φ−1(1−α).
n α 2 γ
as input a dataset of size n in a d-dimensional space, i.e.
Remark 4.2 (Privacy of noisy empirical mean). For any
D ={Z 1,...,Z n}∈(Rd)n,andoutputsthenoisymean noisescaleγ,m˜⋆ ≤ m⋆. Thus,thenoisymeanleaksless
γ
aboutthetargetdatumz⋆. TheGaussianmechanismacts
µ˜
n
≜ n1 (cid:80)n i=1Z i+ √1 nN
d
∈Rd,
byincreasingthevarianceoftheoriginaldatagenerating
distribution,andthusdecreasingtheMahalanobisdistance
whereN d ∼ N (0,C γ)suchthatγ = (γ 1,...,γ d) ∈ Rd betweenz⋆andthenewnoisydata-generatingdistribution.
andC γ =diag(cid:0) γ 12,...,γ d2(cid:1) ∈Rd×d. SimilartoSection3, Thenoisyempiricalmeanalsoprovidesa(cid:112) m˜⋆-Gaussian
γ
we assume that the data-generating distribution D has a
DP (Dong et al., 2019) protection against any adversary
meanµ ≜ (µ 1,...,µ d) ∈ Rd,acovariancematrixC σ ≜ targetingthepresenceofz⋆,whichcorrespondstoaninfinite
diag(σ2,...,σ2)∈Rd×d,andafinite(4+δ)-thmoment.
1 d collectionof(ϵ,δ)-DPguarantees,whereforallϵ≥0,
Fornoisyempiricalmean,theLRtestis (cid:32)
ϵ
(cid:112) m˜⋆(cid:33) (cid:32)
ϵ
(cid:112) m˜⋆(cid:33)
δ(ϵ)=Φ − + γ −eϵΦ − − γ
ℓ˜γ(µ˜ ;z⋆,µ,C
)=(cid:88)d log(cid:32) p˜i nn ,j(µ˜ n,j;z j⋆,µ j,σ j)(cid:33) (cid:112) m˜⋆ γ 2 (cid:112) m˜⋆ γ 2
n n σ
j=1
p˜o nu ,jt(µ˜ n,j;z j⋆,µ j,σ j) Incontrasttoempiricalmean(Section3),itispossibleto
(11) controltheDPlevelsbycontrollingthenoisescaleγ.
whereµ˜ =(µ˜ )n ,p˜outisthedistributionofµ˜ under
n n,j j=1 n,j n,j
b=0,andp˜in isthedistributionofµ˜ underb=1,for 4.2.Effectsofsub-sampling
n,j n,j
(µ˜ ,b)generatedusingAlgorithm1andM=Mγ.
n n Now, weconsidertheempiricalmeanwithsub-sampling
The output of Mγ could be re-written as µ˜ = mechanism(Balleetal.,2018)Msub,ρthatuniformlysub-
n n n
1 (cid:80)n (Z + N ), where (N ) ∼i.i.d N (0,C ). This samples k rows without replacement from the original
n i=1 i i i γ n
meansthattheMγ istheexactempricalmeanofni.i.dsam- dataset, and then computes the exact empirical mean of
n
plesfromanewdata-generatingdistributionD˜. Formally, the sub-sampled rows. Msub,ρ takes as input a dataset
n
µ˜ = 1 (cid:80)n Z˜ ,whereZ˜ ∼D˜ ≜D(cid:78) N (0,C ). This D ={Z ,...,Z }∈(Rd)nandoutputs
n n i=1 i i γ 1 n
6QuantifyingthePer-datumMembershipLeakage
µˆsub ≜ 1 (cid:80)n z 1{ς(i)≤k }.
kn kn i=1 i n
x
Here, k ≜ ρn, 0 < ρ < 1 and ς ∼unif S is a permu-
n n
x
tationsampleduniformlyfromthesetofpermutationsof
x
{1...,n},i.e. S ,andindependentlyfrom(Z ,...,Z ).
n 1 n
Forempiricalmeanwithsub-sampling,theLRtestis
Figure1.Theeffectofmisspecifyingthetargetdatumdependson
ℓs nub,ρ(µˆs nub;z⋆,µ,C σ) therelativeangleθ,betweenz⋆−µandztarg−µ,correctedby
=(cid:88)d log(cid:32) pi nn ,, jsub(µˆs nu ,jb;z j⋆,µ j,σ j) (cid:33)
. (15)
theinverseco-variancematrixC σ−1.
pout,sub(µˆsub;z⋆,µ ,σ ) 4.3.Attackingwithamisspecifiedtarget
j=1 n,j n,j j j j
Now, we suppose that the adversary has a misspecified
Here,µˆsub =(µˆsub)n ,pout,subisthedistributionofµˆsub target datum ztarg, that is different from the real z⋆ used
n n,j j=1 n,j n,j
underb = 0, andpin,sub isthedistributionofµˆsub under to generate the per-datum MI game in Algorithm 1. The
n,j n,j adversary then builds the LR test tailored for ztarg, i.e.
b = 1, given (µˆsub,b) are generated using Algorithm 1
n ℓ (µˆ ;ztarg,µ,C ),whereℓ isdefinedinSection3. This
appliedwithM=Msub,ρ. n n σ n
n isinterestinginthesettingwhereadifferentpublicdataset
AdaptingtheprooftechniqueusedfromSection3,weget is used to attack a model trained on a private dataset (Ye
thefollowingtheorem. DetailedproofsinAppendixC. etal.,2022;Karmakar&Basu,2023).
Theorem4.3(Per-datummembershipleakagefortheem- AsmentionedinSection3,themisspecifiedadversarywill
pirical mean with sub-sampling). First, we show that as never be optimal but it still can leak enough information
d,n→∞whiled/n=τ: depending on the amount of misspecification. Here, we
(cid:16) (cid:17) quantifythesub-optimalityofthemisspecifiedadversary,
-UnderH ,ℓsub,ρ(µˆsub;z⋆,µ,C )⇝N −ρm⋆,ρm⋆ .
0 n n σ 2 whichwedefineasameasureofleakagesimilaritybetween
(cid:16) (cid:17) ztarg andz⋆,i.e. toquantifyhowmuchztarg leaksinforma-
-UnderH 1,ℓs nub,ρ(µˆs nub;z⋆,µ,C σ)⇝N ρm 2⋆,ρm⋆ . tionaboutthepresenceofz⋆.
For the sub-sampling empirical mean mechanism, the Theorem 4.5 (Leakage of a misspecified adversary). We
asymptoticleakageofadatumz⋆is showthatasd,n←∞whiled/n=τ,
(cid:16) (cid:17)
limξ
(z⋆,Msub,ρ,D)=Φ(cid:18)√ ρm⋆(cid:19) −Φ(cid:18) −√ ρm⋆(cid:19) -UnderH 0,ℓ n(µˆ n;ztarg,µ,C σ)⇝N −mt 2arg,mtarg .
n,d n n 2 2 (cid:16) (cid:17)
-UnderH ,ℓ (µˆ ;ztarg,µ,C )⇝N m⋆−mdiff,mtarg
1 n n σ 2
Theoptimalpowerachievablegivensignificancelevelαis
Here, mtarg ≜ lim 1∥ztarg − µ∥2 and mdiff ≜
√
n,d n Cσ−1
l nim ,dPow n(ℓs nub,ρ,α,z⋆)=Φ(cid:0) z α+ ρm⋆(cid:1) (16) lim n,d n1∥ztarg−z⋆∥2 Cσ−1.
Let the adversary A use ℓ (µˆ ;ztarg,µ,C ) as the
√ miss n n σ
underthethresholdτ α =−ρm 2⋆ + ρm⋆Φ−1(1−α). LR test function, mtarg ≜ lim n,d n1∥ztarg −µ∥2 Cσ−1, and
Remark4.4(PrivacyofEmpiricalMeanwithSub-sampling). mscal ≜lim n,d n1 (ztarg−µ)T C σ−1(z⋆−µ). Then,
Foranysub-samplingratioρ ∈ (0,1),ρm⋆ ≤ m⋆. Thus,
(cid:16) (cid:17) (cid:16) (cid:17)
empiricalmeanwithsub-samplingleakslessaboutthetar- lim n,dAdv n(A miss)=Φ 2| √m msc ta al r|
g
−Φ − 2| √m msc ta al r|
g
.
get datum z⋆. The sub-sampling mechanism acts by de-
creasingthenumberofeffectivesampledpoints,andconse- If the MI adversary had well specified the target datum,
quentlydecreasingm⋆. Inaddition,thesub-sampledmean i.e. used z⋆ rather than ztarg, then she achieves the op-
√
providesa ρm⋆-GaussianDP(Dongetal.,2019)protec- timal asymptotic advantage lim ξ (z⋆,Memp,D) =
n,d n n
tionagainstanyadversarytargetingz⋆. Thiscorrespondsto Φ(cid:16)√ m⋆(cid:17) −Φ(cid:16) −√ m⋆(cid:17)
.
acollectionof(ϵ,δ)-DPguarantees,i.e. forallϵ≥0, 2 2
Theorem4.5quantifiesthesub-optimalityofthemisspecified
(cid:16) √ (cid:17) (cid:16) √ (cid:17)
δ(ϵ)=Φ −√ϵ + ρm⋆ −eϵΦ −√ϵ − ρm⋆ . adversary,whichis
ρm⋆ 2 ρm⋆ 2
∆(ztarg,z⋆)=lim ξ (z⋆,Memp,D)−Adv (A ).
In contrast to empirical mean (Sec. 3), it is possible to n,d n n n miss
controlDPlevelsbycontrollingthesub-samplingratioρ.
Indeed, ∆(ztarg,z⋆) ≥ 0, since by the Cauchy Schwartz
7QuantifyingthePer-datumMembershipLeakage
√
inequality,|mscal|≤ mtargm⋆.Themisspecifiedattackis three target datapoints in {0,1}d. (a) The easiest point
√
stillstrongaslongasthedifference mtargm⋆−|mscal|= toattackz⋆ isthepointwiththehighestMahalanobis
√ easy
mtargmtrue(1−|cos(θ)|)stayssmall. Wegeometrically distancewithrespecttop. Itisthepointwithbinarycoor-
illustrateθinFigure1. dinatesbeingthefurthestawayfromthecoordinatesofp:
z⋆ =(1{p≤1/2})d .(b)Similarly,thehardestpoint
4.4.Leakagebeyondtheempiricalmean: easy i=1
toattackisz⋆ =(1{p>1/2})d ,whichtakesthebi-
Anapplicationtoprivacyauditing hard i=1
nariesclosesttop. (c)Amediumpointtoattackisapoint
WeobservethatonestepofDP-SGDcorrespondstocom- randomlysampledfromthedata-generatingdistribution,i.e.
putingthenoisysub-sampledempiricalmeanofclippedloss z⋆ ∼Bern(p),forwhichtheMahalanobisdistanceisof
(cid:16) (cid:17) med
gradients.Specifically,θ =θ −η.1 (cid:80)B g˜t ,where orderdandtheleakagescoreisoforderτ =d/n. Further
t t−1 B i=1 i
g˜t =min(cid:110) 1, c (cid:111) ·gt+N (cid:0) 0,γ2c2I(cid:1) andgtistheloss experimentaldetailsareinAppendixE.
i ∥gt∥ i i
2 Resultsanddiscussion.WeillustratetheresultsinFigure2.
gradient. If the auditor has access to all the intermediate
1. Impactofz⋆: Figure2(a)and(b)showthedistributions
modelparameters{θ }t andthegradients,i.e. ifweare
j j=0 oftheapproximatelog-likelihoodratios(asinEq.(10))for
inawhite-boxattacksetting(Nasretal.,2023),designing
z⋆ andz⋆ ,respectively. Thesefiguresshowthatthe
anattackandacanaryselectionstrategyforDP-SGDare easy hard
LRdistributionsforz⋆ arebetterseparatedthanthoseof
equivalent to designing an attack and a canary selection easy
(cid:16) (cid:17) z⋆ ,andalsoconcentratedaroundtheirleakagescores,as
strategyfortheempiricalmean 1 (cid:80)B g˜t . hard
B i=1 i predictedbyTheorem3.1.
Ourresultssuggesttochooseascanariesthedatapoints 2. TightnessofPowerofTestAnalysis: Figure2(c)com-
forwhichtheMahalanobisdistancesoftheclippednoisy paresthetheoreticalpowerfunction(dottedline)withthe
gradientsg˜ itarebig,andtouseasaplug-inLRscorevt = empirical ROC curve of the for the approximate LR of
(cid:16) (cid:17)
(gˆt−µˆ )TCˆ−1 1(θt−1−θt)−µˆ − 1 ∥gˆt−µˆ ∥2 . Eq. (10) (solid line) for z⋆ . Figure 2 (c) validates that
t t η t 2qn t Cˆ−1 hard
t Eq.(14)tightlycharacterisestheROCcurve.
Here, µˆ and Cˆ are plug-in estimation of the mean and
t t
co-variance of the clipped noisy gradients, and gˆt is the 3. Impact of m⋆, noise, and sub-sampling ratio: Fig. 2
gradientofthetargetdatum. InAppendixD,wepresentex- (d) shows that the power of LR test uniformly increases
actlyhowourresultsrelatetotheprivacyauditingliterature withincreaseinm⋆. Fig.2(e)showsthatthepowerofLR
of(Steinkeetal.,2023;Nasretal.,2023;Leemannetal., testuniformlydecreaseswithincreaseinthenoisevariance
2023). Specifically,ouranalysistheoreticallyjustifiesthe γ2 of the Gaussian mechanism. Fig. 2 (f) shows that the
tightnessofthewhite-boxauditingof(Nasretal.,2023)and powerofLRtestuniformlydecreaseswithdecreaseinthe
theirDiraccanarystrategy,SectionC.2(Nasretal.,2023). sub-samplingratioρ. Thus,experimentsvalidatethatthe
impacts of datum-wise hardness of leakage and privacy-
preservingmechanismsaretightlycapturedbyouranalysis.
5.Experimentalanalysis
Now,weaimtoempiricallyvalidatethetheoreticalanalysis. 6.Conclusionandfuturework
Thus,weask
We study per-datum MI games, and characterise the per-
1. IsthedistributionoftheLRtesttightlycharacterisedby
datummembershipleakagefortheempiricalmeanandits
theGaussiandistributionsofTheorem3.1?
variations. Weshowthattheleakageduetoatargetdatum
2. Istheasymptoticapproximationsforthelog-likelihood isdependentontheMahalanobisdistancefromthemean
ratiotestsuggestedbyouranalysistightenough? ofthedatageneratingdistribution,andcapturesexactlythe
hardness of per-datum MI games (Table 1). Our generic
3. Are the power of the LR tests tightly determined by
analysisisabletocapturetheimpactofdifferentDPmech-
Eq(9),(14),and(16)fortheempiricalmean,noisyempir-
anisms,likeGaussiannoiseadditionandsub-sampling,and
icalmean,andsub-sampledempiricalmeanmechanisms,
usingmisspecifiedtargetdatumontheleakage. Finally,we
respectively?
numericallyvalidatethetightnessofouranalysis.
Experimentalsetup. Wetaken = 1000,τ = 5andthus
Asaperspective,itwouldbenaturaltoputtheinsightsof
d=5000. ThedatageneratingdistributionDisaddimen-
ouranalysisintodesigningtightwhite-boxandblack-box
sional Bernoulli distribution, with parameter p ∈ [0,1]d.
privacyauditingalgorithmsforpracticalMLmodels.
The three mechanisms considered are Memp, Mγ and
n n
Msub,ρ.Theadversarieschosenforeachmechanismarethe BroaderImpactStatement
n
thresholdingadversariesbasedontheasymptoticapproxi-
Thispaperpresentsworkwhosegoalistoadvancethefield
mationsofLRtests,asintheanalysis. Finally,wechoose
ofTrustworthyMachineLearning. Ourworktheoretically
8QuantifyingthePer-datumMembershipLeakage
0.12 m 2 m 2 Out 0.25 m 2 m 2 Out 1.0
In In
0.10 0.20 0.8
0.08
0.15 0.6
0.06
0.10 0.4
0.04
0.2
0.05
0.02 Empirical
0.0 Theoretical
0.00 0.00
20 15 10 5 0 5 10 15 20 7.5 5.0 2.5 0.0 2.5 5.0 7.5 10.0 0.0 0.2 0.4 0.6 0.8 1.0
LR Test LR Test False Positive Rate
(a)LRdistributiononeasytargetz⋆ (b)LRdistributiononhardtargetz⋆ (c)Theoreticalandempiricaltrade-offs
easy hard
1.0 1.0 1.0
0.8 0.8 0.8
0.6 0.6 0.6
0.4 m The o= re t7 ic.7 a5 l 0.4 m = =0 . 1 70 .43 0.4 = m 0 =.1 0 0.77
m = 5.61 = 0.50 = 0.50
0.2 Theoretical 0.2 m = 3.74 0.2 m = 3.87
m = 3.42 = 1.00 = 1.00
0.0 Theoretical 0.0 m = 1.47 0.0 m = 7.75
102 101 100 102 101 100 102 101 100
False Positive Rate (log) False Positive Rate (log) False Positive Rate (log)
(d)Effectofm⋆ (e)Effectofγ (f)Effectofρ
Figure2.Experimentaldemonstrationofthetheoreticalresultsandimpactsofm⋆,noise,andsub-samplingratioonleakage.Dottedlines
representtheoreticalboundsandsolidlinesrepresenttheempiricalresults.
quantifiestheprivacyleakageduetopubliclyreleasingsim- Balle,B.,Barthe,G.,andGaboardi,M. Privacyamplifica-
plestatistics,suchastheempiricalmeanofadataset. Our tionbysubsampling: Tightanalysesviacouplingsand
resultscanalsobegeneralisedtoMLmodels. Webelieve divergences. Advancesinneuralinformationprocessing
thatthisworkisastepforwardgivingtheanalyticaltoolsto systems,31,2018.
quantifytheprivacyleakageduetoaparticipationornotin
adataset. Thus,thisprovidesmoreinformeddecisionsto Bommasani, R., Hudson, D. A., Adeli, E., Altman, R.,
theindividualonhowmuchtheirparticipationmayimpact Arora,S.,vonArx,S.,Bernstein,M.S.,Bohg,J.,Bosse-
thepublishedstatistic/models. Wepointoutthatourwork lut,A.,Brunskill,E.,etal. Ontheopportunitiesandrisks
onlystudiestheoreticallythelikelihoodratiobasedattacks, offoundationmodels. arXivpreprintarXiv:2108.07258,
and our theoretical methods to dust for the presence of a 2021.
targetindividualswereonlyusedinsimulateddatainthe
Carlini,N.,Chien,S.,Nasr,M.,Song,S.,Terzis,A.,and
experiments.
Tramer,F. Membershipinferenceattacksfromfirstprin-
ciples. In2022IEEESymposiumonSecurityandPrivacy
References
(SP),pp.1897–1914.IEEE,2022.
Abadi, M., Chu, A., Goodfellow, I., McMahan, H. B.,
Dong, J., Roth, A., and Su, W. J. Gaussian differential
Mironov, I., Talwar, K., and Zhang, L. Deep learning
privacy. arXivpreprintarXiv:1905.02383,2019.
withdifferentialprivacy.InProceedingsofthe2016ACM
SIGSAC conference on computer and communications
Dwork, C. and Roth, A. The algorithmic foundations of
security,pp.308–318,2016.
differentialprivacy. FoundationsandTrends®inTheo-
reticalComputerScience,9(3–4):211–407,2014.
Annas,G.J. Hipaaregulations:aneweraofmedical-record
privacy? NewEnglandJournalofMedicine,348:1486, Dwork,C.,Smith,A.,Steinke,T.,Ullman,J.,andVadhan,
2003. S. Robusttraceabilityfromtraceamounts. In2015IEEE
56th Annual Symposium on Foundations of Computer
Arcolezi,H.H.andGambs,S. Revealingthetruecostof Science,pp.650–669.IEEE,2015.
local privacy: An auditing perspective. arXiv preprint
arXiv:2309.01597,2023. Dwork,C.,Smith,A.,Steinke,T.,andUllman,J. Exposed!
9
ytisneD
rewoP
ytisneD
rewoP
rewoP
rewoPQuantifyingthePer-datumMembershipLeakage
a survey of attacks on private data. Annual Review of Murakonda,S.K.andShokri,R. Mlprivacymeter: Aiding
StatisticsandItsApplication,4:61–84,2017. regulatorycompliancebyquantifyingtheprivacyrisks
ofmachinelearning. arXivpreprintarXiv:2007.09339,
Fredrikson, M., Jha, S., and Ristenpart, T. Model inver-
2020.
sionattacksthatexploitconfidenceinformationandba-
siccountermeasures. InProceedingsofthe22ndACM Nasr,M.,Hayes,J.,Steinke,T.,Balle,B.,Tramèr,F.,Jagiel-
SIGSAC conference on computer and communications ski, M., Carlini, N., and Terzis, A. Tight auditing of
security,pp.1322–1333,2015. differentially private machine learning. arXiv preprint
arXiv:2302.07956,2023.
Google, G. T. Gemini: a family of highly capable multi-
modalmodels. arXivpreprintarXiv:2312.11805,2023. Neyman, J. and Pearson, E. S. Ix. on the problem of the
mostefficienttestsofstatisticalhypotheses. Philosophi-
Homer,N.,Szelinger,S.,Redman,M.,Duggan,D.,Tembe, calTransactionsoftheRoyalSocietyofLondon.SeriesA,
W.,Muehling,J.,Pearson,J.V.,Stephan,D.A.,Nelson, ContainingPapersofaMathematicalorPhysicalChar-
S.F.,andCraig,D.W.Resolvingindividualscontributing acter,231(694-706):289–337,1933.
traceamountsofdnatohighlycomplexmixturesusing
high-densitysnpgenotypingmicroarrays. PLoSgenetics, OpenAI. Gpt-4 technical report. arXiv preprint
4(8):e1000167,2008. arXiv:2303.08774,2023.
Humphries,T.,Oya,S.,Tulloch,L.,Rafuse,M.,Goldberg, Pardau,S.L. Thecaliforniaconsumerprivacyact: Towards
I., Hengartner, U., and Kerschbaum, F. Investigating aeuropean-styleprivacyregimeintheunitedstates. J.
membershipinferenceattacksunderdatadependencies. Tech.L.&Pol’y,23:68,2018.
In2023IEEE36thComputerSecurityFoundationsSym-
Petropoulos, A., Siakoulis, V., Stavroulakis, E., and Vla-
posium(CSF),pp.473–488.IEEE,2023.
chogiannakis,N.E. Predictingbankinsolvenciesusing
machine learning techniques. International Journal of
Jain, A., Patel, H., Nagalapatti, L., Gupta, N., Mehta, S.,
Forecasting,36(3):1092–1113,2020.
Guttula,S.,Mujumdar,S.,Afzal,S.,SharmaMittal,R.,
andMunigala,V. Overviewandimportanceofdataqual-
Petrov,V.V. Sumsofindependentrandomvariables,vol-
ityformachinelearningtasks. InProceedingsofthe26th
ume82. SpringerScience&BusinessMedia,2012.
ACM SIGKDD international conference on knowledge
discovery&datamining,pp.3561–3562,2020. Pillutla, K., Andrew, G., Kairouz, P., McMahan, H. B.,
Oprea,A.,andOh,S. Unleashingthepowerofrandom-
Karmakar,P.andBasu,D. Marich: Aquery-efficientdistri-
izationinauditingdifferentiallyprivateml.arXivpreprint
butionallyequivalentmodelextractionattack. InThirty-
arXiv:2305.18447,2023.
seventh Conference on Neural Information Processing
Systems,2023. Pyrgelis, A., Troncoso, C., and De Cristofaro, E. Knock
knock,who’sthere? membershipinferenceonaggregate
Laux,J.,Wachter,S.,andMittelstadt,B. Trustworthyar- locationdata. arXivpreprintarXiv:1708.06145,2017.
tificial intelligence and the european union ai act: On
theconflationoftrustworthinessandacceptabilityofrisk. Sankararaman, S., Obozinski, G., Jordan, M. I., and
Regulation&Governance,18(1):3–32,2024. Halperin,E. Genomicprivacyandlimitsofindividualde-
tectioninapool. Naturegenetics,41(9):965–967,2009.
Leemann, T., Pawelczyk, M., and Kasneci, G. Gaus-
sian membership inference privacy. arXiv preprint Shokri,R.,Stronati,M.,Song,C.,andShmatikov,V. Mem-
arXiv:2306.07273,2023. bershipinferenceattacksagainstmachinelearningmod-
els. In2017IEEEsymposiumonsecurityandprivacy
Maddock,S.,Sablayrolles,A.,andStock,P. Canife: Craft- (SP),pp.3–18.IEEE,2017.
ingcanariesforempiricalprivacymeasurementinfeder-
Song, S. and Marn, D. Introducing a new pri-
atedlearning. arXivpreprintarXiv:2210.02912,2022.
vacy testing library in tensorflow, 2020. URL
Mahalanobis,P.C. Onthegeneraliseddistanceinstatistics. https://blog.tensorflow.org/2020/06/
In Proceedings of the National Institute of Science of introducing-new-privacy-testing-library.
India,volume12,pp.49–55,1936. html.
Mireshghallah,F.,Goyal,K.,Uniyal,A.,Berg-Kirkpatrick, Steinke, T. and Ullman, J. The pitfalls of av-
T.,andShokri,R. Quantifyingprivacyrisksofmasked eragecase differential privacy, 2020. URL
language models using membership inference attacks. https://differentialprivacy.org/
arXivpreprintarXiv:2203.03929,2022. average-case-dp/.
10QuantifyingthePer-datumMembershipLeakage
Steinke, T., Nasr, M., and Jagielski, M. Privacy au-
diting with one (1) training run. arXiv preprint
arXiv:2305.08846,2023.
Tardos,G. Optimalprobabilisticfingerprintcodes. Journal
oftheACM(JACM),55(2):1–24,2008.
Tramèr,F.,Zhang,F.,Juels,A.,Reiter,M.K.,andRisten-
part,T. Stealingmachinelearningmodelsviaprediction
{APIs}. In25thUSENIXsecuritysymposium(USENIX
Security16),pp.601–618,2016.
VanderVaart,A.W. Asymptoticstatistics,volume3. Cam-
bridgeuniversitypress,2000.
Voigt, P. and Von dem Bussche, A. The eu general data
protectionregulation(gdpr). APracticalGuide,1stEd.,
Cham: SpringerInternationalPublishing,10(3152676):
10–5555,2017.
Wiens,J.andShenoy,E.S.Machinelearningforhealthcare:
onthevergeofamajorshiftinhealthcareepidemiology.
Clinicalinfectiousdiseases,66(1):149–153,2018.
Ye, J., Maddi, A., Murakonda, S. K., Bindschaedler, V.,
andShokri,R. Enhancedmembershipinferenceattacks
againstmachinelearningmodels. InProceedingsofthe
2022ACMSIGSACConferenceonComputerandCom-
municationsSecurity,pp.3093–3106,2022.
Yeom,S.,Giacomelli,I.,Fredrikson,M.,andJha,S.Privacy
risk in machine learning: Analyzing the connection to
overfitting. In2018IEEE31stcomputersecurityfounda-
tionssymposium(CSF),pp.268–282.IEEE,2018.
Zanella-Béguelin,S.,Wutschitz,L.,Tople,S.,Salem,A.,
Rühle,V.,Paverd,A.,Naseri,M.,Köpf,B.,andJones,
D. Bayesianestimationofdifferentialprivacy. InInter-
nationalConferenceonMachineLearning,pp.40624–
40636.PMLR,2023.
Zhang, B., Yu, R., Sun, H., Li, Y., Xu, J., and Wang, H.
Privacyforall: Demystifyvulnerabilitydisparityofdif-
ferential privacy against membership inference attack.
arXivpreprintarXiv:2001.08855,2020.
11QuantifyingthePer-datumMembershipLeakage
A.Outline
Theappendicesareorganizedasfollows:
• Theconnectionbetweenper-datumandaverage-datumgamesisdiscussedinAppendixB.Also,aproofofTheorem2.2
isgiveninSectionB.4.
• AllthemissingproofsofTheorem3.1,Corollary3.2,Theorem4.3andTheorem4.5aregiveninAppendixC.There,
weintroducealsoourmaintechnicaltoolsfromasymptoticstatistics.
• TheapplicationofourresultstoprivacyauditingisdiscussedinAppendixD.
• ExtendedexperimentsarepresentedinAppendixE.
B.Per-datumV.Saverage-datumMembershipGames
Inthissection,wepresenttheaverage-datumMIgame,andconnectittotheper-datummembershipgame.
B.1.Theaverage-datumMembershipGame
Algorithm 3 takes as input the mechanism M, the data-generating distribution D and the number of samples n. The
algorithmstartsbysamplingadata-setD = {z ,...,z }ofsizenindependentlyfromthedata-generatingdistribution.
1 n
Thenflipsafaircoinb∼Bern(1/2). Ifb=0,thealgorithmoutputssamplesrandomlyatargetdatumfromz⋆ ∼Di.e.
thecasewherez⋆isnotincluded. Otherwiseifb=1,z⋆istakentobethej-thelementofDwherej ischosenrandomly.
Finally,thealgorithmsamplesanoutputo∼M(D),andreturnsthetuple(z⋆,o,b).
Theaverage-datumMIgame(Algorithm2)runsAlgorithm3inmultiplerounds. Ateachroundt,Algorithm3generates
thetuple(z⋆,o ,b )andanadversarytriestoreconstructb byonlyobservingthepair(z⋆,o ). Specifically,aaverage-
t t t t t t
datumadversaryAtakesasinputthepair(z⋆,o)generatedfromAlgorithm3andoutputsaguessˆbtryingtoinferbfrom
Algorithm3,i.e. whethertherecordz⋆wasincludedinthedatasetthatgeneratedoutputo. Theaverage-datumMIgame
(Algorithm2)correspondstothesettingstudiedin(Yeometal.,2018)formachinelearningtrainingmechanisms.
Anaverage-datumMIgamecanalsobeseenasahypothesistesting,wheretheadversarytriestotestthehypothesis“H :
0
Thepair(z⋆,o)observedwasgeneratedinthecasewhereowasgeneratedindependentlyfromz⋆,versus“H : Thepair
1
(z⋆,o)observedwasgeneratedinthecasewherez⋆wasincludedintheinputdatasetgeneratingo",i.e. b=1. Wedenote
byp (z⋆,z)thedistributionofthepair(z⋆,o)underH andp (z⋆,o)thedistributionofthepair(z⋆,o)underH .
out 0 in 1
B.2.Theaverage-datumMembershipadversaryanditsperformancemetric
Anaverage-dependentadversaryAisa(possiblyrandomised)functionthattakesasinputthepair(z⋆,o)generatedby
Algorithm3andoutputsaguessˆb∼A(z⋆,o)tryingtoinferb.TheperformanceofAcanbeassessedeitherwithaggregated
metricsliketheaccuracyandtheadvantage,orwithtest-basedmetricslikeTypeIerror,TypeIIerror,andtrade-offfunctions.
TheaccuracyofAisdefinedas
Acc (A)≜Pr[A(z⋆,o)=b], (17)
n
wheretheprobabilityisoverthegenerationof(z⋆,o,b)usingAlgorithm3withinput(M,D,n).
Theadvantageofanadversaryisthere-centredaccuracy.
Adv (A)≜2Acc (A)−1. (18)
n n
AnadversarycanuseathresholdoverascorefunctiontoconducttheMIgames,i.e. forA (z⋆,o)≜1{s(o;z⋆)>τ}
s,τ
wheresisascoringfunctionandτ isathreshold. Inthissetting,wecandefinetwoerrorsfromthehypothesistesting
formulation.
• TheTypeIerror,alsocalledtheFalsePositiveRate,is
α (A )≜Pr[A (z⋆,o)=1|b=0]. (19)
n s,τ s,τ
12QuantifyingthePer-datumMembershipLeakage
Algorithm3Average-datumMembershipProblem
Input: MechanismM,Data-generatingdistributionD,Numberofrecordsn
Output: (z⋆,o,b),wherez ∈Z,o∈Oandb∈{0,1}
n
(cid:78)
BuildadatasetD ∼ D
i=1
Sampleb∼Bernoulli(cid:0)1(cid:1)
2
ifb=0then
Samplez⋆ ∼Dind. ofD
else
Samplej ∼U[n]
Takeztobethej-thelementofD,i.e. z ←D
j
endif
Sampleo∼M(D)
Return(z⋆,o,b)
• TheTypeIIerror,alsocalledtheFalseNegativeRate,is
β (A )≜Pr[A (z⋆o)=0|b=1]. (20)
n s,τ s,τ
• Thepowerofthetestis1−β (A ).
n s,τ
Here,theprobabilitiesaredefinedoverthegenerationof(z⋆,o,b)usingAlgorithm1withinputs(M,D,n). InMIgames,
wewanttodesignteststhatmaximisethepowerunderafixedsignificancelevelα,i.e. weaimtoachieve
Pow (s,α)≜ max1−β (A ). (21)
n n s,τ
τ∈Tα
whereT ≜{τ ∈R:α (A )≤α}.
α n s,τ
B.3.Connectionbetweentheper-datumandaveragedatumMIgames
Anaverage-datumadversaryAcanberegardedasaninfinitecollectionofper-datumadversaries(A ) ,whereA(z⋆,o)=
z⋆ z⋆
A (o).
z⋆
Theadvantage(andaccuracy)ofAisthisjusttheexpectedadvantage(andaccuracy)ofA ,whenz⋆ ∼D,i.e.Adv (A)=
z⋆ n
E Adv (A ). Thus,studyingtheperformancemetricsofanadversaryunderAverage-datumMIgames"averages
z⋆∼D n z⋆
out"itsperformanceondifferenttargetpoints,whichtakesouttheeffectofspecificz⋆. Inaddition,usingAverage-datum
performancemetricforauditingprivacycanhurttheperformance,andabettergaincouldbeobservedbyjustrunningthe
sameattackona“easytoattack"per-datumMIgame.
TheoptimalLRtestattackforaverage-datumgamesisstillthelog-likelihoodratiotest:
(cid:18) pin(z⋆,o) (cid:19)
ℓ (o;z⋆)≜log n (22)
n pout(z⋆,o)
n
(cid:18) pin(o|z⋆)pin(z⋆) (cid:19)
=log n n (23)
pout(o|z⋆)pout(z⋆)
n n
(cid:18) pin(o|z⋆) (cid:19)
=log n (24)
pout(o|z⋆)
n
sincepin(z⋆)=pout(z⋆)=D(z⋆).
n n
Thus the same log-likelihood ratio test solves optimally both the per-datum and average-datum MI games. The only
differenceisinresultedperformancemetric,i.e. whetherweaverageouttheeffectofz⋆ ∼Dinaverage-datumMIgames
orwesupposethatz⋆isfixedforper-datumMIgames.
13QuantifyingthePer-datumMembershipLeakage
Algorithm4Average-datumMembershipInferenceGame
Input: MechanismM,Data-generatingdistributionD,Numberofsamplesn,AdversaryA,NumberofroundsT
Output: AlistL∈{0,1}T,whereL =1iftheadversarysucceedsatstept.
t
InitialiseaemptylistLoflengthT
fort=1,...,Tdo
Sample(z⋆,o ,b )∼Algorithm3,withinputs(M,D,n)
t t t
Sampleˆb ∼A(z⋆,o )
t t t
(cid:110) (cid:111)
SetL ←1 b =ˆb
t t t
endfor
ReturnL
B.4.ProofofTheorem2.2
Theorem 2.2 (Characterising Optimal Adversaries). (a) A is the adversary that maximises the advantage (and
Bayes,z⋆
accuracy),i.e. foranyadversaryA ,wehavethatAdv (A )−Adv (A )≥0.
z⋆ n Bayes,z⋆ n z⋆
(b)TheadvantageoftheoptimalBayesadversaryis
Adv n(A Bayes,z⋆)=TV(cid:0) po nut(.|z⋆)(cid:13) (cid:13)pi nn(.|z⋆)(cid:1) , (25)
whereTVisthetotalvariationdistance.
(c)Foreveryα∈[0,1],thelog-likelihoodscoreisthescorethatmaximisesthepowerundersignificanceα,i.e. foranyα
andanyscorefunctions,Pow (ℓ,α,z⋆)≥Pow (s,α,z⋆).
n n
Proof. Toprove(a),weobservethatthethelog-likelihoodadversarywiththresholdτ =0isexactlytheBayesoptimalclas-
(cid:16) (cid:17)
sifier. Specifically,sincePr(b=0)=Pr(b=1),wecanrewritethelog-likelihoodastheℓ (o;z⋆)=log Pr(b=1|o,z⋆) .
n Pr(b=0|o,z⋆)
Thusthresholdingwith0givesexactlytheBayesoptimalclassifier,whichhasthehighestaccuracyamongallclassifiers.
For(b),weobservethatAdv (A )=
n Bayes,z⋆
Pr(ℓ (o;z⋆)≤0|b=0)−Pr(ℓ (o;z⋆)≤0|b=1)
n n
=pout(O |z⋆)−pin(O |z⋆)
n n
whereO ≜{o∈O :pout(o|z⋆)≥pin(o|z⋆)}.
n n
ThelastequationisexactlythedefinitionoftheTV(cid:0) pout(.|z⋆)(cid:13) (cid:13)pin(.|z⋆)(cid:1)
.
n n
Finally,(c)isadirectconsequenceoftheNeyman-Pearsonlemma.
14QuantifyingthePer-datumMembershipLeakage
C.Missingproofs
First, we present some classic background results from asymptotic statics, the Edgeworth asymptotic expansion and
Linderberg-Fellerresults. Then,weprovidethemissingproofsofTheorem3.1,Theorem4.3andTheorem4.5.
C.1.Backgroundonasymptoticstatics
A sequence of random variables X is said to converge in distribution to a random variable X, i.e. X ⇝ X if
n n n
Pr(X ≤x)→Pr(X ≤x),foreveryxatwhichthelimitdistributionx→Pr(X ≤x)iscontinuous.
n
AsequenceofrandomvariablesX issaidtoconvergeinprobabilitytoX ifforeveryϵ>0,Pr(∥X −X∥>ϵ)→0,
n n
denotedbyX →P X.
n
Werecallthatcontinuousmappingspreservebothconvergences.
Asequenceofrandomvariable(X )iscalleduniformlytightif: foreveryϵ,∃M >0,suchthatsup Pr(∥X ∥>M)<ϵ.
n n n
TheoremC.1(Prohorov’stheorem). LetX bearandomvectorinRd.
n
1. IfX ⇝X,forsomeX,thenthesequence(X )isuniformlytight;
n n
2. If(X )isuniformlytight,thenthereexitsasubsequencewithX ⇝X asj →∞forsomeX.
n nj
Wealsorecallthestochastico andO notationforrandomvariables.
p p
DefinitionC.2(Stochastico andO ). WesaythatX =o (R )ifX =Y R andY →P 0
p p n p n n n n n
WesaythatX =O (R )ifX =Y R andY =O (1)andO (1)isdenotesasequencethatisuniformlytight(also
n p n n n n n p p
calledboundedinprobability)
ThefollowinglemmaisusedtoaftertogetTaylorexpansionsofrandomvariables.
Lemma C.3 (Lemma 2.12 in (Van der Vaart, 2000)). Let R be a function on damain Rk, such that R(0) = 0. Let
X =o (1).
n p
Then,foreveryp>0,
(a)ifR(h)=o(∥h∥p)ash→0,thenR(X )=o (∥X ∥p);
n p n
(b)ifR(h)=O(∥h∥p)ash→0,thenR(X )=O (∥X ∥p).
n p n
TheLindeberg-Fellertheoremisthesimplestextensionoftheclassicalcentrallimittheorem(CLT)andisapplicableto
independent(annotnecessarilyidenticallydistributed)randomvariableswithfinitevariances.
TheoremC.4(Lindeberg-FellerCLT). LetY ,...Y beindependentrandomvectorswithfinitevariancessuchthat
n,1 n,dn
1.
foreveryϵ>0,(cid:80)dn E(cid:2)
∥Y
∥2(cid:3)1{∥Y
∥>ϵ}→0,
j=1 n,i n,i
2. (cid:80)dn E[Y ]→µ,
j=1 n,i
3.
(cid:80)dn
Cov[Y ]→Σ.
j=1 n,i
Then(cid:80)dn Y ⇝N (µ,Σ)
j=1 n,j
Finally,thelastresultfromasymptoticstatisticsistheEdgeworthasymptoticexpansionintheCLT.
TheoremC.5(Edgeworthexpansion,Theorem15ofChapter7in(Petrov,2012)). LetZ ,...,Z sampledi.i.dfromD,
1 n
whereDhasafiniteabsolutemomentofk-thorder,i.e. E[|X |k] < ∞. Letd bethedensityofthecentrednormilized
1 n
mean σ√1 n(cid:80)n i=1X i,then
k−2 (cid:18) (cid:19)
d (x)=
√1 e−x2/2+(cid:88)q ν(x)
+o
1
(26)
n 2π nν/2 n(k−2)/2
ν=1
uniformlyinx,whereq (x)arerelatedtotheHermitePolynomials.
v
15QuantifyingthePer-datumMembershipLeakage
C.2.ProofofTheorem3.1
Theorem3.1(Asymptoticdistributionoflog-likelihoodratio). UsinganEdgeworthasymptoticexpansionofthelikelihood
ratiotestandaLindeberg-Fellercentrallimittheorem,weshowthat
-UnderH :
0
(cid:18) (cid:19)
1
ℓ (µˆ ;z⋆,µ,C )⇝N − m⋆,m⋆
n n σ 2
-UnderH :
1
(cid:18) (cid:19)
1
ℓ (µˆ ;z⋆,µ,C )⇝N m⋆,m⋆
n n σ 2
wheretheconvergenceisaconvergenceindistribution,suchthatd,n→∞,whiled/n=τ. Wecallm⋆theleakagescore
oftargetdatumz⋆.
Proof. Wehavethatµˆ
n
= n1 (cid:80)n i=1Z i,whereZ
i
=(Z i,j)d j=n
1
∈Rdn andZ
i
∼i.i.d D =(cid:78)d j=n 1D j.
EachdistributionD hasmeanµ andvarianceσ2.
j j j
Wedenoteµˆ =(µˆ )dn ,whereµˆ = 1 (cid:80)n Z .
n n,j j=1 n,j n i=1 i,j
Step1: Rewritingthelikelihoodratiotest
Letj ∈[1,d ].
n
UnderH ,wecanre-write
0
σ
µˆ =µ + √j Zˆ ,
n,j j n n,j
where
√ (cid:18) µˆ −µ (cid:19)
Zˆ ≜ n n,j j
n,j σ
n
=
√1 (cid:88)Z
i,j
−µ
j.
n σ
j
i=1
Since(Z )n arei.i.dfromD ,usingtheCLT,Zˆ ⇝ N(0,1).
i,j i=1 j n,j n→∞
Letd bethedensityfunctionofZˆ .
n,j n,j
Thedensitypoutofµˆ underH canbewrittenas
n,j n,j 0
√ √
(cid:20) (cid:21)
n n
pout(x;z⋆,µ ,σ )= d (x−µ )
n,j j j j σ n,j σ j
j j
UnderH ,wecanre-write
1
(cid:18) (cid:19)
1 n−1 σ
µˆ = z⋆+ µ + √ j Zˆ
n,j n j n j n−1 n−1,j
√
=µ + 1 (cid:0) z⋆−µ (cid:1) + σ j n−1 Zˆ
j n j j n n−1,j
Thedensitypin ofµˆ underH canbewrittenas
n,j n,j 1
(cid:20) (cid:18) (cid:19)(cid:21)
pin (x;z⋆,µ ,σ )= √n d √n x−µ − 1 (cid:0) z⋆−µ (cid:1)
n,j j j j σ n−1 n−1,j σ n−1 j n j j
j j
16QuantifyingthePer-datumMembershipLeakage
Thelikelihoodratiostatisticis
ℓ (µˆ ;z⋆,µ,C
)=(cid:88)dn log(cid:32) pi nn ,j(µˆ n,j;z j⋆,µ j,σ j)(cid:33)
n n σ pout(µˆ ;z⋆,µ ,σ )
j=1 n,j n,j j j j
=(cid:88)dn −1 log(cid:18)
1−
1(cid:19) +log(cid:32) d n−1,j(cid:0) δ nin ,j(cid:1)(cid:33)
(27)
(cid:0) (cid:1)
2 n d δout
j=1 n,j n,j
where
√
n
δout ≜ (µˆ −µ ) (28)
n,j σ n,j j
j
(cid:18) (cid:19)
δin ≜ √ n µˆ −µ + 1 (cid:0) µ −z⋆(cid:1) (29)
n,j n−1σ n,j j n j j
j
Step2: Asymptoticexpansionofthelikelihoodratiotest
UsingLemmaC.7,wehave
log(cid:32) d n−1,j(cid:0) δ nin ,j(cid:1)(cid:33) = 1(cid:16)(cid:0) δout(cid:1)2 −(cid:0) δin (cid:1)2(cid:17) + λ 3(cid:0) µ j −z j⋆(cid:1) R +o (cid:18) 1(cid:19) (30)
d (cid:0) δout(cid:1) 2 n,j n,j nσ n,j p n
n,j n,j j
(31)
LetY ≜ 1(cid:16)(cid:0) δout(cid:1)2 −(cid:0) δin (cid:1)2(cid:17) + λ3(µj−z j⋆) R .
n,j 2 n,j n,j nσj n,j
Weremarkthatweneedanexpansionuptoo
(cid:0)1(cid:1)
,sinced /n=τ +o(1).
p n n
Thus
ℓ (µˆ ;z⋆,µ,C
)=(cid:88)dn −1 log(cid:18)
1−
1(cid:19) +log(cid:32) d n−1,j(cid:0) δ nin ,j(cid:1)(cid:33)
(32)
n n σ 2 n d (cid:0) δout(cid:1)
j=1 n,j n,j
(cid:88)dn (cid:18)
1
(cid:18) 1(cid:19)(cid:19)
= +Y +o (33)
2n n,j p n
j=1
τ
(cid:88)dn
= +o (1)+ Y (34)
2 p n,j
j=1
because dn =τ +o(1).
n
Step3: ConcludingusingtheLindeberg-FellerCLT
UnderH :
0
UsingLemmaC.8,E [Y ,j]=− 1 − (z j⋆−µj)2 +o(cid:0)1(cid:1) andV [Y ,j]= (z j⋆−µj)2 +o(cid:0)1(cid:1) .
0 n 2n 2nσ2 n 0 n nσ2 n
j j
Since(cid:80)dn (z j⋆−µj)2
=
∥z⋆−µ∥2 Cσ−1
,weget:
j=1 nσ2 n
j
• (cid:80)dn E [Y ,j]→−τ − m⋆
j=1 0 n 2 2
• (cid:80)dn V [Y ,j]→m⋆
j=1 0 n
17QuantifyingthePer-datumMembershipLeakage
UsingLemmaC.9,wehavethatY verifytheLindeberg-Fellercondition,i.e.
n,j
(cid:88)dn
E (cid:2) Y2 1{|Y |>ϵ}(cid:3) →0
0 n,j n,j
j=1
foreveryϵ>0.
(cid:16) (cid:17)
WeconcludeusingtheLindeberg-FellerCLTthat(cid:80)dn Y ⇝N −τ − m⋆,m⋆ ,andthus
j=1 n,j 2 2
(cid:18) m⋆ (cid:19)
ℓ (µˆ ;z⋆,µ,C )⇝N − ,m⋆ (35)
n n σ 2
Similarly,UnderH :
1
UsingLemmaC.8,E [Y ,j]=− 1 + (z j⋆−µj)2 +o(cid:0)1(cid:1) andV [Y ,j]= (z j⋆−µj)2 +o(cid:0)1(cid:1) .
1 n 2n 2nσ2 n 1 n nσ2 n
j j
Weget:
• (cid:80)dn E [Y ]→−τ + m⋆
j=1 1 n,j 2 2
• (cid:80)dn V [Y ]→m⋆
j=1 1 n,j
UsingLemmaC.9,wehavethatY verifytheLindeberg-Fellercondition,i.e.
n,j
(cid:88)dn
E (cid:2) Y2 1{|Y |>ϵ}(cid:3) →0
1 n,j n,j
j=1
foreveryϵ>0.
(cid:16) (cid:17)
WeconcludeusingtheLindeberg-FellerCLTthat(cid:80)dn Y ⇝N −τ + m⋆,m⋆ ,andthus
j=1 n,j 2 2
(cid:18) m⋆ (cid:19)
ℓ (µˆ ;z⋆,µ,C )⇝N ,m⋆ (36)
n n σ 2
RemarkC.6. Expanding 1(cid:16)(cid:0) δout(cid:1)2 −(cid:0) δin (cid:1)2(cid:17) ,takingitssomeforj =1untild andignoringtermsthatareino(1/n),
2 n,j n,j n
wegetthat
1
ℓ (µˆ ;z⋆,µ,C )≈(z⋆−µ)TC−1(µˆ −µ)− ∥z⋆−µ∥2 (37)
n n σ σ n 2n Cσ−1
C.3.ThethreetechnicallemmasusedtointheproofofTheorem3.1
LemmaC.7. Asymptoticexpansionofthelikelihoodratiotest
Weshowthat
log(cid:32) d n−1,j(cid:0) δ nin ,j(cid:1)(cid:33) = 1(cid:16)(cid:0) δout(cid:1)2 −(cid:0) δin (cid:1)2(cid:17) + λ 3(cid:0) µ j −z j⋆(cid:1) R +o (cid:18) 1(cid:19)
d (cid:0) δout(cid:1) 2 n,j n,j nσ n,j p n
n,j n,j j
√
whereδ nou ,jt ≜ σjn(µˆ n,j −µ j),δ nin ,j ≜ √ n−n 1σj (cid:0) µˆ n,j −µ j + n1 (cid:0) µ j −z j⋆(cid:1)(cid:1) ,
andR ≜(cid:0) δout(cid:1)2 +δoutδin +(cid:0) δin (cid:1)2 −3.
n,j n,j n,j n,j n,j
18QuantifyingthePer-datumMembershipLeakage
Proof. Step1: Asymptoticexpansionofd
n,j
UsingTheorem15ofChapter7fromPetrov,fork =4,wegetthat
(cid:18) (cid:19) (cid:18) (cid:19)
d n,j(x)= √1 2πe−x 22 1+ h √1( nx) + h 2 n(x) +o n1 (38)
uniformlyinx,where
h (x)≜λ (cid:0) x3−3x(cid:1)
1 3
h (x)≜ λ2 3 (cid:0) x6−15x4+45x2−15(cid:1) + λ 4 (cid:0) x4−6x2+3(cid:1)
2 72 24
andλ ≜ γj,k whereγ isthek-ordercumulantofdistributionD .
k σk j,k j
j
Wedoanexpansionuptothe4-thorder,sinceweneedanexpansionuptoo
(cid:0)1(cid:1)
.
p n
Step2: Asymptoticexpansionofd (cid:0) δout(cid:1) andd (cid:0) δin (cid:1)
n,j n,j n−1,j n,j
SincetheconvergenceinuniforminEquation38,wegetthat
d n,j(cid:0) δ nou ,jt(cid:1) = √1 2πe−(δnou 2,jt)2 (cid:18) 1+ h 1( √δ n nou ,jt) + h 2(δ nnou ,jt) +(cid:19) +o p(cid:18) n1(cid:19)
=
√1 2πe−(δnou 2,jt)2 (cid:18)
1+
h 1( √δ
n
nou ,jt)
+
h 2(δ nnou ,jt) +e(δnou 2,jt)2
o
p(cid:18) n1(cid:19)(cid:19)
(39)
and
d n−1,j(cid:0) δ nin ,j(cid:1) = √1 2πe−(δnin 2,j)2 (cid:32) 1+ h √1 n(δ −nin ,j 1) + h n2( −δ nin , 1j)(cid:33) +o p(cid:18) n1(cid:19)
= √1 2πe−(δnin 2,j)2 (cid:32) 1+ h √1 n(δ −nin ,j 1) + h n2( −δ nin , 1j) +e(δnin 2,j)2 o p(cid:18) n1(cid:19)(cid:33) (40)
UnderbothH andH ,δin ⇝ Z ≜N(0,1)andδout ⇝ Z′ ≜N(0,1).
0 1 n,j n→∞ n,j n→∞
Sincex→ex2/2isacontinuousfunction,thene(δnin 2,j)2
⇝
n→∞
eZ2/2ande(δnou 2,jt)2
⇝
n→∞
e(Z′)2/2.
UsingProhorov’stheorem(ThmC.1),wegetthate(δnin 2,j)2
=O
p(1)ande(δnou 2,jt)2
=O p(1).
Thismeansthat
(δnin ,j)2 (cid:18) 1(cid:19) (cid:18) 1(cid:19) (cid:18) 1(cid:19)
e 2 o p n =O p(1)o p n =o p n (41)
and
(δnou ,jt)2 (cid:18) 1(cid:19) (cid:18) 1(cid:19) (cid:18) 1(cid:19) (cid:18) 1(cid:19)
e 2 o p n =O p n o p n =o p n . (42)
Ontheotherhand,bothh andh arecontinuousfunctions(polynomialsfunctions),thissimilarlygivesthath (δin )=
1 2 1 n,j
O (1)andh (δin )=O (1).
p 2 n,j p
Combinedwiththefactthat √1 = √1 +o(cid:0)1(cid:1) and 1 = 1 +o(cid:0)1(cid:1) ,wegetthat
n−1 n n n−1 n n
19QuantifyingthePer-datumMembershipLeakage
h √1(δ nin ,j)
=
h
1
√(δ nin ,j)
+O
(1)o(cid:18) 1(cid:19)
=
h
1
√(δ nin ,j)
+o
(cid:18) 1(cid:19)
(43)
n−1 n p n n p n
and
h 2(δ nin ,j)
=
h 1(δ nin ,j)
+O
(1)o(cid:18) 1(cid:19)
=
h 1(δ nin ,j)
+o
(cid:18) 1(cid:19)
(44)
n−1 n p n n p n
PluggingEq.42inEq.39gives
d n,j(cid:0) δ nou ,jt(cid:1) = √1 2πe−(δnou 2,jt)2 (cid:18) 1+ h 1( √δ n nou ,jt) + h 2(δ nnou ,jt) +o p(cid:18) n1(cid:19)(cid:19) (45)
andPluggingEq.41,Eq.43andEq.44inEq.40gives
d n−1,j(cid:0) δ nin ,j(cid:1) = √1 2πe−(δnin 2,j)2 (cid:32) 1+ h 1 √(δ nnin ,j) + h 2( nδ nin ,j) +o p(cid:18) n1(cid:19)(cid:33) (46)
Step3: Asymptoticexpansionofthelogarithm
ApplyingthelogarithmtoEq.45,wegetthat
log(cid:0)
d
(cid:0) δout(cid:1)(cid:1) =−1
log(2π)−
(δ nou ,jt)2 +log(cid:18)
1+
h 1( √δ nou ,jt)
+
h 2(δ nou ,jt)
+o
(cid:18) 1(cid:19)(cid:19)
n,j n,j 2 2 n n p n
1 (δout)2
=− log(2π)− n,j +log(1+H ,j) (47)
2 2 n
whereH
n,j
≜ h1( √δ n nou ,jt) + h2(δ nnou ,jt) +o p(cid:0) n1(cid:1) .
LetR(h)=log(1+h)−(h− h2),forh∈R+.
2
WehavethatR(0)=0andR(h)=o(cid:0) h2(cid:1)
ash→0.
(cid:16) (cid:17)
Ontheotherhand,H
n,j
→P
n→∞
0. SpecificallyH
n,j
=O
p
√1
n
.
UsingLemmaC.3,wegetthatR(H ,j)=o
(cid:0)
(H
,j)2(cid:1)
=o
(cid:0)1(cid:1)
.
n p n p n
Allinall,wehaveshown
H2 (cid:18) 1(cid:19)
log(1+H )=H − n,j +o
n,j n,j 2 p n
=
h 1( √δ nou ,jt)
+
1 (cid:18)h 2(δ nou ,jt)
−
1(cid:0)
h
(δout)(cid:1)2(cid:19)
+o
(cid:18) 1(cid:19)
n n n 2 1 n,j p n
PluggingthisinEq.47,wegetthat
log(cid:0)
d
(cid:0) δout(cid:1)(cid:1) =−1
log(2π)−
(δ nou ,jt)2
+
h 1( √δ nou ,jt)
+
1 (cid:18)h 2(δ nou ,jt)
−
1(cid:0)
h
(δout)(cid:1)2(cid:19)
+o
(cid:18) 1(cid:19)
(48)
n,j n,j 2 2 n n n 2 1 n,j p n
Similarly,wecanshowthat
log(cid:0) d (cid:0) δin (cid:1)(cid:1) =−1 log(2π)− (δ nin ,j)2 + h 1 √(δ nin ,j) + 1 (cid:32) h 2(δ nin ,j) − 1(cid:0) h (δin )(cid:1)2(cid:33) +o (cid:18) 1(cid:19) (49)
n−1,j n,j 2 2 n n n 2 1 n,j p n
20QuantifyingthePer-datumMembershipLeakage
Step4: Asymptoticexpansionofpolynomialsinδin andδout
n,j n,j
First,wehave
δin =(cid:114) n δout+ µ √j −z j⋆
n,j n−1 n,j σ n−1
j
=δout+ µ j − √z j⋆ +o (cid:18) √1 (cid:19)
n,j σ n p n
j
Whichgives
h (cid:0) δout(cid:1) −h (cid:0) δin (cid:1) =λ (cid:16)(cid:0) δout(cid:1)3 −(cid:0) δin (cid:1)3 +(cid:0) δout−δin (cid:1)(cid:17)
1 n,j 1 n,j 3 n,j n,j n,j n,j
=λ (cid:0) δout−δin (cid:1)(cid:16)(cid:0) δout(cid:1)2 +δoutδin +(cid:0) δin (cid:1)2 −3(cid:17)
3 n,j n,j n,j n,j n,j n,j
=λ R
(cid:18)z j⋆− √µ j
+o
(cid:18) √1 (cid:19)(cid:19)
3 n,j σ n p n
j
whereR ≜(cid:0) δout(cid:1)2 +δoutδin +(cid:0) δin (cid:1)2 −3,whichcanbewrittenasapolynomialinδout.
n,j n,j n,j n,j n,j n,j
ThusR =O (1),whichmeansthat
n,j p
h (cid:0) δout(cid:1) −h (cid:0) δin (cid:1) =λ R (cid:18)z j⋆− √µ j(cid:19) +o (cid:18) √1 (cid:19) (50)
1 n,j 1 n,j 3 n,j σ n p n
j
(cid:18) (cid:19)
1
=O √ (51)
p n
Similarly,onecanshowthat
(cid:18) (cid:19)
h (cid:0) δout(cid:1) −h (cid:0) δin (cid:1) =O √1 (52)
2 n,j 2 n,j p n
and
(cid:18) (cid:19)
h2(cid:0) δout(cid:1) −h2(cid:0) δin (cid:1) =O √1 . (53)
1 n,j 1 n,j p n
Step5: Summarisingtheasymptoticexpansionofthelog-likelihoodratiotest
Allinall,wegetthat
log(cid:32) d n−1,j(cid:0) δ nin ,j(cid:1)(cid:33) = 1(cid:16)(cid:0) δout(cid:1)2 −(cid:0) δin (cid:1)2(cid:17) + λ 3(cid:0) µ j −z j⋆(cid:1) R +o (cid:18) 1(cid:19)
d (cid:0) δout(cid:1) 2 n,j n,j nσ n,j p n
n,j n,j j
LemmaC.8. Expectationandvariancecomputations
E [Y ]=−
1
−
(z j⋆−µ j)2 +o(cid:18) 1(cid:19)
V [Y ]=
(z j⋆−µ j)2 +o(cid:18) 1(cid:19)
0 n,j 2n 2nσ2 n 0 n,j nσ2 n
j j
E [Y ]=−
1
+
(z j⋆−µ j)2 +o(cid:18) 1(cid:19)
V [Y ]=
(z j⋆−µ j)2 +o(cid:18) 1(cid:19)
1 n,j 2n 2nσ2 n 1 n,j nσ2 n
j j
21QuantifyingthePer-datumMembershipLeakage
Proof. Letusrecallthat
Y ≜ 1(cid:16)(cid:0) δout(cid:1)2 −(cid:0) δin (cid:1)2(cid:17) + λ
3(cid:0)
µ j −z
j⋆(cid:1)
R (54)
n,j 2 n,j n,j nσ n,j
j
whereR ≜(cid:0) δout(cid:1)2 +δoutδin +(cid:0) δin (cid:1)2 −3
n,j n,j n,j n,j n,j
UnderH :
0
SinceE (µˆ )=µ andV (µˆ )= 1σ2,wegetthat
0 n,j j 0 n,j n j
E (cid:0) δout(cid:1) =0 E (cid:16)(cid:0) δout(cid:1)2(cid:17) =1 (55)
0 n,j 0 n,j
E (cid:0) δin (cid:1) = µ √j −z j⋆ E (cid:16)(cid:0) δin (cid:1)2(cid:17) =1+ 1 + (cid:0) µ j −z j⋆(cid:1)2 +o(cid:18) 1(cid:19) (56)
0 n,j σ n−1 0 n,j n nσ2 n
j j
Also
(cid:114) (cid:18) (cid:19)
E (cid:0) δoutδin (cid:1) = n =1+ 1 +o 1 (57)
0 n,j n,j n−1 2n n
Whichmeansthat
E (R )= 3 + (cid:0) µ j −z j⋆(cid:1)2 +o(cid:18) 1(cid:19) =o(1) (58)
0 n,j 2n nσ2 n
j
Finally
E [Y ]=−
1
−
(z j⋆−µ j)2 +o(cid:18) 1(cid:19)
(59)
0 n,j 2n 2nσ2 n
j
Ontheotherhand,
V [Y ]=E [Y2 ]−(E [Y ])2 (60)
0 n,j 0 n,j 0 n,j
(cid:18) (cid:19)
1
=E [Y2 ]+o (61)
0 n,j n
= 1 E (cid:20)(cid:16)(cid:0) δout(cid:1)2 −(cid:0) δin (cid:1)2(cid:17)2(cid:21) + λ2 3 (cid:0) µ −z⋆(cid:1)2E [R2 ]+ λ 3 (cid:0) µ −z⋆(cid:1)E (cid:104) R (cid:16)(cid:0) δout(cid:1)2 −(cid:0) δin (cid:1)2(cid:17)(cid:105)
4 0 n,j n,j n2σ2 j j 0 n,j nσ j j 0 n,j n,j n,j
j j
(62)
22QuantifyingthePer-datumMembershipLeakage
Wecomputethefollowingexpectations:
E [(cid:0) δout(cid:1)3 ]= n3/2 E (cid:104) (µˆ −µ )3(cid:105)
0 n,j σ3 0 n,j j
j
1 µ
= √ 3,j
n σ3
j
E [(cid:0) δout(cid:1)4 ]= n2 E (cid:104) (µˆ −µ )4(cid:105)
0 n,j σ4 0 n,j j
j
(cid:32) (cid:33)
1 µ
=3+ 4,j −3
n σ4
j
E [(cid:0) δin (cid:1)4 ]=E
(cid:34)(cid:18)(cid:114)
n δout+ µ √j −z j⋆
(cid:19)4(cid:35)
0 n,j 0 n−1 n,j σ n−1
j
=3+ 1 (cid:32) µ 4,j −3(cid:33) + 6 + 4µ j −z j⋆ µ + 6(µ j −z j⋆)2 +o(cid:18) 1(cid:19)
n σ4 n n σ4 3,j n σ2 n
j j j
E [(cid:0) δout(cid:1)2(cid:0) δin (cid:1)2 ]=E (cid:34) (cid:0) δout(cid:1)2(cid:18)(cid:114) n δout+ µ √j −z j⋆ (cid:19)2(cid:35)
0 n,j n,j 0 n,j n−1 n,j σ n−1
j
=3+ 1 (cid:32) µ 4,j −3(cid:33) + 3 + 2µ j −z j⋆ µ + 1(µ j −z j⋆)2 +o(cid:18) 1(cid:19)
n σ4 n n σ4 3,j n σ2 n
j j j
Allinall,wehave
E
(cid:20)(cid:16)(cid:0)
δout(cid:1)2 −(cid:0) δin
(cid:1)2(cid:17)2(cid:21)
=E [(cid:0) δout(cid:1)4 ]+E [(cid:0) δin (cid:1)4 ]−2E [(cid:0) δout(cid:1)2(cid:0) δin (cid:1)2 ]
0 n,j n,j 0 n,j 0 n,j 0 n,j n,j
=
4(µ
j
−z j⋆)2 +o(cid:18) 1(cid:19)
n σ2 n
j
E [R2 ]=O(1)
0 n,j
E (cid:104) R (cid:16)(cid:0) δout(cid:1)2 −(cid:0) δin (cid:1)2(cid:17)(cid:105) =o(1)
0 n,j n,j n,j
Thus
V [Y ]=
1(µ
j
−z j⋆)2 +o(cid:18) 1(cid:19)
0 n,j n σ2 n
j
UnderH :
1
SinceE (µˆ )=µ + 1 (cid:0) z⋆−µ (cid:1) andV (µˆ )= n−1σ2,wegetthat
1 n,j j n j j 1 n,j n2 j
E (cid:0) δout(cid:1) = z j⋆− √µ j E (cid:16)(cid:0) δout(cid:1)2(cid:17) =1− 1 + (cid:0) µ j −z j⋆(cid:1)2 (63)
1 n,j σ n 1 n,j n nσ2
j j
E (cid:0) δin (cid:1) =0 E (cid:16)(cid:0) δin (cid:1)2(cid:17) =1 (64)
1 n,j 1 n,j
Also
(cid:114) (cid:18) (cid:19)
E (cid:0) δoutδin (cid:1) = n−1 =1− 1 +o 1 (65)
1 n,j n,j n 2n n
Whichmeansthat
E (R )=− 3 + (cid:0) µ j −z j⋆(cid:1)2 +o(cid:18) 1(cid:19) =o(1) (66)
1 n,j 2n nσ2 n
j
23QuantifyingthePer-datumMembershipLeakage
Finally
E [Y ]=−
1
+
(z j⋆−µ j)2 +o(cid:18) 1(cid:19)
(67)
1 n,j 2n 2nσ2 n
j
UnderH 1,onecanrewriteδ nin
,j
=Zˆ
n−1,j
andδ nou ,jt =(cid:113) n− n1δ nin
,j
+ z σj⋆ j− √µ nj.
ThususingthesamestepsasinH ,weget
0
E [(cid:0) δin (cid:1)3 ]= √ 1 µ 3,j
1 n,j n−1 σ3
j
(cid:32) (cid:33)
E [(cid:0) δin (cid:1)4 ]=3+ 1 µ 4,j −3
1 n,j n−1 σ4
j
E [(cid:0) δout(cid:1)4 ]=3+ 1 (cid:32) µ 4,j −3(cid:33) + 6 + 4z j⋆−µ j µ + 6(z j⋆−µ j)2 +o(cid:18) 1(cid:19)
1 n,j n σ4 n n σ4 3,j n σ2 n
j j j
E [(cid:0) δout(cid:1)2(cid:0) δin (cid:1)2 ]=3+ 1 (cid:32) µ 4,j −3(cid:33) + 3 + 2 z j⋆−µ j µ + 1(z j⋆−µ j)2 +o(cid:18) 1(cid:19)
1 n,j n,j n σ4 n n−1 σ4 3,j n σ2 n
j j j
Allinall,wehave
E
(cid:20)(cid:16)(cid:0)
δout(cid:1)2 −(cid:0) δin
(cid:1)2(cid:17)2(cid:21)
=
4(µ
j
−z j⋆)2 +o(cid:18) 1(cid:19)
1 n,j n,j n σ2 n
j
E [R2 ]=O(1)
1 n,j
E (cid:104) R (cid:16)(cid:0) δout(cid:1)2 −(cid:0) δin (cid:1)2(cid:17)(cid:105) =o(1)
1 n,j n,j n,j
Thus
V [Y ]=
1(µ
j
−z j⋆)2 +o(cid:18) 1(cid:19)
1 n,j n σ2 n
j
LemmaC.9. TheLindeberg-Fellercondition
Therandomvariables(Y )dn verifytheLindeberg-Fellercondition.
n,j j=1
Proof. Letϵ>0. Leth∈{0,1}.
Letδ >0. Wehavethat
(cid:34) (cid:35)
Y2+δ
E (cid:2) Y2 1{|Y |>ϵ}(cid:3) =E n,j 1{|Y |>ϵ}
h n,j n,j h Yδ n,j
n,j
≤ 1 E (cid:2) Y2+δ(cid:3)
ϵδ h n,j
Ontheotherhand,wehavethatY = 1(cid:16)(cid:0) δout(cid:1)2 −(cid:0) δin (cid:1)2(cid:17) + λ3(µj−z j⋆) R ,where
n,j 2 n,j n,j nσj n,j
(cid:16)(cid:0) δout(cid:1)2 −(cid:0) δin (cid:1)2(cid:17) =O (cid:18) √1 (cid:19) andR =O (1)
n,j n,j p n n,j p
ThusY
n,j
=O p(cid:16) √1 n(cid:17) ,andE h(cid:2) Y n2 ,+ jδ(cid:3) =o(cid:0) n1(cid:1) .
WhichmeansthatE (cid:2) Y2 1{|Y |>ϵ}(cid:3) =o(cid:0)1(cid:1) and
h n,j n,j n
24QuantifyingthePer-datumMembershipLeakage
(cid:88)dn
E (cid:2) Y2 1{|Y |>ϵ}(cid:3)
=o(cid:18)
d
n(cid:19)
=o(1)→0
h n,j n,j n
j=1
C.4.ProofofCorollary3.2
Corollary 3.2 (Per-datum membership leakage of the em-pirical mean). The asymptotic leakage of a datum z⋆ in the
empiricalmeanis
√ √
(cid:18) m⋆(cid:19) (cid:18) m⋆(cid:19)
limξ (z⋆,Memp,D)=Φ −Φ − (68)
n,d n n 2 2
Theoptimalpowerachievableundersignificanceαis
(cid:16) √ (cid:17)
limPow (ℓ ,α,z⋆)=Φ Φ−1(α)+ m⋆ (69)
n n
n,d
√
underthethresholdτ = m⋆ + m⋆Φ−1(1−α).
α 2
Proof. Fromtheasymptoticdistributionofthelikelihood,wegetdirectlythat
(cid:18) (cid:18) m⋆ (cid:19) (cid:19) (cid:18) (cid:18) m⋆ (cid:19) (cid:19)
limξ (z⋆,Memp,D)=Pr N − ,m⋆ <0 −Pr N ,m⋆ <0
n,d n n 2 2
(cid:18) m⋆/2(cid:19) (cid:18) m⋆/2(cid:19)
=Φ √ −Φ −√
m⋆ m⋆
√ √
(cid:18) m⋆(cid:19) (cid:18) m⋆(cid:19)
=Φ −Φ − (70)
2 2
Thethresholdτ forwhichtheasymptoticlikelihoodtestachievessignificaneαverifies:
α
(cid:18) (cid:18) m⋆ (cid:19) (cid:19)
Pr N − ,m⋆ ≥τ ) =α
2 α
√
Thusτ =−m⋆ + m⋆Φ−1(1−α).
α 2
Finally,wefindthepowerofthetestby
(cid:18) (cid:18) m⋆ (cid:19) (cid:19)
limPow (ℓ ,α,z⋆)=Pr N ,m⋆ ≥τ
n,d n n 2 α
(cid:18) m⋆ √ m⋆ √ (cid:19)
=Pr + m⋆N (0,1)≥− + m⋆Φ−1(1−α)
2 2
(cid:16)√ √ (cid:17)
=Pr m⋆N (0,1)≥−m⋆− m⋆Φ−1(α)
(cid:16) √ (cid:17)
=Pr N (0,1)≤ m⋆+Φ−1(α)
(cid:16) √ (cid:17)
=Φ Φ−1(α)+ m⋆
C.5.Effectsofsub-sampling,ProofofTheorem4.3
Theorem4.3(Per-datummembershipleakagefortheempiricalmeanwithsub-sampling). First,weshowthatasd,n→∞
whiled/n=τ:
(cid:16) (cid:17)
-UnderH ,ℓsub,ρ(µˆsub;z⋆,µ,C )⇝N −ρm⋆,ρm⋆ .
0 n n σ 2
25QuantifyingthePer-datumMembershipLeakage
(cid:16) (cid:17)
-UnderH ,ℓsub,ρ(µˆsub;z⋆,µ,C )⇝N ρm⋆,ρm⋆ .
1 n n σ 2
Forthesub-samplingempiricalmeanmechanism,theasymptoticleakageofarecordz⋆is
√ √
(cid:18) ρm⋆(cid:19) (cid:18) ρm⋆(cid:19)
limξ (z⋆,Msub,ρ,D)=Φ −Φ −
n,d n n 2 2
Theoptimalpowerachievablegivensignificancelevelαis
√
limPow
(ℓsub,ρ,α,z⋆)=Φ(cid:0)
z +
ρm⋆(cid:1)
(71)
n n α
n,d
√
underthethresholdτ =−ρm⋆ + ρm⋆Φ−1(1−α).
α 2
Proof. We have that µˆsub = 1 (cid:80)n Z 1{ς(i)≤k }, where k ≜ ρn, Z are i.i.d and ς ∼unif S is a permutation
n kn i=1 i n n i n
sampleduniformlyfromthesetofpermutationsof{1...,n}i.e. S andindependentlyfrom(Z ).
n i
Wedenoteµˆsub =(µˆsub)dn .
n n,j j=1
Step1: Rewritingthelikelihoodratiotest
Letj ∈[1,d ].
n
UnderH ,wecanre-write
0
σ
µˆsub =µ + √j Zˆ ,
n,j j k kn,j
n
where
(cid:32) (cid:33)
Zˆ ≜(cid:112) k
µˆs nu ,jb−µ
j
dn,j n σ
=
√1 (cid:88)kn Z
ς−1(i),j
−µ
j
.
k σ
n i=1 j
Since(Z )n arei.i.dfromD ,andς ∼unif S andind. from(Z ),then(Z )kn .
i,j i=1 j n i ς−1(i),j i=1
UsingtheCLT,Zˆ ⇝ N(0,1).
dn,j n→∞
Letd bethedensityfunctionofZˆ .
n,j n,j
Thedensitypout,subofµˆsubunderH canbewrittenas
n,j n,j 0
√ √
(cid:20) (cid:21)
k k
pout,sub(x;z⋆,µ ,σ )= nd n(x−µ )
n,j j j j σ kn,j σ j
j j
UnderH ,wecanre-write
1
n−1
1 1 (cid:88)
µˆsub = z⋆1{ς(n)≤k }+ Z 1{ς(i)≤k }
n,j k j n k i n
n n
i=1
LetA={1{ς(n)≤k }}theeventthatz⋆wassub-sampled. WehavethatPr(A)=ρ.
n
Thedensitypin,subofµˆsubunderH andgivenAis
n,j n,j 1
(cid:20) (cid:18) (cid:19)(cid:21)
√k n d √k n x−µ − 1 (cid:0) z⋆−µ (cid:1)
σ k −1 kn−1,j σ k −1 j k j j
j n j n n
26QuantifyingthePer-datumMembershipLeakage
Thedensitypin,subofµˆsubunderH andgivenAcis
n,j n,j 1
√ √
(cid:20) (cid:21)
k k
nd n(x−µ )
σ kn,j σ j
j j
Thus,thedensitypin,subofµˆsubunderH canbewrittenas
n,j n,j 1
√ √
(cid:20) (cid:21) (cid:20) (cid:18) (cid:19)(cid:21)
pin,sub(x;z⋆,µ ,σ )=(1−ρ) k nd k n(x−µ ) +ρ √k n d √k n x−µ − 1 (cid:0) z⋆−µ (cid:1)
n,j j j j σ kn,j σ j σ k −1 kn−1,j σ k −1 j k j j
j j j n j n n
Thelikelihoodratiostatisticis
ℓsub,ρ(µˆsub;z⋆,µ,C
)=(cid:88)dn log(cid:32) pi nn ,, jsub(µˆs nu ,jb;z j⋆,µ j,σ j) (cid:33)
n n σ pout,sub(µˆsub;z⋆,µ ,σ )
j=1 n,j n,j j j j
 √ (cid:16) (cid:17) (cid:16) (cid:17)
=(cid:88)dn log(1−ρ) σk jnd kn,j δ √ko nut ,j,sub + (cid:16)ρ σj√k kn
n
(cid:17)−1d kn−1,j δ kin n, ,s jub
 (72)
knd δout,sub
j=1 σj kn,j kn,j
 (cid:16) (cid:17)
=(cid:88)dn log(1−ρ)+ρ(cid:114)
k
n
d
kn−1, (cid:16)j
δ kin n, ,s jub
(cid:17)  (73)
k n−1 d δout,sub
j=1 kn,j kn,j
where
√
δout,sub ≜ k n (cid:0) µˆsub−µ (cid:1) (74)
kn,j σ
j
n,j j
(cid:18) (cid:19)
δin,sub ≜ √ k n µˆsub−µ + 1 (cid:0) µ −z⋆(cid:1) (75)
kn,j k n−1σ
j
n,j j k
n
j j
Step2: Asymptoticexpansionofthelikelihoodratiotest
UsingLemmaC.10,wehave
 (cid:16) (cid:17)
(cid:114) d δin,sub (cid:18) (cid:19)
log(1−ρ)+ρ
k
nk −n
1
dkn−1, (cid:16)j δouk tn ,s, uj
b(cid:17)
=W
n,j
+o
p
n1
kn,j kn,j
where
W ≜ ρ (δout,sub)2− ρ (δin,sub)2+ρλ
3(cid:0)
µ j −z
j⋆(cid:1)
R + ρ + ρ(1−ρ)(cid:16) (δout,sub)2−(δin,sub)2(cid:17)2 (76)
n,j 2 kn,j 2 kn,j k nσ
j
kn,j 2k
n
8 kn,j kn,j
TheextrahardnessofthisproofcomesfromthefactthatthedensityunderH isnowamixtureoftwoGaussians,rather
1
thanjustoneGaussianinthecaseoftheexactempiricalmean.
Thus
(cid:88)dn
ℓsub,ρ(µˆsub;z⋆,µ,C )=o (1)+ W (77)
n n σ p n,j
j=1
because dn =τ +o(1).
n
27QuantifyingthePer-datumMembershipLeakage
Step3: ConcludingusingtheLindeberg-FellerCLT
UnderH :
0
UsingLemmaC.11,E [W ,j]=−ρ(µj−z j⋆)2 +o(cid:0)1(cid:1) andV [W ]=ρ(µj−z j⋆)2 +o(cid:0)1(cid:1) .
0 n 2 nσ2 n 0 n,j nσ2 n
j j
Since(cid:80)dn (z j⋆−µj)2
=
∥z⋆−µ∥2 Cσ−1
,weget:
j=1 nσ2 n
j
• (cid:80)dn E [W ,j]→−ρm⋆
j=1 0 n 2
• (cid:80)dn V [W ,j]→ρm⋆
j=1 0 n
SimilarlytoLemmaC.9,wecanshowthatW verifytheLindeberg-Fellercondition,i.e.
n,j
(cid:88)dn
E (cid:2) W2 1{|W |>ϵ}(cid:3) →0
0 n,j n,j
j=1
foreveryϵ>0.
WeconcludeusingtheLindeberg-FellerCLTthat
(cid:18) m⋆ (cid:19)
ℓsub,ρ(µˆsub;z⋆,µ,C )⇝N −ρ ,ρm⋆ (78)
n n σ 2
Similarly,UnderH :
1
UsingLemmaC.11,E [W ,j]= ρ(µj−z j⋆)2 +o(cid:0)1(cid:1) andV [W ]=ρ(z j⋆−µj)2 +o(cid:0)1(cid:1) .
1 n 2 nσ2 n 1 n,j nσ2 n
j j
Weget:
• (cid:80)dn E [W ,j]→ ρm⋆
j=1 1 n 2
• (cid:80)dn V [W ,j]→ρm⋆
j=1 1 n
SimilarlytoLemmaC.9,wecanshowthatW verifytheLindeberg-Fellercondition,i.e.
n,j
(cid:88)dn
E (cid:2) W2 1{|W |>ϵ}(cid:3) →0
1 n,j n,j
j=1
foreveryϵ>0.
WeconcludeusingtheLindeberg-FellerCLTthat
(cid:18) m⋆ (cid:19)
ℓsub,ρ(µˆsub;z⋆,µ,C )⇝N ρ ,ρm⋆ (79)
n n σ 2
Step4: Characterisingtheadvantageandthepowerfunction
UsingthesamestepasintheproofofCorollary3.2,weconclude.
Nowwepresenttheproofofthehelpfultechnicallemmas.
28QuantifyingthePer-datumMembershipLeakage
LemmaC.10(Asymptoticexpansionofthelikelihoodratiotestforsub-sampling). Weshowthat
 (cid:16) (cid:17)
(cid:114) d δin,sub (cid:18) (cid:19)
log(1−ρ)+ρ
k
nk −n
1
dkn−1, (cid:16)j δouk tn ,s, uj
b(cid:17)
=W
n,j
+o
p
n1
kn,j kn,j
where
W ≜ ρ (δout,sub)2− ρ (δin,sub)2+ρλ
3(cid:0)
µ j −z
j⋆(cid:1)
R + ρ + ρ(1−ρ)(cid:16) (δout,sub)2−(δin,sub)2(cid:17)2
n,j 2 kn,j 2 kn,j k nσ
j
kn,j 2k
n
8 kn,j kn,j
Proof. First,werecallthat
d
kn,j(cid:16)
δ ko nut
,j,sub(cid:17)
=
√1 2πe−(δkou nt ,, 2jsub)2 (cid:32)
1+
h 1(δ √ko nu kt
,
nj,sub)
+
h 2(δ ko knu nt ,j,sub)
+o
p(cid:18) n1(cid:19)(cid:33)
(80)
Takingtheinverse,anddeveloppingitweget
(cid:16)
d
kn,j(cid:16)
δ ko nut
,j,sub(cid:17)(cid:17)−1 =√ 2πe(δkou nt ,, 2jsub)2 (cid:32)
1+
h 1(δ √ko nu kt
,
nj,sub)
+
h 2(δ ko knu nt ,j,sub)
+o
p(cid:18) n1(cid:19)(cid:33)−1
 (cid:16) (cid:17)2 
=√ 2πe(δkou nt ,, 2jsub)2
 1−
h 1(δ √ko nu kt ,j,sub)
−
h 2(δ ko knut ,j,sub)
+
1
2
h 1(δ ko knut ,j,sub)
+o
p(cid:18) n1(cid:19)


n n n
Combiningwiththeotherresult
d
kn−1,j(cid:16)
δ kin n, ,s
jub(cid:17)
=
√1 2πe−(δkin n, 2s ,u jb)2 (cid:32)
1+
h 1( √δ ki kn n, n,s jub)
+
h 2(δ kkin nn, ,s jub)
+o
p(cid:18) n1(cid:19)(cid:33)
(81)
Puttingthemtogethergives
(cid:16) (cid:17)  (cid:16) (cid:17)2 
d dk kn n− ,j1, (cid:16)j
δ
koδ nuki
t
,n jn ,s, ,s uju bb
(cid:17)
=e(δkou nt ,, jsub)2 2−(δkin n,s ,u jb)2  1− h 1(δ √ko nu kt , nj,sub) − h 2(δ ko knu nt ,j,sub) + 21 h 1(δ ko knu nt ,j,sub) +o p(cid:18) n1(cid:19) 

(cid:32)
1+
h 1( √δ kin n, ,s jub)
+
h 2(δ kin n, ,s jub)
+o
(cid:18) 1(cid:19)(cid:33)
k k p n
n n
=e(δkou nt ,, jsub)2 2−(δkin n,s ,u jb)2 (cid:32)
1+
h 1(δ kin n, ,s jub) √− kh n1(δ ko nut ,j,sub)
+
k1
n
(cid:18) 1 2(cid:16)
h 1(δ ko nut
,j,sub)(cid:17)2
−h 1(δ kin n, ,s jub)h 1(δ ko nut
,j,sub)(cid:19)
+o
p(cid:18) n1(cid:19)(cid:33)
Now,weproceedtodoTaylorexpansionoftheexponentialfunction,toget
e(δkou nt ,, jsub)2 2−(δkin n,s ,u jb)2
=1+
1
2(δ ko nut ,j,sub)2−
21
(δ kin n, ,s jub)2+
81(cid:16)
(δ ko nut ,j,sub)2−(δ kin n, ,s
jub)2(cid:17)2
+o
p(cid:18) n1(cid:19)
Puttingeverythingtogether,weget
29QuantifyingthePer-datumMembershipLeakage
(cid:16) (cid:17)
(cid:114) d δin,sub
(1−ρ)+ρ k n kn−1,j kn,j =1+ ρ + ρ (δout,sub)2− ρ (δin,sub)2+ ρ(cid:16) (δout,sub)2−(δin,sub)2(cid:17)2
k n−1
d
(cid:16) δout,sub(cid:17) 2k
n
2 kn,j 2 kn,j 8 kn,j kn,j
kn,j kn,j
+ρh 1(δ kin n, ,s jub) √−h 1(δ ko nut ,j,sub)
+
ρ (cid:18) 1(cid:16)
h
(δout,sub)(cid:17)2
−h (δin,sub)h
(δout,sub)(cid:19)
+o
(cid:18) 1(cid:19)
k
n
k
n
2 1 kn,j 1 kn,j 1 kn,j p n
Finally,anotherTaylorexpansionofthelogarithmgives
 (cid:16) (cid:17)
(cid:114) d δin,sub
log(1−ρ)+ρ
k
nk −n
1
dkn−1, (cid:16)j δouk tn ,s, uj
b(cid:17)
=1+ 2kρ
n
+ ρ 2(δ ko nut ,j,sub)2− ρ 2(δ kin n, ,s jub)2+ ρ 8(cid:16) (δ ko nut ,j,sub)2−(δ kin n, ,s jub)2(cid:17)2
kn,j kn,j
+ρh 1(δ kin n, ,s jub) √−h 1(δ ko nut ,j,sub)
+
ρ (cid:18) 1(cid:16)
h
(δout,sub)(cid:17)2
−h (δin,sub)h
(δout,sub)(cid:19)
+o
(cid:18) 1(cid:19)
k
n
k
n
2 1 kn,j 1 kn,j 1 kn,j p n
1ρ2 (cid:16) (cid:17)2 ρ2 (cid:16) (cid:17)2
− (δout,sub)2−(δin,sub)2 − h (δin,sub)−h (δout,sub)
2 4 kn,j kn,j 2k
n
1 kn,j 1 kn,j
whichaftersimplifications
 (cid:16) (cid:17)
log(1−ρ)+ρ(cid:114)
k
nk −n 1d dk kn n− ,j1, (cid:16)j
δ
koδ nuki
t
,n jn ,s, ,s uju bb
(cid:17)
= ρ 2(δ ko nut ,j,sub)2− ρ 2(δ kin n, ,s jub)2+ρh 1(δ kin n, ,s jub) √− kh n1(δ ko nut ,j,sub)
ρ ρ(1−ρ)(cid:16) (cid:17)2 (cid:18) 1(cid:19)
+ + (δout,sub)2−(δin,sub)2 +o
2k
n
8 kn,j kn,j p n
concludestheproof.
LemmaC.11. Expectationandvariancecomputationsforsub-sampling
E [W
]=−ρ(cid:0) µ
j
−z j⋆(cid:1)2 +o(cid:18) 1(cid:19)
V [W
]=ρ(µ
j
−z j⋆)2 +o(cid:18) 1(cid:19)
0 n,j 2 nσ2 n 0 n,j nσ2 n
j j
E [W ]=
ρ(cid:0) µ
j
−z j⋆(cid:1)2 +o(cid:18) 1(cid:19)
V [W
]=ρ(z j⋆−µ j)2 +o(cid:18) 1(cid:19)
1 n,j 2 nσ2 n 1 n,j nσ2 n
j j
Proof. Letusrecallthat
W ≜ ρ (δout,sub)2− ρ (δin,sub)2+ρλ
3(cid:0)
µ j −z
j⋆(cid:1)
R + ρ + ρ(1−ρ)(cid:16) (δout,sub)2−(δin,sub)2(cid:17)2 (82)
n,j 2 kn,j 2 kn,j k nσ
j
kn,j 2k
n
8 kn,j kn,j
(cid:16) (cid:17)2 (cid:16) (cid:17)2
whereR ≜ δout,sub +δout,subδin,sub+ δin,sub −3
kn,j kn,j kn,j kn,j kn,j
UnderH :
0
SinceE (µˆsub)=µ andV (µˆsub)= 1 σ2,wegetthat
0 n,j j 0 n,j kn j
(cid:16) (cid:17) (cid:18)(cid:16) (cid:17)2(cid:19)
E δout,sub =0 E δout,sub =1 (83)
0 kn,j 0 kn,j
E (cid:16) δin,sub(cid:17) = µ √j −z j⋆ E (cid:18)(cid:16) δin,sub(cid:17)2(cid:19) =1+ 1 + (cid:0) µ j −z j⋆(cid:1)2 +o(cid:18) 1(cid:19) (84)
0 kn,j σ
j
k n−1 0 kn,j k
n
k nσ j2 n
30QuantifyingthePer-datumMembershipLeakage
Also
(cid:16) (cid:17) (cid:114) k 1 (cid:18) 1(cid:19)
E δout,subδin,sub = n =1+ +o (85)
0 kn,j kn,j k n−1 2k
n
n
Whichmeansthat
E (R )= 3 + (cid:0) µ j −z j⋆(cid:1)2 +o(cid:18) 1(cid:19) =o(1) (86)
0 kn,j 2k k σ2 n
n n j
Wecomputethefollowingexpectations:
(cid:16) (cid:17)3 1 µ
E [ δout,sub ]= √ 3,j
0 kn,j k σ3
n j
(cid:32) (cid:33)
(cid:16) (cid:17)4 1 µ
E [ δout,sub ]=3+ 4,j −3
0 kn,j k
n
σ j4
E [(cid:16) δin,sub(cid:17)4 ]=3+ 1 (cid:32) µ 4,j −3(cid:33) + 6 + 4 µ j −z j⋆ µ + 6 (µ j −z j⋆)2 +o(cid:18) 1(cid:19)
0 kn,j k
n
σ j4 k
n
k
n
σ j4 3,j k
n
σ j2 n
E [(cid:16) δout,sub(cid:17)2(cid:16) δin,sub(cid:17)2 ]=3+ 1 (cid:32) µ 4,j −3(cid:33) + 3 + 2 µ j −z j⋆ µ + 1 (µ j −z j⋆)2 +o(cid:18) 1(cid:19)
0 kn,j kn,j k
n
σ j4 k
n
k
n
σ j4 3,j k
n
σ j2 n
Allinall,wehave
E (cid:34)(cid:18)(cid:16) δout,sub(cid:17)2 −(cid:16) δin,sub(cid:17)2(cid:19)2(cid:35) = 4 (µ j −z j⋆)2 +o(cid:18) 1(cid:19)
0 kn,j kn,j k
n
σ j2 n
Finally
E [W
]=−ρ(cid:0) µ
j
−z j⋆(cid:1)2
+
ρ(1−ρ)(cid:0) µ
j
−z j⋆(cid:1)2 +o(cid:18) 1(cid:19)
(87)
0 n,j 2k σ2 2 k σ2 n
n j n j
=−ρ(cid:0) µ
j
−z j⋆(cid:1)2 +o(cid:18) 1(cid:19)
(88)
2 nσ2 n
j
Ontheotherhand,
V [W ]=E [W2 ]−(E [W ])2
0 n,j 0 n,j 0 n,j
(cid:18) (cid:19)
1
=E [W2 ]+o
0 n,j n
ρ2 (cid:34)(cid:18)(cid:16) (cid:17)2 (cid:16) (cid:17)2(cid:19)2(cid:35) (cid:18) 1(cid:19)
= E δout,sub − δin,sub +o
4 0 kn,j kn,j n
=
ρ2 (µ
j
−z j⋆)2 +o(cid:18) 1(cid:19) +o(cid:18) 1(cid:19)
k σ2 n n
n j
=
ρ(µ
j
−z j⋆)2 +o(cid:18) 1(cid:19)
(89)
n σ2 n
j
UnderH :
1
LetA={1{ς(n)≤k }}theeventthatz⋆wassub-sampled. WehavethatPr(A)=ρ.
n
31QuantifyingthePer-datumMembershipLeakage
Wehavethefollowing
E (µˆsub)=ρE (µˆsub |A)+(1−ρ)E (µˆsub |Ac)
1 n,j 1 n,j 1 n,j
1
=ρ(µ + (z⋆−µ ))+(1−ρ)µ
j k j j j
n
=µ + 1 (cid:0) z⋆−µ (cid:1)
j n j j
V (cid:0) µˆsub(cid:1) =E
(cid:34)(cid:18)
µˆsub−µ − 1 (cid:0) z⋆−µ
(cid:1)(cid:19)2(cid:35)
1 n,j 1 n,j j n j j
=ρE
(cid:34)(cid:18)
µˆsub−µ − 1 (cid:0) z⋆−µ
(cid:1)(cid:19)2 |A(cid:35)
+(1−ρ)E
(cid:34)(cid:18)
µˆsub−µ + 1 (cid:0) z⋆−µ
(cid:1)(cid:19)2 |Ac(cid:35)
1 n,j j n j j 1 n,j j n j j
=ρ(cid:32) k n−1 σ2+(cid:18) 1−ρ (z⋆−µ )(cid:19)2(cid:33) +(1−ρ)(cid:18) 1 σ2+ ρ2 (cid:0) z⋆−µ (cid:1)2(cid:19)
k2 j k j j k j k2 j j
n n n n
= σ j2 (cid:18) 1− ρ (cid:19) + ρ(1−ρ)(cid:0) z⋆−µ (cid:1)2
k k k2 j j
n n n
Again,wecomputethefollowingexpectations:
E (cid:18)(cid:16) δout,sub(cid:17)2(cid:19) = k n (cid:32) V (cid:0) µˆsub(cid:1) + (cid:0) µ j −z j⋆(cid:1)2(cid:33)
1 kn,j σ2 1 n,j n2
j
= k n (cid:32) σ j2 (cid:18) 1− ρ (cid:19) + ρ(1−ρ)(cid:0) z⋆−µ (cid:1)2 +ρ2(cid:0) µ j −z j⋆(cid:1)2(cid:33)
σ2 k k k2 j j k2
j n n n n
=1−
ρ
+ρ(cid:0)
µ j −z
j⋆(cid:1)2
k k σ2
n n j
and
E (cid:18)(cid:16) δin,sub(cid:17)2(cid:19) = k n2 (cid:32) V (cid:0) µˆsub(cid:1) +(cid:18) 1−ρ (z⋆−µ )(cid:19)2(cid:33)
1 kn,j (k n−1)σ j2 1 n,j k
n
j j
= k n2 (cid:32) σ j2 (cid:18) 1− ρ (cid:19) + ρ(1−ρ)(cid:0) z⋆−µ (cid:1)2 +(cid:18) 1−ρ (z⋆−µ )(cid:19)2(cid:33)
(k −1)σ2 k k k2 j j k j j
n j n n n n
=1+
1−ρ +(1−ρ)(cid:0) µ j −z j⋆(cid:1)2 +o(cid:18) 1(cid:19)
k k σ2 n
n n j
Thusagain,weget
E (cid:16) δout,sub(cid:17) =√ ρz j⋆− √µ j E (cid:18)(cid:16) δout,sub(cid:17)2(cid:19) =1− 1 + (cid:0) µ j −z j⋆(cid:1)2 (90)
1 kn,j σ
j
n 1 kn,j n nσ j2
E (cid:16) δin,sub(cid:17) =(1−ρ) µ √j −z j⋆ E (cid:18)(cid:16) δin,sub(cid:17)2(cid:19) =1+ 1−ρ +(1−ρ)(cid:0) µ j −z j⋆(cid:1)2 +o(cid:18) 1(cid:19) (91)
1 kn,j σ
j
k n−1 1 kn,j k
n
k nσ j2 n
Now,wefindthat
E (cid:18)(cid:16) δout,sub(cid:17)2(cid:19) −E (cid:18)(cid:16) δin,sub(cid:17)2(cid:19) =− 1 +(2ρ−1)(cid:0) µ j −z j⋆(cid:1)2 +o(cid:18) 1(cid:19) (92)
1 kn,j 1 kn,j k
n
k nσ j2 n
32QuantifyingthePer-datumMembershipLeakage
Also,
E (cid:16) δout,subδin,sub(cid:17) =E
(cid:32)(cid:114)
k n (cid:16) δout,sub(cid:17)2 + µ √j −z j⋆
δout,sub(cid:33)
1 kn,j kn,j 1 k n−1 kn,j σ
j
k n−1 kn,j
=(cid:114) k n (cid:32) 1− 1 + (cid:0) µ j −z j⋆(cid:1)2(cid:33) + µ √j −z j⋆ (cid:18) √ ρz j⋆− √µ j(cid:19)
k −1 n nσ2 σ k −1 σ n
n j j n j
=1+o(1)
Whichmeansthat
E (R )=o(1) (93)
1 kn,j
Again,followingthesamestepsasinH ,wearriveat
0
E (cid:34)(cid:18)(cid:16) δout,sub(cid:17)2 −(cid:16) δin,sub(cid:17)2(cid:19)2(cid:35) = 4 (µ j −z j⋆)2 +o(cid:18) 1(cid:19)
1 kn,j kn,j k
n
σ j2 n
Finally
E [W
]=ρ(2ρ−1)(cid:0) µ
j
−z j⋆(cid:1)2
+
ρ(1−ρ)(cid:0) µ
j
−z j⋆(cid:1)2 +o(cid:18) 1(cid:19)
1 n,j 2k σ2 2 k σ2 n
n j n j
=ρ(cid:0) µ
j
−z j⋆(cid:1)2 +o(cid:18) 1(cid:19)
(94)
2nσ2 n
j
Again,
ρ2 (cid:34)(cid:18)(cid:16) (cid:17)2 (cid:16) (cid:17)2(cid:19)2(cid:35) (cid:18) 1(cid:19)
V [W ]= E δout,sub − δin,sub +o
1 n,j 4 1 kn,j kn,j n
=
ρ2 (µ
j
−z j⋆)2 +o(cid:18) 1(cid:19) +o(cid:18) 1(cid:19)
k σ2 n n
n j
=
ρ(µ
j
−z j⋆)2 +o(cid:18) 1(cid:19)
(95)
n σ2 n
j
C.6.Effectofmisspecifiaction,proofofTheorem4.5
Theorem4.5(Leakageofamisspecifiedadversary). Weshowthatasd,n←∞whiled/n=τ,
(cid:16) (cid:17)
-UnderH ,ℓ (µˆ ;ztarg,µ,C )⇝N −mtarg,m⋆ .
0 n n σ 2
(cid:16) (cid:17)
-UnderH ,ℓ (µˆ ;ztarg,µ,C )⇝N m⋆−mdiff,m⋆
1 n n σ 2
LettheadversaryA useℓ (µˆ ;ztarg,µ,C )astheLRtestfunction. Then,
miss n n σ
(cid:16) (cid:17) (cid:16) (cid:17)
lim n,dAdv n(A miss)=Φ | 2m √s mca ⋆l| −Φ −| 2m √s mca ⋆l| .
Proof. Step1: Asymptoticexpansionofthelikelihoodratiotest
DirectlyusingEq.32fromtheproofinSectionC.2,byonlyreplacingz⋆byztarg,weget
33QuantifyingthePer-datumMembershipLeakage
τ
(cid:88)dn
ℓ (µˆ ;z⋆,µ,C )= +o (1)+ Ytarg (96)
n n σ 2 p n,j
j=1
where
Ytarg ≜ 1(cid:18) (cid:0) δout,targ(cid:1)2 −(cid:16) δin,targ(cid:17)2(cid:19) + λ 3(cid:0) µ j −z jtarg(cid:1) Rtarg,
n,j 2 n,j n,j nσ n,j
j
and
√
n
δout,targ ≜ (µˆ −µ ) (97)
n,j σ n,j j
j
(cid:18) (cid:19)
δin,targ ≜ √ n µˆ −µ + 1 (cid:0) µ −ztarg(cid:1) (98)
n,j n−1σ n,j j n j j
j
Rtarg ≜(cid:0) δout,targ(cid:1)2 +δout,targδin,targ+(cid:16) δin,targ(cid:17)2 −3 (99)
n,j n,j n,j n,j n,j
Step2: Computingexpectationsandvariances
Thisisthestepwheretheeffectofmisspecificationappear.
UnderH :
0
SinceE (µˆ )=µ andV (µˆ )= 1σ2,wegetthat
0 n,j j 0 n,j n j
E (cid:0) δout,targ(cid:1) =0 E (cid:16)(cid:0) δout,targ(cid:1)2(cid:17) =1 (100)
0 n,j 0 n,j
E (cid:16) δin,targ(cid:17) = µ j √−z jtarg E (cid:18)(cid:16) δin,targ(cid:17)2(cid:19) =1+ 1 + (cid:0) µ j −z jtarg(cid:1)2 +o(cid:18) 1(cid:19) (101)
0 n,j σ n−1 0 n,j n nσ2 n
j j
UsingsimilarstepsasinLemmaC.8,weget
E [Ytarg]=−
1
−
(z jtarg−µ j)2 +o(cid:18) 1(cid:19)
(102)
0 n,j 2n 2nσ2 n
j
And
V [Ytarg]=
1(µ
j
−z jtarg)2 +o(cid:18) 1(cid:19)
0 n,j n σ2 n
j
UnderH :
1
SinceE (µˆ )=µ + 1 (cid:0) z⋆−µ (cid:1) andV (µˆ )= n−1σ2,let
1 n,j j n j j 1 n,j n2 j
(cid:18) (cid:19)
δin,true ≜ √ n µˆ −µ + 1 (cid:0) µ −z⋆(cid:1) ,
n,j n−1σ n,j j n j j
j
andthus
(cid:16) (cid:17) (cid:18)(cid:16) (cid:17)2(cid:19)
E δin,true =0, E δin,true =1
1 n,j 1 n,j
34QuantifyingthePer-datumMembershipLeakage
Ontheotherhand,wecanrewrite
δout,targ =(cid:114) n−1 δin,true+ z j⋆− √µ j
n,j n n,j σ n
j
z⋆−ztarg
δin,targ =δin,true+ j√ j
n,j n,j σ n−1
j
Thus,wegetthat
E (cid:0) δout,targ(cid:1) = z j⋆− √µ j E (cid:16)(cid:0) δout,targ(cid:1)2(cid:17) =1− 1 + (cid:0) µ j −z j⋆(cid:1)2 (103)
1 n,j σ n 1 n,j n nσ2
j j
E (cid:16) δin,targ(cid:17) = z j⋆ √−z jtarg E (cid:18)(cid:16) δin,targ(cid:17)2(cid:19) =1+ 1 (cid:0) z⋆−ztarg(cid:1)2 (104)
1 n,j σ n−1 1 n,j (n−1)σ2 j j
j j
Also
E
(cid:16) δout,targδin,targ(cid:17) =(cid:114) n−1
+
(cid:0) z j⋆−µ √j(cid:1)(cid:0) √z j⋆−ztarg(cid:1)
1 n,j n,j n σ2 n n−1
j
=1−
1
+
(cid:0) z j⋆−µ j(cid:1)(cid:0) z j⋆−ztarg(cid:1) +o(cid:18) 1(cid:19)
2n nσ2 n
j
Whichmeansthat
E (cid:0) Rtarg(cid:1) =o(1) (105)
1 n,j
Finally
E [Ytarg]=−
1
+
(z j⋆−µ j)2−(cid:0) z j⋆−z jtarg(cid:1)2 +o(cid:18) 1(cid:19)
(106)
1 n,j 2n 2nσ2 n
j
V [Ytarg]=
1(µ
j
−z jtarg)2 +o(cid:18) 1(cid:19)
1 n,j n σ2 n
j
Allinall,weprovedthat
E [Ytarg]=− 1 − (z jtarg−µ j)2 +o(cid:18) 1(cid:19) V [Ytarg]= 1(µ j −z jtarg)2 +o(cid:18) 1(cid:19)
0 n,j 2n 2nσ2 n 0 n,j n σ2 n
j j
E [Ytarg]=− 1 + (z j⋆−µ j)2−(cid:0) z j⋆−z jtarg(cid:1)2 +o(cid:18) 1(cid:19) V [Ytarg]= 1(µ j −z jtarg)2 +o(cid:18) 1(cid:19)
1 n,j 2n 2nσ2 n 1 n,j n σ2 n
j j
Step3: ConcludingusingtheLindeberg-FellerCLT
UnderH :
0
UsingtheresultsofStep2,wehave
• (cid:80)dn E [Ytarg,j]→−τ − mtarg
j=1 0 n 2 2
• (cid:80)dn V [Y ,j]→mtarg
j=1 0 n
35QuantifyingthePer-datumMembershipLeakage
SimilarlytoLemmaC.9,wecanshowthatYtarg verifytheLindeberg-Fellercondition,i.e.
n,j
(cid:88)dn
E (cid:2) (Ytarg)21(cid:8) |Ytarg|>ϵ(cid:9)(cid:3) →0
0 n,j n,j
j=1
foreveryϵ>0.
(cid:16) (cid:17)
WeconcludeusingtheLindeberg-FellerCLTthat(cid:80)dn Ytarg ⇝N −τ − mtarg,mtarg ,andthus
j=1 n,j 2 2
(cid:18) mtarg (cid:19)
ℓ (µˆ ;ztarg,µ,C )⇝N − ,mtarg (107)
n n σ 2
Similarly,UnderH :
1
WegetusingtheresultsofStep3that
• (cid:80)dn E [Ytarg]→−τ + m⋆−mdiff
j=1 1 n,j 2 2
• (cid:80)dn V [Ytarg]→mtarg
j=1 1 n,j
SimilarlytoLemmaC.9,wecanshowthatYtarg verifytheLindeberg-Fellercondition,i.e.
n,j
(cid:88)dn
E (cid:2) (Ytarg)21(cid:8) |Ytarg|>ϵ(cid:9)(cid:3) →0
1 n,j n,j
j=1
foreveryϵ>0.
(cid:16) (cid:17)
WeconcludeusingtheLindeberg-FellerCLTthat(cid:80)dn Ytarg ⇝N −τ + m⋆−mdiff,mtarg ,andthus
j=1 n,j 2 2
(cid:18) m⋆−mdiff (cid:19)
ℓ (µˆ ;ztarg,µ,C )⇝N ,mtarg (108)
n n σ 2
Step4: Gettingtheadvantageofthemisspecifiedattack.
WeusethatTV(cid:0) N (cid:0) µ 0,σ 02(cid:1) (cid:13) (cid:13)N (cid:0) µ 1,σ 02(cid:1)(cid:1) =Φ(cid:16) |µ0 2− σ0µ1|(cid:17) −Φ(cid:16) −|µ0 2− σ0µ1|(cid:17) ,sothat
l nim ,dAdv n(A
miss)=TV(cid:18)
N
(cid:18) −mt 2arg ,mtarg(cid:19) (cid:13)
(cid:13)
(cid:13) (cid:13)N
(cid:18) m⋆− 2mdiff ,mtarg(cid:19)(cid:19)
(cid:18) |m⋆+mtarg−mdiff|(cid:19) (cid:18) |m⋆+mtarg−mdiff|(cid:19)
=Φ √ −Φ − √
4 m⋆ 4 m⋆
(cid:18) |mscal| (cid:19) (cid:18) |mscal| (cid:19)
=Φ √ −Φ − √
2 mtarg 2 mtarg
becausemdiff =m⋆+mtarg−2mscal.
RemarkC.12(Simplewaytogettheexpectationscomputation). ThankstoRemarkC.6,werecallthat
1
ℓ (µˆ ;ztarg,µ,C )≈(ztarg−µ)TC−1(µˆ −µ)− ∥targ−µ∥2 (109)
n n σ σ n 2n Cσ−1
And thus taking the expectation under H and H , using that E (µˆ ) = µ, E (µˆ ) = n−1µ+ 1z⋆ and V (µˆ ) =
0 1 0 n 1 n n n 0 n
V (µˆ )=C ,wegetbackthesameexpectationsandvariancesvaluesastheresultofTheorem4.5.
1 n σ
36QuantifyingthePer-datumMembershipLeakage
D.Applicationtoprivacyauditing
Wecanleveragetheinsightsfromtheanalysisoftheper-datummembershipleakagetotheprivacyauditingproblem(Nasr
etal.,2023;Arcolezi&Gambs,2023;Steinkeetal.,2023;Pillutlaetal.,2023). Inprivacyauditing,thegoalistoretrievea
lowerboundontheprivacybudgetofagivenmechanism(e.g. DP-SGD(Abadietal.,2016)). Ourresultssuggestthatthe
canariestoaudittheempiricalmeanshouldbepointswithhighMahalanobisdistancewithrespecttothedata-generating
distribution.
Togobeyondtheempiricalmean,wefirstobservethatonestepofDP-SGDcorrespondstocomputingthenoisysub-sampled
empiricalmeanofclippedlossgradients. Specifically,
(cid:32) B (cid:33)
1 (cid:88)
θ =θ −η. g˜t ,
t t−1 B i
i=1
whereg˜t =min(cid:110) 1, c (cid:111) ·gt+N (cid:0) 0,γ2c2I(cid:1) ,gt =∇ ℓ(θ ,z ),Bisthebatchsize,ηthelearningrate,andθ and
i ∥gt∥ i i θt−1 t−1 i t
2
θ arethemodelparametersbeforeandaftertheDP-SGDupdate.
t−1
If the auditor has access to all the intermediate model parameters {θ }t and the learning rate η, i.e. if we are in a
j j=0
white-boxattacksetting(Nasretal.,2023),designinganattackandacanaryselectionstrategyforDP-SGDareequivalent
(cid:16) (cid:17)
todesigninganattackandacanaryselectionstrategyfortheempiricalmean 1 (cid:80)B g˜t . Thus,ourresultssuggestto
B i=1 i
chooseascanariesthedatapointsforwhichtheMahalanobisdistancesoftheclippednoisygradientsg˜tarebig,andto
i
(cid:16) (cid:17)
useasaplug-inLRscorevt = (gˆt−µˆ )TCˆ−1 1(θt−1−θt)−µˆ − 1 ∥gˆt−µˆ ∥2 . Here,µˆ andCˆ areplug-in
t t η t 2qn t Cˆ−1 t t
t
estimationofthemeanandco-varianceoftheclippednoisygradients,andgˆtthegradientatthetargetdatumz⋆.
Connectiontotheauditingframeworkof(Steinkeetal.,2023) Inthissection,weexplicithowourresultscanbeused
tocomplementtheprivacyauditingframeworkof(Steinkeetal.,2023)forDP-SGD,inthe“white-box"setting,wherethe
auditorhasaccestoalltheintermediateparameters,andtothegradients.
First,inAlgorithm5,werecalltheirframework. Then,weproposehowourinsightsfromtheempiricalmeancanbeusedto
proposeanewscoringfunction,i.e. Algorithm7andanewcanarychoosingstrategy,i.e. Algorithm6.
Algorithm7directlyusestheapproximateLRfromourtheoryasascore,ateachgradientstep. Then,ittakesthemaxofthe
scoresasindicatorofwhetherthepointhasbeenincludedatleastinoneofthesteps. Algorithm6startswithrcandidate
canaries,thenretreivesthemcannariesthathavethehighestMahalanobisdistanceinthegradientspace,atmultiplestepsof
theDP-SGDupdate.
Weleaveitforfutureworktoimplementandtestexperimentallyifthesemethodsindeedhaveaneffectontheauditing
results.
Connectionto(Nasretal.,2023) (Nasretal.,2023)tightlyauditedDP-SGDusingsimilarideastothoseofAlgorithm7
andAlgorithm6. Inthesamewhite-boxsetting,theyproposeascanariesthegradientpointswhereallgradientsarezero,
exceptatasingleindex,calledDiraccanaries(Nasretal.,2023,Sec. C.2). Ourresultsjustifythesuccessoftheircanary
choosingstrategy,sinceDiraccanarieswillhaveahighMahalanobisdistanceinthegradientspace. Ontheotherhand,asa
scoringattack,theyuseascalarproductattackonthegradientspace,whichasdiscussedinSection3istightlyconnectedto
ourplug-inapproximateLRtest.
Connectiontotheanalysisof(Leemannetal.,2023). (Leemannetal.,2023)proposesagradientbasedattackcalled
Gradient Likelihood Ratio (GLiR) Attack, i.e. Algorithm1 in (Leemann etal., 2023). The attack also isbased on the
observationthatonestepofDP-SGDisanempiricalmeanonthegradientspace. However,theiranalysisoftheLRteston
theempiricalmeanarrivesatadifferentscorefunctionthanours. Weprovidethetwofollowingremarkstoconnectthetwo
analyses.
First,inStep1oftheproof,insectionE.1. of(Leemannetal.,2023),theydeclarethat“Wesupposethatthenumberof
averagedsamplesissufficientlylargesuchthatwecanapplytheCentralLimitTheorem"andthustake
37QuantifyingthePer-datumMembershipLeakage
Algorithm5DP-SGDAuditor
Data: d∈(X ×Y)nconsistingofmauditingexamples(a.k.a. canaries)andn−mnon-auditingexamples. rreference
examples{zref,...,zref}
1 r
Parameters: Numberofexamplestorandomizemforaudit,numberofpositivek andnegativek guesses,audit-type
+ −
i.e. black-boxorwhite-box.
fori∈[m]do
SampleS ∈{−1,+1}independentlywithE[S ]=0.
i i
endfor
SetS =1foralli∈[n]\[m].
i
Splitdintod
IN
∈(X ×Y)nIN andd
OUT
∈(X ×Y)nOUT accordingtoS,wheren IN+n
OUT
=n. Namely,ifS
i
=1,
thend isind ;and,ifS =−1,thend isind .
i IN i i OUT
RunDP-SGDoninputd withappropriateparameters.
IN
LetT bethenumberofiterationsandletℓ:Rd×X →Rbetheloss.
Letθ ,··· ,θ ∈RdbetheoutputofDP-SGD.
0 T
ifaudit-type=black-boxthen
ComputethevectorofscoresY =(BB-SCORE(x ,θ ):i∈[m])∈Rm.
i T
else
ComputethevectorofscoresY =(WB-SCORE(x ,θ ,θ ,··· ,θ ):i∈[m])∈RmusingAlgorithm7.
i 0 1 T
endif
SortthescoresY.
LetT ∈{−1,0,+1}mbe+1forthelargestk scoresand-1forthesmallestk scores.
+ −
Return: ThevectorS ∈{−1,+1}mindicatingthetrueselectionandtheguessesT ∈{−1,0,+1}m.
UnderH ,
0
(cid:18) (cid:19)
1
µˆ ∼N µ, C (110)
n n σ
andunderH ,
1
(cid:18) (cid:19)
1 n−1 n−1
µˆ ∼N z⋆+ µ, C (111)
n n n n2 σ
(adaptingtheirnotationtoours,Eq. 45and46in(Leemannetal.,2023)).
However,theCentralLimitTheoremisalimitindistributionoftheempiricalmeans,andthusthelimitdistributionofµˆ is
n
justtheconstantµunderbothH andH ,theeffectofz⋆disappearsinthisstatement,sincen→∞.
0 1
Forthisclaimtobecorrect,oneshouldforexamplesupposethatthedata-generatingdistributionisexactlyaGaussian
distribution. Thisgivesthattheexactdistributionofµˆ underH andH areasexpressedbytheirtwoequations.
n 0 1
Supposingthatthedata-generatingdistributionsareGaussiandistributionssimplifiestheanalysis,sincenowthereisno
needtogoforasymptoticinnandd,andthusnoneedforEdgeworthexpansionsandLindebergCLT.
Ontheotherhand,asteststatistic,(Leemannetal.,2023)choosestoanalysethedistributionofthe“normsquared"of
are-centredandnormalisedversionofthemeani.e. S ≈ ∥C−1/2(µˆ −µ)∥2 (hidingsomeconstantsspecifictotheir
n σ n
analysis). TheycharacterisethedistributionofS andshowthatitisa(scaled)non-centralchi-squareddistributionwithd
n
degreesoffreedom,withdifferentparametersunderH andH .
0 1
Ouranalysisprovidesasimplertest(Eq10),andcouldbeappliedtothesettingof(Leemannetal.,2023)toprovidea
tighteranalysisofthef-MIPguaranteeofDP-SGD(Leemannetal.,2023).
38QuantifyingthePer-datumMembershipLeakage
Algorithm6Choosingcanariesforwhite-boxauditing
Data: nnon-auditingexamplesandrreferenceexamples
Parameters: mthenumberofcanariestochosewherem<r,andDP-SGPparameters: NumberofiterationsT ≥1,
clippingthresholdc>0,noisemultiplierσ >0,samplingprobabilityq ∈(0,1],learningrateη >0.
Output: Asetofmcanaries
Initializeascoringlistoflengthrwithzerosi.e. S =[0]∗r.
Initializeθ ∈Rd.
0
fort=1,··· ,T do
SampleSt ⊆[n]whereeachi∈[n]isincludedindependentlywithprobabilityq.
Computegt =∇ f(cid:0) θt−1,z (cid:1) ∈Rdforalli∈St.
i θt−1 i
(cid:26) (cid:27)
Clipgˆt =min 1, c ·gt ∈Rdforalli∈St.
i ∥gt∥ i
Computetheempiricai lm2 eanµˆ = 1 (cid:80) gˆt
t |St| i∈St i
ComputetheempiricalcovariancematrixCˆ = 1 (cid:80) gˆt(gˆt)T
t |St| i∈St i i
Sampleξt ∼N (cid:0) 0,σ2c2I (cid:1) .
d
(cid:16) (cid:17)
Updateθ =θ −η· µˆ + 1 ξt .
t t−1 t |St|
Computegref,t =∇ f(cid:0) θt−1,zref(cid:1) ∈Rdthegradientforalli∈[1,r]referenceexamples.
i θt−1 i
(cid:26) (cid:27)
Clipgˆref,t =min 1, c ·gref,t ∈Rdforalli∈[1,r].
i ∥gref,t∥ i
i 2
SortinascendingordertherreferencepointswithrespecttotheestimatedMahalanobisdistance∥gˆref,t−µˆ ∥ .
i t Cˆ−1
t
Letrank(i)therankofreferencepointzref,fori∈[1,r],
i
UpdatethescoringlistS suchthatS ←S +rank(i)
i i
endfor
ReturnthesetofmreferencepointswiththehighestscoresinS.
Algorithm7Computingscoresforwhite-boxauditing
Input: Acanaryz⋆,asetweightsw ,...,w correspondingtotheoutputofDP-SGD,oracleaccesstogradientofthe
1 T
loss∇ ℓ
θ
Output: WB-SCORE(z⋆,θ ,··· ,θ )
1 T
fort=1,··· ,T do
Computegt =∇ ℓ(θ ,z⋆)∈Rd.
(cid:110)θt−1 (cid:111)t−1
Clipgˆt =min 1, c ·gt ∈Rd.
∥gt∥
2
Computegref,t =∇ ℓ(cid:0) θt−1,zref(cid:1) ∈Rdthegradientforalli∈[1,r]referenceexamples.
i θt−1 i
(cid:26) (cid:27)
Clipgˆref,t =min 1, c ·gref,t ∈Rdforalli∈[1,r].
i ∥gref,t∥ i
i 2
Computetheempiricalmeanµˆ = 1(cid:80)r gˆref,t
t r i=1 i
ComputetheempiricalcovariancematrixCˆ = 1(cid:80)r gˆref,t(gˆref,t)T
t r i=1 i i
(cid:16) (cid:17)
Letvt =(gˆt−µˆ )TCˆ−1 1(θt−1−θt)−µˆ − 1 ∥gˆt−µˆ ∥2 .
t t η t 2qn t Cˆ−1
t
endfor
Returnmaxℓ vt ∈R
t=1
39QuantifyingthePer-datumMembershipLeakage
E.ExperimentalDetails
Here,weempiricallyverifyourtheoreticalresultsandtheirimpactsbycomputingtheeffectoftheleakagescore(m⋆)on
theper-datumROCcurve.
E.1.Experimentalsetup
Wetaken=1000,τ =5andthusd=5000. ThedatageneratingdistributionDisaddimensionalBernoullidistribution,
with parameter p ∈ [0,1]d. To chose p, we sample it uniformly randomly from [a,1−a]d, where a = 0.25 to avoid
limitcases. Oncepischosen,weusethesameD ≜Bern(p)foralltheexperiments. Thethreemechanismsconsidered
areMemp,Mγ andMsub,ρ. Theadversarieschosentoeachmechanismarethethresholdingadversariesbasedonthe
n n n
asymptoticapproximationsofLRtests,suggestedbytheanalysis. ForMemp,weusetheapproximationofEq(10). The
n
approximate LR test for Mγ is taken by replacing C by C +C in Eq (11). For Msub,ρ, we take the approximate
n σ σ γ n
log-likelihoodrationofEq.(15)oftheanalysis. Finally,wechoosetargetdatapointsin{0,1}dinthreeways:
(a)Theeasiestpointtoattackz⋆ isthepointwiththehighestMahalanobisdistancewithrespecttop. Itisthepointwith
easy
binarycoordinatesbeingthefurthestawayfromthecoordinatesofp: z⋆ =(1{p≤1/2})d .
easy i=1
(b)Similarly,thehardestpointtoattackisz⋆ =(1{p>1/2})d ,whichtakesthebinariesclosesttop.
hard i=1
(c)Amediumpointtoattackwouldbejustapointrandomlysampledfromthedata-generatingdistribution,i.e. z⋆ ∼
med
Bern(p),forwhichtheMahalanobisdistanceisoforderdandtheleakagescoreoforderτ =d/n.
E.2.Analysisofresults
1. Figure2(a)and(b)showsthedistributionoftheapproximatelog-likelihoodratiosasinEq.(10). Togeneratethese
twofigures,wefirstsimulateAlgorithm1forn =2000togetalistof1000empiricalmeanswherethetargetwasnot
sim
includedand1000empiricalmeanswherethetargetwasincluded. Thenwecomputetheapproximatelog-likelihoodratio
ofEq.10foreachofthe2000empiricalmeans,withµ = pandC = diag(p(1−p))andz⋆ = z⋆ forFigure2(a)
σ easy
andz⋆ =z⋆ forFigure2(b). Thesetwofiguresshowthattheapproximatelog-likelihoodratioisindeeddistributedby
hard
Gaussianswithmeans−m⋆ and m⋆ ,andvariancem⋆aspredictedbyTheorem3.1.
2 2
2. Figure 2 (c) compares the theoretical power function with the empirical ROC curve of the for the approximate log-
likelihoodratioofEq.10withz⋆ . The“Theoretical"dashedlineinFigure2(c)correspondstoplottingthetheoretical
hard
Pow of(Eq9). The“empirical"solidlineisgeneratedbysimulatingtheMIgameofAlgorithm2forT =2000rounds.
n
Thenbyvaryingthethresholdsoftheapproximatelog-likelihoodratioadversary,weempiricallycomputethefalsepositive
andtruepositiverates. Eq.10perfectlycharacterisestheROCcurveaspredictedbyCorollary.
3. Figures 2 (d), (e) and (f) are generated similarly to Figure (c), for the three mechanisms Memp, Mγ and Msub,ρ.
n n n
Figure2(d)investigatestheeffectofm⋆byvaryingthetargetdatum,wherethebluelinecorrespondstoz⋆ ,thegreen
easy
linetoz⋆ andtheredlinetoz⋆ . Figure2(e)and(f)investigatetheeffectofthenoisescaleγ andthesub-sampling
med hard
ratioρ,byvaryingtheseparametersforthesamez⋆ . Thethreefiguresvalidatethepredictionofthetheoreticalpower
easy
functions,andshowthatm⋆,m˜⋆ andρm⋆perfectlycharacterisetheper-datumleakageofthethreemechanismsMemp,
γ n
Mγ andMsub,ρ.
n n
40
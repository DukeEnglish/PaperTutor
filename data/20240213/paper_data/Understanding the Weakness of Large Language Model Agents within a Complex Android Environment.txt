Understanding the Weakness of Large Language Model Agents
within a Complex Android Environment
MingzheXing∗ RongkaiZhang HuiXue
PekingUniversity PekingUniversity MicrosoftResearch
QiChen FanYang ZhenXiao†
MicrosoftResearch MicrosoftResearch PekingUniversity
ABSTRACT actionsbasedupontheperceivedstateofenvironment.Anexam-
Largelanguagemodels(LLMs)haveempoweredintelligentagents pleisforLLMstointeractwithdomain-specificsoftware,suchas
toexecuteintricatetaskswithindomain-specificsoftwaresuchas databases[13],games[28]andbrowsers[40],fortaskcompletion.
browsersandgames.However,whenappliedtogeneral-purpose Morerecently,newLLM-basedagentshaveemergedtointeract
softwaresystemslikeoperatingsystems,LLMagentsfacethreepri- withgeneral-purposesoftwaresystems,suchasoperatingsystems
marychallenges.Firstly,theactionspaceisvastanddynamic,posing alongwiththeirinstalledAPPs,toaccomplishmorecomplexopen-
difficultiesforLLMagentstomaintainanup-to-dateunderstanding domaintasks[35,36].Thesetasksrangefromsimpleactionslike
anddeliveraccurateresponses.Secondly,real-worldtasksoftenre- settingreminderstomoreintricateactivitieslikefinancialmanage-
quireinter-applicationcooperation,demandingfarsightedplanning mentandstayingconnectedwithlovedones.Complexscenariosin
fromLLMagents.Thirdly,agentsneedtoidentifyoptimalsolutions operatingsystemstypicallymanifestthefollowingcharacteristics:
aligningwithuserconstraints,suchassecurityconcernsandprefer- 1)avastandever-changingactionspaceduetoreal-timeinter-
ences.ThesechallengesmotivateAndroidArena,anenvironment netdataexchange,APPinstallations,andupgrades;2)anincreasing
andbenchmarkdesignedtoevaluateLLMagentsonamodernop- demandforcross-APPcollaborationasusertasksbecomemore
eratingsystem.Toaddresshigh-costofmanpower,wedesigna interconnectedandmultifaceted;and3)heightenedconsideration
scalableandsemi-automatedmethodtoconstructthebenchmark. forpersonalinterestsandsecurityconcerns.
Inthetaskevaluation,AndroidArenaincorporatesaccurateand Thesecharacteristicsmotivateustoestablishanewenvironment
adaptivemetricstoaddresstheissueofnon-uniquesolutions.Our andcomprehensivebenchmarktostudytheboundariesofLLM
findingsrevealthatevenstate-of-the-artLLMagentsstrugglein agent’scapabilitywithinacomplexsoftwaresystem.Inthispaper,
cross-APPscenariosandadheringtospecificconstraints.Addition-
weintroduceAndroidArena,anenvironmentbuiltontheAndroid
ally,weidentifyalackoffourkeycapabilities,i.e.,understanding, operatingsystem,accompaniedbyanevaluationbenchmarkcon-
reasoning,exploration,andreflection,asprimaryreasonsforthe
tainingannotatedgroundtruthactionsequences.AndroidArena
failureofLLMagents.Furthermore,weprovideempiricalanalysis supportsreal-timeinternetdataexchangeanddynamicAPPman-
onthefailureofreflection,andimprovethesuccessrateby27%with agement, and enables seamless operations across various APPs.
ourproposedexplorationstrategy.Thisworkisthefirsttopresent ThesefeaturesfacilitatetheevaluationofLLMagentsinavast
valuableinsightsinunderstandingfine-grainedweaknessofLLM anddynamicactionspaceandcross-APPscenarios.Additionally,we
agents,andoffersapathforwardforfutureresearchinthisarea.En- proposeascalablemethodforsemi-automaticallyconstructingan
vironment,benchmark,andevaluationcodeforAndroidArenaare instructionbenchmark,ensuringcomprehensivecoverageofAPP
releasedathttps://github.com/AndroidArenaAgent/AndroidArena. functionalities.Ouropen-sourcebenchmark,informedbytheafore-
mentionedcharacteristics,evaluatestasksnotonlywithinasingle
APPbutalsocomplextasksrequiringcollaborationacrossmultiple
1 INTRODUCTION
APPs.Itfurtherconsiderstaskssubjecttoconstraintssuchasuser
Large language models (LLMs) have shown great potentials in
preferencesandsecurityconsiderations.
understandinghiddenintentfromhumanandcommonsenserea-
Evaluating tasks within a complex operating system is non-
soning[27].ThismakesitpossibletoutilizeLLMasagent[29,32],
trivial[14],primarilyduetothefactthatthefeasibleactionse-
anintelligententitycapableofmakingdecisionsandexecuting
quenceforataskisoftennon-unique.Thispresentsasignificant
challenge to precisely evaluating agents in multi-step decision-
∗ThisworkisdoneduringtheinternshipatMicrosoftResearch.
makingscenarios.Toaddressthisissue,wedeviseadaptivemet-
†Correspondingauthor.
ricstoevaluatetaskcompletionaccurately.Theevaluation
resultsrevealthatallstate-of-the-art(SOTA)LLMagentsfallshort
Permissiontomakedigitalorhardcopiesofallorpartofthisworkforpersonalor
classroomuseisgrantedwithoutfeeprovidedthatcopiesarenotmadeordistributed incross-APPscenarios,withasuccessrateoflessthan60%,and
forprofitorcommercialadvantageandthatcopiesbearthisnoticeandthefullcitation struggletofullyadheretospecificconstraints.Notably,GPT-3.5[18]
onthefirstpage.Copyrightsforcomponentsofthisworkownedbyothersthanthe
author(s)mustbehonored.Abstractingwithcreditispermitted.Tocopyotherwise,or achievesa6xhighersuccessratethanLLaMA2-70B[25].Through
republish,topostonserversortoredistributetolists,requirespriorspecificpermission meticulouscaseanalysistounderstandthecausesoffailure,we
and/orafee.Requestpermissionsfrompermissions@acm.org.
identifyandabstractfourkeyplanningcapabilitiesofLLM
Conferenceacronym’XX,June03–05,2018,Woodstock,NY
©2018Copyrightheldbytheowner/author(s).PublicationrightslicensedtoACM. agents,inspiredbyreinforcementlearning(RL)[24]:understand-
ACMISBN978-1-4503-XXXX-X/18/06 ing,reasoning,exploration,andreflection.Wedesignmetrics
https://doi.org/XXXXXXX.XXXXXXX
4202
beF
9
]IA.sc[
1v69560.2042:viXraConferenceacronym’XX,June03–05,2018,Woodstock,NY MingzheXing,RongkaiZhang,HuiXue,QiChen,FanYang,andZhenXiao
Table1:ThecomparisonbetweenourAndroidArenabenchmarkandexistingbenchmarks.
Online Realistic Scalably CollaborativeTasks Taskswith
Benchmark
Evaluation Environment Generated betweenAPPs Constraints
MineCraft[28] ✓ ✗ ✗ ✗ ✗
Mind2Web[7] ✗ ✓ ✗ ✗ ✗
AITW[20] ✗ ✓ ✗ ✗ ✗
AndroidEnv[26] ✓ ✓ ✗ ✗ ✗
WebArena[40] ✓ ✓ ✗ ✗ ✗
AndroidArena ✓ ✓ ✓ ✓ ✓
tomeasurethesefine-grainedcapabilities,showingimprove- 2.2 ExistingOperatingSystemTaskBenchmark
mentdirectionsforLLMagents.LLaMA2exhibitsweaknesses OperatingSystems(OS)serveascrucialenvironmentswithwhich
acrossalldimensions,andevenadvancedmodelslikeGPT-4[18] humansinteractdaily,andnumerousbenchmarkshaveemergedto
arenoexemptions,exhibitingweakreflectionandexplorationabil- evaluatetheperformancesofagentswithinOS.AITW[20]stands
ities.Empiricalanalysispredominantlyattributestheweakness outasastaticimagedatasetthatoffershumandemonstrationsof
inreflectiontolow-qualitytrajectoriesandsparsityinenviron- deviceinteractions.However,thestaticnatureofAITWprevents
mentfeedback.Moreover,wefindthatbyintegratinghistorical agentsfromobtainingareproducibleenvironment.Ontheother
visitedinformationintothepromptandbalancingexplorationand hand,AndroidEnv[26]providessupportfordynamicinteractions
exploitationbytheagent,thesuccessrateofspecificAPPscan withAPP.Despitethis,itonlysupportssingleAPP’sinteractionin
improveby27%,andtheexplorationperformanceisenhanced. eachenvironmentinstance,whichlimitsitscapabilitytoevaluate
Insummary,wemakethefollowingcontributions. complexandrealistictasks.WebArena[40]createstaskssimulating
humanbehavioronwebbrowsers.However,itisalsolimitedto
• Weopen-sourceAndroidArena,abenchmarkbasedontheAn-
automatetasksonasinglewebsite,whichposesaconstraintonits
droidoperatingsystem,toevaluatedailytasksrequiringcross-
applicability.Whiletheseworkshavebeenasourceofinspiration,
APPcollaboration,aswellasconsiderationsforconstraintssuch
theyalsohighlightthesignificantchallengesofevaluatingtasks
assecurity.Additionally,ourscalableandsemi-automatedap-
onOS.Tasksperformedbyreal-worldusersareoftenmorecom-
proachreducesthecostofbenchmarkconstruction.
plexanddemanding,requiringthecollaborationofmultipleAPPs.
• OurfindingsindicatethatSTOAmodelsunderperformindaily
Additionally,agentsneedtoconsidervariousconstraintssuchas
tasksandarenotreadyfordirectproductintegration.Wepro-
securityanduserpreference.ThereforeweproposeAndroidArena,
posefine-grainedmetricsthatrevealfailurecausesandhighlight
areproduciblemobileenvironmentthatallowsforcross-APPac-
fourareasforfutureresearch:understanding,reasoning,reflec-
cess.Alongsidethis,weintroduceanewdatasetthatencapsulates
tion,andexploration.Initialanalysisshowthefailurereasonsof
therichness,difficulty,andconstraintsofinstructions.Thedetail
reflection,and27%ofimprovementwhenenhancingexploration.
comparisonwithotherworksislistedinTable1.
2 BACKGROUND 2.3 ExistingMetricsforMulti-stepDecision
2.1 FrameworksofLLMAgent To assess the performances of LLM agents, a range of metrics
are proposed. SmartPlay [31] and LASER [16] employ success
WiththeemergenceofLLMs,thestudyofLLMagentshasbegun
rateandrewardtoevaluatetaskcompletion.However,thesemet-
tothrive.Earlyresearchwork[1,11,19]promptLLMstodirectly
ricscannotreflectthedetailedcompletionwithinindividualtasks.
generateactionsbasedonenvironmentobservations.ReAct[38]
TPTU[21]andMind2Web[7]incorporateastep-wiseactionalign-
isapioneerworktointegratereasoningandactinginLLMfor
mentmethod,offeringamorenuancedanalysisoftaskcompletion.
generaltasksolving.Itfirstgeneratesreasoningtracesbasedon
Nevertheless,whenappliedtomulti-stepdecision-makingscenar-
historycontext,subsequentlyproducingactionstointeractwith
ioswherethefeasibleactionsequenceforcompletingataskisnot
theenvironment.Buildinguponthistask-solvingparadigm,subse-
unique,thiskindofstep-wisematchingmethodmayintroducein-
quentagentshavebeenproposedtoenhancecapabilitiesinvarious
accuracies.Inthispaper,weproposeanadaptivewaytoaccurately
dimensions.Reflexion[22]summarizestextualfeedbackfromthe
assessthetaskcompletion,andasetoffine-grainedabilityevalu-
environmentandthenincorporatesitasadditionalcontextforthe
ationmetricstounderstandtheweaknessesofagents,providing
LLMagentinthesubsequentepisode.Theself-reflectivecontext
valuableinsightsintoimprovementdirectionsforLLMagents.
actsasasemanticgradientsignal,offeringtheagentaconcrete
directiontoimproveupon,andfacilitatesthelearningprocessfrom
3 ANDROIDARENAENVIRONMENT
priormistakesforenhancingtaskperformance.Thispaperfocuses
onevaluatingtheabilitiesofLLMagentsandunderstandingtheir Inthissection,weintroducetheAndroidArenaenvironment,dis-
weaknesses.WeadoptReActasthebasicagentstrategyandReflex- tinguishedbyitsvastanddynamicactionspace,alongwithits
ionasanapproachtoassesstheagent’sabilityofself-reflection. capabilitytofacilitatecross-APPandconstrainedtaskexecution.UnderstandingtheWeaknessofLargeLanguageModelAgentswithinaComplexAndroidEnvironment Conferenceacronym’XX,June03–05,2018,Woodstock,NY
Cross-APP Task
Search contacts Extract the email titled "flight confirmation", Atlanta International
and find the direction to the airport. Airport
A Alice
B Bob
Constrained Task
JJ John
Tell Bob the meeting is moved to tomorrow
Z Zara
+ Constraint: I prefer to use Email
rather than instant messaging APPs
Contacts Fix & manage
(a)APPscreenshot. (b)Compressedobservation. Figure2:Examplesofcross-APPandconstrainedtasks.
Figure1:AnexampleoftheContactsAPPpageanditscorre-
proposedmethodachievesacompressionratioof86.6%acrosssev-
spondingcompressedobservation.
eraltestedAPPs(pleaseseeTable6in§A).Motivatedbyprevious
research[12]showingsuperiorperformancebyregardingLLMas
rewardfunctions,weemployGPT-4toquantifythereward𝑟,and
Webeginbyofferingaformaldefinitionofthemobiletaskautoma-
validateitseffectivenessthroughexperimentsin§6.2.
tionprocess,followedbyanoverviewofthesystemimplementa-
tion.Subsequently,weexploretheintricaciesoftheactionspace,
3.2 VastandDynamicActionSpace
highlightingitsdynamicandexpansivenature.
Unlikepriorenvironments[26,40]focusingonasingleAPPand
3.1 LLMAgentforMobileTaskAutomation onlysupportingspecificactions,ouractionspaceisvastanddy-
namic.ItisattributedtothefactthatatypicalAPPmayfeature
Givenataskpresentedwithauserinstructioninnaturallanguage,
hundredsofUIelementsavailableformanipulation,andtheseUI
theagentisresponsibleformakingactiondecisionstocomplete
componentsexhibitvariabilityowingtoreal-timeinternetdataex-
thisinstructiononthephone.Thisprocesscanbeformulatedasa
ContextualMarkovDecisionProcess(CMDP)[9]⟨C,S,A,T,𝑟⟩. change.Thevastanddynamicnaturesarefurtheramplifiedwhen
Context𝑐 ∈Cisthemobiletaskexplicitlyexpressedasatextual consideringalltheAPPswithinAndroidArena.Ourdesignedac-
instruction.State𝑠 ∈Sisthecurrentobservedphonestate,i.e.,the tions can be categorized into four groups: 1) APP-level actions
displayedcontentonthescreen.Action𝑎∈Acanbeperformedon are responsible for installing, launching, and stopping APPs; 2)
Component-levelactionsdirectlyoperatetheUIcomponentssuch
thecurrentphonescreen,e.g.,clicksortyping.Transitionfunction
T(𝑠′|𝑠,𝑎) representsthechangeinthephoneonperformingan asclicking,typing,andswipingetc;3)System-levelactionsinclude
action.Reward𝑟 isawardedforsuccessfulcompletionofthetask. turningthescreenonandoff,adjustingthevolume,andtaking
screenshotsetc;and4)Task-levelactionisissuedwhentheagent
Implementation.OurimplementationisbasedonUIAutoma-
deemsthetaskshouldfinish.Thecompleteactionspaceisin§B.
tor[8],aUItestingframeworkthatenablesdirectoperationsonUI
components.WithUIAutomator,weofferflexibleconfigurations
4 SCALABLEMOBILETASKGENERATOR
to render APP page content (i.e., the observation space) in two
modes:1)thephonescreenshot,apixel-basedrepresentationas ThetasksexecutedinAndroidArenaenvironmentaredistinguished
perceivedbyhumans,and2)thetextualXMLdescriptionofthe fromotherbenchmarksbyincorporatingcross-APPcollaboration
phonescreen(depictedinFig.8in§A).Itisimportanttonotethat, andconstrainedtasksscenarios,commonlyencounteredinreal-life
giventhefocusofthisworkonLLMagents,weexclusivelyutilize but ignored in existing benchmarks. Even for single-APP tasks,
thetextmodality,whileacknowledgingthatourimplementationis existingbenchmarksareeithersmall-scale[36]orderivedfrom
capableofsupportingmulti-modalmodels.EachUIcomponentin thePixelHelpforum[20,35],aplatformdedicatedtodiscussing
thescreencorrespondstoanXMLentry,containingitsrole(e.g., phone-relatedissues,thusdeviatingfromroutinetasks.Theseshort-
abutton),textcontent,andproperties(e.g.,ifclickable)informa- comingsunderscorethenecessityforabenchmarkthatexhibits
tion. A statistic conducted on eight popular APPs indicates an higherscalabilityandalignscloselywithhumanexperiences,
averagetokencountfortheXMLexceeding10,000.Consequently, whileaccountingforcross-APPandconstrainedtasks.
directlyfeedingtheXMLintotheLLMisimpracticalduetocon- ThissectionoutlinesourproposedMobileTaskGenerator(MTG
textlengthlimitations.Toaddressthischallenge,weproposea inshort),aframeworkforscalabletaskconstruction.MTGnotonly
two-stageheuristiccompressionmethod,involvingtheremoval alignswithtypicalhumaninteractionpatterns,butalsoencom-
ofdecision-irrelevantXMLtagsandthemergingofnon-visibleor passesadiversearrayofAPPfunctions,enablingtoevaluatethe
non-functionalnodes(thedetailedalgorithmisprovidedin§A) agentsacrossabroaderspectrum.Theconstructedbenchmarkcom-
tocompresstheXML.AsillustratedinFig.1(b),thecompressed prisesthreetaskcategories:single-APPtasks,cross-APPtasks,and
observationmaintainsthehierarchicalstructureof theoriginal constrainedtasks.Thesingle-APPandcross-APPtasksarecrafted
XML,enablingtheLLMagenttocomprehendtheUIlayoutvia toassesstheagents’proficiencyinsolvinggeneraltasks,andmore
text.Subsequenttocompression,eachentryisassignedaunique complextasksrequiringcooperationbetweentwoAPPs.Incon-
ID(e.g.,[nd725]),facilitatingagentsinlocatingtheUIelement.Our trasttotheformertwocategoriesfocusingontaskcompletion,theConferenceacronym’XX,June03–05,2018,Woodstock,NY MingzheXing,RongkaiZhang,HuiXue,QiChen,FanYang,andZhenXiao
APP Functionalities Extraction Instruction Generation and Evolution Human Verification
and Annotation
Queries Functionalities Tasks
Create email from event Extract the date from the email
Gmail and Calendar
collaboration features Send email after titled "meeting" and create a calendar event.
creating an event ......
How to use Gmail and
Calendar together for tasks Search Engine Create event from Create a new Gmail draft with Human Verification
emali content and Annotation
the details of a event titled "meeting".
Functions of Gmail and Calendar?
Vector Database Reterival QA Functionality Evol-Instruct Benchmark
to Instruction
Figure3:IllustrativeexampleoftheMTGworkflowforcross-APP(i.e.,GmailandContacts)tasksconstructionprocedure.The
single-APPtasksaregeneratedwiththesameprocessbutwithdifferentquerytemplatesandLLMprompts(pleasesee§F.5).
Table2:Thestatisticsofourbenchmark. theoriginalinstructions.Intheapplicationofthisstrategy,each
evolutionaryiterationinvolvesusingLLMalongwithtwoprompts,
TaskType #Tasks Avg.Len.ofActionSequence namely in-depth evolving and in-breadth evolving. The in-depth
single-APPtasks 164 6.13 evolvingpromptencouragesLLMtorewriteinstructionsbymak-
cross-APPtasks 22 11.14 ingthemmorecomplexandchallenging,whilein-breadthevolving
constrainedtasks 35 6.03 promptaimstoenhancethefeaturecoverageandoveralldataset
diversity.Throughtheiterativeexecutionofmultipleevolutions,
wesequentiallyderiveevolutiondatasets,therebyexpandingand
constrainedtasksaredesignedtoevaluateagents’proficiencyin refiningthepooloftaskinstructions.
comprehendingpredefinedconstraints.Inourbenchmark,each HumanVerificationandAnnotationToconstructthebench-
taskconsistsofanaturallanguageinstructionandasequenceof mark, we engage annotators proficient in operating the testing
labeledactionsfortaskcompletion.Constrainedtasksadditionally APPs.Theyarefirstinstructedtodiscernandfiltertasksexhibit-
includeafieldofconstraintsrepresentedinnaturallanguage.Ex- ingrepetitiveness,ambiguity,orimpossibilitytocomplete.Subse-
amplesofcross-APPandconstrainedtasksareshowninFig.2.The quently,theydocumenttheirinteractionswiththephone.Given
statisticalinformationofourbenchmarkispresentedinTable2. thattheremightbemultiplefeasibleactionsequencesforcomplet-
ingatask,theyareencouragedtooptforthemostconciseaction
4.1 Single-andCross-APPTasksConstruction planwiththeshortestactionsequence.Aftercompletingatask,
APPFunctionalitiesExtraction.Weincorporate13testingAPPs annotatorsre-executetheannotatedactionsequencewithareplay
frompre-installedGooglesuitethataredesignedtoworkseam- script,enablingthemeasilytoverifytheaccuracyofannotated
lessly with the Android OS and provide essential services. The actionsequence.Subsequently,thecompiledtaskinstructionsand
completeAPPlistcanbefoundin§C.Ourobjectiveistoformulate actiondemonstrationsarecollectedintothebenchmarkdataset.
thetaskinstructionsthatcoverrichanddiversefunctionalitiesof
4.2 ConstrainedTasksConstruction
APPswhilealigningwiththeauthenticusagebehaviorofhumans.
Toachievethisgoal,weproposeleveraginginsightsgleanedfrom Inthecontextofreal-worldmobiletasks,oftenconfinedbyspe-
humandiscussionsandsharedexperiencesregardingAPPsavail- cificuserpreferencesorsecurityconsiderations,weintroducea
ableontheinternet.Concretely,wefirstformulatequeriescentered constrainedtasksettoassesstheagents’capabilitytocomprehend
ontheusageofspecificAPPsandemploysearchenginestoretrieve user-definedconstraintsandmakedecisionsadeptlytoavoidviola-
relatedwebpages.AsdepictedinFig.3,exemplifiedconstructed tions.Specifically,weconsiderthreetypesofconstraints:APP-level,
queriesare“GmailandCalendarcollaborationfeatures” and“How page-levelandcomponent-levelconstraints.APP-levelconstraints
touseGmailandCalendartogetherfortasks”.Wethenbuildavec- involvethepreferencesofusingspecificAPPs,exemplifiedbycon-
tordatabasetostorethesehighvolumeofwebpagescontaining straintslike“preferringnottouseinstantmessageforcommunica-
richfunctionalitiesthatgenuinelyengageandconcernusers.By tion”.Page-levelconstraintsrestrictaccesstoaspecificpage,asseen
retrievingfromthedatabasewithLLMandaspecificprompt(§F.4), inscenariossuchas“refrainingfromenteringthelabellistpagein
wecanextractconfinedAPPfunctionalities. Gmailduetothepresenceofsensitiveinformation”.Component-level
InstructionGenerationandEvolutionOurnextstepinvolves constraintsidentifyspecificUIcomponentsassensitiveactions,
utilizingaLLMwithafunctionality-to-instructionprompt(pro- e.g.,“donotclickthepaymentbutton”.Itisnoteworthythatthe
videdin§F.5)togenerateinitialtaskinstructionsgroundedinthe constrainedtasksaremeticulouslyselectedfromthesingle-APP
identifiedAPPfunctionalities.Toautomaticallymass-producemore tasksetandmanuallylabeledwithnaturallanguageconstraints
instructions,weemploytheEvol-Instruct[33]strategytoexpand alongwiththecorrespondingcorrectactionsequences.UnderstandingtheWeaknessofLargeLanguageModelAgentswithinaComplexAndroidEnvironment Conferenceacronym’XX,June03–05,2018,Woodstock,NY
5 EVALUATIONMETRICS Algorithm1DeepQ-learning
Designingprecisemetricsisessentialforaccuratelyandcomprehen- InitializereplaymemoryDandaction-valuefunction𝑄
sivelyevaluatingagent’sperformance.However,existingmetrics forepisode=1,𝑀do
employedinmulti-stepdecision-makingscenarios[7,21]exhibit Initialisestate𝜙 1=𝜙(𝑠 1)
impreciseandsurface-levelevaluationissues,whichhinderthem for𝑡 =1,𝑇 do
tofullyunderstandtheperformanceandweaknessofLLMagent. Withprobability𝜖selectarandomaction𝑎 𝑡 ⊲Explore
To address these limitations, we propose a novel set of metrics theenvironment
toevaluateagentperformanceinamoreadaptiveandprecise otherwiseselect𝑎 𝑡 =max𝑎𝑄∗(𝜙(𝑠 𝑡),𝑎;𝜃) ⊲Reasonthe
manner,andtoassessfine-grainedagentplanningabilities. nextaction
Executeaction𝑎 𝑡 inemulatorandobservereward𝑟 𝑡 and
5.1 AdaptiveandPreciseTaskCompletion state𝑠 𝑡+1
Evaluation Preprocessobservation𝜙 𝑡+1=𝜙(𝑠 𝑡+1)⊲Understandthe
environmentandobservation
To begin with, we introduce the notations of action sequences.
Given a task, its annotated action sequence can be represented
Storetransition(𝜙 𝑡,𝑎 𝑡,𝑟 𝑡,𝜙 𝑡+1)inD
OptimizeQbasedonaminibatchsampledfromD ⊲
asaoflength𝐿,andtheactualexecutedactionsisaˆ oflength𝐿ˆ.
Reflectionfromexperience
Exemplaryinstancesofaandaˆareillustratedasfollows:
endfor
a=𝐴𝐵𝐶𝐷𝐸𝐹𝐺 (1) endfor
aˆ =𝐴𝑋𝑌𝐵𝑈𝑉𝑊𝐸𝐹𝐹𝐹𝐺𝑍, (2)
whereeachuppercasecharacterdenotesadistincttypeofaction.
5.2 UnderstandRootCausewithFine-grained
Manyexistingmetrics[7,21]adoptthestep-wisematchingmethod,
AbilitiesEvaluation
whichisimpreciseinthisscenario.InEq.2,theagentidentifies
thecorrectaction𝐵aftertwostepsofexploration(i.e.,𝑋 and𝑌). Inadditiontoprovidingadaptiveandaccuratemetricsforevaluat-
Despitethisactionsequencenotaligningwiththegroundtruth ingtaskcompletionincomplexdecision-makingscenarios,another
(i.e.,Eq.1)inthestep-wisemanner,itleadstothecorrectsubse- primaryobjectiveofourstudyistoinvestigatetheunderlyingroot
quentstepandconstitutesavalidactionsequenceforcompleting causecontributingtothesuccessorfailureofagentsplanning.Rec-
thetask.Therefore,previousmetricsexhibitinaccuraciesinthe ognizingthatRLservesasaclassicalandeffectiveapproachtoad-
multi-stepdecision-makingenvironmentswheremultiplefeasible dresstheCMDPproblem[9],weabstractthefundamentalelements
actionsequencesexist.Incontrasttopreviousgreedystep-wise andmechanismsinRLagents,andproposefine-grainedcapabilities
matching,weproposetoalignthetwosequencesinanadaptive tailoredtoassessLLMagents.HereweusetheDQN[17](Algo-
way,i.e.,calculatingtheirlongestcommonsubsequence(LCS) rithm1),oneofthemostclassicalRLalgorithms,asanexample.
a𝑙𝑐𝑠 (markedinredinEq.1and2).TheLCSaccuratelyandadap- Wedecomposeitintofourkeydimensions,i.e.,understanding,
tivelyreflectstaskcompletioninthemulti-stepdecision-making reasoning,exploration,andreflection.
scenario.BasedontheaccurateLCS,weproposeourmetricsto Understanding.Theaspectofunderstandingencompassesthe
evaluatethetaskcompletionasfollows: agent’sproficiencyincomprehendingobservationandadhering
• T tha esk rewR ae rw da dr isd co(T unR t) f. a𝑇 ct𝑅 or= ,𝛾(cid:205) (𝐿𝑖𝐿 −= 𝑖0 )𝛾 a( s𝐿 s− ig𝑖 n)1 s𝑖 h, iw ghh ee rre re𝛾 wa∈ rd[ s0 t, o1] thi es t ao geth ne tsa cc oti no fin nf io nr gm ta ht eia rn od us tp pa uc te as cp tie oc nifi se sd tri in ctt lyhe wp itr ho im np at. pU ren dli ek fie nR edL
actionspace,theoutputspaceofLLMspanstheentirevocabulary.
actionsthatareclosertothefinalaction(e.g.,𝐺 inEq.1),and1
𝑖
ThisimposesagreatdemandonLLMagentstofullyunderstand
equals1whenthe𝑖-thactionisintheLCS.Thismetricconsiders
andadheretothespecifiedactionformatandspace.Additionally,
boththeactionmatchingandthedistancetowardstasksuccess.
constrainedbyphonescreensizelimit,vitalinformationsuchas
• TaskCompletionRatio(TCR).𝑇𝐶𝑅 = 𝑘/𝐿,where𝑘 isthe
the succinct status description of a checkbox, poses challenges
indexofthelastmatchedactionintheLCS.Thismetricsmeasure
forLLMagentsinunderstandingcrucialbutbriefobserveddetails.
theprogressoftaskcompletion.
Consequently,tocomprehensivelygaugetheagent’sunderstanding
• ReversedRedundancyRatio(RRR).𝑅𝑅𝑅 = 𝐿/𝐿ˆ. Itcanbe
ability,weformulatethreemetrics:
usedtoevaluatetheefficiencyoftheagentcompletingatask.
Weinverseitfortheconvenienceofcomparison,i.e.,thehigher • InvalidFormat.Theratioofoutputtingactionsthatdeviate
thismetric,thegreatertheefficiencyoftheagent. fromtheformatpredefinedinprompt.
• SuccessRate(SR).Unliketheabovethreemetricsrelyingon • InvalidAction.Theratioofoutputtingactionsoutsidetheac-
groundtruthactionsequence,theSRisjudgedbytheGPT-4 tionspacespecifiedinprompt.
solelygiventhetrajectoryincludinghistoricalactionsandob- • NuggetsMining.Theratioofthetargetelementlengthtothe
servations.SRequals1whenGPT-4perceivesthatthetaskhas entireobservation,assessingtheagent’scapacitytounderstand
beensuccessfullycompleted,and0whenthetaskisdeemedun- thetaskcontextandidentifypivotalpiecesofinformation.For
successful.Thismetricisdevisedfortheunsupervisedscenario, example,whentheagentcorrectlyselectstheBobasshownin
enhancingthescalabilityoftheevaluation.In§6.2,weprovide Fig.1,theNuggetsMiningcanbecomputedasthedivisionofthe
statisticalevidencetodemonstratetheaccuracyofSR. lengthofthe[nd725]entrybythetotallengthoftheobservation.Conferenceacronym’XX,June03–05,2018,Woodstock,NY MingzheXing,RongkaiZhang,HuiXue,QiChen,FanYang,andZhenXiao
Table 3: Performances evaluated on single-APP and cross-APP tasks.
Table4:ThePearsonCorrelationCoefficient
Cross-APPtasksposeasignificantchallengeforSOTAagents,andhigh-
ofSRwithinformationrichness(IR),andwith
lightasubstantialdisparitybetweenGPT-4andotheragents.
operationcomplexity(OC),andwiththemulti-
plicationofIRandOC.
Single-APPTasks Cross-APPTasks
Model TR TCR RRR SR TR TCR RRR SR
Metrics GPT-3.5 GPT-4
LLaMA2-13B 0.025 0.038 0.007 0.023 0.027 0.084 0.000 0.000
IR 0.37 0.62
LLaMA2-70B 0.237 0.301 0.047 0.127 0.062 0.089 0.000 0.000
OC 0.61 0.28
GPT-3.5 0.413 0.555 0.262 0.449 0.214 0.390 0.021 0.048
IR×OC 0.68 0.57
GPT-4 0.502 0.689 0.755 0.759 0.421 0.746 0.685 0.571
Reasoning.Thisdimensionindicatestheagent’scapacitytode- requiresfurtherimprovementintheexplorationandreflec-
ducethemostsuitableactionbasedonthecurrentobservation.To tiondimensions.(§6.3).
assessit,twometricsareemployed:
• OperationLogic.Theinversenumberofincorrectactionsat- 6.1 EvaluationSetting
temptedbeforesuccessfullyfindingthecorrectaction.Consider
WeconductexperimentsonSOTAopen-sourceandclosed-source
Eq.1and2asanexample.Theagentcorrectlyexecutesaction
LLMs.Thedetailedexperimentsettingsareintroducedasfollows.
B after two erroneous attempts, i.e.,𝑋 and𝑌. Therefore, the
Agent Models. The selected LLMs encompass GPT-{3.5-turbo,
OperationLogicforthissubsequenceiscalculatedas1/2.
4}[18],LLaMA2-{13B-chat,70B-chat}[25],representingtwopower-
• AwarenessofCompletion.Theratioofcasesthattheagent
fulclosed-sourceandopen-sourceLLMmodelfamilies,respectively.
correctlyfindsthetaskcompletedandissuesafinishaction.
RegardingthepromptsettingsforLLMagents,pleasereferto§F.
Exploration.LLMagentsmakedecisionsfrompretraining-derived
Max Step. We set maximum step limits for agents to evaluate
priorknowledge.Duetothestaticnatureoftheirpriorknowledge,
theircapabilitiesofcompletingtaskswithinreasonabletimeframe.
certainLLMagentsexhibitaproclivitytoiterativelyexecutethe
AccordingtothelengthofactionsequencesasshowninTable2,
sameerroneousaction[40].Itprecludesthemfromexploringal-
weempiricallysetthemaximumsteplimitas15forsingle-APPand
ternativeactionpathwaystoascertainthecorrectexecutionpath.
constrainedtasks,whileforcross-APPtasks,itissetas30.
Thisphenomenonreflectstheagent’sexplorationability,whichwe
quantifybycountingtheinstancesofactionrepetition.
6.2 PoorPerformanceinMobileTasks
• RepeatActions.Theratioofactionsresultinginrepetitiveor
cyclicalpatterns. Inthissection,weintegratethemetricsintroducedin§5.1toassess
thetaskcompletionofLLMagentsacrossvarioustasktypes.Were-
Reflection.SimilartoRLagents,theLLMagentsareprovento
porttheresultsacrosssingle-APP,cross-APP,andconstrainedtasks
have the capability to extract insights from previous trials and
inTable3andTable5.RecallthattheSuccessRate(SR)isassessed
leveragetheinsightsforsubsequentexecutions[22].Weutilizethe
byGPT-4.Tovalidateitsreliability,weperformcross-validation
Reflexionmechanismtogaugetheagent’sproficiencyinextracting
betweenitwithTRandTCR,whereTRandTCRrepresentalter-
pertinentexperiencesandapplyingthemjudiciously.
• Reflexion@K.𝑅𝑒𝑓𝑙𝑒𝑥𝑖𝑜𝑛@𝐾 =(cid:205) 𝑖𝐾 =1(𝑆𝑅 𝑖 −𝑆𝑅 𝑖−1),where𝐾 is n tha eti Pv ee ap re sors np Cec ot ri rv ee ls ato ion nta Cs ok ec ffio cm iep nle tt (i Po Cn C.S )p [e 5c ]i bfi ec ta wll ey e, nw Se Rco am ndpu Tt Re
,
thenumberofReflexioniterations.Itmeasuresthedifferences resultinginacorrelationof0.87,andbetweenSRandTCR,yielding
betweentheoriginaltrailandthetrailafterReflexion. acorrelationof0.91.Thesehighcoefficientsindicateasubstan-
Remark:Thefourdimensionsarenotmutuallyindependent.For tialcorrelationbetweenSRandbothTRandTCR,validatingthe
instance,aprerequisiteforreasoningtheoptimalactionisathor- rationaleofadoptingtheGPT-4judgmentmechanism.
oughunderstandingoftheenvironmentandobservation.Ourobjec- Table3revealsasignificantdeficiencyofSOTAagentsin
tiveistoassessagentabilitiesfromdiverseperspectivesratherthan thereal-worldmobiletasks.WhileGPT-4achievesa75.9%SR
segregatingthemintoindependentcomponents.Itisworthnoting onsingle-APPtasks,allagentsexhibitaninabilitytomakeeffective
thatourproposeddimensionsandmetricscanbegeneralizedto decisionsacrossothertasksettings.Noteworthytheperformance
otherLLMagents,enablingtheevaluationoftheircapabilitiesin gapbetweenGPT-4andGPT-3.5ismuchlargerforcross-APPtasks
differentenvironments.Thedimensionscoresarecomputedasthe than single-APP tasks. It indicates that the cross-APP tasks are
averageoftheircorrespondingmetrics(detailsprovidedin§D). morecomplexanddifficult,andcanwellrevealthesignificant
disparity in planning abilities between the two agents. In
6 EXPERIMENTSANDFINDINGS
contrasttopriorbenchmarkstudies,LLaMA2-70Bdemonstrates
Inthissection,wesetuptheexperiments,andpresenttheexperi- inferiorperformancerelativetoGPT-3.5andGPT-4.
mentalresults.Wesummarizenoteworthyfindingsasfollows.First, WeconductadetailedexaminationoftheAPPswheretheSOTA
existingSOTAagentsstillexhibitsubstantialroomforimprove- agents,includingGPT-3.5andGPT-4,donotperformwell.Our
ment(§6.2).Second,incontrasttotheresultsobservedinprior investigationrevealsavulnerabilityinhandlingAPPscharac-
benchmarks[6,15],LLaMA2-70Bexhibitsinferiorplanning terizedbydeficienttextualinformationandintricateopera-
abilitiesacrossvariousdimensions.GPT-4,whileadvanced, tionallogics.Tofurthersubstantiatethisobservation,wecalculateUnderstandingtheWeaknessofLargeLanguageModelAgentswithinaComplexAndroidEnvironment Conferenceacronym’XX,June03–05,2018,Woodstock,NY
Table5:ConstraintsviolationratiosforConstrainedTasks.
YouTube L LL La aM MA A2 2- -1 73 0B B YouTube L LL La aM MA A2 2- -1 73 0B B
Weather GPT-3.5 Weather GPT-3.5
Model APP-level Page-level Component-level Settings GPT-4 Settings GPT-4
Messages Messages
GPT-3.5 0.207 0.072 0.33 Google Maps Google Maps
Gmail Gmail
GPT-4 0.000 0.050 0.00 Firefox Firefox
Camera Camera
Calendar Calendar
Reasoning 0.0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.000 0.005 0.010 0.015 0.020 0.025
(a)InvalidActionRatio. (b)InvalidFormatRatio.
LLaMA2-13B
LLaMA2-70B
GPT-3.5
GPT-4 YouTube L LL La aM MA A2 2- -1 73 0B B YouTube L LL La aM MA A2 2- -1 73 0B B
Weather GPT-3.5 Weather GPT-3.5
Settings GPT-4 Settings GPT-4
Messages Messages
Exploration Understanding Google Maps Google Maps
Gmail Gmail
Firefox Firefox
Camera Camera
Calendar Calendar
0.0 0.2 0.4 0.6 0.8 1.0 0.0 0.2 0.4 0.6 0.8 1.0
(c)NuggetsMiningScore. (d)OperationLogicScore.
Reflection
YouTube L LL La aM MA A2 2- -1 73 0B B YouTube L LL La aM MA A2 2- -1 73 0B B
Figure4:Agentabilitiesevaluationoncross-APPtasks. W See ta tit nh ge sr G GP PT T- -3 4.5 W See ta tit nh ge sr G GP PT T- -3 4.5
Messages Messages
Google Maps Google Maps
Gmail Gmail
thePCCbetweenSRandtheinformationrichness(IR)andopera- Firefox Firefox
Camera Camera
tioncomplexity(OC)ofAPPs.Specifically,weutilizetheaverage Calendar Calendar
lengthofAPPobservationandtheinverselengthofgroundtruth 0.0 0.2 0.4 0.6 0.8 1.0 0.0 0.1 0.2 0.3 0.4 0.5 0.6 0.7
(e)AwareofCompletionRatio. (f)RepeatActionRatio.
actionstoquantifyIRandOC,respectively.TheresultsinTable4
demonstratethatOCposesamoresubstantialchallengeforGPT-3.5
inachievingahigherSR,whileGPT-4exhibitsagreatersensitivity Figure5:Metricsforunderstanding,reasoningandexplo-
toIR.ThehighvaluesofIR×OCfurtherproveourfindings. rationdimensions.
Beyondbasictaskcompletion,weassesstheagents’capacityto
comprehendconstraintsandadeptlymakedecisionstoavoidvio-
lations.Table5presentstheconstraintviolationratiosofGPT-3.5 prescribedactionrules.Fig.5(c)demonstratesthesuperiorcapacity
andGPT-4.LLaMA2modelsareexcludedastheyfacechallenges ofGPT-3.5andGPT-4toapprehendmorenuancedinformationcom-
incompletingbasictasks,renderingthisassessmentimpractical. paredtoLLaMA2.InFig.5(d),LLaMA2agentsexhibitchallenges
Table5revealsthatevenforstraightforwardconstraints,GPT-3.5 inidentifyingthecorrectsubsequentactionsevenaftermultiple
stillmayviolatethem.Byreadingitsintermediatereasoningpro- attempts.Moreover,LLaMA2-13Blackstheawarenessthatthetask
cesses,wediscernthatGPT-3.5lacksawarenessandunderstanding hasbeensuccessfullycompleted,asdepictedinFig.5(e).Fig.5(f)
ofconstraints.Forinstance,inthecaseof“Findthecurrentweather indicatesahighrepeatactionratioofLLaMA2,underscoringits
forecast” withtheconstraint“donotusetheWeatherAPP”,GPT-3.5 limitedabilitytoexploretheenvironment.GPT-4alsodemon-
directlyopenstheWeatherAPP,whileGPT-4comprehendsthecon- stratesanotableproclivityforrepeatingerroneousactions
straintanddevisesanalternativewayusingawebbrowsertosearch forseveralAPPs.ToimprovetheexplorationabilityofGPT-4,
forweatherforecast.Ithighlightstheconsiderabledistanceyet weintroduceanexplorationstrategyandexamineitsimpacton
tobecoveredbeforeGPT-3.5canbeappliedeffectivelyin performance in §7.2. While GPT-4 shows certain improvement
permission-sensitiveenvironments. throughReflexion,ouranalysissuggeststhatitstemsfromin-
herent opportunities for additional attempts to complete
6.3 FourWeaknessLeadingtoFailure thetaskratherthananenhancementintheagent’spolicy.
Detailedexperimentsandanalysiscanbefoundin§7.1.
Inthissection,weemploythemetricsintroducedin§5.2toquan-
tify the fine-grained planning abilities of these agents, so as to
7 FUTUREDIRECTIONSFORENHANCING
understandtheirweaknessesthatleadtofailure.AsshowninFig.4,
LLMAGENT
GPT-4showssuperiorperformancesacrossvariousdimensions,
furthersubstantiatingitsexcellenceintaskcompletion,asindi- Through experiments in §6.3, we observe that LLaMA2 models
catedinTable3.Incontrast,LLaMA2modelsexhibitsignificant displayweaknessesacrossallfourdimensions.Evenforthelead-
weaknessesacrossallfourdimensions.InFig.5,wepresentthe ingmodel,GPT-4,stillexhibitsshortcomingsinexplorationand
composedmetricsofthesedimensions.Duetospacelimit,weonly reflection.Inthissection,wefirstanalyzetheineffectivenessof
presentpartofthetestingAPPs,andthecompleteAPPmetricscan Reflexionandprovideanempiricalanalysisofthefactorscontribut-
befoundin§E.Fig.5(a)and5(b)presenttheratiosofoutputting ingtothisphenomenon.Second,weproposeanovelprompt-based
invalidformatandout-of-spaceactions.Thenotablyhigherratios explorationmethod,revealingthatexplicitlyencouragingtheagent
ofLLaMA2showitschallengesinunderstandingandadheringto toexploreunknownactionscanenhanceperformance.Conferenceacronym’XX,June03–05,2018,Woodstock,NY MingzheXing,RongkaiZhang,HuiXue,QiChen,FanYang,andZhenXiao
0.90 Reflection 0.60 0.6
0.25 0.85 Re-execute 0.55 0.20 0.80 0.50 0.5
0.75 0.45 GPT-4 0.4 GPT-4 0.15 0.70 0.40 GPT-4+Exploration GPT-4+Exploration
0.10 Reflection 0.65 00 .. 33 05 0.3
0.05 Re-execute 0.60 0.25 0.2
0.20
0 1 Tria2 l Num3 ber 4 5 0 1 Tria2 l Num3 ber 4 5 5 15 Max2 5 Step 35 45 5 15 Max2 5 Step 35 45
(a)SRofGPT-3.5agent. (b)SRofGPT-4agent. (a)Successrate. (b)Repeatactionratio.
Figure6:Performancesevaluatedoncross-APPtasksbyin- Figure7:GPT-4andGPT-4+Explorationcomparisonsbyvary-
creasingthereflectiontimes. ingthemaximumsteplimitontheCameraAPP.
asillustratedinFig.5(f),indicatingitslimitedexplorationcapabili-
7.1 AnalysisofReflection’sFailure
ties.Furthermore,therepetitionofactionsdegradesthequalityof
RecallthatReflexionsummarizesexperienceandthenre-executes precedingtrajectories,renderingtheminsufficientforproviding
failed tasks, it inherently offers opportunities for additional at- informativeguidanceforreflection,asdiscussedin§7.1.
temptsandpossessespotentialforperformanceimprovement.Ac- Inthissection,weintroduceanovelprompt-basedexploration
cordingly,weconductacomparativeevaluationwithre-executing strategyforLLMagents.Divergingfrompriorapproaches[4]that
failedtaskswithouttheReflexionprocess,namelyRe-execute.In treattheLLMasaRLpolicynetworkandemployexplorationstrate-
Fig.6,wepresenttheSRofReflexion@5andRe-execute@5.Con- giesoriginatingfromRL,ourstrategyguidestheexplorationof
trarytoexpectations,weobservethatReflexiondoesnotyield LLMagentbyincorporatingapromptindicatingthecount
positiveoutcomescomparedtoRe-execute.Thisunexpected ofpreviouslyvisitedobservations𝑀(s)andissuedactions
phenomenonmotivatesaninvestigationoftheunderlyingmecha- 𝑁(s,a).Specifically,weembedahintpromptsuchas“Youhave
nismsofReflexionandthechallengesofapplyingitinourscenario. alreadybeeninthecurrentstateMtimes,andtakenactionAforN
Toinitiateourinvestigation,weprovideaformaldefinitionofthe times” ateachdecisionstep.ThisconceptisinspiredbytheUpper
Reflexionprocess,specifiedasfollows: ConfidenceBound(UCB)[2,30].UnlikeUCB,wedonotdesign
①
(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32) (cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32) explicitexplorationstrategies.Instead,weintegratehistoricalinfor-
(cid:122) (cid:125)(cid:124) (cid:123)
𝑃(newtrajectory|reflection)·𝑃(reflection| oldtrajectory), mationintotheprompt,leveragingthepowerfuldecision-making
(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32) (cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32) (cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32) (cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32) capabilitiesoftheLLMtobalanceexplorationandexploitation.
(cid:124) (cid:123)(cid:122) (cid:125) (cid:124) (cid:123)(cid:122) (cid:125)
③ ② WeconductanexperimentontheCameraAPP,whereGPT-4ex-
where𝑃denotestheLLMagents.ThisequationdescribestheReflex- hibitsthehighestrepeatactionratio,toevaluatetheeffectiveness
ionprocess,i.e.,extractingvaluableinsightsfrompasttrajectories oftheexplorationstrategy.Wevarythemaximumsteplimitin
andbenefitingsubsequenttrials.Threekeystepsinthisequation {5,15,25,35,45},andpresentSRandrepeatactionratioinFig.7.
maycontributetothedegradationofReflexionperformanceinour Theresultsshowthat,withasimplecounting-basedprompt,SR
scenario.Thefirstandthemostimportantreasonisthatthe canachieve27%ofimprovement.Furthermore,asthemaximum
oldtrajectory(markedin①)islessinformativecomparedwith steplimitincreases,theexplorationabilityofGPT-4degrades.In
previousscenarios.Unlikebenchmarks[3,37]characterizedbyone- contrast,forGPT-4+Exploration,effectiveexplorationoftheenvi-
stepdecision,andvirtualALFWorldenvironment[23]withsmall ronmentpersists,leadingtocontinuedperformanceimprovement.
andstaticactionspace,ourenvironmentnecessitatesmulti-step
planningwithinavastanddynamicactionspace.Thischallenge 8 CONCLUSION
notonlymakesithardtoexploretheentireactionspace,thuscan-
ThisstudyintroducesAndroidArenaenvironmentandascalable
notprovidesufficientguidancefornexttrial,butalsosparsifies
benchmark.Itsupportstheevaluationofcross-APPandconstrained
therewardfeedback.Therefore,apotentialimprovementcanbe
taskscenarios.Weproposeadaptiveandprecisemetricstoassess
achievedbyimprovingtracequality.Inspecific,employingexplo-
taskcompletion,andfine-grainedabilitiesofagentstounderstand
rationstrategiestobroadentheexploredactionspaceforinforma-
theirweaknesses.Theresultsunderscoresignificantroomforim-
tiveexperience[16]anddevisingintrinsicrewardstomitigatethe
provementamongSOTAagents.Wehighlightfourresearchdirec-
sparserewardissue[39].Secondly,aconstrainedabilitytodistill
tionsforenhancingLLMagents.Additionally,weofferempirical
reflection(i.e.,part②)diminishesthereflectionefficacy.Lastly,re-
insightsintothefailureofreflectionandpresentanovelmethod
gardingpart③,thereflectionmaynotbefullyleveragedbyagent
toenhancetheexplorationcapabilitiesofagents.Inthefuture,we
or,conversely,introducesbias[10]anddegradestheperformance
plantoinvestigatetheweaknessesofmulti-modalmodelagents.
comparedtotheRe-executethatiswithoutreflection.
Giventhatvisionmodelsexcelatspatialunderstandingandreason-
ing,areaswhereLLMsstruggle[34],weintendtoscrutinizetheir
7.2 EnhancingExplorationBoostsPerformance
fine-grainedabilitiesandidentifypromisingresearchdirectionsin
Uponreadingthetrajectories,weobservethatevenforGPT-4,it thisdomain.OurAndroidArenasupportsmulti-modalevaluation,
stillpresentsapronouncedtendencytorepeaterroneousactions, andthebenchmarkcanbeeasilyextendedtothissetting.
etaR
sseccuS
noitcA
taepeRUnderstandingtheWeaknessofLargeLanguageModelAgentswithinaComplexAndroidEnvironment Conferenceacronym’XX,June03–05,2018,Woodstock,NY
REFERENCES
preprintarXiv:2307.09288(2023).
[1] MichaelAhn,AnthonyBrohan,NoahBrown,YevgenChebotar,OmarCortes, [26] DanielToyama,PhilippeHamel,AnitaGergely,GheorgheComanici,Amelia
ByronDavid,ChelseaFinn,ChuyuanFu,KeerthanaGopalakrishnan,KarolHaus- Glaese,ZafaraliAhmed,TylerJackson,ShiblMourad,andDoinaPrecup.2021.
man,etal.2022. Doasican,notasisay:Groundinglanguageinrobotic AndroidEnv:AReinforcementLearningPlatformforAndroid.abs/2105.13231
affordances.arXivpreprintarXiv:2204.01691(2022). (2021).arXiv:2105.13231[cs.LG] http://arxiv.org/abs/2105.13231
[2] PeterAuer,NicoloCesa-Bianchi,andPaulFischer.2002.Finite-timeanalysisof [27] BoshiWang,XiangYue,andHuanSun.2023.CanChatGPTDefenditsBeliefin
themultiarmedbanditproblem.Machinelearning47(2002),235–256. Truth?EvaluatingLLMReasoningviaDebate.InFindingsoftheAssociationfor
[3] Jacob Austin, Augustus Odena, Maxwell Nye, Maarten Bosma, Henryk ComputationalLinguistics:EMNLP2023.11865–11881.
Michalewski,DavidDohan,EllenJiang,CarrieCai,MichaelTerry,QuocLe, [28] GuanzhiWang,YuqiXie,YunfanJiang,AjayMandlekar,ChaoweiXiao,YukeZhu,
etal.2021. Programsynthesiswithlargelanguagemodels. arXivpreprint LinxiFan,andAnimaAnandkumar.2023.Voyager:Anopen-endedembodied
arXiv:2108.07732(2021). agentwithlargelanguagemodels.arXivpreprintarXiv:2305.16291(2023).
[4] ThomasCarta,ClémentRomac,ThomasWolf,SylvainLamprier,OlivierSigaud, [29] LeiWang,ChenMa,XueyangFeng,ZeyuZhang,HaoYang,JingsenZhang,
andPierre-YvesOudeyer.2023.Groundinglargelanguagemodelsininteractive ZhiyuanChen,JiakaiTang,XuChen,YankaiLin,etal.2023.Asurveyonlarge
environmentswithonlinereinforcementlearning.arXivpreprintarXiv:2302.02662 languagemodelbasedautonomousagents.arXivpreprintarXiv:2308.11432(2023).
(2023). [30] YingpengWen,QinliangSu,MinghuaShen,andNongXiao.2022.Improving
[5] IsraelCohen,YitengHuang,JingdongChen,JacobBenesty,JacobBenesty,Jing- theexplorationefficiencyofDQNsviatheconfidenceboundmethods.Applied
dongChen,YitengHuang,andIsraelCohen.2009.Pearsoncorrelationcoefficient. Intelligence(2022),1–15.
Noisereductioninspeechprocessing(2009),1–4. [31] YueWu,XuanTang,TomMMitchell,andYuanzhiLi.2023. SmartPlay:A
[6] NicholasCrispino,KyleMontgomery,FankunZeng,DawnSong,andChenguang BenchmarkforLLMsasIntelligentAgents. arXivpreprintarXiv:2310.01557
Wang.2023.AgentInstructsLargeLanguageModelstobeGeneralZero-Shot (2023).
Reasoners.arXivpreprintarXiv:2310.03710(2023). [32] ZhihengXi,WenxiangChen,XinGuo,WeiHe,YiwenDing,BoyangHong,Ming
[7] XiangDeng,YuGu,BoyuanZheng,ShijieChen,SamuelStevens,BoshiWang, Zhang,JunzheWang,SenjieJin,EnyuZhou,etal.2023.Theriseandpotential
HuanSun,andYuSu.2023.Mind2Web:TowardsaGeneralistAgentfortheWeb. oflargelanguagemodelbasedagents:Asurvey.arXivpreprintarXiv:2309.07864
arXivpreprintarXiv:2306.06070(2023). (2023).
[8] SGunasekaranandVBargavi.2015. Surveyonautomationtestingtoolsfor [33] Can Xu, Qingfeng Sun, Kai Zheng, Xiubo Geng, Pu Zhao, Jiazhan Feng,
mobileapplications.InternationalJournalofAdvancedEngineeringResearchand ChongyangTao,andDaxinJiang.2023.Wizardlm:Empoweringlargelanguage
Science2,11(2015),2349–6495. modelstofollowcomplexinstructions.arXivpreprintarXiv:2304.12244(2023).
[9] AssafHallak,DotanDiCastro,andShieMannor.2015. Contextualmarkov [34] YutaroYamada,YihanBao,AndrewKLampinen,JungoKasai,andIlkerYildirim.
decisionprocesses.arXivpreprintarXiv:1502.02259(2015). 2023.EvaluatingSpatialUnderstandingofLargeLanguageModels.arXivpreprint
[10] JieHuang,XinyunChen,SwaroopMishra,HuaixiuStevenZheng,AdamsWeiYu, arXiv:2310.14540(2023).
XinyingSong,andDennyZhou.2023.Largelanguagemodelscannotself-correct [35] AnYan,ZhengyuanYang,WanrongZhu,KevinLin,LinjieLi,JianfengWang,
reasoningyet.arXivpreprintarXiv:2310.01798(2023). JianweiYang,YiwuZhong,JulianMcAuley,JianfengGao,etal.2023.Gpt-4vin
[11] WenlongHuang,PieterAbbeel,DeepakPathak,andIgorMordatch.2022.Lan- wonderland:Largemultimodalmodelsforzero-shotsmartphoneguinavigation.
guagemodelsaszero-shotplanners:Extractingactionableknowledgeforembod- arXivpreprintarXiv:2311.07562(2023).
iedagents.InInternationalConferenceonMachineLearning.PMLR,9118–9147. [36] ZhaoYang,JiaxuanLiu,YuchengHan,XinChen,ZebiaoHuang,BinFu,and
[12] MinaeKwon,SangMichaelXie,KaleshaBullard,andDorsaSadigh.2023.Reward GangYu.2023.Appagent:Multimodalagentsassmartphoneusers.arXivpreprint
designwithlanguagemodels.arXivpreprintarXiv:2303.00001(2023). arXiv:2312.13771(2023).
[13] JinyangLi,BinyuanHui,GeQu,BinhuaLi,JiaxiYang,BowenLi,BailinWang, [37] ZhilinYang,PengQi,SaizhengZhang,YoshuaBengio,WilliamWCohen,Ruslan
BowenQin,RongyuCao,RuiyingGeng,etal.2023.Canllmalreadyserveasa Salakhutdinov,andChristopherDManning.2018.HotpotQA:Adatasetfordi-
databaseinterface?abigbenchforlarge-scaledatabasegroundedtext-to-sqls. verse,explainablemulti-hopquestionanswering.arXivpreprintarXiv:1809.09600
arXivpreprintarXiv:2305.03111(2023). (2018).
[14] YuanchunLi,HaoWen,WeijunWang,XiangyuLi,YizhenYuan,GuohongLiu, [38] ShunyuYao,JeffreyZhao,DianYu,NanDu,IzhakShafran,KarthikNarasimhan,
JiachengLiu,WenxingXu,XiangWang,YiSun,etal.2024.PersonalLLMAgents: andYuanCao.2022.React:Synergizingreasoningandactinginlanguagemodels.
InsightsandSurveyabouttheCapability,EfficiencyandSecurity.arXivpreprint arXivpreprintarXiv:2210.03629(2022).
arXiv:2401.05459(2024). [39] HaoqiYuan,ChiZhang,HongchengWang,FeiyangXie,PenglinCai,HaoDong,
[15] XiaoLiu,HaoYu,HanchenZhang,YifanXu,XuanyuLei,HanyuLai,YuGu, andZongqingLu.2023.Plan4mc:Skillreinforcementlearningandplanningfor
HangliangDing,KaiwenMen,KejuanYang,etal.2023.Agentbench:Evaluating open-worldminecrafttasks.arXivpreprintarXiv:2303.16563(2023).
llmsasagents.arXivpreprintarXiv:2308.03688(2023). [40] ShuyanZhou,FrankFXu,HaoZhu,XuhuiZhou,RobertLo,AbishekSridhar,
[16] KaixinMa,HongmingZhang,HongweiWang,XiaomanPan,andDongYu.2023. XianyiCheng,YonatanBisk,DanielFried,UriAlon,etal.2023. Webarena:
LASER:LLMAgentwithState-SpaceExplorationforWebNavigation. arXiv Arealisticwebenvironmentforbuildingautonomousagents. arXivpreprint
preprintarXiv:2309.08172(2023). arXiv:2307.13854(2023).
[17] Volodymyr Mnih, Koray Kavukcuoglu, David Silver, Alex Graves, Ioannis
Antonoglou,DaanWierstra,andMartinRiedmiller.2013.Playingatariwithdeep
reinforcementlearning.arXivpreprintarXiv:1312.5602(2013).
[18] ROpenAI.2023.GPT-4technicalreport.arXiv(2023),2303–08774.
[19] ChenQian,XinCong,ChengYang,WeizeChen,YushengSu,JuyuanXu,Zhiyuan
Liu,andMaosongSun.2023.Communicativeagentsforsoftwaredevelopment.
arXivpreprintarXiv:2307.07924(2023).
[20] ChristopherRawles,AliceLi,DanielRodriguez,OrianaRiva,andTimothyLilli-
crap.2023.Androidinthewild:Alarge-scaledatasetforandroiddevicecontrol.
arXivpreprintarXiv:2307.10088(2023).
[21] JingqingRuan,YihongChen,BinZhang,ZhiweiXu,TianpengBao,Guoqing
Du,ShiweiShi,HangyuMao,XingyuZeng,andRuiZhao.2023. Tptu:Task
planningandtoolusageoflargelanguagemodel-basedaiagents.arXivpreprint
arXiv:2308.03427(2023).
[22] NoahShinn,FedericoCassano,AshwinGopinath,KarthikRNarasimhan,and
ShunyuYao.2023.Reflexion:Languageagentswithverbalreinforcementlearning.
InThirty-seventhConferenceonNeuralInformationProcessingSystems.
[23] Mohit Shridhar, Xingdi Yuan, Marc-Alexandre Côté, Yonatan Bisk, Adam
Trischler,andMatthewHausknecht.2020. Alfworld:Aligningtextandem-
bodiedenvironmentsforinteractivelearning.arXivpreprintarXiv:2010.03768
(2020).
[24] RichardSSutton,AndrewGBarto,etal.1999.Reinforcementlearning.Journal
ofCognitiveNeuroscience11,1(1999),126–134.
[25] HugoTouvron,LouisMartin,KevinStone,PeterAlbert,AmjadAlmahairi,Yas-
mineBabaei,NikolayBashlykov,SoumyaBatra,PrajjwalBhargava,ShrutiBhos-
ale,etal.2023. Llama2:Openfoundationandfine-tunedchatmodels. arXivConferenceacronym’XX,June03–05,2018,Woodstock,NY MingzheXing,RongkaiZhang,HuiXue,QiChen,FanYang,andZhenXiao
APPENDIX Table7:Thecompleteactionspace,includingactiontypeand
thecorrespondingparameters.
A DETAILEDOBSERVATIONCOMPRESSION
METHOD
Actionlevel ActionType ActionParameters
ThetextualobservationisderivedfromtheXMLrepresentation InstallAPP Downloadlink
encapsulatingcomprehensivescreeninformationasshowninFig.8. LaunchAPP Packagename
APPlevel
However,directlyinputtingtheentireXMLintotheLLM,proves StopAPP Packagename
tobeexcessivelylengthyasillustratedinTable6.Tomitigatethis, StopallAPP
weemployatwo-phaseheuristicapproachforcompressingthe Click XPath
Doubleclick XPath
XMLtoamanageablelengthforLLMprocessing.TheXMLen-
Longclick XPath
triesarecategorizedintotwogroups:oneforlayout,whichdoes
Componentlevel Settext XPath,Text
not support actionable operations, and the other for UI compo-
Swipeup/down/left/right Number
nents.WeeliminatetheXMLentriesrelatedtolayout,retaining
Pressback
onlythoseassociatedwithUIcomponents.Inthesecondphase,
Presshome
wemergenon-functionalandnon-visiblenodesupwards,incor-
Screenon/off
poratingtheirdescriptiveinformationintotheparentnodes.This
Volumeup/down/mute
strategyenhancestheLLM’sabilitytounderstandthesemanticof Systemlevel Setorientation Horizontal/vertical
thehierarchicalXMLtree,andresultinamoreefficientcompres- Screenshot
sion.Forcomponentswithnuancedstatedescriptions,weamplify TaskLevel Finishtask
theirtextualinformation.Forinstance,whentheswitchcompo-
nentisintheoffposition,weappendadescriptionstating“itis
currentlyunchecked,andyoucanswitchiton.".Toenabletheagent InpreviousworklikeAndroidEnv,theactionisdonebysuc-
toaccuratelyselecttheUIcomponentforoperation,auniqueIDis cessive touches and lifts, each consists a position (𝑥,𝑦) and an
assignedtoeachcomponentinthecompressedobservation.Inthe 𝐴𝑐𝑡𝑖𝑜𝑛𝑇𝑦𝑝𝑒 ∈{𝑇𝑂𝑈𝐶𝐻,𝐿𝐼𝐹𝑇,𝑅𝐸𝑃𝐸𝐴𝑇}.AndroidEnvdividesthe
compressedobservation,componentsarestructurallyorganized, screenintoagridandrestrictstheActionTypetoTOUCH,orgroups
maintainingtheirancestral-descendantrelationshipsintheoriginal actionsequenceslike[TOUCH,LIFT,TOUCH,LIFT]intoasingle
XMLtree,aidingtheLLMagentincomprehendingtheinterface’s gesture,suchasswiping,scrolling,ordrag-and-drop.However,con-
layoutthroughtextandtherebyenhancingitscommandefficacy. tinuoustouchesandliftsbringadditionalinferenceoverheadfor
agents,andcannotaccuratelysimulatethecontinuityandsmooth-
nessofswiping.Insteadofinteractingwiththephonebysuccessive
Table6:WerandomlyselectseveralAPPsandcomparetheto-
touchesandlifts,wedirectlyoperatetheUIcomponentsofAPPs
kennumbersbeforeandaftercompression.Ourcompression
throughUIAutomator.ItisatestingframeworkforAndroid,send-
ratioreachahighof86.6%,whilepreservingthesemantic
ingaseriesofeventsincludingpressing,dragging,andscrolling.
information.Thisapproachenhancestheutilizationofthe
Theseeventsareconsistentwithrealfingerslides.Operatingcom-
LLMagentcontext,allowingfortheaccommodationofmore
ponentsbysendingactioneventsisnotonlymoreaccurateand
historicalobservationsineachdecision-makingprocess.
naturalinsimulatingrealuseroperations,butalsosuperiorinterms
ofAPPcompatibility.Wecangettheexecutableactionsthateach
AppName #Token(Original) #Token(Compressed)
componentcanperformfromthecorrespondingXMLandmain-
Gmail(emaillist) 11,707 1,155
taintheminthecompressedobservation,suchasclickable,double
Gmail(composeemail) 7,273 413
Calendar 8,604 584 clickable,longclickable,etc.Atthesametime,wealsorecordthe
Googlemap 15,725 637 typeofeachcomponentinthecompressedobservation,suchas
YouTube 12,005 939 button,text-editor,whichcanassisttheagenttogiveappropriate
PlayStore 10,450 620 actioninstructions.AswehavesetauniqueIDforeachcomponent
Googledrive 11,060 651
inthecompressedobservation,theagentcanoperateacompo-
ClockAlarm 9,633 505
nentbyspecifyingitsIDandthecorrespondingactiontype.Since
Clock 7,980 285
UIAutomatorlocatesandoperatesoncomponentsbasedontheir
XPath,ourimplementationemploysamappingtabletoconvert
componentIDsintocomponentXPaths,afterwhichweperform
B DETAILEDACTIONSPACE theoperations.
Wesupportfour-level’sactionspace,i.e.,APPlevel,component
C BENCHMARKSTATISTICS
level,systemlevelandtasklevel.Applevelactionsareresponsible
forinstalling,launchingandstoppingAPPs.Mostactionsarecom- Ourbenchmarkcomprisesthreetypesoftasks:single-APP,cross-
ponentlevelwhichareresponsibleforoperatingUIcomponents, APP,andconstrainedtasks.Thesingle-APPtasksarederivedfrom
suchasclicking,typing,andswiping.Wealsosupportsystemlevel 13APPsincludingCalendar,Camera,Clock,Contacts,YouTube,
actionsincludingturningthescreenonandoff,adjustingthevol- Weather,Settings,Photos,Messages,GoogleMaps,GoogleDrive,
ume,settingorientation,andtakingscreenshots.Task-levelaction GmailandFirefox.Statisticalinformationregardingthebenchmark
isdesignedfortheagenttodecideifataskshouldfinish. isillustratedinFig.9.UnderstandingtheWeaknessofLargeLanguageModelAgentswithinaComplexAndroidEnvironment Conferenceacronym’XX,June03–05,2018,Woodstock,NY
Search contacts
[n0236] EditText open_search_bar ;click ;Search contacts :
[n54c6] ImageButton ;click ;Open navigation drawer :
A Alice
[nb90c] ImageView ;click ;More options :
[nc3e7] selected_account_disc ;click ;Signed :
B Bob
[n1c26] ListView list ;long-click ; 4 contacts :
[nea52] ViewGroup ;click ;Alice :
JJ John [nd725] ViewGroup ;click ;Bob :
[nca5w] ViewGroup ;click ;John :
Z Zara [ndsf3] ViewGroup ;click ;Zara :
[n22ea] ImageButton floating_action_button ;click ;Create contact :
+ [nf05c] contacts ;focusable selected ;Contacts :
[n4eed] nav_manage ;click ;Fix & manage :
Contacts Fix & manage
(a)Screenshot. (b)XMLderivedbyUIAutomator. (c)Compressedobservation.
Figure8:Anexampleofthescreenshot,originalXMLandcompressedobservationofContactsAPPpage.
Calendar
Camera Constrained YouTube YouTube L LL La aM MA A2 2- -1 73 0B B
Clock
6.5%3.3%
16.3%
W See ta tit nh ge sr W See ta tit nh ge sr G GP PT T- -3 4.5
6.5% MesP sh ao gt eos s MesP sh ao gt eos s
C Fo irn et fa oc xts 25 .3.1 %% 10.2% cross-APP GG oo oo gg ll ee
F
G iDM remra fiv oap e xis l L L G GL L P Pa a T TM M - -3 4A A .52 2- -1 73 0B B GG oo oo gg ll ee
F
G iDM remra fiv oap e xis l
Contacts Contacts
Clock Clock
Gmail 8.4% 4.7% Camera Camera
YouTube Calendar Calendar
5.6% 6.5% 0.0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.000 0.005 0.010 0.015 0.020 0.025
Google Drive Weather (a)InvalidActionRatio. (b)InvalidFormatRatio.
6.5% 8.8%
6.5%2.8%
Google Map Ms essages PhotosSettings YouTube YouTube L LL La aM MA A2 2- -1 73 0B B
Weather Weather GPT-3.5
Settings Settings GPT-4
Photos Photos
Figure9:ProportionofinstructionsfordifferentApps Messages Messages
Google Maps LLaMA2-13B Google Maps
Google Drive L GL Pa TM -3A .52-70B Google Drive
Gmail GPT-4 Gmail
Firefox Firefox
D PLANNINGABILITYSCORES Contacts Contacts
Clock Clock
Camera Camera
Inthissection,wepresentadetailedexplanationofthecalculation Calendar Calendar
methodforthefourfine-grainedplanningabilityscoresintroduced 0.0 0.2 0.4 0.6 0.8 1.0 0.0 0.2 0.4 0.6 0.8 1.0
(c)NuggetsMiningScore. (d)OperationLogicScore.
in §5.2. The value ranges of these metrics are [0, 1], with the
exceptionofNuggetsMining,OperationLogic,andReflexion@K.
FollowingAgentBench[15],wenormalizethelatterthreemetricsto WYo eu aT tu hb ee r L L GL L Pa a TM M -3A A .52 2- -1 73 0B B WYo eu aT tu hb ee r L L GL L Pa a TM M -3A A .52 2- -1 73 0B B
[0, 1]acrossallmodels.Itisimportanttonotethatsmallermetrics Se Pt ht oin tg os
s
GPT-4 Se Pt ht oin tg os
s
GPT-4
Messages Messages
inunderstandingandexplorationindicatebetterperformancein Google Maps Google Maps
Google Drive Google Drive
thesedimensions,whilelargervaluesforthemetricsinreasoning Gmail Gmail
Firefox Firefox
andreflectiondenotesuperiorperformanceinthoseaspects.The Contacts Contacts
Clock Clock
calculationsforthefourdimensionsarespecifiedasfollow: Camera Camera
Calendar Calendar
𝑈𝑛𝑑𝑒𝑟𝑠𝑡𝑎𝑛𝑑𝑖𝑛𝑔=(1−𝐼𝑛𝑣𝑎𝑙𝑖𝑑𝐹𝑜𝑟𝑚𝑎𝑡𝑅𝑎𝑡𝑖𝑜)+ 0.0 0.2 0.4 0.6 0.8 1.0 0.0 0.1 0.2 0.3 0.4 0.5 0.6 0.7
(e)AwareofCompletionRatio. (f)RepeatActionRatio.
(1−𝐼𝑛𝑣𝑎𝑙𝑖𝑑𝐴𝑐𝑡𝑖𝑜𝑛𝑅𝑎𝑡𝑖𝑜)+(1−𝑁𝑢𝑔𝑔𝑒𝑡𝑠𝑀𝑖𝑛𝑖𝑛𝑔)
𝑅𝑒𝑎𝑠𝑜𝑛𝑖𝑛𝑔=𝑂𝑝𝑒𝑟𝑎𝑡𝑖𝑜𝑛𝐿𝑜𝑔𝑖𝑐+𝐴𝑤𝑎𝑟𝑒𝑛𝑒𝑠𝑠𝑜𝑓 𝐶𝑜𝑚𝑝𝑙𝑒𝑡𝑖𝑜𝑛
Figure10:Metricsforunderstanding,reasoningandexplo-
𝐸𝑥𝑝𝑙𝑜𝑟𝑎𝑡𝑖𝑜𝑛=1−𝑅𝑒𝑝𝑒𝑎𝑡𝐴𝑐𝑡𝑖𝑜𝑛𝑅𝑎𝑡𝑖𝑜
rationdimensionsonalltestingAPPs.
𝑅𝑒𝑓𝑙𝑒𝑐𝑡𝑖𝑜𝑛=𝑅𝑒𝑓𝑙𝑒𝑥𝑖𝑜𝑛@𝐾
Subsequently,westandardizethefourdimensionscoresandpresent
theminFig.4.
F PROMPTDESIGN
E COMPLETERESULTSFORTESTINGAPPS
FollowingWebArena,ourpromptforeachdecision-makingstep
Duetospacelimit,wepresentpartofthetestingAPPsin§6.2.In incorporatesenvironmentdescriptions,two-shotexamples,task
Fig.10,weshowthemetricsforalltestingAPPs. instructions,andhistoricalobservationsandactions,asillustratedConferenceacronym’XX,June03–05,2018,Woodstock,NY MingzheXing,RongkaiZhang,HuiXue,QiChen,FanYang,andZhenXiao
You are an autonomous intelligent agent tasked with operating a youjustperformedandtheresultedphoneobservation.It
mobile phone.
You are able to assist with a wide range of tasks, ...... maybehelpfultotrackyourprogress.
Here's the information you'll have: Environment Solve the user’s task with interleaving Observation,
...... Description Thought,Actionsteps.
To be successful, it is very important to follow the following rules: Thoughtcanreasonaboutthecurrentsituation.
...... Attheendofthinkingprocess,youMUSTresponsethe
nextActioninthefollowingformats:
1.APPlevelActions:
input:
User's objective: open the email from Kaggle in Gmail. #start[app-name]#:ThisactionstartanAPPspecifiedby
Previous observations and actions ......
Agent output: ...... appname.YoucanONLYissuethestartoperationonthe
Input Two-shot
input: Example followingAPPs:
User's objective: open the email from Kaggle in Gmail. {app-string}
Previous observations and actions ......,
output: ...... 2.ComponentlevelActions:
#click[id]#:Thisactionclicksonanelementwithaspecific
idontheAPPpage.
REMEMBER to think step by step, and generate the next action in the
correct format. #long-click[id]#:Thisactionlongclicksonanelement
......
withaspecificidontheAPPpage.
Action
Now, begin! Prompt #set-text [id] [text]# This action set text in a text view
User's objective: ......
elementwithaspecificidontheAPPpage.
Previous observations and actions ......
NotethattheUIelementswith’clickable’or’long-clickable’
propertiescanbeissuedwith#click#,whiletheelements
with’EditText’canbeissuedwith#set-text#action.
Thinking:
The user wants to find the best walking route to "Microsoft SVC 3.SystemlevelActions:
Agent Building". The current view is the Google Maps home page. The
Output search box is available with the id [na928]. I should input the #swipe-up#:Scrollupthescreen.
destination "Microsoft SVC Building" into the search box. So, the next
action is #set_text [na928] [Microsoft SVC Building]#. #swipe-down#:Scrolldownthescreen.
#swipe-left#:Swipeleftthescreen.
#swipe-right#:Swiperightthescreen.
Figure11:Promptstructure.
#press-back#:Navigatetothepreviouslyviewedpage.
#press-enter#:Pressenter.
4.CompletionAction:
inFig.11.WeadopttheReflexionpromptfromitsofficialimple- #finish[answer]#:Issuethisactionwhenyoubelievethe
mentationwithmodificationstailoredtoourspecificscenario.The taskiscomplete.Iftheobjectiveistofindatext-based
prompt context limit is 4K for LLaMA2-13B, LLaMA2-70B, and answer,providetheanswerinthebracket.Ifyoubelieve
GPT-3.5,andat8KforGPT-4.Giventhathistoricalobservations thetaskisimpossibletocomplete,providetheansweras
andactionsmayexceedthecontextlimit,andtoensureafaircom- "N/A"inthebracket.
parison,weapplythetruncationstrategyemployedinWebArena ——
acrossallagentstomaintainapromptwithinthe4Kcontextlimit. Observationisthesimplifiedandstructuredtextrepresen-
tationofAPPview.
F.1 EnvironmentDescriptionPrompt Tobesuccessful,itisveryimportanttofollowthefollow-
ingrules:
EnvironmentDescriptionPrompt
1.YouMUSTonlyissueONEnextactionineachthinking
process.
Youareanautonomousintelligentagenttaskedwithop-
2.Generatetheactioninthecorrectformat.Alwaysput
eratingamobilephone.Youareabletoassistwithawide
theactioninsideapairof#.Forexample,#click[node3]#.
rangeoftasks,fromansweringsimplequestionstoplan-
3.Issuefinishactionwhenyouthinkyouhaveachieved
ningandexecutingacomplicatedinstructionwithspecific
theobjective.
actionsyoucanissue.
4.Todayis{date},whichmightbeusefulforyoutocom-
Here’stheinformationyou’llhave:
pletethetask.
Theuser’sobjective:Thisisthetaskyou’retryingtocom-
plete.
TheinstalledAPPs:ThesearetheAPPsyoucanoperate
on.
Thecurrentphone’sobservation:Thisisasimplifiedand
structuredrepresentationofthephoneview,providingkey
information.
Thepreviousactionandobservation:TherearetheactionUnderstandingtheWeaknessofLargeLanguageModelAgentswithinaComplexAndroidEnvironment Conferenceacronym’XX,June03–05,2018,Woodstock,NY
F.2 ReflectionPrompt
tasks
ReflectionPrompt Integration between {app_name1} and {app_name2} for
productivity
Youareanadvancedreasoningagentthatcanimprove Collaborative task management with {app_name1} and
basedonselfreflection.Youwillbegivenapreviousrea- {app_name2}
soningtrialinwhichyouweregivenaccesstooperatean {app_name1}and{app_name2}integrationforworkand
Androidphoneenvironmentwithhuman-likeactionsin- productivity
cludingclickandtypetextonthephonescreen,andatask Productivitytipswith{app_name1}and{app_name2}
instructiontocomplete.Youwereunsuccessfulincomplet-
ingthetaskeitherbecauseyoumadethewrongaction
F.5 Functionality-to-InstructionPrompt
decisions,oryouusedupyoursetnumberofreasoning
steps.Inafewsentences,Diagnoseapossiblereasonfor
Functionality-to-InstructionPrompt
failureanddeviseanew,concise,highlevelplanthataims
tomitigatethesamefailure.Usecompletesentences.
Youareasmarttaskcreatorforasmartphoneintelligent
assistant.Giventhefeaturesdescriptionofthe{app}APP,
yourgoalistogenerateclearandpracticaltasksthatthe
F.3 RewardPrompt
assistantcanassistpeoplewithwhiletheyuse{app}on
RewardPrompt theirphoneintheirdailylives.Thesetasksshouldencom-
passawiderangeofpossibleinstructionsandquestions
Youcanaccesstotheactionsandphonestatesatsomesteps thatmayarisewhenusing{app}APP.
duringexecutingaspecifictaskonaphone.Checkifthe Forexample,fortheGmailAPP,potentialtaskinstructions
givenphonestatesandactionsindicatetheachievementof couldinclude:
agoal.Thephonestateisrepresentedasstructuredtexts, Composeanemailwiththesubject<emailsubject>and
witheachentrydenotingaUIcomponentalongwithits themessagecontent<emailcontent>tobesentto<email
contentandfunctiondescription. address>usingGmail.,
Thegoalis{goal}, Sendthefirstdraftemail.,
theactionsandstatesatsomestepsare:{traj} Openthelatestemailfrom<emailaddress>inGmail.,
Pleasecheckiftheabovetrajectoryindicatetheachieve- OpenGmailsettings.,
mentofthegoal:goal.Onlyoutput’Yes’or’No’,noother TurnoffnotificationsforGmail.,
words. Starthelatestemailfrom<emailaddress>inGmail.,
Deletethelatestemailfrom<emailaddress>inGmail.,
etc.,wheretheplaceholderssurroundedwithanglebrack-
F.4 QueryTemplate
ets’<’and’>’shouldbeautomatedgeneratedandnotbe
Queriesforsingle-APPfunctionalitiesextraction filledwithspecificcontent.
The{app}APP’sfeaturedescriptionis:{feature}
Queriesforsingle-APP Yourtaskistogenerateasmanyofthesetasksaspossible
forthe{app}app.Ensurethattheseinstructionsareclear
howtouse{app_name} andwillnotleadtoanymisunderstandingsothattheassi-
{app_name}usageinstructions tantcansuccessfullyexecutethem.Yourresponseshould
{app_name}quickstartguides bealistofcommaseparatedtaskinstructions,whereeach
{app_name}cheatsheets instructionshouldbepresentedinonesentence.
{app_name}productivityguides
use{app_name}step-by-step
tipsandtricksfor{app_name}
{app_name}forbeginners
{app_name}tutorial
gettingstartedwith{app_name}
introductionto{app_name}
Queriesforcross-APPfunctionalitiesextraction
Queriesforcross-APP
{app_name1}and{app_name2}collaborationfeatures
Howtouse{app_name1}and{app_name2}togetherfor
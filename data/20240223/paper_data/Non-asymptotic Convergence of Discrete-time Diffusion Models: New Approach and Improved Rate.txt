Non-asymptotic Convergence of Discrete-time Diffusion
Models: New Approach and Improved Rate
YuchenLiang∗ PeizhongJu† YingbinLiang‡ NessShroff§
Abstract
Thedenoisingdiffusionmodelemergesrecentlyasapowerfulgenerativetechniquethatconvertsnoiseintodata.
Theoreticalconvergenceguaranteehasbeenmainlystudiedforcontinuous-timediffusionmodels,andhasbeenobtained
fordiscrete-timediffusionmodelsonlyfordistributionswithboundedsupportintheliterature.Inthispaper,weestablish
theconvergenceguaranteeforsubstantiallylargerclassesofdistributionsunderdiscrete-timediffusionmodelsandfurther
improvetheconvergenceratefordistributionswithboundedsupport.Inparticular,wefirstestablishtheconvergence
ratesforbothsmoothandgeneral(possiblynon-smooth)distributionshavingfinitesecondmoment.Wethenspecialize
ourresultstoanumberofinterestingclassesofdistributionswithexplicitparameterdependencies,includingdistributions
withLipschitzscores,Gaussianmixturedistributions,anddistributionswithboundedsupport.Wefurtherproposeanovel
acceleratedsamplerandshowthatitimprovestheconvergenceratesofthecorrespondingregularsamplerbyorders
ofmagnitudewithrespecttoallsystemparameters. Fordistributionswithboundedsupport,ourresultimprovesthe
dimensionaldependenceofthepreviousconvergenceratebyordersofmagnitude.Ourstudyfeaturesanovelanalysis
techniquethatconstructstiltingfactorrepresentationoftheconvergenceerrorandexploitsTweedie’sformulaforhandling
Taylorexpansionpowerterms.
Indexterms—generativemodels,denoisingdiffusionprobabilisticmodel(DDPM),convergenceanalysis
1 Introduction
Generativemodelingisafundamentaltaskinmachinelearning,aimingtogeneratesamplesoutofadistribution
similar to that of training data. Classical generative models include variational autoencoders (VAE) [1],
generativeadversarialnetworks(GANs)[2],andnormalizingflows[3],etc. Recently,diffusionmodels[4,5]
have arisen as an extremely appealing generative model and have received wide popularity due to their
state-of-the-artperformanceforavarietyoftasks,includingtext/image/videogenerationandothergenerative
tasks. See[6–8]forsurveysofdiffusionmodelsindifferentapplications.
The empirical success of diffusion models has also motivated theoretical studies, aiming to characterize
the convergence of diffusion model processes. Most theoretical interests have focused on continuous-
timediffusionmodels,i.e.,stochasticdifferentialequation(SDE)basedformulations[9],giventheirclose
relationshiptoLangevinMonte-CarlosamplersandmanySDEtoolsavailableforuse(seeSection1.2). In
particular,giventime-averagedL2 scoreestimationerror[10],polynomial-timeconvergenceguaranteeshave
beenestablishedforwidefamiliesoftargetdistributions[11–17].
However,fromtheapplicationside,manygenerativesamplers,includingthosestate-of-the-artones,employ
discrete-time denoising diffusion probabilistic models (DDPMs) [5]. See [7, Table 1] and [8, Figure 5]
for a list of algorithms used in the literature. In contrast to continuous-time diffusion models which are
extensivelystudied,discrete-timediffusionmodelsarelargelyunexploredtheoretically. Existingtechniques
forcontinuous-timemodelsarenotdirectlytransferabletotheirdiscrete-timecounterparts. Theonlyworkthat
∗DepartmentofElectricalandComputerEngineering,TheOhioStateUniversity.liang.1439@osu.edu
†DepartmentofElectricalandComputerEngineering,TheOhioStateUniversity.ju.171@osu.edu
‡DepartmentofElectricalandComputerEngineering,TheOhioStateUniversity.liang.889@osu.edu
§DepartmentofElectricalandComputerEngineering,TheOhioStateUniversity.shroff.11@osu.edu
1
4202
beF
12
]GL.sc[
1v10931.2042:viXraanalyzesthediscrete-timediffusionmodelsis[18],whichprovidedanon-asymptoticconvergenceguarantee
fordenoisingdiffusionprobabilisticmodels(DDPMs),butonlyfordistributionwithboundedsupportset.
Despitethepracticalimportanceofdiscrete-timediffusionmodels,severalfundamentalquestionsremainopen:
(1)(Unboundedsupport)Theconvergenceguaranteehasnotbeenestablishedfordiscrete-timediffusion
modelsforchallengingdistributionswithunboundedsupport,suchasthecommonmixtureGaussiandistribu-
tion. Inparticular,thedistributionwithLipschitzscorefunction(whichcanhaveunboundedsupport)hasbeen
showntoenjoypolynomialtimeconvergenceforcontinuous-timediffusionmodels,butitsconvergencehas
notyetbeenshownfordiscrete-timemodels. Itappearsthatthetypical-setbasedanalysistoolsin[18]doesnot
handlethecasewithunboundedsupport. (2)(Highdimensionaldependence)Therehasbeensignificanteffort
onthecontinuous-timeanalysistoreducethedependenceoftheconvergencerateonthevariabledimensiond,
butthediscrete-timeanalysisstillsuffersfromthelargedependenceond(seeSection1.2). Thisclearlycalls
foramorerefinedanalysisfordiscrete-timeanalysis. (3)(Estimationerror)Acceleratedsamplerhasbeen
developedin[18],whichdoesnothandleestimationerror. Thisseemstobeduetotheirchoiceofestimator
foracceleration,andcallsforanewestimationalgorithmwhoseerrorcanbeeasilyanalyzed.
Inordertocomprehensivelydealwiththeaforementionedopenchallenges,newanalysistoolsarerequired,
whichisthegoalofthispaper.
1.1 OurContributions
Our main contribution lies in the development of novel analytical techniques to analyze the discrete-time
DDPMmodelandprovidenon-asymptoticconvergenceguaranteeswithabetterrateandforasubstantially
largerclassofdistributionsoverthestate-of-the-art(seeTable1forasummaryofourresults). Inparticular,
ourcontributionsarethree-fold.
RegularSampler: Weprovidethefirstnon-asymptoticconvergenceboundonthedistancebetweengenerated
andtargetdistributionsfordiscrete-timeDDPMforgeneraldistributionshavingfinitesecondmoments. Our
boundfurtherspecializestoexplicitdependenceonthesystemparametersforvariousclassesofdistributions,
suchasthosehavingLipschitzscores(withtheparameterL),Gaussianmixtures(withN components),and
those having bounded support, for which the generated distribution converges to the target distribution at
(cid:16) (cid:17) (cid:16) (cid:17) (cid:16) (cid:17)
the rate of O dL2 , O d2min{d,N}2 , and O d2 , respectively. In particular, for the case where the
ε2 ε2 δ2ε2
distributionhasboundedsupport,weimprovethenumberofconvergencestepsonthedimensiondin[18]by
afactorofO(d2).
Accelerated Sampler: We propose a new accelerated DDPM sampler by introducing an estimator of the
Hessianoflog-likelihoodateachstep,whichhandlestheestimationerrorandimprovesthedependenceofthe
convergencerateonbothϵandd. Weshowthatourestimatorachievesaprovablyfasterconvergencerate
(cid:16) (cid:17) (cid:16) (cid:17)
ofO(cid:0)dM(cid:1) ,O d1.5min{d,N}1.5 andO d1.5 respectivelyforthosehavingLipschitzscoresandHessians
ε ε δ1.5ε
(withparameterM),Gaussianmixtures,andthosedistributionshavingboundedsupport. Inparticular,the
acceleratedsamplerimprovesthedependenceoftheconvergencerateonεoftheregularsamplerbyafactor
ofO(1/ε)aswellasenjoyingbetterdependenciesondandδ. Fordistributionswithboundedsupport,our
acceleratedDDPMsamplerimprovesthenumberofconvergencestepsin[18]byafactorofO(d1.5).
Novel Analysis Technique: We develop a novel technique for analyzing discrete-time diffusion models.
Specifically,ourtechniquefeaturestwonewelements: (i)characterizationoftheerrorincurredateachdiscrete
stepofthereverseprocessusingtiltingfactor;and(ii)analysisofthemeanvalueoftiltingfactorviaTweedie’s
formula to handle power terms in the Taylor expansion. Such a technique enables us to (a) analyze more
generaldistributionsincludingthosewithunboundedsupport;(b)tightlyidentifythedominanttermandobtain
2TargetdistributionQ Numofsteps Results
0
(cid:16) (cid:17)
∇logq L-Lipschitz∀t O dL2 Theorem2(thispaper)
t ε2
(cid:16) (cid:17)
d2min{d,N}2
Q Gaussianmixture(N components) O Theorem3(thispaper)
0 ε2
(cid:16) (cid:17)
Q boundedsupport O d4 [18,Theorem3]
0 ε2
(cid:16) (cid:17)
O d2 Theorem4(thispaper)
δ2ε2
(cid:16) (cid:17)
d1.5min{d,N}1.5
Q Gaussianmixture(accl.) O Theorem7(thispaper)
0 ε
(cid:16) (cid:17)
Q boundedsupport(accl.,noest. err) O d3 [18,Theorem4]
0 ε
(cid:16) (cid:17)
Q boundedsupport(accl.) O d1.5 Theorem8(thispaper)
0 δ1.5ε
Table1: Summaryofconvergenceresultsfordiscrete-timeDDPMsamplersintermsofthenumberofstepsneededtoachieve
ϵ-accuracy,wheredisthedimension.(i)Thefirstthreerowsandthelastthreerowsrespectivelycorrespondtotheresultsforregular
andacceleratedsamplers.(ii)ForQ withboundedsupport,ourpaperconsidersQ (δ)thatsatisfiesW (Q ,Q)2 ≲δd,whereδ
0 1 2 0
capturestheclosenessbetweenQ andQ ,whereas[18]doesnotexplicitlycapturesuchaparameterintheirresult.Nevertheless,
0 1
ourresultsimprovethecorrespondingresultsin[18]intermsofdependenceond.
theconvergenceratewithlowerdimensionaldependence;and(c)handletheestimationerrorinourproposed
acceleratedsamplerwhenbothscoreandHessianestimationerrorsexist.
1.2 RelatedWorks
TheoryonContinuous-timeDDPMSamplers: Manyworkshaveexploredtheperformanceguaranteesof
generativemodelsfromacontinuous-timeperspectivebasedonaSDE-typeanalysis. Specifically,anumber
ofstudiesperformanalysesundertheL∞ scoreestimationerror[11,19]. Later,underL2 scoreestimation
error,[20]developedpolynomial1 boundsfordistributionsthathaveLipschitzscoresandsatisfylog-Sobolev
inequality. Soon after, [12,13] concurrently developed polynomial bounds for those smooth distributions
havingLipschitzscores(O(dL2/ε2))andthosenon-smoothdistributionshavingboundedsupportusingearly
stopping(O(d3/δ4ε2)). Later,[14]improvedthenumberofstepstobeO(d2log(1/δ)2/ε2)forthosetarget
distributions with finite second moment. This result was recently further improved to linear dimensional
dependence[15]. In[17],itisshownthatlineardimensionaldependencecanalsobeachievedforthosetarget
distributionshavingfiniterelativeFisherinformationagainstaGaussiandistribution. Otherthantheworks
above,[16]analyzedadifferentsamplingscheme(e.g.,predictor-corrector),and[21–23]analyzedsampling
errorsusingadifferenterrormeasure(theWasserstein-2distance).
TheoryonContinuous-timeDeterministicSamplers: Beyondstochasticsamplers,anotherlineofstudies
providedtheoreticalguaranteesfortheprobabilityflowordinarydifferentialequation(PF-ODE),whichisa
deterministicsamplercorrespondingtotheSDE[24,25].[26]comparedtheperformanceofSDEandPF-ODE
and investigated conditions where one might outperform the other. Besides PF-ODE, [27,28] provided
guaranteesfortheclosely-relatedflow-matchingmodel,whichlearnsadeterministiccouplingbetweenany
twodistributions.[29]proposedanovelODEforsamplingfromaconditionaldistribution.[30,31]provided
convergenceguaranteesforthemorerecentconsistencymodels[32].
TheoryonDiscrete-timeDDPMSamplers: Despiteflourishingresultsonthecontinuous-timeDDPMmodel
(i.e.,SDE),[18]istheonlyworkthataddressesthetheoreticalperformanceofdiscrete-timemodels. Intheir
work, polynomial-time guarantees are shown for both stochastic and deterministic discrete-time samplers
under the L2 estimation error for target distributions having bounded support. Accelerated stochastic and
1By“polynomial”wemeanthatthenumberofstepshaspolynomialdependenceonthescoreestimationerror,alongwithother
parameters.
3deterministic variants are also analyzed when there is no score estimation error. Our work substantially
broadensthetargetdistributionstoincludethosewithunboundedsupportandimprovestheresultsin[18]for
distributionswithboundedsupportwithacompletelydifferentanalyticaltechnique.
TheoryonScoreEstimation: Inordertoachieveanend-to-endanalysis,severalworksdevelopedsample
complexityboundstoachievetheL2 scoreestimationerrorofDDPMforavarietyofdistributions,including
thosehavingboundedsupport[33],Gaussianmixture[34],high-dimensionalgraphicalmodels[35]andthose
supportedonalow-dimensionallinearsubspace[36]. Morerecently,[37]consideredthegeneralizabilityof
thecontinuous-timediffusionmodels.
2 Preliminaries of the DDPM Algorithm
Inthispaper,weareinterestedinanalyzingthetheoreticalperformanceofthediscrete-timeDDPMsampler[5].
DDPMistrainedonaforward(Markov)process,andthesamplesaregeneratedthroughareverse(Markov)
process.
2.1 DDPMandtheForwardProcess
Letx ∈ Rdbetheinitialdata,andletx ∈ Rd,∀1 ≤ t ≤ T bethelatentvariablesintheDDPMalgorithm. Let
0 t
Q betheinitialdatadistribution,andletQ bethemarginallatentdistributionattimetintheforwardprocess,
0 t
for all 1 ≤ t ≤ T. Denote Q := Q as the overall joint distribution. In the DDPM algorithm, white
0,...,T √ √
Gaussiannoiseisgraduallyaddedtothedataintheforwardprocess: x = 1−β x + β w , ∀1 ≤ t ≤ T,
t t t−1 t t
i.i.d.
wherew ∼ N(0,I ). Equivalently,thiscanbeexpressedasaconditionaldistributionateachtimet:
t d
(cid:112)
Q (x |x ) = N(x ; 1−β x ,β I ), (1)
t|t−1 t t−1 t t t−1 t d
whichmeansthatunderQ,X → X → ··· → X . Hereβ ∈ (0,1)capturesthe“amount”ofnoisethatis
0 1 T t
injectedattimet,andβ ’sarecalledthenoiseschedule. Define
t
t
(cid:89)
α := 1−β , α¯ := α , 1 ≤ t ≤ T.
t t t i
i=1
Animmediateresultbyaccumulatingthestepsisthat
√
Q (x |x ) = N(x ; α¯ x ,(1−α¯ )I ), (2)
t|0 t 0 t t 0 t d
√ √
or,writtenequivalently,x = α¯ x + 1−α¯ w¯ , ∀1 ≤ t ≤ T,wherew¯ ∼ N(0,I )denotestheaggregated
t t 0 t t t d
noiseattimet. Intuitively,forlargeT,sinceQ ≈ N(0,I )(whichisindependentofx ),itisexpected
T|0 d 0
that Q ≈ N(0,I ) when T becomes large, as long as the variance under Q is finite. Finally, since the
T d 0
conditionalnoisesareGaussian,eachQ (t ≥ 1)isabsolutelycontinuousw.r.ttheLebesguemeasure. Letthe
t
correspondingp.d.f. ofeachQ beq (t ≥ 1). Similarlydefineq ,q ,andq fort ≥ 1. IncaseQ
t t t,t−1 t|t−1 t−1|t 0
isalsoabsolutelycontinuousw.r.t. theLebesguemeasure,letq bethecorrespondingp.d.f. ofQ .
0 0
2.2 TheReverseProcess
The goal of DDPM is to generate samples approximately from the data distribution Q . We first draw the
0
latent variable at time T from a Gaussian distribution: x ∼ N(0,I ) =: P . Then, to achieve effective
T d T
sampling,eachforwardstepisapproximatedbyareversesamplingstep. Define
1 1−α
µ (x ) := √ (x +(1−α )∇logq (x )), σ2 := t . (3)
t t α t t t t t α
t t
Ateachtimet = T,T −1,...,1,definethetruereverseprocessas
(cid:114)
1 1−α
t
x = √ (x +(1−α )∇logq (x ))+ z = µ (x )+σ z
t−1 t t t t t t t
α α
t t
4wherez ∼ N(0,I ). Equivalently,thiscanbewrittenasP = N(x ;µ (x ),σ2I ). Here∇logq (x)is
d t−1|t t−1 t t t d t
calledthescoreofq . LetP bethemarginaldistributionsofx inthetruereverseprocess,andletp bethe
t t t t
correspondingp.d.f. ofP w.r.t. theLebesguemeasure.
t
Inpractice,onedoesnothaveaccessto∇logq . Instead,itsestimate,denotedass ,isused,whichresultsin
t t
anestimated reverseprocess:
(cid:114)
1 1−α
t
x = √ (x +(1−α )s (x ))+ z = µ (x )+σ z
t−1 t t t t (cid:98)t t t
α α
t t
inwhichwedefine
µ (x ) := x +(1−α )s (x ). (4)
(cid:98)t t t t t t
LetP(cid:98)t bethemarginaldistributionsofx
t
intheestimatedreverseprocesswithcorrespondingp.d.f. p (cid:98)t. Note
that P(cid:98)t−1|t = N(x t−1;µ (cid:98)t(x t),σ t2I d) and P(cid:98)T = P T. Define P, P(cid:98), p
t−1|t
and p
t|t−1
in a way similar to the
forwardprocess. Hence,underP andP(cid:98),X
T
→ X
T−1
→ ··· → X 0.
IncasewhereQ isabsolutelycontinuousw.r.t. theLebesguemeasure,weareinterestedinmeasuringthe
0
mismatchbetweenQ
0
andP(cid:98)0 throughthetotal-variationdistance,definedas
(cid:12) (cid:12)
TV(Q 0,P(cid:98)0) := sup (cid:12) (cid:12)Q 0(A)−P(cid:98)0(A)(cid:12) (cid:12).
A⊆R
d
Thismetriciscommonlyusedinpriortheoreticalstudies[14,18]. Inparticular,fromPinsker’sinequality,the
total-variation(TV)distanceisupperboundedasTV(Q 0,P(cid:98)0)2 ≤ 1 2KL(Q 0||P(cid:98)0),wheretheKLdivergenceis
definedas
(cid:90) (cid:20) (cid:21)
dQ q (X)
KL(Q ||P ) := log 0 dQ = E log 0 ≥ 0.
0 0 0 X∼Q
dP 0 p (X)
0 0
Thus,itissufficienttocontroltheKLdivergencewhenq exists.
0
Whenq doesnotexist(say,whenQ haspointmasses),onecanusetheWassersteindistancetomeasurethe
0 0
mismatchatt = 0. TheWasserstein-2distanceisdefinedas
(cid:26) (cid:90) (cid:27)1/2
W (Q ,P ) := min ∥x−y∥2dΓ(x,y) , (5)
2 0 0
Γ∈Π(Q 0,P 0) Rd×Rd
whereΠ(Q ,P )isthesetofalljointprobabilitymeasuresonRd×Rd withmarginaldistributionsQ and
0 0 0
P ,respectively.
0
2.3 OtherNotations
Foranytwofunctionsf(d,δ,T)andg(d,δ,T),wewritef(d,δ,T) ≲ g(d,δ,T)(resp. f(d,δ,T) ≳ g(d,δ,T))
forsomeuniversalconstant(notdependingonδ,dorT)L < ∞(resp. L > 0)iflimsup |f(d,δ,T)/
T→∞
g(d,δ,T)| ≤ L (resp. liminf |f(d,δ,T)/g(d,δ,T)| ≥ L). We write f(d,δ,T) ≍ g(d,δ,T) when
T→∞
both f(d,δ,T) ≲ g(d,δ,T) and f(d,δ,T) ≳ g(d,δ,T) hold. Note that the dependence on δ and d is
retained with ≲,≳,≍. We write f(d,δ,T) = O(g(T)) (resp. f(d,δ,T) = Ω(g(T))) if f(d,δ,T) ≲
L(d,δ)g(T) (resp. f(d,δ,T) ≳ L(d,δ)g(T)) holds for some L(d,δ) (possibly depending on δ and d).
We write f(d,δ,T) = o(g(T)) if limsup |f(d,δ,T) /g(T)| = 0. We write f(d,δ,T) = O˜(g(T)) if
T→∞
f(d,δ,T) = O(g(T)(logg(T))k)forsomeconstantk. Notethatthebig-O notationomitsthedependence
on δ and d. In the asymptotic when ε−1 → ∞, we write f(d,ε−1) = O(g(d,ε−1)) if f(d,δ,ε−1) ≲
g(d,δ,ε−1)(logg(ε−1))k forsomeconstantk. Unlessotherwisespecified,wewritexi(1 ≤ i ≤ d)asthei-th
elementofavectorx ∈ Rd and[A]ij asthe(i,j)-thelementofamatrixA. Forafunctionf(x) : Rd → R,
(cid:12)
we write ∂ f(z) as a shorthand for ∂ f(x)(cid:12) , and similarly for higher moments. For matrices A,B,
i ∂xi (cid:12)
x=z
Tr(A) is the trace of A, and A ⪯ B means that B −A is positive semi-definite. For a positive integer n,
[n] := {1,...,n}.
53 General Q : Convergence Bound of Discrete-time DDPMs
0
Inthissection,weprovidetheconvergenceguaranteesfordiscrete-timeDDPMsamplersforgeneralQ . We
0
willfirstestablishourmainresultforsmoothQ ,andthenextenditformoregeneral(possiblynonsmooth)
0
Q . Wewillalsoprovideasketchofourproofofthemaintheoremtodescribeourkeyanalysistechniques.
0
3.1 TechnicalAssumptions
ThefollowingAssumptions1to3arecommonlyadoptedintheliterature[12,14].
Assumption1(FiniteSecondMoment). ThereexistsaconstantM < ∞(thatdoesnotdependondandT)
2
suchthatE [X X⊺ ] ⪯ M I .
X 0∼Q 0 0 0 2 d
Assumption2(ScoreEstimationError). Thes estimatessatisfy
t
T
1 (cid:88)
E ∥s (X )−∇logq (X )∥2 ≤ ε2, whereε2 = O˜(T−1).
X ∼Q t t t t
T t t
t=1
Assumption3(AbsoluteContinuity). Q isabsolutelycontinuousw.r.t. theLebesguemeasure,andthusq
0 0
exists. Also,supposethatq isanalytic.
0
Thefollowingregularityassumption(Assumption4)isneededforouranalysisbasedonTaylorexpansion.
Itisrathersoft,andwewillshowthatitissatisfiedforGaussianmixtureQ andforanyQ withbounded
0 0
support(seeSection4).
Assumption4(RegularDerivatives). Foranyk ≥ 1,thereexistsafunctionU (x)suchthat
k
(cid:12) (cid:12)
max (cid:12)∂klogq (x)(cid:12) ≤ U (x), ∀t ≥ 0.
(cid:12) a t (cid:12) k
a∈[d]k
Whenq doesnotexist,thisisrequiredonlyfor∀t ≥ 1. HereU (x)satisfies:
0 k
1. Foranyfixedx,U (x)doesnotdependonT. Also,forsomeconstantC < ∞thatdoesnotdependon
k k
T,E [U (X )p] < Cp, ∀p ≥ 1.
X t∼Q t k t k
2. Intermsofk,U (x)/k!convergesabsolutelyforanyfinitexandT: (cid:80)∞ 1U (x) < ∞.
k k=1 k! k
3.2 ConvergenceBounds
Topresentthemainresult,wefirstdefineasetofnoisescheduleasfollows.
Definition1(NoiseSchedule). ForallsufficientlylargeT,thestepsizeα ’ssatisfy
t
T
1−α ≲ logT , ∀1 ≤ t ≤ T, and α¯ = (cid:89) α = o(cid:0) T−1(cid:1) .
t T t
T
t=1
InDefinition1,theupperboundon1−α requiresthatα islargeenoughtocontrolthereverse-steperror,
t t
whiletheupperboundonα¯ requiresthatα issmallenoughtocontroltheinitializationerror. Oneexampleof
T t
(cid:16) (cid:17)T (cid:16) (cid:16) (cid:17)(cid:17)
suchα is1−α ≡ clogT, ∀t ≥ 1foranyc > 1. Then,α¯ = 1− clogT = exp T log 1− clogT =
t t T T T T
(cid:16) (cid:17)
O eT−clogT = O(T−c).
T
Wefirstpresentthefollowingmaintheoremoftheconvergencerateforthediscrete-timeDDPM.
6Theorem1(SmoothQ ). UnderAssumptions1to4,ifthenoiseschedulesatisfiesDefinition1,thedistribution
0
P(cid:98)0 generatedbythediscrete-timeDDPMsatisfies
T (cid:18)
(cid:88) (cid:104) (cid:16) (cid:17)(cid:105)
KL(Q 0||P(cid:98)0) ≲ (1−α t)2 E
X ∼Q
Tr ∇2logq t−1(µ t(X t))∇2logq t(X t)
t t
t=1
(cid:19)
(cid:104) (cid:105)
+E Tr(cid:0) ∇2logq (µ (X ))(cid:1)2 +(logT)ε2.
X ∼Q t−1 t t
t t
Theorem 1 characterizes the convergence in terms of KL divergence (and thus TV distance) for smooth
(possiblyunbounded)Q . TheboundinTheorem1willbefurtherinstantiatedwithexplicitdependenceon
0
systemparametersforexampledistributionsQ inSection4. TofurtherexplaintheupperboundinTheorem1,
0
the last term arises from the score estimation error, and the first two terms capture the errors accumulated
duringthereversestepsovert = T,...,1. Inparticular,weshowthatthereverseerrorcanbecapturedby
thetiltingfactor(seeSection3.3),andhencethefirstterminTheorem1isthedominanttermofthemean
valuegapofthetiltingfactorbetweenP andQ . Thesecondtermisthedominantterminthesquared
t−1|t t−1|t
meanvalueofthetiltingfactorunderP . Moredetailedexplanationcanbefoundintheproofsketchin
t−1|t
Section3.3.
We note that Theorem 1 is the first convergence result for discrete-time DDPMs for general distribution
smoothQ thathasfinitesecondmoment(alongwithsomemildregularityconditions). The(only)previous
0
analysisondiscrete-timeDDPMmodelsisgivenby[18],whichrequiresthedatadistributiontohavefinite
support. There,atypicalsetismanuallycraftedandthevaluesofthelog-likelihoodsinandoutofthisset
areboundedseparately. Thisanalysis,however,doesnotapplytohandletargetdistributionshavinginfinite
support. HerewedevelopadifferentapproachbasedontitlingfactorrepresentationandTweedie’sformulato
handlepowerterms,whichisapplicabletoamuchwiderclassoftargetdistributions,includingthosehaving
infinitesupport. WeprovideanoverviewofouranalysisinSection3.3. WewillalsoshowinSection3.3that
whenwespecializeourresulttodistributionswithboundedsupportweimprovetheratedependenceonthe
dimensiondin[18].
Thefollowingcorollaryshowsatighterbound(wherethesecondterminTheorem1cangoaway)underan
additionalconditionin(6). ItisnotrestrictiveaswewillshowinSection4.
Corollary1(SmoothQ ). UnderthesamesettingofTheorem1,iffurtherthat,foranyfixedx ,
0 t
√
∥∇logq (µ (x ))− α ∇logq (x )∥2 = O(1−α ), ∀t ≥ 1 (6)
t−1 t t t t t t
holds,thenthedistributionP(cid:98)0 generatedbythediscrete-timeDDPMsatisfies
T
(cid:88) (cid:104) (cid:16) (cid:17)(cid:105)
KL(Q 0||P(cid:98)0) ≲ (1−α t)2E
X ∼Q
Tr ∇2logq t−1(µ t(X t))∇2logq t(X t) +(logT)ε2.
t t
t=1
WenextfurtherextendTheorem1forsmoothQ togeneralQ thatcanbepossiblynon-smoothandhence
0 0
thedensityfunctionq doesnotexist. Suchdistributionsoccurofteninpractice;forexample,whenQ hasa
0 0
discretesupportsuchasforimages,orwhenQ issupportedonalow-dimensionalmanifold. Fornon-smooth
0
Q ,itsone-stepperturbationQ doeshaveap.d.f. q ,whichisfurtheranalytic(Lemma6). Thisenablesusto
0 1 1
applyTheorem1onQ toobtainthefollowingconvergencebound. Also,weusetheWassersteindistance
1
to measure the perturbation between Q and Q , which is widely used in the analysis of continuous-time
0 1
diffusionmodels[12–14].
7Corollary2(General(possiblynon-smooth)Q 0). UnderAssumptions1,2and4,thedistributionP(cid:98)1generated
bythediscrete-timeDDPMsatisfies
T (cid:18)
(cid:88) (cid:104) (cid:16) (cid:17)(cid:105)
KL(Q 1||P(cid:98)1) ≲ (1−α t)2 E
X ∼Q
Tr ∇2logq t−1(µ t(X t))∇2logq t(X t)
t t
t=2
(cid:19)
(cid:104) (cid:105)
+E Tr(cid:0) ∇2logq (µ (X ))(cid:1)2 +(logT)ε2.
X ∼Q t−1 t t
t t
whereQ issuchthatW (Q ,Q )2 ≲ (1−α )d.
1 2 0 1 1
Inparticular,Corollary2appliestoanygeneraltargetdistributionwhenthesecondmomentisfinite(under
regularityconditions).
3.3 ProofSketchofTheorem1
Inthissubsection,weprovideaproofsketchofTheorem1todescribetheideaofouranalysisapproach. The
fullproofisprovidedinAppendixA.Tobeginwedecomposethetotalerroras
KL(Q 0||P(cid:98)0) ≤ E
X ∼Q
(cid:20)
log
q T(X T)(cid:21) +(cid:88)T
E
X ,X ∼Q
(cid:20)
log
p t−1|t(X t−1|X t)(cid:21)
T T p (X ) t t−1 t,t−1 p (X |X )
T T (cid:98)t−1|t t−1 t
t=1
(cid:124) (cid:123)(cid:122) (cid:125)
(cid:124) (cid:123)(cid:122) (cid:125)
initializationerror
estimationerror
+(cid:88)T
E
(cid:20)
log
q t−1|t(X t−1|X t)(cid:21)
.
X ,X ∼Q
t t−1 t,t−1 p (X |X )
t−1|t t−1 t
t=1
(cid:124) (cid:123)(cid:122) (cid:125)
reverse-steperror
Theinitializationerrorcanbeboundedeasily(Lemma3). Belowwefocusontheresttwotermsinfoursteps.
OurnoveldevelopmentliesinSteps2-4,whichupper-boundthereverse-steperror.
Step1: Boundingestimationerror(Lemma4). Ateachtimet = 1,...,T,ratherthanupper-boundingvia
typicalsetsasin[18],wedirectlyevaluatetheexpectedvalueoflog(p (x |x )/p (x |x )). This
t−1|t t−1 t (cid:98)t−1|t t−1 t
isstraightforwardsinceP
t−1|t
andP(cid:98)t−1|t areGaussianwithdifferentmeansyetthesamecovariance.
Step2: Tiltingfactorexpressionoflog-likelihoodratio(Lemmas5and6andEquation(21)). WithBayes’
rule,weshowthatq isanexponentiallytiltedformofp withtiltingfactor:
t−1|t t−1|t
∞
√ ⊺ (cid:88)
ζ = (∇logq (µ )− α ∇logq (x )) (x −µ )+ T (logq ,x ,µ )
t,t−1 t−1 t t t t t−1 t p t−1 t−1 t
p=2
where T (f,x,µ) is the p-th order Taylor power term of function f around x = µ. This tilting factor thus
p
allowsustoexpresslog(q /p )asfollows. Foreachfixedx ,
t−1|t t−1|t t
(cid:20) q (X |x )(cid:21)
E
X ∼Q
log t−1|t t−1 t = E
X ∼Q
[ζ t,t−1]−logE
X ∼P
[eζ t,t−1]
t−1 t−1|t p (X |x ) t−1 t−1|t t−1 t−1|t
t−1|t t−1 t
≤ E [ζ ]−log(cid:0) 1+E [ζ ](cid:1) .
X ∼Q t,t−1 X ∼P t,t−1
t−1 t−1|t t−1 t−1|t
Suppose that E [ζ ] is small. Then, via the approximation log(1+z) = z − z2 +O(z3) for
X t−1∼P t−1|t t,t−1 2
z ≈ 0,weobtain
(cid:20) q (X |x )(cid:21)
E log t−1|t t−1 t ≤ E [ζ ]−E [ζ ]
X ∼Q X ∼Q t,t−1 X ∼P t,t−1
t−1 t−1|t p (X |x ) t−1 t−1|t t−1 t−1|t
t−1|t t−1 t
+
1 (cid:0)E
[ζ
](cid:1)2 +O(cid:16) (cid:0)E
[ζ
](cid:1)3(cid:17)
.
X ∼P t,t−1 X ∼P t,t−1
2 t−1 t−1|t t−1 t−1|t
8Steps3-4developexplicitexpressionsfortheexpectedvalueofζ underP andQ .
t,t−1 t−1|t t−1|t
Step 3: Explicit expression for E [ζ ] (Lemma 7). Given the expression of ζ , under
X ∼P t,t−1 t,t−1
t−1 t−1|t
regularityconditions(i.e.,Assumption4),thisstepcanbereducedtocalculatingtheexpectedvaluesofthe
powerterms,whicharetheGaussiancentralizedmoments. NotethatE [ζ ]isindeedsmallfor
X ∼P t,t−1
t−1 t−1|t
largeT duetovanishingvariance(see(3)).
Step 4: Explicit expression for E [ζ ] (Lemmas 8 to 10). While the Gaussian centralized
X ∼Q t,t−1
t−1 t−1|t
momentsareeasytocalculate,Q isnotGaussianingeneral. AsanextensiontotheoriginalTweedie’s
t−1|t
formula[38],wecalculatethefirstfourcentralizedmoments(asfunctionsofx andlogq )andprovidethe
t t
asymptoticorderofallhighermomentsforfixedx ’s. Theseenableustodeterminethedominatingtermof
t
E [ζ ]−E [ζ ].
X ∼Q t,t−1 X ∼P t,t−1
t−1 t−1|t t−1 t−1|t
Finally,substitutingthecalculatedexpectedvaluesintotheupperboundandnotingthatthepartialderivatives
donotaffecttherate(byAssumption4)weobtainthedesirableresult.
4 Example Q ’s: Convergence Rate with Explicit Parameter Dependence
0
Inthissection,wespecializeTheorem1andCorollary2toseveralinterestingdistributionclasses,forwhich
convergenceboundswithexplicitdependenceonsystemparameterscanbederived. Thekeyistolocatethe
dependenceinthedominatingtermsinthereverse-steperror.
4.1 Q withLipschitzScores
t
Wefirstinvestigatethedistributionclasswhereall∇logq (t ≥ 0)isnorm-Lipschitz. Suchaclasshasbeen
t
wellstudiedforcontinuous-timediffusionmodels[14],andthefollowingtheoremestablishesthefirstsuch
resultforthediscrete-timediffusionmodels.
Theorem2(LipschitzScores). Supposethat∇logq (x), ∀t ≥ 0isnormL-Lipschitz,i.e.,∃L > 0suchthat
t
∥∇logq (x)−∇logq (y)∥ ≤ L∥x−y∥, ∀x,y ∈ Rd, ∀t ≥ 0. (7)
t t
Then,underthesamesettingofTheorem1,thedistributionP(cid:98)0 generatedbythediscrete-timeDDPMsatisfies
dL2log2T
KL(Q 0||P(cid:98)0) ≲ +(logT)ε2.
T
Ourresultfordiscrete-timeDDPMsexhibitsthesamedependenceond,L,andT asthoseforcontinuous-
timemodels[14,Theorem1]. However,thediscrete-timeDDPMprocessismathematicallydifferentfrom
theircontinuous-timeprocess,andhenceitreliesoncompletelydifferenttechniquesforupper-boundingthe
reverse-steperror,asweoutlineinSection3.3.
4.2 GaussianMixtureQ
0
NextweinvestigatethecasewhereQ isGaussianmixture. Thisisarichclassofdistributionswithstrong
0
approximation power [39,40]. The following theorem establishes the first convergence result for such a
distributionclassfordiscrete-timesamplers.
Theorem3(Q GaussianMixture). SupposethatQ isGaussianmixture,whosep.d.f. isgivenbyq (x ) =
0 0 0 0
(cid:80)N
π q (x ), where q is the p.d.f. of N(µ ,Σ ) and π ∈ [0,1] is the mixing coefficient where
n=1 n 0,n 0 0,n 0,n 0,n n
(cid:80)N
π = 1. Then,underAssumption2,wehave
n=1 n
d2min{d,N}2log2T
KL(Q 0||P(cid:98)0) ≲ +(logT)ε2.
T
9Iffurther,Σ ≡ σ2I ,∀n = 1,...,N,thentheboundbecomesindependentofN asfollows:
0,n 0 d
d2log2T
KL(Q 0||P(cid:98)0) ≲ +(logT)ε2.
T
Theorem3isthefirstDDPMresultdirectlyregardingGaussianmixtureQ ,whichdoesnothaveanexisting
0
uniformLipschitzconstantonitsscore. In[34],itisshownthatthesamplecomplexityandthenumberof
gradientdescentstepstominimizetheDDPMobjectivewhenQ isGaussianmixturearebothpolynomial
0
ind,N,andε−1. Ourresultbelowshedsnewlightfortheend-to-endanalysisofGaussianmixturelearning
throughthediscrete-timediffusionprocess.
TheproofofTheorem3isnon-trivialintwoways: (i)InordertoshowthatAssumption4holdsforGaussian
mixturedistributions,itisgenerallydifficulttoevaluateandprovideanupperboundforallordersofpartial
derivatives of the logarithm of a mixture density. To this end, we employ the multivariate Faá di Bruno’s
formula[41]todevelopanexplicitbound(Lemma15andCorollary4). (ii)Inordertoeliminatethesecond
terminTheorem1,ourmethoddoesnon-trivialverificationofcondition(6)forGaussianmixturebasedon
explicitformsderivedfromGaussianmixture. Notethatingeneral, evenwithsmallperturbationbetween
Q andQ ,thereisnoguaranteethattheirrespectivescorefunctionsarealsoclosealmosteverywhere.
t−1 t
4.3 Q withBoundedSupport
0
Next,wespecializeCorollary2tothecasewithQ havingboundedsupport(andpossiblynon-smooth). Such
0
acasehasbeenconsideredin[18]. Tomakeourresultcomparabletothatin[18],wewillemploythenoise
scheduleproposedin[18]:
(cid:40) (cid:41)
clogT
(cid:18) clogT(cid:19)t
1−α = δ, 1−α = min δ 1+ ,1 , ∀2 ≤ t ≤ T (8)
1 t
T T
foranyconstantsc > 2andδ ∈ (e−c,1). Notethatanynoiseschedulesatisfyingtheaboveconditionalso
satisfiesthatinDefinition1,andhenceourCorollary2stillholdshere. WethenspecializeCorollary2tothe
followingresultforQ withboundedsupport.
0
Theorem4(Q withBoundedSupport). Supposethat∥X ∥2 ≤ R2dalmostsurelyunderQ ,whereRisa
0 0 0
constantthatdoesnotdependond. UnderAssumption2,withthenoiseschedulein(8),thedistributionP(cid:98)1
generatedbythediscrete-timeDDPMsatisfies
d2log2T
KL(Q 1||P(cid:98)1) ≲
δ2T
+(logT)ε2,
whereQ issuchthatW (Q ,Q )2 ≲ δd. Further,ifthereisnon-vanishingprobabilityoverthesupport,i.e.,
1 2 0 1
∀γ > 0and∀x ∈ supp(Q ),
0 0
(cid:110) (cid:111)
∀B (x ) := y ∈ supp(Q ) : ∥y−x ∥2 ≤ γ2 , Q (B (x )) ≥ ϵ, (9)
γ 0 0 0 0 γ 0
thenwecanachieveanimprovedrateas
dlog2T
KL(Q 1||P(cid:98)1) ≲
δ2T
+(logT)ε2.
Thecondition(9)canbesatisfiedeasily, forexample, whenQ hasnon-zeroprobabilitiesonlyatdiscrete
0
values(e.g.,images). Thisconditionisuniquetoourpaper.
(cid:16) (cid:17)
Comparison to result in [18]: Theorem 4 indicates that O d2 diffusion steps are needed for discrete-
δ2ε2
time DDPMs to achieve O(ε2) error in KL divergence (or O(ε) in TV distance). Such a result improves
10the dependence on d in [18] by a factor of O(d2). We further note that we consider Q (δ) that satisfies
1
W (Q ,Q )2 ≲ δd, where δ captures the closeness between Q and Q , whereas [18] does not explicitly
2 0 1 0 1
capturesuchaparameterintheirresult.
TheproofofTheorem4involvesthefollowingnovelelements. (i)VerifyingAssumption4requiresevaluating
andprovidinganupperboundforallordersofpartialderivativesofthelogarithmofacontinuousmixture
density. (ii)InordertoeliminatethesecondterminTheorem1,weneedtoprovideandverifyananalogous
conditionto(6)yetforgeneralQ . (iii)Weuseachange-of-measureargumenttofindtheoptimalupperbound
0
ontheexpectedtraceofHessianproducts.
5 Accelerated DDPM Sampler and Convergence Bounds
TogeneratesamplesfromthedatadistributionQ ,theideaofDDPMistodesignareverseprocessinwhich
0
eachreversesamplingstepwellapproximatesthecorrespondingforwardstep. Toachievethis,theconditional
mean of the true reverse process is designed to match the posterior mean at each step. In this section, we
propose a new accelerated sampler along with a new covariance estimator, in which both the conditional
meanandcovarianceofthereverseprocessmatchthecorrespondingposteriorquantitiesateachstep.
5.1 ANewAcceleratedDDPMSampler
Ateachtimet = T,T −1,...,1,definethetrueaccelerated reverseprocessas
1
x
t−1
= µ t(x t)+Σ t2(x t)z (10)
whereµ isdefinedin(3),z ∼ N(0,I ),and(cf. Lemma8)
t d
Σ (x ) := 1−α t (cid:0) I +(1−α )∇2logq (x )(cid:1) . (11)
t t d t t t
α
t
Equivalently,thiscanbewrittenasP′ = N(x ;µ (x ),Σ (x )). When(1−α )isvanishingforlarge
t−1|t t−1 t t t t t
T (e.g.,Definition1),Σ (x ) ≻ 0foralllargeT’s,andthustheconditionalGaussianprocessiswell-defined.
t t
The above accelerated sampler has a close relationship to Ozaki’s discretization method to approximate a
continuous-timestochasticprocess[42].
In practice, one does not know ∇2logq and needs to estimate it. Denote such an estimator by H (see an
t t
estimatorH weproposebelowbasedonaHessianmatchingmethod),andsupposethatH isalsosymmetric.
t t
GivenH ,wecanobtainanestimatedaccelerated reverseprocess:
t
x
t−1
= µˆ t(x t)+Σˆ t1 2(x t)z
whereµˆ isdefinedin(4),and
t
1−α
Σˆ (x ) := t (I +(1−α )H (x )). (12)
t t d t t t
α
t
Equivalently,wecanwrite
P(cid:98) t′
−1|t
= N(x t−1;µˆ t(x t),Σˆ t(x t)).
AHessianmatchingestimator OnemethodtoobtainH (x),whichestimates∇2logq (x),isasfollows.
t t
Notethat
∇2q (x)
∇2logq (x) = t −(∇logq (x))(∇logq (x))⊺
t t t
q (x)
t
(cid:18) ∇2q (x) 1 (cid:19) 1
t ⊺
= + I − I −(∇logq (x))(∇logq (x)) . (13)
d d t t
q (x) 1−α¯ 1−α¯
t t t
11Apartfromtheoriginalscoreestimate,werequireanadditionalHessianestimate:
v t(x) := argmin E
X ∼Q
(cid:13) (cid:13) (cid:13)v θ(X t)−(cid:18) ∇2q t(X t) + 1 I d(cid:19)(cid:13) (cid:13) (cid:13)2
v θ:Rd→Rd×d t t(cid:13) q t(X t) 1−α¯ t (cid:13) F
=
v
θa :Rrg d→m Ri dn ×dE X 0∼Q 0,W¯ t∼N(0,I d)(cid:13) (cid:13) (cid:13) (cid:13)v θ(√ α¯ tX 0+√ 1−α¯ tW¯ t)− 1−1 α¯ tW¯ tW¯ t⊺(cid:13) (cid:13) (cid:13) (cid:13)2
F
.
Herethesecondequationisananalogytoscorematching,whichwecallasHessianmatching. Theresulton
Hessianmatchingisincludedinthefollowinglemma,theproofofwhichisprovidedinAppendixI.1.
Lemma1. Withtheforwardprocessin(1),wehave
argmin E
X ∼Q
(cid:13) (cid:13) (cid:13)v θ(X t)−(cid:18) ∇2q t(X t) + 1 I d(cid:19)(cid:13) (cid:13) (cid:13)2
v θ:Rd→Rd×d t t(cid:13) q t(X t) 1−α¯ t (cid:13) F
=
v
θa :Rrg d→m Ri dn ×dE X 0∼Q 0,W¯ t∼N(0,I d)(cid:13) (cid:13) (cid:13) (cid:13)v θ(√ α¯ tX 0+√ 1−α¯ tW¯ t)− 1−1 α¯ tW¯ tW¯ t⊺(cid:13) (cid:13) (cid:13) (cid:13)2
F
.
From(13),anestimatefor∇2logq (x)isgivenby
t
1
⊺
H (x) = v (x)− I −s (x)s (x). (14)
t t 1−α¯ d t t
t
Intheliterature,severalotherestimatorshavebeenproposedforhigherorderderivativesoflogq (x)[43,44].
t
WenotethatanyestimatorforH isapplicabletoouranalysisaslongasAssumption5issatisfied.
t
Wenotethatouracceleratedsamplerisdifferentfromthatin[18,Section3.3.2]. Oursamplerdirectlyestimates
thecovarianceofthereverseprocess,andhencehasamoreintuitiveexplanationthatalignswiththeoriginal
DDPM[4,5],whereastheirsamplercanbeinterpretedasjointlyestimatingthecovariancematrixplusnoise.
Sinceoursamplerdirectlyestimatesthecovariance,itenablesustohandletheestimationerrorseasily,whereas
in[18]theestimatorsareassumedtobeperfectwhichmaynotbefeasibleinpractice. Further, aswewill
showbelow,oursamplerenjoysabetterconvergenceratewithimproveddependenceondthanthatin[18].
5.2 TechnicalAssumptionsforAcceleratedSampler
Inordertoanalyzetheacceleratedsampler,weneedanewassumptionthatextendsAssumption2toincorporate
theHessianestimationerror.
Assumption5(ScoreandHessianEstimationError). Theestimatess ’sandH ’ssatisfy
t t
1 (cid:88)T (cid:113)
E ∥s (X )−∇logq (X )∥4 ≤ ε2,
X ∼Q t t t t
T t t
t=1
suchthatε2 = O˜(T−2). Also,
T
T1 (cid:88) E
X t∼Q
t(cid:13) (cid:13)H t(X t)−∇2logq t(X t)(cid:13) (cid:13)2
F
≤ ε2 H,
t=1
suchthatε2 = O˜(T−1).
H
Inthefollowinglemma,weprovidesufficientconditionssuchthats fromregularscorematchingandH in
t t
(14)satisfyAssumption5.
12Lemma2. UnderAssumption4,supposethatv ands satisfy
t t
1 (cid:88)T E
X ∼Q
(cid:13) (cid:13) (cid:13)v t(X t)−(cid:18) ∇2q t(X t) + 1 I d(cid:19)(cid:13) (cid:13) (cid:13)2 = O˜(T−1),
T t t(cid:13) q (X ) 1−α¯ (cid:13)
t=1 t t t F
1 (cid:88)T (cid:113)
E ∥s (X )−∇logq (X )∥4 = O˜(T−2).
X ∼Q t t t t
T t t
t=1
Then,s andH definedin(14)satisfyAssumption5.
t t
5.3 AcceleratedConvergenceBounds
Wefirstdefineanewnoisescheduleasfollows,whichwillbeusefulforacceleration.
Definition2(NoiseScheduleforAcceleration). Thestep-sizeα ’ssatisfy
t
T
1−α ≲ logT , ∀1 ≤ t ≤ T, while α¯ = (cid:89) α = o(cid:0) T−2(cid:1)
t T t
T
t=1
forallsufficientlylargeT’s.
Inparticular,α¯ needstodecayatafasterratecomparedtothatinDefinition1. Anexampleofα thatsatisfies
T t
Definition2is1−α ≡ clogT, ∀t ≥ 1withc > 2.
t T
We provide the accelerated convergence results below for smooth Q and general Q which may be non-
0 0
smooth. Wewillthenspecializetheseresultstotheconvergenceratewithexplicitparameterdependencefor
Gaussianmixturedistributionsanddistributionswithboundedsupport.
Theorem5(AcceleratedSamplerforSmoothQ ). UnderAssumptions1and3to5,withtheα ’ssatisfying
0 t
Definition2,iffurtherthat(6)and
(cid:13) (cid:13)∇2logq t−1(µ t)−α t∇2logq t(x t)(cid:13) (cid:13)2 = O(1−α t) (15)
holdforallt ≥ 1andfixedx ∈ Rd,thenwehave
t
 
T d
(cid:88) (cid:88)
KL(Q 0||P(cid:98) 0′) ≲ (1−α t)3E X t∼Q t ∂ i3 jklogq t−1(µ t(X t))∂ i3 jklogq t(X t)
t=1 i,j,k=1
log2T
+(logT)ε2+ ε2 .
T H
To explain the above bound, the first term arises from the accumulated reverse-step error over times t =
T,...,1. ThesecondandthirdtermsareduetoinaccuratescoreandHessianestimation,respectively. Now,
underAssumption4,theexpectationofpartialderivativescanbeupper-boundedbyaconstantindependent
ofT (whichcanstilldependonothersystemparameterssuchasthedimensiond,andanalyzingthisisour
furtherinterestwhenweinstantiatethisresulttospecificclassesofdistributions). Thisimpliesthattherate
ofthereverse-steperroriscontrolledbythecoefficient(1−α )3 ≲ (logT/T)3. Thus,afterthesummation
t
from t = 1,...,T, the first term as well as the entire upper bound is in the order of O˜(1/T2) (note that
ε2 = O˜(1/T2)andε2 = O˜(1/T)byAssumption5). Thus,inordertoachieveO(ε2)errorinKLdivergence,
H
thenumberof(discrete)diffusionstepsrequiredisO(ε−1),whichimprovesthedependenceoftheconvergence
rateonεoftheregularsamplerbyafactorofO(ε−1).
13Corollary3(AcceleratedSamplerforGeneralQ ). UnderAssumptions1,4and5,usingtheα ’sdefinedin
0 t
(8)withc > 4,wehave
 
T d
(cid:88) (cid:88)
KL(Q 1||P(cid:98) 1′) ≲ (1−α t)3E X t∼Q t ∂ i3 jklogq t−1(µ t(X t))∂ i3 jklogq t(X t)
t=2 i,j,k=1
log2T
+(logT)ε2+ ε2 .
T H
HereQ issuchthatW (Q ,Q )2 ≲ δd.
1 2 0 1
Inthefollowing,wespecializeTheorem5andCorollary3totheinterestingcasesconsideredinSection4.
Theorem 6 (Accelerated Sampler for Lipschitz Score and Hessian). Suppose that ∇logq (x) and
t
∇2logq (x), ∀t ≥ 0arenormL-Lipschitzand2-normM-Lipschitz,respectively. Thismeansthat∃L,M > 0
t
suchthat
∥∇logq (x)−∇logq (y)∥ ≤ L∥x−y∥, ∀x,y ∈ Rd, ∀t ≥ 0,
t t
(cid:13) (cid:13)∇2logq t(x)−∇2logq t(y)(cid:13) (cid:13) ≤ M ∥x−y∥, ∀x,y ∈ Rd, ∀t ≥ 0. (16)
Then,underAssumptions1and3to5,thedistributionP(cid:98)0 generatedbythediscrete-timeDDPMsatisfies
d2M2log3T log2T
KL(Q 0||P(cid:98)0) ≲
T2
+(logT)ε2+
T
ε2 H.
ThisisthefirstresultforDDPMsamplerstoachieveanacceleratedconvergenceresultundertheadditional
conditionofLipschitzHessian,andunderscoreandHessianestimationerrors. Prioranalogousresultsare
availableintheliteratureofLangevinMonte-Carlosampling[45].
Theorem7(AcceleratedSamplerforGaussianMixtureQ ). SupposethatQ isGaussianmixture(asdefined
0 0
inTheorem3). UnderAssumption5,usingtheα ’sinDefinition2,wehave
t
d3min{d,N}3log3T log2T
KL(Q 0||P(cid:98) 0′) ≲
T2
+(logT)ε2+
T
ε2 H.
ThisisthefirstresultforDDPMsamplerstoachieveanacceleratedconvergencerateforGaussianmixture
targetsunderscoreandHessianestimationerror.
Theorem8(AcceleratedSamplerforQ havingBoundedSupport). Supposethat∥X ∥2 ≤ R2dalmostsurely
0 0
underQ . UnderAssumption5,usingtheα ’sdefinedin(8)withc > 4,wehave
0 t
d3log3T log2T
KL(Q 1||P(cid:98) 1′) ≲
δ3T2
+(logT)ε2+
T
ε2 H,
whereQ issuchthatW (Q ,Q )2 ≲ δd.
1 2 0 1
(cid:16) (cid:17)
Inotherwords,whenQ hasboundedsupport,ittakestheacceleratedalgorithmO d1.5 stepstoapproximate
0 δ1.5ε
a perturbed data distribution Q within ε2 error in KL divergence. Compared to [18], our number of
1
convergence steps to achieve ε2-KL divergence has an improved dimensional dependence by a factor of
O(d1.5). OuranalysisincludesbothscoreandHessianestimationerrors,whereas[18]doesnothandlethese
errors.
146 Conclusion
Inthispaper,wehavedevelopedanovelanalysisframeworkdirectlyoverthediscrete-timeDDPMprocess,
andwehaveprovidedconvergenceguaranteesforbothsmoothQ andgeneralQ withearly-stopping. One
0 0
futuredirectionistofurthershrinktheδ dependencefrompolynomialtologarithmicforgeneralQ under
0
early-stopping. It is also interesting to investigate other families of distributions where explicit parameter
dependencecanbefound.
Acknowledgements
ThisworkhasbeensupportedinpartbytheU.S.NationalScienceFoundationunderthegrants: CCF-1900145,
NSFAIInstitute(AI-EDGE)2112471,CNS-2312836,CNS-2223452,CNS-2225561,andwassponsoredby
theArmyResearchLaboratoryunderCooperativeAgreementNumberW911NF-23-2-0225. Theviewsand
conclusionscontainedinthisdocumentarethoseoftheauthorsandshouldnotbeinterpretedasrepresenting
theofficialpolicies,eitherexpressedorimplied,oftheArmyResearchLaboratoryortheU.S.Government. The
U.S.GovernmentisauthorizedtoreproduceanddistributereprintsforGovernmentpurposesnotwithstanding
anycopyrightnotationherein.
References
[1] DiederikPKingmaandMaxWelling. Auto-encodingvariationalbayes. arXivpreprintarXiv:1312.6114,
2022.
[2] IanGoodfellow,JeanPouget-Abadie,MehdiMirza,BingXu,DavidWarde-Farley,SherjilOzair,Aaron
Courville,andYoshuaBengio.Generativeadversarialnets.InAdvancesinNeuralInformationProcessing
Systems,volume27,2014.
[3] DaniloRezendeandShakirMohamed. Variationalinferencewithnormalizingflows. InProceedingsof
the32ndInternationalConferenceonMachineLearning,volume37,pages1530–1538,2015.
[4] Jascha Sohl-Dickstein, Eric Weiss, Niru Maheswaranathan, and Surya Ganguli. Deep unsupervised
learningusingnonequilibriumthermodynamics. InProceedingsofthe32ndInternationalConferenceon
MachineLearning,volume37,pages2256–2265,2015.
[5] JonathanHo,AjayJain,andPieterAbbeel. Denoisingdiffusionprobabilisticmodels. InAdvancesin
NeuralInformationProcessingSystems,volume33,pages6840–6851,2020.
[6] LingYang,ZhilongZhang,YangSong,ShendaHong,RunshengXu,YueZhao,WentaoZhang,BinCui,
andMing-HsuanYang. Diffusionmodels: Acomprehensivesurveyofmethodsandapplications. ACM
ComputingSurveys,56(4),Nov2023.
[7] F.Croitoru,V.Hondru,R.Ionescu,andM.Shah.Diffusionmodelsinvision: Asurvey.IEEETransactions
onPatternAnalysis&MachineIntelligence,45(9):10850–10869,Sep2023.
[8] Amirhossein Kazerouni, Ehsan Khodapanah Aghdam, Moein Heidari, Reza Azad, Mohsen Fayyaz,
IlkerHacihaliloglu,andDoritMerhof. Diffusionmodelsinmedicalimaging: Acomprehensivesurvey.
MedicalImageAnalysis,88,August2023.
[9] Yang Song, Jascha Sohl-Dickstein, Diederik P. Kingma, Abhishek Kumar, Stefano Ermon, and Ben
Poole. Score-basedgenerativemodelingthroughstochasticdifferentialequations. In9thInternational
ConferenceonLearningRepresentations,ICLR2021,2021.
[10] AapoHyvärinen. Estimationofnon-normalizedstatisticalmodelsbyscorematching. JournalofMachine
LearningResearch,6(24):695–709,2005.
15[11] ValentinDeBortoli,JamesThornton,JeremyHeng,andArnaudDoucet. Diffusionschrödingerbridge
withapplicationstoscore-basedgenerativemodeling. InAdvancesinNeuralInformationProcessing
Systems,volume34,pages17695–17709,2021.
[12] Sitan Chen, Sinho Chewi, Jerry Li, Yuanzhi Li, Adil Salim, and Anru Zhang. Sampling is as easy
as learning the score: theory for diffusion models with minimal data assumptions. In The Eleventh
InternationalConferenceonLearningRepresentations,2023.
[13] HoldenLee,JianfengLu,andYixinTan. Convergenceofscore-basedgenerativemodelingforgeneral
datadistributions. InProceedingsofThe34thInternationalConferenceonAlgorithmicLearningTheory,
volume201,pages946–985,2023.
[14] HongruiChen,HoldenLee,andJianfengLu. Improvedanalysisofscore-basedgenerativemodeling:
user-friendlyboundsunderminimalsmoothnessassumptions. InProceedingsofthe40thInternational
ConferenceonMachineLearning,2023.
[15] JoeBenton,ValentinDeBortoli,ArnaudDoucet,andGeorgeDeligiannidis. Linearconvergencebounds
fordiffusionmodelsviastochasticlocalization. arXivpreprintarXiv:2308.03686,2023.
[16] Francesco Pedrotti, Jan Maas, and Marco Mondelli. Improved convergence of score-based diffusion
modelsviaprediction-correction. arXivpreprintarXiv:2305.14164,2023.
[17] GiovanniConforti,AlainDurmus,andMartaGentiloniSilveri. Scorediffusionmodelswithoutearly
stopping: finitefisherinformationisallyouneed. arXivpreprintarXiv:2308.12240,2023.
[18] Gen Li, Yuting Wei, Yuxin Chen, and Yuejie Chi. Towards faster non-asymptotic convergence for
diffusion-basedgenerativemodels. arXivpreprintarXiv:2306.09251,2023.
[19] ValentinDeBortoli. Convergenceofdenoisingdiffusionmodelsunderthemanifoldhypothesis. Trans-
actionsonMachineLearningResearch,2022.
[20] Holden Lee, Jianfeng Lu, and Yixin Tan. Convergence for score-based generative modeling with
polynomialcomplexity. InAdvancesinNeuralInformationProcessingSystems,2022.
[21] StefanoBruno,YingZhang,Dong-YoungLim,ÖmerDenizAkyildiz,andSotiriosSabanis. Ondiffusion-
basedgenerativemodelsandtheirerrorbounds: Thelog-concavecasewithfullconvergenceestimates.
arXivpreprintarXiv:2311.13584,2023.
[22] XuefengGao,HoangM.Nguyen,andLingjiongZhu. Wassersteinconvergenceguaranteesforageneral
classofscore-basedgenerativemodels. arXivpreprintarXiv:2311.11003,2023.
[23] XuefengGaoandLingjiongZhu. Convergenceanalysisforgeneralprobabilityflowodesofdiffusion
modelsinwassersteindistances. arXivpreprintarXiv:2401.17958,2024.
[24] SitanChen,GiannisDaras,andAlexandrosG.Dimakis.Restoration-degradationbeyondlineardiffusions:
anon-asymptoticanalysisforddim-typesamplers. InProceedingsofthe40thInternationalConference
onMachineLearning,2023.
[25] SitanChen,SinhoChewi,HoldenLee,YuanzhiLi,JianfengLu,andAdilSalim. Theprobabilityflow
ODEisprovablyfast. InThirty-seventhConferenceonNeuralInformationProcessingSystems,2023.
[26] Yu Cao, Jingrun Chen, Yixin Luo, and Xiang ZHOU. Exploring the optimal choice for generative
processesindiffusionmodels: Ordinaryvsstochasticdifferentialequations. InThirty-seventhConference
onNeuralInformationProcessingSystems,2023.
16[27] XiuyuanCheng,JianfengLu,YixinTan,andYaoXie. Convergenceofflow-basedgenerativemodelsvia
proximalgradientdescentinwassersteinspace. arXivpreprintarXiv:2310.17582,2023.
[28] Joe Benton, George Deligiannidis, and Arnaud Doucet. Error bounds for flow matching methods.
TransactionsonMachineLearningResearch,2024.
[29] JinyuanChang,ZhaoDing,YulingJiao,RuoxuanLi,andJerryZhijianYang. Deepconditionalgenerative
learning: Modelanderroranalysis. arXivpreprintarXiv:2402.01460,2024.
[30] JunlongLyu,ZhitangChen,andShouboFeng. Samplingisaseasyaskeepingtheconsistency: conver-
genceguaranteeforconsistencymodels,2024.
[31] Gen Li, Zhihan Huang, and Yuting Wei. Towards a mathematical theory for consistency training in
diffusionmodels. arXivpreprintarXiv:2402.07802,2024.
[32] YangSong,PrafullaDhariwal,MarkChen,andIlyaSutskever. Consistencymodels. InProceedingsof
the40thInternationalConferenceonMachineLearning,2023.
[33] KazusatoOko,ShuntaAkiyama,andTaijiSuzuki. Diffusionmodelsareminimaxoptimaldistribution
estimators. In ICLR 2023 Workshop on Mathematical and Empirical Understanding of Foundation
Models,2023.
[34] KulinShah,SitanChen,andAdamKlivans. LearningmixturesofgaussiansusingtheDDPMobjective.
InThirty-seventhConferenceonNeuralInformationProcessingSystems,2023.
[35] SongMeiandYuchenWu. Deepnetworksasdenoisingalgorithms: Sample-efficientlearningofdiffusion
modelsinhigh-dimensionalgraphicalmodels. arXivpreprintarXiv:2309.11420,2023.
[36] Minshuo Chen, Kaixuan Huang, Tuo Zhao, and Mengdi Wang. Score approximation, estimation
and distribution recovery of diffusion models on low-dimensional data. In Proceedings of the 40th
InternationalConferenceonMachineLearning,2023.
[37] PuhengLi, ZhongLi, HuishuaiZhang, andJiangBian. Onthegeneralizationpropertiesofdiffusion
models. arXivpreprintarXiv:2311.01797,2024.
[38] BradleyEfron. Tweedie’sformulaandselectionbias. JournaloftheAmericanStatisticalAssociation,
106(496):1602–1614,2011.
[39] AthanassiaG.Bacharoglou. Approximationofprobabilitydistributionsbyconvexmixturesofgaussian
measures. ProceedingsoftheAmericanMathematicalSociety,138(7):2619–2628,2010.
[40] Ilias Diakonikolas, Daniel M. Kane, and Alistair Stewart. Statistical query lower bounds for robust
estimationofhigh-dimensionalgaussiansandgaussianmixtures. In2017IEEE58thAnnualSymposium
onFoundationsofComputerScience(FOCS),pages73–84,2017.
[41] GConstantineandTSavits. Amultivariatefaadibrunoformulawithapplications. Transactionsofthe
AmericanMathematicalSociety,348(2):503–520,1996.
[42] Isao Shoji. Approximation of continuous time stochastic processes by a local linearization method.
MathematicsofComputation,67(221):287–298,1998.
[43] ChenlinMeng,YangSong,WenzheLi,andStefanoErmon. Estimatinghighordergradientsofthedata
distributionbydenoising. InAdvancesinNeuralInformationProcessingSystems,2021.
17[44] ChengLu,KaiwenZheng,FanBao,JianfeiChen,ChongxuanLi,andJunZhu. Maximumlikelihood
training for score-based diffusion odes by high-order denoising score matching. In International
ConferenceonMachineLearning,2022.
[45] ArnakS.DalalyanandAvetikKaragulyan. User-friendlyguaranteesforthelangevinmontecarlowith
inaccurategradient. StochasticProcessesandtheirApplications,129(12):5278–5311,2019.
[46] Pierre Moulin and Venugopal V. Veeravalli. Statistical Inference for Engineers and Data Scientists.
CambridgeUniversityPress,Cambridge,UK,2018.
18Appendix
A ProofofTheorem1 21
A.1 Step0: Boundingterm1–InitializationError . . . . . . . . . . . . . . . . . . . . . . . . . 22
A.2 Step1: Boundingterm2–ScoreEstimationError. . . . . . . . . . . . . . . . . . . . . . . 22
A.3 Step2: ExpressingLog-likelihoodRatioviaTiltingFactor . . . . . . . . . . . . . . . . . . 22
A.4 Step3: ConditionalExpectationofζ underP . . . . . . . . . . . . . . . . . . . . 24
t,t−1 t−1|t
A.5 Step4: ConditionalExpectationofζ underQ . . . . . . . . . . . . . . . . . . . . 24
t,t−1 t−1|t
A.6 Boundingterm3–Reverse-stepError . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 26
B ProofofCorollaries1and2 26
B.1 ProofofCorollary1 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 26
B.2 ProofofCorollary2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28
C AuxiliaryProofsforTheorem1andCorollaries1and2 28
C.1 ProofofLemma3 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28
C.2 ProofofLemma4 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29
C.3 ProofofLemma5 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29
C.4 ProofofLemma6 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30
C.5 ProofofLemma7 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31
C.6 ProofofLemma8 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 33
C.7 ProofofLemma9 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 34
C.8 ProofofLemma11 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 39
C.9 ProofofLemma12 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 40
D ProofofTheorems2and3 40
D.1 ProofofTheorem2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 41
D.2 ProofofTheorem3 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 41
E ProofofTheorem4 46
E.1 VerifyingAssumption4 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 47
E.2 BoundingMomentsofζ underP . . . . . . . . . . . . . . . . . . . . . . . . . . . 47
t,t−1 t−1|t
E.3 MoreRefinedBoundforQ withBoundedSupport . . . . . . . . . . . . . . . . . . . . . . 48
0
E.4 ExplicitParameterDependence. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 49
19F AuxiliaryProofsforTheorems2to4 52
F.1 ProofofLemma13 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 52
F.2 ProofofLemma14 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 52
F.3 ProofofLemma15 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 55
F.4 ProofofCorollary4 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 58
F.5 ProofofLemma16 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 59
F.6 ProofofLemma17 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 60
F.7 ProofofLemma18 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 61
G ProofofTheorem5 63
G.1 Step1: ImprovingEstimationError . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 64
G.2 Step2: Re-expressingLog-likelihoodRatioinAcceleratedProcess. . . . . . . . . . . . . . 66
G.3 Step3: ConditionalExpectationofζ′ underP′ andQ . . . . . . . . . . . . . . 67
t,t−1 t−1|t t−1|t
G.4 Step4: ConditionalMomentsofζ′ underP′ . . . . . . . . . . . . . . . . . . . . . . 69
t,t−1 t−1|t
G.5 ImprovingReverse-stepError . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 69
H ProofofCorollary3andTheorems6to8 70
H.1 ProofofCorollary3 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 70
H.2 ProofofTheorem6 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 71
H.3 ProofofTheorem7 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 73
H.4 ProofofTheorem8 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 76
I AuxiliaryProofsforTheorems5to8andCorollary3 78
I.1 ProofofLemma1 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 78
I.2 ProofofLemma2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 79
I.3 ProofofLemma19 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 80
I.4 ProofofLemma20 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 81
I.5 ProofofLemma21 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 81
I.6 ProofofLemma22 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 83
I.7 ProofofLemma23 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 85
I.8 ProofofLemma24 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 87
I.9 ProofofLemma25 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 88
I.10 ProofofLemma26 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 89
20I.11 ProofofLemma27 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 90
A Proof of Theorem 1
TobegintheproofofTheorem1,notethat
(cid:20) (cid:21)
q(X ,...,X )
KL(Q||P(cid:98)) = E
X ,...,X ∼Q
log 0 T
0 T p(X ,...,X )
(cid:98) 0 T
(cid:34)
q (X
)(cid:81)T
q (X |X
)(cid:35)
( =i) E log 0 0 t=1 t|t−1 t t−1
X ,...,X ∼Q
0 T p(X ,...,X )
(cid:98) 0 T
(cid:34)
q (X
)(cid:81)T
q (X |X
)(cid:35)
( =ii) E log 0 0 t=1 t|t−1 t t−1
X 0,...,X T∼Q
p (X
)(cid:81)T
p (X |X )
(cid:98)0 0 t=1(cid:98)t|t−1 t t−1
= E
(cid:20)
log
q 0(X 0)(cid:21) +(cid:88)T
E
(cid:20)
log
q t|t−1(X t|X t−1)(cid:21)
X ∼Q X ,X ∼Q
0 0 p (X ) t−1 t t−1,t p (X |X )
(cid:98)0 0 (cid:98)t|t−1 t t−1
t=1
= E
(cid:20)
log
q 0(X 0)(cid:21) +(cid:88)T
E
(cid:20)
E
(cid:20)
log
q t|t−1(X t|X t−1)(cid:21)(cid:21)
X ∼Q X ∼Q X ∼Q
0 0 p (X ) t−1 t−1 t t|t−1 p (X |X )
(cid:98)0 0 (cid:98)t|t−1 t t−1
t=1
T
(cid:88) (cid:104) (cid:105)
= KL(Q 0||P(cid:98)0)+ E
X t−1∼Q
t−1
KL(Q t|t−1(·|X t−1)||P(cid:98)t|t−1(·|X t−1)) .
t=1
Here (i) holds because of the Markov property of the forward process. We explain (ii) below. By the
backwardMarkovpropertyofthereverseprocess,foranyt ≥ 1,givenX = x ,eachofX ,...,X is
t−1 t−1 t−2 0
independentwithX . Thisimpliesthat
t
p (x |x ,...,x ) = p (x |x ), ∀t ≥ 1.
(cid:98)t|t−1,...,0 t t−1 0 (cid:98)t|t−1 t t−1
Thus, p(x ,...,x ) = p (x
)(cid:81)T
p (x |x ). In other words, X ,...,X is also forward Markov
(cid:98) 0 T (cid:98)0 0 t=1(cid:98)t|t−1 t t−1 0 t
underP(cid:98).
Followingfromsimilararguments,
T
(cid:88) (cid:104) (cid:105)
KL(Q||P(cid:98)) = KL(Q T||P(cid:98)T)+ E
X t∼Q
t
KL(Q t−1|t(·|X t)||P(cid:98)t−1|t(·|X t)) .
t=1
SinceKL-divergenceisnon-negative,anupperboundonKL(Q 0||P(cid:98)0)isgivenby
KL(Q 0||P(cid:98)0)
T
(cid:88) (cid:104) (cid:105)
= KL(Q T||P(cid:98)T)+ E
X t∼Q
t
KL(Q t−1|t(·|X t)||P(cid:98)t−1|t(·|X t))
t=1
T
(cid:88) (cid:104) (cid:105)
− E
X t−1∼Q
t−1
KL(Q t|t−1(·|X t−1)||P(cid:98)t|t−1(·|X t−1))
t=1
T
(cid:88) (cid:104) (cid:105)
≤ KL(Q T||P(cid:98)T)+ E
X t∼Q
t
KL(Q t−1|t(·|X t)||P(cid:98)t−1|t(·|X t))
t=1
= E
(cid:20)
log
q T(X T)(cid:21) +(cid:88)T
E
(cid:20)
log
p t−1|t(X t−1|X t)(cid:21)
X ∼Q X ,X ∼Q
T T p (X ) t t−1 t,t−1 p (X |X )
T T (cid:98)t−1|t t−1 t
t=1
(cid:124) (cid:123)(cid:122) (cid:125)
(cid:124) (cid:123)(cid:122) (cid:125)
Term1:initializationerror
Term2:estimationerror
21+(cid:88)T
E
(cid:20)
log
q t−1|t(X t−1|X t)(cid:21)
. (17)
X ,X ∼Q
t t−1 t,t−1 p (X |X )
t−1|t t−1 t
t=1
(cid:124) (cid:123)(cid:122) (cid:125)
Term3:reverse-steperror
Thelastequalityholdsbecausep = p . Next,weboundtheabovethreetermsseparatelyinafewsteps.
(cid:98)T T
A.1 Step0: Boundingterm1–InitializationError
Lemma3. Supposeα¯ ↘ 0asT → ∞. Then,
T
(cid:20) (cid:21)
E log q T(X T) ≤ 1 E ∥X ∥2α¯ +O(cid:0) α¯2(cid:1) , asT → ∞.
X T∼Q T p (X ) 2 X 0∼Q 0 0 T T
T T
Remark1. UnderAssumption1,ifthenoiseschedulesatisfiesDefinition1,wehave
(cid:20) (cid:21)
q (X )
E log T T = o(T−1).
X ∼Q
T T p (X )
T T
Proof. SeeAppendixC.1.
A.2 Step1: Boundingterm2–ScoreEstimationError
Lemma4. UnderAssumption2,withtheα ’ssatisfyingDefinition1,wehave
t
(cid:88)T
E
(cid:20)
log
p t−1|t(X t−1|X t)(cid:21)
≲ (logT)ε2.
X ,X ∼Q
t t−1 t,t−1 p (X |X )
(cid:98)t−1|t t−1 t
t=1
Proof. SeeAppendixC.2.
A.3 Step2: ExpressingLog-likelihoodRatioviaTiltingFactor
Tounderstandandanalyzethereverse-steperror,wefirstinvestigatetherelationshipbetweenq andp
t−1|t t−1|t
foranyfixedt ≥ 1andx ∈ Rd. Inthissectionwriteµ (x ) = µ forbrevity. Inthefollowinglemma,we
t t t t
showthatq isanexponentiallytiltedformofp ,whichfurtherenablesustoupper-boundtheexpected
t−1|t t−1|t
log-likelihoodratiousingthetiltingfactor.
Lemma5. Foranyfixedx ∈ Rd,wehave
t
p t−1|t(x t−1|x t)eζ t,t−1(x t,x t−1)
q (x |x ) =
t−1|t t−1 t E
X ∼P
[eζ t,t−1(x t,X t−1)]
t−1 t−1|t
where
√
⊺
ζ (x ,x ) := logq (x )−logq (µ )−(x −µ ) ( α ∇logq (x )). (18)
t,t−1 t t−1 t−1 t−1 t−1 t t−1 t t t t
Proof. SeeAppendixC.3.
Inthefollowingwewriteζ = ζ (x ,x )andomitdependenciesonx andx forbrevity. Forany
t,t−1 t,t−1 t t−1 t t−1
fixedx ,theconditionalreverse-steperrorcanbeupper-boundedas
t
(cid:20) q (X |x )(cid:21)
E log t−1|t t−1 t
X ∼Q
t−1 t−1|t p (X |x )
t−1|t t−1 t
(cid:104) (cid:105)
= E
X ∼Q
ζ t,t−1−logE
X ∼P
[eζ t,t−1]
t−1 t−1|t t−1 t−1|t
22= E
X ∼Q
[ζ t,t−1]−logE
X ∼P
[eζ t,t−1]
t−1 t−1|t t−1 t−1|t
≤ E [ζ ]−log(cid:0) 1+E [ζ ](cid:1) (19)
X ∼Q t,t−1 X ∼P t,t−1
t−1 t−1|t t−1 t−1|t
wherethelastinequalityfollowsbecauseez ≥ 1+z foranyz ∈ R.
Giventhedefinitionofζ in(18),belowweanalyzelogq (x)aroundx = µ usingTaylorexpansion.
t,t−1 t−1 t
ThefollowinglemmaguaranteesthevalidityofTaylorexpansionfort ≥ 1.
Lemma6. Fixt ≥ 1. ForanyQ (notnecessarilyhavingap.d.f. w.r.t. theLebesguemeasure),givenany
0
k ≥ 1 and any vector of indices a ∈ [d]k, q exists and |∂klogq (x )| < ∞, ∀x ∈ Rd (which possibly
t a t t t
dependsonT). Further,q andlogq arebothanalytic.
t t
Proof. SeeAppendixC.4.
Recallthatxi(1 ≤ i ≤ d)denotesthei-thelementofavectorx. Ingeneral,givenananalyticfunctionf(x),
itsTaylorexpansionaroundx = µisgivenby
∞
(cid:88)
f(x) = f(µ)+ T (f,x,µ)
p
p=1
d d
= f(µ)+∇f(µ)⊺ (x−µ)+ 1 (cid:88) ∂2f(µ)(xi−µi)2+ 1 (cid:88) ∂2f(µ)(xi−µi)(xj −µj)
2 ii 2 ij
i=1 i,j=1
i̸=j
d d
1 (cid:88) 1 (cid:88)
+ ∂3 f(µ)(xi−µi)3+ ∂3 f(µ)(xi−µi)2(xj −µj)
3! iii 3! iij
i=1 i,j=1
i̸=j
d d
1 (cid:88) 1 (cid:88)
+ ∂3 f(µ)(xi−µi)(xj −µj)(xk −µk)+ ∂4 f(µ)(xi−µi)4
3! ijk 4! iiii
i,j,k=1 i=1
i,j,kalldiffer
d d
1 (cid:88) 1 (cid:88)
+ ∂4 f(µ)(xi−µi)3(xj −µj)+ ∂4 f(µ)(xi−µi)2(xj −µj)2
4! iiij 4! iijj
i,j=1 i,j=1
i̸=j i̸=j
d
1 (cid:88)
+ ∂4 f(µ)(xi−µi)2(xj −µj)(xk −µk)
4! iijk
i,j,k=1
i,j,kalldiffer
d ∞
1 (cid:88) (cid:88)
+ ∂4 f(µ)(xi−µi)(xj −µj)(xk −µk)(xl −µl)+ T (f,x,µ)
4! ijkl p
i,j,k,l=1 p=5
i,j,k,lalldiffer
where
d
1 (cid:88) (cid:89)
T (f,x,µ) := ∂pf(µ) (xi−µi)γi (20)
p p! a
γ∈Nd:(cid:80) γi=p i=1
i
whereina ∈ [d]p themultiplicityofi(∈ [d])isγi. Specializetothecasewheref = logq ,x = x ,and
t−1 t−1
µ = µ . Sincelogq isanalytic(byAssumption3andLemma6),Taylorexpansioncanbeappliedandis
t t−1
23equalto(cf. (18))
∞
√ ⊺ (cid:88)
ζ = (∇logq (µ )− α ∇logq (x )) (x −µ )+ T (logq ,x ,µ ). (21)
t,t−1 t−1 t t t t t−1 t p t−1 t−1 t
p=2
Withallthesetools,wearenowreadytoanalyzeζ underP andQ .
t,t−1 t−1|t t−1|t
A.4 Step3: ConditionalExpectationofζ underP
t,t−1 t−1|t
Startingfromnow,wewillneedtoexaminetherateof 1−α t. AdirectimplicationofDefinition1isthat,with
α
t
someconstantC ,sinceα ↘ 0asT → ∞,
1 t
(1−α )p CplogpT/Tp
t ≤ 1 ≲ (1−α )p, ∀p,q ≥ 1,t ≥ 1. (22)
αq (1−C logT/T)q t
t 1
Also,fromthedefinitionofµ in(3),if(1−α )satisfiesDefinition1andif∥∇logq (x)∥satisfiesAssump-
t t t
tion4,wehaveµ (x) = x+O(logT/T)foranyfixedx ∈ Rd.
t
The following lemma evaluates E [ζ ]. Although we consider smooth Q in this section, the
X ∼P t,t−1 0
t−1 t−1|t
resultisalsoapplicabletonon-smoothQ att ≥ 2sinceQ (t ≥ 1)isalwayssmoothduetoLemma6.
0 t
Lemma 7. Fix t ≥ 1. Suppose that all partial derivatives of logq exist. For any fixed x ∈ Rd, under
t−1 t
Assumption4,
(cid:32) (cid:33)
d (cid:18) (cid:19)
E [ζ ] = 1 (cid:88) ∂2 logq (µ ) 1−α t
X t−1∼P t−1|t t,t−1 2 ii t−1 t α
t
i=1
 
(cid:32) (cid:33)
+ 1
8
(cid:88)d
∂ i4 iiilogq t−1(µ t)
(cid:18)
1−
α
tα
t(cid:19)2
+ 41
!
 
(cid:88)d
∂ i4 ijjlogq t−1(µ t) 
(cid:18)
1−
α
tα
t(cid:19)2
+O(cid:0) (1−α t)3(cid:1) .
i=1 i,j=1
i̸=j
Remark2. SupposethenoiseschedulesatisfiesDefinition1. WehaveE [ζ ] = O(1−α ) =
X ∼P t,t−1 t
t−1 t−1|t
O˜(T−1),whichvanishesasT → ∞.
Proof. SeeAppendixC.5.
A.5 Step4: ConditionalExpectationofζ underQ
t,t−1 t−1|t
Although each Q is conditionally Gaussian, the posterior Q is not Gaussian in general. In the
t|t−1 t−1|t
following,weanalyzetheposteriorcentralizedmomentsunderQ usingtheideaofTweedie’sformula[38].
t−1|t
Then, we apply themto analyzeE [ζ ], againusing theTaylorexpansionin (21). Again, the
X ∼Q t,t−1
t−1 t−1|t
resultismoregenerallyapplicabletonon-smoothQ att ≥ 2duetoLemma6.
0
√
Lemma8. Fixt ≥ 1andx ∈ Rd. Definex˜ := α t x ,and
t t 1−α t
t
(cid:18) (cid:19)
1−α 1−α d
κ(x˜ ) := logq √ t x˜ + t ∥x˜ ∥2+ log(2π(1−α )). (23)
t t t t t
α 2α 2
t t
Let1 ≤ i,j,k,l ≤ d,whicharepossiblyequaltoeachother. Thefirst3centralizedmomentsunderQ
t−1|t
satisfy
E [X ] = ∇κ = µ
X ∼Q t−1 t
t−1 t−1|t
1−α (1−α )2
E [(X −µ )(X −µ )⊺ ] = ∇2κ = t I + t ∇2logq (x )
X ∼Q t−1 t t−1 t d t t
t−1 t−1|t α α
t t
24(cid:104) (cid:105)
E (Xi −µi)(Xj −µj)(Xk −µk) = ∂3 κ
X t−1∼Q t−1|t t−1 t t−1 t t−1 t ijk
(1−α )3
= t ∂3 logq (x ) = O((1−α )3).
3/2 ijk t t t
α
t
Thefourthcentralizedmomentsatisfies
(cid:104) (cid:105)
E (Xi −µi)(Xj −µj)(Xk −µk)(Xl −µl)
X t−1∼Q t−1|t t−1 t t−1 t t−1 t t−1 t
= (∂2κ)(∂2κ)+(∂2 κ)(∂2κ)+(∂2κ)(∂2 κ)+∂4 κ
ij kl ik jl il jk ijkl
 (cid:16) (cid:17)2
  3 1− αα t +O((1−α t)3), ifi = j = k = l,
 t
=

(cid:16)
1− αα
tt(cid:17)2
+O((1−α t)3), ifi = k ̸= j = l,
 O((1−α )3), otherwise.
t
Notethatallderivativesabovearew.r.t. x˜ .
t
Proof. SeeAppendixC.6.
Thefollowinglemmaprovidesthecorrectorder(intermsof(1−α ))ofanyposteriorcentralizedmoment. In
t
otherwords,thisshowsthatQ hasnice(Gaussian)concentration.
t−1|t
Lemma 9. Fix t ≥ 1, x ∈ Rd, and p ≥ 2. Let a = (a ,...,a ) ∈ [d]p be a vector of indices of length p.
t 1 p
Withthesamedefinitionsofx˜ andκ(x˜ )asinLemma8,ifpisodd,
t t
(cid:34) p (cid:35)
E
X t−1∼Q
t−1|t
(cid:89) (X ta −i 1−µa ti) = O(cid:16) (1−α t)p+ 23(cid:17) , ∀a ∈ [d]p. (24)
i=1
Ifpiseven,
(cid:34) p (cid:35)
E
X t−1∼Q
t−1|t
(cid:89) (X ta −i 1−µa ti) = O((1−α t)p 2), ∀a ∈ [d]p. (25)
i=1
Proof. SeeAppendixC.7.
CombiningthemomentresultsinLemmas8and9,wecanderivethefollowingresult,againusingtheTaylor
expansionaroundµ (see(21)).
t
Lemma10. Fixt ≥ 1. Supposethatallpartialderivativesoflogq exist. Foranyfixedx ∈ Rd,under
t−1 t
Assumption4,
E [ζ ]
X ∼Q t,t−1
t−1 t−1|t
=
1 (cid:88)d
∂2 logq (µ
)(cid:18) 1−α
t +
(1−α t)2
∂2 logq (x
)(cid:19)
2 ii t−1 t α α ii t t
t t
i=1
(cid:32) (cid:33)
+
(1−α t)2 (cid:88)d
∂2 logq (µ )∂2 logq (x )+
1 (cid:88)d
∂4 logq (µ )
(cid:18) 1−α t(cid:19)2
α ij t−1 t ij t t 8 iiii t−1 t α
t t
i,j=1 i=1
i̸=j
 
+ 41
!
 
(cid:88)d
∂ i4 ijjlogq t−1(µ t) 
(cid:18)
1−
α
tα
t(cid:19)2
+O(cid:0) (1−α t)3(cid:1) .
i,j=1
i̸=j
25Proof. TheproofissimilartothatofLemma7andthusomitted. Notethattheexchangeofinfinitesumand
expectationisstillguaranteedbyAssumption4. Theonlydifferenceisthatwesubstituteadifferentsetof
momentsaccordingtoLemmas8and9intotheTaylorexpansionin(21).
A.6 Boundingterm3–Reverse-stepError
Now,wecombineLemmas7and10andcontinuefrom(19)toupper-boundterm3ofthereverse-steperror.
TheTaylorexpansionoflog(1+z)aroundz = 0yieldsthat
z2
log(1+z) = z− +O(z3), whenz → 0.
2
For each t ≥ 1, suppose that Assumption 4 is satisfied. Since E [ζ ] is vanishing because
X ∼P t,t−1
t−1 t−1|t
1−α ↘ 0asT → ∞(seeRemark2),wecanuseLemmas7and10andcontinue(19)as
t
(cid:20) q (X |x )(cid:21)
E log t−1|t t−1 t ≤ E [ζ ]−log(cid:0) 1+E [ζ ](cid:1)
X ∼Q X ∼Q t,t−1 X ∼P t,t−1
t−1 t−1|t p (X |x ) t−1 t−1|t t−1 t−1|t
t−1|t t−1 t
= E [ζ ]−E [ζ ]+ 1 (cid:0)E [ζ ](cid:1)2
X ∼Q t,t−1 X ∼P t,t−1 X ∼P t,t−1
t−1 t−1|t t−1 t−1|t 2 t−1 t−1|t
(cid:16) (cid:17)
+O
(cid:0)E
[ζ
](cid:1)3
X ∼P t,t−1
t−1 t−1|t
= (1−α t)2 (cid:16) Tr(cid:0) ∇2logq (µ )∇2logq (x )(cid:1) +Tr(cid:0) ∇2logq (µ )(cid:1)2(cid:17)
2α2 t−1 t t t t−1 t
t
(cid:16) (cid:17)
+O
(cid:0)E
[ζ
](cid:1)3
X ∼P t,t−1
t−1 t−1|t
wherethelastlinefollowsfromLemmas7and10andtherelationshipin(22). Thefinalstepistotakethe
expectationoverX ∼ Q . UnderAssumption4,sinceallhigherorderpartialderivativeshaveanupperbound
t t
inexpectationw.r.t. Q thatdoesnotdependonT,therateofeachtermdoesnotchangeaftertheexpectation.
t
Inotherwords,(cf. Lemma7)
E (cid:2)(cid:0)E [ζ ](cid:1)p(cid:3) = O((1−α )p), ∀p ≥ 1. (26)
X ∼Q X ∼P t,t−1 t
t t t−1 t−1|t
Therefore,summingovert ≥ 1,weobtain
(cid:88)T
E
(cid:20)
log
q t−1|t(X t−1|X t)(cid:21)
X ,X ∼Q
t−1 t t−1,t p (X |X )
t−1|t t−1 t
t=1
T
≲ (cid:88) (1−α )2E (cid:104) Tr(cid:16) ∇2logq (µ (X ))∇2logq (X )(cid:17) +Tr(cid:0) ∇2logq (µ (X ))(cid:1)2(cid:105) .
t X ∼Q t−1 t t t t t−1 t t
t t
t=1
Now,theproofofTheorem1iscomplete.
B Proof of Corollaries 1 and 2
B.1 ProofofCorollary1
TheinitializationandestimationerrorscanbeboundedinthesamewayasinTheorem1,andthedifference
liesinhowtoboundthereverse-steperror. InordertogetridoftheTr(·)2 termandtoachieveamoreprecise
bound,weneedtocontroltheexpectedvaluesofhigher(specifically,secondandthird)momentsofζ .
t,t−1
From(21),itcanbeobservedthatthefirst-ordertermofζ becomeszeroaftertakingexpectationunder
t,t−1
P andQ . However,thistermwillbepresentinthepowersofζ whichinturnwillaffecttheir
t−1|t t−1|t t,t−1
expectedvalues. Tothisend,condition(6)guaranteesthatthecoefficientforthefirst-ordertermissmall. In
thefollowinglemma,weshowthattheexpectedpowersofζ aresmallwhen(6)holds.
t,t−1
26Lemma11. SupposethatAssumption4and (6)hold. Then,ifthenoiseschedulesatisfiesDefinition1,forall
t ≥ 1andfixedx ∈ Rd,
t
E [ζ2 ] = O(cid:0) (1−α )2(cid:1) =
O(cid:18) log2T(cid:19)
, and
X t−1∼P t−1|t t,t−1 t T2
E [ζ3 ] = O(cid:0) (1−α )3(cid:1) =
O(cid:18) log3T(cid:19)
.
X t−1∼P t−1|t t,t−1 t T3
Proof. SeeAppendixC.8.
Inordertoachieveamorepreciseerrorcontrol,wealsoneedtoexpandmorepowertermsforez thanin(19).
Specifically,
(cid:20) q (X |x )(cid:21)
E log t−1|t t−1 t ≤ E [ζ ]
X ∼Q X ∼Q t,t−1
t−1 t−1|t p (X |x ) t−1 t−1|t
t−1|t t−1 t
(cid:18) (cid:19)
1 1
−log 1+E [ζ ]+ E [ζ2 ]+ E [ζ3 ] (27)
X t−1∼P t−1|t t,t−1 2 X t−1∼P t−1|t t,t−1 3! X t−1∼P t−1|t t,t−1
wherewehaveusedthefactthatez ≥ 1+z+ z2 + z3 foranyz ∈ R. Then,
2 3!
(cid:20) q (X |x )(cid:21)
E log t−1|t t−1 t
X ,X ∼Q
t−1 t t−1,t p (X |x )
t−1|t t−1 t
(cid:34)
≤ E E [ζ ]
X ∼Q X ∼Q t,t−1
t t t−1 t−1|t
(cid:35)
(cid:18) (cid:19)
1 1
−log 1+E [ζ ]+ E [ζ2 ]+ E [ζ3 ]
X t−1∼P t−1|t t,t−1 2 X t−1∼P t−1|t t,t−1 3! X t−1∼P t−1|t t,t−1
(cid:34)
= E E [ζ ]−E [ζ ]
X ∼Q X ∼Q t,t−1 X ∼P t,t−1
t t t−1 t−1|t t−1 t−1|t
1 1
− E [ζ2 ]− E [ζ3 ]
2 X t−1∼P t−1|t t,t−1 3! X t−1∼P t−1|t t,t−1
1
(cid:18)
1 1
(cid:19)2
+ E [ζ ]+ E [ζ2 ]+ E [ζ3 ]
2 X t−1∼P t−1|t t,t−1 2 X t−1∼P t−1|t t,t−1 3! X t−1∼P t−1|t t,t−1
(cid:32) (cid:33)(cid:35)
(cid:18)
1 1
(cid:19)3
+O E [ζ ]+ E [ζ2 ]+ E [ζ3 ]
X t−1∼P t−1|t t,t−1 2 X t−1∼P t−1|t t,t−1 3! X t−1∼P t−1|t t,t−1
(cid:34)
( =i) E E [ζ ]−E [ζ ]
X ∼Q X ∼Q t,t−1 X ∼P t,t−1
t t t−1 t−1|t t−1 t−1|t
(cid:35)
− 1 E [ζ2 ]+ 1 (cid:0)E [ζ ](cid:1)2 +O((1−α )3)
2 X t−1∼P t−1|t t,t−1 2 X t−1∼P t−1|t t,t−1 t
(ii)
≤ E (cid:2)E [ζ ]−E [ζ ](cid:3) +O((1−α )3).
X ∼Q X ∼Q t,t−1 X ∼P t,t−1 t
t t t−1 t−1|t t−1 t−1|t
Here (i) follows from the results in Lemmas 7 and 11 and Assumption 4 (see (26)), and (ii) follows from
Jensen’sinequality. Thus,againusingtheresultsinLemmas7and10,wecanachieveafasterresult:
(cid:88)T
E
(cid:20)
log
q t−1|t(X t−1|X t)(cid:21)
X ,X ∼Q
t−1 t t−1,t p (X |X )
t−1|t t−1 t
t=1
27T
(cid:88) (cid:104) (cid:16) (cid:17)(cid:105)
≲ (1−α )2E Tr ∇2logq (µ (X ))∇2logq (X ) .
t X ∼Q t−1 t t t t
t t
t=1
B.2 ProofofCorollary2
Notethatq alwaysexistsandisanalyticbyLemma6. Therefore,itremainstoupper-boundthemismatch
1
betweenQ andQ . InthefollowinglemmaweprovidesuchaboundinWassersteindistance.
0 1
Lemma12. ForanyQ ,
0
W (Q ,Q )2 ≤ (1−α )(M +1)d.
2 0 1 1 2
Remark3. If1−α = δ,thisimpliesthat
1
W (Q ,Q )2 ≲ δd.
2 0 1
Proof. SeeAppendixC.9.
Theproofofthiscorollaryisthuscomplete. AconsequenceofLemma12isthat,inordertoobtainconvergence
guaranteesforgeneraldistributions,onecanview1−α ascontrollingthemismatchbetweenQ andQ (in
1 0 1
termsoftheWassersteindistance),and1−α t, ∀t ≥ 2ascontrollingthemismatchbetweenQ
1
andP(cid:98)1 (in
termsoftheKL-divergence).
C Auxiliary Proofs for Theorem 1 and Corollaries 1 and 2
Inthissection,weprovidetheproofsforthoseauxiliarylemmasintheproofofTheorem1andCorollaries1
and2.
C.1 ProofofLemma3
First,notethat
q (x ) = E [q (x |X )].
T T X 0∼Q 0 T|0 T 0
Alsonotethatthefunctionf(x) = xlog(x)isconvex. Thus,byJensen’sinequality,
(cid:90)
E [logq (X )] = E [q (x |X )]logE [q (x |X )]dx
X T∼Q T T T X 0∼Q 0 T|0 T 0 X 0∼Q 0 T|0 T 0 T
(cid:90)
≤ E (cid:2) q (x |X )logq (x |X )(cid:3) dx
X 0∼Q 0 T|0 T 0 T|0 T 0 T
(cid:20)(cid:90) (cid:21)
= E q (x |X )logq (x |X )dx .
X 0∼Q 0 T|0 T 0 T|0 T 0 T
√
SinceQ isconditionalGaussianN( α¯ x ,(1−α¯ )I ),itsnegativeconditionalentropyequals
T|0 T 0 T d
(cid:90)
d d
q (x |x )logq (x |x )dx = − − log(2π(1−α¯ ))
T|0 T 0 T|0 T 0 T 2 2 T
foranyx ∈ Rd. Ontheotherhand,sinceP = N(0,I ),
0 T d
d 1
E [logp (X )] = − log(2π)− E ∥X ∥2
X ∼Q T T X ∼Q T
T T 2 2 T T
where
E
X T∼Q T
∥X T∥2 = α¯ TE
X 0∼Q
0∥X 0∥2+(1−α¯ T)E
W¯ T∼N(0,I
d)(cid:13) (cid:13)W¯ T(cid:13) (cid:13)2
= α¯ E ∥X ∥2+(1−α¯ )d.
T X ∼Q 0 T
0 0
28Puttingthetwotogether,
(cid:20) (cid:21)
q (X )
E log T T = E [logq (X )]−E [logp (X )]
X ∼Q X ∼Q T T X ∼Q T T
T T p (X ) T T T T
T T
d d d 1 (cid:16) (cid:17)
≤ − − log(2π(1−α¯ ))+ log(2π)+ α¯ E ∥X ∥2+(1−α¯ )d
T T X ∼Q 0 T
2 2 2 2 0 0
1 dα¯ d
= α¯ E ∥X ∥2− T − log(1−α¯ ).
T X ∼Q 0 T
2 0 0 2 2
WhenT islarge(andthuswhenα¯ issmall),theTaylorexpansionw.r.t. α¯ around0yields
T T
log(1−α¯ ) = −α¯
+O(cid:0) α¯2(cid:1)
.
T T T
Therefore,
(cid:20) (cid:21)
E log q T(X T) ≤ 1 α¯ E ∥X ∥2− dα¯ T − d (−α¯ )+O(cid:0) α¯2(cid:1)
X T∼Q T p (X ) 2 T X 0∼Q 0 0 2 2 T T
T T
= 1 α¯ E ∥X ∥2+O(cid:0) α¯2(cid:1) .
2 T X 0∼Q 0 0 T
C.2 ProofofLemma4
NotethatbothP
t−1|t
andP(cid:98)t−1|t areGaussianwiththesamevariance. Thus,foreacht = 1,...,T,
log
p t−1|t(x t−1|x t)
=
α
t
(cid:16)
∥x −µ (x )∥2−∥x −µ (x
)∥2(cid:17)
t−1 (cid:98)t t t−1 t t
p (x |x ) 2(1−α )
(cid:98)t−1|t t−1 t t
α α
= t (x −µ (x ))⊺ (µ (x )−µ (x ))+ t ∥µ (x )−µ (x )∥2.
t−1 t t t t (cid:98)t t t t (cid:98)t t
(1−α ) 2(1−α )
t t
Forthefirsttermabove,
E [(X −µ (X ))⊺ (µ (X )−µ (X ))]
X ,X ∼Q t−1 t t t t (cid:98)t t
t t−1 t,t−1
= E (cid:2) (E [X |X ]−µ (X ))⊺ (µ (X )−µ (X ))(cid:3)
X ∼Q X ∼Q t−1 t t t t t (cid:98)t t
t t t−1 t−1|t
= E [(µ (X )−µ (X ))⊺ (µ (X )−µ (X ))] = 0
X ∼Q t t t t t t (cid:98)t t
t t
wherethelastlinefollowsfromLemma8. Thus,
(cid:88)T
E
(cid:20)
log
p t−1|t(X t−1|X t)(cid:21)
=
(cid:88)T α
t E ∥µ (X )−µ (X )∥2
X ,X ∼Q X ∼Q t t (cid:98)t t
t t−1 t,t−1 p (X |X ) 2(1−α ) t t
(cid:98)t−1|t t−1 t t
t=1 t=1
T
= (cid:88) 1−α tE ∥s (X )−∇logq (X )∥2
X ∼Q t t t t
2 t t
t=1
(i) logT (cid:88)T
≲ E ∥s (X )−∇logq (X )∥2
X ∼Q t t t t
T t t
t=1
(ii)
≤ (logT)ε2
where(i)followsbecause1−α ≲ logT/T,and(ii)holdsbyAssumption2. Theproofisnowcomplete.
t
C.3 ProofofLemma5
Weremindreadersthatthroughoutthisproofx isfixed(roughlyspeaking,likeaconstant). Wewanttoknow
t
howq (x |x )changeswithx givenfixedx . Beforewebeginthederivation,wefirstprovidesome
t−1|t t−1 t t−1 t
usefulequations:
(cid:32) (cid:33)
∥x −µ ∥2
t−1 t
p (x |x ) ∝ exp − , (28)
t−1|t t−1 t 2(1−α )/α
t t
29(cid:13) √ (cid:13)2 (cid:13) √ (cid:13)2
(cid:13)x t− α tx t−1(cid:13) (cid:13)x t−1−x t/ α t(cid:13)
= , (29)
2(1−α ) 2(1−α )/α
t t t
where∝meansproportionaltothechangeofx (forfixedx ),and
t−1 t
∥x t−1−µ t∥2−∥x t−1−x t/√ α t∥2 =(cid:13) (cid:13) (cid:13)x t−1− √x t + √x t −µ t(cid:13) (cid:13) (cid:13)2 −(cid:13) (cid:13) (cid:13)x t−1− √x t (cid:13) (cid:13) (cid:13)2
(cid:13) α α (cid:13) (cid:13) α (cid:13)
t t t
√ ⊺ √ (cid:13) (cid:13) x t (cid:13) (cid:13)2
=2(x t−1−x t/ α t) (x t/ α t−µ t)+(cid:13)√ −µ t(cid:13) , (30)
(cid:13) α (cid:13)
t
√ √
(x −x / α )⊺(x / α −µ ) √ √
t−1 t t t t t ⊺
=−(x −x / α ) α ∇logq (x ) (byEquation(3))
t−1 t t t t t
(1−α )/α
t t
√
⊺ ⊺
=− α x ∇logq (x )+x ∇logq (x ). (31)
t t−1 t t t t t
Nowwearereadytoinvestigateq (x |x ). ByBayes’rule,wehave
t−1|t t−1 t
q (x |x )
t−1|t t−1 t
q (x |x )q (x )
t|t−1 t t−1 t−1 t−1
=
q (x )
t t
∝ q (x )q (x |x )
t−1 t−1 t|t−1 t t−1
(again,∝meansproportionaltothechangeofx ;hereq (x )isomittedsincex isfixed)
t−1 t t t
(cid:32) (cid:13) √ (cid:13)2(cid:33)
(cid:13)x t− α tx t−1(cid:13)
∝ q (x )exp −
t−1 t−1
2(1−α )
t
(cid:32)
∥x t−1−µ
t∥2−(cid:13)
(cid:13)x t−1−x
t/√
α
t(cid:13) (cid:13)2(cid:33)
∝ q (x )p (x |x )exp (byEquations(28)and(29))
t−1 t−1 t−1|t t−1 t 2(1−α )/α
t t
√ √
(cid:18) (x −x / α )⊺(x / α −µ )(cid:19)
t−1 t t t t t
∝ q (x )p (x |x )exp (byEquation(30))
t−1 t−1 t−1|t t−1 t (1−α )/α
t t
√
(cid:0) ⊺ (cid:1)
∝ p (x |x )exp logq (x )− α x ∇logq (x ) (byEquation(31))
t−1|t t−1 t t−1 t−1 t t−1 t t
∝ p (x |x )exp(ζ (x ,x )),
t−1|t t−1 t t,t−1 t t−1
√ ⊺
whereζ (x ,x ) = logq (x )− α x ∇logq (x )+fn(x )andfn(x )canbesomearbitrary
t,t−1 t t−1 t−1 t−1 t t−1 t t t t
functionofx . Inotherwords,q isanexponentiallytiltedformofp withtiltingfactorζ (x ,x ).
t t−1|t ⊺√ t−1|t t,t−1 t t−1
Now,choosefn(x ) = −logq (µ )+µ α ∇logq (x )andwehave
t t−1 t t t t t
√
⊺
ζ (x ,x ) := logq (x )−logq (µ )−(x −µ ) ( α ∇logq (x )).
t,t−1 t t−1 t−1 t−1 t−1 t t−1 t t t t
Thus,forfixedx ,
t
p t−1|t(x t−1|x t)eζ t,t−1(x t,x t−1)
q (x |x ) = .
t−1|t t−1 t E
X ∼P
[eζ t,t−1(x t,X t−1)]
t−1 t−1|t
C.4 ProofofLemma6
√
Recall Equation (2). Let Q˜ denote the distribution of α¯ x , and let g(z) denote the p.d.f. (w.r.t. the
0 √ t 0
Lebesguemeasure)ofthedistributionof 1−α¯ w¯ . NotethatgisascaledversionoftheunitGaussianp.d.f.,
t t
(cid:82)
and g(z)dz = 1 < ∞. Now,foranyeventA ⊆ B(λ),
z∈Rd
(cid:90) (cid:90) (cid:90) (cid:18)(cid:90) (cid:19)
Q (A) = g(x−x˜ )dQ˜ (x˜ )dx = g(x−x˜ )dx dQ˜ (x˜ )
t 0 0 0 0 0 0
x∈A x˜ ∈Rd x˜ ∈Rd x∈A
0 0
30(cid:82)
byFubini’stheorem. IfAhasLebesguemeasure0,bycontinuityofg(x)weget g(x−x˜ )dx = 0,and
x∈A 0
thusQ (A) = 0. ThisshowsthatQ isabsolutelycontinuousw.r.t. theLebesguemeasure,anditsp.d.f. exists,
t t
denotedasq .
t
Now,sinceanyorderofderivativeoftheGaussianp.d.f. isboundedawayfrominfinityandQ˜ isaprobability
0
measure,wecaninvokethedominatedconvergencetheoremheretochangetheorderofderivativeandintegral
as
(cid:90) (cid:90)
∂kq (x) = ∂k g(x−x˜ )dQ˜ (x˜ ) = ∂kg(x−x˜ )dQ˜ (x˜ ). (32)
a t a 0 0 0 a 0 0 0
x˜ ∈Rd x˜ ∈Rd
0 0
Thus,foranyk ≥ 1andanyvectorofindicesa ∈ [d]k,wehave
(cid:12) (cid:12) (cid:12) (cid:12)(cid:90) (cid:12) (cid:12)
(cid:12)∂kq (x)(cid:12) ≤ sup (cid:12)∂kg(x)(cid:12) dQ˜ (x˜ ) = sup (cid:12)∂kg(x)(cid:12) < ∞.
(cid:12) a t (cid:12) (cid:12) a (cid:12) 0 0 (cid:12) a (cid:12)
x∈Rd x˜ ∈Rd x∈Rd
0
ThisalsoimpliesthattheTaylorterm|T (q ,x,µ)| < ∞foranyxandµ,and
k t
(cid:90) (cid:90) p
q (x) = g(x−x˜ )dQ˜ (x˜ ) ( =i) lim (cid:88) T (g(x−x˜ ),x,µ)dQ˜ (x˜ )
t 0 0 0 k 0 0 0
x˜ ∈Rd x˜ ∈Rdp→∞
0 0 k=0
(cid:90) p
( =ii) lim (cid:88) T (g(x−x˜ ),x,µ)dQ˜ (x˜ )
k 0 0 0
p→∞ x˜ ∈Rd
0 k=0
p
(iii) (cid:88)
= lim T (q ,x,µ)
k t
p→∞
k=0
where (i) follows because (scaled) Gaussian density is analytic, (ii) follows from dominated convergence
theoremandthefactthatg isaGaussiandensityandhasanupperboundindependentofx˜ ,and(iii)follows
0
from(32). Thisshowsthatq isanalytic.
t
Finally, since ∂klogq is a smooth function of q ,∂1q ,...,∂kq , we have ∂klogq (x ) < ∞ (possibly
a t t t t a t t
dependingonT)forallk ≥ 1andfixed(finite)x ∈ Rd. Also,logq isanalyticbecauselog(·)isanalyticand
t t
q (x ) > 0, ∀x ∈ Rd.
t t t
C.5 ProofofLemma7
RecalltheTaylorexpansionofζ from(21)andthatP = N(x ;µ ,σ2I ). Inotherwords,under
t,t−1 t−1|t t−1 t t d
P ,givenx ,Xi isconditionallyindependentofXj forany1 ≤ i,j ≤ dwithi ̸= j. Thus,usingthe
t−1|t t t−1 t−1
resultof(conditionallyindependent)Gaussianmoments,weobtain
E [(Xi −µi)p] = 0, ∀p ≥ 1odd
X t−1∼P t−1|t t−1 t
1−α
E [(Xi −µi)2] = t
X t−1∼P t−1|t t−1 t α
t
(cid:18)
1−α
(cid:19)2
E [(Xi −µi)4] = 3 t
X t−1∼P t−1|t t−1 t α
t
(cid:18)
1−α
(cid:19)2
E [(Xi −µi)2(Xj −µj)2] = t
X t−1∼P t−1|t t−1 t t−1 t α
t
 
E X t−1∼P t−1|t 

(cid:89) (X ti −1−µi t) 

≍
(cid:18)
1−
α
tα
t(cid:19)p/2
, ∀p ≥ 2even. (33)
i∈a
s.t.a∈[d]p
31Therefore,followingfrom(21),foranyfixedx ,
t
d
E [ζ ] ( =i) 1 (cid:88) ∂2 logq (µ )E (Xi −µi)2
X t−1∼P t−1|t t,t−1 2 ii t−1 t X t−1∼P t−1|t t−1 t
i=1
d
1 (cid:88)
+ ∂4 logq (µ )E (Xi −µi)4
4! iiii t−1 t X t−1∼P t−1|t t−1 t
i=1
d
1 (cid:88)
+ ∂4 logq (µ )E (Xi −µi)2(Xj −µj)2
4! iijj t−1 t X t−1∼P t−1|t t−1 t t−1 t
i,j=1
i̸=j
∞
(cid:88)
+ E [T (logq ,X ,µ )]
X ∼P p t−1 t−1 t
t−1 t−1|t
p=6
( =ii) 1
(cid:88)d
∂2 logq (µ
)(cid:18)
1−α
t(cid:19)
+ 1
(cid:88)d
∂4 logq (µ
)(cid:18)
1−α
t(cid:19)2
2 ii t−1 t α 8 iiii t−1 t α
t t
i=1 i=1
(cid:32) (cid:33)
+
1
(cid:88)d
∂4 logq (µ
)(cid:18)
1−α
t(cid:19)2
+O
(cid:18)
1−α
t(cid:19)3
.
4! iijj t−1 t α α
t t
i,j=1
i̸=j
(cid:12) (cid:12)
Here (ii) follows from Assumption 4 and because (cid:12)∂ aklogq t−1(x)(cid:12)(∀a : |a| = k) admits an upper bound
U (x)whichisindependentofT forallk ≥ 1andx ∈ Rd. Wenowexplainstep(i)below. Sincelogq is
k t−1
analytic,allitspartialderivativesexist. Itremainstoshowthattheinfinitesumandtheexpectationcanbe
exchanged. Thisfollowsbecause
(cid:12)  (cid:12)
(cid:12) k (cid:12)
lim (cid:12) (cid:12)E X ∼P [ζ t,t−1]−E X ∼P (cid:88) T p(logq t−1,X t−1,µ t)(cid:12) (cid:12)
k→∞(cid:12) t−1 t−1|t t−1 t−1|t (cid:12)
(cid:12) p=2 (cid:12)
(cid:12) (cid:12)
(cid:12) k (cid:12)
≤ lim E X ∼P (cid:12) (cid:12)ζ t,t−1−(cid:88) T p(logq t−1,X t−1,µ t)(cid:12) (cid:12)
k→∞ t−1 t−1|t(cid:12) (cid:12)
(cid:12) p=2 (cid:12)
 
∞
(cid:88)
≤ lim E X ∼P  |T p(logq t−1,X t−1,µ t)|
k→∞ t−1 t−1|t
p=k+1
 
∞
(i =ii) E X ∼P  lim (cid:88) |T p(logq t−1,X t−1,µ t)| ( =iv) 0.
t−1 t−1|t k→∞
p=k+1
Here both (iii) and (iv) are because of the following. Under Assumption 4, for any x , µ , and T, the
t−1 t
infinitesumisconvergent:
(cid:88)∞ (cid:88)∞ dp
|T (logq ,x ,µ )| ≤ U (µ )|x −µ |p < ∞.
p t−1 t−1 t p t t−1 t
p!
p=1 p=1
Thus,(iv)directlyfollows. Thisalsoimpliesthatforanyϵ > 0thereexistssomelargeenoughk suchthat
ϵ
∞ k
(cid:88) (cid:88)ϵ
|T (logq ,x ,µ )| ≤ |T (logq ,x ,µ )|+ϵ.
p t−1 t−1 t p t−1 t−1 t
p=1 p=1
32(cid:104) (cid:105)
ThisshowsthatE (cid:80)∞ |T (logq ,x ,µ )| < ∞sinceallcentralizedmomentsexistunder
X t−1∼P t−1|t p=1 p t−1 t−1 t
Gaussiandistribution. Thus,(iii)immediatelyfollowsfromthedominatedconvergencetheorem,and(i)is
(cid:16) (cid:17)p
established. Theproofiscompletesince 1− αα t = O((1−α t)p), ∀p ≥ 1by(22).
t
C.6 ProofofLemma8
(cid:16) √ (cid:17)
Notethatq (x |x ) = 1 exp −∥x t− α tx t−1∥2 . FollowingfromtheideaofTweedie[38],
t|t−1 t t−1 (2π(1−α ))d/2 2(1−α )
t t
wehave
q (x )
t−1 t−1
q (x |x ) = q (x |x )
t−1|t t−1 t q (x ) t|t−1 t t−1
t t
√
(cid:18) (cid:19)
q (x ) α α
= t−1 t−1 q (x |0)exp t x⊺ x − t ∥x ∥2
q (x ) t|t−1 t 1−α t t−1 2(1−α ) t−1
t t t t
√
(cid:18) (cid:19)
(cid:16) − αt ∥x ∥2(cid:17) α t ⊺
= q t−1(x t−1)e 2(1−αt) t−1 exp
1−α
x tx t−1−logq t(x t)+logq t|t−1(x t|0)
t
(cid:0) ⊺ (cid:1)
=: f(x )exp x x˜ −κ(x˜ ) (34)
t−1 t−1 t t
wherewehaveusedthedefinitionsofx˜ andκ(x˜ )in(23). Thisshowsthatx isaconditionalexponential
t t t−1
familygivenx˜ . Thus,thefirstmomentcanbefoundas(cf. Prop.11.1in[46])
t
(cid:90) (cid:90)
(cid:0) ⊺ (cid:1)
0 = ∇ q (x |x )dx = ∇ f(x )exp x x˜ −κ(x˜ ) dx
x˜ t t−1|t t−1 t t−1 x˜ t t−1 t−1 t t t−1
(cid:90)
(cid:0) ⊺ (cid:1)
= f(x )∇ exp x x˜ −κ(x˜ ) dx
t−1 x˜ t t−1 t t t−1
(cid:90)
(cid:0) ⊺ (cid:1)
= f(x )exp x x˜ −κ(x˜ ) (x −∇ κ(x˜ ))dx
t−1 t−1 t t t−1 x˜ t t t−1
(cid:90)
(cid:0) ⊺ (cid:1)
= f(x )exp x x˜ −κ(x˜ ) x dx −∇ κ(x˜ )
t−1 t−1 t t t−1 t−1 x˜ t t
whichimpliesthat
E [X ] = ∇κ. (35)
X ∼Q t−1
t−1 t−1|t
Forthesecondmoment,
(cid:90)
0 = ∂2 q (x |x )dx
ij t−1|t t−1 t t−1
= (cid:90) f(x ) ∂ (cid:16) exp(cid:0) x⊺ x˜ −κ(x˜ )(cid:1)(cid:0) xi −∂ κ(x˜ )(cid:1)(cid:17) dx
t−1 ∂x˜j t−1 t t t−1 i t t−1
t
(cid:90) (cid:16) (cid:17)
= f(x )exp(cid:0) x⊺ x˜ −κ(x˜ )(cid:1) (xi −∂ κ(x˜ ))(xj −∂ κ(x˜ ))−∂2κ(x˜ ) dx
t−1 t−1 t t t−1 i t t−1 j t ij t t−1
whichyields
1−α (1−α )2
E [(X −µ )(X −µ )⊺ ] = ∇2κ = t I + t ∇2logq (x ). (36)
X ∼Q t−1 t t−1 t d t t
t−1 t−1|t α α
t t
Below, we write x = x and κ = κ(x˜ ) for brevity. We remind readers that all derivatives are w.r.t. x˜
t−1 t t
insteadofx = x . Forthethirdmoment,
t−1
(cid:90) (cid:90)
0 = ∂3 q dx =: f(x)exp(x⊺ x˜ −κ)D (x,x˜ )dx
ijk t−1|t t 3 t
33where
(cid:16) (cid:17)
D (x,x˜ ) = exp(−x⊺ x˜ +κ)∂ exp(x⊺ x˜ −κ)(cid:0) (xi−∂ κ)(xj −∂ κ)−∂2κ(cid:1)
3 t t k t i j ij
= (xk −∂ κ)(cid:0) (xi−∂ κ)(xj −∂ κ)−∂2κ(cid:1)
k i j ij
+(−∂2 κ)(xj −∂ κ)+(−∂2 κ)(xi−∂ κ)−∂3 κ. (37)
ik j jk i ijk
Now,foranyfunctionfn(x˜ )and1 ≤ i ≤ d,
t
(cid:90)
f(x)exp(x⊺ x˜ −κ)fn(x˜ )(xi−∂ κ)dx = 0
t t i
bythefirstmomentresult(35). Thus,weget
(cid:104) (cid:105)
E (Xi −µi)(Xj −µj)(Xk −µk) = ∂3 κ.
X t−1∼Q t−1|t t−1 t t−1 t t−1 t ijk
Forthefourthmoment,wehave
(cid:90) (cid:90)
0 = ∂4 q dx =: f(x)exp(x⊺ x˜ −κ)D (x,x˜ )dx
ijkl t−1|t t 4 t
where
(cid:16)
D (x,x˜ ) = exp(−x⊺ x˜ +κ)∂ exp(x⊺ x˜ −κ)((xi−∂ κ)(xj −∂ κ)(xk −∂ κ)
4 t t l t i j k
(cid:17)
−∂2κ(xk −∂ κ)−∂2 κ(xj −∂ κ)−∂2 κ(xi−∂ κ)−∂3 κ)
ij k ik j jk i ijk
(cid:16) (cid:17)
= (xi−∂ κ)(xj −∂ κ)(xk −∂ κ)(xl −∂ κ)+∂ (xi−∂ κ)(xj −∂ κ)(xk −∂ κ)
i j k l l i j k
−∂2κ(xk −∂ κ)(xl −∂ κ)−∂3 κ(xk −∂ κ)+∂2κ∂2κ
ij k l ijl k ij kl
−∂2 κ(xj −∂ κ)(xl −∂ κ)−∂3 κ(xj −∂ κ)+∂2 κ∂2κ
ik j l ikl j ik jl
−∂2 κ(xi−∂ κ)(xl −∂ κ)−∂3 κ(xi−∂ κ)+∂2 κ∂2κ
jk i l jkl i jk il
−∂3 κ(xl −∂ κ)−∂4 κ (38)
ijk l ijkl
and
(cid:16) (cid:17)
∂ (xi−∂ κ)(xj −∂ κ)(xk −∂ κ)
l i j k
= −∂2κ(xj −∂ κ)(xk −∂ κ)−∂2κ(xi−∂ κ)(xk −∂ κ)−∂2κ(xi−∂ κ)(xj −∂ κ).
il j k jl i k kl i j
Usingthefirstandsecondmomentresultsin(35)and(36),weget
(cid:104) (cid:105)
E (Xi −µi)(Xj −µj)(Xk −µk)(Xl −µl) =
X t−1∼Q t−1|t t−1 t t−1 t t−1 t t−1 t
(∂2κ)(∂2κ)+(∂2 κ)(∂2κ)+(∂2κ)(∂2 κ)+∂4 κ.
ij kl ik jl il jk ijkl
Andthefourthmomentresultfollowsdirectlybyapplying(36)toeachoftheterms.
C.7 ProofofLemma9
Wefirstintroducesomenotationsusedintheproof. Wewritex = x andκ = κ(x˜ ). Givenasetofindices
t−1 t
A,defineitsbipartitionas
bipart(A) := {(B,C) : A = B⊔C}
where B and C are both sets of indices (and therefore the order of indices within each of B and C does
not matter). Here ⊔ refers to the disjoint union of the two sets (which is only defined when the two
sets are disjoint). Next, given a set B, define allpart (B) as a set containing all partitions of B such
≥2
34that there are at least 2 elements in each part of the partition. As an example, allpart ({1,2,3,4}) =
≥2
{{{1,2},{3,4}},{{1,3},{2,4}},{{1,4},{2,3}},and{{1},{2,3,4}} ∈/ allpart ({1,2,3,4})despitethe
≥2
factthatitisavalidpartition. Foreachpartitionb ∈ allpart (B),define
≥2
(cid:89)
∂ κ := ∂|ξ|κ.
b a
ξ
ξ∈b
Herenotethatξ isalsoaset,and∂ κiswelldefinedsincetheorderofindicestotakepartialderivativewith
b
doesnotmatter. Define
D (x,x˜ ) := 1
0 t
(cid:16) (cid:17)
⊺ ⊺
D (x,x˜ ) := exp(−x x˜ +κ)∂ exp(x x˜ −κ)D (x,x˜ )
p t t a t p−1 t
p
forallp ≥ 1. Weagainremindreadersthatallderivativesarew.r.t. x˜ insteadofx = x .
t t−1
Byworkingoutthederivative,adirectimplicationofthedefinitionofD isarecursiverelationship:
p
D p(x,x˜ t) = (xa p −∂ a κ)D p−1(x,x˜ t)+∂ a D p−1(x,x˜ t).
p p
Also,ifweunrolltherecursionofD ,weget
p
(cid:16) (cid:17)
⊺ ⊺
D (x,x˜ ) = exp(−x x˜ +κ)∂ exp(x x˜ −κ)D (x,x˜ )
p t t a t p−1 t
p
(cid:16) (cid:16) (cid:17)(cid:17)
⊺ ⊺ ⊺ ⊺
= exp(−x x˜ +κ)∂ exp(x x˜ −κ)exp(−x x˜ +κ)∂ exp(x x˜ −κ)D (x,x˜ )
t a t t a t p−2 t
p p−1
(cid:16) (cid:17)
= exp(−x⊺ x˜ +κ)∂2 exp(x⊺ x˜ −κ)D (x,x˜ )
t a ,a t p−2 t
p p−1
(cid:16) (cid:17)
= exp(−x⊺ x˜ +κ)∂p exp(x⊺ x˜ −κ)
t a ,...,a t
p 1
andthus
(cid:90) (cid:90) (cid:16) (cid:17)
0 = ∂p q dx = f(x)∂p exp(x⊺ x˜ −κ) dx
a ,...,a t−1|t a ,...,a t
1 p 1 p
(cid:90)
⊺
= f(x)exp(x x˜ −κ)D (x,x˜ )dx (39)
t p t
wherewerecallthedefinitionoff(x)backin(34).
Inthefollowing,wepresenttheentireproofintotwoparts. Inpart1,weinductivelyshowthateachD (x,x˜ )
p t
satisfiesaparticularpolynomialform. Inpart2,weinductivelyshowthatthispolynomialformresultsinthe
desiredrates.
Part1oftheproofofLemma9: ThefirststeptowardprovingthedesiredresultsistoobtaintheformofD
p
forallp ≥ 2. Now,weaimtoshowinductivelythat
p
(cid:89) (cid:88) (cid:88) (cid:89)
D p(x,x˜ t) = (xa i −∂ a κ)− d p(b,C)(∂ bκ) (xa c −∂ a κ) (40)
i c
i=1 (B,C)∈bipart([p])b∈allpart (B) c∈C
≥2
where d (b,C) is a constant from combinatorics, which is possibly 0 and which only depends on p. From
p
Lemma8,thebasescaseshavebeenestablishedthat(cf. (37)and(38))
D (x,x˜ ) = (xi−∂ κ)(xj −∂ κ)−∂2κ
2 t i j ij
D (x,x˜ ) = (xi−∂ κ)(xj −∂ κ)(xk −∂ κ)
3 t i j k
−∂2κ(xk −∂ κ)−∂2 κ(xj −∂ κ)−∂2 κ(xi−∂ κ)−∂3 κ
ij k ik j jk i ijk
35D (x,x˜ ) = (xi−∂ κ)(xj −∂ κ)(xk −∂ κ)(xl −∂ κ)
4 t i j k l
−∂2κ(xk −∂ κ)(xl −∂ κ)−∂2 κ(xj −∂ κ)(xl −∂ κ)−∂2 κ(xi−∂ κ)(xl −∂ κ)
ij k l ik j l jk i l
+∂ ((xi−∂ κ)(xj −∂ κ)(xk −∂ κ))−∂3 κ(xl −∂ κ)−∂3 (xk −∂ κ)
l i j k ijk l ijl k
−∂3 (xj −∂ κ)−∂3 (xi−∂ κ)+∂2κ∂2κ+∂2 κ∂2κ+∂2 κ∂2κ−∂4 κ.
ikl j jkl i ij kl ik jl jk il ijkl
Inparticular,eachtermofD p (p = 2,3,4)isintheformofeither(cid:81)p i=1(xa i −∂ a iκ)or(∂ bκ)(cid:81) c∈C(xa c −
∂ κ),where|ξ| ≥ 2, ∀ξ ∈ b,and(⊔ ξ)⊔C = [p]. Therefore,D ,D ,D allsatisfythehypothesis(40).
a ξ∈b 2 3 4
c
Turningtotheinductivestep,wesupposethatD satisfies(40),i.e.,
k
k
(cid:89) (cid:88) (cid:88) (cid:89)
D k(x,x˜ t) = (xa i −∂ a κ)− d k(b,C)(∂ bκ) (xa c −∂ a κ).
i c
i=1 (B,C)∈bipart([k])b∈allpart (B) c∈C
≥2
Then,usingtherecursiverelationship,wehave
D (x,x˜ )
k+1 t
= (xa k+1 −∂ a κ)D k(x,x˜ t)+∂ a D k(x,x˜ t)
k+1 k+1
k+1
(cid:89) (cid:88) (cid:88) (cid:89)
= (xa i −∂ a κ)− d k(b,C)(∂ bκ) (xa c −∂ a κ)(xa k+1 −∂ a κ)
i c k+1
i=1 (B,C)∈bipart([k])b∈allpart (B) c∈C
(cid:124) (cid:123)(cid:122) (cid:125) ≥2
(cid:124) (cid:123)(cid:122) (cid:125)
T
1 T
2
(cid:32) (cid:33) (cid:32) (cid:33)
k
(cid:89) (cid:88) (cid:88) (cid:89)
−∂ a − (xa i −∂ a κ) − d k(b,C)(∂ bκ) ∂ a (xa c −∂ a κ)
k+1 i k+1 c
i=1 (B,C)∈bipart([k])b∈allpart (B) c∈C
(cid:124) (cid:123)(cid:122) (cid:125) ≥2
(cid:124) (cid:123)(cid:122) (cid:125)
T
3 T
4
− (cid:88) (cid:88) d k(b,C)(cid:0) ∂ a (∂ bκ)(cid:1)(cid:89) (xa c −∂ a κ)
k+1 c
(B,C)∈bipart([k])b∈allpart (B) c∈C
≥2
(cid:124) (cid:123)(cid:122) (cid:125)
T
5
= T −T −T −T −T
1 2 3 4 5
wherewedefineeachtermasT ,...,T . Nowwediscussthesetermsseparately:
1 5
1. T 1 (andonlyT 1)isintheform(cid:81) ik =+ 11(xa i −∂ a iκ).
2. T 2isasummationofindividualterms: (∂ bκ)(cid:81) c∈C(xa c−∂
a
cκ)(xa k+1−∂
a
k+1κ). Hereb ∈ allpart ≥2(B)
and (B,C) ∈ bipart([k]). Thus, by definition of bipart and allpart , for each ξ ∈ b, |ξ| ≥ 2 and
≥2
(⊔ ξ)⊔C = [k]. Therefore,k+1 ∈/ B⊔C and
ξ∈b
(⊔ ξ)⊔C ⊔{k+1} = [k]⊔{k+1} = [k+1].
ξ∈b
This implies that each individual term of T is in the form of (∂ κ)(cid:81) (xc − ∂ κ) where b ∈
2 b c∈C c
2
allpart (B ),suchthatB := B andC := C ⊔{k+1}. HereC iswelldefinedbecausek+1 ∈/ C.
≥2 2 2 2 2
Since(B ,C ) ∈ bipart([k+1]),
2 2
(cid:88) (cid:88) (cid:89)
T 2 = d 2(b,C)(∂ bκ) (xa c −∂ a κ)
c
(B,C)∈bipart([k+1])b∈allpart (B) c∈C
≥2
forsomeconstantd (b,C).
2
363. T 3 is the derivative of product, which is a summation of individual terms: (∂ a2 ,a κ)(cid:81)d i=1(xa i −
j k+1 i̸=j
∂
a
iκ), j = 1,...,k. Therefore,foreachj = 1,...,k,eachtermisoftheform(∂ bκ)(cid:81)
c∈C
3(xa c−∂
a
cκ)
where b ∈ allpart (B ), such that B := {j,k + 1} and C := [k] \ {j}. Since (B ,C ) ∈
≥2 3 3 3 3 3
bipart([k+1]),
(cid:88) (cid:88) (cid:89)
T 3 = d 3(b,C)(∂ bκ) (xa c −∂ a κ)
c
(B,C)∈bipart([k+1])b∈allpart (B) c∈C
≥2
forsomeconstantd (b,C).
3
4. T 4 isasummationofindividualterms: (∂ bκ)(cid:0) ∂ a k+1(cid:81) c∈C(xa c −∂ a cκ)(cid:1) whereb ∈ allpart ≥2(B)and
(B,C) ∈ bipart([k]). Now,
(cid:32) (cid:33)
(cid:89) (cid:89)
(∂ bκ) ∂ a k+1 (xa c −∂ a cκ) = −(∂ bκ)(∂ a2 j,a k+1κ) (xa i −∂ a iκ)
c∈C i∈C
i̸=c
(cid:89)
= −(∂ b κ) (xa i −∂ a κ)
4 i
i∈C
4
where b := b⊔{k+1,c} and C := C \{c}. Here b is well defined because k+1,c ∈/ b. Define
4 4 4
B := [k+1]\C ,andwehaveb ∈ allpart (B ). Since(B ,C )isavalidpartitionof[k+1],we
4 4 4 ≥2 4 4 4
have
(cid:88) (cid:88) (cid:89)
T 4 = d 4(b,C)(∂ bκ) (xa c −∂ a κ)
c
(B,C)∈bipart([k+1])b∈allpart (B) c∈C
≥2
forsomeconstantd (b,C).
4
5. T 5 isasummationofindividualterms: (cid:0) ∂ a k+1(∂ bκ)(cid:1)(cid:81) c∈C(xa c −∂ a cκ),whereb ∈ allpart ≥2(B)and
(B,C) ∈ bipart([k]). Fromdefinitionof∂ κ,
b
 
(cid:89) (cid:88)(cid:16) (cid:17)(cid:89) (cid:88)
∂ a k+1(∂ bκ) = ∂ a k+1 ∂ a|ξ ξ|κ = ∂ a|ξ ξ| ,+ a k1 +1κ ∂ a|ζ ζ|κ = ∂ b ξκ
ξ∈b ξ∈b ζ∈b ξ∈b
ζ̸=ξ
where,foreachξ ∈ b,wehavedefinedanewpartitionb suchthatk+1isaddedtotheξ inthepartition
ξ
b. Formally,defineb := b\ξ⊔{ξ⊔{k+1}},whichiswelldefinedbecauseξ ∈/ (b\ξ)andk+1 ∈/ B.
ξ
DefineB := B ⊔{k+1}andC := C, andnotethat(B ,C )isavalidpartitionof[k+1]. Since
5 5 5 5
|ζ| ≥ 2, ∀ζ ∈ b,wehave|ζ′| ≥ 2, ∀ζ′ ∈ b . Sinceb ∈ allpart (B),wehaveb ∈ allpart (B )for
ξ ≥2 ξ ≥2 5
allξ ∈ b. Therefore,foranyfixedC(= C )
5
(cid:88) (cid:0) (cid:1) (cid:88) (cid:88)
d (b,C) ∂ (∂ κ) = d (b,C)∂ κ
k a b k b
k+1 ξ
b∈allpart (B) b∈allpart (B) ξ∈b
≥2 ≥2
(cid:88)
= d (b ,C)∂ κ
5 5 b
5
b ∈allpart (B )
5 ≥2 5
forsomeconstantd (b ,C),andthus
5 5
(cid:88) (cid:88) (cid:89)
T 5 = d 5(b,C)(∂ bκ) (xa c −∂ a κ).
c
(B,C)∈bipart([k+1])b∈allpart (B) c∈C
≥2
Finally,letting
5
(cid:88)
d (b,C) := d (b,C)
k+1 j
j=2
37foreachb ∈ allpart (B)andC suchthat(B,C) ∈ bipart([k+1]),wehaveshownthatifD (x,x˜ )isin
≥2 k t
theformof(40),D (x,x˜ )isalsointhisform. Thus,claim(40)isvalidforallp ≥ 2.
k+1 t
Part 2 of the proof of Lemma 9: First, we remind readers of the definition of κ(x˜ ) in (23). Note that
t
∇κ = µ fromdirectdifferentiation. From(39)and(40),forfixedx ,wehave
t t
(cid:34) p (cid:35)
(cid:89)
E (Xa i −µa i)
X t−1∼Q t−1|t t−1 t
i=1
 
(cid:34) (cid:35)
= O 

sup ∂ bκ(x˜ t)E X t−1∼Q
t−1|t
(cid:89) (X ta −c 1−µa tc)  

(B,C)∈bipart([p])
c∈C
b∈allpart (B)
≥2
(cid:32) (cid:32) (cid:33) (cid:34) (cid:35)(cid:33)
(cid:89)
= O sup sup ∂ bκ(x˜ t) E
X t−1∼Q
t−1|t
(X ta −c 1−µa tc) . (41)
(B,C)∈bipart([p]) b∈allpart (B)
≥2 c∈C
Wefirstconsiderthetermsup ∂ κ(x˜ ). Givenapartitionb ∈ allpart (B),directdifferentiation
b∈allpart (B) b t ≥2
≥2
yields
1−α (1−α )2
∂|ξ|κ = t + t ∂2 logq (x ) = O(1−α ), if |ξ| = 2andξ = ξ
a ξ α α a ξ t t t 1 2
t t
(1−α )|ξ|
∂|ξ|κ = t ∂|ξ| logq (x ) = O((1−α )|ξ|), forallotherξ.
a ξ α|ξ|/2 ξ t t t
t
(cid:81) |ξ|
Since by definition ∂ κ = ∂ κ and ⊔ ξ = B, the slowest rate of ∂ κ (as a function of B) is
b ξ∈b a ξ ξ∈b b
determinedbythepartitionbcontainingthemostnumberofequalpairs. Theslowestrateis
(cid:40) O(cid:0) (1−α )(|B|−1)/2(1−α )3(cid:1) = O(cid:0) (1−α )(|B|+5)/2(cid:1) if |B|isodd
t t t
sup ∂ κ(x˜ ) =
b t O(cid:0)
(1−α
)|B|/2(cid:1)
if |B|iseven
b∈allpart (B) t
≥2
To proceed, we will again use induction to find the overall rate. From Lemma 8, base cases have been
establishedthat
(cid:34) (cid:35)
2
(cid:89)
E
X t−1∼Q
t−1|t
(X ta −i 1−µa ti) = O(1−α t), ∀a ∈ [d]2
i=1
(cid:34) (cid:35)
3
E
X t−1∼Q
t−1|t
(cid:89) (X ta −i 1−µa ti) = O(cid:0) (1−α t)3(cid:1) , ∀a ∈ [d]3
i=1
(cid:34) (cid:35)
4
E
X t−1∼Q
t−1|t
(cid:89) (X ta −i 1−µa ti) = O(cid:0) (1−α t)2(cid:1) , ∀a ∈ [d]4.
i=1
Theseratessatisfy(24)and(25)whenp = 2,3,4. Nowweturntotheinductivestep. Supposek ≥ 4iseven.
Forpurposeofinduction,suppose(24)and(25)holdforallp = 2,...,k. Then,following(41),forp = k+1
(oddnumber),wehave
(cid:34) (cid:35)
k+1
(cid:89)
E (Xa i −µa i)
X t−1∼Q t−1|t t−1 t
i=1
38 
= O sup (1−α )(|B|+5)/2(1−α )|C|/2+ sup (1−α )|B|/2(1−α )(|C|+3)/2
 t t t t 
(B,C)∈bipart([k+1]) (B,C)∈bipart([k+1])
|B|odd,|C|even |B|even,|C|odd
(cid:16) (cid:17)
= O (1−α )(k+1)/2+5/2+(1−α )(k+1)/2+3/2
t t
(cid:16) (cid:17)
= O (1−α )(k+1)/2+3/2 .
t
Then,forp = k+2(evennumber),wehave
(cid:34) (cid:35)
k+2
(cid:89)
E (Xa i −µa i)
X t−1∼Q t−1|t t−1 t
i=1
 
= O sup (1−α )(|B|+5)/2(1−α )(|C|+3)/2+ sup (1−α )|B|/2(1−α )|C|/2
 t t t t 
(B,C)∈bipart([k+2]) (B,C)∈bipart([k+1])
|B|odd,|C|odd |B|even,|C|even
(cid:16) (cid:17)
= O (1−α )(k+2)/2+4+(1−α )(k+2)/2
t t
(cid:16) (cid:17)
= O (1−α )(k+2)/2 .
t
Theseshowthevalidityoftheclaims(24)and(25). Theproofisnowcomplete.
C.8 ProofofLemma11
√
Fix t ≥ 1 and x ∈ Rd. We write g(x ) = ∇logq (µ )− α ∇logq (x ) for brevity, and from (6) we
t t t−1 t t t t
have∥g(x )∥2 = O(1−α )foranyfixedx . Theexchangeoftheinfinitesumandtheexpectationisagain
t t t
guaranteedbyAssumption4. From(21)and(33),itcanbeverifiedthattheexpectedsecondmomentis
(cid:104) (cid:105)
E [ζ2 ] = E (T +T +T )2 +O(σ6)
X t−1∼P t−1|t t,t−1 X t−1∼P t−1|t 1 2 3 t
= E (cid:2) T2(cid:3) +E [T T ]+E (cid:2) T2(cid:3) +O(σ6)
X t−1∼P t−1|t 1 X t−1∼P t−1|t 1 3 X t−1∼P t−1|t 2 t
d (cid:18) (cid:19)
= σ2∥g(x )∥2+3σ4(cid:88) 1 (cid:0) ∂2 logq (µ )(cid:1)2 + 1 gi(x )∂3 logq (µ )
t t t 4 ii t−1 t 3 t iii t−1 t
i=1
d (cid:18)
+σ4 (cid:88) 1 (cid:0) ∂2 logq (µ )(cid:1)(cid:0) ∂2 logq (µ )(cid:1) + 1 (cid:0) ∂2 logq (µ )(cid:1)2
t 4 ii t−1 t jj t−1 t 2 ij t−1 t
i,j=1
i̸=j
(cid:19)
+gi(x )∂3 logq (µ ) +O(σ6). (42)
t ijj t−1 t t
Sinceσ2 = (1−α )/α andsinceallpartialderivativesarewellcontrolledaccordingtoAssumption4,we
t t t
immediatelygetE [ζ2 ] = O(cid:0) (1−α )2(cid:1) fortheexpectedsecondmoment.
X t−1∼P t−1|t t,t−1 t
Theexpectedthirdmomentis
(cid:104) (cid:105)
E [ζ3 ] = E (T +T +T )3 +O(σ6)
X t−1∼P t−1|t t,t−1 X t−1∼P t−1|t 1 2 3 t
= 3E (cid:2) T2T (cid:3) +O(σ6)
X t−1∼P t−1|t 1 2 t
d d
(cid:88) 3 (cid:88)
= 3σ4 (gi(x ))2(∂2 logq (µ ))+3σ4 (gi(x ))(gj(x ))(∂2 logq (µ ))
t 2 t ii t−1 t t t t ij t−1 t
i=1 i,j=1
i̸=j
39d
(cid:88) 3
+σ4 (gi(x ))2(∂2 logq (µ ))+O(σ6). (43)
t 2 t jj t−1 t t
i,j=1
i̸=j
Now,byCauchy-Schwartzinequalityweget
(cid:12) (cid:12)
d
(cid:12) (cid:12) (cid:12)(cid:88) (gi(x t))2(∂ i2 ilogq t−1(µ t))(cid:12) (cid:12)
(cid:12)
≤ ∥g(x t)∥2 4(cid:13) (cid:13)diag(∇2logq t−1(µ t))(cid:13) (cid:13)
(cid:12) (cid:12)
i=1
≤ ∥g(x t)∥2(cid:13) (cid:13)diag(∇2logq t−1(µ t))(cid:13) (cid:13) = O(1−α t)
d
(cid:88)
(gi(x ))(gj(x ))(∂2 logq (µ ))
t t ij t−1 t
i,j=1
i̸=j
d d
(cid:88) (cid:88)
= (gi(x ))(gj(x ))(∂2 logq (µ ))− (gi(x ))2(∂2 logq (µ ))
t t ij t−1 t t ii t−1 t
i,j=1 i=1
≤ (cid:13) (cid:13)∇2logq t−1(µ t)(cid:13) (cid:13)∥g(x t)∥2+O(1−α t) = O(1−α t)
d d d
(cid:88) (cid:88) (cid:88)
(gi(x ))2(∂2 logq (µ )) = (gi(x ))2(∂2 logq (µ ))− (gi(x ))2(∂2 logq (µ ))
t jj t−1 t t jj t−1 t t ii t−1 t
i,j=1 i,j=1 i=1
i̸=j
≤ ∥g(x t)∥2(cid:12) (cid:12)Tr(∇2logq t−1(µ t))(cid:12) (cid:12)+O(1−α t) = O(1−α t)
where diag(A) is a vector of the diagonal elements of matrix A. Under Assumption 4, we obtain
E [ζ3 ] = O(cid:0) (1−α )3(cid:1) fortheexpectedthirdmomentfort ≥ 1.
X t−1∼P t−1|t t,t−1 t
C.9 ProofofLemma12
From(1),theforwardprocessatthefirststepis
√ √
x = α x + 1−α w
1 1 0 1 1
wherew ∼ N(0,I )isindependentofQ . Thus,
1 d 0
E
X 1∼Q 1,X 0∼Q
0∥X 1−X 0∥2 = E
W 1∼N(0,I d),X 0∼Q
0(cid:13) (cid:13)√ 1−α 1W 1+(√ α t−1)X 0(cid:13) (cid:13)2
( =i) E
W 1∼N(0,I
d)(cid:13) (cid:13)√ 1−α 1W 1(cid:13) (cid:13)2 +E
X 0∼Q
0∥(√ α t−1)X 0∥2
(ii) √
≤ (1−α )d+( α −1)2M d
1 1 2
(iii)
≤ (1−α )(M +1)d
1 2
√
where(i)followsfromindependence,(ii)followsfromAssumption1,and(iii)followsbecause( z−1)2 ≤
1−z for all z ∈ [0,1]. The proof is complete since W (Q ,Q )2 ≤ E ∥X −X ∥2 by the
2 0 1 X ∼Q ,X ∼Q 1 0
1 1 0 0
definitionofWasserstein-2distance.
D Proof of Theorems 2 and 3
Inthissection,weinstantiateTheorem1(alongwithitscorollaries)toprovideupperboundsthathaveexplicit
parameterdependenceforanumberofinterestingdistributionclasses. Inordertoobtainanupperboundthat
explicitlydependsonsystemparameters,weneedonlytoprovideanexplicitboundonthereverse-steperror,
whichisthemaintopicthatweaddressinthefollowingsubsections.
40D.1 ProofofTheorem2
Wefirstestablishausefulresultunderthedistributionclassin(7). Considery = x+ξuwhereu ∈ Rdsatisfies
∥u∥2 = 1andξ ∈ Rissomesmallconstant. Withsomex∗ = γx+(1−γ)y whereγ ∈ (0,1),wehave
∇logq (y)−∇logq (x) = ∇2logq (x∗)(y−x) = ξ∇2logq (x∗)u
t t t t
=⇒ (cid:13) (cid:13)ξ∇2logq t(x∗)u(cid:13) (cid:13) = ∥∇logq t(y)−∇logq t(x)∥ ≤ L∥y−x∥ = Lξ∥u∥.
Thus, taking the limit of ξ to 0, by continuity of ∇2logq (x), we get ∥∇logq (x)u∥ ≤ L∥u∥. Since u is
t t
an arbitrary unit vector, this implies that all absolute eigenvalues of ∇2logq (x) are upper-bounded by L.
t
Since∇2logq (x)isrealsymmetric,thismeansthatallthesingularvaluesof∇2logq (x)arenomorethan
t t
L. Usingthisfact,wecanverifycondition(6),whichiscontainedinthefollowinglemma.
Lemma13. If∇logq isnorm-Lipschitzforallt ≥ 0(asin(7)),wehave,foranyx ∈ Rd,
t t
√
∥∇logq (µ )− α ∇logq (x )∥2 = O(1−α ), ∀t ≥ 1.
t−1 t t t t t
Asaresult,condition(6)holds.
Proof. SeeAppendixF.1.
Now,toderiveanexplicitupperboundonthereverse-steperror,weapplyVonNeumann’straceinequality
andobtain
(cid:16) (cid:17)
Tr ∇2logq (µ )∇2logq (x ) ≤ dL2, ∀t ≥ 1.
t−1 t t t
Therefore,followingfromCorollary1,weobtain
(cid:88)T
E
(cid:20)
log
q t−1|t(X t−1|X t)(cid:21)
≲
dL2log2T
.
X ,X ∼Q
t−1 t t−1,t p (X |X ) T
t−1|t t−1 t
t=1
D.2 ProofofTheorem3
Wefirstintroducesomerelevantnotations. GiventhatQ isGaussianmixture,thep.d.f. ofq ateachtime
0 t
t ≥ 1canbecalculatedas
(cid:90) N
(cid:88)
q (x) = q (x|x ) π q (x )dx
t t|0 0 n 0,n 0 0
x 0∈Rd
n=1
N (cid:90) N
(cid:88) (cid:88)
= π q (x|x )q (x )dx =: π q (x).
n t|0 0 0,n 0 0 n t,n
n=1
x 0∈Rd
n=1
SincetheconvolutionoftwoGaussiandensityisstillGaussian,wehavethatq isthep.d.f. ofN(µ ,Σ ),
√ t,n t,n t,n
whereµ := α¯ µ andΣ := α¯ Σ +(1−α¯ )I . NotethatΣ hasfullrank. Wecheckcondition
t,n t 0,n t,n t 0,n t d t,n
(6)inthefollowinglemma.
Lemma14. WhenQ isGaussianmixture(seeTheorem3),wehave,foranyx ∈ Rd,
0 t
√
∇logq (µ )− α ∇logq (x ) = O(1−α ), ∀t ≥ 1.
t−1 t t t t t
Asaresult,(6)holds.
Proof. SeeAppendixF.2.
Next,weverifyAssumption4forGaussianmixtureQ . Thefollowinglemmaprovidesanupperboundonany
0
orderofpartialderivativeofaGaussianmixturedensity,aslongaseachmixturecomponentiswellcontrolled.
WiththiswefurtherverifyAssumption4forGaussianmixtureinCorollary4.
41(cid:82)
Lemma 15. Let g(x|z) be the conditional Gaussian p.d.f. of N(µ ,Σ ). Define q(x) := g(x|z)dΠ(z),
z z
whereΠ(z)isamixingdistribution(anddenoteZ itssupport). Supposeb := sup ∥µ ∥ < ∞,andsuppose
z∈Z z
thefollowingconditionsonΣ holdforallz ∈ Z:
z
1. Thereexistu,U ∈ Rsuchthatu ≤ det(Σ ) ≤ U;
z
2. ThereexistsV ∈
Rsuchthat(cid:13) (cid:13)Σ−1(cid:13)
(cid:13) ≤ V;
z
3. Thereexistsw ∈ Rsuchthatsup z∈Z,i,j∈[d]2(cid:12) (cid:12) (cid:12)[Σ z− 21 ]ij(cid:12) (cid:12)
(cid:12)
≤ w.
Then,
(cid:40) (cid:41)
(cid:12) (cid:12) d2kmax{w,1}k d2kmax{w,1}k
(cid:12)∂klogq(x)(cid:12) ≤ min CkB UkekV(∥x∥2+b2),B |poly (x)| ,
(cid:12) a (cid:12) k uk/2 2 k uk/2 k
whereB istheBellnumber,C issomeconstant,andpoly (x)issomek-thorderpolynomialinx.
k k
Proof. SeeAppendixF.3.
Corollary4. WhenQ isGaussianmixture(seeTheorem3),Assumption4issatisfied.
0
Proof. SeeAppendixF.4.
Now,wecancalculate
∇2logq (x)
t
(cid:32) (cid:32) (cid:33)
= 1 q (x) (cid:88) π q (x)(cid:0) Σ−1(x−µ )(x−µ )⊺ Σ−1−Σ−1(cid:1)
q2(x) t n t,n t,n t,n t,n t,n t,n
t n
(cid:32) (cid:33)(cid:32) (cid:33)⊺(cid:33)
(cid:88) (cid:88)
− π q (x)Σ−1(x−µ ) π q (x)Σ−1(x−µ ) . (44)
n t,n t,n t,n n t,n t,n t,n
n n
Puttingitdifferently,wehave
(cid:32) (cid:32) (cid:33)
∂2 logq (x) = 1 q (x) (cid:88) π q (x)(cid:0) [Σ−1(x−µ )]i[Σ−1(x−µ )]j −[Σ−1]ij(cid:1)
ij t q2(x) t n t,n t,n t,n t,n t,n t,n
t n
(cid:32) (cid:33)(cid:32) (cid:33)(cid:33)
(cid:88) (cid:88)
− π q (x)[Σ−1(x−µ )]i π q (x)[Σ−1(x−µ )]j .
n t,n t,n t,n n t,n t,n t,n
n n
Wecantakemax withineachsummationhereandget
n
(cid:12) (cid:12)∂ i2 jlogq t(x)(cid:12) (cid:12) ≤ max(cid:0) [Σ− t,n1(x−µ t,n)]i[Σ− t,n1(x−µ t,n)]j(cid:1) −min[Σ− t,n1]ij
n n
+max(cid:12) (cid:12)[Σ t− ,n1(x−µ t,n)]i(cid:12) (cid:12)max(cid:12) (cid:12)[Σ− t,n1(x−µ t,n)]j(cid:12) (cid:12)
n n
( ≤i) 2max(cid:12) (cid:12)[Σ− t,n1(x−µ t,n)]i(cid:12) (cid:12)max(cid:12) (cid:12)[Σ− t,n1(x−µ t,n)]j(cid:12) (cid:12)+max(cid:12) (cid:12)[Σ− t,n1]ij(cid:12)
(cid:12)
n n n
≤ 2(cid:16) max(cid:12) (cid:12)zi (x)(cid:12) (cid:12)max(cid:12) (cid:12)zj (x)(cid:12) (cid:12)+max(cid:12) (cid:12)[Σ−1]ij(cid:12) (cid:12)(cid:17) ,
t,n (cid:12) t,n (cid:12) t,n
n n n
where for brevity we write z (x) := Σ−1(x − µ ). Here (i) follows because max (a b ) ≤
t,n t,n t,n n n n
max n|a n|max n|b n|. Below we write ξ t(x,i) := max n(cid:12) (cid:12)z ti ,n(x)(cid:12) (cid:12) and Σ¯ to be a matrix such that Σ¯ij :=
42max n(cid:12) (cid:12)[Σ− t,n1]ij(cid:12) (cid:12)forbrevity. Forlaterpurposeswewanttoshowthatξ t−1(µ t,i)−ξ t(x t,i) = O(1−α t). Note
thatforeachnandfixedx (writingµ (x ) = µ ),
t t t t
z (µ )−z (x )
t−1,n t t,n t
= Σ−1 (µ −µ )−Σ−1(x −µ )
t−1,n t t−1,n t,n t t,n
= (Σ−1 −Σ−1)(µ −µ )−Σ−1((x −µ )−(µ −µ )). (45)
t−1,n t,n t t−1,n t,n t t,n t t−1,n
Here,sinceΣ isrealsymmetric,wecanwritetheeigen-decompositionasΣ = UDU⊺ ,whereU is
t−1,n t−1,n
anorthonormalmatrix(havingunit2-norm)andDisadiagonalmatrix(withalldiagonalelementspositive). In
thesamenotation,Σ−1 = UD−1U⊺ ,andΣ−1 = (α Σ +(1−α )I )−1 = U(α D+(1−α )I )−1U⊺ .
t−1,n t,n t t−1,n t d t t d
Since
(cid:12) (cid:12)
(cid:12) (cid:12)[D−1]ii−[(α tD+(1−α t)I d)−1]ii(cid:12) (cid:12) = (cid:12) (cid:12) (cid:12)D1
ii
−
α
Dii+1
(1−α
)(cid:12) (cid:12)
(cid:12)
t t
(cid:12) (cid:12)
(1−α t)((cid:12)Dii (cid:12)+1)
≤
α (Dii)2+(1−α )Dii
t t
= O(1−α ),
t
thefollowingholds:
(cid:13) (cid:13)
(cid:13)Σ−1 −Σ−1(cid:13) = O(1−α ).
(cid:13) t−1,n t,n(cid:13) t
Denote[A]i∗ asthei-throwofamatrixA. Thus,followingfrom(45),foranyi ∈ [d],
(cid:13) (cid:13) (ii) (cid:13) (cid:13)
(cid:13)[Σ−1 ]i∗−[Σ−1]i∗(cid:13) ≤ (cid:13)Σ−1 −Σ−1(cid:13) = O(1−α ),
(cid:13) t−1,n t,n (cid:13) (cid:13) t−1,n t,n(cid:13) t
√
(cid:12) (cid:12)
(cid:12) (cid:12)µi t−xi t(cid:12) (cid:12) = (cid:12) (cid:12) (cid:12)1− √ αα t xi t− 1 √− αα t ∂ ilogq t(x t)(cid:12) (cid:12)
(cid:12)
= O(1−α t),
t t
(cid:12) (cid:12)µi t,n−µi t−1,n(cid:12) (cid:12) = (cid:12) (cid:12)(1−√ α t)µi t−1,n(cid:12) (cid:12) = O(1−α t),
where (ii) follows from the definition of matrix 2-norm and from the fact that [Σ−1]i∗ = Σ−11 (1
t,n t,n i i
is the unit vector where the i-th element is 1, and recall that Σ−1 is symmetric). This implies that
t,n
(cid:12) (cid:12)
(cid:12)z ti −1,n(µ t)−z ti ,n(x t)(cid:12) = O(1−α t),∀i. Thus,
ξ t−1(µ t,i)−ξ t(x t,i) = max(cid:12) (cid:12)z ti −1,n(µ t)(cid:12) (cid:12)−max(cid:12) (cid:12)z ti ,n(x t)(cid:12) (cid:12)
n n
≤ max(cid:12) (cid:12)z ti −1,n(µ t)−z ti ,n(x t)(cid:12) (cid:12) = O(1−α t), (46)
n
wherethelastinequalityfollowsbecausemax |a |+max |b | ≥ max (|a |+|b |) ≥ max |a +b |.
n n n n n n n n n n
Now,followingfromTheorem1,wehave
 
d
(cid:88)
E X t∼Q t ∂ i2 jlogq t−1(µ t(X t))∂ i2 jlogq t(X t)
i,j=1
 
d
≤ 4E X ∼Q (cid:88) (cid:0) ξ t−1(µ t(X t),i)ξ t−1(µ t(X t),j)+Σ¯ij(cid:1)(cid:0) ξ t(X t,i)ξ t(X t,j)+Σ¯ij(cid:1) 
t t
i,j=1
 
d
(i ≍ii) 4E X ∼Q (cid:88) (cid:0) ξ t(X t,i)ξ t(X t,j)+Σ¯ij(cid:1)2 
t t
i,j=1
43 
d d
(cid:88) (cid:88)
≤ 8E X ∼Q  ξ t(X t,i)2ξ t(X t,j)2 +8 (Σ¯ij)2
t t
i,j=1 i,j=1

(cid:32)
(cid:33)2
d d
(cid:88) (cid:88)
= 8E X ∼Q  ξ t(X t,i)2 +8 (Σ¯ij)2, (47)
t t
i=1 i,j=1
where(iii)followsfromtheasymptoticresultin(46).
Inthefollowing,weprovidetwodifferentwaystoupper-boundthetwotermsin(47). Thefirstapproachcan
beappliedwhenN isnottoolargecomparedtod. Forthefirstterm,
d d d N
(cid:88) (cid:88) (cid:88)(cid:88)
ξ(x,i)2 = max([Σ−1]i∗(x−µ ))2 ≤ ([Σ−1]i∗(x−µ ))2
t,n t,n t,n t,n
n
i=1 i=1 i=1n=1
N
= (cid:88)(cid:13) (cid:13)Σ− t,n1(x−µ t,n)(cid:13) (cid:13)2 ≤ N max(cid:13) (cid:13)Σ− t,n1(cid:13) (cid:13)2 max∥x−µ t,n∥2
n n
n=1
(iv)
≲ N max∥x−µ ∥2,
t,n
n
where(iv)followsbecauseofthefollowing. SinceΣ isa(full-rank)covariancematrix,allitseigenvalues
t,n
arepositive. Letλ > 0bethesmallesteigenvalueofΣ ,andthus
n,min 0,n
max(cid:13) (cid:13)Σ−1(cid:13)
(cid:13) ≤
1
≤
1
< ∞. (48)
n t,n 2 α¯ tmin nλ n,min+(1−α¯ t) min{1,min nλ n,min}
Inparticular,thisbounddoesnotdependondorT. Also,forthesecondterm,
d d d N N
(cid:88) (Σ¯ij)2 = (cid:88) max([Σ−1]ij)2 ≤ (cid:88) (cid:88) ([Σ−1]ij)2 = (cid:88)(cid:13) (cid:13)Σ−1(cid:13) (cid:13)2 ≲ Nd,
n t,n t,n t,n F
i,j=1 i,j=1 i,j=1n=1 n=1
√
wherethelastinequalityfollowsfrom(48)andthefactthatforanymatrixfull-rankA,∥A∥ ≤ d∥A∥ .
F 2
WhenN islarge,wecaninsteadboundthefirsttermas
d d
(cid:88) (cid:88)
ξ(x,i)2 = max([Σ−1]i∗(x−µ ))2
t,n t,n
n
i=1 i=1
d d
( ≤v) (cid:88) max(cid:16)(cid:13) (cid:13)[Σ− t,n1]i∗(cid:13) (cid:13)2 ∥x−µ t,n∥2(cid:17) ≤ (cid:88) max(cid:13) (cid:13)[Σ− t,n1]i∗(cid:13) (cid:13)2 max∥x−µ t,n∥2
n n n
i=1 i=1
( ≤vi) (cid:88)d max(cid:13) (cid:13)Σ− t,n1(cid:13) (cid:13)2 max∥x−µ t,n∥2 (v ≲ii) dmax∥x−µ t,n∥2.
n n n
i=1
Here(v)followsfromCauchy-Schwartzinequality,(vi)holdsforthesamereasonfor(ii),and(vii)follows
againfrom(48). Also,forthesecondterm,wecanobtainanalternativeupperboundasfollows. Writethe
eigen-decomposition as Σ = Q diag(λ ,...,λ )Q⊺ , where Q here is an orthonormal matrix (that
0,n n n,1 n,d n n
doesnotdependonT). Then,
Σ−1 = Q (α¯ diag(λ ,...,λ )+(1−α¯ )I )−1Q⊺
t,n n t n,1 n,d t d n
= Q diag((α¯ λ +(1−α¯ ))−1,...,(α¯ λ +(1−α¯ ))−1)Q⊺ ,
n t n,1 t t n,d t n
44andthus
(cid:12) (cid:12)
d
max (cid:12) (cid:12)[Σ− t,n1]ij(cid:12) (cid:12) = max (cid:12) (cid:12) (cid:12)(cid:88) (α¯ tλ n,k +(1−α¯ t))−1Qi nkQk nj(cid:12) (cid:12) (cid:12)
n∈[N] n∈[N](cid:12) (cid:12)
k=1
≤ (min{1,minλ n,min})−1 max (cid:12) (cid:12)(Qi n∗)⊺ (Qj n∗)(cid:12) (cid:12)
n n∈[N],i,j∈[d]
≤ (min{1,minλ n,min})−1 max (cid:13) (cid:13)Qi n∗(cid:13) (cid:13)2
n n∈[N],i∈[d]
= (min{1,minλ })−1,
n,min
n
wherethelastlinefollowsbecauseQ isorthonormalforalln ∈ [N]. Notethatthisisauniformboundthat
n
doesnotdependonN,T ord,whichfurtherimpliesthat
d
(cid:88)
(Σ¯ij)2 ≲ d2.
i,j=1
Combiningthetwocases,weget
d
(cid:88)
ξ(x,i)2 ≲ min{d,N}max∥x−µ ∥2, (49)
t,n
n
i=1
d
(cid:88)
(Σ¯ij)2 ≲ dmin{d,N}. (50)
i,j=1
Now,followingfrom(47),weobtain

(cid:32)
(cid:33)2
d
(cid:88) (cid:104) (cid:105)
E X ∼Q  ξ t(X t,i)2  ≲ min{d,N}2E X ∼Q max∥X t−µ t,n∥4
t t t t n
i=1
(cid:16) (cid:104) (cid:105) (cid:17)
≤ min{d,N}2 E ∥X ∥4 +max∥µ ∥4 ,
X ∼Q t t,n
t t n
inwhich
max∥µ ∥4 ≤ max∥µ ∥4 ≲ d2
t,n 0,n
n n
becauseµ < ∞isafixedvectorthatdoesnotdependonT. Forthefirstterm,theexpectedfourthpowerof
0,n
thenormcanbeupper-boundedas
E(cid:20) (cid:16)(cid:13) (cid:13)√ α¯ tX 0+√ 1−α¯ tW¯ t(cid:13) (cid:13)2(cid:17)2(cid:21) ≤ E(cid:20) (cid:16) ∥X 0∥2+2∥X 0∥(cid:13) (cid:13)W¯ t(cid:13) (cid:13)+(cid:13) (cid:13)W¯ t(cid:13) (cid:13)2(cid:17)2(cid:21)
≤ 4(cid:16) E∥X 0∥4+E(cid:13) (cid:13)W¯ t(cid:13) (cid:13)4(cid:17) .
RecallthatQ isaGaussianmixture. Hence,
0
(cid:90) N (cid:90)
(cid:88)
∥x ∥4q (x )dx = π ∥x ∥4q (x )dx ≍ d2,
0 0 0 0 n 0 0,n 0 0
n=1
and

(cid:32)
(cid:33)2
d d d
E(cid:13) (cid:13)W¯ t(cid:13) (cid:13)4 = E  (cid:88) (W¯ ti)2  = (cid:88) E(W¯ ti)4+ (cid:88) E(W¯ ti)2(W¯ tj)2 ≍ d2.
i=1 i=1 i,j=1
i̸=j
45Therefore,weobtainanupperboundonthereverse-steperroras:
(cid:88)T
E
(cid:20)
log
q t−1|t(X t−1|X t)(cid:21)
≲
d2min{d,N}2log2T
.
X ,X ∼Q
t−1 t t−1,t p (X |X ) T
t−1|t t−1 t
t=1
Nextweconsideraspecialcase: whereallGaussianmixtureshavethesamecovariancematrix,andfurther
the covariance is a scaled version of the identity, i.e., Σ ≡ σ2I ,∀n = 1,...,N. In this case, Σ ≡
0,n 0 d t,n
(α¯ σ2+(1−α¯ ))I =: σ2I ,∀n,and(44)canbesimplifiedto
t 0 t d t d
∇2logq (x)
t
(cid:32) (cid:32) (cid:33)
= 1 q (x) (cid:88) π q (x)(cid:0) σ−4(x−µ )(x−µ )⊺ −σ−2I (cid:1)
q (x)2 t n t,n t t,n t,n t d
t
n
(cid:32) (cid:33)(cid:32) (cid:33)⊺(cid:33)
(cid:88) (cid:88)
−σ−4 π q (x)(x−µ ) π q (x)(x−µ )
t n t,n t,n n t,n t,n
n n
(cid:32) (cid:32) (cid:33)
1 (cid:88) ⊺
= q (x) π q (x)µ µ
σ4q (x)2 t n t,n t,n t,n
t t n
(cid:32) (cid:33)(cid:32) (cid:33)⊺(cid:33)
(cid:88) (cid:88)
− π q (x)µ π q (x)µ −σ−2I
n t,n t,n n t,n t,n t d
n n
= 1 (cid:88) π˜ (x)(µ −µ˜ (x))(µ −µ˜ (x))⊺ −σ−2I
σ4 n t,n t t,n t t d
t n
inwhichwehavedefined
N
π nq t,n(x) (cid:88)
π˜ (x) := , µ˜ (x) := π˜ (x)µ .
n t n t,n
q (x)
t
n=1
Note that here π˜ (x) is a p.m.f. in n for any fixed x since (cid:80)N π˜ (x) = 1. Also, note that σ−4 ≤
n √ n=1 n t
max{σ−4,1}andµ = α¯ µ ≤ µ . Therefore,usingasimilartechniquein(55),wecanobtain
0 t,n t 0,n 0,n
d
(cid:88)
∂2 logq (µ )∂2 logq (x )
ij t−1 t ij t t
i,j=1
(cid:18) (cid:19)
≤ max{σ−4,1} max ∥µ −µ ∥4+2d max ∥µ −µ ∥2+d2
0 0,a 0,b 0,a 0,b
a,b∈[n] a,b∈[n]
≲ d2.
Therefore, when all Gaussian mixtures have the same independent covariance, we can upper-bound the
reverse-steperroras
(cid:88)T
E
(cid:20)
log
q t−1|t(X t−1|X t)(cid:21)
≲
d2log2T
.
X ,X ∼Q
t−1 t t−1,t p (X |X ) T
t−1|t t−1 t
t=1
E Proof of Theorem 4
Throughout this section we adopt the noise schedule α ’s defined in (8). We first investigate some nice
t
propertiesofthenoiseschedulein(8). Below,Lemma16(alongwithitsproof)issimilarto[18,Eq(39)]. We
includeafullproofhereforthesakeofcompleteness.
46Lemma16. Theα ’sdefinedin(8)(withc > 2)satisfy
t
1−α logT
t ≲ while α¯ = o(T−1), ∀2 ≤ t ≤ T, p ≥ 1.
(1−α¯ )p δp−1T T
t−1
Remark4. Whenp = 2,theα ’sin(8)(withc > 2)satisfythelatercondition(51).
t
Proof. SeeAppendixF.5.
Similarto(22),anotherpropertyoftheα ’sin(8)isthat
t
(1−α )p (1−α )p
t ≲ t , ∀p,q ≥ 1,t ≥ 2.
αq(1−α¯ )2p (1−α¯ )2p
t t−1 t−1
Additionally,
1−α¯ α¯ (1−α ) 1−α logT
t −1 = t−1 t ≤ t ≲ , ∀2 ≤ t ≤ T.
1−α¯ 1−α¯ 1−α¯ T
t−1 t−1 t−1
Sincetheparameterdependenceisclearintheboundfortheinitializationandestimationerrors(Lemmas3
and4),itremainstoprovideaboundonthereverse-steperrorthatdependsexplicitlyonthesystemparameters,
whichisthemaintopicbelow. Inthefollowing,wefirstprovideamorerefinedboundthanCorollary2when
Q hasboundedsupport.
0
E.1 VerifyingAssumption4
When Q is smooth, we can verify Assumption 4 when Q is a Gaussian mixture. It turns out, then, that
0 0
Assumption 4 is still satisfied for bounded Q since q is always a Gaussian mixture where the mixing
0 t
distributionisQ . Itremainstoshowthateachmixturecomponenthaswell-controlledmeanandvariance,
0
whichisindeedthecaseifanon-vanishing1−α ischosen(i.e.,withearly-stopping). Thisisshowninthe
1
followinglemma.
Lemma17. If1−α = δ,andsupposethatQ hasboundedsupport,thenAssumption4issatisfied.
1 0
Proof. SeeAppendixF.6.
E.2 BoundingMomentsofζ underP
t,t−1 t−1|t
WhenQ issmooth,weneed(6)toshowthattheexpectedsecondandthirdpowersofζ underP is
0 t,t−1 t−1|t
small,andasaresultwecangetridofthetermTr(·)2(seeCorollary1). ForgeneralQ (possiblynon-smooth),
0
wecanshowthatasimilarconditionas(6)holds,whichfurtherallowsustoshowthattheexpectedsecond
andthirdpowersofζ underP arestillsmall.
t,t−1 t−1|t
Lemma18. Fixt ≥ 2andx ∈ Rd. SupposethatAssumption4holdsandthattheα ’ssatisfy
t t
(cid:18) (cid:19)
1−α logT
t
= O , ∀t ≥ 2. (51)
(1−α¯ )2 T
t−1
Then,ifQ satisfiesAssumption1(notnecessarilyhavingap.d.f.),wehave
0
(cid:18) (cid:19)
√ 1−α
t
∇logq (µ (x ))− α ∇logq (x ) = O .
t−1 t t t t t (1−α¯ )3
t−1
Proof. SeeAppendixF.7.
47Corollary5. UnderthesameconditionasLemma18,iftheα ’ssatisfy(51),then
t
(cid:18) (1−α )2 (cid:19) (cid:18) log2T(cid:19)
E [ζ2 ] = O t = O , and
X t−1∼P t−1|t t,t−1 (1−α¯ )4 T2
t−1
(cid:18) (1−α )3 (cid:19) (cid:18) log3T(cid:19)
E [ζ3 ] = O t = O .
X t−1∼P t−1|t t,t−1 (1−α¯ )6 T3
t−1
√
Proof. We will use the result in Lemma 18. Write g(x ) = ∇logq (µ )− α ∇logq (x ). The proof
t t−1 t t t t
is similar to Lemma 11. The only difference is that the rate of g(x ) is slightly different. We still use the
t
expectedsecondandthirdmomentexpressionsfrom(42)and(43),andwenotethatσ2 = (1−α )/α and
t t t
(1−α )/(1−α¯ )2 = O(logT/T)(by(51)). SinceAssumption4issatisfied(byLemma17),thepartial
t t−1
derivativesdonotaffecttherate,andweimmediatelyobtainthedesiredresult.
E.3 MoreRefinedBoundforQ withBoundedSupport
0
Now we combine the ingredients together to show a more refined bound than that in Corollary 2. The
techniquetoboundKL(Q 1||P(cid:98)1)issimilartothatinCorollary1. Inparticular,weprovidearefinedboundfor
thereverse-steperror. AsinCorollary1,westartfrom(27).
Ifweadopttheα ’sin(8),thenAssumption4issatisfiedwhenQ hasboundedsupportbyLemma17. Asa
t 0
result,alltheresultsforconditionalexpectationsareapplicable(Lemmas7to9),andhighermomentsunder
P arealsoguaranteedbyCorollary5. Therefore,wecancontinuefrom(27)andproceedasfollows. For
t−1|t
eacht ≥ 2andfixedx ∈ Rd,wehave
t
(cid:20) q (X |x )(cid:21)
E log t−1|t t−1 t
X ∼Q
t−1 t−1|t p (X |x )
t−1|t t−1 t
1 1
≤ E [ζ ]−E [ζ ]− E [ζ2 ]− E [ζ3 ]
X t−1∼Q t−1|t t,t−1 X t−1∼P t−1|t t,t−1 2 X t−1∼P t−1|t t,t−1 3! X t−1∼P t−1|t t,t−1
1
(cid:18)
1 1
(cid:19)2
+ E [ζ ]+ E [ζ2 ]+ E [ζ3 ]
2 X t−1∼P t−1|t t,t−1 2 X t−1∼P t−1|t t,t−1 3! X t−1∼P t−1|t t,t−1
(cid:32) (cid:33)
(cid:18)
1 1
(cid:19)3
+O E [ζ ]+ E [ζ2 ]+ E [ζ3 ]
X t−1∼P t−1|t t,t−1 2 X t−1∼P t−1|t t,t−1 3! X t−1∼P t−1|t t,t−1
( =i) E [ζ ]−E [ζ ]− 1 E [ζ2 ]+ 1 (cid:0)E [ζ ](cid:1)2
X t−1∼Q t−1|t t,t−1 X t−1∼P t−1|t t,t−1 2 X t−1∼P t−1|t t,t−1 2 X t−1∼P t−1|t t,t−1
(cid:18) (1−α )3 (cid:19)
t
+O
(1−α¯ )6
t−1
(ii) (cid:18) (1−α )3 (cid:19)
≤ E [ζ ]−E [ζ ]+O t
X t−1∼Q t−1|t t,t−1 X t−1∼P t−1|t t,t−1 (1−α¯ )6
t−1
(i =ii) (1−α t)2 Tr(cid:0) ∇2logq (µ )∇2logq (x )(cid:1) +O(cid:18) (1−α t)3 (cid:19) . (52)
2α t−1 t t t (1−α¯ )6
t t−1
Here(i)followsfromCorollary5andLemma7,(ii)followsfromJensen’sinequality,and(iii)followsfrom
Lemmas 7 to 9. Next we take the expectation over X ∼ Q , which does not affect the rate of each term
t t
becauseofAssumption4(showntobesatisfiedhere,byLemma17). Takingasummationovert = 2,...,T,
wehavethusobtainedarefinedboundforQ withboundedsupport.
0
48E.4 ExplicitParameterDependence
Finally,weprovidetheexplicitparameterdependencewhenQ hasboundedsupport. Again,webeginby
0
investigating∇2logq (t ≥ 1). WederivetheHessianoflogq (x)as
t t
(cid:32)(cid:82) (cid:33)
∇2logq t(x) =
∂
(cid:82)x
0∈Rd∇q t|0(x|x 0)dQ 0(x 0)
∂x q (x|x )dQ (x )
x ∈Rd t|0 0 0 0
0
(cid:16) (cid:17)(cid:16) (cid:17)⊺
q (x)(cid:82) ∇2q (x|x )dQ (x )− (cid:82) ∇q (x|x )dQ (x ) (cid:82) ∇q (x|x )dQ (x )
t x ∈Rd t|0 0 0 0 x ∈Rd t|0 0 0 0 x ∈Rd t|0 0 0 0
= 0 0 0
q2(x)
t
1 (cid:18) (cid:90) (cid:0) √ √ ⊺ (cid:1)
= q (x) q (x|x ) (x− α¯ x )(x− α¯ x ) −(1−α¯ )I dQ (x )
(1−α¯ )2q2(x) t t|0 0 t 0 t 0 t d 0 0
t t x 0∈Rd
(cid:18)(cid:90) √ (cid:19)(cid:18)(cid:90) √ (cid:19)⊺(cid:19)
− q (x|x )(x− α¯ x )dQ (x ) q (x|x )(x− α¯ x )dQ (x )
t|0 0 t 0 0 0 t|0 0 t 0 0 0
x ∈Rd x ∈Rd
0 0
(i) 1 1 (cid:18) (cid:16) ⊺ (cid:18)(cid:90) √ (cid:19) ⊺
= − I + q (x) q (x)xx − q (x|x ) α¯ x dQ (x ) x
1−α¯ d (1−α¯ )2q2(x) t t t|0 0 t 0 0 0
t t t x 0∈Rd
(cid:18)(cid:90) √ (cid:19)⊺ (cid:90) √ √ (cid:17)
(cid:0) ⊺(cid:1)
−x q (x|x ) α¯ x dQ (x ) + q (x|x ) ( α¯ x )( α¯ x ) dQ (x )
t|0 0 t 0 0 0 t|0 0 t 0 t 0 0 0
x ∈Rd x ∈Rd
0 0
(cid:18) (cid:90) √ (cid:19)(cid:18) (cid:90) √ (cid:19)⊺(cid:19)
− q (x)x− q (x|x )( α¯ x )dQ (x ) q (x)x− q (x|x )( α¯ x )dQ (x )
t t|0 0 t 0 0 0 t t|0 0 t 0 0 0
x ∈Rd x ∈Rd
0 0
1 1 (cid:18) (cid:90) (cid:0) √ √ ⊺(cid:1)
= − I + q (x) q (x|x ) ( α¯ x )( α¯ x ) dQ (x )
1−α¯ d (1−α¯ )2q2(x) t t|0 0 t 0 t 0 0 0
t t t x 0∈Rd
(cid:18)(cid:90) √ (cid:19)(cid:18)(cid:90) √ (cid:19)⊺(cid:19)
− q (x|x )( α¯ x )dQ (x ) q (x|x )( α¯ x )dQ (x ) (53)
t|0 0 t 0 0 0 t|0 0 t 0 0 0
x ∈Rd x ∈Rd
0 0
where(i)followsbecauseforanyfunctionfn(x)ofx,
(cid:90) (cid:18)(cid:90) (cid:19)
1 1
q (x|x )fn(x)dQ (x ) = q (x|x )dQ (x ) fn(x) = fn(x).
q (x) t|0 0 0 0 q (x) t|0 0 0 0
t x ∈Rd t x ∈Rd
0 0
Foreaseofpresentation,define
q (x|x ) q (x|x )
t|0 0 t|0 0
h (x |x) := = .
t 0 (cid:82)
q (x) q (x|x )dQ (x )
t x ∈Rd t|0 0 0 0
0
Here h is the likelihood ratio between the conditional and the marginal at time t. Note that
t
(cid:82) h (x |x)dQ (x ) = 1. Therefore, givenanyx, thereexistsaprobabilitymeasureQ˜ (x |x)(abso-
x ∈Rd t 0 0 0 0|t 0
0
lutelycontinuousw.r.t. Q )suchthat dQ˜ 0|t(x 0|x) = h (x |x)forallx . Sinceh (x |x) > 0,Q˜ (x |x)has
0 dQ (x ) t 0 0 t 0 0|t 0
0 0
thesamesupportasQ forallx. Alsodefinem (x) := E [X ]. Withthesenotations,wecanuse
0 t X ∼Q˜ (·|x) 0
0 0|t
change-of-measuretoget
1
I +∇2logq (x)
d t
1−α¯
t
(cid:18)(cid:90)
α¯
t ⊺
= h (x |x)x x dQ (x )
(1−α¯ )2 t 0 0 0 0 0
t x ∈Rd
0
(cid:18)(cid:90) (cid:19)(cid:18)(cid:90) (cid:19)⊺(cid:19)
− h (x |x)x dQ (x ) h (x |x)x dQ (x )
t 0 0 0 0 t 0 0 0 0
x ∈Rd x ∈Rd
0 0
(cid:90)
α¯
= t (x −m (x))(x −m (x))⊺ dQ˜ (x |x). (54)
(1−α¯ )2 0 t 0 t 0|t 0
t x ∈Rd
0
49Inparticular,foreachi,j ∈ [d]andfixedx,wehave
(cid:12) (cid:12)∂ i2 jlogq t(x)(cid:12) (cid:12) ≤ (1−α¯ t
α¯ )2
(cid:90) (cid:12) (cid:12)xi 0−mi t(x)(cid:12) (cid:12)(cid:12) (cid:12) (cid:12)xj 0−mj t(x)(cid:12) (cid:12) (cid:12)dQ˜ 0|t(x 0|x)+ 1−1
α¯
.
t x ∈Rd t
0
NowconsiderQ withboundedsupport. InthiscaseQ˜ (x |x)hasthesameboundedsupportasQ forallx.
0 0|t 0 0
Notethatm (x)isalsocontainedinthissupport. Wehave
t
d
(cid:88)
∂2 logq (µ )∂2 logq (x )
ij t−1 t ij t t
i,j=1
(cid:90) d
≤ α¯ tα¯ t−1 × (cid:88) |xi −mi (µ )||xj −mj (µ )|
(1−α¯ )2(1−α¯ )2 a t−1 t a t−1 t
t t−1 x ,x ∈Rd
a b i,j=1
|xi −mi(x )||xj −mj(x )|dQ˜ (x |µ )dQ˜ (x |x )
b t t b t t 0|t−1 a t 0|t b t
(cid:90) d
+ α¯ t−1 × (cid:88) |xi −mi (µ )||xj −mj (µ )|dQ˜ (x |µ )
(1−α¯ )(1−α¯ )2 a t−1 t a t−1 t 0|t−1 a t
t t−1 x ∈Rd
a i,j=1
(cid:90) d
+ α¯ t × (cid:88) |xi −mi(x )||xj −mj(x )|dQ˜ (x |x )
(1−α¯ )(1−α¯ )2 b t t b t t 0|t b t
t−1 t x ∈Rd
b i,j=1
d2
+
(1−α¯ )(1−α¯ )
t−1 t
α¯ α¯
t t−1
= ×
(1−α¯ )2(1−α¯ )2
t t−1
(cid:32) (cid:33)2
(cid:90) d
(cid:88)
(xi −mi (µ ))(xi −mi(x )) dQ˜ (x |µ )dQ˜ (x |x )
a t−1 t b t t 0|t−1 a t 0|t b t
x ,x ∈Rd
a b i=1
(cid:32) (cid:33)2
(cid:90) d
+ α¯ t−1 × (cid:88) |xi −mi (µ )| dQ˜ (x |µ )
(1−α¯ )(1−α¯ )2 a t−1 t 0|t−1 a t
t t−1 x ∈Rd
a i=1
(cid:32) (cid:33)2
(cid:90) d
+ α¯ t × (cid:88) |xi −mi(x )| dQ˜ (x |x )
(1−α¯ )(1−α¯ )2 b t t 0|t b t
t−1 t x ∈Rd
b i=1
d2
+
(1−α¯ )(1−α¯ )
t−1 t
(ii) α¯ α¯
t t−1
≤ ×
(1−α¯ )2(1−α¯ )2
t t−1
(cid:90)
∥x −m (µ )∥2∥x −m (x )∥2dQ˜ (x |µ )dQ˜ (x |x )
a t−1 t b t t 0|t−1 a t 0|t b t
x ,x ∈Rd
a b
(cid:90)
α¯
+ t−1 × d∥x −m (µ )∥2dQ˜ (x |µ )
(1−α¯ )(1−α¯ )2 a t−1 t 0|t−1 a t
t t−1 x ∈Rd
a
(cid:90)
α¯
+ t × d∥x −m (x )∥2dQ˜ (x |x )
(1−α¯ )(1−α¯ )2 b t t 0|t b t
t−1 t x ∈Rd
b
d2
+
(1−α¯ )(1−α¯ )
t−1 t
50(iii)
≤ (1−α¯ )−4×
t−1
(cid:18) (cid:19)
max ∥x −x ∥4+2d max ∥x −x ∥2+d2 (55)
a b a b
x ,x :∥x ∥2,∥x ∥2≤R2d x ,x :∥x ∥2,∥x ∥2≤R2d
a b a b a b a b
where (ii) follows from Cauchy–Schwartz inequality and (iii) follows from the assumption that Q has
0
boundedsupportandbecauseα¯ < α¯ < 1. Since
t t−1 √
max ∥x −x ∥ ≤ 2 max ∥x ∥ ≲ R d,
a b a
x ,x :∥x ∥2,∥x ∥2≤R2d x :∥x ∥2≤R2d
a b a b a a
wecancontinuefrom(55)andupper-boundeachsummationterminEquation(52)as
 
(1− 2αα t)2
E
X t∼Q
t(cid:88)d
∂ i2 jlogq t−1(µ t)∂ i2 jlogq t(x t) ≲
(1(1 −− α¯α t)2
)4d2R4.
t t−1
i,j=1
Therefore,forthereverse-steperror,wefinallyobtain
(cid:88)T
E
(cid:20)
log
q t−1|t(X t−1|X t)(cid:21)
≲
d2R4log2T
.
X t−1,X t∼Q t−1,t p (X |X ) δ2T
t−1|t t−1 t
t=1
WeremindreadersthatRdoesnotdependond.
Inthefollowing,weshowthattheresultcanbefurtherimprovedundertheadditionalassumptionin(9). The
goalistoprovideanupperboundonh (x |x)forallx. From(9),
t 0
(cid:90) (cid:90)
q (x|y)dQ (y) ≥ q (x|y)dQ (y)
t|0 0 t|0 0
y∈Rd y∈B (x )
γ 0
(iv)
≥ ϵ inf q (x|y)
t|0
y∈B (x )
γ 0
where(iv)holdsby(9). Takingthelimitγ → 0,bycontinuityofq (x|x )inx ,weobtainthat
t|0 0 0
(cid:90)
q (x|y)dQ (y) ≥ ϵ·q (x|x ),
t|0 0 t|0 0
y∈Rd
andthush (x |x) ≤ ϵ−1 forallx ∈ Rd andx ∈ supp(Q ). Thus,followingfrom(54),wehave
t 0 0 0
(cid:90)
1 α¯
− I ⪯ ∇2logq (x) ⪯ t x x⊺ dQ˜ (x |x)
1−α¯ d t (1−α¯ )2 0 0 0|t 0
t t x ∈Rd
0
(cid:90)
1
⪯ ϵ−1 x x⊺ dQ (x )
(1−α¯ )2 0 0 0 0
t x ∈Rd
0
1
⪯ M I ,
(1−α¯ )2 2 d
t
wherethelastlinefollowsfromAssumption1. Thisimpliesthat
(cid:26) (cid:27)
(cid:13) (cid:13)∇2logq t(x t)(cid:13) (cid:13) 2 ≤ max 1−1 α¯ , (1−1 α¯ )2M 2 ≤ (1−1 α¯ )2(M 2+1).
t t t
Hence,usingVonNeumann’straceinequality,weobtain
Tr(cid:0) ∇2logq t(x t)∇2logq t−1(µ t)(cid:1) ≤ d(cid:13) (cid:13)∇2logq t(x t)(cid:13) (cid:13) 2(cid:13) (cid:13)∇2logq t−1(µ t)(cid:13) (cid:13)
2
1
≤ d(M +1)2.
(1−α¯ )2(1−α¯ )2 2
t t−1
NotethathereM doesnotdependond. Therefore,weobtainanimprovedboundonthereverse-steperror
2
undercondition(9)asfollows:
(cid:88)T
E
(cid:20)
log
q t−1|t(X t−1|X t)(cid:21)
≲
dlog2T
.
X t−1,X t∼Q t−1,t p (X |X ) δ2T
t−1|t t−1 t
t=1
51F Auxiliary Proofs for Theorems 2 to 4
Inthissection,weprovidetheproofsforthelemmasintheproofsforTheorems2to4.
F.1 ProofofLemma13
Followingfrom[14,Lemma20],wehave
1
∇logq (x) = √ E [∇logq (X )].
t α X t−1∼Q t−1|t(·|x) t−1 t−1
t
Hence,
√
∥∇logq (µ )− α ∇logq (x )∥2
t−1 t t t t
= (cid:13) (cid:13)∇logq t−1(µ t)−E
X ∼Q (·|x
)[∇logq t−1(X t−1)](cid:13) (cid:13)2
t−1 t−1|t t
(i)
≤ E ∥∇logq (µ )−∇logq (X )∥2
X ∼Q (·|x ) t−1 t t−1 t−1
t−1 t−1|t t
(ii)
≤ L2·E ∥µ −X ∥2
X ∼Q (·|x ) t t−1
t−1 t−1|t t
(i =ii) L2·E
X ∼Q (·|x
)(cid:13) (cid:13)X t−1−E
X ∼Q (·|x
)[X t−1](cid:13) (cid:13)2
t−1 t−1|t t t−1 t−1|t t
where(i)followsfromJensen’sinequality,(ii)followsfromEquation(7),and(iii)followsfromLemma8.
Finally,followingfromLemma8,weobtain
E
X ∼Q (·|x
)(cid:13) (cid:13)X t−1−E
X ∼Q (·|x
)[X t−1](cid:13) (cid:13)2
t−1 t−1|t t t−1 t−1|t t
(cid:0) (cid:1)
= Tr Cov (X )
X ∼Q (·|x ) t−1
t−1 t−1|t t
= 1−α t d+ (1−α t)2 Tr(cid:0) ∇2logq (x )(cid:1) .
t t
α α
t t
Here(cid:12) (cid:12)Tr(cid:0) ∇2logq t(x t)(cid:1)(cid:12) (cid:12) < dLsinceallabsolutevaluesoftheeigenvaluesof∇2logq t(x)areupper-bounded
byL. Theproofisnowcomplete.
F.2 ProofofLemma14
Fixt ≥ 1andx ∈ Rd. Wehavethat
t
(cid:90) N
(cid:88)
q (x) = q (x|x ) π q (x )dx
t t|0 0 n 0,n 0 0
x 0∈Rd
n=1
N (cid:90) N
(cid:88) (cid:88)
= π q (x|x )q (x )dx =: π q (x).
n t|0 0 0,n 0 0 n t,n
n=1
x 0∈Rd
n=1
√
Hereq isthep.d.f. ofN(µ ,Σ )whereµ := α¯ µ andΣ := α¯ Σ +(1−α¯ )I . Thus,we
t,n t,n t,n t,n t 0,n t,n t 0,n t d
have
(cid:80)N π q (x)Σ−1(x−µ )
n=1 n t,n t,n t,n
∇logq (x) =
t (cid:80)N
π q (x)
n=1 n t,n
(cid:80)N π q (x)Σ−1 (cid:80)N π q (x)Σ−1µ
n=1 n t,n t,n n=1 n t,n t,n t,n
= x− .
q (x) q (x)
t t
Thisimpliesthat
√
∇logq (µ )− α ∇logq (x )
t−1 t t t t
52(cid:80)N n=1π nq t−1,n(µ t)Σ− t−1
1,n
(cid:80)N n=1π nq t,n(x t)Σ− t,n1 √
= µ − α x
t t t
q (µ ) q (x )
t−1 t t t
(cid:124) (cid:123)(cid:122) (cid:125)
term1
(cid:32)(cid:80)N n=1π nq t−1,n(µ t)Σ− t−1 1,nµ t−1,n √ (cid:80)N n=1π nq t,n(x t)Σ− t,n1µ t,n(cid:33)
− − α . (56)
t
q (µ ) q (x )
t−1 t t t
(cid:124) (cid:123)(cid:122) (cid:125)
term2
Thefirsttermin(56)isequalto
(cid:32)(cid:80)N π q (µ )Σ−1 (cid:80)N π q (x )Σ−1(cid:33)
n=1 n t−1,n t t−1,n n=1 n t,n t t,n
term1 = − µ
(cid:80)N
π q (µ )
(cid:80)N
π q (x )
t
m=1 m t−1,m t m=1 m t,m t
(cid:80)N n=1π nq t,n(x t)Σ− t,n1 √
+ (µ − α x )
t t t
q (x )
t t
(cid:16) (cid:17)
(cid:80)N π π q (µ )q (x )Σ−1 −q (µ )q (x )Σ−1
m,n=1 m n t−1,n t t,m t t−1,n t−1,m t t,n t t,n
= µ
t
q (µ )q (x )
t−1 t t t
(cid:80)N n=1π nq t,n(x t)Σ− t,n1 √
+ (µ − α x )
t t t
q (x )
t t
where
√ x 1−α √
t t
µ − α x = √ + √ ∇logq (x )− α x
t t t t t t t
α α
t t
1−α
t
= √ (x +∇logq (x )) = O(1−α ).
t t t t
α
t
Thesecondtermin(56)isequalto
(cid:32)(cid:80)N π q (µ )Σ−1 µ (cid:80)N π q (x )Σ−1µ (cid:33)
n=1 n t−1,n t t−1,n t−1,n n=1 n t,n t t,n t−1,n
term2 = −α
t
q (µ ) q (x )
t−1 t t t
(cid:32)(cid:80)N
π q (µ )Σ−1 µ
(cid:33)
n=1 n t−1,n t t−1,n t−1,n
= (1−α )
t
q (µ )
t−1 t
(cid:32)(cid:80)N π q (µ )Σ−1 µ (cid:80)N π q (x )Σ−1µ (cid:33)
n=1 n t−1,n t t−1,n t−1,n n=1 n t,n t t,n t−1,n
+α −
t (cid:80)N
π q (µ )
(cid:80)N
π q (x )
m=1 m t−1,m t m=1 m t,m t
(cid:32)(cid:80)N
π q (µ )Σ−1 µ
(cid:33)
n=1 n t−1,n t t−1,n t−1,n
= (1−α )
t
q (µ )
t−1 t
(cid:16) (cid:17)
(cid:80)N π π q (µ )q (x )Σ−1 −q (µ )q (x )Σ−1 µ
m,n=1 m n t−1,n t t,m t t−1,n t−1,m t t,n t t,n t−1,n
+α .
t
q (µ )q (x )
t−1 t t t
Observe that there is a common factor in both terms above, namely, q (µ )q (x )Σ−1 −
t−1,n t t,m t t−1,n
q (µ )q (x )Σ−1. The proof would be complete if this common factor is of order (1 − α ), which
t−1,m t t,n t t,n t
wenowinvestigate. Notethat
Σ−1 −Σ−1 = Σ−1 −(α Σ +(1−α )I )−1
t−1,n t,n t−1,n t t−1,n t d
53(cid:18)
1−α
(cid:19)−1
= Σ−1 − (α Σ )(I + t Σ−1 )
t−1,n t t−1,n d α t−1,n
t
1 1−α
= Σ−1 − (I + t Σ−1 )−1Σ−1
t−1,n α d α t−1,n t−1,n
t t
(cid:18) (cid:19)
( =i) Σ−1 − 1 I − 1−α t Σ−1 +O((1−α )2) Σ−1
t−1,n α d α t−1,n t t−1,n
t t
1−α 1−α
= t Σ−1 + t Σ−2 +O((1−α )2) = O(1−α )
α t−1,n α2 t−1,n t t
t t
where(i)followsfromTaylorexpansionandnotethat1−α = O(logT/T)andΣ−1 = O(1). Also,
t t−1,n
q (µ )q (x )−q (µ )q (x )
t−1,n t t,m t t−1,m t t,n t
(cid:18) (cid:19)
q (µ )q (x )
t−1,n t t,m t
= q (µ )q (x ) −1
t−1,m t t,n t
q (µ )q (x )
t−1,m t t,n t
=: q (µ )q (x )(e∆−1)
t−1,m t t,n t
where
1 1
∆ = − (µ −µ )⊺ Σ−1 (µ −µ )+ (x −µ )⊺ Σ−1(x −µ )
2 t t−1,n t−1,n t t−1,n 2 t t,n t,n t t,n
1 1
− (x −µ )⊺ Σ−1(x −µ )+ (µ −µ )⊺ Σ−1 (µ −µ ).
2 t t,m t,m t t,m 2 t t−1,m t−1,m t t−1,m
Here,foranyi ∈ [d],wehave
(cid:12) (cid:12)(µi −µi )−(xi −µi )(cid:12)
(cid:12)
t t−1,n t t,n
√
(cid:12) (cid:12)
= (cid:12) (cid:12) (cid:12)1− √ αα t xi t+ 1 √− αα t [∇logq t(x t)]i−(1−√ α t)µi t−1,n(cid:12) (cid:12)
(cid:12)
t t
√
≤ 1− √ αα t (cid:12) (cid:12)xi t(cid:12) (cid:12)+ 1 √− αα t (cid:12) (cid:12)[∇logq t(x t)]i(cid:12) (cid:12)+(1−√ α t)(cid:12) (cid:12)µi t−1,n(cid:12) (cid:12)
t t
≤ 1 √− αα t (cid:12) (cid:12)xi t(cid:12) (cid:12)+ 1 √− αα t (cid:12) (cid:12)[∇logq t(x t)]i(cid:12) (cid:12)+(1−α t)(cid:12) (cid:12)µi t−1,n(cid:12) (cid:12)
t t
= O(1−α ).
t
Thus,(µ −µ )−(x −µ ) = O(1−α )and
t t−1,n t t,n t
(cid:13) (cid:13)
(cid:13)(µ −µ )⊺ Σ−1 (µ −µ )−(x −µ )⊺ Σ−1(x −µ )(cid:13)
(cid:13) t t−1,n t−1,n t t−1,n t t,n t,n t t,n (cid:13)
(cid:13)
= (cid:13)(µ −µ )⊺ (Σ−1 −Σ−1)(µ −µ )
(cid:13) t t−1,n t−1,n t,n t t−1,n
+(µ −µ
)⊺ Σ−1(cid:0)
(µ −µ )−(x −µ
)(cid:1)
t t−1,n t,n t t−1,n t t,n
(cid:13)
+(cid:0) (µ −µ )−(x −µ )(cid:1)⊺ Σ−1(x −µ )(cid:13)
t t−1,n t t,n t,n t t,n (cid:13)
(cid:13) (cid:13)
≤ (cid:13)(µ −µ )⊺ (Σ−1 −Σ−1)(µ −µ )(cid:13)
(cid:13) t t−1,n t−1,n t,n t t−1,n (cid:13)
(cid:13) (cid:13)(cid:13) (cid:13)
+(cid:13)(µ −µ )⊺ Σ−1(cid:13)(cid:13)(µ −µ )−(x −µ )(cid:13)
(cid:13) t t−1,n t,n(cid:13)(cid:13) t t−1,n t t,n (cid:13)
(cid:13) (cid:13)(cid:13) (cid:13)
+(cid:13)(µ −µ )−(x −µ )(cid:13)(cid:13)Σ−1(x −µ )(cid:13)
(cid:13) t t−1,n t t,n (cid:13)(cid:13) t,n t t,n (cid:13)
= O(1−α ),
t
54whichfurtherimpliesthat∆ = O(1−α ). Then,
t
q (µ )q (x )−q (µ )q (x ) = O(e∆−1) = O(∆) = O(1−α ).
t−1,n t t,m t t−1,m t t,n t t
Hence,thecommonfactorinbothtermsof(56)satisfies
q (µ )q (x )Σ−1 −q (µ )q (x )Σ−1
t−1,n t t,m t t−1,n t−1,m t t,n t t,n
= q (µ )q (x )(Σ−1 −Σ−1)+(q (µ )q (x )−q (µ )q (x ))Σ−1
t−1,n t t,m t t−1,n t,n t−1,n t t,m t t−1,m t t,n t t,n
= O(1−α ).
t
Theproofisnowcomplete.
F.3 ProofofLemma15
Fixk ≥ 1anda ∈ [d]k. Recallthatu ≤ det(Σ z) ≤ U,(cid:13) (cid:13)Σ− z1(cid:13) (cid:13) ≤ V,andsup z∈Z,i,j∈[d]2(cid:12) (cid:12) (cid:12)[Σ− z 1 2]ij(cid:12) (cid:12) (cid:12) ≤ w for
allz ∈ Z. Alsowriteϕ(y)asthep.d.f. oftheunitGaussian. Weareinterestedinupper-boundingtheabsolute
partialderivativesoflogq(x)withafunctionofxwhere
(cid:90)
q(x) = g(x|z)dΠ(z),
where,usingthechange-of-variableformula,
1 (cid:16) −1 (cid:17)
g(x|z) =
det(Σ
)1ϕ Σ
z
2(x−µ z) . (57)
z 2
Wefirstidentifyanupperboundontheabsolutepartialderivativesofq(x). Now,
(cid:90)
∂kq(x) ( =i) ∂kg(x|z)dΠ(z)
a a
( ≤ii)
inf
d1
et(Σ )1
(cid:90)
∂
akϕ(cid:16) Σ−
z
1
2(x−µ
z)(cid:17)
dΠ(z)
z∈Z z 2
where(i)followsfromthedominatedconvergencetheorem(see(32)),and(ii)followsfrom(57). Toobtain
an upper bound on the k-th derivative of Gaussian density, we invoke the multivariate version of the Faá
−1
di Bruno’s formula [41, Theorem 2.1]. Since y = Σ
z
2(x−µ z) is linear in x, only the first-order partial
−1
derivativeisnon-zeroandisequaltoanentryinΣ
z
2. Thus,wehave
(cid:12) (cid:12)
(cid:12) k (cid:12)
(cid:12) (cid:12) (cid:12)∂ akϕ(cid:16) Σ z− 21 (x−µ z)(cid:17)(cid:12) (cid:12) (cid:12) = (cid:12) (cid:12)
(cid:12)
(cid:88) ϕ( ak ′) (y)(cid:89) ∂x∂ [Σ− z 1 2(x−µ z)]a′ s(cid:12) (cid:12)
(cid:12)
a
(cid:12)a′∈[d]k s=1 s (cid:12)
(cid:12) (cid:12)
(cid:12) (cid:12)
≤ (cid:12) (cid:12)
(cid:12)
(cid:88) ϕ( ak ′)(cid:16) Σ z− 21 (x−µ z)(cid:17)(cid:12) (cid:12) (cid:12)max{w,1}k, ∀a : |a| = k.
(cid:12)a′∈[d]k (cid:12)
Here we define ϕ(k) (y) := ∂kϕ(y). Since ϕ(y) is a Gaussian density which is infinitely differentiable and
a a
(k)
decaysexponentiallyatthetail,itsk-thorderderivativesatisfiesϕ (y) = poly (y)ϕ(y)wherepoly (y)is
a k k
ak-thorderpolynomialfunctioniny ,...,y (andthusinx ,...,x bylinearity). Alsonotethat,forany
1 d 1 d
a ∈ [d]k,
(cid:12) (cid:12)
lim (cid:12)ϕ(k) (y)(cid:12) = lim |poly (y)ϕ(y)| = 0.
(cid:12) a (cid:12) k
∥y∥→∞ ∥y∥→∞
55(cid:12) (cid:12) (cid:12) (cid:12)
By the continuity of ϕ(k) (y), there exists y¯ such that (cid:12)ϕ(k) (y)(cid:12) ≤ (cid:12)ϕ(k) (y¯ )(cid:12) ≤ poly (y¯ ) for all y ∈ Rd.
a a (cid:12) a (cid:12) (cid:12) a a (cid:12) k a
Now,forallx ∈ Rd,
(cid:12) (cid:12) (cid:12)∂ akq(x)(cid:12) (cid:12)
(cid:12)
≤ (cid:90) det(Σ z)−1
2
(cid:12) (cid:12) (cid:12)∂ akϕ(cid:16) Σ z− 21 (x−µ z)(cid:17)(cid:12) (cid:12) (cid:12)dΠ(z)
 
≤ max{w,1}k(cid:90) det(Σ z)− 21  (cid:88) (cid:12) (cid:12) (cid:12)poly k(cid:16) Σ− z 1 2(x−µ z)(cid:17)(cid:12) (cid:12) (cid:12)ϕ(cid:16) Σ− z 1 2(x−µ z)(cid:17) dΠ(z) (58)
a∈[d]k
dkmax{w,1}k
≤ √ |poly (y¯ )|ϕ(y¯ ). (59)
u k a a
Wehavethusobtainedaconstantupperboundonallpartialderivativesofq(x)oforderk.
Next,weconvertthepartialderivativeboundintothatforlogq(x). WeagaininvokeFaádiBruno’sformula
[41]. Notethat
k
∂klogq(x) = q(x)−k (cid:88) (cid:89) ∂|b j| q(x) =: (cid:88) r (x) (60)
a b j b 1,...,b k
b ,...,b j=1 b ,...,b
1 k 1 k
inwhichwedefineeachsummationtermasr. Here{b ,...,b }issome(possiblyempty)partitionofa,i.e.,
1 k
(cid:80) (cid:80)
b = aand |b | = k (thus,atmostk partitions). Weorderthispartitionsuchthatk ≥ |b | ≥ ··· ≥
j j j j 1
|b | ≥ 0. Notethatthetotalnumberofpartitioncanbeupper-boundedbydk(cid:80)k B (1,...,1) = dkB ,
k l=1 k,l k
whereB (·)andB aretheBellpolynomialsandtheBellnumber,respectively.
k,l k
Wefirstshowcaseasimpleyetusefulupperbound. From(59),weget,
(cid:12) (cid:12)
(cid:12) k (cid:12) k
(cid:12) (cid:12)(cid:89) ∂|b j| q(x)(cid:12) (cid:12) ≤ (cid:89)(cid:12) (cid:12)∂|b j| q(x)(cid:12) (cid:12)
(cid:12) b j (cid:12) (cid:12) b j (cid:12)
(cid:12)j=1 (cid:12) j=1
≤
(dmax{w,1})(cid:80) j|b j| max{maxϕ(y),1}k(cid:89)k (cid:12)
(cid:12)poly (y¯
)(cid:12)
(cid:12)
min{u,1}k/2 y (cid:12) |b j| b j (cid:12)
j=1
≤
(dmax{w,1})(cid:80) j|b j| max{maxϕ(y),1}kmax(cid:12)
(cid:12)poly (y¯
)(cid:12) (cid:12)k
min{u,1}k/2 y j (cid:12) |b j| b j (cid:12)
dkmax{w,1}k
≤ Ck
b 1,...,b j min{u,1}k/2
where,asnotedabove,y¯ doesnotdependonx. HereC issomeconstantwhichdependsonlyonthe
b b ,...,b
j 1 j
partition{b ,...,b }andisindependentofx. Ontheotherhand,wecanalsoobtainasimplelowerbound
1 j
onq(x). Observethatq(x)iscontinuousandalwayspositive. Recallthatb = sup ∥µ ∥. Thus,
z∈Z z
(cid:90)
q(x) = g(x|z)dΠ(z)
Z
(cid:90) (cid:18) (cid:19)
1 1
≥ exp − sup(x−µ )⊺ Σ−1(x−µ ) dΠ(z)
(2π)d/2sup z∈Zdet(Σ z)1 2 Z 2 z∈Z z z z
(cid:90) (cid:18) (cid:19)
≥
(2π)d/2sup
z1
∈Zdet(Σ z)1
2
Zexp −1
2
zs ∈u Zp(cid:13) (cid:13)Σ− z1(cid:13) (cid:13)(∥x∥2+∥µ z∥2) dΠ(z)
(cid:90) (cid:18) (cid:19)
≥ 1 exp −1 sup(cid:13) (cid:13)Σ−1(cid:13) (cid:13)(∥x∥2+b2) dΠ(z)
(2π)d/2sup z∈Zdet(Σ z)1 2 Z 2 z∈Z z
56(cid:18) (cid:19)
1 V
≥ exp − (∥x∥2+b2) .
(2π)d/2U 2
Therefore,ifwesetC := max C ,weobtain
b ,...,b b ,...,b
1 j 1 j
(cid:12) (cid:12) d2kmax{w,1}k
(cid:12)∂klogq(x)(cid:12) ≤ CkB UkekV(∥x∥2+b2). (61)
(cid:12) a (cid:12) k min{u,1}k/2 2
Theupperboundabove,thoughitdependsonlyonparametersu,U,V,w,hasanexponentialdependenceonx,
whichisnotdesirable. Wenextderiveamorerefinedboundinx. Forbrevityofanalysis, were-expressr
(definedin(60))toavoidemptypartitions:
p
r (x) =
q(x)−p(cid:89) ∂|b j|
q(x), s.t. |b | = ··· = |b | = 0.
b 1,...,b k b j p+1 k
j=1
(cid:13) (cid:13)
Now,bytheboundednessof∥µ
∥and(cid:13)Σ−1/2(cid:13)onZ,foreachx,thereexist(bounded)Σ¯
andµ¯ suchthat,
z (cid:13) z (cid:13) b j b j
∀z ∈ Z,
(cid:88) (cid:12) (cid:12) (cid:12)poly
|b
j|(cid:16) Σ−
z
1 2(x−µ z)(cid:17)(cid:12) (cid:12)
(cid:12)
≤ (cid:88) (cid:12) (cid:12) (cid:12)poly
|b
j|(cid:16) Σ¯ b− j21 (x−µ¯
b
j)(cid:17)(cid:12) (cid:12)
(cid:12)
< ∞.
b∈[d]|bj| b∈[d]|bj|
Then,followingfrom(58),weobtain
(cid:12) (cid:12)
(cid:12) p (cid:12) p
|r b 1,...,b k(x)| = q(x)−p(cid:12) (cid:12) (cid:12)(cid:89) ∂ b|b jj| q(x)(cid:12) (cid:12)
(cid:12)
≤ q(x)−p(cid:89)(cid:12) (cid:12) (cid:12)∂ b|b jj| q(x)(cid:12) (cid:12) (cid:12)
(cid:12)j=1 (cid:12) j=1
(dmax{w,1})(cid:80)p j=1|b j|
≤ ×
up/2
(cid:89)p (cid:82) det(Σ z)−1
2
(cid:80)
c
j∈[d]|bj|(cid:12) (cid:12) (cid:12)poly
|b
j|(cid:16) Σ z− 21 (x−µ z)(cid:17)(cid:12) (cid:12) (cid:12)ϕ(cid:16) Σ−
z
1 2(x−µ z)(cid:17) dΠ(z)
j=1
(cid:82) det(Σ z)−1 2ϕ(cid:16) Σ z− 21 (x−µ z)(cid:17) dΠ(z)
(dmax{w,1})k
≤ ×
min{1,u}k/2
(cid:89)p (cid:80)
c
j∈[d]|bj|(cid:12) (cid:12) (cid:12)poly
|b
j|(cid:16) Σ¯ b− j21 (x−µ¯
b
j)(cid:17)(cid:12) (cid:12) (cid:12)(cid:16) (cid:82) det(Σ z)−1 2ϕ(cid:16) Σ−
z
1 2(x−µ z)(cid:17) dΠ(z)(cid:17)
j=1
(cid:82) det(Σ z)−1 2ϕ(cid:16) Σ z− 21 (x−µ z)(cid:17) dΠ(z)
= (dmax{w,1})k (cid:89)p (cid:88) (cid:12) (cid:12)poly (cid:16) Σ¯− 21 (x−µ¯ )(cid:17)(cid:12) (cid:12)
min{1,u}k/2 (cid:12) |b j| b j b j (cid:12)
j=1 c j∈[d]|bj|
Notethatforeachj,thenumberoftermsinthesummationaboveisupper-boundedbyd|b j|. Thus,expanding
the product of summations would result in no more than (cid:81)p d|b j| = dk terms. Also, since (cid:12) (cid:12)poly (y)(cid:12) (cid:12)·
j=1 k 1
(cid:12)
(cid:12)poly k
2(y)(cid:12)
(cid:12) =
(cid:12)
(cid:12)poly k 1+k
2(y)(cid:12) (cid:12),andsinceanyΣ¯−
b
j1
2(x−µ¯ b j)islinearinxandindependentinz,eachproduct
termisak-thorderpolynomialinx. Therefore,weobtain
d2kmax{w,1}k
|r (x)| ≤ max |poly (x)|
b 1,...,b k min{1,u}k/2 c j∈[d]|bj|,∀j=1,...,p k
andthus
(cid:12) (cid:12) d2kmax{w,1}k
(cid:12)∂klogq(x)(cid:12) ≤ B max max |poly (x)|. (62)
(cid:12) a (cid:12) k min{1,u}k/2 b 1,...,b kc j∈[d]|bj|,∀j=1,...,p k
57(cid:12) (cid:12)
Wehavethusidentifiedanupperboundon(cid:12)∂klogq(x)(cid:12)whichispolynomialinx. Theproofisnowcomplete
a
bycombining(61)and(62).
F.4 ProofofCorollary4
Wefirstidentifyu,U,V,w forΣ suchthattheyareindependentofT andk forallt ≥ 1. Fixt ≥ 1. Weuse
t,n
thefactthatΣ = α¯ Σ +(1−α¯ )I . Ifweletλ ≥ ··· ≥ λ > 0astheeigenvaluesofΣ (which
t,n t 0,n t d n,1 n,d 0,n
donotdependonT),theeigenvaluesofΣ are{α¯ λ +(1−α¯ )}d . Therefore,foranyn = 1,...,N
t,n t n,i t i=1
andt ≥ 1,
d d
(cid:89) (cid:89)
(u :=) min{minλ ,1} ≤ det(Σ ) ≤ max{maxλ ,1}(=: U).
n,i t,n n,i
n n
i=1 i=1
Also, following from (48), we have V := 1 . Next, write the eigen-decomposition as Σ =
min{1,min λ } 0,n
Q diag(λ ,...,λ )Q⊺ ,whereQ hereisanorthn onn, od rmalmatrix(thatdoesnotdependonT). Then,for
n n,1 n,d n n
anyt ≥ 1,
Σ− t,n1 2 = Q n(α¯ tdiag(λ n,1,...,λ n,d)+(1−α¯ t)I d)−1 2Q⊺
n
= Q diag((α¯ λ +(1−α¯ ))−1,...,(α¯ λ +(1−α¯ ))−1)Q⊺
n t n,1 t 2 t n,d t 2 n
andthus,forallt ≥ 1,
d
[Σ t− ,n21 ]ij = (cid:88) (α¯ tλ
n,k
+(1−α¯ t))− 21Qi nkQk nj
k=1
(cid:12) (cid:12)
d
(cid:12)(cid:88) (cid:12)
≤ (min{1,minλ })−1 max (cid:12) QikQkj(cid:12) =: w.
n,d 2 (cid:12) n n (cid:12)
n n∈[N],i,j∈[d](cid:12) (cid:12)
k=1
Sincetheidentifiedu,U,V,w areallindependentofT andk,byLemma15wehaveobtainedanupperbound
(cid:12) (cid:12)
on(cid:12)∂klogq(x)(cid:12)foranyfixedxwhichisindependentofT. Also,intermsofk,wecanusetheexponential
a
generatingfunctionforB andshowthat,foranyr ∈ R,
k
∞
(cid:88) B p rp = eer −1 < ∞.
p!
p=1
This shows that the infinite sum of U (x) converges after scaled by k!. Now, note that under Gaussian
k
g(x |z) the expected value of any k-th order polynomial term in x is finite and is equal to the k-th order
t t
non-centralizedmoment. UsingtheresultsonGaussiannon-centralizedmoment,wehavefromLemma15,
forallp ≥ 1,
(cid:90) (cid:90)
E
X t∼Q
t[U k(X t)p] ≤ C kp (cid:12) (cid:12)poly pk(x t)(cid:12) (cid:12)g(x t|z)dx tdΠ(z)
(cid:90)
= C kp (cid:12) (cid:12)poly pk(µ z,Σ z)(cid:12) (cid:12)dΠ(z)
(cid:26) (cid:27)kp
≤ (C k′)pmax 1,maxmax(cid:12) (cid:12)µi z(cid:12) (cid:12) max (cid:12) (cid:12)[Σ z]ij(cid:12) (cid:12) < ∞
z∈Z i∈[d] i,j∈[d]
whereC andC′ aresomeconstantsthatdependonlyonk. Thisisfinitebecauseeachelementofµ andΣ
k k z z
hasafiniteupperboundthatisindependentofT. Combiningalltheabove,wehaveshownAssumption4.
58F.5 ProofofLemma16
Theproofissimilartothatof[18,Eq(39)]. First,notethatifT islarge,
(cid:18) (cid:19) T
δ 1+ clogT logT ≍ δec > 1.
T
Thus,fort ≥ T(≥ T ),wehave
2 logT
(cid:40) (cid:41)
clogT
(cid:18) clogT(cid:19)t
clogT
1−α = min δ 1+ ,1 = .
t
T T T
Asaresult,
(cid:89)T (cid:18) clogT(cid:19)⌈T/2⌉ (cid:18)(cid:24) T(cid:25)(cid:18) clogT(cid:19)(cid:19)
α¯ ≤ α = 1− ≍ exp − = T−c/2. (63)
T t
T 2 T
t=⌊T/2⌋
Thisshowsthatα satisfiesα¯ =
o(cid:0) T−1(cid:1)
ifc > 2.
t T
Defineτ suchthat
(cid:18) clogT(cid:19)τ (cid:18) clogT(cid:19)τ+1
δ 1+ ≤ 1 < δ 1+ . (64)
T T
Hereτ isuniquesince1−α isnon-decreasing. Inotherwords,τ isthelasttimethat1−α isexponentially
t t
growing. AssumethatT islargeenoughsuchthatτ ≥ 2. Below,weshowthat
1
(cid:18) clogT(cid:19)t
1−α¯ ≥ δ 1+ , ∀2 ≤ t ≤ τ. (65)
t−1
3 T
Ift = 2,
(cid:18) (cid:19)
1 clogT
1−α¯ = 1−α¯ = 1−α = δ ≥ δ 1+ .
t−1 1 1
3 T
HerethelastinequalityholdswhenT issufficientlylarge. Fort > 2,supposeforpurposeofcontradictionthat
thereexists2 < t ≤ τ suchthat
0
1
(cid:18) clogT(cid:19)t
0 1
(cid:18) clogT(cid:19)t
1−α¯ < δ 1+ while1−α¯ ≥ δ 1+ , ∀2 ≤ t ≤ t −1.
t −1 t−1 0
0 3 T 3 T
Inwords,t isdefinedasthefirsttimethat(65)isviolated. Toarriveatacontradiction,wefirstwrite
0
(cid:18) (cid:19)
α¯ (1−α )
t −2 t −1
1−α¯ = (1−α¯ ) 1+ 0 0
t −1 t −2
0 0 1−α¯
t −2
0
1
(cid:18) clogT(cid:19)t 0−1(cid:18)
α¯ (1−α
)(cid:19)
t −2 t −1
≥ δ 1+ 1+ 0 0 .
3 T 1−α¯
t −2
0
Heretheinequalityholdsbecauset isthefirsttimethat(65)isviolated,andthus(65)stillsholdsfort = t −1.
0 0
Also,
(i) 1 (cid:18) clogT(cid:19)t 0 (ii) 1 (cid:18) clogT(cid:19)t 0−1 (iii) 1
1−α¯ ≤ 1−α¯ < δ 1+ ≤ δ 1+ ≤
t −2 t −1
0 0 3 T 2 T 2
where (i) holds because (65) is violated at t = t , (ii) holds when T is sufficiently large, and (iii) holds
0
becauset −1 ≤ τ andbythedefinitionofτ in(64). Thus,
0
(cid:16) (cid:17)t −1
1clogTδ 1+ clogT 0
α¯ t −2(1−α t −1) 2 T T clogT
0 0 ≥ = ,
1−α¯
t 0−2
1δ(cid:16)
1+
clogT(cid:17)t 0−1 T
2 T
59andthus
1
(cid:18) clogT(cid:19)t 0−1(cid:18)
α¯ (1−α
)(cid:19)
1
(cid:18) clogT(cid:19)t
0
t −2 t −1
1−α¯ ≥ δ 1+ 1+ 0 0 ≥ δ 1+ .
t −1
0 3 T 1−α¯ 3 T
t −2
0
Wehavereachedacontradiction. Therefore,wehaveshownthat(65)holds.
Now,(65)impliesthat
1
(cid:18) clogT(cid:19)t
1
(cid:18) clogT(cid:19)t/p
1−α¯ ≥ δ 1+ ≥ δ 1+ , ∀2 ≤ t ≤ τ.
t−1
3 T 3 T
Therearetwocases:
• If2 ≤ t ≤ τ,then
(cid:16) (cid:17)t
1−α
t
clo TgTδ 1+ clo TgT 3pclogT
≤ = .
(1−α¯ )p (cid:16) (cid:17)t δp−1T
t−1 1 δp 1+ clogT
3p T
• Ift > τ,then
(cid:16) (cid:17)
clogT clogT 1+ clogT
1−α t ≤ 1−α t ≤ T = T T
(1−α¯ t−1)p (1−α¯ τ−1)p 1 δp(cid:16) 1+ clogT(cid:17)τ 3−pδp−1(cid:16) 1+ clogT(cid:17)τ+1
3p T T
3pclogT (cid:18) clogT(cid:19)
< 1+ .
δp−1T T
Inbothcases,ifT islargeenough,
1−α 4pclogT logT
t ≤ ≲ , ∀2 ≤ t ≤ T
(1−α¯ )p δp−1T δp−1T
t−1
becausepandcareconstants(thatdonotdependonT,d,andδ). Theproofisnowcomplete.
F.6 ProofofLemma17
√
WeusethesamenotationasinLemma6: Q˜ denotesthedistributionof α¯ x ,g(x)denotesthep.d.f. (w.r.t.
0√ t 0
theLebesguemeasure)ofthedistributionof 1−α¯ w¯ ,and
t t
(cid:90)
q (x) = g(x−x )dQ˜ (x ).
t 0 0 0
Now, we first need to identify u,U,V,w from Σ ≡ (1−α¯ )I , ∀x ∈ supp(Q˜ ), ∀t ≥ 1. Note that
t,x t d 0 0
0
1−α¯ ≥ 1−α = δ. Therefore,forallt ≥ 1,
t 1
u := δd ≤ det(Σ ) ≤ 1 =: U
t,x
0
(cid:13) (cid:13)Σ−1 (cid:13) (cid:13) ≤ 1 =: V
t,x 0 δ
(cid:12) (cid:12)[Σ− 21 ]ij(cid:12) (cid:12) ≤ √1 =: w.
(cid:12) t,x (cid:12)
0 δ
Sincetheidentifiedu,U,V,w areallindependentofT andk,byLemma15wehaveobtainedanupperbound
(cid:12) (cid:12)
on (cid:12)∂ aklogq t(x)(cid:12) for all k ≥ 1 and t ≥ 1, a bound that is independent of T and polynomial in x. With the
samelineofargumentinCorollary4,theinfinitesumofU (x)convergesifscaledbyk!.
k
60Finally,since[Σ ]ij ≤ 1−α¯ ≤ 1,wehavefromLemma15,forallp ≥ 1,
t,x t
0
(cid:90) (cid:90)
E
X t∼Q
t[U k(X t)p] ≤ C kp (cid:12) (cid:12)poly pk(x t)(cid:12) (cid:12)g(x t−x 0)dx tdQ˜ 0(x 0)
(cid:90)
≤ C kp (cid:12) (cid:12)poly pk(x 0)(cid:12) (cid:12)dQ˜ 0(x 0)
(cid:40) (cid:41)pk
≤ Cpmax 1, sup (cid:12) (cid:12)xi(cid:12) (cid:12) < ∞,
k 0
x ∈supp(Q˜ ),i∈[d]
0 0
where C is some constants that only depends on k. Since the support of Q˜ is finite, we have shown
k 0
Assumption4.
F.7 ProofofLemma18
√
Fixt ≥ 2andx ∈ Rd. Recallthatq (x|x )isthep.d.f. ofN( α¯ x ,(1−α¯ )I ). Thegradientoflogq (x)
t t|0 0 t 0 t d t
is
√
(cid:82) ∇q (x|x )dQ (x ) − 1 (cid:82) q (x|x )(x− α¯ x )dQ (x )
∇logq t(x) = (cid:82)x 0∈Rd t|0 0 0 0 = 1−α¯ t x 0(cid:82)∈Rd t|0 0 t 0 0 0 . (66)
q (x|x )dQ (x ) q (x|x )dQ (x )
x ∈Rd t|0 0 0 0 x ∈Rd t|0 0 0 0
0 0
Thus,
√
∇logq (µ )− α ∇logq (x )
t−1 t t t t
√ √ √
− 1 (cid:82) q (µ |x)(µ − α¯ x)dQ (x) − α t (cid:82) q (x |y)(x − α¯ y)dQ (y)
=
1−α¯
t−1
x∈Rd t−1|0 t t t 0
−
1−α¯
t
y∈Rd t|0 t t t 0
(cid:82) (cid:82)
q (µ |x)dQ (x) q (x |y)dQ (y)
x∈Rd t−1|0 t 0 y∈Rd t|0 t 0
= −
1 (cid:32) (cid:18) 1−α¯
t
−1(cid:19) (cid:82) x∈Rdq t−1|0(µ t|x)(µ t−√ α¯ t−1x)dQ 0(x)
(cid:82)
1−α¯ 1−α¯ q (µ |x)dQ (x)
t t−1 x∈Rd t−1|0 t 0
(cid:82) √ (cid:82) √ (cid:33)
+
x∈Rdq t−1|0(µ t|x)(µ t− α¯ t−1x)dQ 0(x) −√
α
y∈Rdq t|0(x t|y)(x t− α¯ ty)dQ 0(y)
(cid:82) t (cid:82)
q (µ |x)dQ (x) q (x |y)dQ (y)
x∈Rd t−1|0 t 0 y∈Rd t|0 t 0
1 (cid:16) (cid:17)
= (1−α¯ −(1−α¯ ))∇logq (µ )
t t−1 t−1 t
1−α¯
t
(cid:32)(cid:82) √ (cid:82) √ (cid:33)
−
1 x∈Rdq t−1|0(µ t|x)(µ t− α¯ t−1x)dQ 0(x) −√
α
y∈Rdq t|0(x t|y)(x t− α¯ ty)dQ 0(y)
(cid:82) t (cid:82)
1−α¯ q (µ |x)dQ (x) q (x |y)dQ (y)
t x∈Rd t−1|0 t 0 y∈Rd t|0 t 0
1−α 1 √
t
≤ |∇logq (µ )|+ |µ − α x |
t−1 t t t t
1−α¯ 1−α¯
t t (cid:124) (cid:123)(cid:122) (cid:125)
term1
(cid:12)(cid:82) √ (cid:82) √ (cid:12)
+
1 (cid:12)
(cid:12)
x∈Rdq t−1|0(µ t|x)( α¯ t−1x)dQ 0(x)
−
α t y∈Rdq t|0(x t|y)( α¯ t−1y)dQ 0(y)(cid:12)
(cid:12). (67)
1−α¯ (cid:12) (cid:82) q (µ |x)dQ (x) (cid:82) q (x |y)dQ (y) (cid:12)
t (cid:12) x∈Rd t−1|0 t 0 y∈Rd t|0 t 0 (cid:12)
(cid:124) (cid:123)(cid:122) (cid:125)
term2
Term1in(67)is
√ x 1−α √
t t
µ − α x = √ + √ ∇logq (x )− α x
t t t t t t t
α α
t t
1−α
t
= √ (x +∇logq (x )).
t t t
α
t
61Toinvestigateterm2,weprovidesomeshort-handnotation. Define
q (µ |x)
t−1|0 t
h (x) :=
t−1 (cid:82)
q (µ |x)dQ (x)
x∈Rd t−1|0 t 0
q (x |x)
t|0 t
h (x) := .
t (cid:82)
q (x |x)dQ (x)
x∈Rd t|0 t 0
Then,term2(withoutabsolutevalue)in(67)becomes
(cid:90) √ (cid:90) √
h (x)( α¯ x)dQ (x)−α h (x)( α¯ x)dQ (x)
t−1 t−1 0 t t t−1 0
x∈Rd x∈Rd
(cid:90) √ √ (cid:90)
= (1−α ) h (x)( α¯ x)dQ (x)+α α¯ (h (x)−h (x))xdQ (x). (68)
t t−1 t−1 0 t t−1 t−1 t 0
x∈Rd x∈Rd
Hereweobtainedacoefficient(1−α )inthefirsttermof(68). Thereasonwhythistermissmallwillbe
t
discussedbelow. Forthesecondtermin(68),
(cid:90)
(h (x)−h (x))xdQ (x)
t−1 t 0
x∈Rd
(cid:90)
1 (cid:0) (cid:1)
= q (µ |x)q (x |y)−q (x |x)q (µ |y) xdQ (y)dQ (x)
q (µ )q (x ) t−1|0 t t|0 t t|0 t t−1|0 t 0 0
t−1 t t t x,y∈Rd
where
q (µ |x)q (x |y)−q (x |x)q (µ |y)
t−1|0 t t|0 t t|0 t t−1|0 t
(cid:18)q (µ |x)q (x |y) (cid:19)
t−1|0 t t|0 t
= q (x |x)q (µ |y) −1
t|0 t t−1|0 t q (x |x)q (µ |y)
t|0 t t−1|0 t
= q (x |x)q (µ |y)×
t|0 t t−1|0 t
(cid:32) (cid:32) √ √ √ √ (cid:33) (cid:33)
∥µ − α¯ x∥2 ∥x − α¯ y∥2 ∥µ − α¯ y∥2 ∥x − α¯ x∥2
t t−1 t t t t−1 t t
exp − − + + −1
2(1−α¯ ) 2(1−α¯ ) 2(1−α¯ ) 2(1−α¯ )
t−1 t t−1 t
=: q (x |x)q (µ |y)(e∆−1)
t|0 t t−1|0 t
inwhichwedefinedtheexponentas∆. Now,
√ √ √ √
∥µ − α¯ x∥2 ∥x − α¯ y∥2 ∥µ − α¯ y∥2 ∥x − α¯ x∥2
t t−1 t t t t−1 t t
∆ = − − + +
2(1−α¯ ) 2(1−α¯ ) 2(1−α¯ ) 2(1−α¯ )
t−1 t t−1 t
√ √
α¯ (x−y)⊺µ +α¯ ∥y∥2−α¯ ∥x∥2 α¯ (x−y)⊺x +α¯ ∥y∥2−α¯ ∥x∥2
t−1 t t−1 t−1 t t t t
= −
2(1−α¯ ) 2(1−α¯ )
t−1 t
(cid:18) √ √ (cid:19)⊺
1 α¯ (1−α ) α¯ (1−α )
t t t−1 t
= x + √ ∇logq (x ) (x−y)
t t t
2 α (1−α¯ )(1−α¯ ) α (1−α¯ )
t t−1 t t t−1
α¯ (1−α )
+ t−1 t (∥y∥2−∥x∥2).
(1−α¯ )(1−α¯ )
t−1 t
Followingfromassumption(51),
√
(cid:18) (cid:19) (cid:18) (cid:19)
α¯ (1−α ) 1−α logT
t t t
= O = O ,
α (1−α¯ )(1−α¯ ) (1−α¯ )2 T
t t−1 t t−1
(cid:18) (cid:19)
1−α logT
t
= O ,
1−α¯ T
t−1
62(cid:18) (cid:19) (cid:18) (cid:19)
α¯ (1−α ) 1−α logT
t−1 t t
= O = O .
(1−α¯ )(1−α¯ ) (1−α¯ )2 T
t−1 t t−1
Forfixedx ,underAssumption4,thisimpliesthat∆ = O(logT/T),andthus
t
(cid:18) log2T(cid:19)
e∆−1 = ∆+O(∆2) = ∆+O .
T2
Now,inordertoupper-boundtheintegralsthatappearinthetwotermsin(68),wenotethatforanyp > 0,
(cid:32) √ (cid:33)
(cid:90) (cid:90) 2
∥x−x / α¯ ∥
q (x |x)∥x∥pdQ (x) = exp − t t ∥x∥pdQ (x).
t|0 t 0 2(1−α¯ )/α¯ 0
x∈Rd x∈Rd t t
(cid:18) √ (cid:19)
Writeu(x) := exp −∥x−x t/ α¯ t∥2 ∥x∥p. Notethatu(x) > 0andthatu(x) ↘ 0as∥x∥ → ∞. Definea
2(1−α¯ )/α¯
t t
(cid:110) (cid:111)
subsetB := x : u(x) ≤ ∥x∥2 . SinceB isboundedawayfrominfinity,thereexistsacompactsetB such
thatB ⊆ B. Bycontinuityofu(x),sup u(x) < ∞. Thus,sincethesecondmomentofQ isboundedby
x∈B 0
Assumption1,wehave
(cid:90) (cid:90) (cid:90)
u(x)dQ (x) = u(x)dQ (x)+ u(x)dQ (x)
0 0 0
x∈Rd x∈B x∈/B
(cid:90)
≤ supu(x)+ ∥x∥2dQ (x) < ∞.
0
x∈B x∈Rd
Thisguaranteesthat
(cid:90)
q (x |x)q (µ |y)∥x−y∥∥x∥dQ (x)dQ (y) < ∞,
t|0 t t−1|0 t 0 0
x,y∈Rd
(cid:90)
q (x |x)q (µ |y)∥y∥2∥x∥dQ (x)dQ (y) < ∞,
t|0 t t−1|0 t 0 0
x,y∈Rd
(cid:90)
q (x |x)q (µ |y)∥x∥3dQ (x)dQ (y) < ∞.
t|0 t t−1|0 t 0 0
x,y∈Rd
(cid:16) (cid:17)
Therefore,combiningtheresultsabove,weconcludethatthesecondtermin(68)isintheorderO 1−α t .
(1−α¯ )2
t−1
Hence,plugginginto(67),weobtain
(cid:18) (cid:19)
√ 1−α
t
∇logq (µ )− α ∇logq (x ) = O .
t−1 t t t t (1−α¯ )3
t−1
G Proof of Theorem 5
Usingthesametechniquein(17)todecomposeKL(Q||P(cid:98)),wealsoneedtodealwiththethreeerrortermsin
(17)fortheacceleratedreverseprocess. Withtheα ’sdefinedinDefinition2,theinitializationerrorsatisfies
t
(cid:20) (cid:21)
q (X )
E log T T = o(T−2).
X T∼Q T p′ (X )
T T
Inthesequel,wefocusonimprovingthereverse-steperrorandtheestimationerrorinafewsteps.
63G.1 Step1: ImprovingEstimationError
We first bound the estimation error, which includes the errors that come from the score and the Hessian
estimation. ThroughoutthissubsectionweperformanalysisunderAssumption4,where,forfixedx andin
t
expectationofX ∼ Q ,allpartialderivativeshaveupperboundsthatdonotdependonT. Inparticular,this
t t
assumptionguaranteesthat(1−α )p∂klogq (x) = O((1−α )p), ∀k,p ≥ 1foranyfixedx ∈ Rd.
t a t t
Tostart,notethatbothP′ andP(cid:98)′ areGaussian(yethavingdifferentmeanandcovariance). Thus,for
t−1|t t−1|t
eacht = 1,...,T,
p (x |x )
t−1|t t−1 t
log
p (x |x )
(cid:98)t−1|t t−1 t
(cid:16) (cid:17) (cid:16) (cid:17)
= log det(Σ )−1 −log det(Σˆ )−1
t 2 t 2
1 1
− (x −µ )⊺ Σ−1(x −µ )+ (x −µˆ )⊺ Σˆ−1(x −µˆ )
2 t−1 t t t−1 t 2 t−1 t t t−1 t
1 (cid:16) (cid:17) 1
= log(det(Σˆ ))−log(det(Σ )) + (x −µ )⊺ (Σˆ−1−Σ−1)(x −µ )
2 t t 2 t−1 t t t t−1 t
1 1
+ (x −µˆ )⊺ Σˆ−1(x −µˆ )− (x −µ )⊺ Σˆ−1(x −µ )
2 t−1 t t t−1 t 2 t−1 t t t−1 t
1 (cid:16) (cid:17) 1
= log(det(Σˆ ))−log(det(Σ )) + (x −µ )⊺ (Σˆ−1−Σ−1)(x −µ )
2 t t 2 t−1 t t t t−1 t
1 1 1
+ (µ −µˆ )⊺ Σˆ−1(x −µ )+ (x −µ )⊺ Σˆ−1(µ −µˆ )+ (µ −µˆ )⊺ Σˆ−1(µ −µˆ ). (69)
2 t t t t−1 t 2 t−1 t t t t 2 t t t t t
Therearefivetermsin(69). Wefirstconsiderthethirdandthefourthterm,forwhichwehave
(cid:104) (cid:105)
E (µ −µˆ )⊺ Σˆ−1(X −µ ) = (µ −µˆ )⊺ Σˆ−1E [X −µ ] = 0,
X t−1∼Q t−1|t t t t t−1 t t t t X t−1∼Q t−1|t t−1 t
(cid:104) (cid:105)
E (X −µ )⊺ Σˆ−1(µ −µˆ ) = E [X −µ ]⊺ Σˆ−1(µ −µˆ ) = 0.
X t−1∼Q t−1|t t−1 t t t t X t−1∼Q t−1|t t−1 t t t t
Nowconsidertheexpectationofthelasttermin(69). FromthedefinitionofΣˆ in(12),forsmall1−α we
t t
haveΣˆ ≻ 0,andwecandefineBˆ := I −(I +(1−α )H )−1,andthusΣˆ−1 = 1 (I −Bˆ ). FromTaylor
t t d d t t t σ2 d t
t
expansion,wehaveBˆ = (1−α )H +O((1−α )2),sincefromAssumption4,foranyfixedx ,H (x )has
t t t t t t t
anupperboundindependentofT. Thus,foreacht ≥ 1,
(cid:104) (cid:105)
E (µ (X )−µˆ (X ))⊺ Σˆ−1(X )(µ (X )−µˆ (X ))
X t∼Q t t t t t t t t t t t
(cid:104) (cid:105)
= (1−α )E (s (X )−∇logq (X ))⊺ (I −Bˆ (X ))(s (X )−∇logq (X ))
t X ∼Q t t t t d t t t t t t
t t
(cid:16)
= (1−α ) E ∥s (X )−∇logq (X )∥2
t X ∼Q t t t t
t t
(cid:104) (cid:105)(cid:17)
−E (s (X )−∇logq (X ))⊺ Bˆ (X )(s (X )−∇logq (X ))
X ∼Q t t t t t t t t t t
t t
and
(cid:12) (cid:104) (cid:105)(cid:12)
(cid:12)E (s (X )−∇logq (X ))⊺ Bˆ (X )(s (X )−∇logq (X )) (cid:12)
(cid:12) X t∼Q t t t t t t t t t t t (cid:12)
(cid:104) (cid:105)
≤ E ∥s (X )−∇logq (X )∥2(cid:0) (1−α )∥H (X )∥+O((1−α )2)(cid:1)
X ∼Q t t t t t t t t
t t
( =i) (1−α )E (cid:104) ∥s (X )−∇logq (X )∥2∥H (X )∥(cid:105) +O((1−α )2)
t X ∼Q t t t t t t t
t t
(cid:113) (cid:113)
≤ (1−α ) E ∥s (X )−∇logq (X )∥4 E ∥H (X )∥2+O((1−α )2)
t X ∼Q t t t t X ∼Q t t t
t t t t
64(ii) (cid:113)
≲ (1−α ) E ∥s (X )−∇logq (X )∥4+O((1−α )2),
t X ∼Q t t t t t
t t
where(i)and(ii)bothfollowfromAssumption4. Therefore,theexpectationofthelasttermin(69)canbe
boundedas
T
(cid:88) E (cid:104) (µ (X )−µˆ (X ))⊺ Σˆ−1(X )(µ (X )−µˆ (X ))(cid:105)
X t∼Q t t t t t t t t t t t
t=1
T
(cid:88)
≲ (1−α )E ∥s (X )−∇logq (X )∥2
t X ∼Q t t t t
t t
t=1
T (cid:113)
(cid:88)
+ (1−α )2 E ∥s (X )−∇logq (X )∥4+O((1−α )3)
t X ∼Q t t t t t
t t
t=1
logT (cid:88)T (cid:113)
≲ E ∥s (X )−∇logq (X )∥4
X ∼Q t t t t
T t t
t=1
≤ (logT)ε2, (70)
where the last line follows by Assumption 5, and note that E ∥s (X )−∇logq (X )∥2 ≤
X ∼Q t t t t
(cid:113) t t
E ∥s (X )−∇logq (X )∥4 followingfromJensen’sinequality.
X ∼Q t t t t
t t
Nextweturntothefirsttwotermsin(69). Thefirsttermisgivenby
log(det(Σˆ ))−log(det(Σ )) = log(det(I +(1−α )H ))−log(det(I +(1−α )∇2logq (x ))).
t t d t t d t t t
When(1−α )issmall,wecanuseTaylorexpansionforthefunctionsdet(·)andlog(·)toget
t
log(det(I +(1−α )H ))
d t t
(cid:18) (1−α )2 (cid:19)
= log 1+(1−α )Tr(H )+ t (Tr(H )2−Tr(H2))+O((1−α )3)
t t 2 t t t
(1−α )2 (1−α )2
= (1−α )Tr(H )+ t (Tr(H )2−Tr(H2))− t Tr(H )2+O((1−α )3)
t t 2 t t 2 t t
(1−α )2
= (1−α )Tr(H )− t Tr(H2)+O((1−α )3).
t t 2 t t
Similarexpressioncanbeobtainedforlog(det(I +(1−α )∇2logq (x ))). Thus,thefirsttermin(69)is
d t t t
equalto
log(det(Σˆ ))−log(det(Σ ))
t t
= (1−α )(cid:0) Tr(H )−Tr(∇2logq (x ))(cid:1) − (1−α t)2 (cid:2) Tr(H2)−Tr((∇2logq (x ))2)(cid:3)
t t t t 2 t t t
+O((1−α )3).
t
Forthesecondtermin(69),wefirsttakeexpectationoverx andget
t−1
(cid:104) (cid:105) (cid:16) (cid:17)
E (X −µ )⊺ (Σˆ−1−Σ−1)(X −µ ) = Tr (Σˆ−1−Σ−1)Σ .
X t−1∼Q t−1|t t−1 t t t t−1 t t t t
Toproceed,notethat
(I +(1−α )H )−1 (i =ii) I −(1−α )H +(1−α )2H2+O((1−α )3).
d t t d t t t t t
65Tosee(iii),wewriteS asthetrueinverseofI +(1−α )H . Itsexistenceisguaranteedif(1−α )issmall.
t d t t t
Since
(I +(1−α )H )(I −(1−α )H +(1−α )2H2) = I +O((1−α )3),
d t t d t t t t d t
wehave
(I +(1−α )H )(I −(1−α )H +(1−α )2H2−S ) = O((1−α )3)
d t t d t t t t t t
whichimpliesthatS = I −(1−α )H +(1−α )2H2 +O((1−α )3). Thisshowsthevalidityof(iii).
t d t t t t t
Therefore,
(cid:16) (cid:17)
Tr (Σˆ−1−Σ−1)Σ = Tr(Σˆ−1Σ −I )
t t t t t d
= Tr(cid:0)(cid:2) I −(1−α )H +(1−α )2H2+O((1−α )3)(cid:3)(cid:2) I +(1−α )∇2logq (x )(cid:3) −I (cid:1)
d t t t t t d t t t d
= (1−α )(cid:2) Tr(∇2logq (x ))−Tr(H )(cid:3)
t t t t
+(1−α )2(cid:2) Tr(H2)−Tr(H ∇2logq (x ))(cid:3) +O((1−α )3).
t t t t t t
Addingthistothefirsttermof(69)andtakingexpectationoverX ∼ Q (notingAssumption4here),weget
t t
(cid:104)(cid:16) (cid:17)
E log(det(Σˆ (X )))−log(det(Σ (X )))
X ,X ∼Q t t t t
t−1 t t−1,t
(cid:105)
+(X −µ (X ))⊺ (Σˆ−1(X )−Σ−1(X ))(X −µ (X ))
t−1 t t t t t t t−1 t t
= (1−α t)2 E (cid:2) Tr(H (X )2)−2Tr(H (X )∇2logq (X ))+Tr((∇2logq (X ))2)(cid:3)
X ∼Q t t t t t t t t
2 t t
+O((1−α )3)
t
( =iv) (1− 2α t)2 E
X t∼Q
t(cid:13) (cid:13)H t(X t)−∇2logq t(X t)(cid:13) (cid:13)2
F
+O((1−α t)3),
where(iv)followsbecausefortwosymmetricmatricesAandB,
Tr(A2)−2Tr(AB)+Tr(B2) = Tr(A2)−Tr(AB)−Tr(BA)+Tr(B2)
= Tr((A−B)(A−B)) = Tr((A−B)⊺ (A−B)) = ∥A−B∥2 .
F
Thus,followingfromAssumption5,
T
(cid:88) (cid:104)(cid:16) (cid:17)
E log(det(Σˆ (X )))−log(det(Σ (X )))
X ,X ∼Q t t t t
t−1 t t−1,t
t=1
(cid:105) log2T
+(X −µ (X ))⊺ (Σˆ−1(X )−Σ−1(X ))(X −µ (X )) ≲ ε2 . (71)
t−1 t t t t t t t−1 t t T H
Hereε istheHessianestimationerror. Combining(70)and(71)yieldsthedesiredresultfortheaccelerated
H
estimationerror,whichisintheorderO˜(1/T2).
G.2 Step2: Re-expressingLog-likelihoodRatioinAcceleratedProcess
Nextwefocusonthereverse-steperrorfortheacceleratedprocess. RecallthatQ issmooth. Weintroduce
0
thefollowingnotationsforanalysis. Let
A (x ) := (1−α )∇2logq (x ), B (x ) := I −(I +A )−1, (72)
t t t t t t t d d t
whichimplythat
Σ (x ) = σ2(I +A (x )), Σ−1(x ) = σ−2(I −B (x )).
t t t d t t t t t d t t
(cid:13) (cid:13)
When(1−α t)issmalland(cid:13)∇2logq t(x t)(cid:13)satisfiesAssumption4,wecanperformTaylorexpansiononB
t
aroundA (forfixedx )andobtain
t t
B = A +O((1−α )2). (73)
t t t
Fixt ≥ 1andx ∈ Rd. Writeµ (x ) = µ ,A (x ) = A ,andB (x ) = B forbrevity.
t t t t t t t t t t
66Lemma19. Foranyfixedx ∈ Rd,wehave
t
p′ t−1|t(x t−1|x t)eζ t′ ,t−1(x t,x t−1)
q (x |x ) = ,
t−1|t t−1 t E
X ∼P′
[eζ t′ ,t−1(x t,X t−1)]
t−1 t−1|t
where
1
ζ′ (x ,x ) := ζ (x ,x )− (x −µ )⊺ B (x −µ )
t,t−1 t t−1 t,t−1 t t−1 2σ2 t−1 t t t−1 t
t
√
⊺
= logq (x )−logq (µ )−(x −µ ) ( α ∇logq (x ))
t−1 t−1 t−1 t t−1 t t t t
1
⊺
− (x −µ ) B (x −µ ), (74)
2σ2 t−1 t t t−1 t
t
andζ (x ,x )isasdefinedin(18).
t,t−1 t t−1
Proof. SeeAppendixI.3.
Comparedwiththetiltingfactorfortheregularprocess(in(18)),anadditionaltermthatisrelatedtoΣ (and
t
thusB )isintroducedinζ′ . Throughthisextraterm,wecanfurthercontrolthesecond-orderterminthe
t t,t−1
Taylorexpansionoflogq aroundµ .
t−1 t
Tocontinue,similarto(27),weobtain
(cid:34) (cid:35)
q (X |x )
E log t−1|t t−1 t ≤ E (cid:2) ζ′ (cid:3)
X t−1∼Q t−1|t p′ (X |x ) X t−1∼Q t−1|t t,t−1
t−1|t t−1 t
(cid:18) (cid:19)
1 1
−log 1+E [ζ′ ]+ E [(ζ′ )2]+ E [(ζ′ )3] . (75)
X t−1∼P t−1|t t,t−1 2 X t−1∼P t−1|t t,t−1 3! X t−1∼P t−1|t t,t−1
Note that logq (t ≥ 1) is still analytic by Lemma 6 and Assumption 3. Thus, the Taylor expansion of
t−1
ζ′ (x ,x )aroundx = µ is(cf. (21))
t,t−1 t t−1 t−1 t
√
ζ′ = (∇logq (µ )− α ∇logq (x ))⊺ (x −µ )
t,t−1 t−1 t t t t t−1 t
(cid:18) (cid:19)
1 1
+ (x −µ )⊺ ∇2logq (µ )− B (x −µ )
2 t−1 t t−1 t σ2 t t−1 t
t
∞
(cid:88)
+ T (logq ,x ,µ ) (76)
p t−1 t−1 t
p=3
whereT (f,x,µ)isdefinedin(20). Nowwemoveontoinvestigatetheexpectedvaluesofζ′ underP′
p t,t−1 t−1|t
andQ . InordertodifferentiatefromtheT inAppendixA,wewrite
t−1|t 2
(cid:18) (cid:19)
1 1
T′ := (x −µ )⊺ ∇2logq (µ )− B (x −µ ).
2 2 t−1 t t−1 t σ2 t t−1 t
t
G.3 Step3: ConditionalExpectationofζ′ underP′ andQ
t,t−1 t−1|t t−1|t
BelowwecalculatethecentralizedmomentsunderP′ . Calculationintheacceleratedprocessbecomes
t−1|t
moreinvolvedsincetheP′ isnolongerindependent. Fortunately,wecanemployIsserlis’sTheoremfor
t−1|t
ourhelp,whichconstitutesthemainideainthelemmabelow. Notethattheresultsinthissubsectionholdfor
bothsmooth(∀t ≥ 1)andgeneral(∀t ≥ 2)Q ’s.
0
67Lemma20. Fixt ≥ 1. ForbrevitywriteZ = Xi −µi, ∀i ∈ [d],A = A (x ),andE[·]asashorthandfor
i t−1 t t t
E [·]. Recalltheacceleratedreverseprocessin(10). UnderAssumption4,wehaveA = O(1−α ),
X ∼P′ t t
t−1 t−1|t
andthefollowingresultshold:
(cid:34) (cid:35)
(cid:89)
E Z = 0, ∀a : |a| odd,
i
i∈a
(cid:34) (cid:35)
E
(cid:89)
Z =
O(cid:16)
(1−α
)|a|(cid:17)
, ∀a : |a| even.
i t 2
i∈a
Specifically,fori,j,k,l ∈ [d]alldiffer,thefourthmomentis
E[Z4] = 3σ4(1+Aii)2
i t
E[Z3Z ] = 3σ4Aij(1+Aii)
i j t
E[Z2Z2] = σ4(1+Aii)(1+Ajj)+O((1−α )4)
i j t t
E[Z2Z Z ] = σ4(1+Aii)Ajk +O((1−α )4)
i j k t t
E[Z Z Z Z ] = O((1−α )4).
i j k l t
Fori,j,k ∈ [d]alldiffer,thesixthmomentis
E[Z6] = 15σ6(1+Aii)3
i t
E[Z4Z2] = 3σ6(1+Aii)2(1+Ajj)+O((1−α )4)
i j t t
E[Z2Z2Z2] = σ6(1+Aii)(1+Ajj)(1+Akk)+O((1−α )4),
i j k t t
(cid:104) (cid:105)
andE (cid:81) Z = O((1−α )4)otherwise.
i∈a:|a|=6 i t
Proof. SeeAppendixI.4.
Next we turn to calculate the fifth and sixth centralized moment under Q , again drawing the idea of
t−1|t
Tweedie’sformula[38]. ThisisadirectextensiontoLemma8.
Lemma21. Fixt ≥ 1andx ∈ Rd. UnderAssumption4,wehaveA = O(1−α ). Withthesamedefinitions
t t t
ofx˜ andκ(x˜ )asinLemma8,thefifthcentralizedmomentis
t t
(cid:104) (cid:105)
E (Xi −µi)(Xj −µj)(Xk −µk)(Xl −µl)(Xm −µm)
X t−1∼Q t−1|t t−1 t t−1 t t−1 t t−1 t t−1 t
(cid:88)
= (∂2κ)(∂3 κ)+∂5 κ = O((1−α )4)
ξ {i,j,k,l,m}\ξ ijklm t
ξ∈({i,j,k,l,m})
2
where,givenasetA,wedefine
(cid:18) (cid:19)
A (cid:110) (cid:111)
:= {a ,a } : a ,a ∈ A, a ̸= a .
1 2 1 2 1 2
2
LetPk bethesetthatcontainsalldistinctsize-k partitionsof[n]. Define
n
part (A) := {((a ,a ) : {i,j} ∈ p) : p ∈ P2 }.
2 i j |A|
Thesixthcentralizedmomentis
(cid:104) (cid:105)
E (Xi −µi)(Xj −µj)(Xk −µk)(Xl −µl)(Xm −µm)(Xn −µn)
X t−1∼Q t−1|t t−1 t t−1 t t−1 t t−1 t t−1 t t−1 t
68(cid:88)
= (∂2 κ)(∂2 κ)(∂2 κ)+O((1−α )4)
ξ ξ ξ t
1 2 3
(ξ ,ξ ,ξ )∈part ({i,j,k,l,m,n})
1 2 3 2
 (cid:16) (cid:17)3
 

15 1− αα tt +O((1−α t)4), ifi = j = k = l = m = n
=


3(cid:16)
1− αα
tt(cid:17)3
+O((1−α t)4), ifi = k = m = n ̸= j = l
(cid:16) (cid:17)3
  

1− αα t +O((1−α t)4), ifi = l,j = m,k = nwhilei,j,k alldiffer
 t

O((1−α )4), otherwise
t
Againnotethatallderivativesabovearew.r.t. x˜ .
t
Proof. SeeAppendixI.5.
In the following lemma, we use the results in the previous two lemmas to control the difference
E [ζ′ ] − E [ζ′ ], which will be shown to be the term that dominates the rate
X t−1∼Q t−1|t t,t−1 X t−1∼P t′ −1|t t,t−1
inthereverse-steperror.
Lemma22. Supposethatallderivativesoflogq existandthatAssumption4holds. Then,foranyfixed
t−1
x ∈ Rd,
t
E [ζ′ ]−E [ζ′ ]
X t−1∼Q t−1|t t,t−1 X t−1∼P t′ −1|t t,t−1
=
(1−α t)3 (cid:88)d
∂3 logq (µ )∂3 logq (x )+O((1−α )4).
3/2 ijk t−1 t ijk t t t
3!α
t i,j,k=1
Proof. SeeAppendixI.6.
G.4 Step4: ConditionalMomentsofζ′ underP′
t,t−1 t−1|t
InCorollary1,weimprovetheconvergenceresultinTheorem1byintroducing(6),whichguaranteesthatthe
firstorderterminζ issmallforanyfixedx . Now,inordertoobtainabetterconvergencerateforthe
t,t−1 t
acceleratedsampler,weusethecondition(15)toshowthatthesecondordertermin(76)isalsosmall.
Lemma23. Supposethatboth(6)and (15)hold. UnderAssumption4,withthenoisescheduleaccordingto
Definition2,wehave,foranyt ≥ 1andfixedx ,
t
E [ζ′ ] = O(cid:0) (1−α )1.5(cid:1) ,
X t−1∼P t′
−1|t
t,t−1 t
E [(ζ′ )2] = O(cid:0) (1−α )2(cid:1) ,
X t−1∼P t′
−1|t
t,t−1 t
E [(ζ′ )3] = O(cid:0) (1−α )3.5(cid:1) .
X t−1∼P t′
−1|t
t,t−1 t
Proof. SeeAppendixI.7.
G.5 ImprovingReverse-stepError
Below,wecombineLemmas22and23toupper-boundthereverse-steperrorintheacceleratedprocess. Recall
thatQ issmooth(Assumption3). Followingfrom(75),foreacht ≥ 1andx ∈ Rd,wehave
0 t
(cid:34) (cid:35)
q (X |X )
E log t−1|t t−1 t
X t−1∼Q t−1|t p′ (X |X )
t−1|t t−1 t
≤ E (cid:2) ζ′ (cid:3)
X t−1∼Q t−1|t t,t−1
69(cid:18) (cid:19)
1 1
−log 1+E [ζ′ ]+ E [(ζ′ )2]+ E [(ζ′ )3]
X t−1∼P t′ −1|t t,t−1 2 X t−1∼P t′ −1|t t,t−1 3! X t−1∼P t′ −1|t t,t−1
= E (cid:2) ζ′ (cid:3) −E [ζ′ ]− 1 E [(ζ′ )2]− 1 E [(ζ′ )3]
X t−1∼Q t−1|t t,t−1 X t−1∼P t′ −1|t t,t−1 2 X t−1∼P t′ −1|t t,t−1 3! X t−1∼P t′ −1|t t,t−1
1
(cid:18)
1 1
(cid:19)2
+ E [ζ′ ]+ E [(ζ′ )2]+ E [(ζ′ )3]
2 X t−1∼P t′ −1|t t,t−1 2 X t−1∼P t′ −1|t t,t−1 3! X t−1∼P t′ −1|t t,t−1
(cid:32) (cid:33)
(cid:18)
1 1
(cid:19)3
+O E [ζ′ ]+ E [(ζ′ )2]+ E [(ζ′ )3]
X t−1∼P t′ −1|t t,t−1 2 X t−1∼P t′ −1|t t,t−1 3! X t−1∼P t′ −1|t t,t−1
( =i) E (cid:2) ζ′ (cid:3) −E [ζ′ ]− 1 E [(ζ′ )2]+ 1 (cid:16) E [ζ′ ](cid:17)2
X t−1∼Q t−1|t t,t−1 X t−1∼P t′ −1|t t,t−1 2 X t−1∼P t′ −1|t t,t−1 2 X t−1∼P t′ −1|t t,t−1
+O((1−α )3.5)
t
(ii)
≤ E (cid:2) ζ′ (cid:3) −E [ζ′ ]+O((1−α )3.5)
X t−1∼Q t−1|t t,t−1 X t−1∼P t′ −1|t t,t−1 t
(i =ii) (1−α t)3 (cid:88)d ∂3 logq (µ )∂3 logq (x )+O((1−α )3.5).
3/2 ijk t−1 t ijk t t t
3!α
t i,j,k=1
Here(i)followsfromLemma23,(ii)followsfromJensen’sinequality,and(iii)followsfromLemma22.
Also,recallthatunderAssumption4wecantaketheouterexpectationoverX ∼ Q whilemaintainingthe
t t
rateofeachterm. Therefore,wecansumupovert ≥ 1andobtain
(cid:88)T
E
(cid:20)
log
q t−1|t(X t−1|X t)(cid:21)
X ,X ∼Q
t−1 t t−1,t p (X |X )
t−1|t t−1 t
t=1
 
T d
(cid:88) (cid:88)
≲ (1−α t)3E X t∼Q t ∂ i3 jklogq t−1(µ t)∂ i3 jklogq t(x t). (77)
t=1 i,j,k=1
ThiscompletestheproofofTheorem5.
H Proof of Corollary 3 and Theorems 6 to 8
H.1 ProofofCorollary3
WenowextendTheorem5togeneralQ . Wewillusetheα ’sinEquation(8),yetwithc > 4. From(63),we
0 t
canshowthatthischoiceguaranteesthat
α¯ = o(T−2).
T
Sinceallq (t ≥ 1)exist(byLemma6),ifAssumption4holds,theresultinLemma22stillapplies. Itremains
t
toshowthattheexpectedpowersofζ′ issmallunderP′ . WhenQ issmooth,thisisguaranteedby(6)
t,t−1 t−1|t 0
and(15). Whileananalogyto(6)isshowninLemma18,thereisstillaneedtoshowacounterpartto(15),
whichwepursuebelow.
Lemma 24. Fix t ≥ 2. Suppose that Assumption 4 holds and that the α ’s satisfy (51). For any Q that
t 0
satisfiesAssumption1(notnecessarilyhavingap.d.f.) andanyfixedx ∈ Rd,
t
(cid:18) (cid:19)
1−α
∇2logq (µ )−α ∇2logq (x ) = O t .
t−1 t t t t (1−α¯ )4
t−1
Proof. SeeAppendixI.8.
70UsingLemmas18and24,wecanshowthattheexpectedsecondandthirdpowersofζ′ aresmallunder
t,t−1
P′ ,whichiscontainedinthefollowinglemma.
t−1|t
Lemma25. UnderAssumption4,supposethatboth
√
1. ∇logq (µ )− α ∇logq (x ) = O((1−α )/(1−α¯ )3),and
t−1 t t t t t t−1
2. ∇2logq (µ )−α ∇2logq (x ) = O((1−α )/(1−α¯ )4)
t−1 t t t t t t−1
holdforanyfixedx . Then,iftheα ’ssatisfy(51),fort ≥ 2,wehave
t t
E [ζ′ ] = O(cid:0) (1−α )2/(1−α¯ )4(cid:1) =
O(cid:18) log2T(cid:19)
,
X t−1∼P t′ −1|t t,t−1 t t−1 T2
E [(ζ′ )2] = O(cid:0) (1−α )3/(1−α¯ )6(cid:1) =
O(cid:18) log3T(cid:19)
,
X t−1∼P t′ −1|t t,t−1 t t−1 T3
E [(ζ′ )3] = O(cid:0) (1−α )5/(1−α¯ )10(cid:1) =
O(cid:18) log5T(cid:19)
.
X t−1∼P t′ −1|t t,t−1 t t−1 T5
Proof. SeeAppendixI.9.
Wenowcontinuefrom(75)toprovideanupperboundonthereverse-steperrorforgeneralQ . Notethatthe
0
α t’sin(8)satisfy (1−1− α¯α t
)2
= O(logT/T)byLemma16. Thus,forallt ≥ 2,
t−1
(cid:34) (cid:35)
q (X |X )
E log t−1|t t−1 t
X t−1∼Q t−1|t p′ (X |X )
t−1|t t−1 t
≤ E (cid:2) ζ′ (cid:3) −E [ζ′ ]− 1 E [(ζ′ )2]− 1 E [(ζ′ )3]
X t−1∼Q t−1|t t,t−1 X t−1∼P t′ −1|t t,t−1 2 X t−1∼P t′ −1|t t,t−1 3! X t−1∼P t′ −1|t t,t−1
1
(cid:18)
1 1
(cid:19)2
+ E [ζ′ ]+ E [(ζ′ )2]+ E [(ζ′ )3]
2 X t−1∼P t′ −1|t t,t−1 2 X t−1∼P t′ −1|t t,t−1 3! X t−1∼P t′ −1|t t,t−1
(cid:32) (cid:33)
(cid:18)
1 1
(cid:19)3
+O E [ζ′ ]+ E [(ζ′ )2]+ E [(ζ′ )3]
X t−1∼P t′ −1|t t,t−1 2 X t−1∼P t′ −1|t t,t−1 3! X t−1∼P t′ −1|t t,t−1
( =i) E (cid:2) ζ′ (cid:3) −E [ζ′ ]− 1 E [(ζ′ )2]+ 1 (cid:16) E [ζ′ ](cid:17)2
X t−1∼Q t−1|t t,t−1 X t−1∼P t′ −1|t t,t−1 2 X t−1∼P t′ −1|t t,t−1 2 X t−1∼P t′ −1|t t,t−1
(cid:18) (1−α )4 (cid:19)
t
+O
(1−α¯ )8
t−1
( ≤ii) E (cid:2) ζ′ (cid:3) −E [ζ′ ]+O(cid:18) (1−α t)4 (cid:19)
X t−1∼Q t−1|t t,t−1 X t−1∼P t′ −1|t t,t−1 (1−α¯ t−1)8
(i =ii) (1−α t)3 (cid:88)d ∂3 logq (µ )∂3 logq (x )+O(cid:18) (1−α t)4 (cid:19) .
3/2 ijk t−1 t ijk t t (1−α¯ )8
3!α t−1
t i,j,k=1
Here(i)followsfromLemma25,(ii)followsfromJensen’sinequality,and(iii)followsfromLemma22.
SincetakingtheexpectationwithX ∼ Q doesnotchangetherateofeachterm(Assumption4),theproofis
t t
nowcomplete.
H.2 ProofofTheorem6
Firstwecheckconditions(6)and(15). InLemma13,itisshownthat(6)issatisfiedunderLipschitzgradient.
Itremainstoshow(15)undertheadditionalconditiononLipschitzHessian.
71Lemma26. Supposethat∇logq and∇2logq are,respectively,norm-Lipschitzand2-norm-Lipschitzfor
t t
allt ≥ 0(asin(16)). Then,foranyfixedx ∈ Rd,wehave
t
(cid:13) (cid:13)∇2logq t−1(µ t)−α t∇2logq t(x t)(cid:13) (cid:13)2 = O(1−α t), ∀t ≥ 1.
Asaresult,condition(15)holds.
Proof. SeeAppendixI.10.
In order to continue from Theorem 5 (in particular, (77)), we need to introduce some useful no-
tations for the distribution class in (16). For a matrix A, define its vectorization as vec(A) :=
[A11,...,A1d,...,Ad1,...,Add]⊺ ∈ Rd2. Define K ∈ Rd2×d to be the matrix that reorganizes the third-
t
orderpartialderivativetensor,i.e.,
[K (x)]mk := ∂3 logq (x), s.t.m = (i−1)d+j, ∀i,j,k ∈ [d].
t ijk t
Withthesenotations,considery = x+ξuwhereu ∈ Rd satisfies∥u∥2 = 1andξ ∈ Rissomesmallconstant.
Then,
vec(∇2logq (y))−vec(∇2logq (x)) = K (x∗)(y−x) = ξK (x∗)u.
t t t t
Herex∗ = γx+(1−γ)y forsomeγ ∈ (0,1). Also,wehave
(cid:13) (cid:13)vec(∇2logq t(y))−vec(∇2logq t(x))(cid:13)
(cid:13)
= (cid:13) (cid:13) √∇2logq t(y)−∇2logq t(x)(cid:13) (cid:13)
F √
≤ d(cid:13) (cid:13)∇2logq t(y)−∇2logq t(x)(cid:13) (cid:13) ≤ dM ∥y−x∥
wherethelastinequalitycomesfrom(16). Thus,notingthaty = x+ξuandthat∥u∥2 = 1,wetakethelimit
ofξ to0andget
√
∥K (x)∥ ≤ dM, ∀x ∈ Rd, ∀t ≥ 0.
t
Wenowderiveanexplicitupperboundonthereverse-steperror. UsingCauchy-Schwartzinequality,forany
t ≥ 1andx ∈ Rd,wehave
t
d
(cid:88)
∂3 logq (µ )∂3 logq (x )
ijk t−1 t ijk t t
i,j,k=1
(cid:118) (cid:118)
(cid:117) d (cid:117) d
(cid:117) (cid:88) (cid:117) (cid:88)
≤ (cid:116) (∂ i3 jklogq t−1(µ t))2(cid:116) (∂ i3 jklogq t(x t))2
i,j,k=1 i,j,k=1
= ∥K (µ )∥ ×∥K (x )∥
t−1 t F t t F
√ √
≤ ( d∥K (µ )∥)×( d∥K (x )∥)
t−1 t t t
≤ d2M2.
Therefore,followingfromTheorem5,weobtain
(cid:88)T
E
(cid:20)
log
q t−1|t(X t−1|X t)(cid:21)
≲
d2M2log3T
.
X t−1,X t∼Q t−1,t p (X |X ) T2
t−1|t t−1 t
t=1
72H.3 ProofofTheorem7
WeremindreadersthatAssumption4issatisfiedfromCorollary4. ThisproofissimilartothatofTheorem3,
andweremindreadersofthenotationsq ,µ ,andΣ inTheorem3. Also,condition(6)hasbeenchecked
t,n t,n t,n
inLemma14. InordertoinvokeTheorem5,weneedtochecktheadditionalcondition(15),asshowninthe
followinglemma.
Lemma27. WhenQ isGaussianmixture(seeTheorem3),then,forallfixedx ,
0 t
∇2logq (µ )−α ∇2logq (x ) = O(1−α ).
t−1 t t t t t
Asaresult,(15)holds.
Proof. SeeAppendixI.11.
NowwecontinuefromTheorem5toworkforanexplicitdependenceond. Againwritez (x) := Σ−1(x−
t,n t,n
µ ). Notethat∂ zi = [Σ−1]ik,andthat∂ q (x) = q (x)(−zk (x)).
t,n k t,n t,n k t,n t,n t,n
From(44),thesecondpartialderivativeofitslog-p.d.f. is
(cid:32)
N
1 (cid:88) (cid:16) (cid:17)
∂2 logq (x) = q (x) π q (x) zi (x)zj (x)−[Σ−1]ij
ij t q2(x) t n t,n t,n t,n t,n
t n=1
(cid:124) (cid:123)(cid:122) (cid:125)
N1
(cid:32) (cid:33)(cid:32) (cid:33)(cid:33)
(cid:88) (cid:88)
− π q (x)zi (x) π q (x)zj (x) .
n t,n t,n n t,n t,n
n n
(cid:124) (cid:123)(cid:122) (cid:125)
N2
Tocalculatethethirdpartialderivativeofitslog-p.d.f.,weneedfirsttocalculatethepartialderivativeofN1
andN2. ThederivativeforN1isgivenby
N
(cid:88) (cid:16) (cid:17)
∂ π q (x) zi (x)zj (x)−[Σ−1]ij
k n t,n t,n t,n t,n
n=1
N
(cid:88) (cid:16) (cid:17)
= π q (x)(−zk (x)) zi (x)zj (x)−[Σ−1]ij
n t,n t,n t,n t,n t,n
n=1
N
(cid:88)
+ π q (x)[Σ−1]ikzj (x)+π q (x)[Σ−1]jkzi (x),
n t,n t,n t,n n t,n t,n t,n
n=1
andthederivativefortermN2isgivenby
(cid:32) (cid:33)
N N
(cid:88) (cid:88)
∂ π q (x)zi (x) π q (x)zj (x)
k n t,n t,n n t,n t,n
n=1 n=1
N N
(cid:88) (cid:16) (cid:17)(cid:88)
= π q (x) (−zk (x))zi (x)+[Σ−1]ik π q (x)zj (x)
n t,n t,n t,n t,n n t,n t,n
n=1 n=1
N N
(cid:88) (cid:88) (cid:16) (cid:17)
+ π q (x)zi (x) π q (x) (−zk (x))zj (x)+[Σ−1]jk .
n t,n t,n n t,n t,n t,n t,n
n=1 n=1
73Combiningthese,thederivativeforthenumeratoris
∂ (q (x)N1−N2) = ∂ (q (x))N1+q (x)∂ (N1)−∂ (N2)
k t k t t k k
N N
(cid:88) (cid:88) (cid:16) (cid:17)
= − π q (x)zk (x) π q (x) zi (x)zj (x)−[Σ−1]ij
n t,n t,n n t,n t,n t,n t,n
n=1 n=1
(cid:32)
N
(cid:88) (cid:16) (cid:17)
+q (x) π q (x)(−zk (x)) zi (x)zj (x)−[Σ−1]ij
t n t,n t,n t,n t,n t,n
n=1
(cid:33)
+π q (x)[Σ−1]ikzj (x)+π q (x)[Σ−1]jkzi (x)
n t,n t,n t,n n t,n t,n t,n
N N
(cid:88) (cid:16) (cid:17)(cid:88)
− π q (x) (−zk (x))zi (x)+[Σ−1]ik π q (x)zj (x)
n t,n t,n t,n t,n n t,n t,n
n=1 n=1
N N
(cid:88) (cid:88) (cid:16) (cid:17)
− π q (x)zi (x) π q (x) (−zk (x))zj (x)+[Σ−1]jk
n t,n t,n n t,n t,n t,n t,n
n=1 n=1
N N N
(cid:88) (cid:88) (cid:88)
= −q (x) π q (x)zi (x)zj (x)zk (x)− π q (x)zk (x) π q (x)zi (x)zj (x)
t n t,n t,n t,n t,n n t,n t,n n t,n t,n t,n
n=1 n=1 n=1
N N N N
(cid:88) (cid:88) (cid:88) (cid:88)
+ π q (x)zj (x) π q (x)zi (x)zk (x)+ π q (x)zi (x) π q (x)zj (x)zk (x)
n t,n t,n n t,n t,n t,n n t,n t,n n t,n t,n t,n
n=1 n=1 n=1 n=1
N N N
(cid:88) (cid:88) (cid:88)
+q (x) π q (x)[Σ−1]ijzk (x)+ π q (x)[Σ−1]ij π q (x)zk (x)
t n t,n t,n t,n n t,n t,n n t,n t,n
n=1 n=1 n=1
N N N
(cid:88) (cid:88) (cid:88)
+q (x) π q (x)[Σ−1]ikzj (x)− π q (x)[Σ−1]ik π q (x)zj (x)
t n t,n t,n t,n n t,n t,n n t,n t,n
n=1 n=1 n=1
N N N
(cid:88) (cid:88) (cid:88)
+q (x) π q (x)[Σ−1]jkzi (x)− π q (x)zi (x) π q (x)[Σ−1]jk.
t n t,n t,n t,n n t,n t,n n t,n t,n
n=1 n=1 n=1
Since
(cid:18) (cid:19)
q (x)N1−N2
∂3 logq (x) = ∂ t
ijk t k q2(x)
t
(cid:32) (cid:33)
N
1 (cid:88)
= ∂ (q (x)N1−N2)q (x)+2(q (x)N1−N2) π q (x)zk (x) ,
q3(x) k t t t n t,n t,n
t n=1
weget
q3(x)∂3 logq (x)
t ijk t
N N N
(cid:88) (cid:88) (cid:88)
= −q2(x) π q (x)zi (x)zj (x)zk (x)+q (x) π q (x)zk (x) π q (x)zi (x)zj (x)
t n t,n t,n t,n t,n t n t,n t,n n t,n t,n t,n
n=1 n=1 n=1
N N
(cid:88) (cid:88)
+q (x) π q (x)zj (x) π q (x)zi (x)zk (x)
t n t,n t,n n t,n t,n t,n
n=1 n=1
74N N
(cid:88) (cid:88)
+q (x) π q (x)zi (x) π q (x)zj (x)zk (x)
t n t,n t,n n t,n t,n t,n
n=1 n=1
(cid:32) (cid:33)(cid:32) (cid:33)(cid:32) (cid:33)
N
(cid:88) (cid:88) (cid:88)
−2 π q (x)zi (x) π q (x)zj (x) π q (x)zk (x)
n t,n t,n n t,n t,n n t,n t,n
n n n=1
N N N
(cid:88) (cid:88) (cid:88)
+q2(x) π q (x)[Σ−1]ijzk (x)−q (x) π q (x)[Σ−1]ij π q (x)zk (x)
t n t,n t,n t,n t n t,n t,n n t,n t,n
n=1 n=1 n=1
N N N
(cid:88) (cid:88) (cid:88)
+q2(x) π q (x)[Σ−1]ikzj (x)−q (x) π q (x)[Σ−1]ik π q (x)zj (x)
t n t,n t,n t,n t n t,n t,n n t,n t,n
n=1 n=1 n=1
N N N
(cid:88) (cid:88) (cid:88)
+q2(x) π q (x)[Σ−1]jkzi (x)−q (x) π q (x)zi (x) π q (x)[Σ−1]jk.
t n t,n t,n t,n t n t,n t,n n t,n t,n
n=1 n=1 n=1
Below write ξ t(x,i) := max n(cid:12) (cid:12)z ti ,n(x)(cid:12) (cid:12) and Σ¯ to be a matrix such that Σ¯ij := max n(cid:12) (cid:12)[Σ− t,n1]ij(cid:12) (cid:12). Also write
h (x) = π q (x)/q (x). Notethatforanyx,
(cid:80)N
h (x) = 1. Therefore, wetakemax withineach
t,n n t,n t n=1 t,n n
summationaboveandget
(cid:12) (cid:12)∂ i3 jklogq t(x)(cid:12) (cid:12) ≤ 6ξ t(x,i)ξ t(x,j)ξ t(x,k)+2Σ¯ijξ t(x,k)+2Σ¯ikξ t(x,j)+2Σ¯jkξ t(x,i).
FollowingfromTheorem5,wehave
 
d
(cid:88)
E X t∼Q t ∂ i3 jklogq t−1(µ t(X t))∂ i3 jklogq t(X t)
i,j,k=1
(cid:34)
d
(cid:88) (cid:16)
≤ E 6ξ(µ (X ),i)ξ(µ (X ),j)ξ(µ (X ),k)+2Σ¯ijξ(µ (X ),k)+2Σ¯ikξ(µ (X ),j)
X ∼Q t t t t t t t t t t
t t
i,j,k=1
(cid:35)
(cid:17)(cid:16) (cid:17)
+2Σ¯jkξ(µ (X ),i) 6ξ(X ,i)ξ(X ,j)ξ(X ,k)+2Σ¯ijξ(X ,k)+2Σ¯ikξ(X ,j)+2Σ¯jkξ(X ,i)
t t t t t t t t
 
d
(i) (cid:88) (cid:16) (cid:17)2
≍ E X ∼Q  ξ(X t,i)ξ(X t,j)ξ(X t,k)+Σ¯ijξ(X t,k)+Σ¯ikξ(X t,j)+Σ¯jkξ(X t,i) 
t t
i,j,k=1
 
d
(cid:88)
≤ 2E X ∼Q  ξ(X t,i)2ξ(X t,j)2ξ(X t,k)2+(Σ¯ij)2ξ(X t,k)2+(Σ¯ik)2ξ(X t,j)2+(Σ¯jk)2ξ(X t,i)2 
t t
i,j,k=1
(ii) (cid:104) (cid:105)
≲ min{d,N}3E ∥X ∥6+max∥µ ∥6 +(dmin{d,N})(dmin{d,N})
X ∼Q t t,n
t t n
where(i)followsfrom(46),and(ii)followsfrom(49)and(50). Here
max∥µ ∥6 ≤ max∥µ ∥6 ≲ d3
t,n 0,n
n n
sinceµ < ∞isafixedvector,andtheexpectedsixthpowerofthenormcanbeboundedas
0,n
E∥X t∥6 = E(cid:20) (cid:16)(cid:13) (cid:13)√ α¯ tX 0+√ 1−α¯ tW¯ t(cid:13) (cid:13)2(cid:17)3(cid:21) ≲ (cid:16) E∥X 0∥6+E(cid:13) (cid:13)W¯ t(cid:13) (cid:13)6(cid:17) .
75SinceQ isaGaussianmixture,
0
(cid:90) N (cid:90)
(cid:88)
∥x ∥6q (x )dx = π ∥x ∥6q (x )dx ≍ d3,
0 0 0 0 n 0 0,n 0 0
n=1
andalsoE(cid:13) (cid:13)W¯ t(cid:13) (cid:13)6 ≍ d3. Therefore,followingfromTheorem5,wefinallyobtainaboundonthereverse-step
errorwithexplicitsystemparameters:
(cid:34) (cid:35)
(cid:88)T
E log
q t−1|t(X t−1|X t)
≲
d3min{d,N}3log3T
.
X t−1,X t∼Q t−1,t p′ (X |X ) T2
t=1 t−1|t t−1 t
H.4 ProofofTheorem8
Weremindreadersthatifweusetheα ’sin(8),Assumption4issatisfiedwhenQ hasboundedsupport(by
t 0 √
Lemma 17). We again begin by investigating ∂ i3 jklogq t(x)(t ≥ 1) for general Q 0. Write zi := xi− 1−α¯α¯ txi 0.
t
Notethat∂ q (x|x ) = q (x|x )(−zk). Followingfrom(53),thesecondpartialderivativeoflogq (x)is
k t|0 0 t|0 0 t
givenby
(cid:18) (cid:90)
1
∂2 logq (x) = q (x) q (x|x )zizjdQ (x )
ij t q2(x) t t|0 0 0 0
t
(cid:124) (cid:123)(cid:122) (cid:125)
N1
(cid:90) (cid:90) (cid:19)
1
− q (x|x )zidQ (x ) q (x|x )zjdQ (x ) − I .
t|0 0 0 0 t|0 0 0 0 1−α¯ d
t
(cid:124) (cid:123)(cid:122) (cid:125)
N2
Notethatthelasttermisaconstant. ThederivativefortermN1isgivenby
(cid:90)
∂ q (x|x )zizjdQ (x )
k t|0 0 0 0
(cid:90)
= q (x|x )(−zk)zizj +1(k = i)q (x|x )(1−α¯ )−1zj
t|0 0 t|0 0 t
+1(k = j)q (x|x )(1−α¯ )−1zidQ (x ),
t|0 0 t 0 0
andthederivativefortermN2isgivenby
(cid:18)(cid:90) (cid:90) (cid:19)
∂ q (x|x )zidQ (x ) q (x|x )zjdQ (x )
k t|0 0 0 0 t|0 0 0 0
(cid:90) (cid:16) (cid:17) (cid:90)
= q (x|x ) (−zk)zi+1(k = i)(1−α¯ )−1 dQ (x ) q (x|x )zjdQ (x )
t|0 0 t 0 0 t|0 0 0 0
(cid:90) (cid:90) (cid:16) (cid:17)
+ q (x|x )zidQ (x ) q (x|x ) (−zk)zj +1(k = j)(1−α¯ )−1 dQ (x )
t|0 0 0 0 t|0 0 t 0 0
(cid:18)(cid:90) (cid:19)(cid:90)
= q (x|x )(−zk)zidQ (x )+1(k = i)(1−α¯ )−1q (x) q (x|x )zjdQ (x )
t|0 0 0 0 t t t|0 0 0 0
(cid:90) (cid:18)(cid:90) (cid:19)
+ q (x|x )zidQ (x ) q (x|x )(−zk)zjdQ (x )+1(k = j)(1−α¯ )−1q (x) .
t|0 0 0 0 t|0 0 0 0 t t
Combiningthese,thederivativeforthenumeratorisgivenby
∂ (q (x)N1−N2) = ∂ (q (x))N1+q (x)∂ (N1)−∂ (N2)
k t k t t k k
(cid:90)
= −q (x) q (x|x )zizjzkdQ (x )
t t|0 0 0 0
76(cid:90) (cid:90)
− q (x|x )zkdQ (x ) q (x|x )zizjdQ (x )
t|0 0 0 0 t|0 0 0 0
(cid:90) (cid:90)
+ q (x|x )zjdQ (x ) q (x|x )zizkdQ (x )
t|0 0 0 0 t|0 0 0 0
(cid:90) (cid:90)
+ q (x|x )zidQ (x ) q (x|x )zjzkdQ (x ).
t|0 0 0 0 t|0 0 0 0
Thus,
q (x)N1−N2
∂3 logq (x) = ∂ t
ijk t k q2(x)
t
(cid:18) (cid:90) (cid:19)
1
= ∂ (q (x)N1−N2)q (x)+2(q (x)N1−N2) q (x|x )zkdQ (x )
q3(x) k t t t t|0 0 0 0
t
(cid:18) (cid:90)
1
= −q2(x) q (x|x )zizjzkdQ (x )
q3(x) t t|0 0 0 0
t
(cid:90) (cid:90)
(cid:88)
+q t(x) q t|0(x|x 0)za 1dQ 0(x 0) q t|0(x|x 0)za 2za 3dQ 0(x 0)
a =i,j,k
1
a <a ,a ,a ̸=a
2 3 2 3 1
(cid:90) (cid:90) (cid:90) (cid:19)
−2 q (x|x )zidQ (x ) q (x|x )zjdQ (x ) q (x|x )zkdQ (x ) .
t|0 0 0 0 t|0 0 0 0 t|0 0 0 0
q (x|x )
Now,foreaseofpresentation,defineh (x |x) := t|0 0 . Then,
t 0 q (x)
t
∂3 logq (x)
ijk t
(cid:90)
= − h (x |x)zizjzkdQ (x )
t 0 0 0
(cid:90) (cid:90)
(cid:88)
+ h t(x 0|x)za 1dQ 0(x 0) h t(x 0|x)za 2za 3dQ 0(x 0)
a =i,j,k
1
a <a ,a ,a ̸=a
2 3 2 3 1
(cid:90) (cid:90) (cid:90)
−2 h (x |x)zidQ (x ) h (x |x)zjdQ (x ) h (x |x)zkdQ (x ).
t 0 0 0 t 0 0 0 t 0 0 0
Pluggingthedefinitionofzi,zj,zk,weobtain
3/2 (cid:90) (cid:18) (cid:90) (cid:19)
α¯
∂3 logq (x) = t h (x |x) xi − h (x |x)xidQ (x )
ijk t (1−α¯ )3 t 0 0 t 0 0 0 0
t
(cid:18) (cid:90) (cid:19)(cid:18) (cid:90) (cid:19)
xj − h (x |x)xjdQ (x ) xk − h (x |x)xkdQ (x ) dQ (x )
0 t 0 0 0 0 0 t 0 0 0 0 0 0
(cid:82)
Note that h (x |x)dQ (x ) = 1. Therefore, given any x, we can similarly define a probability measure
t 0 0 0
Q˜ (x |x) (absolutely continuous w.r.t. Q ) such that dQ˜ 0|t(x 0|x) = h (x |x) for all x . Similarly write
0|t 0 0 dQ (x ) t 0 0
0 0
m (x) := E [X ]. Withthesenotations,wecanwrite
t X ∼Q˜ (·|x) 0
0 0|t
(cid:104) (cid:105)
∂3 logq (x) = E (Xi −mi(x))(Xj −mj(x))(Xk −mk(x)) .
ijk t X ∼Q˜ (·|x) 0 t 0 t 0 t
0 0|t
Now consider Q with bounded support. In this case Q˜ has the same (bounded) support as Q for all x.
0 0|t 0
Notethatm (x)isalsocontainedinthissupport. Then,
t
d
(cid:88)
∂3 logq (µ )∂3 logq (x )
ijk t−1 t ijk t t
i,j,k=1
77α¯3/2 α¯3/2 (cid:90) (cid:88)d
= t t−1 (xi −mi (µ ))(xi −mi(x ))
(1−α¯ )3(1−α¯ )3 a t−1 t b t t
t t−1 x ,x ∈Rd
a b i,j,k=1
(xj −mj (µ ))(xj −mj(x ))(xk −mk (µ ))(xk −mk(x ))dQ˜ (x |µ )dQ˜ (x |x )
a t−1 t b t t a t−1 t b t t 0|t−1 a t 0|t b t
3/2 3/2
α¯ α¯
= t t−1 ×
(1−α¯ )3(1−α¯ )3
t t−1
(cid:32) (cid:33)3
(cid:90) d
(cid:88)
(xi −mi (µ ))(xi −mi(x )) dQ˜ (x |µ )dQ˜ (x |x )
a t−1 t b t t 0|t−1 a t 0|t b t
x ,x ∈Rd
a b i=1
3/2 3/2
(i) α¯ α¯
≤ t t−1 ×
(1−α¯ )3(1−α¯ )3
t t−1
(cid:90) (cid:16) (cid:17)3
∥x −m (µ )∥2∥x −m (x )∥2 2 dQ˜ (x |µ )dQ˜ (x |x )
a t−1 t b t t 0|t−1 a t 0|t b t
x ,x ∈Rd
a b
(ii)
≤ (1−α¯ )−3(1−α¯ )−3 max ∥x −x ∥6
t t−1 a b
x ,x :∥x ∥2,∥x ∥2≤R2d
a b a b
where(i)followsfromCauchy–Schwartzinequality,and(ii)followsfromtheassumptionofboundedsupport.
Since √
max ∥x −x ∥ ≤ 2 max ∥x ∥ ≲ R d,
a b a
x ,x :∥x ∥2,∥x ∥2≤R2d x :∥x ∥2≤R2d
a b a b a a
thereverse-steperrorsatisfies
 
(1−α t)3E X t∼Q t
(cid:88)d
∂ i3 jklogq t−1(µ t)∂ i3 jklogq t(x t) ≲
(1−α¯(1− )3α
(t
1)3
−α¯
)3d3R6.
t−1 t
i,j,k=1
Thus,thereverse-steperrorinCorollary3hasanupperboundwithexplicitparameterdependence:
(cid:88)T
E
(cid:20)
log
q t−1|t(X t−1|X t)(cid:21)
≲
d3R6log3T
.
X t−1,X t∼Q t−1,t p (X |X ) δ3T2
t−1|t t−1 t
t=1
AgainnotethathereRdoesnotdependond.
I Auxiliary Proofs for Theorems 5 to 8 and Corollary 3
I.1 ProofofLemma1
Theideaissimilartoscorematching. Definev′(x) := v (x)− 1 I . Foreachi,j ∈ [d],
θ θ 1−α¯ d
t
(cid:32) (cid:32) (cid:33)(cid:33)2
E vij(X )−
∂ i2 jq t(X t)
+
1{i = j}
X t∼Q t θ t q (X ) 1−α¯
t t t
(cid:32) (cid:33)2
∂2q (X )
= E [v′(X )]ij − ij t t
X t∼Q t θ t q (X )
t t
(cid:34) (cid:35)
∂2q (X )
= E (cid:0) [v′(X )]ij(cid:1)2 −2E [v′(X )]ij ij t t +const
X t∼Q t θ t X t∼Q t θ t q (X )
t t
(cid:90)
= E (cid:0) [v′(X )]ij(cid:1)2 −2 [v′(x )]ij∂2q (x )dx +const
X t∼Q t θ t θ t ij t t t
78whereconstdenotestermsthatareindependentofθ,and
(cid:90)
[v′(x )]ij∂2q (x )dx
θ t ij t t t
(cid:90) (cid:90)
= [v′(x )]ij ∂2q (x |x )dQ (x )dx
θ t ij t|0 t 0 0 0 t
(cid:90) (cid:90) ∂2q (x |x )
= q (x |x )[v′(x )]ij ij t|0 t 0 dQ (x )dx
t|0 t 0 θ t q (x |x ) 0 0 t
t|0 t 0
(cid:90) (cid:90)
( =i) q (x |x )[v′(x )]ij(cid:0) ∂2 logq (x |x )+∂ logq (x |x )∂ logq (x |x )(cid:1) dQ (x )dx
t|0 t 0 θ t ij t|0 t 0 i t|0 t 0 j t|0 t 0 0 0 t
(cid:32) √ √ (cid:33)
(cid:90) (cid:90) 1{i = j} xi − α¯ xi xj − α¯ xj
= q (x |x )[v′(x )]ij − + t t 0 · t t 0 dQ (x )dx
t|0 t 0 θ t 1−α¯ 1−α¯ 1−α¯ 0 0 t
t t t
( =ii) E (cid:20) [v′(X )]ij(cid:18) −1{i = j} + 1 W¯ iW¯ j(cid:19)(cid:21)
XX =0∼ √Q α¯0 X,W¯ +t∼ √N 1−(0 α¯,I d W¯) θ t 1−α¯ t 1−α¯ t t t
t t 0 t t
where(i)followsbecauseforanyfunctionf(x)wehave∂2 logf(x) = ∂ i2 jf(x) −(∂ logf(x))(∂ logf(x)),
√ √ ij f(x) i j
and(ii)followsbecausex = α¯ x + 1−α¯ w¯ . Therefore,
t t 0 t t
(cid:32) (cid:32) (cid:33)(cid:33)2
E vij(X )−
∂ i2 jq t(X t)
−
1{i = j}
X t∼Q t θ t q (X ) 1−α¯
t t t
(cid:18) (cid:18) 1{i = j} 1 (cid:19)(cid:19)2
= E [v′(X )]ij − − + W¯ iW¯ j +const
XX =0∼ √Q α¯0 X,W¯ +t∼ √N 1−(0 α¯,I d W¯) θ t 1−α¯ t 1−α¯ t t t
t t 0 t t
(cid:18)
1
(cid:19)2
= E [v (X )]ij − W¯ iW¯ j +const
XX =0∼ √Q α¯0 X,W¯ +t∼ √N 1−(0 α¯,I d W¯) θ t 1−α¯ t t t
t t 0 t t
andtheresultfollowsimmediatelyafterwesumupoveri,j ∈ [d].
I.2 ProofofLemma2
Recallthat
1
⊺
H (x) = v (x)− I −s (x)s (x).
t t 1−α¯ d t t
t
Denote
ε2 H,1 := T1 (cid:88)T E X t∼Q t(cid:13) (cid:13) (cid:13) (cid:13)v t(X t)−(cid:18) ∇ q2q (t X(X )t) + 1−1 α¯ I d(cid:19)(cid:13) (cid:13) (cid:13) (cid:13)2 = O˜(T−1),
t=1 t t t F
1 (cid:88)T (cid:113)
ε2 := E ∥s (X )−∇logq (X )∥4 = O˜(T−2).
H,2 T X t∼Q t t t t t
t=1
ThegoalistoshowthatH iscloseto∇2logq (i.e.,thesecondrelationshipinAssumption5). Giventhat
t t
∇2logq (x) = ∇2q t(x) −(∇logq (x))(∇logq (x))⊺ ,thekeyistocontroltheerrorincurredbys (x)s (x)⊺ ,
t q (x) t t t t
t
whichis
d
(cid:88) (cid:16) (cid:17)2
E si(X )sj(X )−[∇logq (X )]i[∇logq (X )]j
X t∼Q t t t t t t t t t
i,j=1
79d
(cid:88) (cid:16) (cid:17)2
= E (si(X )−[∇logq (X )]i)sj(X )+[∇logq (X )]i(sj(X )−[∇logq (X )]j)
X t∼Q t t t t t t t t t t t t t
i,j=1
d
(i) (cid:88)
≤ 2E (si(X )−[∇logq (X )]i)2(sj(X ))2+([∇logq (X )]i)2(sj(X )−[∇logq (X )]j)2
X t∼Q t t t t t t t t t t t t t
i,j=1
(cid:104) (cid:105)
= 2E ∥s (X )−∇logq (X )∥2(∥∇logq (X )∥2+∥s (X )∥2)
X ∼Q t t t t t t t t
t t
where(i)followsbecause(a+b)2 = a2+b2+2ab ≤ 2a2+2b2. Tocontinue,weusetheCauchy-Schwartz
inequalityandobtain
E ∥s (X )s⊺ (X )−(∇logq (X ))(∇logq (X ))⊺ ∥2
X t∼Q t t t t t t t t t F
(cid:113) (cid:114) (cid:104) (cid:105)
≤ 2 E ∥s (X )−∇logq (X )∥4 2E ∥∇logq (X )∥4+∥s (X )∥4 .
X ∼Q t t t t X ∼Q t t t t
t t t t
Herethesecondtermis
E[∥s (X )∥4] ≤ 8E[∥s (X )−∇logq (X )∥4]+8E[∥∇logq (X )∥4]
t t t t t t t t
≲ E[∥∇logq (X )∥4] < ∞
t t
whichhasanupperboundthatisindependentofT byAssumption4. Therefore,
T
T1 (cid:88) E
X t∼Q
t(cid:13) (cid:13)H t(X t)−∇2logq t(X t)(cid:13) (cid:13)2
F
t=1
≤ 1 (cid:88)T E
X ∼Q
(cid:13) (cid:13) (cid:13)v θ(X t)−(cid:18) ∇2q t(X t) + 1 I d(cid:19)(cid:13) (cid:13) (cid:13)2
T t t(cid:13) q (X ) 1−α¯ (cid:13)
t=1 t t t F
T
+ 1 (cid:88) E ∥s (X )s⊺ (X )−(∇logq (X ))(∇logq (X ))⊺ ∥2
T X t∼Q t t t t t t t t t F
t=1
≲ 1 (cid:88)T E
X ∼Q
(cid:13) (cid:13) (cid:13)v θ(X t)−(cid:18) ∇2q t(X t) + 1 I d(cid:19)(cid:13) (cid:13) (cid:13)2
T t t(cid:13) q (X ) 1−α¯ (cid:13)
t=1 t t t F
1 (cid:88)T (cid:113)
+ E ∥s (X )−∇logq (X )∥4
X ∼Q t t t t
T t t
t=1
= ε2 +ε2 = O˜(T−1).
H,1 H,2
Theproofisnowcomplete.
I.3 ProofofLemma19
ByBayes’rule,foranyx givenfixedx ,wehave
t−1 t
q (x |x )
t−1|t t−1 t
(cid:32) (cid:13) √ (cid:13)2(cid:33)
(cid:13)x t− α tx t−1(cid:13)
∝ q (x )exp −
t−1 t−1
2(1−α )
t
(cid:32) (cid:13) √ (cid:13)2(cid:33)
∝ q (x )p′ (x |x )exp
1
(x −µ )⊺ Σ−1(x −µ )−
(cid:13)x t−1−x t/ α t(cid:13)
t−1 t−1 t−1|t t−1 t 2 t−1 t t t−1 t 2(1−α )/α
t t
80(cid:32) (cid:13) √ (cid:13)2(cid:33)
= q (x )p′ (x |x )exp
1
(x −µ )⊺ (I −B )(x −µ )−
(cid:13)x t−1−x t/ α t(cid:13)
t−1 t−1 t−1|t t−1 t 2σ2 t−1 t d t t−1 t 2(1−α )/α
t t t
(byEquation(72))
(cid:18) (cid:19)
1
∝ p′ (x |x )exp ζ (x ,x )− (x −µ )⊺ B (x −µ ) ,
t−1|t t−1 t t,t−1 t t−1 2σ2 t−1 t t t−1 t
t
Now,withthedefinitionofζ′ (x ,x )inEquation(74),wehave
t,t−1 t t−1
p′ t−1|t(x t−1|x t)eζ t′ ,t−1(x t,x t−1)
q (x |x ) = .
t−1|t t−1 t E
X ∼P′
[eζ t′ ,t−1(x t,X t−1)]
t−1 t−1|t
I.4 ProofofLemma20
TheresultfollowsdirectlyfromIsserlis’sTheorem,whichsaysthat
(cid:34) (cid:35)
n
(cid:89) (cid:88) (cid:89) (cid:88) (cid:89)
E Z = E[Z Z ] = Cov(Z ,Z )
i i j i j
i=1 p∈P2{i,j}∈p p∈P2{i,j}∈p
n n
sinceeachZ iscentered. HereP2 isthesetthatcontainsalldistinctsize-2partitionsof[n]. Forexample,
i n
P2 = {({1,2},{3,4}),({1,3},{2,4}),({1,4},{2,3})}. Thus,sinceA = O(1−α )underAssumption4,
4 t t
(cid:34) (cid:35)
n
(cid:89)
E Z = 0, ifnisodd
i
i=1
(cid:34) (cid:35) (cid:32) (cid:33)
n (cid:18) (cid:19)n
E (cid:89) Z = O 1−α t 2 = O(cid:0) (1−α )n(cid:1) , ifniseven.
i t 2
α
t
i=1
Morespecifically,followingfromIsserlis’sTheorem,thefourthmomentis
E[Z Z Z Z ] = Cov(Z ,Z )Cov(Z ,Z )
i j k l i j k l
+Cov(Z ,Z )Cov(Z ,Z )+Cov(Z ,Z )Cov(Z ,Z ), ∀i,j,k,l ∈ [d].
i k j l i l j k
Here Cov(Z i,Z j) = 1− αα t(1{i = j}+(1−α t)Aij). The fourth moment result follows immediately by
t
pluggingintotheformula. Turningtothesixthmoment,wenotethatweareinterestedonlyinthecoefficients
forthetermsthatgrowatarateO((1−α )3). Sincethesixthmomentconsistsofsumofproducttermsin
t
whichthreecovariancesaremultiplied(givingusarateatleastO((1−α )3)),atleastoneproducttermin
t
the sum must take covariance values only on the diagonal of the matrix. Therefore, only E[Z6], E[Z4Z2],
i i j
andE[Z2Z2Z2]withi,j,k alldiffersatisfythisrequirement,andweimmediatelygetthedesiredresultfrom
i j k
Isserlis’sTheorem.
I.5 ProofofLemma21
TheproofissimilartothatofLemma8. Theideaistousetheinductiverelationship(providedintheproofof
Lemmas8and9):
(cid:16) (cid:17)
⊺ ⊺
D (x,x˜ ) = exp(−x x˜ +κ)∂ exp(x x˜ −κ)D (x,x˜ )
5 t t m t 4 t
= (xm−∂ κ)D (x,x˜ )+∂ D (x,x˜ )
m 4 t m 4 t
(cid:16) (cid:17)
⊺ ⊺
D (x,x˜ ) = exp(−x x˜ +κ)∂ exp(x x˜ −κ)D (x,x˜ )
6 t t n t 5 t
= (xn−∂ κ)D (x,x˜ )+∂ D (x,x˜ ).
n 5 t n 5 t
81LetPk bethesetthatcontainsalldistinctsize-k partitionsof[n]. Weusethedefinitions:
n
(cid:18) (cid:19)
A (cid:110) (cid:111)
:= {a ,...,a } : a ,...,a ∈ A, a ,...,a alldiffer , k ≤ |A|
1 k 1 k 1 k
k
part (A) := {((a ,a ) : {i,j} ∈ p) : p ∈ Pk }.
k i j |A|
RecalltheformulaforD in(38),whichcanbeabbreviatedas(here|a| = 4):
4
(cid:89) (cid:88) (cid:89) (cid:88)
D (x,x˜ ) = (xi−∂ κ)− ∂2κ (xi−∂ κ)+ ∂2κ∂2κ
4 t i b i b c
i∈a b∈(a 2) i∈a\b (b,c)∈part 2(a)
(cid:88)
− ∂3 κ(xi−∂ κ)−∂4κ.
a\{i} i a
i∈a
Alsorecallthedefinitionoff(x)inLemma8andthat(cid:82) f(x)ex⊺x˜ t−κD p(x,x˜ t)dx = 0,throughwhichwecan
findtheexpectedp-thmomentsofE (cid:2)(cid:81) (Xi −µi)(cid:3) . Forreference,thefirstfourmoments
X t−1∼Q t−1|t i∈a t−1 t
are
(cid:90)
f(x)exp(x⊺ x˜ −κ)(xi−∂ κ)dx = 0
t i
(cid:90)
f(x)exp(x⊺ x˜ −κ)(xi−∂ κ)(xj −∂ κ)dx = ∂2κ = O(1−α )
t i j ij t
(cid:90)
f(x)exp(x⊺ x˜ −κ)(xi−∂ κ)(xj −∂ κ)(xk −∂ κ)dx = ∂3 κ = O((1−α )3)
t i j k ijk t
(cid:90)
f(x)exp(x⊺ x˜ −κ)(xi−∂ κ)(xj −∂ κ)(xk −∂ κ)(xl −∂ κ)dx
t i j k l
= (∂2κ)(∂2κ)+(∂2 κ)(∂2κ)+(∂2κ)(∂2 κ)+∂4 κ = O((1−α )2)
ij kl ik jl il jk ijkl t
wherewenotethat∂kκ = O((1−α )k)forallk ≥ 3.
a t
WecancalculateD as(with|a| = 5):
5
D 5(x,x˜ t) = (xa 5 −∂ a κ)D 4(x,x˜ t)+∂ a D 4(x,x˜ t)
5 5
(cid:89) (cid:88) (cid:89) (cid:88) (cid:89)
= (xi−∂ κ)− ∂2κ (xi−∂ κ)− ∂3 κ (xi−∂ κ)
i b i a\b i
i∈a b∈(a) i∈a\b b∈(a) i∈b
2 2
(cid:88)
+ ∂2κ∂2κ(xi−∂ κ)
b c i
i∈a
(b,c)∈part (a\{i})
2
(cid:88) (cid:88)
− ∂4 κ(xi−∂ κ)+ ∂2κ∂3 κ−∂5κ.
a\{i} i b a\b a
i∈a b∈(a)
2
Therefore,
 
(cid:89)
E X t−1∼Q t−1|t (X ti −1−µi t)
i∈a:|a|=5
(cid:88) (cid:88) (cid:88)
= ∂2κ∂3 κ+ ∂3 κ∂2κ− ∂2κ∂3 κ+∂5κ
b a\b a\b b b a\b a
b∈(a) b∈(a) b∈(a)
2 2 2
(cid:88)
= ∂2κ∂3 κ+∂5κ = O((1−α )4).
b a\b a t
b∈(a)
2
82NowweturntocalculateD (andlet|a| = 6):
6
D 6(x,x˜ t) = (xa 6 −∂ a κ)D 5(x,x˜ t)+∂ a D 5(x,x˜ t)
6 6
(cid:89) (cid:88) (cid:89) (cid:88) (cid:89)
= (xi−∂ κ)− ∂2κ (xi−∂ κ)− ∂3 κ (xi−∂ κ)
i b i a\b i
i∈a b∈(a) i∈a\b b∈(a) i∈b
2 3
(cid:88) (cid:89) (cid:88) (cid:89) (cid:88)
− ∂4 κ (xi−∂ κ)+ ∂2κ∂2κ (xi−∂ κ)+ fn(κ)(xi−∂ κ)
a\b i c e i i
b∈(a) i∈b b∈(a) i∈b i∈a
2 2
(c,e)∈part (a\b)
2
(cid:88) (cid:88) (cid:88)
− ∂2κ∂2κ∂2κ+ ∂2κ∂4 κ+ ∂3κ∂3κ−∂6κ.
b c e b a\b b c a
(b,c,e)∈part 2(a) b∈(a 2) (b,c)∈part 3(a)
Here fn(κ) is a function of κ which does not depend on x. Note that fn does not affect the expected value
becauseE [X −µ ] = 0. Therefore,wehave
X ∼Q t−1 t
t−1 t−1|t
 
(cid:89)
E X t−1∼Q t−1|t (X ti −1−µi t)
i∈a:|a|=6
 
(cid:88) (cid:88) (cid:88)
= ∂ b2κ ∂ c2κ∂ e2κ+∂ a4 \bκ+ ∂ a3 \bκ∂ b3κ
b∈(a 2) (c,e)∈part 2(a\b) b∈(a 3)
(cid:88) (cid:88)
+ ∂4 κ∂2κ− ∂2κ∂2κ∂2κ
a\b b b c e
b∈(a) b∈(a)
2 2
(c,e)∈part (a\b)
2
(cid:88) (cid:88) (cid:88)
+ ∂2κ∂2κ∂2κ− ∂2κ∂4 κ− ∂3κ∂3κ+∂6κ
b c e b a\b b c a
(b,c,e)∈part 2(a) b∈(a 2) (b,c)∈part 3(a)
(cid:88) (cid:88) (cid:88)
= ∂2κ∂4 κ+ ∂3κ∂3κ+ ∂2κ∂2κ∂2κ+∂6κ
b a\b b c b c e a
b∈(a 2) (b,c)∈part 3(a) (b,c,e)∈part 2(a)
(cid:88)
= ∂2κ∂2κ∂2κ+O((1−α )5).
b c e t
(b,c,e)∈part (a)
2
Theproofisnowcomplete.
I.6 ProofofLemma22
UnderAssumption4,wecanuseasimilaranalysisasintheproofofLemma7toshowtheabsoluteconvergence
oftheTaylorseries(foranyfixedx andµ ),andthuswearestillabletoexchangetheinfinitesumandthe
t−1 t
expectationunderbothP′ andQ . Thus,weobtain
t−1|t t−1|t
√
E [ζ′ ] = (∇logq (µ )− α ∇logq (x ))⊺E [X −µ ]
X t−1∼P t′
−1|t
t,t−1 t−1 t t t t X t−1∼P t′
−1|t
t−1 t
(cid:20) (cid:18) (cid:19) (cid:21)
1 1
+ E (X −µ )⊺ ∇2logq (µ )− B (X −µ )
2 X t−1∼P t′ −1|t t−1 t t−1 t σ2 t t−1 t
t
∞
(cid:88)
+ E [T (logq ,X ,µ )]
X ∼P′ p t−1 t−1 t
t−1 t−1|t
p=3
andsimilarunderQ duetoitsGaussian-likeconcentrationofcentralizedmoments.
t−1|t
83WeinvestigateeachtermintheTaylorexpansion(76)separately. Firstnotethat
E [T ] = 0 = E [T ]
X ∼Q 1 X ∼P′ 1
t−1 t−1|t t−1 t−1|t
aspreviously. Also,forT′,notethatforanyrandomvariableZ (regardlessofitsdistribution)withEZ = 0
2
andCov(Z) = Σ,themeanofthequadraticform(withfixedmatrixΞ)is
E[Z⊺
ΞZ] =
E[Tr(Z⊺
ΞZ)] = Tr(ΞΣ).
Thisimpliesthat
(cid:20) (cid:18) (cid:19) (cid:21)
1
E [T′] = E (X −µ )⊺ ∇2logq (µ )− B (X −µ )
X t−1∼P t′ −1|t 2 X t−1∼P t′ −1|t t−1 t t−1 t σ2 t t−1 t
t
(cid:18)(cid:18) (cid:19) (cid:19)
1
= Tr ∇2logq (µ )− B Σ
t−1 t σ2 t t
t
(cid:20) (cid:18) (cid:19) (cid:21)
1
= E (X −µ )⊺ ∇2logq (µ )− B (X −µ )
X t−1∼Q t−1|t t−1 t t−1 t σ2 t t−1 t
t
= E [T′].
X t−1∼Q t−1|t 2
UsingLemmas8and20,therateforT is
3
E [T (logq ,X ,µ )]−E [T (logq ,X ,µ )]
X ∼Q 3 t−1 t−1 t X ∼P′ 3 t−1 t−1 t
t−1 t−1|t t−1 t−1|t
= E [T (logq ,X ,µ )]
X ∼Q 3 t−1 t−1 t
t−1 t−1|t
=
(1−α t)3 (cid:88)d
∂3 logq (µ )∂3 logq (x ).
3/2 ijk t−1 t ijk t t
3!α
t i,j,k=1
Using Lemmas 9 and 20, and when the partial derivatives satisfy Assumption 4, the rate for T , T , and
5 7
T (p ≥ 8)canalsobedetermined:
p
E [T (logq ,X ,µ )]−E [T (logq ,X ,µ )]
X ∼Q 5 t−1 t−1 t X ∼P′ 5 t−1 t−1 t
t−1 t−1|t t−1 t−1|t
= E [T (logq ,X ,µ )] = O((1−α )4),
X ∼Q 5 t−1 t−1 t t
t−1 t−1|t
E [T (logq ,X ,µ )]−E [T (logq ,X ,µ )]
X ∼Q 7 t−1 t−1 t X ∼P′ 7 t−1 t−1 t
t−1 t−1|t t−1 t−1|t
= E [T (logq ,X ,µ )] = O((1−α )5),
X ∼Q 7 t−1 t−1 t t
t−1 t−1|t
E [T (logq ,X ,µ )]−E [T (logq ,X ,µ )]
X ∼Q p t−1 t−1 t X ∼P′ p t−1 t−1 t
t−1 t−1|t t−1 t−1|t
= O((1−α )4), ∀p ≥ 8.
t
TheremainingordersareT andT . ThefollowingproofwilldrawfromtheresultsinLemmas8,20and21.
4 6
WriteZ = Xi −µi andAij = [A ]ij fori,j ∈ [d]. ForT ,leti,j,k,l ∈ [d]alldiffer,andthedifference
i t−1 t t 4
(inexpectation)ofeachtermofT is
4
E [Z4]−E [Z4]
X t−1∼Q t−1|t i X t−1∼P t′ −1|t i
(cid:18) 1−α (cid:19)2 (1−α )3
= 3 t +6 t ∂2 logq (x )−3σ4(1+Aii)2+O((1−α )4),
α α2 ii t t t t
t t
E [Z3Z ]−E [Z3Z ]
X t−1∼Q t−1|t i j X t−1∼P t′ −1|t i j
(1−α )3
= 3 t ∂2 logq (x )−3σ4Aij(1+Aii)+O((1−α )4),
α2 ij t t t t
t
E [Z2Z2]−E [Z2Z2]
X t−1∼Q t−1|t i j X t−1∼P t′ −1|t i j
84= (cid:18) 1−α t(cid:19)2 + (1−α t)3 (cid:0) ∂2 logq (x )+∂2 logq (x )(cid:1) −σ4(1+Aii)(1+Ajj)+O((1−α )4)
α α2 ii t t jj t t t t
t t
E [Z2Z Z ]−E [Z2Z Z ]
X t−1∼Q t−1|t i j k X t−1∼P t′ −1|t i j k
(1−α )3
= t ∂2 logq (x )−σ4(1+Aii)Ajk +O((1−α )4),
α2 jk t t t t
t
E [Z Z Z Z ]−E [Z Z Z Z ] = O((1−α )4).
X ∼Q i j k l X ∼P′ i j k l t
t−1 t−1|t t−1 t−1|t
Recallfrom(72)thatA = (1−α )∇2logq (x ) = O(1−α )underAssumption4. Hence,manylow-order
t t t t t
termsabovearecancelled,andweget
E [T (logq ,X ,µ )]−E [T (logq ,X ,µ )] = O((1−α )4).
X ∼Q 4 t−1 t−1 t X ∼P′ 4 t−1 t−1 t t
t−1 t−1|t t−1 t−1|t
NowweturntoT . Leti,j,k ∈ [d]alldiffer,andthedifference(inexpectation)ofeachlowest-ordertermof
6
T is
6
E [Z6]−E [Z6]
X t−1∼Q t−1|t i X t−1∼P t′ −1|t i
(cid:18)
1−α
(cid:19)3
= 15 t −15σ6(1+Aii)3+O((1−α )4),
α t t
t
E [Z4Z2]−E [Z4Z2]
X t−1∼Q t−1|t i j X t−1∼P t′ −1|t i j
(cid:18)
1−α
(cid:19)3
= 3 t −3σ6(1+Aii)2(1+Ajj)+O((1−α )4),
α t t
t
E [Z2Z2Z2]−E [Z2Z2Z2]
X t−1∼Q t−1|t i j k X t−1∼P t′ −1|t i j k
(cid:18)
1−α
(cid:19)3
= t −σ6(1+Aii)(1+Ajj)(1+Akk)+O((1−α )4).
α t t
t
Also,byLemmas20and21,therestofthetermsalreadysatisfyO((1−α )4). Hence,
t
E [T (logq ,X ,µ )]−E [T (logq ,X ,µ )] = O((1−α )4).
X ∼Q 6 t−1 t−1 t X ∼P′ 6 t−1 t−1 t t
t−1 t−1|t t−1 t−1|t
Therefore,thelowestordertermaboveisT ,whoseorderisO((1−α )3). Theproofisnowcomplete.
3 t
I.7 ProofofLemma23
√
Inthisproofwewriteg(x ) = ∇logq (µ )− α ∇logq (x )andΞ(x ) = ∇2logq (µ )−σ−2B (x )
t t−1 t t t t t t−1 t t t t
forbrevity. Followingfrom(15)and(73),weobtain
∥Ξ(x t)∥2 ≤ 2(cid:13) (cid:13) (cid:13) (cid:13)∇2logq t−1(µ t)− σ1 2A t(x t)(cid:13) (cid:13) (cid:13) (cid:13)2 +2(cid:13) (cid:13) (cid:13) (cid:13)σ1 2(A t(x t)−B t(x t))(cid:13) (cid:13) (cid:13) (cid:13)2 = O(1−α t).
t t
Also,notethat∥g(x )∥ ≤ ∥g(x )∥ =
O(cid:0)
(1−α
)0.5(cid:1)
,and∥Ξ(x )∥ ≤ ∥Ξ(x )∥ =
O(cid:0)
(1−α
)0.5(cid:1)
.
t ∞ t t t max t t
RecalltheTaylorexpansionofζ′ from(76),whichis
t,t−1
∞
(cid:88)
ζ′ = T +T′ + T (logq ,x ,µ ),
t,t−1 1 2 p t−1 t−1 t
p=3
where
√
⊺
T = (∇logq (µ )− α ∇logq (x )) (x −µ )
1 t−1 t t t t t−1 t
1
T′ = (x −µ )⊺ Ξ(x )(x −µ )
2 2 t−1 t t t−1 t
85and in the following we write T as a shorthand for T (logq ,x ,µ ). Using the moment results in
p p t−1 t−1 t
Lemma20,itcanbeverifiedthattheexpectedfirstmomentforfixedx is
t
1
E [ζ′ ] = Tr(Ξ(x )Σ (x ))+O(σ4)
X t−1∼P t′ −1|t t,t−1 2 t t t t
(i) 1
≤ ∥Ξ(x )∥Tr(Σ (x ))+O(σ4)
2 t t t t
= O((1−α )1.5).
t
Here(i)directlyfollowsfromVonNeumann’straceinequality,andnotethatΣ (x )issymmetricpositive
t t
definite(whoseeigenvaluesequalsingularvalues)andthat∥Ξ(x )∥isthelargestsingularvalueofΞ(x ). The
t t
finalratefollowsfromtheconditionthatΣ (x ),∥Ξ(x )∥2 = O(1−α ).
t t t t
Recall the expansion for powers of ζ in (42) and (43). The expansion for ζ′ is similar except that
t,t−1 t,t−1
T isreplacedbyT′. UnderAssumption4,itisstillvalidtoexchangetheinfinitesumandtheexpectation.
2 2
CombiningwithLemma20,wehavetheexpectedsecondmomentas
 2
∞
(cid:88)
E X t−1∼P t′ −1|t[(ζ t′ ,t−1)2] = E X t−1∼P t′ −1|tT 1+T 2′ + T p 
p=3
(cid:104) (cid:105)
= E (cid:0) T +T′ +T (cid:1)2 +O(σ6)
X t−1∼P t′
−1|t
1 2 3 t
= E (cid:2) (T )2+2T T +(T′)2(cid:3) +O(σ6) (78)
X t−1∼P t′
−1|t
1 1 3 2 t
= O(cid:0) (1−α )2(cid:1) +O(cid:0) (1−α )2.5(cid:1) +O(cid:0) (1−α )3(cid:1) +O(σ6)
t t t t
=
O(cid:0)
(1−α
)2(cid:1)
.
t
Here the orders can be determined in the following way. Take E (cid:2) (T )2(cid:3) as an example. The
X ∼P′ 1
t−1 t−1|t
totalorderofthistermisthesumof(i)thatcomesfromthevanishingcoefficientgi(x )gj(x )(∀i,j ∈ [d]),
t t
which (after summation) yields O(1−α ) by (6), and (ii) that comes from the expectation E
t X ∼P′
t−1 t−1|t
[(Xi −µi)(Xj −µj)](∀i,j ∈ [d]),whichisO(1−α )foreachi,j ∈ [d]byLemma20.
t−1 t t−1 t t
Under Assumption 4, again using Lemma 20, we get the expected third moment for any fixed x as the
t
following. Notethatallmomentswithoddordersarezero.
E [(ζ′ )3] = E (cid:2) (T +T′ +T +T +T +T )3(cid:3) +O(σ10)
X t−1∼P t′
−1|t
t,t−1 X t−1∼P t′
−1|t
1 2 3 4 5 6 t
(cid:16) (cid:17) (cid:16) (cid:17) (cid:16) (cid:17)
= O E (cid:2) (T )2T′(cid:3) +O E (cid:2) (T )2T (cid:3) +O E (cid:2) (T )2T (cid:3)
X t−1∼P t′
−1|t
1 2 X t−1∼P t′
−1|t
1 4 X t−1∼P t′
−1|t
1 6
(cid:16) (cid:17) (cid:16) (cid:17) (cid:16) (cid:17)
+O E (cid:2) T T′T (cid:3) +O E (cid:2) T T′T (cid:3) +O E [T T T ]
X t−1∼P t′
−1|t
1 2 3 X t−1∼P t′
−1|t
1 2 5 X t−1∼P t′
−1|t
1 3 4
(cid:16) (cid:17) (cid:16) (cid:17) (cid:16) (cid:17)
+O E (cid:2) (T′)3(cid:3) +O E (cid:2) (T′)2T (cid:3) +O E (cid:2) T′(T )2(cid:3)
X t−1∼P t′
−1|t
2 X t−1∼P t′
−1|t
2 4 X t−1∼P t′
−1|t
2 3
+O(σ10) (79)
t
=
O(cid:0)
(1−α
)3.5(cid:1) +O(cid:0)
(1−α
)4(cid:1) +O(cid:0)
(1−α
)5(cid:1) +O(cid:0)
(1−α
)4(cid:1) +O(cid:0)
(1−α
)5(cid:1)
t t t t t
+O(cid:0) (1−α )4.5(cid:1) +O(cid:0) (1−α )4.5(cid:1) +O(cid:0) (1−α )5(cid:1) +O(cid:0) (1−α )4.5(cid:1) +O(σ10)
t t t t t
=
O(cid:0)
(1−α
)3.5(cid:1)
.
t
Theproofisnowcomplete.
86I.8 ProofofLemma24
Fort ≥ 2,notethatlogq andlogq existbyLemma6. Weremindreadersofthedefinitionsofh (x)
t−1 t t−1
andh (x)fromintheproofofLemma18. Alsofromthere,wehaveshownthat,foranyfixedx ∈ Rd,
t
(cid:90) (cid:18) (cid:19)
1−α
t
(h (x)−h (x))poly(x)dQ (x) = O , (80)
t−1 t 0 (1−α¯ )2
x∈Rd t−1
(cid:18) (cid:19)
√ 1−α
t
∇logq (µ )− α ∇logq (x ) = O (81)
t−1 t t t t (1−α¯ )3
t−1
wherepoly(x)isapolynomialinxofarbitraryorder. Wewillbuildontheseresultsinthisproof.
From(53),theHessianoflogq (x)isgivenby
t
∇2logq (x)
t
1 (cid:90) q t|0(x|x 0) √ √
⊺
1
= (x− α¯ x )(x− α¯ x ) dQ (x )− I
(1−α¯ )2 q (x) t 0 t 0 0 0 1−α¯ d
t x ∈Rd t t
0
1 (cid:18)(cid:90) q t|0(x|x 0) √ (cid:19)(cid:18)(cid:90) q t|0(x|x 0) √ (cid:19)⊺
− (x− α¯ x )dQ (x ) (x− α¯ x )dQ (x )
(1−α¯ )2 q (x) t 0 0 0 q (x) t 0 0 0
t x ∈Rd t x ∈Rd t
0 0
1 (cid:90) q t|0(x|x 0) √ √
⊺
= (x− α¯ x )(x− α¯ x ) dQ (x )
(1−α¯ )2 q (x) t 0 t 0 0 0
t x ∈Rd t
0
(cid:124) (cid:123)(cid:122) (cid:125)
term1
1
⊺
− I −(∇logq (x))(∇logq (x)) .
d t t
1−α¯
t (cid:124) (cid:123)(cid:122) (cid:125)
(cid:124) (cid:123)(cid:122) (cid:125) term3
term2
Thedifferencecorrespondingtoterm3is
⊺ ⊺
(∇logq (µ ))(∇logq (µ )) −α (∇logq (x ))(∇logq (x ))
t−1 t t−1 t t t t t t
√
⊺
= (∇logq (µ )− α ∇logq (x ))(∇logq (µ ))
t−1 t t t t t−1 t
√ √
⊺
+( α ∇logq (x ))(∇logq (µ )− α ∇logq (x ))
t t t t−1 t t t t
(cid:18) (cid:19)
1−α
t
= O .
(1−α¯ )3
t−1
Heretheratefollowsfrom(81)underAssumption4.
Forterm2,thecorrespondingdifferenceis
(cid:18) (cid:19) (cid:18) (cid:19)
1 1 1−α 1−α
t t
−α I = I = O .
1−α¯ t 1−α¯ d (1−α¯ )(1−α¯ ) d (1−α¯ )2
t−1 t t−1 t t−1
Forterm1,thecorrespondingdifferenceis
1 (cid:90) √ √
⊺
h (x)(µ − α¯ x)(µ − α¯ x) dQ (x)
(1−α¯ )2 t−1 t t−1 t t−1 0
t−1 x∈Rd
α (cid:90) √ √
t ⊺
− h (x)(x − α¯ x)(x − α¯ x) dQ (x)
(1−α¯ )2 t t t t t 0
t x∈Rd
(cid:20)
1 1
(cid:21)(cid:90)
√ √
⊺
= − h (x)(µ − α¯ x)(µ − α¯ x) dQ (x)
(1−α¯ )2 (1−α¯ )2 t−1 t t−1 t t−1 0
t−1 t x∈Rd
1 (cid:90) √ √
⊺
+ [h (x)−h (x)](µ − α¯ x)(µ − α¯ x) dQ (x)
(1−α¯ )2 t−1 t t t−1 t t−1 0
t x∈Rd
871 (cid:90) (cid:2) √ √ √ (cid:3) √ ⊺
+ h (x) (µ − α¯ x)− α (x − α¯ x) (µ − α¯ x) dQ (x)
(1−α¯ )2 t t t−1 t t t t t−1 0
t x∈Rd
1 (cid:90) √ √ (cid:2) √ √ √ (cid:3)⊺
+ h (x) α (x − α¯ x) (µ − α¯ x)− α (x − α¯ x) dQ (x).
(1−α¯ )2 t t t t t t−1 t t t 0
t x∈Rd
Here
(cid:18) (cid:19)(cid:18) (cid:19)
1 1 1 1 1 1 1
− = + −
(1−α¯ )2 (1−α¯ )2 (1−α¯ )2 1−α¯ 1−α¯ 1−α¯ 1−α¯
t−1 t t t−1 t t−1 t
(cid:18) (cid:19)
1−α
t
= O ,
(1−α¯ )3(1−α¯ )
t t−1
√ √ √ 1−α √
t
(µ − α¯ x)− α (x − α¯ x) = √ (x +∇logq (x ))−(1−α ) α¯ x
t t−1 t t t t t t t t−1
α
t
= O(1−α ).
t
Also,by(80),sincethesecondmomentunderQ isfinite,wehave
0
(cid:90) √ √ (cid:18) 1−α (cid:19)
⊺ t
[h (x)−h (x)](µ − α¯ x)(µ − α¯ x) dQ (x) = O .
t−1 t t t−1 t t−1 0 (1−α¯ )2
x∈Rd t−1
Therefore,wehave
(cid:18) (cid:19)
1−α
∇2logq (µ )−α ∇2logq (x ) = O t .
t−1 t t t t (1−α¯ )4
t−1
I.9 ProofofLemma25
The proof is similar to that for Lemma 25. The sole difference is in the rate of g(x )(= ∇logq (µ )−
√ t t−1 t
α ∇logq (x ))andΞ(x )(= ∇2logq (µ )−σ−2B (x )). NotethatΞ(x ) = O((1−α )/(1−α¯ )4)
t t t t t−1 t t t t t t t−1
by(73).
(cid:16) (cid:17)
SinceΣ t(x t) = O(1−α t)andΞ(x t) = O (1−1− α¯α t
)4
,forthefirstmomentweget
t−1
1 (cid:18) (1−α )2 (cid:19)
E [ζ′ ] = Tr(Ξ(x )Σ (x ))+O(σ4) = O t .
X t−1∼P t′ −1|t t,t−1 2 t t t t (1−α¯ t−1)4
Forthesecondmoment,wecancontinuefrom(78)andget
E [(ζ′ )2]
X t−1∼P t′
−1|t
t,t−1
= E (cid:2) (T )2+2T T +(T′)2(cid:3) +O(σ6)
X t−1∼P t′
−1|t
1 1 3 2 t
(cid:18) (1−α )3 (cid:19) (cid:18) (1−α )3 (cid:19) (cid:18) (1−α )4 (cid:19)
= O t +O t +O t +O(σ6)
(1−α¯ )6 (1−α¯ )6 (1−α¯ )8 t
t−1 t−1 t−1
(cid:18) (1−α )3 (cid:19)
t
= O .
(1−α¯ )6
t−1
Forthethirdmoment,wecancontinuefrom(79)andget
E [(ζ′ )3]
X t−1∼P t′
−1|t
t,t−1
(cid:16) (cid:17) (cid:16) (cid:17) (cid:16) (cid:17)
= O E (cid:2) (T )2T′(cid:3) +O E (cid:2) (T )2T (cid:3) +O E (cid:2) (T )2T (cid:3)
X t−1∼P t′
−1|t
1 2 X t−1∼P t′
−1|t
1 4 X t−1∼P t′
−1|t
1 6
(cid:16) (cid:17) (cid:16) (cid:17) (cid:16) (cid:17)
+O E (cid:2) T T′T (cid:3) +O E (cid:2) T T′T (cid:3) +O E [T T T ]
X t−1∼P t′
−1|t
1 2 3 X t−1∼P t′
−1|t
1 2 5 X t−1∼P t′
−1|t
1 3 4
(cid:16) (cid:17) (cid:16) (cid:17) (cid:16) (cid:17)
+O E (cid:2) (T′)3(cid:3) +O E (cid:2) (T′)2T (cid:3) +O E (cid:2) T′(T )2(cid:3)
X t−1∼P t′
−1|t
2 X t−1∼P t′
−1|t
2 4 X t−1∼P t′
−1|t
2 3
88+O(σ10)
t
(cid:18) (1−α )5 (cid:19) (cid:18) (1−α )5 (cid:19) (cid:18) (1−α )6 (cid:19) (cid:18) (1−α )5 (cid:19)
t t t t
= O +O +O +O
(1−α¯ )10 (1−α¯ )6 (1−α¯ )6 (1−α¯ )7
t−1 t−1 t−1 t−1
(cid:18) (1−α )6 (cid:19) (cid:18) (1−α )5 (cid:19) (cid:18) (1−α )6 (cid:19) (cid:18) (1−α )6 (cid:19)
t t t t
+O +O +O +O
(1−α¯ )7 (1−α¯ )3 (1−α¯ )12 (1−α¯ )8
t−1 t−1 t−1 t−1
(cid:18) (1−α )5 (cid:19)
+O t +O(σ10).
(1−α¯ )4 t
t−1
(cid:18) (1−α )5 (cid:19)
t
= O .
(1−α¯ )10
t−1
Theproofisnowcomplete.
I.10 ProofofLemma26
Usingasimilarprocedureasin[14,Lemma22],wecanobtain
∇2logq (x) =
t
1 (cid:0)E [∇2logq (X )]+Cov (∇logq (X ))(cid:1) .
α X t−1∼Q t−1|t(·|x) t−1 t−1 X t−1∼Q t−1|t(·|x) t−1 t−1
t
Therefore,
∇2logq (µ )−α ∇2logq (x )
t−1 t t t t
= ∇2logq (µ )−E [∇2logq (X )]
t−1 t X ∼Q (·|x ) t−1 t−1
t−1 t−1|t t
(cid:124) (cid:123)(cid:122) (cid:125)
term1
−Cov (∇logq (X )).
X ∼Q (·|x ) t−1 t−1
t−1 t−1|t t
(cid:124) (cid:123)(cid:122) (cid:125)
term2
Forterm1,byJensen’sinequality,wehave
(cid:13) (cid:13)∇2logq t−1(µ t)−E
X ∼Q (·|x
)[∇2logq t−1(X t−1)](cid:13) (cid:13)2
t−1 t−1|t t
≤ E
X ∼Q (·|x
)(cid:13) (cid:13)∇2logq t−1(µ t)−∇2logq t−1(X t−1)(cid:13) (cid:13)2
t−1 t−1|t t
≤ M2E ∥µ −X ∥2
X ∼Q (·|x ) t t−1
t−1 t−1|t t
= O(1−α ),
t
wheretheratefollowsfromLemma8. Forterm2,byJensen’sinequality,wehave
(cid:13) (cid:13)
(cid:13)Cov
X ∼Q (·|x
)(∇logq t−1(X t−1))(cid:13)
t−1 t−1|t t
(cid:13) (cid:13)2
≤ E (cid:13)∇logq (X )−E ∇logq (X˜ )(cid:13)
X t−1∼Q t−1|t(·|x t)(cid:13) t−1 t−1 X˜ t−1∼Q t−1|t(·|x t) t−1 t−1 (cid:13)
(cid:13) (cid:13)2
≤ E (cid:13)∇logq (X )−∇logq (X˜ )(cid:13)
X ,X˜ ∼Q (·|x )(cid:13) t−1 t−1 t−1 t−1 (cid:13)
t−1 t−1 t−1|t t
(cid:13) (cid:13)2
≤ L2·E (cid:13)X −X˜ (cid:13)
X ,X˜ ∼Q (·|x )(cid:13) t−1 t−1(cid:13)
t−1 t−1 t−1|t t
(cid:18) (cid:13) (cid:13)2(cid:19)
≤ 2L2· E ∥X −µ ∥2+E (cid:13)X˜ −µ (cid:13)
X t−1∼Q t−1|t(·|x t) t−1 t X˜ t−1∼Q t−1|t(·|x t)(cid:13) t−1 t(cid:13)
= O(1−α ).
t
HeretherateagainfollowsfromLemma8. Combiningthetwoterms,weobtain
(cid:13) (cid:13)∇2logq t−1(µ t)−α t∇2logq t(x t)(cid:13) (cid:13)2
89≤ 2(cid:13) (cid:13)∇2logq t−1(µ t)−E
X ∼Q (·|x
)[∇2logq t−1(X t−1)](cid:13) (cid:13)2
t−1 t−1|t t
(cid:13) (cid:13)2
+2(cid:13)Cov
X ∼Q (·|x
)(∇logq t−1(X t−1))(cid:13)
t−1 t−1|t t
= O(1−α )+O((1−α )2) = O(1−α ).
t t t
Theproofisnowcomplete.
I.11 ProofofLemma27
FromCorollary4,Assumption4issatisfied. Weremindreadersofthenotationsπ ,q ,µ ,andΣ inthe
n t,n t,n t,n
proofofLemma14. There,wealsoprovedthat,forallm,n ∈ [N],
Σ−1 −Σ−1 = O(1−α ), (82)
t−1,n t,n t
q (µ )q (x )−q (µ )q (x ) = O(1−α ), (83)
t−1,n t t,m t t−1,m t t,n t t
(µ −µ )−(x −µ ) = O(1−α ), (84)
t t−1,n t t,n t
q (µ )q (x )Σ−1 −q (µ )q (x )Σ−1 = O(1−α ), (85)
t−1,n t t,m t t−1,n t−1,m t t,n t t,n t
√
∇logq (µ )− α ∇logq (x ) = O(1−α ). (86)
t−1 t t t t t
From(44),wehave
∇2logq (x)
t
(cid:32) (cid:33)
N N
= (cid:88) π q t,n(x) Σ−1(x−µ )(x−µ )⊺ Σ−1 −(cid:88) π q t,n(x) Σ−1
n q (x) t,n t,n t,n t,n n q (x) t,n
t t
n=1 n=1
(cid:32) (cid:33)(cid:32) (cid:33)⊺
N N
−
(cid:88)
π
q t,n(x)
Σ−1(x−µ )
(cid:88)
π
q t,n(x)
Σ−1(x−µ )
n q (x) t,n t,n n q (x) t,n t,n
t t
n=1 n=1
N N
= (cid:88) π q t,n(x) Σ−1(x−µ )(x−µ )⊺ Σ−1−(cid:88) π q t,n(x) Σ−1−(∇logq (x))(∇logq (x))⊺ .
n q (x) t,n t,n t,n t,n n q (x) t,n t t
t t (cid:124) (cid:123)(cid:122) (cid:125)
n=1 n=1
term3
(cid:124) (cid:123)(cid:122) (cid:125) (cid:124) (cid:123)(cid:122) (cid:125)
term1 term2
Weconsiderthedifferenceassociatedwitheachtermseparately. Forterm3,thedifferenceis
⊺ ⊺
(∇logq (µ ))(∇logq (µ )) −α (∇logq (x ))(∇logq (x ))
t−1 t t−1 t t t t t t
√
⊺
= (∇logq (µ )− α ∇logq (x ))(∇logq (µ ))
t−1 t t t t t−1 t
√ √
⊺
+( α ∇logq (x ))(∇logq (µ )− α ∇logq (x ))
t t t t−1 t t t t
= O(1−α ).
t
Heretheratefollowsfrom(86). Forterm2,thedifferenceis
(cid:80)N π q (µ )Σ−1 (cid:80)N π q (x )Σ−1
n=1 n t−1,n t t−1,n n=1 n t,n t t,n
−α
(cid:80)N
π q (µ )
t (cid:80)N
π q (x )
m=1 m t−1,m t m=1 m t,m t
(cid:80)N π q (µ )Σ−1 (cid:32)(cid:80)N π q (µ )Σ−1 (cid:80)N π q (x )Σ−1(cid:33)
n=1 n t−1,n t t−1,n n=1 n t−1,n t t−1,n n=1 n t,n t t,n
= (1−α ) +α −
t (cid:80)N
π q (µ )
t (cid:80)N
π q (µ )
(cid:80)N
π q (x )
m=1 m t−1,m t m=1 m t−1,m t m=1 m t,m t
(cid:80)N π q (µ )Σ−1
n=1 n t−1,n t t−1,n
= (1−α )
t (cid:80)N
π q (µ )
m=1 m t−1,m t
(cid:80)N π π (q (µ )q (x )Σ−1 −q (µ )q (x )Σ−1)
m,n=1 m n t−1,n t t,m t t−1,n t−1,m t t,n t t,n
+α
t
q (µ )q (x )
t−1 t t t
90= O(1−α ).
t
Heretherateinthelastlinefollowsfrom(85). Forterm1,thedifferenceis
(cid:80)N π q (µ )Σ−1 (µ −µ )(µ −µ )⊺Σ−1
n=1 n t−1,n t t−1,n t t−1,n t t−1,n t−1,n
(cid:80)N
π q (µ )
m=1 m t−1,m t
(cid:80)N π q (x )Σ−1(x −µ )(x −µ )⊺Σ−1
n=1 n t,n t t,n t t,n t t,n t,n
−α
t (cid:80)N
π q (x )
m=1 m t,m t
(cid:80)N π q (µ )Σ−1 (µ −µ )(µ −µ )⊺Σ−1
n=1 n t−1,n t t−1,n t t−1,n t t−1,n t−1,n
= (1−α )
t (cid:80)N
π q (µ )
m=1 m t−1,m t
(cid:80)N
π π D
m,n=1 m n m,n
+α
t
q (µ )q (x )
t−1 t t t
where
D := q (x )q (µ )Σ−1 (µ −µ )(µ −µ )⊺ Σ−1
m,n t,m t t−1,n t t−1,n t t−1,n t t−1,n t−1,n
−q (µ )q (x )Σ−1(x −µ )(x −µ )⊺ Σ−1
t−1,m t t,n t t,n t t,n t t,n t,n
= [q (x )q (µ )−q (µ )q (x )]Σ−1 (µ −µ )(µ −µ )⊺ Σ−1
t,m t t−1,n t t−1,m t t,n t t−1,n t t−1,n t t−1,n t−1,n
(cid:104) (cid:105)
+q (µ )q (x ) Σ−1 −Σ−1 (µ −µ )(µ −µ )⊺ Σ−1
t−1,m t t,n t t−1,n t,n t t−1,n t t−1,n t−1,n
+q (µ )q (x )Σ−1[(µ −µ )−(x −µ )](µ −µ )⊺ Σ−1
t−1,m t t,n t t,n t t−1,n t t,n t t−1,n t−1,n
+q (µ )q (x )Σ−1(x −µ )[(µ −µ )−(x −µ )]⊺ Σ−1
t−1,m t t,n t t,n t t,n t t−1,n t t,n t−1,n
(cid:104) (cid:105)
+q (µ )q (x )Σ−1(x −µ )(x −µ )⊺ Σ−1 −Σ−1
t−1,m t t,n t t,n t t,n t t,n t−1,n t,n
= O(1−α ).
t
Sincethedifferencesinallthreetermsarewellcontrolledusing(82)–(86),theproofiscomplete.
91
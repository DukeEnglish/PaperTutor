Fast and Uncertainty-Aware SVBRDF Recovery from Multi-View Capture
using Frequency Domain Analysis
RUBENWIERSMA,DelftUniversityofTechnology,AdobeResearch,TheNetherlands
JULIENPHILIP,AdobeResearch,NetflixEyelineStudios,UK
MILOŠHAŠAN,AdobeResearch,USA
KRISHNAMULLIA,AdobeResearch,USA
FUJUNLUAN,AdobeResearch,USA
ELMAREISEMANN,DelftUniversityofTechnology,TheNetherlands
VALENTINDESCHAINTRE,AdobeResearch,UK
Spherical Harmonics Relighting
Color Our estimate 5s Mitsuba estimate 70s
Metallicity
Roughness
Uncertainty
Fig.1. Wepresentfastmulti-viewmaterialacquisitionforobjectscapturedinuncontrolledsetups(left).Weproposetobuilduponandextendthesignal
processingframeworkforinverserenderingproposedbyRamamoorthiandHanrahan[2001]:weimprovethemodelwithshadowingandmaskingandpropose
alightweightobjectivefunctionforBRDFfittingusingsphericalharmonicspowerspectra(center).Usingthisobjective,weproposeanuncertaintyestimation
approachrelyingonstatisticalentropy.Weshowthatourmaterialestimationissignificantlyfasterthanpreviousworkandachievessimilarorbetterresults.
Relightableobjectacquisitionisakeychallengeinsimplifyingdigitalasset quantifytheuncertaintyoftheestimation,basedontheavailabledata,high-
creation.Completereconstructionofanobjecttypicallyrequirescaptur- lightingtheareasforwhichpriorsoradditionalsampleswouldberequired
inghundredstothousandsofphotographsundercontrolledillumination, forimprovedacquisitionquality.Wecompareourapproachtoprevious
withspecializedequipment.Therecentprogressindifferentiablerendering workandquantitativelyevaluateourresults,showingsimilarqualityas
improvedthequalityandaccessibilityofinverserenderingoptimization. previousworkinafractionofthetime,andprovidingkeyinformationabout
Nevertheless,underuncontrolledilluminationandunstructuredviewpoints, thecertaintyoftheresults.
thereisnoguaranteethattheobservationscontainenoughinformationtore-
CCSConcepts:•Computingmethodologies→Reflectancemodeling;
constructtheappearancepropertiesofthecapturedobject.Wethuspropose
3Dimaging;Appearanceandtexturerepresentations.
toconsidertheacquisitionprocessfromasignal-processingperspective.
Givenanobject’sgeometryandalightingenvironment,weestimatethe AdditionalKeyWordsandPhrases:Objectacquisition,Appearancecapture,
propertiesofthematerialsontheobject’ssurfaceinseconds.Wedosoby Inverserendering
leveragingfrequencydomainanalysis,consideringtherecoveryofmate-
ACMReferenceFormat:
rialpropertiesasadeconvolution,enablingfasterrorestimation.Wethen
RubenWiersma,JulienPhilip,MilošHašan,KrishnaMullia,FujunLuan,El-
marEisemann,andValentinDeschaintre.2024.FastandUncertainty-Aware
Authors’addresses:RubenWiersma,rubenwiersma@gmail.com,DelftUniversityof SVBRDFRecoveryfromMulti-ViewCaptureusingFrequencyDomainAnal-
Technology,AdobeResearch,TheNetherlands;JulienPhilip,AdobeResearch,Netflix
ysis. 1,1(June2024),17pages.https://doi.org/10.1145/nnnnnnn.nnnnnnn
EyelineStudios,UK;MilošHašan,AdobeResearch,USA;KrishnaMullia,AdobeRe-
search,USA;FujunLuan,AdobeResearch,USA;ElmarEisemann,DelftUniversity
ofTechnology,TheNetherlands;ValentinDeschaintre,deschain@adobe.com,Adobe 1 INTRODUCTION
Research,UK.
Objectreconstructionishighlyattractiveforavarietyofapplica-
tions:fromcreatingassetsandenvironmentsformoviesandvideo
2024.XXXX-XXXX/2024/6-ART$15.00
https://doi.org/10.1145/nnnnnnn.nnnnnnn games,topreservingcultural-heritageobjectsdigitally.Completely
,Vol.1,No.1,Article.Publicationdate:June2024.
4202
nuJ
52
]VC.sc[
1v47771.6042:viXra2 • RubenWiersma,JulienPhilip,MilošHašan,KrishnaMullia,FujunLuan,ElmarEisemann,andValentinDeschaintre
capturing the appearance properties of an object would require Toallowmeaningfulanalysisorefficiencygains,wemakethe
hundredsofphotographsundercontrolledviewpointsandlighting assumptionthatthegeometryandlightingareestimatedorcap-
conditions.Unfortunately,finecontrolofthelightingandviewing turedusingexistingmethods.ForgeometrywecanuseSDFextrac-
conditionsisinconvenient,andimpossibleinmanysetups,suchas tion[RosuandBehnke2023]orscanning[Kuangetal.2023],while
outdoorsorinacrowdedmuseum.Insuchscenariosonlyamore lightingcanbecapturedusingachromeballoranomnidirectional
“passive”captureofobjectappearanceispossible.Inthiswork,we camera.Thisisunlikerecentinverserenderingmethods,which
thereforeassumenocontroloverlightingandsupposethatviews assumeallcomponentsareunknown[Munkbergetal.2022;Sun
arecapturedinanunstructuredmanner.Whilethistypeofcap- etal.2023].Ourunderlyinggoalistomakethebestuseoftheavail-
turecanbeenoughtorecoverthegeometryofanobject,itismore abledataandtobetterunderstandwheresignalismissing,before
challengingtoacquireaccurateappearanceproperties. resortingtodata-drivenoradhocpriors.
RecentapproachesforBRDFrecoveryfrom(under-constrained) FollowingRamamoorthiandHanrahan[2001],wemodelreflected
multi-viewcapturecanmainlybeclassifiedintotwocategories: lightfromasurfaceasaconvolutionofBRDFandincominglighton
(a)acquisitionfromonlyafewimages,relyingondeepnetwork thehemisphere.ToobtaintheBRDF,wereconstructthisconvolu-
priors[Deschaintreetal.2019]and(b)optimizingdirectlyforap- tionfilterandmapittoanalyticalBRDFparameters.Workinginthe
pearance parameters using differentiable rendering [Jakob et al. frequencydomain,aconvolutionisaper-coefficientmultiplication,
2022;Munkbergetal.2022].Themethodstypicallydonotprovide which greatly simplifies analysis and computational complexity.
accuracyguarantees,andthelatteronesoptimizeanill-posedsys- WeproposeseveralkeyimprovementstoRamamoorthiandHan-
tem,withoutprovidinganyuncertaintymeasure.Theoptimization rahan’sapproach.First,wehandleirregularlight-fieldsampling
methodsareoftenslow,duetorequiringmanyiterationsoffull bytransformingtheobservationsofboththeoutgoingandincom-
differentiablerenderingforeveryview. inglightintosphericalharmonics,usinganefficientregularized
Itiseasytomissinformationaboutthespecularbehaviorofan least-squaresapproach.Hereby,wecanusesparseirregulardata
objectwhenlightingandviewpointsareuncontrolled,asitrequires fromtheviewsamplingaswellasregularFibonaccisamplesfrom
aluckyalignmentoflightsourcesandviewingdirections.Toshine theenvironmentlightinginacommonrepresentation.Next,we
ametaphoricallightonthismissinginformation,weproposeto includetheshadowingandmaskingtermsoftheBRDF,discarded
jointlyestimatetheobject’sSVBRDFparametersandtheassociated byRamamoorthiandHanrahan[2001],andupdatethespherical
uncertainty.Weimproveuponaseminalworkstudyinginverse harmonicscoefficientsduringaparametergradient-descentopti-
renderingproblemsfromasignal-processingperspectiveinthefre- mization.Weobtainresultsonparwithafull-featureddifferentiable
quencydomain[RamamoorthiandHanrahan2001].Movingtothe renderingsystem[Jakobetal.2022].Weleveragetherelationship
frequencydomainallowsonetogaininsightabouttheexpected betweenthesphericalharmonicpowerspectraofincomingandout-
stabilityofaninverserenderingsystemtosolve.Forexample,the goinglighttodefineanewobjectivefunctionforinverserendering.
incominglightmustcontainenoughamplitudeinhigh-frequency Asthisobjectiveisextremelylightweighttoevaluate,bothinterms
bandstorecovercertainroughnessvaluesforamicrofacetBRDF. oftimeandmemory,wecanevaluatetheerrorformanyparame-
Otherwise,noiseinthesignalcouldmaketheinversionunstable. tercombinationsinparallel.Weinterprettheerrorasaposterior
Without any amplitude, the inversion would be ill-conditioned, distribution,encodinghowlikelyeachmaterialparametercombi-
but this is unlikely to occur for natural lighting. Unfortunately, nationis,giventheobservations.Thisstatisticalperspectivelets
mappingtheanalysisinthefrequencydomaintopracticalalgo- uscomputetheentropyoftheposteriordistributionasameasure
rithmsisnon-trivial:Forinstance,samplesareoftenassumedto ofuncertainty.Intuitively,observationsthatcanbewellexplained
beequallyspacedforfrequencyanalysiswhilewedealwithun- bymanydifferentparametercombinationsleadtoa‘spread-out’
structuredsparsesamples.Moreover,initsoriginalformulation, probabilitydistributionwithhighentropy,whichreflectsahigher
theconclusionsfromRamamoorthiandHanrahan[2001]requirea uncertainty.Incontrast,whenonlyafewparametercombinations
prioriknowledgeoftheBRDFtoconcludewhethertheinversion arelikely,thedistributionisconcentratedwithlowentropy,reflect-
problemiswell-conditioned. inghighcertainty.Similarly,wecanestimatetheinformationgain
Inthiswork,wetackletheseproblemswithanimprovedfrequency- fromanewviewbyestimatingitsimpactonentropy,potentially
basedformulation,providingbothcomputationalefficiencyandin- providinginteractiveguidanceduringcapture.Thisuncertaintyis
sightintotheunderlyinguncertainty.OurSVBRDFestimationisas alsohighlyrelevanttoweighpriors,increasingpriorweightsfor
accurateasdifferentiablerendering-basedoptimizationand13−35 uncertainestimations.
timesfasterthanthestate-of-the-artdifferentiablepathtracer,Mit- Wevalidateourmaterialparametersanduncertaintyestimations
suba3[Jakobetal.2022].ByfinetuningourresultswithMitsuba, inbothsyntheticandrealacquisitionconditions,comparingthe
weachievebetterrelightingresults(+0.5dBPSNR)inlessthana estimationwithrecentmethods.Oursolutionperformsonparwith
thirdofthetime.Thankstoourextensionofthesignalprocessing state-of-the-artwhilebeing13timesfasterandprovidinguncer-
framework,weobtainanaccurateestimateofstatisticalentropy, tainty.Further,wevalidateourrefinedsignal-processingframework
interpretedasanuncertaintymeasureforeachsurfacepoint.We throughablationstudies,demonstratingclearimprovementover
showthatthisuncertaintycanbeusedtoimproveacquisitionby RamamoorthiandHanrahan[2001].Insummary,weenablefastma-
informationsharingorprovidinginformationabouttheinformation terialreconstructionanduncertaintyestimationviacontributions
providedbyagivenview. tothespaceofSVBRDFestimationfrommulti-viewcapturesunder
naturallighting:
,Vol.1,No.1,Article.Publicationdate:June2024.FastandUncertainty-AwareSVBRDFRecoveryfromMulti-ViewCaptureusingFrequencyDomainAnalysis • 3
• afrequency-spacemethodusingspherical-harmonicspower partofthematerialpropertiesarelikelyfaithfullyreconstructed
spectraforefficientBRDFapproximationandparameterex- andforwhichpartswesimplydonothaveenoughinformation.
plorationfromsparse,irregularsamples,
• weimprovetheconvolutionapproximationofRamamoorthi
2.2 DatapriorsforCapture
andHanrahanbyincorporatingshadowingandmasking,
• we quantify uncertainty in BRDF recovery by leveraging Various approaches propose using data-based priors to simplify
statisticalentropy, andenablelow-informationacquisition,allowingforestimating
• weevaluatevariousapplicationsforimprovedreconstruction (SV)BRDFsfromaslittleasasingleimage.Manysuchapproaches
basedonfastacquisitionanduncertainty. targetflatsurfaces,trainedonalargeamountofdatausingenvi-
ronmentallylitimage(s)[Lietal.2017;Martinetal.2022;Shietal.
Wewillreleaseourimplementationuponacceptance.
2020;Vecchioetal.2023]orflash-litimage(s)[Deschaintreetal.
2018,2019,2020;Guoetal.2021;Shahetal.2023;Zhouetal.2023;
2 RELATEDWORK ZhouandKalantari2021;ZhouandKhademiKalantari2022]for
acquisition.MaterialGAN[Guoetal.2020]andGaoetal.[2019]
Capturingreal-world,spatiallyvarying,surfacereflectancemodels
proposetooptimizeinlatentspacesofdeepneuralnetworks,hereby
fromseveralcameraviewshasbeenalong-standingchallengein
remaininginthemanifoldofvalidmaterials.Inthecontextof3D
computergraphics.Theoperatorthatmapsincominglightfroma
objectacquisition,methodsoftenfocusonmaterialextractionusing
givendirectiontooutgoinglightobservedatanotherdirectionis
afew(orevensingle)flashormulti-focalphotographs[Bossetal.
a6Dfunction,thespatiallyvaryingbidirectionalreflectancedistri-
2020;Deschaintreetal.2021;Fanetal.2023;Lietal.2018].These
butionfunction(SVBRDF).ObtainingSVBRDFsfrommulti-view
approachesareorthogonaltoourmethod,aswefocusonrecov-
imageshastypicallybeenaddressedthrough:optimization,using
eringtheSVBRDFfromtheprovidedsignalwithoutinitialprior,
simplifiedmodels,andusingdata-priorstrainedoneitherrealistic
quantifyingtheuncertaintyoftheprocess.Ouruncertaintycanin
orsyntheticSVBRDFs,orreal-worldmeasurements.
turnbeusedtobetterguidetheuseofpriorstosurfaceregions
whichmostneedit.
2.1 Optimization-basedCapture
Variousmethodsrecovertheassociatedmaterialpropertiesthrough
2.3 Frequency-basedlighttransport
optimization using a set of photographs of an object or surface.
Thistasktypicallyrequiresmanyphotographsandcontrolledlight- Ourworkbuildsonthefrequencyanalysisoflighttransport,in
ing[Aittalaetal.2013;DupuyandJakob2018;Nametal.2018]or particularwiththeideathatBRDFscanbeexpressedaslow-pass
objectorientations[Dongetal.2014]duringacquisitiontoguaran- filters[Durandetal.2005;RamamoorthiandHanrahan2001].From
teethatspeculareffectsaresufficientlyobserved.Someapproaches this,onecanexpressthereflectionoflightwithaBRDFasamulti-
reliedonspecializedhardware,forexampletocapturepolarimetric plicationinthefrequencydomain.Thisideahasbeensuccessfully
information[Hwangetal.2022].Othersproposetorelyonpriors, usedinthecontextofcontrolledillumination[Aittalaetal.2013;
suchasstationarityofthecapturedmaterials[Aittalaetal.2016, Ghoshetal.2007],controllingthefrequencyoflightpatternsto
2015;Henzleretal.2021;Xuetal.2016]tocompensateforlimited estimatetheBRDFfilterparameterthroughadeconvolutionofthe
information.Multiplemethods[Loubetetal.2019;Munkbergetal. reflectedlight.Wedonotassumecontrolofthelightandoperatein
2022;Nimier-Davidetal.2021;Vicinietal.2022]leveragedthere- thespherical-harmonicsfrequencydomainratherthantheFourier
centprogressindifferentiablerenderings[Changetal.2023;Jakob domain([Aittalaetal.2013])orcustombasisfunctions([Ghosh
etal.2022;Laineetal.2020;Nicoletetal.2021,2023;Nimier-David etal.2007]).Thisallowsouranalysistoworkwitharbitrarynatu-
etal.2022,2020,2019;Spielbergetal.2023;Wuetal.2023b;Xuetal. rallightingenvironments.Closesttoourapproachistheworkby
2023;Yanetal.2022]toproposejointoptimizationoflight,geometry, RamamoorthiandHanrahan[2001],whichexplicitlyderivesthe
andmaterialproperties.Recentapproachesbuildonnovelrepresen- conceptofreflectionasconvolutioninasignal-processingframe-
tationsforvolumetricscenes,suchasneuralnetworks[Mildenhall work.Theyfurtheroutlinetheimplicationsofthisperspectiveon
etal.2020]and3DGaussians[Kerbletal.2023],toincludeopti- thewell-posednessofBRDF-andlightestimationfrommulti-view
mizationformaterialproperties[Bietal.2020;Bossetal.2021a,b; inputsandoptimizeforBRDFparametersthroughthefrequency
Engelhardtetal.2024;Jinetal.2023;Maoetal.2023;Srinivasan domain.Ourworkdiffersinanumberofways:First,weaddtheo-
etal.2021;Wuetal.2023a;Zhangetal.2021a,b,2023].Ingeneral, reticalinsightsonuncertaintyandsampling.Weproposemethods
theseapproachescannotguaranteethattheoptimizedresultsare to quantify these concepts, so they can be used in downstream
accurate,asthereisnoguaranteethattheprovidedphotographs tasksandshowhowtoacceleratethisapproachusingthepower
samplethenecessarylight-viewanglepairstoqualifythespecu- spectrum.Second,ourapproachsupportsarbitrarylightsetupsand
larbehaviorandareunabletoprovideanymeasureofcertainty. treatsallfrequenciesinthesameframework,ratherthanseparating
Moreover,theyrelyonaheavyoptimizationprocess.Inspiredby highandlowfrequencylighting.Wedosobyrobustlyestimating
RamamoorthiandHanrahan[2001]whodescribedBRDFsasmul- sphericalharmoniccoefficientsdirectlyonsparse,irregularsamples
tiplicationsinthefrequencydomain,weproposetoleveragethe usingaregularizedleast-squaresmethod.Finally,weproposeto
efficiencyofthisframeworktojointlyestimatethematerialproper- improvetheBRDFmodeldescribedbyRamamoorthiandHanrahan
tiesandtheiruncertainty,providingkeyinformationaboutwhich toincludeshadowingandmaskingandshowhowtomapthemodel
,Vol.1,No.1,Article.Publicationdate:June2024.4 • RubenWiersma,JulienPhilip,MilošHašan,KrishnaMullia,FujunLuan,ElmarEisemann,andValentinDeschaintre
tothewidelyusedsimplifiedprincipledBRDF[BurleyandStudios functionfordegreeℓ andorder𝑚.Thetotalnumberofspherical
2012]. harmonicsupto-andincludingamaximumdegree,ℓ∗,equals(ℓ∗+
1)2.Ausefulpropertyofsphericalharmonicsinoursettingisthat
2.4 Uncertaintyestimation
arotationalconvolutiononthesphereisequaltomultiplicationof
Uncertaintyestimationinthecontextofacquisitionishighlyde- coefficientsinthesphericalharmonicdomain.
sirable,asitcanguidethecapturingprocessandtheuseofpriors, Thepowerspectrumofasphericalfunction𝑓 canbecomputed
orsimplyinformontheexpectedqualityofagivenreconstruction. fromthesphericalharmoniccoefficientsperdegree
Lenschetal.[2003a],estimateanobject’smaterialpropertiesby ℓ
∑︁
clusteringsimilarBRDFestimationswithinanobject.Toguidethe 𝑆 𝑓(ℓ)= 𝑓 ℓ2 𝑚. (4)
clusteringanditssplitting,thecovarianceoftheparametersareused. 𝑚=−ℓ
InLenschetal.[2003b],theuncertaintyofBRDFparametersisesti- The power spectrum is invariant to rotations of the coordinate
matedusingsimilarcovariancematrices.Morerecently,Rodriguez- system.Inourcontextthatmeansthepowerspectrumisinvariant
Pardoetal.[2023]takinginspirationfromBayesianmethods([Gal toslightperturbationsofthenormalsateachpoint.
andGhahramani2016]),usedMonte-Carlodropouttoestimatethe
uncertaintyofmaterialestimationfromasinglepicture.Inthecon- 3.1.1 Computingsphericalharmoniccoefficients. Onecanfindthe
textofnovelviewsynthesis,Golietal.[2024]proposetoevaluate SHcoefficientsforafunction 𝑓 bycomputingtheinnerproduct
theinherentvolumetricuncertaintyofNeRF[Mildenhalletal.2020] withthebasisfunctions
∫
reconstructionsposteriortotraining.Theyuserayperturbations 𝑓 ℓ𝑚 = 𝑓(𝜃,𝜙)𝑌 ℓ𝑚(𝜃,𝜙)𝑑𝜔. (5)
andanapproximationoftheHessiantoquantifyit.Theyshowa 𝑆2
correlationbetweenuncertaintyandabsoluteerror.Inthiswork,we A useful property holds for the coefficient of degree ℓ = 0, for
useamoreexplicitapproachtouncertaintyestimation.Weuseafast whichthesphericalharmonicisconstant;𝑌 00(𝜃,𝜙)=(4𝜋)−1 2.The
BRDFestimationapproximationformanyparametercombinations correspondingcoefficient, 𝑓 00,isequaltotheintegralof 𝑓 times
andinterprettheresultingerrorasanegativelog-likelihoodfrom thenormalizationconstant,(4𝜋)− 21 .Thesphericalharmonicsfor
whichwederiveanentropymeasure.
higherdegreesallintegratetozero1.Thisisrelevantinthecontext
3 BACKGROUND ofrendering,becausethetotalintegratedincomingandoutgoing
𝑡ℎ
radiancecanbereadfromthe0 degreecoefficientandthatcoeffi-
Ourmethodbuildsonpriorworkininverserenderingandspherical cientalone.Inthegeneralcase,weestimatethecoefficientfor𝑓
ℓ𝑚
harmonics.Wesummarizerequiredbackgroundknowledgeand basedonsamplesof𝑓.Thesamplingmethoddetermineshowthese
refertorelatedworkforfurtherdepth.
coefficientsareestimated.
3.1 SphericalHarmonics Regularsampling. If𝑓 issampledonagridwithequallyspaced
Sphericalharmonicsareaseriesoforthonormalbasisfunctionson longitudinalandlatitudinalangles,thisintegralcanbeaccelerated
thesphere,indexedbytheirdegreeℓ andorder𝑚.Weusethem usingafastFouriertransforminthelongitudinaldirection𝜙 and
torepresentincomingandoutgoingradianceoverincomingand aquadratureruleinthelatitudinaldirection𝜃 [DriscollandHealy
outgoingdirectionsontheunitsphere.Sphericalharmonicsare 1994].Inoursetting,thisapproachcanbeusedforenvironment
analogoustotheFourierseriesonaflatdomain,wherethefrequency mapsrepresentedasrectangulartextures.
oftheFourierseriescorrespondstothedegreeℓandorder𝑚.We
Irregularsampling. Duringcapturethecameraisoftenplacedat
provideabriefoverviewofpropertiesrelevanttoourmethod.For irregularpositions,leadingtonon-uniform(𝜃,𝜙)samples.Further,
furtherdetails,ahelpfulreferenceandsoftwarepackageispublished
apointonthesurfacemightbeobservedfromonlyafewpositions.
byWieczorekandMeschede[2018].
Wethereforeoftenneedtousesparseandirregularsamplestofit
Anyreal,square-integrablefunctiononthespherecanbeex-
sphericalharmoniccoefficients.Wedosobyfittingthecoefficients
pressedasaspherical-harmonicsseries:
usingleast-squares,expressingEquation1asalinearsystem
∞ ℓ
𝑓(𝜃,𝜙)=∑︁ ∑︁ 𝑓 ℓ𝑚𝑌 ℓ𝑚(𝜃,𝜙), (1) Yc≈f, (6)
ℓ=0𝑚=−ℓ wheref isavectorof𝑛discretesamplesfrom𝑓,Yisamatrixof
where𝑓 ℓ𝑚isthecoefficientforsphericalharmonic𝑌 ℓ𝑚(𝜃,𝜙),given size𝑛×(ℓ∗+1)2containingthesphericalharmonicssampledatthe
as
samelocationsas𝑓,andcisavectorofthe(ℓ∗+1)2coefficientswe
√︄ wanttofind.Wecanfindcbysolvingaleast-squaressystem
𝑁 ℓ𝑚 =
(2−𝛿 𝑚0)(2ℓ+1) (ℓ−𝑚)!
(2) Y⊺ Yc=Y⊺ f. (7)
4𝜋 (ℓ+𝑚)!
𝑌
ℓ𝑚(𝜃,𝜙)=(cid:40) 𝑁𝑁 ℓℓ 𝑚𝑚 𝑃𝑃 ℓℓ𝑚 |𝑚( |c (o cs o𝜃 s) 𝜃c )o ss in𝑚 |𝑚𝜙
|𝜙
ii ff 𝑚𝑚 <≥ 00 .,
(3)
T
s
mao
am
kb
p
ie
nle
gw
s,
te hwll ehp sio
c
yhs se
tc
ed
a
m, nth ubi
e
ns dcs ehy ras
-l
ct lee onm
ng si
tr
n
re agq inu
in
eir dte
h
.s
e
W𝑛
c
eo>
n pt
r(
e
oℓ
x
p∗
t
o+
o sf
e1 s)
tp
o2
a
ui rn
s
sed ee
s
ap
am
ce un
p
sd
l
tie onn mgt
,
𝑁 ℓ𝑚 isanormalizationfactor,𝛿 𝑚0istheKroneckerdeltafunction, 1Becausethesphericalharmonicsareorthormal,theinnerproductbetweenanyspher-
whichevaluatesto1when𝑚=0,and𝑃 ℓ𝑚 istheassociatedLegendre icalharmonicwithℓ>0andtheconstantfunction(ℓ,𝑚=0)equalszero.
,Vol.1,No.1,Article.Publicationdate:June2024.FastandUncertainty-AwareSVBRDFRecoveryfromMulti-ViewCaptureusingFrequencyDomainAnalysis • 5
SH Fit on Fibonacci samples BRDF as convolution Fresnel Shadowing, masking Optimization
Input lighting Section 4.2 Background in angular space Section 4.1 Section 4.3
f00
Shadowing Masking
+ f10
+ f11
Low pass filtering … Microsurface
Mixed
Multi-view capture
and Geometry
SH Fit on sparse samples BRDF as convolution Power spectrum parameter estimation Uncertainty
Section 4.2 Background Section 4.4 Section 4.5
f00 K s
× =
+ f10 α
+ f11
… Incoming radiance Candidate BRDF Outgoing radiance
Frequency Domain
Fig.2. Anoverviewofourpipelineshowinginput,output,andtheproposedalgorithm.Theinputtoourapproachisasetofphotographsofanobjectfrom
multiplecamerapointsandtheassociatedcameraextrinsicsandintrinsics.Wealsoprovidetheinputlightingasanenvironmentmapandobjectgeometry.
Next,weproposetwomainvariantsofourapproach:amixedpipeline(top)andapipelinefullycontainedinthesphericalharmonicdomain(bottom).The
MixedpipelinefirstestimatessphericalharmoniccoefficientsfortheinputlightingonFibonaccisamples.ThelightisconvolvedwiththeBRDFfilterand
mappedbacktotheangulardomain,wheretheoutgoingradianceisattenuatedwithFresnel,shadowing,andmasking.Duringacquisition,weoptimizethe
BRDFparametersbycomparingtheoutgoinglightsamplestotheradiancecapturedintheinputphotographs.TheFrequencyDomainpipelinefirst
estimatessphericalharmoniccoefficientsonboththeincomingandoutgoingradianceandthenestimatestheeffectofdifferentBRDFfilterswithinthepower
spectrum.Thisisusedtocomputeameasureofuncertaintyonthepredictedparametersforacquisition.
regularizerinSection4.2forcaseswherethenumberofsamplesis cannotbeestimatedwithoutadditionalpriorsonplausiblespatial
toolow. parametervariations.ForthemicrofacetBRDF,thisleadstothe
followingconclusion:iftheincominglightonlycontainsfrequen-
3.2 ReflectionasConvolution ciesℓ <<𝛼−1,multiplyingthecoefficientsofthelightwiththose
Surfacereflectioncanbeapproximatedastheconvolutionofincom- oftheBRDFonlyresultsinasmalldifference,andtheinversion
ingradiance(fromthelightdirection)withaBRDF[Ramamoorthi
ofthisoperationisill-conditioned.Toaccuratelyestimate𝛼,the
andHanrahan2001].Specifically,ifweassumeanisotropicmicro- incominglightusedduringthecaptureneedstoexhibitsufficiently
facetTorranceandSparrow[1967]BRDF,combinedwithaLamber- highfrequencies.
tianterm,wecanderivethefollowingapproximateequationfor Thisinsightisbasedonaderivationforthecoefficientsofthe
outgoingradiance𝐵atpoint𝑝intheviewdirection𝜔 𝑜 microfacetmodel.ThenormalizedSH-coefficientsofthespecular
componentoftheBRDFfornormalincidence,𝑆,areapproximated
𝐵(𝑝,𝜔 𝑜)≈𝐾 𝑑𝐸(𝑝)+𝐾 𝑠𝐹(𝜃 𝑜)[𝑆 𝛼 ∗𝐿(𝑝)]𝜔𝑜, (8) by
where𝐾
𝑑
and𝐾
𝑠
arediffuseandspecularterms;𝐸(𝑝)istheirradi-
anceintegratedoverthehemisphere;𝐹(𝜃 𝑜)isasimplifiedFresnel 𝑓ˆ ℓ𝑚 ≈𝑒−(𝛼ℓ)2, (9)
term,whichonlydependsontheoutgoingdirection;𝐿(𝑝)isthein-
comingradiance;and𝑆 𝛼 isafilterparametrizedbythedistribution whichisaGaussianinthefrequencydomainwithawidthdeter-
width,𝛼.Thisfilterisderivedfromthenormaldistributionfunction minedby𝛼.ThekernelisderivedfromaBeckmannnormaldistribu-
ofthesurface.The∗operatorrepresentsconvolution.Aderivation tionfunctionandthe𝛼 parametercorrespondstothe𝛼 parameter
ofthisapproximationisincludedintheAppendix. there.NotethatthesecoefficientsdonotvarywiththeSphericalHar-
In this framework, estimating the specular BRDF parameters monicsorder𝑚,sincethenormaldistributionfunctionisisotropic
comesdowntoestimatingtheconvolutionkernel.Thiscanbedone foroutgoingraysinthedirectionofthenormalvector(𝜃 𝑜 =0).An
efficientlysinceaconvolutionintheangulardomaincanberep- importantapproximationemployedbyRamamoorthiandHanrahan
resentedasamultiplicationinthesphericalharmonicsfrequency is that this same kernel can be used for any outgoing direction.
domain.Usingthisrepresentation,onecanfindtheconvolution Whilethecorrectkernelvarieswiththeincomingandoutgoing
kernelthroughadivisionofthesphericalharmonicscoefficientsof direction,thisapproximationdoesnotleadtosignificanterrorfor
theoutgoingradiancebythoseoftheincomingradiance.Thisis inverserendering[RamamoorthiandHanrahan2001]astheynote
analogoustokernelestimationforimagedeblurringintheFourier that“itcanbeshownbyTaylor-seriesexpansionsandverifiednumer-
domain. ically,thatthecorrectionstothisfilteraresmall [forlowdegrees
Theaboveleadstocrucialinsightsregardingthewell-posedness ℓ]”.
ofBRDFrecovery.RamamoorthiandHanrahanstatethatthere- Inthispaper,weexpandonthetheoryestablishedbyRamamoor-
coveryofBRDFparametersisill-posediftheinputlightinghasno thi and Hanrahan by improving the reflection as a convolution
amplitudealongcertainmodesofthefilter(BRDF).Thosemodes model’saccuracyanddevelopingtheimplicationsforwell-posedness
,Vol.1,No.1,Article.Publicationdate:June2024.
noitazimitpO noitazilaitinI6 • RubenWiersma,JulienPhilip,MilošHašan,KrishnaMullia,FujunLuan,ElmarEisemann,andValentinDeschaintre
intoquantifiablemetricsonuncertaintywithouta-prioriknowledge especiallyifthemicrofacetdistributioniswide(highroughness).
on𝛼. RamamoorthiandHanrahanarguethatthesetermscanbeignored,
becausetheymostlyaffectobservationsmadeatgrazingangles.
4 METHOD
Whilethisistrueformaterialswithlowroughness,wefindthat
Ourgoalistorecover(SV)BRDFspropertiesandquantifyuncer- ignoringthistermleadstoreconstructionerrorsforhighroughness
tainty from multi-view capture of an object under environment materials–weevaluatetheterms’impactinTable4.Wethere-
lighting.TheinputtoourmethodisasetofimagesIcapturedfrom fore propose to introduce shadowing and masking terms to the
multiplecamerapositions.Thecameraextrinsics,intrinsics,object convolutionmodel.
geometryandHDRlightingareassumedtobeknown–through Shadowingandmaskingeffectsaretypicallymodeledjointlyto
existingmethodsforcameracalibration,photogrammetry,andHDR avoidanover-correctionoftheradiance(Pharretal.[2023],Section
environmentcapture–butnotcontrolled. 9.6.3).However,thisjointtermcannotbeincludedinthesimplified
Foreachpoint𝑝 ontheobjectsurface,weknowtheincoming convolutionmodelaspresentedinEquation8,becausethekernel
radiance𝐿(𝑝,𝜔 𝑖)fromdirections𝜔 𝑖.Thesevaluescanbesampled wouldneedtovarywithboth𝜔 𝑖 and𝜔 𝑜 (the2Dkernelonlyvaries
fromtheenvironmentmap.Forhigheraccuracy,onecanattenuate witheither𝜔 𝑖 or𝜔 𝑜).Therefore,weassumethatshadowingand
thelightbasedonself-occlusion,butwedonotexplorethisinour maskingeffectsareindependentandcanbemodeledseparatelyas
work.Byprojectingthecapturedimagesontothesurface,were- 𝐺 𝛼(𝜔 𝑖)𝐺 𝛼(𝜔 𝑜).Whilewedoobserveasmalloverestimationofthe
trievetheoutgoingradianceateachpoint,𝐵(𝑝,𝜔 𝑜).Ourtaskisto shadowingandmaskingeffect,weshowinTable4thattheaddition
recovertheBRDF𝑓(𝑝,𝜔 𝑜,𝜔 𝑖)andcapturetheuncertaintyassoci- ofthetermstillleadstoimprovementsforBRDFacquisition.This
atedwithitsparameters.TheBRDFrelatestheincomingradiance waywecanfirstattenuatetheincominglightwiththeshadowing
oftheupperhemisphereΩtotheoutgoingradianceas[Pharretal. term,thenconvolvewiththeBRDFandthenattenuatetheresult
2023]: withthemaskingterm
𝐵(𝑝,𝜔
𝑜)=∫
𝑓(𝑝,𝜔 𝑜,𝜔 𝑖)𝐿(𝑝,𝜔 𝑖)cos𝜃 𝑖𝑑𝜔 𝑖. (10)
𝐵(𝑝,𝜔 𝑜)≈𝐾 𝑑𝐸(𝑝)+𝐾 𝑠𝐹(𝜃 𝑜)𝐺 𝛼(𝜃 𝑜)[𝑆 𝛼 ∗𝐺 𝛼(𝜃 𝑖)𝐿(𝑝)]𝜔𝑜, (11)
Ω where𝐺 𝛼 istheshadowing-maskingfunctionintheTrowbridge
WeusetheTorranceandSparrow[1967]BRDFmodelwithparam- andReitz[1975]model(alsoreferredtoasGGX[Walteretal.2007]).
eters for diffuse reflectance𝐾 𝑑, specular reflectance𝐾 𝑠, and the Theshadowingandmaskingtermsbothdependon𝛼,whichisnot
slopeofthenormaldistributionfunction𝛼(Equation8).Wedenote knowna-priori.Thismeansthattheshadowingandmaskingterms
theseparametersasavectorofparameters,𝜓.Insubsection4.6,we changeasweoptimize𝛼.Asaconsequence,weneedtoupdatethe
showhowtomapasimplifiedDisneyprincipledBRDF[Burleyand coefficientsfortheincominglightas𝐺 𝛼(𝜃 𝑖) changes.Whilethe
Studios2012]totheseparameters. estimationofsphericalharmoniccoefficientsisrelativelyfast,it
Toestimate𝜓,weproposetobuildontheframeworkproposed canstillbequitecumbersometoupdatethecoefficientsinevery
byRamamoorthiandHanrahan[2001].Inthefollowingsectionswe optimizationstep.Therefore,weonlyupdatetheshadowingterm
carefullyhighlighthowweimproveandextenditsusecompared each𝑚iterations.
totheoriginalformulation.Anoverviewofthepipelineisshown
4.2 FittingSphericalHarmonicCoefficients
inFigure2,wherewedenoteourcontributionsinblackandexist-
ingworkingray.Inparticular,wedescribetheextensionofthe Muchofourcomputationreliesonaconvolutionappliedinthe
existingconvolutionmodeltotakeshadowingandmaskingeffects sphericalharmonicsdomain,whichmeanswerequireagoodspher-
into account. We then describe an efficient spherical-harmonics icalharmonicstransform.Thisischallenging,becausetheoutgoing
fittingfromsparseandirregularsamplesofradiance,enablingun- lightfield,𝐵,issampledsparselyandnon-uniformly(Figure3,sec-
structuredcapturesetups.Wethenproposeacarefullyvalidated ondcolumn).Therefore,RamamoorthiandHanrahandonotdirectly
approximationoftheconvolutionmodeltodesignalightweight estimatesphericalharmoniccoefficientson𝐵,butonlyperformthe
lossfunction,leveragingthepowerspectrumforefficientlosseval- transformationfromthesphericalharmonicdomaintothedirec-
uation.TheseimprovementsenablequicksamplingoftheBRDF tionaldomain.Thisissimpler,becauseitonlyrequiresevaluating
parameterspace,Ψ,whichweusetoproposeanewformulation
thesphericalharmonicsatthesamplelocations(Equation1).For
forcapturinguncertaintyrelyingonstatisticalentropy.Finally,we theincominglight,theyrepresentlow-frequency(areasources)and
maptheTorrance-SparrowBRDFmodelparameterstothoseofthe high-frequencylighting(pointsources)separatelyandlimittheir
simplifiedDisneyprincipledBRDF[BurleyandStudios2012]for environmentstocontrolled‘lightbox’-likesettings.Wewouldlike
useinmodernrenderingpipelines. tocomputeanestimateofthesphericalharmoniccoefficientsfor
theoutgoingradiance,becausethiswouldenablealgorithmicanal-
4.1 ImprovingtheConvolutionModel
ysisfullywithinthefrequencydomain.Thisishighlyappealing,
The approximate reflection function in Equation 8 does not in- becauseithasthepotentialtogreatlysimplifytheanalysisofBRDF
cludetheshadowingormaskingtermspresentinmicrofacetmod- recovery,asshowcasedbyRamamoorthiandHanrahan[2001].
els[Pharretal.2023].Theshadowingandmaskingtermsmodel Nexttosparsesampling,asignificantchallengeisthatboththe
occlusiononincominglight(shadowing)andoutgoinglight(mask- incoming-andoutgoingradiancefieldsareonlysupportedontheup-
ing)duetotheconfigurationofthemicrofacets(Figure2,topright). perhemispherewhenconsideringreflection.Ifweweretoconsider
Lightatgrazinganglesismorelikelytobeoccludedbymicrofacets, incomingradianceonthelowerhemisphere,wewouldimplicitly
,Vol.1,No.1,Article.Publicationdate:June2024.FastandUncertainty-AwareSVBRDFRecoveryfromMulti-ViewCaptureusingFrequencyDomainAnalysis • 7
Incoming and outgoing radiance No regularizer Padded Constant regularizer Ours
101 101 101 101 101
Incoming light
103 Outgoing light 103 103 103 103
GT BRDF
Relative spectrum
105 105 105 105 105
0 2 4 6 8 0 2 4 6 8 0 2 4 6 8 0 2 4 6 8 0 2 4 6 8
Degree ‘ Degree ‘ Degree ‘ Degree ‘ Degree ‘
Fig.3. Acomparisonoftheoptionsforfittingsphericalharmonicsonsparsesamples.Inthefirstcolumn,top:incomingradiance(synthetic)onthesphere
mappedtoalat-longgrid.Middle:synthesizedoutgoingradianceasaresultoffilteringincomingradiancewithEquation9,𝛼=0.2.Bottom:powerspectraof
incomingandoutgoingradianceandground-truthfilter(BRDF)plottedonalog-scale.Inthesecondtofifthcolumn,weshowtheresultoffittingspherical
harmonicscoefficientstosamplesandthentransformingbacktothespatialdomain.Weuse100samplesfromtheupperhemisphereoftheinputradiance(first
column)andsimulatemissingsamplesduetoocclusionormissedcamerapositionsbymaskingsomepoints,leaving88samples.Thesamplesareweighted
withcos𝜃,whichisvisualizedasthetransparencyofthesamples.Wefindthatourmethodwithaweightedregularizerisabletosmoothlyinterpolatemissing
valuesandretrievesthecorrectBRDFfilterinthepowerspectrum,whereothervariantsoverfit,oradddarkregionsintheupperhemisphere.
modellight‘leakingthrough’thesurface.Onepossiblesolution andoutgoingradiancefitting,weareabletorecoverthecorrect
istosimplypadthelowerhemispherewithzeros(Figure3,third filter(bottomrow),eventhoughtherecoveredincomingradiance
column).Thisisnotpractical,becauseitintroduceshighfrequency looksblurrier(toprow).
variationattheboundary,whichdisruptsanypotentialanalysison Wefitthesignalsforwhichwehavecompletespatialinformation
thesphericalharmoniccoefficients(bottomrow).Anothersolution (e.g.,incomingenvironmentlight)bysamplingitinwithFibonacci
thatweexploredistorepresenttheradiancefieldswithhemispher- samplesonthesphere.Forpartiallyobservedsignal(e.g.,reflected
icalharmonics[Zhengetal.2019].Inpractice,thisisequivalentto light)weusetheavailablesampleswiththedescribedfittingtech-
mirroringtheradiancefieldsalongthemeridian,whichresultedin niqueforsparseandirregularsamples.Animportantconsideration
mismatcheswiththeconvolutionmodel. relatedtothenumberofsamples,isthefrequencyofthesignal
Weinsteadproposeasphericalharmonicsfittingapproachthatis thatwefitsphericalharmonicsto.Wehaveanin-depthanalysisof
robusttosparseandirregularsamples,andsupportsthelackoflower thisintheAppendix.Thepracticaltake-awayisthattheincoming
hemispheresamplesandgracefullyhandlesoccludedregions.First, signalshouldbebandlimitedtoroughly𝑛1 2 toavoidaliasing,where
analogtoideasfromcompressedsensing,weaddaregularization 𝑛isthenumberofinputviews.Weensurethisisthecaseforthein-
termonthesphericalharmoniccoefficients.Atypicalchoicefor comingradiancebyapplyingthefilterinEquation9with𝛼′ =𝑛− 21
thistermisan𝐿1norm,whichenforcessparsityinthespherical
ontheinputenvironmentmap.TheimpactonourBRDFestimation
harmonic coefficients. The resulting system can be solved with isthatwecannotaccuratelyrecover𝛼 < 𝛼′.Inourexperiments
linearprogramming.Weproposeinsteadtouseaweighted𝐿2norm
andanalysisintheAppendix,wefindthattherecovered𝛼 tends
whichcanbesolvedusingstandardlinearsolvers,whichwefound tobebetween0and𝛼′ inthosecases.Asecondfinetuningpass
tobefasterandmorestableforourusecase:
withadifferentiablepathtracer,liketheonewedemonstrateinthe
(Y⊺ Y+𝜆W)c=Y⊺ f, (12) experiments,canhelprefinethoseregions.
4.3 OptimizingforSVBRDFParameters
whereWisadiagonalweightmatrix.Ifconstant,thisweightma-
trixleadstopoorfittingastheregularizationistoostrongonthe UsingourmorecompletemodeldescribedinEquation11,wecan
lowersphericalharmonicsdegrees(Figure3,fourthcolumn).We optimizefortheobject’smaterialparametersusinggradientdescent:
settheweightequalto𝑒ℓ
,increasingthestrengthofregularization
forhighersphericalharmonicsdegrees.Thisisinformedbythe 𝜓∗=argmin∑︁ |𝐵 𝜓(𝑝,𝜔 𝑜)−𝐵′(𝑝,𝜔 𝑜)| (13)
𝜓
observationthatmanynaturalimageshaveapowerspectrumwith 𝑝,𝜔𝑜
exponentialdecay[Flemingetal.2003].Intuitively,thisregularizer With𝐵 𝜓(𝑝,𝜔 𝑜)arenderingoperatorusingEquation11and𝐵′
encouragesfillingunknownregionswithlow-frequencyinforma- theradiancevaluesprojectedontothesurfacepoints𝑝.Asdescribed
tion,akintosolutionswithasmoothnessterm(Figure3,right-most insubsection4.1,weoptimizetheparameters𝜓 foranumberof
column).Byapplyingthesameregularizationtobothincoming- iterationsbeforeupdatingtheshadowingterm,asthissteprequires
,Vol.1,No.1,Article.Publicationdate:June2024.
rewoP rewoP rewoP rewoP rewoP8 • RubenWiersma,JulienPhilip,MilošHašan,KrishnaMullia,FujunLuan,ElmarEisemann,andValentinDeschaintre
recomputingthesphericalharmonicfit.Themaskingtermisin- Next, we propose to use the power spectra𝑆 𝐿 and𝑆 𝐵 of the
cludedintheforwardrenderingstepandupdatedeveryiteration. sphericalharmonicsfittings𝐿 ℓ𝑚 and𝐵 ℓ𝑚,whichwecanexpressas
Becauseof thesimplicity ofthe convolution approximation,we ℓ
areabletooptimizeforallpointsandcamerapositionsinonego, 𝑆 𝐿(ℓ)= ∑︁ 𝐿 ℓ2 𝑚 (15)
ratherthanusingstochasticgradientdescentwithbatchesofrays. 𝑚=−ℓ
Thisletsusrunouroptimizationwithfeweriterationsthanother ℓ
approaches.Similartoothermethods,weaddthetotalvariation 𝑆 𝐵(ℓ)= ∑︁ (𝐾 𝑠𝑒−(𝛼ℓ)2𝐿 ℓ𝑚)2 (16)
normontheparametersintexturespaceasaregularizertoenforce 𝑚=−ℓ
smoothness,weightedwith1×10−3. ℓ
=𝐾 𝑠2𝑒−2(𝛼ℓ)2 ∑︁ 𝐿 ℓ2 𝑚 (17)
4.4 ALightweightObjective
𝑚=−ℓ
Inthissectionwedefineaparticularlyefficient-to-computeapprox- =𝐾 𝑠2𝑒−2(𝛼ℓ)2𝑆 𝐿(ℓ) (18)
imationoftheconvolutionBRDFmodeldescribedinEquation11.
fordegreesℓ >0.UsingthisrelationshipbetweentheBRDFparam-
Ourgoalistodevelopalgorithmstoanalyzetheinverserender-
ingproblemfullyinthesphericalharmonicdomain.Thiswould
eters(𝐾 𝑠,𝛼)andtheincomingandoutgoingradiancepowerspectra
simplifysuchanalysistremendously,asconvolutionissimplya
(𝑆 𝐿(ℓ)and𝑆 𝐵(ℓ),wecanformulatealightweightobjective:
per-frequencymultiplicationinthisdomain. ℓ∗
Forthisapproximation,weproposetoignoretheFresneland 𝐷(𝐾 𝑠,𝛼)=∑︁ (𝑆 𝐵(ℓ)−𝐾 𝑠2𝑒−2(𝛼ℓ)2𝑆 𝐿(ℓ))2. (19)
shadowing and masking terms, letting us express the reflection ℓ=1
functionentirelyintermsofsphericalharmoniccoefficients.We Intuitivelythisobjectiveevaluatesthedifferencebetweentheob-
showexperimentallyinSection5.4.2thattheimpactofthisapproxi- servedradianceandtheBRDF-convolvedincomingradiancewith
mationisacceptableontheunderlyingapplicationofthisobjective. agiven(𝐾 𝑠,𝛼)throughtheirrespectivepowerspectrum.Thisfor-
UsingEquation9forthecoefficientsof𝑆weget: mulationreducesthecomputationfromℓ∗2 toℓ∗ evaluationsof
𝐵 ℓ𝑚 =(cid:40) 𝐾𝜋 𝑠− 𝑒1 2 −𝐾 (𝑑 𝛼𝐸 ℓ)( 2𝑝 𝐿) ℓ𝑚+ ,𝐾 𝑠𝐿 ℓ𝑚, i of thℓ e= rw0.
ise.
(14) t h uh noe w ceo rb t thj ae i isc nt tfi yav se et, vm e as la t uik ami tn ia og t nioit ans se i ssv ha k ol eu wya nt ti oo inn u Sn n ee l coa tcr ioki nin ns 4gt .a 5nn aet naan r d-e i cno au s nts a. bnW et ue (< ss e1h dmo aw s s)
Wenotethatthespecularcomponentforℓ = 0doesnotdepend initializationoftheoptimizationdescribedinSection5.6.
on𝛼,becauseforℓ =0,Equation9equals1.Theterm𝜋−1 2𝐾 𝑑𝐸(𝑝)
4.5 EntropyasUncertainty
representsthediffusecomponentasaconstantfunction.Weknow,
basedontheconservationofenergy,thatthediffusecomponent Inourcontextofpassiveacquisition,wehavenoguaranteethat
should integrate to𝐾 𝑑𝐸(𝑝) on the upper hemisphere for outgo- theilluminationonthecapturedobjectsurfaceissufficienttofully
ing directions. Thus, the integral over the full sphere should be recoverthematerialparameters.Thisuncertaintyisparticularly
𝐾 𝑑2𝐸(𝑝).Equation5showsthattheSphericalHarmonicscoeffi- desirableinformationasitiskeytounderstandingthequalityof
cientfordegreeℓ =0shouldbeequalto(4𝜋)−1 2 timestheintegral: acquisition(e.g.fordigitaltwins),drivingtheuseofpriorsinuncer-
(4𝜋)−1 2𝐾 𝑑2𝐸(𝑝)=𝜋−1 2𝐾 𝑑𝐸(𝑝).Fromthisexpression,wemaketwo tainregionswhilepreservingthecorrectlyrecoveredsurfaceareas,
ordrivingtheacquisitionbymaximizingtheinformationprovided
observations.(a)Wecannotrecovertheratiobetween𝐾
𝑑
and𝐾
𝑠
bynewviewswhenadditionalcapturesarepossible.Weproposeto
fromtheℓ =0alone,aswehavetwounknownsandonlyoneco-
useagridsearchoftheparameterspacetoinformouruncertainty
efficientand(b)wecannotderiveanyinformationon𝛼 fromthe
estimation.Thisisnowtractable,thankstothepowerspectrum
0thdegree,asithasnoimpactthere.Itfollowsthatwecanonly
approximationdiscussedintheprevioussection.Byinterpreting
recover𝐾 𝑠 and𝛼 fromdegreesℓ > 0.Once𝐾 𝑠 isknown,wecan
the error over the parameter space as a likelihood function, we
thenestimate𝐾 𝑑 fromthe0th degree.Inotherwords,weknow
canexpressuncertaintyusingentropy,whichisacommonwayto
diffusereflectanceonceweknowthecontributionofthespecular
studyuncertainty.Wedetailthesecontributionsinthefollowing
component.Thisreducesouranalysisofuncertaintytothespecular
paragraphs.
componentontheparameters𝐾 𝑠and𝛼.Notethatthissimplification
OnecaninterprettherecoveryoftherightBRDFparameters,𝜓∗
comesnaturallyinthefrequencydomain,becausewecanlimitour
asamaximizationoftheposteriorprobabilitydistributionofthe
analysistodegreesℓ >0.Thisisnon-trivialtoseparateoutinthe
parametersgiventheincomingandoutgoingpowerspectrum
directionaldomain.
Weuseourproposedsphericalharmoniccoefficientfittingde- 𝜓∗=argmax𝑝(𝜓|𝑆 𝐿,𝑆 𝐵). (20)
scribedinSection4.2torecover𝐿 ℓ𝑚and𝐵 ℓ𝑚.𝐵 ℓ𝑚isestimatedfrom 𝜓
thesparse,irregularsamplesoftheobjectfromtheinputviewsas AccordingtoBayesrule,theposteriorisproportionaltotheproduct
describedinSection4.2.𝐿 ℓ𝑚 isestimatedfromsamplesoftheenvi- ofthelikelihoodandpriorovertheparameters:
ronmentinthereflectiondirectionsoftheviewingpositions.This
ensuresthatthesphericalharmoniccoefficientsfor𝐿 and𝐵 are
𝑝(𝜓|𝑆 𝐿,𝑆 𝐵)∝L(𝑆 𝐿,𝑆 𝐵|𝜓)𝑞(𝜓), (21)
comparableandthatwecananalyzethefrequenciesoftheobserved Assuming𝑞(𝜓)tobeanuninformativeprior,i.e.auniformdistribu-
light. tionontherangeofallowedparametervalues(typically[0,1]for
,Vol.1,No.1,Article.Publicationdate:June2024.FastandUncertainty-AwareSVBRDFRecoveryfromMulti-ViewCaptureusingFrequencyDomainAnalysis • 9
BRDFparameters),wecanreformulatethisobjectivetoanequiva- Power spectrum Likelihood, Entropy H=0.25
0.0 1.0
1.0
lentnegativelog-likelihoodobjective Incoming
0.8 0.2 0.8
𝜓∗=argm 𝜓in−log(L(𝑆 𝐿,𝑆 𝐵|𝜓)). (22) 0.6 Outgoing (α=0.2,Ks=0.8) 0.4 0.6
0.4 0.6 0.4
WeinterpretthelightweightobjectivedescribedinEquation19as
theNegativeLogLikelihood(NLL)ofthejointprobability,given 0.2 0.8 0.2
parameters𝜓 =(𝐾 𝑠,𝛼): 0.0
0 2 4 6 8
1.0
0.0 0.2 0.4 0.6 0.8 1.0
0.0
Degree ‘ Ks
L(𝑆 𝐿,𝑆 𝐵|𝜓)= √1 𝑒− 2𝜎1 2𝐷(𝐾𝑠,𝛼), (23) 1.0 Power spectrum 0.0 Likelihood, Entropy H=0.69 1.0
𝜎 2𝜋 Incoming
0.8 0.2 0.8
where𝐷(𝐾 𝑠,𝛼)isthesquarederrormeasuredefinedinEquation19.
0.6 0.4 0.6
Wecanviewthisasassumingthattheerror ofourmodelcaused
byapproximationsandmeasurenoiseisGaussian∼N(0,𝜎2).We 0.4 0.6 0.4
set𝜎 = 1𝑒−2,foundempiricallytocapturethechangeinlossob- 0.2 Outgoing (α=0.2,Ks=0.8) 0.8 0.2
servedwhennoticeablychanging𝜓.Thescalingconstantaboveis 0.0 1.0 0.0
0 2 4 6 8 0.0 0.2 0.4 0.6 0.8 1.0
optionalsincewewillrenormalizebelowinEquation24.With𝜎 Degree ‘ Ks
Power spectrum Likelihood, Entropy H=0.87
fixed,minimizingtheNLLfromEquation22isequivalenttomini- 1.0 0.0 1.0
mizing𝐷(𝐾 𝑠,𝛼).
0.8
Incoming
0.2 0.8
creW tize ee dx ip nlo 𝑛re vat lh ue esm inat te or ti aa ll ,p 𝜓a 𝑖=ra 0.m .𝑛e (t √er 𝑛s pp ea rc ve af ro iar b𝜓 le)= .B( e𝐾 c𝑠 a, u𝛼 s) e, td hi is s-
0.6 0.4 0.6
processcanbeparallelizedeasily,thissteptypicallytakesbetween 0.4 0.6 0.4
1−10msforcommonscenarios.Thegridsearchprovidesuswitha 0.2 0.8 0.2
Outgoing (α=0.2,Ks=0.1)
discretedistribution𝑑obtainedfromthe𝑛samplesof𝜓:
0.0 1.0 0.0
0 2 4 6 8 0.0 0.2 0.4 0.6 0.8 1.0
𝑑 𝑖 = (cid:205)𝑛 𝑖=L 1( L𝑆 𝐿 (, 𝑆𝑆 𝐿𝐵 ,𝑆|𝜓 𝐵𝑖 |) 𝜓 𝑖), (24) Fig.4. ExamplesofthDe egree l i‘ kelihoodandentropy𝐻resuK lts ingfromthreesets
ofpowerspectraforincomingandoutgoingradiance.Thelikelihoodis
where𝑑 𝑖 givestheprobabilitythataparameteriswithinarange sampledat100discretevalues.Top:Anidealsituation,wheretheincoming
of1/2𝑛from𝜓 𝑖.Weusethediscretedistributiontocomputethe radianceisadiracdelta(allfrequenciesarepresent).Middle:Asituation
uncertaintywiththedistribution’snormalizedentropy2:
wheretheincomingradiancedoesnothaveenoughamplitudeforhigher
𝑛 degrees.Bottom:Asituationwheretheincomingradianceisideal,butthe
𝐻 =− 1 ∑︁ 𝑑 𝑖log(𝑑 𝑖). (25) specularcomponentistoolowtogetaproperrecoveryfor𝛼.
log(𝑛)
𝑖=1
Intuitively,thenormalizedentropydescribesthespreadofaproba-
bilitydistribution:lowentropymeansthattheprobabilitydistribu- 4.6 DisneyPrincipledBRDF
tionishighlyconcentrated,whichimpliescertainty.Highentropy
ManymodernrenderingpipelinesemployvariantsoftheDisney
meansthattheprobabilitydistributionisspreadout,whichimplies
BRDF[BurleyandStudios2012],whichisacombinationofadiffuse
uncertainty:manyoptionsshareasimilarlyhighprobability.
termandamicrofacettermwithauser-friendlyparametrization.
Weshowthreeexamplesofpowerspectra,theircorresponding
Themodelalsocontainssomeadditionalfeaturesbeyondthescope
likelihoodandentropyinFigure4.Thetoprowshowsincoming
ofthecurrentwork.Wecanformulateourmodelusingtheprin-
lightforadiracdeltalightsource(constantinthesphericalharmonic
cipled BRDF parameters, rather than the raw parameters of the
domain)andweseethatentropyislow(𝐻 = 0.25)andthatitis
Torrance-Sparrowmodel.Weparameterizebasecolor,metallicity
simpletorecoverthecorrectparameters.Themiddleandbottom
androughness,mappingthesetotheTorrance-Sparrowmodelas
rowsareproblematiccases.Inthemiddlerow,thelightonlyhas
amplitudeinlowfrequenciesandmanyroughnessvaluesareequally
likely(𝐻 =0.69),inlinewiththeconclusionsfromRamamoorthi 𝐾 𝑑 =𝑅 𝑏, (26)
andHanrahan.Thebottomrowshowsamaterialwithverylow 𝐾 𝑠 =1, (27)
specularreflectance,resultinginhighentropy(𝐻 =0.87).Thiscould 𝑅 0=0.04+(𝑅 𝑏−0.04)𝑚, (28)
resultinincorrectestimatesundernoisyconditions.Concluding, 𝐹(𝜃 𝑜)=𝑅 0+(1−𝑅 0)(1−cos𝜃 𝑜)5, (29)
entropyasuncertaintygeneralizesandquantifiestheobservations
madebyRamamoorthiandHanrahanontheuncertaintyforcertain 𝛼 =𝑟2, (30)
incominglightandmaterialparameters,withoutrequiringaprior
estimateoftheBRDFparameters. where𝑅 𝑏 isthebasecolor,𝑚isthemetallicityparameterand𝑟 is
theroughness.IntheablationswheretheFresneltermisnotused,
2Thisisequivalenttocomputingentropyonacontinuousprobabilitydensityfunction weset𝐾 𝑠 =𝑅 0.Notethatweset𝐾 𝑠 to1,becausethespecularterm
usingthelimitingdensityofdiscretepoints[Jaynes1957]. iscontainedintheFresneltermas𝑅 0.
,Vol.1,No.1,Article.Publicationdate:June2024.
rewoP
rewoP
rewoP
α
α
α10 • RubenWiersma,JulienPhilip,MilošHašan,KrishnaMullia,FujunLuan,ElmarEisemann,andValentinDeschaintre
BaseColor Roughness Metallic Entropy Relighting1 Relighting2 Relighting3 Relighting4
Fig.5. WecompareourapproachtoMitsubaandphotographsforrelighting.Thefirstcolumnontheleftshowsmaterialparametersandtrainingphotographs,
whiletherightcolumnshowsrelitresultsandphotographsunderdifferentlighting.Weseethatourresultsmatchtheappearanceofthephotographsaswell-
orslightlybetterthanMitsuba.Weseethattheentropyislowerwhereinputsprovidemoreinformation(e.g.well-litregions).VideosintheSupplement.
,Vol.1,No.1,Article.Publicationdate:June2024.
sruO
abustiM
shpargotohP
sruO
abustiM
shpargotohP
sruO
abustiM
shpargotohP
stupnI
stupnI
stupnIFastandUncertainty-AwareSVBRDFRecoveryfromMulti-ViewCaptureusingFrequencyDomainAnalysis • 11
5 EXPERIMENTS Table1. BenchmarkComparisonforNovelSceneRelightingfrom[Kuang
etal.2023].Allthemodelslistedinthistableweretrainedwiththeground-
Ourmethodyieldstwomainbenefits:fastfittingandameasure truth3Dscanandground-truth,in-the-wildenvironmentmaps.Wereport
ofuncertainty.Inourexperiments,wevalidatethesebenefitswith evaluationsonthesamedatasetandtaskunderdifferentacquisitioncondi-
comparisons,provideinsightintovariationsofthealgorithmin tionsintheAppendix.
ablations,andshowapplicationstodemonstratepotentialusecases.
PSNR-H↑ PSNR-L↑ SSIM↑ LPIPS↓ Time
5.1 Implementation NVDiffRec[Munkbergetal.2022] 24.319 31.492 0.969 0.036 142.143s
Mitsuba[Jakobetal.2022] 26.595 34.185 0.977 0.032 69.96s
We implement our full pipeline in PyTorch. The output of our Ours 26.677 33.936 0.977 0.029 5.27s
methodisasetofPBRtextures(roughness,metallicity,basecolor) Ours-SpectrumOnly 24.478 31.117 0.971 0.037 1.96s
whicharemappedtotheinputmeshwithUV-coordinatesto512x512 Ours+Mitsuba(1epoch) 27.038 34.560 0.978 0.030 19.87s
Ours+Mitsuba(2epochs) 27.199 34.770 0.978 0.029 33.39s
textures. For re-renders, we feed the textures produced by our
methodintoMitsuba,whichispossibleduetothemappingtothe
principledBRDFdescribedinsubsection4.6.Eachtimingresult
isreportedonamachinewithanNVIDIARTX4090GPUandan
AMDRyzen97950X16-CoreCPU.Wewillpublishthecodeforour 5.3 Acquisitioncomparison
experimentswithscriptstoreplicateeachtableuponpublication.
OurmaincomparisontargetisMitsuba3[Jakobetal.2022],asit Wevalidatethatourimprovedconvolutionmodelresultsinhigh-
isawell-documented,open-source,andresearch-friendlypackage quality acquisition results. We also quantify the benefit of our
fordifferentiablerendering.MorerecentlySunetal.[2023]propose methodcomparedtoothermethodsregardingoptimizationtime.
to jointly optimize for lighting, material and geometry, but did WetestourapproachonStanfordORBandsyntheticscenes.
notyetreleaseapublicimplementation;giventhattheyrelyona
complexdifferentiablerenderer,webelieveMitsuba3tobethebest 5.3.1 StanfordORB. Thesimilaritymetricsforrelightingresults
proxyfortheirinversePBRstep.WhenoptimizingwithMitsuba, on Stanford ORB are presented in Table 1. We find that our ap-
wesampleonerayperpixelineachview.Thematerialparameters proachperformsonparwithMitsuba,whiledemonstratinga13
areoptimizedwithstochasticgradientdescent,wherethegradient timesspeedupwithlittleoptimizationonourside(e.g.,wedonot
foreachstepisestimatedwitharandomsetofraystoensuregood implementcustomCUDAkernelsandusepurePyTorch).Wealso
convergence.Eachprimaryrayissampled32times,allowingthe comparetoNVDiffRec,asitleveragesadifferentiablerasterizer,and
reflectiondirectionstobesampled.WerunanAdamoptimizeruntil showthatourmethodachievesbetterrelightingresults.ForNVD-
convergenceoramaximumof10epochs. iffRec,giventhatweoptimizeformaterialsonly,wemonitortheloss
andrecordthetimeforgoodconvergence.Weempiricallyfind2000
stepstobesufficientforthisdataset.Wequalitativelycompareour
5.2 Datasets
resultstoMitsubaandphotographsoftheobjectsunderthesame
Weperformexperimentsonarecentin-the-wildbenchmarkdataset, illuminationinFigure5andagainstNVDiffRecinsupplemental
StanfordORB[Kuangetal.2023]andonsyntheticscenes.Stanford material.Wepresentaviewofourmaterialchannelsprojectedon
ORBcontains14objects,eachcaptured3timesindifferentscenes thecapturedobjectandafewinputphotographs.Theentropyis
(lightingenvironments),selectedfromatotalof7scenes.Thelight- visualizedusingthe"Turbo"colormap.Onthefourrightcolumns,
ingenvironmentiscapturedthroughachromeballandstoredasa wepresentrenderingsofourresultsandMitsubaunderanovel
lat-longenvironmentmap.Eachobjectisalsoscannedinaseparate illuminationandcomparethemagainstphotographsoftheobject
stage,providinghigh-qualitygeometry.Forourevaluation,wefocus takenunderthatsameillumination.Wecanseethatourapproach
onthe(SV)BRDFrecoverystepandusetheprovidedgeometry.In recoverssimilarappearanceinafractionofthetime.
ourexperiments,weoptimizematerialparametersforeachobject,
foreachofthethreeenvironments,andtestagainstthephotographs 5.3.2 Synthetic. Forsyntheticdatasets,wecomparetherecovered
ofthesameobjectinthetwoenvironmentsthatwerenotobserved materialparameterswiththeground-truthparameters.Weshowthe
duringoptimization. resultsinTable2,demonstratingcomparableaccuracycomparedto
Forthesyntheticbenchmark,weselected15objectswithspatially Mitsubadespiteparticularlychallengingobjectsforourmethod(e.g.
varyingBRDFtexturesforbasecolor,roughnessandmetallicity. withsignificantinter-reflections–metallicchesspiecesandself-
We selected four environment maps with varying challenges to occlusion–donut).WealsoshowaqualitativeevaluationinFigure7,
rendertheobjects:twoindoorscenes,oneoutdoorscenewitha showingtheparametersinUVspacealongsidetheentropymaps
clear sky and sun, and one overcast outdoor scene. Because we (visualizedusingthe“Turbo”colormap)forresultsoptimizedfrom
haveground-truthmaterialtexturesforthesyntheticscenes,we imagesrenderedunderthe“ruralasphaltroad”environmentlight.
canquantitativelyevaluateouroptimizationresultsandvalidate Ontherightcolumnswecomparererenderingsofourresultsand
uncertaintydirectlyontheoptimizedparameters.Theobjectsare Mitsuba’stoground-truthrenderingsunderadifferentillumination,
renderedinMitsubaat512×512resolutionand256samplesper showingoncemoreagoodappearancematch.Weincludevisual
pixel.RendersandgroundtruthviewsforbothStanfordORBand comparisonsonallsyntheticcasesaswellastheexr filesforall
thesyntheticbenchmarkareincludedintheSupplement. lightenvironmentsinSupplementalMaterial.
,Vol.1,No.1,Article.Publicationdate:June2024.12 • RubenWiersma,JulienPhilip,MilošHašan,KrishnaMullia,FujunLuan,ElmarEisemann,andValentinDeschaintre
Table2. Syntheticbenchmarkcomparison(MSE)ofMitsubaandourmethodtotheground-truthparameters.Foreachenvironmentwepresenttheerrorin
thefollowingway:Average(BaseColor,Roughness,Metallicity).Wealsoreportforeachenvironmentthecorrelationbetweentheentropywecomputewith
ourpowerspectrumapproximationandtheerrorinMitsuba’soptimizationtoshowthatourentropyisusefulforgeneralinverserenderingpipelines.
PhotoStudio Overcast Museum RuralRoad Avg. Time
Mitsuba 0.04(0.01,0.03,0.07) 0.03(0.01,0.02,0.06) 0.04(0.01,0.04,0.08) 0.04(0.01,0.03,0.07) 0.04(0.01,0.03,0.07) 105.19s
Ours 0.07(0.02,0.09,0.10) 0.06(0.02,0.07,0.09) 0.07(0.02,0.08,0.11) 0.05(0.01,0.05,0.08) 0.06(0.02,0.07,0.09) 3.14s
Ours-SpectrumOnly 0.19(0.07,0.15,0.37) 0.20(0.06,0.14,0.40) 0.25(0.09,0.20,0.46) 0.22(0.06,0.16,0.43) 0.21(0.07,0.16,0.41) 1.20s
Error-Entropycorrelation 0.21 0.13 0.18 0.14 0.16 -
5.4 Uncertainty
isparticularlyvisibleonthediceexampleinthesyntheticSupple-
Wetestwhetherourproposedentropy-baseduncertaintymetricis mentalMaterialswhere3facesarewelllit,andtheiropposedfaces
indicativeoferrorininverserenderingresultsandrepresentative arenot).
foruncertaintyinotherinverserenderingframeworks.
5.5 Ablations
5.4.1 StanfordORB. Ourfirstclaimisthattheentropycomputed Ourablationsservetwogoals.First,wewanttovalidatethatourpro-
usingourpowerspectrumorotherdifferentiablerendererswill posedimprovementstoRamamoorthiandHanrahan[2001]makea
besimilar.Wevalidatethisbycomputingourproposedentropy significantdifference.Second,wewouldliketostudythesensitivity
ontheStanfordORBdatasetwithMitsuba,onagridof8×8×8 oftheapproachtosomehyperparameters(e.g.regularizerweight,
parameters(roughness,metallicity,basecolor).Wecomputethe numberofsphericalharmonicsdegrees).Wevaryourmethodand
Pearsoncorrelationcoefficient,𝜌,betweenentropycomputedwith reporttheresultsonStanfordORBandthesyntheticdataset.Further
ourpowerspectrumapproximationandtheonecomputedwith ablationsonspherical-harmonicsfittingareintheAppendix.
Mitsuba’sfully-fledgeddifferentiablerenderer.Wefindahighcorre-
5.5.1 BRDFmodelvariants. Tounderstandwhetherourproposed
lationbetweenentropycomputedwithMitsubaandbothourmixed
improvementstotheBRDFmodelbyRamamoorthiandHanrahan
renderer𝜌 =0.90andthepowerspectrumapproximation𝜌 =0.89
[2001]resultinhigher-qualityacquisitionresults,westudyvariants
asshowninTable3.Thisvalidatesthattheentropywecompute
ofourmodelwithandwithouttheshadowingandmaskingterms.
withourpowerspectrumbasedmodelisindeedsimilartothatcom-
Werunourablationswithaconstantweightonallthesamples.The
putedwithafully-fledgeddifferentiablerenderer.Further,asour
resultsonStanfordORBarepresentedinTable4.Weobservethatthe
powerspectrumapproximationisembarrassinglyparallelizable,we
shadowing-andmaskingtermsimprovetheresultsindependently
obtainextremespeedupsoverboththemixedsphericalharmonics
andwegetthebestresultswithboth.
method(2645×)andMitsuba(800,000×)makingouruncertainty
estimationverypractical. 5.5.2 ConvolutionalonlyvsDirectional. Oneofthemainbenefits
ofourmethodisthatwecanstudytheeffectoftheBRDFfullyin
5.4.2 Synthetic dataset. We also evaluate whether low entropy thesphericalharmonicsdomain.WecanperformthefullBRDF
isassociatedwithlowererrorafteroptimization,evenforresults recoveryprocedureinthesphericalharmonicdomainorthepower
optimizedwithanotherapproach(Mitsuba),indicatingifenough
informationisintheinput.Ifentropyishigh,wehaveahigher
Table3. ComparingcorrelationbetweenentropycomputedwithMitsuba
likelihoodofincorrectparameters,thoughtheymightstillbegood.
andourapproximations.
Indeedwedonotexpectaone-to-onecorrelation(𝜌 =1).Forexam-
ple,ifthelikelihoodforparametersinuncertainregionsisuniform,
lowerrorinahighentropypartisequallylikelyashigherror.That EntropyMitsuba↑ Time
meansacorrelationof0.5isthemostwecanreasonablyexpect.We EntropyMitsuba 1.00±0.00 15m
studythisbycomputingthecorrelationbetweenentropycomputed Entropyangular 0.90±0.05 2.91s
usingthepowerspectrumapproximationandthesquarederror Entropypowerspectrum 0.89±0.06 0.0011s
betweentheground-truthmaterialparametersandtheparameters
optimizedwithMitsuba.Ontopofuncertainty,therecouldbeother Table4. WeablatethedifferentcomponentsoftheBRDF.Forthisablation
factorsforerror,whichcouldresultinlowercorrelation(suchas wedonotapplyacosineweightingtothesamples,betterhighlightingthe
globalilluminationapproximations,approximatelightenvironment, impactoftheshadowingandmaskingterms.
andincorrectgeometry).InthelastrowofTable2weshowthe
correlationscores.WeshowinFigure6resultsoptimizedfromim-
StanfordORB Synthetic
agesrenderedunderthelightingenvironment“ruralasphaltroad”
Shadowing Masking PSNR-H↑ PSNR-L↑ SSIM↑ LPIPS↓ Time MSE Time
whichpresentsastrongdirectionalillumination(sun,outdoor,see
- - 25.646 32.809 0.973 0.035 1.09s 0.16 2.57s
supplementalfolder).Wecanseethatareaswhicharenotdirectly ✓ - 26.245 33.399 0.975 0.034 1.21s 0.14 2.81s
litbythesunintheinputimagesexhibithigherentropy,intuitively, - ✓ 26.070 33.101 0.974 0.035 1.19s 0.13 2.89s
withoutenoughobservedspecularsignal,uncertaintyishigh(this
✓ ✓ 26.411 33.557 0.975 0.034 1.31s 0.12 3.14s
,Vol.1,No.1,Article.Publicationdate:June2024.FastandUncertainty-AwareSVBRDFRecoveryfromMulti-ViewCaptureusingFrequencyDomainAnalysis • 13
One GT Estimated GT Estimated GT Estimated Estimation Our
InputView BaseColor BaseColor Roughness Roughness Metallicity Metallicity Error Entropy
Fig.6. Wedemonstratetheinformativenessofourfastapproximateentropyforotherinverserenderingframeworks(inthiscase,Mitsuba).Weinterleave
groundtruthpropertiesandpropertiesestimatedwithMitsuba(basecolor,roughness,metallicity).Ontheright,weshowtheaverageestimationerror
followedbyourentropyestimation,whichisindependentofMitsuba’sestimation.Weobservethatlowentropyisindicativeoflowererror,suggestingthatit
capturesthesufficiencyofinformationintheinputsignal.Onthediceexample(toprow),the‘one’-faceislitlessthanotherfacesandweobservehighlights
withlowerintensity,leadingtohigherentropy.Whilewestillrecoverthewhitealbedocorrectly,theestimationofroughnessandmetallicityforthedothasa
higherror.Similarly,theinsideandlowerpartsofthedoughnutarelessobservedandnotlitbystronglightsources.Again,entropyishighinregionsofhigh
error(especiallyinmetallicity).Thetriceratopscollarisdown-facingandnotwell-litandourentropycapturesthelackofobservationthatleadstohigherror
inthemetallicitypart.
spectrumdomain,asdoneforourinitializationanduncertainty. 5.6.1 Initialization. Inthecomparisons,ourmethoddemonstrated
WeshowtheimpactofevaluatingtheBRDFparametersfromthe a fast and high-quality estimate of BRDF parameters. However,
powerspectruminrowfourofTable1,comparedtorunningour thereisstillbenefittofinetuningourresultswithadifferentiable
ourmixedfrequency-directionaloptimization(thirdrow).Asthese pathtracer.Suchastepcouldfinetunepartsofthematerialthat
approximationsdonotaccountforeffectssuchasFresnelorshadow- areaffectedbyglobalillumination(e.g.,incorners,ornearhighly
ing/masking,weobservelowerappearancematching,asexpected. reflectivesurfaces).Inthisexperiment,weshowthebenefitofthis
Theapproximationshoweverstillresultinaverygoodappearance approach by initializing material textures with the results from
matchandextremelyfastcomputation.Mostofthereportedtimings ourmethodandoptimizingthemwithMitsubaforoneepochand
inTable1reflectsthefittingofthesphericalharmonics,whichonly only16samplesperpixel(halfthesamplesweusedfortheother
hastobedoneonce,lettinguseasilyexplorehundredstothousands experiments).Thisfinetuningpassonlycosts14s,foratotalof20s
of possible parameter combinations in a fraction of a second to combinedwithoutmethodasinitialization.Thisisoverthreetimes
computeuncertainty. fasterthanthe70srequiredwithoutthisinitialization(Table1).The
resultsinTable5showthatthecombinationofourapproachanda
5.6 Applications
finetuningpasswithMitsubaforoneortwoepochsachievesbetter
Inourapplications,weshowhowfastacquisitionanduncertainty
performancethanonlyusingMitsuba(+0.5dBPSNR-H,PSNR-L)
can be used in (SV)BRDF capture to improve results, and guide forlessthanathirdofthetime.Wealsosurpasstheresultsforonly
understandingoferror. ourmethod,whichistobeexpected.
5.6.2 Sharinginformation. Pointsonthesurfacewithlowentropy
Table5. Weapplyourresultsasaninitializationforashortfine-tuningpass havereasonablecertaintyandwilllikelyexhibitlowererrorthan
usinggradientdescentwithadifferentiablepathtracer(Mitsuba):weuse partswithhighentropy.Wecanusethisinformationtoselectthe
only1epochwith16samplesperpixelforthefirstthreerowsand2epochs
with32samplesperpixelforthefourthrow.Thefinalrowshowstheresult
Table6. Wecombinetheoptimizationresultsfrommultipleenvironments
ofafulloptimizationforMitsuba.
intoonetexturebyusingtheparameterwiththelowestcertainty.We
presenttheMSEinthefollowingway:Average(BaseColor,Roughness,
Initialization PSNR-H↑ PSNR-L↑ SSIM↑ LPIPS↓ Totaltime Metallicity)
Constant 24.339 30.558 0.969 0.047 14.74s
Ours-SpectrumOnly 25.745 33.158 0.975 0.033 16.29s
Ours 27.038 34.560 0.978 0.030 19.87s MSESynthetic
Ours(2epochs) 27.199 34.770 0.978 0.029 33.39s Average 0.04(0.01,0.03,0.07)
Fulloptimization-Constant 26.595 34.185 0.977 0.032 69.96s argminEntropy 0.03(0.01,0.02,0.06)
,Vol.1,No.1,Article.Publicationdate:June2024.14 • RubenWiersma,JulienPhilip,MilošHašan,KrishnaMullia,FujunLuan,ElmarEisemann,andValentinDeschaintre
BaseColor Roughness Metallic Entropy Relighting1 Relighting2 Relighting3
Fig.7. WecompareourresultstoMitsubaandgroundtruthparametersonsyntheticdata.Weseethatweachievesimilarmatchingqualitywitha35x
speedupintheoptimization.Therelitrenderingsarefromtestviewsusingalightingenvironmentunseenduringoptimization.Heretooweseethatentropyis
higherwhereinputsprovidelessinformation(seesupplementalmaterialsforinputs).
,Vol.1,No.1,Article.Publicationdate:June2024.
sruO
abustiM
hturTdnuorG
sruO
abustiM
hturTdnuorG
sruO
abustiM
hturTdnuorGFastandUncertainty-AwareSVBRDFRecoveryfromMulti-ViewCaptureusingFrequencyDomainAnalysis • 15
0.84 shadowingandmaskingtobetterreconstructthetargetappearance
0.075
andestimatedproperties,comparedtotheexistingsignalprocessing
0.070 0.82
frameworkforinverserendering.Ourmethodyieldsresultsthatare
0.065 0.80 onparwiththestate-of-the-artfora13xspeedupinoptimization
0.060 MSE Average entropy and,combinedwithstate-of-the-art,yieldsimprovedresultsforless
0.78
0.055 thanathirdofthetime.
0.050 0.76 Weseethefollowingchallengesforfuturework.Ourmethod
10 20 30 40 10 20 30 40 requiresHDRimagesasinput,becausethetruncationappliedfor
Number of views Number of views
LDRimagescouldintroducefrequenciesthatarenotpresentinthe
Fig.8. PlotsofMSEandEntropyforvaryinginputviewcountsonthesyn- originalsignal.Tomakeourmethodmoreaccessibleforusewith
theticbenchmarkwiththeRuralRoadenvironment,showingthatentropy LDRimages,itisofinteresttostudyhowtousesphericalharmonics
canbeusedasaproxyofaverageMSEforagivensetofviews. decompositionsonLDRimages.Thiscouldbeimplemented,for
example,asanamendmenttotheleast-squaresfittingprocedure.
Ourcurrentimplementationonlyconsidersdirectillumination,ne-
bestconditionstorecoverBRDFparameters,forexamplefromdif- glectingself-illuminationandself-shadowingwhichmayappear
ferentlightingsetups.Asaproofofconcept,wemergethetexture inchallengingconcaveobjects;ourmethodcouldbeextendedto
mapsfromthesyntheticscenesbasedonentropy:foreverytexel,we takethemintoaccountwitharaytracer,asourcoretheoretical
usetheparametersfromtheenvironmentwiththelowestentropy andalgorithmiccontributionsaredefinedforageneraldirectional
atthattexel.TheresultinTable6showsthatthissimpleapproach radiancefieldforpointsinspace.Nonetheless,ourmethodproduces
beatstheaverageoverseparateenvironmentsby25%.Thescoreis accurateestimationsofmaterialsandcanbeusedasaninitialization
equaltothebest-performingenvironmentinTable2.Withthis,we formorecomplete(andslower)differentiablerenderer[Jakobetal.
areabletoselectthebestparameterswithoutknowingtheground- 2022]forareasshowingeffectsthatwedonotcurrentlysupport.
truth. We believe that this approach would yield even stronger Webelievethatourrenewedexplorationandimprovementofthe
resultsinthecontextofmorecomplementaryenvironments. frequency-basedmodeldemonstratesthemeritsofthisframework.
Weareexcitedaboutfurtherapplicationsthattakeadvantageof
5.6.3 Guidingcapture. Entropycanbeappliedduringcaptureasa entropyasameasureofuncertaintyformaterialrecovery.
measuretodefinethemostinformativeviews.Ifaviewdecreases
entropy,it’suseful;ifitdoesnot,wecoulddiscardit.Itisdifficult REFERENCES
toknowwhatinformationaviewwilladdwithoutknowingits
MiikaAittala,TimoAila,andJaakkoLehtinen.2016.Reflectancemodelingbyneural
contents.Asolutiontothiscouldbetocomputeanexpecteddecrease texturesynthesis.ACMTrans.Graph.35,4,Article65(jul2016),13pages. https:
inentropy(informationgain)incasepotentialviewsarenotknown. //doi.org/10.1145/2897824.2925917
MiikaAittala,TimWeyrich,andJaakkoLehtinen.2013.PracticalSVBRDFcapturein
Sincethisisnotpartofourcorecontribution,weleavethisfor
thefrequencydomain.ACMTrans.Graph.32,4(2013),110–1.
futurework.Instead,weshowthatentropyisusefultomeasure MiikaAittala,TimWeyrich,JaakkoLehtinen,etal.2015.Two-shotSVBRDFcapture
theinformativenessofviews.Weranthesyntheticbenchmarkfor forstationarymaterials.ACMTrans.Graph.34,4(2015),110–1.
SaiBi,ZexiangXu,PratulP.Srinivasan,BenMildenhall,KalyanSunkavalli,MilosHasan,
oneenvironment(RuralRoad)andrandomlydropoutviewsfor YannickHold-Geoffroy,DavidJ.Kriegman,andRaviRamamoorthi.2020.NeuralRe-
everyoptimization.InFigure8,weshowthecorrespondingaverage flectanceFieldsforAppearanceAcquisition.abs/2008.03824(2020).arXiv:2008.03824
MSEoverallshapesandchannelsandtheaverageentropyover https://arxiv.org/abs/2008.03824
MarkBoss,RaphaelBraun,VarunJampani,JonathanTBarron,CeLiu,andHendrik
allshapes.WeobserveaclearrelationshipbetweentheMSEand Lensch.2021a.Nerd:Neuralreflectancedecompositionfromimagecollections.In
entropy,demonstratingthatwecanuseentropyasaproxyforthe ProceedingsoftheIEEE/CVFInternationalConferenceonComputerVision.12684–
12694.
expectedsuccessofanoptimization.Ifoneweretouseentropyin
MarkBoss,VarunJampani,RaphaelBraun,CeLiu,JonathanBarron,andHendrik
realtime,thealternativestothepowerspectrumapproximation Lensch.2021b.Neural-pil:Neuralpre-integratedlightingforreflectancedecomposi-
quicklybecometedioustouse:foreveryframethatisconsidered, tion.AdvancesinNeuralInformationProcessingSystems34(2021),10691–10704.
MarkBoss,VarunJampani,KihwanKim,HendrikLensch,andJanKautz.2020.Two-
onewouldeitherhavetowaitacoupleofsecondsorminutesto shotspatially-varyingbrdfandshapeestimation.InProceedingsoftheIEEE/CVF
computetheentropy(Table3). ConferenceonComputerVisionandPatternRecognition.3982–3991.
BrentBurleyandWaltDisneyAnimationStudios.2012.Physically-basedshadingat
6 CHALLENGESANDCONCLUSION disney.InAcmSiggraph,Vol.2012.vol.2012,1–7.
WesleyChang,VenkataramSivaram,DerekNowrouzezahrai,ToshiyaHachisuka,Ravi
Ramamoorthi,andTzu-MaoLi.2023.Parameter-spaceReSTIRforDifferentiableand
Insummary,wepresentamaterialacquisitionanduncertaintyesti-
InverseRendering.InACMSIGGRAPH2023ConferenceProceedings(LosAngeles,
mationmethodformulti-viewcaptureofobjectsusingafrequency CA,USA)(SIGGRAPH’23).AssociationforComputingMachinery,NewYork,NY,
domainanalysis.Wedosothroughefficientsphericalharmonics USA,10pages. https://doi.org/10.1145/3588432.3591512
ValentinDeschaintre,MiikaAittala,FredoDurand,GeorgeDrettakis,andAdrien
fittingandapowerspectrumapproximationthatletsusefficiently
Bousseau.2018.Single-imagesvbrdfcapturewitharendering-awaredeepnetwork.
compute the error associated with varying material parameters ACMTransactionsonGraphics(ToG)37,4(2018),1–15.
forasurface.Byinterpretingthiserrorasalikelihoodfunction, ValentinDeschaintre,MiikaAittala,FrédoDurand,GeorgeDrettakis,andAdrien
Bousseau.2019. Flexiblesvbrdfcapturewithamulti-imagedeepnetwork.In
wecanuseentropyasameasureofuncertainty.Theresultsindi- Computergraphicsforum,Vol.38.WileyOnlineLibrary,1–13.
catecorrelationoflowentropywithlowerror,bothquantitatively ValentinDeschaintre,GeorgeDrettakis,andAdrienBousseau.2020. GuidedFine-
TuningforLarge-ScaleMaterialTransfer.ComputerGraphicsForum(Proceedingsof
andqualitatively.Weshowthatentropycanbeausefulproxyfor
theEurographicsSymposiumonRendering)39,4(2020). http://www-sop.inria.fr/
acquisitionquality.Wealsoproposeawaytotakeintoaccount reves/Basilic/2020/DDB20
,Vol.1,No.1,Article.Publicationdate:June2024.16 • RubenWiersma,JulienPhilip,MilošHašan,KrishnaMullia,FujunLuan,ElmarEisemann,andValentinDeschaintre
ValentinDeschaintre,YimingLin,andAbhijeetGhosh.2021.Deeppolarizationimaging Hendrik P.A. Lensch, Jochen Lang, Asla M. Sá, and Hans-Peter Seidel. 2003b.
for3DshapeandSVBRDFacquisition.InProceedingsoftheIEEE/CVFConferenceon Planned Sampling of Spatially Varying BRDFs. Computer Graphics Fo-
ComputerVisionandPatternRecognition.15567–15576. rum 22, 3 (2003), 473–482. https://doi.org/10.1111/1467-8659.00695
YueDong,GuojunChen,PieterPeers,JiawanZhang,andXinTong.2014.Appearance- arXiv:https://onlinelibrary.wiley.com/doi/pdf/10.1111/1467-8659.00695
from-motion:Recoveringspatiallyvaryingsurfacereflectanceunderunknown XiaoLi,YueDong,PieterPeers,andXinTong.2017.Modelingsurfaceappearancefrom
lighting.ACMTransactionsonGraphics(TOG)33,6(2014),1–12. asinglephotographusingself-augmentedconvolutionalneuralnetworks. ACM
J.R.DriscollandD.M.Healy.1994.ComputingFourierTransformsandConvolutions TransactionsonGraphics(ToG)36,4(2017),1–11.
onthe2-Sphere. AdvancesinAppliedMathematics15,2(1994),202–250. https: ZhengqinLi,ZexiangXu,RaviRamamoorthi,KalyanSunkavalli,andManmohan
//doi.org/10.1006/aama.1994.1008 Chandraker.2018.Learningtoreconstructshapeandspatially-varyingreflectance
JonathanDupuyandWenzelJakob.2018.AnAdaptiveParameterizationforEfficientMa- fromasingleimage.ACMTransactionsonGraphics(TOG)37,6(2018),1–11.
terialAcquisitionandRendering.TransactionsonGraphics(ProceedingsofSIGGRAPH GuillaumeLoubet,NicolasHolzschuch,andWenzelJakob.2019. Reparameterizing
Asia)37,6(Nov.2018),274:1–274:18. https://doi.org/10.1145/3272127.3275059 DiscontinuousIntegrandsforDifferentiableRendering.TransactionsonGraphics
FrédoDurand,NicolasHolzschuch,CyrilSoler,EricChan,andFrançoisX.Sillion. (ProceedingsofSIGGRAPHAsia)38,6(Dec.2019). https://doi.org/10.1145/3355089.
2005.Afrequencyanalysisoflighttransport.ACMTrans.Graph.24,3(jul2005), 3356510
1115–1126. https://doi.org/10.1145/1073204.1073320 ShiMao,ChenmingWu,ZhelunShen,andLiangjunZhang.2023.NeuS-PIR:Learn-
AndreasEngelhardt,AmitRaj,MarkBoss,YunzhiZhang,AbhishekKar,Yuanzhen ingRelightableNeuralSurfaceusingPre-IntegratedRendering. arXivpreprint
Li,DeqingSun,RicardoMartinBrualla,JonathanT.Barron,HendrikP.A.Lensch, arXiv:2306.07632(2023).
andVarunJampani.2024.SHINOBI:SHapeandIlluminationusingNeuralObject RosalieMartin,ArthurRoullier,RomainRouffet,AdrienKaiser,andTamyBoubekeur.
DecompositionviaBRDFOptimizationIn-the-wild.ArXive-prints(2024). 2022.MaterIA:SingleImageHigh-ResolutionMaterialCaptureintheWild.Com-
ChongruiFan,YimingLin,andAbhijeetGhosh.2023. DeepShapeandSVBRDF puterGraphicsForum(Proc.EUROGRAPHICS2022)toappear,toappear(2022),to
EstimationusingSmartphoneMulti-lensImaging.ComputerGraphicsForum(2023). appear.
https://doi.org/10.1111/cgf.14972 BenMildenhall,PratulP.Srinivasan,MatthewTancik,JonathanT.Barron,RaviRa-
Roland W. Fleming, Ron O. Dror, and Edward H. Adelson. 2003. Real- mamoorthi,andRenNg.2020.NeRF:RepresentingScenesasNeuralRadianceFields
world illumination and the perception of surface reflectance proper- forViewSynthesis.InECCV.
ties. Journal of Vision 3, 5 (07 2003), 3–3. https://doi.org/10.1167/3.5.3 JacobMunkberg,JonHasselgren,TianchangShen,JunGao,WenzhengChen,Alex
arXiv:https://arvojournals.org/arvo/content_public/journal/jov/932825/jov-3-5- Evans,ThomasMüller,andSanjaFidler.2022. Extractingtriangular3dmodels,
3.pdf materials,andlightingfromimages.InProceedingsoftheIEEE/CVFConferenceon
YarinGalandZoubinGhahramani.2016.Dropoutasabayesianapproximation:Repre- ComputerVisionandPatternRecognition.8280–8290.
sentingmodeluncertaintyindeeplearning.Ininternationalconferenceonmachine GiljooNam,JooHoLee,DiegoGutierrez,andMinH.Kim.2018.PracticalSVBRDF
learning.PMLR,1050–1059. Acquisitionof3DObjectswithUnstructuredFlashPhotography.ACMTransactions
DuanGao,XiaoLi,YueDong,PieterPeers,KunXu,andXinTong.2019.Deepinverse onGraphics(Proc.SIGGRAPHAsia2018)37,6(2018),267:1–12. https://doi.org/10.
renderingforhigh-resolutionSVBRDFestimationfromanarbitrarynumberof 1145/3272127.3275017
images.ACMTrans.Graph.38,4(2019),134–1. BaptisteNicolet,AlecJacobson,andWenzelJakob.2021.LargeStepsinInverseRen-
AbhijeetGhosh,ShruthiAchutha,WolfgangHeidrich,andMatthewO’Toole.2007. deringofGeometry.ACMTransactionsonGraphics(ProceedingsofSIGGRAPHAsia)
BRDFAcquisitionwithBasisIllumination.In2007IEEE11thInternationalConference 40,6(Dec.2021). https://doi.org/10.1145/3478513.3480501
onComputerVision.IEEE,RiodeJaneiro,Brazil,1–8. https://doi.org/10.1109/ICCV. BaptisteNicolet,FabriceRousselle,JanNovák,AlexanderKeller,WenzelJakob,and
2007.4408935 ThomasMüller.2023.RecursiveControlVariatesforInverseRendering.Transactions
LilyGoli,CodyReading,SilviaSellán,AlecJacobson,andAndreaTagliasacchi.2024. onGraphics(ProceedingsofSIGGRAPH)42,4(Aug.2023). https://doi.org/10.1145/
Bayes’Rays:UncertaintyQuantificationinNeuralRadianceFields.CVPR(2024). 3592139
JieGuo,ShuichangLai,ChengzhiTao,YuelongCai,LeiWang,YanwenGuo,and MerlinNimier-David,ZhaoDong,WenzelJakob,andAntonKaplanyan.2021.Mate-
Ling-QiYan.2021.Highlight-awaretwo-streamnetworkforsingle-imageSVBRDF rialandLightingReconstructionforComplexIndoorSceneswithTexture-space
acquisition. ACMTrans.Graph.40,4,Article123(jul2021),14pages. https: DifferentiableRendering.InEurographicsSymposiumonRendering-DL-onlyTrack,
//doi.org/10.1145/3450626.3459854 Adrien Bousseau and Morgan McGuire (Eds.). The Eurographics Association.
YuGuo,CameronSmith,MilošHašan,KalyanSunkavalli,andShuangZhao.2020. https://doi.org/10.2312/sr.20211292
Materialgan:reflectancecaptureusingagenerativesvbrdfmodel.arXivpreprint MerlinNimier-David,ThomasMüller,AlexanderKeller,andWenzelJakob.2022.Unbi-
arXiv:2010.00114(2020). asedInverseVolumeRenderingwithDifferentialTrackers.ACMTrans.Graph.41,
PhilippHenzler,ValentinDeschaintre,NiloyJMitra,andTobiasRitschel.2021.Gen- 4,Article44(July2022),20pages. https://doi.org/10.1145/3528223.3530073
erativeModellingofBRDFTexturesfromFlashImages.ACMTransGraph(Proc. MerlinNimier-David,SébastienSpeierer,BenoîtRuiz,andWenzelJakob.2020.Radiative
SIGGRAPHAsia)40,6(2021). Backpropagation:AnAdjointMethodforLightning-FastDifferentiableRendering.
InseungHwang,DanielS.Jeon,AdolfoMuñoz,DiegoGutierrez,XinTong,andMinH. TransactionsonGraphics(ProceedingsofSIGGRAPH)39,4(July2020). https://doi.
Kim.2022.SparseEllipsometry:PortableAcquisitionofPolarimetricSVBRDFand org/10.1145/3386569.3392406
ShapewithUnstructuredFlashPhotography.ACMTransactionsonGraphics(Proc. MerlinNimier-David,DelioVicini,TizianZeltner,andWenzelJakob.2019.Mitsuba2:
SIGGRAPH2022)41,4(2022). ARetargetableForwardandInverseRenderer.TransactionsonGraphics(Proceedings
WenzelJakob,SébastienSpeierer,NicolasRoussel,MerlinNimier-David,DelioVicini, ofSIGGRAPHAsia)38,6(Dec.2019). https://doi.org/10.1145/3355089.3356498
TizianZeltner,BaptisteNicolet,MiguelCrespo,VincentLeroy,andZiyiZhang.2022. MattPharr,WenzelJakob,andGregHumphreys.2023.Physicallybasedrendering:From
Mitsuba3renderer. https://mitsuba-renderer.org. theorytoimplementation.MITPress.
EdwinTJaynes.1957.Informationtheoryandstatisticalmechanics.Physicalreview RaviRamamoorthiandPatHanrahan.2001.Asignal-processingframeworkforinverse
106,4(1957),620. rendering.InProceedingsofthe28thannualconferenceonComputergraphicsand
HaianJin,IsabellaLiu,PeijiaXu,XiaoshuaiZhang,SongfangHan,SaiBi,Xiaowei interactivetechniques(SIGGRAPH’01).AssociationforComputingMachinery,New
Zhou,ZexiangXu,andHaoSu.2023. TensoIR:TensorialInverseRendering. York,NY,USA,117–128. https://doi.org/10.1145/383259.383271
arXiv:2304.12461 C.Rodriguez-Pardo,H.Dominguez-Elvira,D.Pascual-Hernandez,andE.Garces.2023.
BernhardKerbl,GeorgiosKopanas,ThomasLeimkühler,andGeorgeDrettakis.2023. UMat:Uncertainty-AwareSingleImageHighResolutionMaterialCapture.In2023
3DGaussianSplattingforReal-TimeRadianceFieldRendering.ACMTransactionson IEEE/CVFConferenceonComputerVisionandPatternRecognition(CVPR).IEEE
Graphics42,4(July2023).https://repo-sam.inria.fr/fungraph/3d-gaussian-splatting/ ComputerSociety,LosAlamitos,CA,USA,5764–5774. https://doi.org/10.1109/
ZhengfeiKuang,YunzhiZhang,Hong-XingYu,SamirAgarwala,ShangzheWu,andJia- CVPR52729.2023.00558
junWu.2023.Stanford-ORB:AReal-World3DObjectInverseRenderingBenchmark. RaduAlexandruRosuandSvenBehnke.2023.PermutoSDF:FastMulti-ViewReconstruc-
arXiv:2310.16044[cs.CV] tionwithImplicitSurfacesusingPermutohedralLattices.InIEEE/CVFConference
SamuliLaine,JanneHellsten,TeroKarras,YeonghoSeol,JaakkoLehtinen,andTimo onComputerVisionandPatternRecognition(CVPR).
Aila.2020. ModularPrimitivesforHigh-PerformanceDifferentiableRendering. VirajShah,SvetlanaLazebnik,andJulienPhilip.2023.JoIN:JointGANsInversionfor
ACMTransactionsonGraphics39,6(2020). IntrinsicImageDecomposition.arXiv(2023).
HendrikLensch,JanKautz,MichaelGoesele,WolfgangHeidrich,andHans-PeterSeidel. LiangShi,BeichenLi,MilošHašan,KalyanSunkavalli,TamyBoubekeur,Radomir
2003a.Image-basedReconstructionofSpatialAppearanceandGeometricDetail. Mech,andWojciechMatusik.2020. MATch:DifferentiableMaterialGraphsfor
ACMTransactionsonGraphics(TOG)22(042003),234–257. https://doi.org/10.1145/ ProceduralMaterialCapture.ACMTrans.Graph.39,6(Dec.2020),1–15.
636886.636891 AndrewSpielberg,FangchengZhong,KonstantinosRematas,KrishnaMurthyJataval-
labhula,CengizÖztireli,Tzu-MaoLi,andDerekNowrouzezahrai.2023. Differ-
entiableVisualComputingforInverseProblemsandMachineLearning. CoRR
,Vol.1,No.1,Article.Publicationdate:June2024.FastandUncertainty-AwareSVBRDFRecoveryfromMulti-ViewCaptureusingFrequencyDomainAnalysis • 17
abs/2312.04574(2023). https://doi.org/10.48550/ARXIV.2312.04574arXiv:2312.04574 ProceedingsoftheIEEE/CVFInternationalConferenceonComputerVision.3848–3858.
PratulPSrinivasan,BoyangDeng,XiumingZhang,MatthewTancik,BenMildenhall, PeiyuXu,SaiBangaru,Tzu-MaoLi,andShuangZhao.2023.Warped-AreaReparameter-
andJonathanTBarron.2021. Nerv:Neuralreflectanceandvisibilityfieldsfor izationofDifferentialPathIntegrals.ACMTrans.Graph.42,6(2023),213:1–213:18.
relightingandviewsynthesis.InProceedingsoftheIEEE/CVFConferenceonComputer ZexiangXu,JannikBollNielsen,JiyangYu,HenrikWannJensen,andRaviRamamoorthi.
VisionandPatternRecognition.7495–7504. 2016.MinimalBRDFsamplingfortwo-shotnear-fieldreflectanceacquisition.ACM
ChengSun,GuangyanCai,ZhengqinLi,KaiYan,ChengZhang,CarlMarshall,Jia-Bin TransactionsonGraphics(TOG)35,6(2016),1–12.
Huang,ShuangZhao,andZhaoDong.2023.Neural-PBIRReconstructionofShape, KaiYan,ChristophLassner,BrianBudge,ZhaoDong,andShuangZhao.2022.Efficient
Material,andIllumination.InProceedingsoftheIEEE/CVFInternationalConference EstimationofBoundaryIntegralsforPath-SpaceDifferentiableRendering.ACM
onComputerVision.18046–18056. Trans.Graph.41,4(2022),123:1–123:13.
K.E.TorranceandE.M.Sparrow.1967. TheoryforOff-SpecularReflectionFrom KaiZhang,FujunLuan,QianqianWang,KavitaBala,andNoahSnavely.2021a.Physg:
RoughenedSurfaces∗.J.Opt.Soc.Am.57,9(Sep1967),1105–1114. https://doi.org/ Inverserenderingwithsphericalgaussiansforphysics-basedmaterialeditingand
10.1364/JOSA.57.001105 relighting.InProceedingsoftheIEEE/CVFConferenceonComputerVisionandPattern
TSTrowbridgeandKarlPReitz.1975.Averageirregularityrepresentationofarough Recognition.5453–5462.
surfaceforrayreflection.JOSA65,5(1975),531–536. XiumingZhang,PratulPSrinivasan,BoyangDeng,PaulDebevec,WilliamTFree-
GiuseppeVecchio,RosalieMartin,ArthurRoullier,AdrienKaiser,RomainRouffet, man,andJonathanTBarron.2021b.Nerfactor:Neuralfactorizationofshapeand
ValentinDeschaintre,andTamyBoubekeur.2023.ControlMat:ControlledGenera- reflectanceunderanunknownillumination.ACMTransactionsonGraphics(ToG)
tiveApproachtoMaterialCapture.arXivpreprintarXiv:2309.01700(2023). 40,6(2021),1–18.
DelioVicini,SébastienSpeierer,andWenzelJakob.2022.DifferentiableSignedDistance YoujiaZhang,TengXu,JunqingYu,YutengYe,YanqingJing,JunleWang,JingyiYu,
FunctionRendering.TransactionsonGraphics(ProceedingsofSIGGRAPH)41,4(July andWeiYang.2023.Nemf:Inversevolumerenderingwithneuralmicroflakefield.
2022),125:1–125:18. https://doi.org/10.1145/3528223.3530139 InProceedingsoftheIEEE/CVFInternationalConferenceonComputerVision.22919–
BruceWalter,StephenRMarschner,HongsongLi,andKennethETorrance.2007. 22929.
Microfacetmodelsforrefractionthroughroughsurfaces.InProceedingsofthe18th YiZheng,KaiWei,BinLiang,YingLi,andXinhuiChu.2019.Zernikelikefunctions
EurographicsconferenceonRenderingTechniques.195–206. onsphericalcap:principleandapplicationsinopticalsurfacefittingandgraphics
Mark A. Wieczorek and Matthias Meschede. 2018. SHTools: Tools for rendering.OpticsExpress27,26(Dec.2019),37180. https://doi.org/10.1364/OE.27.
Working with Spherical Harmonics. Geochemistry, Geophysics, Geosys- 037180
tems 19, 8 (2018), 2574–2592. https://doi.org/10.1029/2018GC007529 XilongZhou,MilošHašan,ValentinDeschaintre,PaulGuerrero,KalyanSunkavalli,
arXiv:https://agupubs.onlinelibrary.wiley.com/doi/pdf/10.1029/2018GC007529 andNimaKhademiKalantari.2023. ASemi-ProceduralConvolutionalMaterial
HaoqianWu,ZhipengHu,LinchengLi,YongqiangZhang,ChangjieFan,andXinYu. Prior.InComputerGraphicsForum.WileyOnlineLibrary.
2023a. NeFII:InverseRenderingforReflectanceDecompositionwithNear-Field XilongZhouandNimaKhademiKalantari.2021.AdversarialSingle-ImageSVBRDF
IndirectIllumination.InProceedingsoftheIEEE/CVFConferenceonComputerVision EstimationwithHybridTraining.ComputerGraphicsForum(2021).
andPatternRecognition.4295–4304. XilongZhouandNimaKhademiKalantari.2022.Look-AheadTrainingwithLearnedRe-
LiwenWu,RuiZhu,MustafaBYaldiz,YinhaoZhu,HongCai,JanarbekMatai,Fatih flectanceLossforSingle-ImageSVBRDFEstimation.ACMTransactionsonGraphics
Porikli,Tzu-MaoLi,ManmohanChandraker,andRaviRamamoorthi.2023b.Factor- 41,6(122022). https://doi.org/10.1145/3550454.3555495
izedInversePathTracingforEfficientandAccurateMaterial-LightingEstimation.In
,Vol.1,No.1,Article.Publicationdate:June2024.
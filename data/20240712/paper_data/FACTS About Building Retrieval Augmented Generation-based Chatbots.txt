FACTS About Building Retrieval Augmented Generation-based
Chatbots
RamaAkkiraju,AnbangXu,DeepakBora,TanYu,LuAn,VishalSeth,AadityaShukla,Pritam
Gundecha,HridhayMehta,AshwinJha,PrithviRaj,AbhinavBalasubramanian,MuraliMaram,
GuruMuthusamy,ShivakeshReddyAnnepally,SidneyKnowles,MinDu,NickBurnett,SeanJaviya,
AshokMarannan,MamtaKumari,SurbhiJha,EthanDereszenski,AnupamChakraborty,Subhash
Ranjan,AminaTerfai,AnoopSurya,TraceyMercer,VinodhKumarThanigachalam,TamarBar,
SanjanaKrishnan,JasmineJaksic,NaveAlgarici,JacobLiberman,JoeyConway,SonuNayyarand
JustinBoitano
NVIDIA
{rakkiraju,anbangx,dbora}@nvidia.com
ABSTRACT extractiveanswersatbest.Theseearlybots,builtondialogman-
Enterprisechatbots,poweredbygenerativeAI,arerapidlyemerg- agementsystemspairedwithinformationretrievalandquestion
ingasthemostexploredinitialapplicationsofthistechnologyin answering(IRQA)solutionswerefragileandlimitedincapability.
theindustry,aimedatenhancingemployeeproductivity.Retrieval WhilepreviousgenerationlanguagemodelsandGPTmodelsex-
Augmented Generation (RAG), Large Language Models (LLMs), isted,theylackedtheaccuracy,robustness,andreliabilityneeded
Langchain/Llamaindex types of LLM orchestration frameworks forbroadenterpriseuse[5].
serveaskeytechnologicalcomponentsinbuildinggenerative-AI Chat-GPT’s release, the emergence of vector databases, and
basedchatbots.However,buildingsuccessfulenterprisechatbotsis thewide-spreaduseofretrievalaugmentedgeneration(RAGs)[8]
noteasy.TheyrequiremeticulousengineeringofRAGpipelines. markedthebeginningofanewerainChatbotdomain.Now,LLMs
Thisincludesfine-tuningsemanticembeddingsandLLMs,extract- canunderstanduserintentswithsimplepromptsinnaturallan-
ingrelevantdocumentsfromvectordatabases,rephrasingqueries, guage,eliminatingtheneedforcomplexintentvarianttraining,syn-
rerankingresults,designingeffectiveprompts,honoringdocument thesizeenterprisecontentcoherently,therebyempoweringchatbots
accesscontrols,providingconciseresponses,includingpertinent withconversationalcapabilitybeyondscriptedintentrecognition.
references,safeguardingpersonalinformation,andbuildingagents WhileLLMsbringtheirgenerativecapabilitiestoconstructcoher-
toorchestratealltheseactivities.Inthispaper,wepresentaframe- ent,factual,andlogicalresponsestouserqueries,vectordatabase-
workforbuildingeffectiveRAG-basedchatbotsbasedonourfirst- poweredinformationretrieval(IR)systemsaugmentLLMsabilityto
handexperienceofbuildingthreechatbotsatNVIDIA:chatbotsfor retrievefreshcontent.ToolslikeLangChain[1]andLlamaindex[9]
ITandHRbenefits,companyfinancialearnings,andgeneralenter- facilitatechatbotconstruction,andorchestrationofcomplexwork-
prisecontent.Ourcontributionsinthispaperarethree-fold.First, flowsincludingmemory,agents,prompttemplates,andoverallflow.
weintroduceourFACTSframeworkforbuildingenterprise-grade Together,vector-searchbasedIRsystems,LLMs,andLangChain-
RAG-basedchatbotsthataddressthechallengesmentioned.FACTS likeframeworksformcorecomponentsofaRAGpipelineandare
mnemonicreferstothefivedimensionsthatRAG-basedchatbots poweringgenerativeAIchatbotsinpostChat-GPTera.
must get right - namely content freshness (F), architectures(A), AtNVIDIA,ourmainmotivationwastoimproveouremployee
costeconomicsofLLMs(C),testing(T),andsecurity(S).Second, productivitybybuildingenterprisechatbots.Ourinitialenthusiasm
wepresentfifteencontrolpointsofRAGpipelinesandtechniques quicklymetwiththerealityofaddressingnumerouschallenges.We
for optimizing chatbots’ performance at each stage. Finally, we learnedthatcraftingasuccessfulenterprisechatbot,eveninpost
presentempiricalresultsfromourenterprisedataontheaccuracy- Chat-GPTera,whilepromising,isnoteasy.Theprocessdemands
latencytradeoffsbetweenlargeLLMsvssmallLLMs.Tothebest meticulousengineeringofRAGpipelines,fine-tuningLLMs,and
ofourknowledge,thisisthefirstpaperofitskindthatprovidesa engineeringprompts,ensuringrelevancyandaccuracyofenter-
holisticviewofthefactorsaswellassolutionsforbuildingsecure priseknowledge,honoringdocumentaccesscontrolpermissions,
enterprise-gradechatbots. providingconciseresponses,includingpertinentreferences,and
safeguardingpersonalinformation.Alloftheserequirecarefulde-
1 INTRODUCTION sign,skillfulexecution,andthoroughevaluation,demandingmany
iterations.Additionally,maintaininguserengagementwhileop-
Chatbotsareincreasinglybecominganextensionofsearchtools
timizingforspeedandcost-efficiencyisessential.Throughour
incompaniesforfindingrelevantinformation.Whetherit’sHR
journey,welearnedthatgettinganenterpriseconversationalvir-
benefits,IThelp,salesqueries,orengineeringissues,enterprise
tualassistantrightisakintoachievingaperfectsymphonywhere
chatbots are now go-to productivity tools. Before the debut of
everynotecarriessignificance!
OpenAI’sChat-GPT[2]inNovember2022,companiesreliedon
Inthispaper,weshareourexperiencesandstrategiesinbuild-
internallydevelopedchatbotsbasedondialogflows.Suchbotsre-
ingeffective,secure,andcost-efficientchatbots.Weanswerthe
quiredextensivetrainingforintentunderstandingandmeticulous
followingquestionsfromapractitionerperspective:
orchestrationforresponsegenerationandyetcouldonlyprovide
4202
luJ
01
]GL.sc[
1v85870.7042:viXraTable1:Asummaryofthethreechatbotsandthecurrentstateofdevelopment.
Chatbot Domain DataSources DataTypes AccessControl SampleQueries State
NVInfo EnterpriseInternal SharePoint,GoogleDrive,Slack Docs,HTML CanIparkovernight EarlyAccess
Bot Knowledge Confluence,ServiceNow,Jiraetc. PDFs,Slides Yes inHQparkinglots? Testing
NVHelp ITHelp KnowledgeArticlesforITHelp Text,PDFs HowtoenrollinEmployee
Bot HRBenefits HRbenefitspages Docs Yes StockPurchaseplan? Production
Scout Companynews,blogs,SECfilings HTML,PDFs WhatareNVIDIArevenues
Bot FinancialEarnings Earnings-relatedinterviews Docs No forthepast3years? Production
• Whatarethekeychallengestoconsiderwhenbuildingand 3 ENSURINGFRESHNESSOFENTERPRISE
deployingenterprise-gradegenerativeAI-basedchatbots?We DATAINLLM-POWEREDCHATBOTS(F)
presentourfindingsfromtryingtodeliverfreshcontent
EnsuringthefreshnessofenterprisedatainLLM-poweredchatbots
(F)withflexiblearchitectures(A)thatarecost-efficient(C),
presentsseveralchallenges.Foundationmodels,althoughpowerful,
testedwell(T),andsecure(S)-(FACTS).
oftenfallshortastheylackdomain-specificandenterprise-specific
• How to achieve user acceptable levels of quality with RAG
knowledge.Oncetrained,thesemodelsareessentiallyfrozenintime
systemsinbuildingchatbots?Wepresentthefifteencontrol
andmayhallucinate,providingundesiredorinaccurateinformation
pointsofRAGpipelinesandtechniquesforoptimizingeach
whenusedonenterprisecontentthattheyarenottrainedon.
controlpointandtheoverallRAGpipeline.
RetrievalAugmentedGeneration(RAG)isaprocesswhererel-
evantinformationisretrievedfromvectordatabasesthroughse-
2 CASESTUDY manticmatchingandthenfedtoLLMsforresponsegeneration.
Ourcompany’scontentlandscapeincludesbothauthoritativeknowl- InaRAGpipeline,vectordatabasesandLLMscollaborativelyen-
edgeandunauthoritativecontent.Authoritativecontentencom- surethedeliveryofup-to-dateenterpriseknowledge.However,
passesIThelparticles,HRresourcesinplatformslikeServiceNow, RAGpipelineshavemanycontrolpoints,eachofwhichwhennot
and project documentation on Confluence, SharePoint, Google tunedwellcanleadtoloweraccuracy,hallucinations,andirrele-
Drive,andengineeringtoolslikeNVBugsandGitHub.Employee- vantresponsesbyChatbots.Additionally,documentaccesscontrol
generatedcontentcomplementsthesesourcesonplatformssuch permissionscomplicatethesearchandretrievalprocess,requiring
asSlackandMSTeams.Inthispaper,wepresentthreebotsthat carefulmanagementtoensuredatasecurityandrelevance.Fur-
wehavebuiltatNVIDIAusingRAGsandLLMs.Thesebotsare thermore,multi-modalcontentnecessitatestheuseofmulti-modal
brieflyintroducedbelow.Allthreebotsarebuiltonourin-house retrieverstohandlestructured,unstructured,andsemi-structured
builtgenerative-AIchatbotplatformcalledNVBotplatform.Some data,includingpresentations,diagrams,videos,andmeetingrecord-
ofthequeriesthatourbotsarecapableofansweringareshownin ings.Addressingthesechallengesiscriticalformaintainingthe
Table1. accuracyandreliabilityofenterprisechatbots.Inspiredby[3],we
identifyfifteencontrolpointsofRAGfromourcasestudiesvisual-
• NVInfoBotanswersquestionsaboutenterprisecontent
izedinFigure1.Eachcontrolpointislabeledwithanumber.Inthe
(approx.500Mdocumentsofsize>7TB),complementing
remainderofthissection,wepresentourinsightsandlearningsfor
intranet search. It manages diverse data formats and en-
addressingRAGcontrolpoints.
forcesdocumentaccesscontrols.Thetechstackincludes
LangChain,avendorvectordatabaseforretrievalandto 3.1 Learnings
handledocumentaccesscontrols,LLMmodel(multipleLLM
Infigure4,wepresentasummarydescriptionofthefifteencontrol
modelscanbeselected),andacustomweb-UI.
pointsofRAGpipelines,challengesassociatedwitheachcontrol
• NVHelpBotBotfocusesonIThelpandHRbenefits(approx.
point,andoursuggestedapproachesforoptimizingeachcontrol
2Kmulti-modaldocumentscontainingtext,tables,images,
point. Each control point is labeled as RAG-C[num] and RAG-
pdfs,andhtmlpages),usingasimilartechstacktoNVInfo
Op[num] for RAG and RAGOps flows, respectively. Below, we
botwithasmallerdatavolume.
presentafewkeylearningsandinsightstomanagethefreshenter-
• ScoutBothandlesquestionsaboutfinancialearningsfrom
prisecontent.
publicsources,managingstructuredandunstructureddata
MetadataEnrichment,Chunking,QueryRephrasal,Query
(approx.4Kmulti-modaldocumentscontainingtext,tables,
Reranking:Wenoticedthatmetadataenrichment,chunking,query
pdfs, and html pages). The tech stack includes an Open
rephrasalandqueryre-rankingstagesofRAGpipelinehavethe
sourceVectorDB,LangChain,Ragasevaluation,selectable
mostimpactonthequalityofChatbotresponses.LLMresponsegen-
LLMmodels,andacustomweb-UI.
erationqualityishighlydependentonretrievalrelevancy.Retrieval
Intheremainderofthepaper,wepresentourFACTSframe- relevancyis,inturn,highlydependentondocumentmetadataen-
workthatsummarizesthechallengesexperiencedandthelearn- richment,chunking,andqueryrephrasal.Weimplementedgrid
ingsgainedinbuildingtheaforementionedthreechatbots.Wefirst search-basedauto-MLcapabilitiestofindtherightconfigurations
startwiththechallengeofdealingwithdeliveringfreshenterprise ofchunktoken-sizes,experimentedwithvariouspromptvariations,
contentineachofthechatbots. andexploreddifferentchunkrerankingstrategiestofindoptimal
2Figure1:ControlPointsinatypicalRAGpipelinewhenbuildingChatbots.
complexqueries.Complexagentsandmulti-agentarchitecturesare
neededtohandlecomplexqueries.
ToFine-tuneLLMsornot?Akeydecisioniswhethertofine-
tuneLLMs,balancingtheuseoffoundationalmodelswithdomain-
specificcustomizations.Onesizedoesn’tfitallwhenitcomesto
LLMs.Someusecasesmayworkwellwithfoundationalmodels,
whileothersrequirecustomization.Whenconsideringcustomiza-
Figure2:Agentarchitectureforhandlingcomplexqueries tion,severaloptionsareavailable,includingpromptengineering,P-
tuning,parameter-efficientfine-tuning(PEFT),andfullfine-tuning
(FT).Fine-tuningrequiressignificantinvestmentindatalabeling,
training,andevaluations,eachofwhichcanbetime-consuming
settingsforeach.Whilewehavemadesignificantimprovements
andcostly.Automatingtestingandqualityevaluationprocessesbe-
inretrievalrelevancyandanswerqualityandaccuracy,webelieve,
comecriticaltoensuringefficiencyandaccuracywhencustomizing
westillhavemoreworktodotooptimizethefullpipeline.
LLMs.Figure3showstheaccuracyvslatencytradeoffevaluations
HybridSearch:WenoticedthatVectordatabasesarenotsogood
wehavedonecomparingOpenAI’sGPT-4modelwithsomeofthe
athandlingmatchingentities(e.g.,peoplenames,places,company
open-sourcemodelsonabout245queriesfromNVHelpbotdo-
names etc.). Using a combination of Lexical search (e.g., elastic
main.OurresultsshowthattheLlama3-70Bmodelexcelsinseveral
search)andvectorsearchprovidedbetterretrievalrelevancyand
aspectsofanswerqualitywhilemaintainingacceptablelatency.
morecoverage.Settingupaninfrastructurethatsupportshybrid
Handlingmulti-modaldata:Enterprisedataismulti-modal.Han-
searchcapabilities,whichcombinesthestrengthsofbothlexical
dlingstructured,unstructured,andmulti-modaldataiscrucialfor
andvector-basedsearches,canenhancetheaccuracyandspeedof
aversatileRAGpipeline.Fromourexperience,ifthestructureof
theretrievalprocess.
thedocumentisconsistentandknownapriori(likethosefoundin
AgenticArchitectures:Questionssuchas‘comparetherevenue
EDGARdatabasesforSECfilingsdatainfinancialearningsdomain
ofNVIDIAfromQ1throughQ4ofFY2024andprovideananalytical
thatScoutbotwashandling),implementingsection-levelsplitting,
commentaryonthekeycontributingfactorsthatledtothechanges
usingthesectiontitlesandsubheadingsandincoporatingthosein
inrevenuesduringthistime’requirecomplexagentsthatarecapa-
thecontextofchunksimprovesretrievalrelevancy.Wealsofound
bleofquerydecompositionandorchestration.Figure2showsone
solutionslikeUnstructured.io,whichspecializeinextractingand
mechanismwehadimplementedtodealwithsuchquestionsin
structuringcontentfromPDFs,helpfulinparsingandchunking
Scoutbot.Fromourexperienceofbuildingthethreebots,wehave
unstructureddocumentswithcontext.
realizedthatIRsystemsandLLMsareinsufficientforanswering
3monitoring.Additionally,theplatformsupportscitizendevelop-
ment,allowingmultipleteamstocontributetheirtestedprompts,
workflows,guardrails,andfine-tunedmodelsforcollectiveuse.
Asourecosystemofbotsexpanded,wefacedacriticalquestion:
should organizations build many domain-specific bots, a single
enterprisebot,orgowithahybridapproach?Domain-specificchat-
botsexcelintailoredenvironments,whilenterprise-widechatbots
actasgeneralists,providingacentralizedknowledgebaseforall
employees.Throughourexperience,werealizedthatthereisno
needtochooseoneovertheother.
Novelarchitecturalpatternsareemergingwhereenterprise-wide
chatbotsactas‘switchboards’,directinginquiriestospecialized
botstunedwithdomain-specificdata.Thismultibotarchitecture
allows for the concurrent development of specialized chatbots
Figure3:NVHelpanswerqualityandlatencymetricscom-
whileprovidinguserswithaunifiedinterface.OurNVBotplat-
parisonamongdifferentmodels
formsupportsthecoexistenceandorchestrationofmultiplechat-
botswithinanenterprise.Thedebateoverasinglebotormulti-
RAGOps:EffectivehealthmonitoringofRAGpipelinesisessential plespecializedbotsisongoing.Weenvisionalandscapewhere
oncetheyaredeployed.Whenanswerqualityispoor,athorough domain-specificbotscoexistwithacentralizedinformationbot,
erroranalysisisrequiredtodeterminewhethertheissueliesin supportedby’copilots’—generativeAIcapabilitiesintegratedinto
retrievalrelevancyorLLMresponsegeneration.Todebugretrieval workplaceenvironmentslikeprogrammingIDEsandcollabora-
relevancy,developersneeddetailedinformationonwhichchunks tiontools.AtNVIDIA,we’reactivelyexploringallthreechatbot
were stored in vector databases withtheir associated metadata, variations—domain-specific,enterprise-wide,andcopilotasgenera-
howquerieswererephrased,whichchunkswereretrieved,and tiveAIreshapesworkplaceefficiencyandinformationaccessibility.
howthosechunkswereranked.Similarly,ifanLLMresponseis
incorrect,itiscrucialtoreviewthefinalpromptusedforanswer
5 COSTECONOMICSOFCHATBOT
generation.Forissueswithcitations,developersmusttraceback
DEPLOYMENTS(C)
totheoriginaldocumentlinksandtheircorrespondingchunks.
RAGOps/LLMOpsandevaluationframeworks,suchasRagas,are UnderstandingthecosteconomicsofgenerativeAI-basedchatbots
critical for providing the necessary automation to enable rapid involvesseveralcriticalfactors.Thehighcostsofmajorandcom-
iterationduringaccuracyimprovementcyclesinRAGpipelines. mercialLLMscanbeunsustainable,withexpensesaddingupsig-
MoredetailsoneachcontrolpointarepresentedinFigure4.In nificantlyacrossmultipleusecases.Additionally,unseenexpenses
summary,whilepromising,implementingRAGsystemsforchat- oftenaccumulateasteamstestvariousLLMstomeetspecificneeds.
botsdemandsmeticulousplanningandcontinuousevaluationto Moreover, when using commercial LLM vendor APIs, securing
ensuresecureandaccuratedataretrieval. sensitiveenterprisedatarequiresguardrailstodetectandprevent
sensitivedataleakage,aswellasgatewaysforauditandlegally
4 BUILDINGFLEXIBLEARCHITECTURESFOR
permittedlearning.Therearealsocostversuslatencytrade-offsto
GENERATIVEAICHATBOTS(A)
consider,aslargeLLMswithlongcontextlengthstypicallyhave
Keeping up with rapid progress in AI is like navigating a fast- slowerresponsetimes,impactingoverallefficiency.
movingriver.Everyaspect,fromvectordatabasesandembedding BiggerVs.SmallerModels:Larger,commercialLLMs,smaller
modelstoLLMs,agenticarchitectures,low-code/no-codeplatforms, opensourceLLMsareincreasinglybecomingviableformanyuse
RAGevaluationframeworks,andpromptingtechniques,isevolving cases, thereby offering cost effective alternatives to companies.
rapidly.Concurrently,departmentswithincompaniesareexploring As opensource models are catching up with larger, commercial
generativeAIbybuildingtheirownchatbotsandAIcopilots. models,theyareincreasinglyofferingclose-comparableaccuracy,
Inthisdynamicenvironment,buildingcommon,flexible,and asdemonstratedinourNVHelpbotempericalevaluationinFigure3,
adaptive platforms are crucial. At NVIDIA, our chatbot ecosys- andgenerallyhavebetterlatencyperformancecomparedtolarger
temhasgrownsignificantly,reflectingatrendlikelyseeninmany models.Additionally,GPUoptimizationofinferencemodelscan
companies.Frombuildingthreeinitialchatbots,werealizedthe furtherspeedupprocessingtimes.Open-sourcemodelsoptimized
importanceofacommonplatformtoavoidduplicatedeffortsinse- withNVIDIA’sTensorRT-LLMinferencelibraries,forinstance,
curity,guardrails,authentication,prompts,userinterfaces,feedback haveshownfasterperformancethannon-optimizedmodels.These
mechanisms,usagereporting,monitoring,andevaluations. strategieshelpbalancetheneedforcost-efficiencywithmaintaining
Toaddressthis,wedevelopedtheNVBotplatform(Figure7),a highperformanceandsecuritystandards.
modularplatformwithapluggablearchitecture.Itallowsdevelop- LLMGateway:IfyoumustuseavendorLLMAPI,itisbetterto
erstoselectLLMs,vectordatabases,embeddingmodels,agents, implementaninternalcompanyLLMGatewayforaudit,subscrip-
andRAGevaluationframeworksthatbestsuittheirusecase.It tionandcostmanagementacrossthecompany.Implementingan
alsoprovidescommoncomponentsforessentialfeatureslikesecu- internalcompanyLLMGatewaycanstreamlineLLMusage,sub-
rity,guardrails,authentication,authorization,userexperience,and scriptions,anddatatrackingforsecurityaudits.Thiscentralhub
4Figure4:RAGcontrolpoints,challenges,andremediations
Figure5:ScoutBot:Multi-partquery
Figure6:NVHelpBot:AnsweringquestionsonHRbenefits
simplifiesmanagementandensuresefficientresourceallocation.
AtNVIDIAIT,wehaveimplementedanLLMGatewaythatlogs
theinboundandoutboundpayloadsforauditpurposesandthis Gateway.It’scrucialtomeasureandmonitorROIbykeepingtrack
dataisguardedwithaccesscontrolpermissions.OurLLMGateway ofLLMsubscriptionsandcosts,aswellasassessingGen-AIfeature
helpsmanagethesubscriptionsandcostsofLLMAPIinvocations. usageandproductivityenhancements.Ensuringthesecurityof
Insummary,developingahybridandbalancedLLMstrategy sensitiveenterprisedataincloud-basedLLMusagerequiresimple-
isessentialformanagingcostsandenablinginnovation.Thisin- mentingguardrailstopreventdataleakageandbuildinganLLM
volvesusingsmallerandcustomizedLLMstomanageexpenses Gatewayforauditsandlegallypermittedlearning.Finally,beaware
whileallowingresponsibleexplorationwithlargeLLMsviaanLLM ofthetrade-offsbetweencost,accuracy,andlatency,customizing
5Figure7:ArchitectureofNVBotplatformuponwhichmultiplechatbotsarebeingbuilt.
smallerLLMstomatchtheaccuracyoflargermodelswhilenot- RLHFyet.Havingtoolstomakethisautomatediscriticalto
ingthatlargeLLMswithlongcontextlengthstendtohavelonger pos-productionlifecyclemanagementofthesechatbots.
responsetime.
6 TESTINGRAG-BASEDCHATBOTS(T) 6.1 Learnings
TestinggenerativeAIsolutionscanbealengthyprocessdueto PlanforLongTestCycles:EffectivetestingofRAG-basedchat-
theneedforhumanresponsevalidation.LLMsareincreasingly botsrequiresanticipationoflengthytestcycles.Beginbyfocusing
beingemployedusing‘LLM-as-a-judge’approach.However,itis onautomatingtestsandenhancingaccuracyassessmentstostream-
advisabletousecautionwhenusingLLMsashumanproxy,asusing linethisessentialphase.
LLMsasjudgescanleadtoself-fulfillingprophecytypeofscenarios BuildRepresentativeGroundTruthDatasets:Itiscrucialto
reinforcingtheirinherentbiasesinevaluationsaswell. constructcomprehensivegroundtruthdatasetsthatreflectfullspec-
trumoftargetedsolutionstrengths.Thisensuresthatthechatbot
• SecurityTesting:Automatingsecuritytestingiscritical
istestedagainstscenariosthatitwillencounterinactualuse.
formaintainingdevelopmentvelocitywithoutcompromis-
Automate Evaluations: While leveraging LLMs as evaluators
ingsafety.Astrongsecurityframeworkandregressiontest
canprovidescalabletestingoptions,rememberthatthequalityof
datasetsensurethatthechatbotremainsresilienttopotential
humanevaluationsisunmatched.Automatedtoolsshouldbeused
threats.WearecollaboratingwithourinternalREDteamsin
wherefeasibletosupplementbutnotreplacehumanoversight.
securitytoprepareasetofdatasetsthatcanbetestedwith
IncorporateHumanFeedbackandContinuousLearning:Es-
eachmajoriterationofthechatbot.
tablishmechanismsthatallowforhumanfeedbackandsystematic
• Prompt Change Testing: Generative AI models can be
erroranalysis.Prioritizeiterativeimprovementsbasedonthisfeed-
highlysensitivetopromptchanges.Tomaintainaccuracy,
backtocontinuallyrefinechatbotperformanceandadaptability.
fullregressiontestingisneededwitheachpromptalteration.
7 SECURINGRAG-BASEDCHATBOTS(S)
• FeedbackLoops:Incorporatingfeedbackgatheredandthe
RLHFcycleispivotalforcontinuousimprovement.Itallows BuildingtrustisparamountwhendeployinggenerativeAIchatbots.
LLMmodelstorefinebothoursolutionsandLanguageMod- Tomitigaterisks,guardrailsforhallucinations,toxicity,fairness,
elsovertime,ensuringthatthechatbotbecomesincreasingly transparency,andsecurityarecritical.Strongfoundationalmodels
proficient.However,ifthechosenfoundationalmodelsdon’t areincreasinglygettingbetterattheseguardrails.However,there
offercustomization,thenitbecomesdifficulttoalignthe arestillmanypossibilitiesofjailbreaks,adversarialattacks,and
modelstohumanfeedback.Ifthefeedbackissignificantand othersecurityissues.Apartfromthesesecurityrisks,generativeAI-
comesinmanyareas,thenmodelcustomizationmaybean basedchatbotsaresusceptibletoderivativerisks(explainedbelow).
option.Asofnow,wehavebegungatheringuserfeedback Sinceourbotsareallinternalenterprisechatbots,ourfocushas
buthaven’tbuiltourcontinuouslearningpipelinesusing beenmoreontheenterprisecontentsecurityandguardrailingfor
6sensitivedata.Belowwesummarizeourlearningsandinsightsfor forcomplexqueryhandling,strategiesfortestingandevaluating
securingRAG-basedchatbotsbasedonourexperience.Addressing subjectivequeryresponses,andraisedawarenessfordealingwith
these challenges is imperative to maintaining the integrity and documentACLsandsecurity.Furthermore,wepresentareference
securityofRAG-basedchatbotswithincorporateenvironments. architectureforaflexiblegenerative-AIbasedChatbotplatform.
ChipNemo[10]presentsevidenceforusingadomainadapted
7.1 Learnings languagemodelforimprovingRAG’sperformanceondomainspe-
cificquestions.Theyfinetunedthee5-small-unsupervisedmodel
EnterpriseContentAccessControl:Enterprisedocumentsare
with3,000domainspecificauto-generatedsamples.Wetriedfine-
protectedbyaccesscontrols,requiringRAG-basedchatbotstocom-
tuninge5-largeembeddingsmodelinScoutBot.Ourresultsdidnot
plywithAccessControlLists(ACLs)duringresponsegeneration.
demonstratesignificantimprovements.Wearepresentlycollecting
Toensurethiscompliance,wespecificallyselectedanIRproduct
highqualityhuman-annotateddatatorepeattheexperiments.This
knownforitscapabilitytohonorthesedocumentACLseffectively.
couldbeanimportantdirectiontoexploreinthefutureforour
DerivativeRiskswithGenerativeAI:Chatbotsmightgener-
work.AnotherinterestingtechniquewaspresentedbySettyet.
ateresponsesthatlackcontextfromtheiroriginaldatasources,
al.[15],inimprovingRAGperformanceusingHypotheticalDocu-
potentiallyleadingtomisinterpretations.Additionally,enhanced
mentEmbeddings(HYDE)technique.HyDEusesanLLMtogener-
searchmethodscouldinadvertentlyelevatetheriskofexposing
ateatheoreticaldocumentwhenrespondingtoaqueryandthen
sensitivedataifenterprisecontentisinappropriatelysecured.As
doesthesimilaritysearchwithboththeoriginalquestionandhy-
partofourNVInfobotjourney,weimplementedsensitivedata
potheticalanswer.Thisisapromisingapproachbutmightmake
guardrailsinadditiontoleveragingsensitivedatafilteringandclas-
thearchitecturecomplex.
sificationcapabilitiesprovidedbythevectorsearchsolutionwe
ActiveRetrievalaugmentedgeneration(FLARE)[7]iteratively
usedtoautomaticallyfilteroutsensitivedataduringtheretrieval.
synthesizesahypotheticalnextsentence.Ifthegeneratedsentence
DataGovernanceandContentSecurity:Efficientknowledgeac-
containslow-probabilitytokens,FLAREwouldusethesentenceas
cesscanincreasesensitivedataleakagerisks.Thus,it’sessentialto
thenewqueryforretrievalandregeneratethesentence.Mialonet
prioritizedatagovernancebeforedeploymenttosafeguardagainst
al.[12]reviewsworksforadvancedaugmentedgenerationmethods
unauthorizedaccessanddatabreaches.AtNVIDIA,weembarked
inlanguagemodel.Self-refine[11]buildsanagenttoimprovethe
onanenterprisecontentsecurityinitiativefordocumentsensitivity
initialanswerofRAGthroughiterativefeedbackandrefinement.
classificationandexclusionofsensitivecontentfromchatbots.
ReAct[16]Agentiswidelyusedforhandlingthecomplexqueries
EnterpriseGuardrailing:Implementingguardrailsthataligngen-
inarecursivemanner.OntheRAGevaluationfront,RAGAS[4]
erativeAIresponseswithspecificenterprisepoliciesandrulesis
andARES[14]utilizeLLMsasjudgesandbuildautomaticRAG
essential. These guardrails help mitigate risks by ensuring that
benchmarktoevaluatetheRAGsystem.Zhuetal.[17]overview
Chatbot-generatedcontentadherestoestablishednormsandethi-
theintensiveusagesofLLMinaRAGpipelineincludingretriever,
calguidelines,preventingpotentiallegalandreputationaldamage.
datageneration,rewriter,andreader.Webelievethatourwork
InNVInfobot,weimplementedmanyguardrailsinLLMprompts
providesauniqueperspectiveonbuildingsecureenterprise-grade
initially. However, later realized that not all LLMs follow these
chatbotsviaourFACTSframework.
promptsconsistently.Therefore,weimplementedtheseguardrails
duringpreandpostprocessingofqueriesandresponsesrespec-
tivelyusingNemoGuardrails[13]. 9 CONCLUSIONS
Inthispaper,wepresentedourapproachtodevelopingeffective
8 RELATEDWORK
RAG-basedchatbots,highlightingourexperiencesofbuildingthree
OurworkcanbecomparedwithRAGpapersonvarioustopics chatbotsatNVIDIA.WeoutlinedourFACTSframework,empha-
dealingwithRAGqualityalongalltheFACTSdimensionswepre- sizingtheimportanceofcontentfreshness(F),architecture(A),
sented(freshness,architecture,costs,testingandsecurity).Due LLMcost(C)management,planningfortesting(T),andsecurity(S)
tolackofspace,wecontrastourworkwithselectiveworks.Bar- increatingrobust,secure,andenterprise-gradechatbots.Wealso
nettet.al.[3]presentedsevenfailurepointswhenengineeringRAG identifiedandelaboratedonfifteencriticalcontrolpointswithin
systems.Intheirwork,theyhighlightthechallengesofgettingre- RAG pipelines, providing strategies to enhance chatbot perfor-
trievalaugmentedgenerationrightbypresentingtheirfindings manceateachstage.Furthermore,ourempiricalanalysisreveals
fromhavingbuiltthreechatbots.WenqiGlantz[6]elaborated12 thetrade-offsbetweenaccuracyandlatencywhencomparinglarge
RAGpainpointsandpresentedsolutions.Weexperiencedsimilar andsmallLLMs.Thispaperoffersaholisticperspectiveonthe
challengesfirst-handwhenbuildingourchatbots.However,none essentialfactorsandpracticalsolutionsforbuildingsecureand
oftheseworksdiscussthechallengeswithcomplexqueries,testing, efficiententerprise-gradechatbots,makingauniquecontribution
dealingwithdocumentsecurity,andtheneedforflexiblearchi- tothefield.Moreworkisneededinseveralareastobuildeffective
tectures.Inourwork,wenotonlybuildonfailure/painpointsof RAG-basedchatbots.Thisincludesdevelopingagenticarchitectures
RAGsasmentionedabove,butalsopresentour15controlpointsin forhandlingcomplex,multi-part,andanalyticalqueries;efficiently
RAGpipelinesandofferspecificsolutionsforeachstage.Also,we summarizinglargevolumesoffrequentlyupdatedenterprisedata;
extendourinsightsandpresentpracticaltechniquesforhandling incorporatingauto-MLcapabilitiestooptimizevariousRAGcontrol
complexqueries,testing,andsecurity.Wepresentareferencear- pointsautomatically;andcreatingmorerobustevaluationframe-
chitectureforoneoftheimplementationsofagenticarchitectures worksforassessingsubjectiveresponsesandconversations.
7REFERENCES
Anand,H.,Banerjee,S.,Bayraktaroglu,I.,etal.Chipnemo:Domain-adapted
[1] Langchain.https://github.com/langchain-ai. llmsforchipdesign.arXivpreprintarXiv:2311.00176(2023).
[2] Achiam,J.,Adler,S.,Agarwal,S.,Ahmad,L.,Akkaya,I.,Aleman,F.L., [11] Madaan,A.,Tandon,N.,Gupta,P.,Hallinan,S.,Gao,L.,Wiegreffe,S.,Alon,
Almeida,D.,Altenschmidt,J.,Altman,S.,Anadkat,S.,etal.Gpt-4technical U.,Dziri,N.,Prabhumoye,S.,Yang,Y.,etal.Self-refine:Iterativerefinement
report.arXivpreprintarXiv:2303.08774(2023). withself-feedback.AdvancesinNeuralInformationProcessingSystems36(2024).
[3] Barnett,S.,Kurniawan,S.,Thudumu,S.,Brannelly,Z.,andAbdelrazek,M. [12] Mialon,G.,Dessì,R.,Lomeli,M.,Nalmpantis,C.,Pasunuru,R.,Raileanu,
Sevenfailurepointswhenengineeringaretrievalaugmentedgenerationsystem. R.,Rozière,B.,Schick,T.,Dwivedi-Yu,J.,Celikyilmaz,A.,etal.Augmented
arXivpreprintarXiv:2401.05856(2024). languagemodels:asurvey.arXivpreprintarXiv:2302.07842(2023).
[4] Es,S.,James,J.,Espinosa-Anke,L.,andSchockaert,S. Ragas:Automated [13] Rebedea,T.,Dinu,R.,Sreedhar,M.,Parisien,C.,andCohen,J. Nemo
evaluationofretrievalaugmentedgeneration.arXivpreprintarXiv:2309.15217 guardrails:Atoolkitforcontrollableandsafellmapplicationswithprogrammable
(2023). rails.arXivpreprintarXiv:2310.10501(2023).
[5] Galitsky,B.Developingenterprisechatbots.Springer,2019. [14] Saad-Falcon,J.,Khattab,O.,Potts,C.,andZaharia,M.Ares:Anautomated
[6] Glantz,W.12ragpainpointsandproposedsolutions. evaluationframeworkforretrieval-augmentedgenerationsystems.arXivpreprint
[7] Jiang,Z.,Xu,F.F.,Gao,L.,Sun,Z.,Liu,Q.,Dwivedi-Yu,J.,Yang,Y.,Callan, arXiv:2311.09476(2023).
J.,andNeubig,G. Activeretrievalaugmentedgeneration. arXivpreprint [15] Setty,S.,Jijo,K.,Chung,E.,andVidra,N. Improvingretrievalforrag
arXiv:2305.06983(2023). based question answering models on financial documents. arXiv preprint
[8] Lewis,P.,Perez,E.,Piktus,A.,Petroni,F.,Karpukhin,V.,Goyal,N.,Küt- arXiv:2404.07221(2024).
tler,H.,Lewis,M.,Yih,W.-t.,Rocktäschel,T.,etal.Retrieval-augmented [16] Yao,S.,Zhao,J.,Yu,D.,Du,N.,Shafran,I.,Narasimhan,K.,andCao,Y.
generationforknowledge-intensivenlptasks.AdvancesinNeuralInformation React:Synergizingreasoningandactinginlanguagemodels. arXivpreprint
ProcessingSystems33(2020),9459–9474. arXiv:2210.03629(2022).
[9] Liu,J.LlamaIndex.ℎ𝑡𝑡𝑝𝑠://𝑔𝑖𝑡ℎ𝑢𝑏.𝑐𝑜𝑚/𝑗𝑒𝑟𝑟𝑦𝑗𝑙𝑖𝑢/𝑙𝑙𝑎𝑚𝑎𝑖𝑛𝑑𝑒𝑥(2022). [17] Zhu,Y.,Yuan,H.,Wang,S.,Liu,J.,Liu,W.,Deng,C.,Dou,Z.,andWen,J.-
[10] Liu,M.,Ene,T.-D.,Kirby,R.,Cheng,C.,Pinckney,N.,Liang,R.,Alben,J., R. Largelanguagemodelsforinformationretrieval:Asurvey. arXivpreprint
arXiv:2308.07107(2023).
8
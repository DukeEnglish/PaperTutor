Transforming In-Vehicle Network Intrusion Detection: VAE-based
Knowledge Distillation Meets Explainable AI
MuhammetAnilYagiz PedramMohajerAnsari MertD.Pesé PolatGoktas
anill.yagiz@gmail.com pmohaje@clemson.edu mpese@clemson.edu polat.goktas@ucd.ie
KırıkkaleUniversity ClemsonUniversity ClemsonUniversity UniversityCollegeDublin
Kırıkkale,Turkey Clemson,SC,USA Clemson,SC,USA Dublin,Ireland
Abstract ACMReferenceFormat:
Intheevolvinglandscapeofautonomousvehicles,ensuringro- MuhammetAnilYagiz,PedramMohajerAnsari,MertD.Pesé,andPolat
Goktas.2024.TransformingIn-VehicleNetworkIntrusionDetection:VAE-
bustin-vehiclenetwork(IVN)securityisparamount.Thispaper
basedKnowledgeDistillationMeetsExplainableAI.InProceedingsofthe
introducesanadvancedintrusiondetectionsystem(IDS)calledKD-
SixthWorkshoponCPSIoTSecurityandPrivacy(CPSIoTSec’24),October14–
XVAEthatusesaVariationalAutoencoder(VAE)-basedknowledge
18,2024,SaltLakeCity,UT,USA.ACM,NewYork,NY,USA,11pages.
distillationapproachtoenhancebothperformanceandefficiency.
https://doi.org/10.1145/3690134.3694819
Ourmodelsignificantlyreducescomplexity,operatingwithjust
1669 parameters and achieving an inference time of 0.3 ms per
batch,makingithighlysuitableforresource-constrainedautomo-
tiveenvironments.EvaluationsintheHCRLCar-Hackingdataset 1 Introduction
demonstrateexceptionalcapabilities,attainingperfectscores(Re-
Theemergenceofautonomousvehicles(AVs)andthewidespread
call,Precision,F1Scoreof100%,andFNRof0%)undermultiple
integrationofconnectedcarshavesignificantlytransformedthe
attack types, including DoS, Fuzzing, Gear Spoofing, and RPM
landscapeofmoderntransportation,offeringunprecedentedlevels
Spoofing. Comparative analysis on the CICIoV2024 dataset fur-
ofsafety,efficiency,andconvenience.Centraltothesetechnologi-
therunderscoresitssuperiorityovertraditionalmachinelearning
caladvancementsisthein-vehiclenetwork(IVN),whichenables
models,achievingperfectdetectionmetrics.Wefurthermoreinte-
seamlesscommunicationamongvariouselectroniccontrolunits
grateExplainableAI(XAI)techniquestoensuretransparencyin
(ECUs)thatgovernessentialvehicularfunctions,includingadaptive
themodel’sdecisions.TheVAEcompressestheoriginalfeature
cruisecontrol,lane-keepingassistance,andreal-timenavigation
spaceintoalatentspace,onwhichthedistilledmodelistrained.
[33,34].However,theincreasingconnectivityofIVNsintroduces
SHAP(SHapleyAdditiveexPlanations)valuesprovideinsightsinto
significantcybervulnerabilities,primarilyduetothelackofrobust
theimportanceofeachlatentdimension,mappedbacktoorigi-
securitymeasuressuchasauthenticationandencryption.These
nalfeaturesforintuitiveunderstanding.Ourpaperadvancesthe
weaknessescanbeexploitedbymaliciousactorstocarryoutcy-
fieldbyintegratingstate-of-the-arttechniques,addressingcritical
berattacks,compromisingpassengersafetyandunderminingthe
challengesinthe deploymentofefficient,trustworthy,andreli-
operationalintegrityofvehicles[17].
ableIDSesforautonomousvehicles,ensuringenhancedprotection
IntrusionDetectionSystems(IDS)areessentialforenhancingthe
againstemergingcyberthreats.
securityofIVNs.WhiletraditionalIDSapproachesaresomewhat
effective,theyoftenfailtoaddressthesophisticatedandevolving
CCSConcepts natureofcyberthreatstargetingIVNs.Thedynamicnatureofthese
•Securityandprivacy→Artificialimmunesystems;Intru- attacksrequiresmoreadvancedandflexiblesolutions.Recentad-
siondetectionsystems;•Computingmethodologies→Arti- vancesinartificialintelligence(AI),particularlyinmachinelearning
ficialintelligence. (ML)anddeeplearning(DL),offerpromisingsolutionstoimprove
IVNsecurity.Thesetechnologiescananalyzevastamountsofnet-
worktrafficdata,learnintricatepatternsofnormalandanomalous
Keywords
behaviors,anddetectpreviouslyunknownattackvectorsinreal
In-vehiclenetwork,knowledgedistillation,securityandprivacy, time[16,32].
VAE,XAI However,deployingMLandDL-basedIDSinIVNspresentssev-
eralchallenges.Asignificantissueistheblack-boxnatureofthese
models,whichobscurestheirdecision-makingprocessesanddimin-
ishesthetrustofstakeholdersintheirreliability.Thislackoftrans-
Permissiontomakedigitalorhardcopiesofallorpartofthisworkforpersonalor
parency,alongwiththeresource-intensivenatureofthesemodels,
classroomuseisgrantedwithoutfeeprovidedthatcopiesarenotmadeordistributed
forprofitorcommercialadvantageandthatcopiesbearthisnoticeandthefullcitation isparticularlyconcerningintheautomotiveindustry,wheresafety
onthefirstpage.Copyrightsforcomponentsofthisworkownedbyothersthanthe andsustainablecomputingareparamount[4,7,9,24].Existing
author(s)mustbehonored.Abstractingwithcreditispermitted.Tocopyotherwise,or
studiesrevealsignificantgapsincurrentIDSsolutionsforIVNs,
republish,topostonserversortoredistributetolists,requirespriorspecificpermission
and/orafee.Requestpermissionsfrompermissions@acm.org. particularlyinprovidingclearexplanationsfordetections,whichis
CPSIoTSec’24,October14–18,2024,SaltLakeCity,UT,USA crucialforgainingstakeholdertrustandensuringregulatorycom-
©2024Copyrightheldbytheowner/author(s).PublicationrightslicensedtoACM.
pliance[3,7].Furthermore,thehighcomputationaldemandand
ACMISBN979-8-4007-1244-9/24/10
https://doi.org/10.1145/3690134.3694819 complexityoftrainingthesemodelsposepracticalchallengesforCPSIoTSec’24,October14–18,2024,SaltLakeCity,UT,USA MuhammetAnilYagiz,PedramMohajerAnsari,MertD.Pesé,&PolatGoktas
real-timedeploymentinvehicles[17,33].Theselimitationsunder- underscoringitsexceptionalcapabilityinaccuratelyidentifying
scoretheneedforinnovativesolutionsthatbalanceperformance, andmitigatingcyberthreatswithinin-vehiclenetworks.
explainability,andefficiency. Notably,whilethereexistsanotherproposedmodelthatachieves
Inthiscontext,ourpaperintroducesanadvancedIDSforthe perfectscoresacrossallclassesontheHCRLCarHackingDataset,
ControllerAreaNetwork(CAN)—themostprominentIVNproto- KD-XVAEframeworkdistinguishesitselfthroughitssuperiorpa-
col—utilizingavariationalautoencoder(VAE)-basedknowledge rameterefficiencyandreducedinferencetimeperbatch,makingit
distillationapproachwithanemphasisonsustainableandexplain- amorepracticalandefficientsolutionforreal-worldapplications.
ableAI.Thismethodnotonlyimprovestheefficiencyandaccuracy Therestofthepaperisstructuredasfollows.Section2provides
ofanomalydetectionbutalsoensurescomputationalefficiency, acomprehensivereviewofrelatedwork.Section3describesthe
makingitsuitablefordeploymentinresource-constrainedenviron- proposedIDSframework,focusingontheintegrationofVAE-based
ments.Theprimarycontributionsofthispaperareasfollows: knowledgedistillationandsustainableAIpractices.Thissection
alsocoverstheexperimentalsetup,includingthedatasetsandper-
• ImprovingAnomalyDetectioninIVNSecuritywith formancemetricsusedfortheevaluation.Section4presentsand
VAE-basedKnowledgeDistillation:ByemployingVAEs comparestheresultsoftheablationstudyoftheproposedsystem
andknowledgedistillationtechniques,weenhancethedetec- withotherstate-of-the-artmethods.Section5discussesshortcom-
tioncapabilitiesoftheIDS,makingitmoreeffectiveiniden- ingsofthisworkandprovidessuggestionsforfutureworkbefore
tifyingsubtleandcomplexanomalieswithinIVNs[33,34]. weconcludesthepaperinSection6.
• SustainableComputing(Time&DataEfficient):Our
approachoptimizesthecomputationalresourcesrequired 2 RelatedWork
fortraininganddeployingIDSmodels,makingitfeasibleto Thissectionprovidesacomprehensivereviewoftheexistinglit-
implementinresource-constrainedenvironmentstypicalof eratureonsecuritymechanismsdesignedtodetectvulnerabilities
autonomousvehicles[3,17]. andaddresssecurityissueswithinautonomousvehicleIVNs.Ad-
• EnhancingReliabilityofIVNSecurityModels:Byin- ditionally,itexploresAI-basedapproachesforenhancingsecurity
corporating sustainable AI methods, we ensure that the withinthesenetworks.
IDSmodelsarenotonlyaccuratebutalsoefficient,thereby
increasingthetrustandreliabilityofthesecuritysystem 2.1 IntrusionDetectionSystemsinIVNs
amongstakeholders[7,9].
IntrusionDetectionSystems(IDSes)areessentialforsecuringnet-
• OptimalModelTrainingStrategiesforIVNSecurity
works such as the Controller Area Network (CAN) in vehicles,
usingKnowledgeDistillationinDeepLearningMod-
whichinherentlylackrobustsecurityfeatures.Variousstrategies
els:Ourstudyexploresoptimalstrategiesfortrainingdeep
havebeendevelopedfordetectingintrusionswithinCANbuses,
learningmodelsusingknowledgedistillation,ensuringthat
employingdifferentdataanalysisandMLtechniques.
theIDSmodelsarenotonlyaccuratebutalsointerpretable
Rajapakshaetal.[27]categorizedIDSapproachesforin-vehicle
andefficient[1,4].
networksintofourprimarytypes:
• ExplainabilityofIVNSecurityModels:Byintegrating
• Fingerprint-based(buslevel)
ExplainableAI(XAI)methodologies,specificallySHapley
• Parameter-monitoring-based(messagelevel)
AdditiveexPlanations(SHAP),weprovideacomprehensive
• Information-theoretic-based(data-flowlevel)
understanding of the model’s decision-making processes.
• Machine-learning-based(functionallevel)
Thistransparencyenhancesstakeholdertrustandallowsfor
actionableinsightsintothesecurityofIVNsystems,reinforc- Amongthese,theMLandDLmethodshaveshownsignificantef-
ingtherobustnessandreliabilityofourproposedframework ficacyinidentifyingnovelattacksonCANbusesthroughacompre-
[18]. hensivedataanalysis.Sunetal.[30]furtherclassifiedintrusionde-
tectionalgorithmsintothreegroups:semantic-based,data-domain-
ThispaperaimstoadvanceIVNsecuritybydevelopingarobust, based,andperiodicity-basedapproaches.Semantic-basedmethods
efficient,andsustainableIDSframeworkthataddressestheunique analyzethesemanticsofCANmessages.Forinstance,Zhaoetal.
challenges of modern autonomous vehicles. The integration of [35]utilizedanArtificialNeuralNetwork(ANN)toenhanceIDS
knowledgedistillationintotheIDSenhancesitsperformance,pro- precision.Datadomain-basedmethods,suchasthoseproposed
vidingacomprehensivesolutionforsecuringin-vehiclenetworks byQinetal.[26],predictCANmessagesusinglong-short-term
againstemergingcyberthreats. memory(LSTM)networks.Periodicity-basedmethods,exemplified
OurproposedIDSframework,KD-XVAE,demonstratesremark- bytheLSTM-basedapproachfromHossainetal.[12],leveragethe
ableperformanceacrosstwodistinctdatasets.OntheHCRLCar temporalpatternsofCANmessagestodetectanomalies,achieving
HackingDataset,ourframeworkattainsanF1score,precision,re- highaccuracyrates.
call,andaccuracyof1.0,accompaniedbyalowinferencetimeof
2.2 IntegrationofAdvancedTechniques
0.3millisecondsperbatch.Similarly,ontheCIC-IOV2024dataset,
KD-XVAEachievesperfectscoresof1.0inF1score,precision,recall, Recentstudieshaveintegratedspatialandtemporalfeaturestoen-
andaccuracy.Theseoutcomesrepresentasignificantadvancement hancedetectioncapabilities.Loetal.[17]combinedConvolutional
overcurrentmethodologies.Furthermore,KD-XVAEsurpassestra- NeuralNetworks(CNN)andLSTMstosuccessfullyidentifysuspi-
ditional machine learning models on the CIC-IOV2024 dataset, ciousactivitiesontheCANbus.Despitetheireffectiveness,theseTransformingIn-VehicleNetworkIntrusionDetection:VAE-basedKnowledgeDistillationMeetsExplainableAI CPSIoTSec’24,October14–18,2024,SaltLakeCity,UT,USA
modelshavelimitations,suchassusceptibilitytoreplayattacks. Buildingonthesecutting-edgemethodologies,ourstudyaimsto
TransferlearninghasalsobeenappliedtoIDSforIVNs.Yanget developanadvancedIDSforvehicleCANbuses,usingtransformer
al.[34]demonstratedsignificantperformanceimprovementsusing architecture.Thisapproachtakesadvantageofthelatestadvances
transferlearninginsmalldatasets.Khatrietal.[14]showedthat inmachinelearning,deeplearning,andsustainableAItocreatea
combiningtransferlearningwithCNN-LSTMcouldsignificantly robustandefficientIDScapableofaddressingtheuniquechallenges
enhanceperformancethroughone-shotlearning.Toaddressthe posedbyIVNsinautonomousvehicles.
limitationsofRecurrentNeuralNetworks(RNNs),suchasvanish-
ingandexplodinggradientissues,attentionmechanismshavebeen 3 Methodology
introduced.Similarly,Sunetal.[30]combinedCNN-LSTMwith
3.1 ThreatModel
attentiontoimprovemodelrobustness.
Understandingthespecificcharacteristicsandpotentialimpacts
oftheseattacksisessentialtodevelopeffectiveIDS.Eachattack
Self-AttentionMechanismsandTransformerArchitectures.
typeexhibitsuniquepatternsandbehaviorsthatcanbeutilizedto
ToovercomethechallengesassociatedwithRNNs,recentresearch
createrobustdetectionalgorithms.Byincorporatingcomprehen-
hasexploredself-attentionmechanisms.Nametal.[21]utilized
sivedatasetssuchastheHCRLCar-Hacking[29]andCIC-IoV[22]
bidirectionalGenerativePre-trainedTransformer(GPT)forbinary
datasets(seeSection4.1fordetaileddescription),researcherscan
classification in vehicle IDS, while Nguyen et al. [23] proposed
simulateadiverserangeofattackscenariosandassesstheresilience
atransformer-basedapproach,outperformingtraditionalandDL
ofIDSagainstadvancedcyberthreats.Inthefollowing,weprovide
modelsinbothefficiencyandprecision.Guptaetal.[8]further
detaileddescriptionsoftheattacktypesincludedinthesepopular
improvedtransformermodelsbyincorporatingCNNintheembed-
datasetstoelucidatetheircharacteristicsandpotentialimpactson
dinglayer,improvingpredictionperformance.
vehiclesecurity.
MachineLearningforIVNSecurity. Qayyumetal.[25]pro-
DenialofService(DoS). ADoSattackaimstooverwhelmthe
videdacomprehensivereviewofthechallengesassociatedwith
vehicle’sCANbuswithanexcessivenumberofmessages.This
thedeploymentofMLinvehicularnetworks,particularlyfocus-
floodoftrafficcaneffectivelyblocklegitimatemessagesfrombeing
ingonsecurityconcernsindevelopingDLpipelinesforconnected
transmitted,disruptingnormalvehicleoperations.InaDoSsce-
andautonomousvehicles.TalpurandGurusamy[31]evaluatedthe
nario,thevehicle’sECUsmaybeunabletocommunicatecritical
adoptionofDLforautomotivenetworksecurity,analyzingvarious
information,leadingtopotentialsafetyhazardsandsystemfailures.
DL-basedsolutionsandtheireffectivenessinintrusiondetection,
OntheCANbus,aDoSattackisverystraightforwardasCAN
authentication,andprivacyprotectionwithinvehiclecommuni-
messageswithlowidentifiers(IDs)havehigherpriorityandcan
cationsystems.Guptaetal.[8]introducedanattention-enabled
thuspreventmessageswithhigherIDsfromcommunicatingon
hierarchicaldeepneuralnetwork(AHDNN)todetectintrusions
thebus.Asaresult,injectingamessagewithCANID0x0would
andensurethesafetyofsmartvehiclesatboththenodeandthenet-
blockanylegitimatetrafficonthebus.
worklevels.Ashrafetal.[2]utilizedDLforintrusiondetectionin
transportationsystems,employingaLSTMautoencodertoidentify Fuzzing. Fuzzingattacksinvolvesendingalargenumberof
maliciousnetworkbehaviorsinIVNsandvehicle-to-infrastructure random,misformed,orunexpectedmessagestotheCANbusto
networks.Mehedietal.[20]proposedaLeNet-baseddeeptransfer discovervulnerabilitieswithinthevehicle’sECUs.Byexposing
learningIDSmodelwithactiveattributeselectiontorecognizeand thesystemtoavarietyofunexpectedinputs,fuzzingcanreveal
differentiatemaliciousCANmessages. weaknessesthatcanbeexploitedtocausetheECUstomalfunction
orcrash,therebycompromisingvehiclesafetyandfunctionality.
ExplainableAIforIVNSecurity. Whilethesemethodshave
SpoofingAttacks. Spoofingattacksonvehicularsystemsin-
shownhigheffectiveness,theiropaqueblack-boxnaturepresents
volvetheinjectionoffalsifieddataintotheCANbus,disrupting
significantchallenges.Thelackoftransparencyandinterpretabil-
theaccuracyofcriticalsystemreadingsandunderminingvehicle
ityintheirdecision-makingprocessesdiminishestheirreliability
performanceandsafety.Thereisamyriadofvehicularsignalson
andtrustworthiness,particularlyfromanindustrystandpoint.The
the CAN bus that is subject to spoofing attacks, with the most
automotivesectordemandssecuritysolutionsthatnotonlyachieve
prominentbeingRPM,gear,gas,speed,andsteeringwheelangle
highdetectionaccuracy,butalsoofferclearexplanationsforthe
[22,29].
detectedanomalies.Tomeetthisneed,thereisagrowingfocuson
developinginterpretablemodels.Madhavetal.[19]exploredthe
3.2 DataPre-processingandFeatureScaling
useofexplainableAItoimprovedecisionmakinginautonomous
vehiclesystems.Houdaetal.[13]proposedaframeworkincorporat- PriortotrainingtheIDS,rigorousdatapre-processingstepswere
ingexplainableAItoimprovethetrustworthinessofdeeplearning takentoensuredataqualityandconsistency.Thesestepsincluded:
techniquesinintrusiondetection.Thisframeworkhelpscyberse- (1) MissingValueHandling:Anymissingorincompletedata
curityexpertssystematicallyelucidatedecision-makingprocesses, entrieswereidentifiedandaddressedbyimputationtech-
therebystrengtheningIoTnetworksecurity.Rendaetal.[28]ex- niquesorbydiscardingincompleterecordstomaintainthe
aminedtheroleofexplainableAIinfederatedlearningtoadvance integrityofthedataset.
technologiesfornext-generation5Gand6Gnetworks,withafocus (2) DataConversion:TheCANIDs,originallyinhexadecimal
onvehicle-to-everythingapplications. format,wereconvertedtodecimaltofacilitatenumericalCPSIoTSec’24,October14–18,2024,SaltLakeCity,UT,USA MuhammetAnilYagiz,PedramMohajerAnsari,MertD.Pesé,&PolatGoktas
proceWssing.Thistransformationwasessentialtostandard- Table1:HyperparameterConfigurationforCHDandCIC
izethedataandensurecompatibilitywithmachinelearning IOVDatasets
algorithms.
(3) Normalization:Tomitigatetheeffectsofvaryingscales Hyperparameter ValuesforCHD ValuesforCICIOV
andunitsacrossdifferentfeatures,aMin-MaxScalerwas
Smoothfactor 1e-06 1e-08
employed.Thisscalingtechniquenormalizedthedatawithin
Numberofencoderlayers 3 3
therange[0,1],ensuringthatallcharacteristicscontributed
Batchsize 32 32
equallytothelearningprocess.Thisstepwascrucialfor Learningrate 0.0001 0.0001
enhancing the convergence rate of the machine learning Epochs 1 50
modelsandpreventinganysinglefeaturefromdominating
thelearningprocess.TheMin-Maxnormalizationformula
isdefinedasfollows: behindknowledgedistillationistoenablethestudentmodelto
𝑥−𝑥
𝑥′ = min (1) emulatethebehavioroftheteachermodel,therebyachievinghigh
𝑥 max−𝑥
min accuracywithreducedcomputationaldemands.
where𝑥 is the original value,𝑥′ is the normalized value,
ProxyDatasetSelection. Theprocessofknowledgetransfer
𝑥 min istheminimumvalueofthefeature,and𝑥 max isthe typicallyrequiresaproxydatasettoactasthemediumfortransfer.
maximumvalueofthefeature.
Commonly,thisproxydatasetisamutuallyexclusivedataset;alter-
natively,somemethodsmayemployanautoencoderorGenerative
3.3 StrategicDataPartitioningforModel
AdversarialNetwork(GAN)tosynthesizeasuitabledataset.
Evaluation
SoftTargetsforKnowledgeTransfer. Oncetheproxydataset
ToensurearobustevaluationoftheIDS,thedatasetsweredivided
isselected,thesofttargetsusedforknowledgetransferaretypically
intotrainingandtestingsets.Inanunconventionalapproachaimed
derivedfromtheclassprobabilitiesoftheteachermodel’soutput
atrigorouslytestingtheIDS,only5%ofthedatawasusedfortrain-
layer(logits)orfromfeaturerepresentationswithinitsinterme-
ing,whiletheremaining95%wasreservedfortesting.Thissplitwas
diatelayers(featuremaps).Thesesofttargetsencapsulatemore
chosentosimulatereal-worldscenarioswheremodelsmustper-
informativeandnuancedrepresentationscomparedtothehard
formwellevenwithlimitedtrainingdata.Thesplitensuredthatthe
labelsutilizedinconventionaltrainingparadigms.
modelwastestedonadiverseandextensivedataset,highlighting
itsgeneralizationcapabilitiesandrobustness. LossFunction. Intraditionalknowledgedistillation,theloss
functioncomprisestwocomponents:astandardcross-entropyloss
3.4 ProposedModelArchitecture
termandadistillationlossterm.Thedistillationlosstermisof-
TobuildarobustandefficientIDS,weemployedacombinationof tendefinedastheKullback-Leibler(KL)divergencebetweenthe
advancedtechniques,includingVAEsandKnowledgeDistillation. softmaxoutputsoftheteacherandstudentmodels:
3.4.1 VariationalAutoencoder(VAE). TheVAEarchitecturewas
∑︁
(cid:18)𝑆 𝑖(𝜎(𝑧))(cid:19)
chosenforitsabilitytolearnlatentrepresentationsofthedata, 𝐿 𝐾𝐿(𝑆 ∥𝑇)= 𝑆 𝑖(𝜎(𝑧))log
𝑇 𝑖(𝜎(𝑧))
(2)
capturingtheunderlyingdistributionofnormalandanomalous 𝑖
patternsinIVNs.TheVAEconsistedofanencoder,whichmapped where𝑆 and𝑇 representthelogitsofthestudentandteacher
theinputdatatoalatentspace,andadecoder,whichreconstructed models,𝜎 denotesthesoftmaxfunction,and𝑇 isatemperature
theinputdatafromthelatentspace.Thereconstructionerrorwas parameterthatsmoothstheprobabilitydistributions.
thenusedtoidentifyanomalies.Thekeyparametersandstructures
TrainingApproach. Ourapproachinvolvespre-trainingthe
oftheVAEaresummarizedinTable1.
teachermodelonthefulldatasettoachievehighaccuracy,gen-
EncoderandDecoderLayers. Theencoderanddecoderwere eratingsoftlabelsfromtheteachermodel’spredictions,andthen
designedwithmultipledenselayers,employingReLUactivations trainingthestudentmodelusingacombinationofhardandsoftla-
tocapturecomplexnon-linearrelationships. belstoinherittheknowledgeoftheteachermodelwhileremaining
computationallyefficient.
LatentSpaceDimension. Thedimensionofthelatentspace
Usingknowledgedistillation,ourIDSachievesabalancebetween
wascarefullyselectedtobalancethetrade-offbetweenreconstruc-
highdetectionaccuracyandreducedcomputationalresourcere-
tionfidelityandcomputationalefficiency.
quirements,makingitsuitableforreal-timeapplicationsinresource-
Regularization. KL-divergenceregularizationwasappliedto constrainedenvironments.
ensurethelatentspacefollowedastandardnormaldistribution,
3.4.3 ExplainableAI(XAI). Interpretabilityisafundamentalaspect
facilitatingbettergeneralizationandanomalydetection.
of our framework, enhancing trust and providing deep insight
3.4.2 KnowledgeDistillation. Knowledgedistillation,initiallypro- intothedecision-makingprocessesofourmodels.Toilluminate
posedbyHintonetal.[10],facilitatesthetransferofknowledge thepredictionsmadebythestudentmodeltrainedonthelatent
fromalargeandcomplexmodel(referredtoasteacher)toasmaller spacerepresentationsfromtheVAE,weemployXAItechniques,
andsimplermodel(referredtoasstudent).Thecoremotivation focusing specifically on Shapley Additive Explanations (SHAP).TransformingIn-VehicleNetworkIntrusionDetection:VAE-basedKnowledgeDistillationMeetsExplainableAI CPSIoTSec’24,October14–18,2024,SaltLakeCity,UT,USA
Figure1:ProposedModelArchitecture
SHAPvaluesprovideaconsistentmeasureoffeatureimportance, wascarefullycuratedtoensureanequalrepresentationofeachdata
ensuringinterpretabilityatbothlocalandgloballevels[5]. category,therebypreservingtheintegrityandrepresentativesof
TheSHAPframeworkcomputestheShapleyvaluesforeach theoriginaldataset.Despitethereducedsize,KD-XVAEachieved
feature,quantifyingtheircontributionstothemodel’spredictions. animpressivemacroaverageF1scoreof0.99,demonstratingthe
TheShapleyvalueforafeatureiscalculatedasfollows[18]: effectivenessofourapproachandtherobustnessofthesubsetin
maintainingessentialdatacharacteristics.
ByintegratingSHAPintoourframework,wenotonlyimprove
∑︁ |𝑆|!(|𝑁|−|𝑆|−1)!
𝜙 𝑖 = [𝑣(𝑆∪{𝑖})−𝑣(𝑆)] (3) the applicability of the model in real-world scenarios, but also
|𝑁|!
𝑆⊆𝑁\{𝑖} providestakeholderswithactionableinsightsintothesecurityand
robustnessofIoVsystems.Thus,ourframeworkenablesboththe
where𝜙 𝑖 representstheShapleyvalueforfeature𝑖,𝑁 istheset reliabilityandinterpretabilitynecessaryforeffectivedeployment
ofallfeatures,𝑆denotesasubsetoffeaturesand𝑣(𝑆)isthevalue
inpracticalapplications.
functionreflectingthepredictionofthemodelwithsubset𝑆.
Inourimplementation,theVAEisutilizedtocompresstheorigi-
4 Evaluation
nalhigh-dimensionalfeaturespaceintoalower-dimensionallatent
space.Theteacher/studentmodelisthentrainedontheselatent Inevaluatingtheperformanceofourproposedmodelagainstes-
representations.Toensuretransparencyandcomprehensibilityof tablishedcompetitors,weobservedsignificantimprovementsin
themodel’sdecisions,weapplySHAPtothelatentspace.SHAPval- bothefficiencyandaccuracymetrics.
uesindicatetheimportanceofeachlatentdimensioninthemodel’s
predictions.Inaddition,wemaptheselatentdimensionsbackto 4.1 Datasets
theoriginalfeaturestoprovideamoreintuitiveunderstandingof Inthispaper,twoprimarydatasetswereutilizedtoevaluatethe
thebehaviorofthemodel.Thismapping,thoughsimplified,offers performanceoftheIDSforIVNs,asdetailedbelow:
valuableinsightsintohoworiginalfeaturesinfluencethelatent
spaceand,consequently,themodel’spredictions. HCRLCar-Hacking. CollectedbytheHackingandCounter-
However,duringtheimplementationofXAItechniques,wefaced measureResearchLab(HCRL),thisdatasetisacomprehensivere-
significantchallengesrelatedtomemoryconsumptionandprocess- sourceforautomotivecybersecurity.ItincludesbothbenignCAN
ingtime.Thecomputationalintensityofthesemethodsnecessitated trafficandfourdistincttypesofattacks—DenialofService(DoS),
thecreationofasmaller,balancedsubsetofourdatasettoenable Fuzzing,RPMSpoofing,andGearSpoofing.Thedataweregathered
moreefficientanalysis.Thissubset,consistingof245,919instances, fromaHyundaiYFSonatavehicleunderreal-worldconditions,CPSIoTSec’24,October14–18,2024,SaltLakeCity,UT,USA MuhammetAnilYagiz,PedramMohajerAnsari,MertD.Pesé,&PolatGoktas
providingarobustfoundationforIDSdevelopment.EachCAN 4.3 PerformanceEvaluationonHCRL
messageincludesatimestamp,an11-bitCANIDinHEXformat Car-HackingDataset
(convertedtoDEC),datalength,8-bytedata,andaflagindicating
Table4providesacomprehensivecomparisonofperformancemet-
whether the message is normal or injected. Sequential samples
ricsforvariousIDSmodelsintheHCRLCarHackingdataset,cov-
(𝑛=29)areaggregatedtoformdataframes,labeledaccordingto
eringdifferentattacktypessuchasDoS,Fuzzing,GearSpoofing,
theattacktypeifanyinjectedmessageispresent[29].
andRPMSpoofing.Thedetailedresultsareoutlinedbelow:
CanadianInstituteforCybersecurityInternetofVehicles • DoSattacks:KD-XVAEachievesanFNRof0%,matching
(CIC-IoV). ThisdatasetfeaturesDoSattacksandvariousspoofing theperfectperformanceoftheTransformer[23]andTime-
scenariosconductedona2019Fordvehicle.Attackswereexecuted EmbeddedTransformer[15].TheRecall,Precision,andF1
undercontrolledconditionswiththevehiclestationary,ensuring Score for KD-XVAE are all 1.0, indicating flawless detec-
safety.ItencompassesDoS,GasSpoofing,SteeringWheelSpoofing, tionandclassificationofDoSattacks.Thisperformanceis
SpeedSpoofing,andRPMSpoofing.Eachentrycontainsatimestamp, onparwiththebestmodelsbutwithasignificantlylower
CANID,DataLengthCode(DLC),databytes,andaflagindicating computationalfootprint.
normalorinjectedmessages.Sequentialdataframesarecreated • Fuzzingattacks:KD-XVAEagaindemonstratesaperfect
byaggregatingsamples(𝑛=7),facilitatingeffectiveanalysisand
performancewithanFNRof0%,andRecall,Precision,and
anomalydetection[22]. F1Scoresof1.0.Thissurpassestheperformanceofmodels
Thesedatasetsprovideacomprehensivefoundationforthede- likeRec-CNN[6],whichshowsahighFNRof17.0%and
velopmentandevaluationofIDSinIVNs,enhancingthesecurity lowerrecallandprecisionvalues.ThesuperiorityofKD-
andresilienceofautonomousvehiclesagainstsophisticatedcyber XVAEinhandlingFuzzingattackshighlightsitsrobustness
threats,assummarizedinTable2. inidentifyingsubtleandcomplexanomalies.
• GearSpoofingattacks:KD-XVAEmaintainsanFNRof0%
4.2 ExperimentalSetupandEvaluationMetrics
andperfectscoresinRecall,Precision,andF1Score.This
TheexperimentsareexecutedonasystemfeaturinganIntelCore isasignificantachievementcomparedtomodelslikethe
i9-13900Kprocessorclockedat3.0GHz,64GBofDDR4RAM,1TB LSTM[23]andCNN-LSTM[23],whichhaveloweraccuracy
SSDstorage,andanNVIDIAGeForceRTX3090GPUwith24GB metrics.Thehighperformanceacrossallmetricsconfirms
ofVRAMrunningUbuntu20.04LTS. KD-XVAE’sabilitytoeffectivelydetectandclassifyGear
Inthisstudy,weconductedcomprehensiveexperimentstoeval- Spoofingattacks.
uatetheperformanceofourproposedIDSmodel.Theexperiments • RPM Spoofing attacks: KD-XVAE consistently delivers
weredesignedtorigorouslytestthemodel’sabilitytodetectvari- an FNR of 0%, with Recall, Precision, and F1 Score all at
oustypesofcyberattackonIVNs.Theevaluationwascarriedout 1.0.ThisperformanceiscomparabletotheTime-Embedded
usingstandardperformancemetricsandbaselinecomparisonswith Transformer [15] and superior to traditional models like
existingstate-of-the-artIDSsolutions.Thekeymetricsusedinthis DCNNResNet[29],which,despitehighprecision,havelower
studyaredefinedasfollows: recallvaluesandhigherFNRs.
• PerformanceMetrics:Metricssuchasaccuracy,precision, Inessence,KD-XVAEachievesperfectdetectionmetrics(Recall,
recall,and𝐹 1-scorewerecalculatedtoassessthemodel’s Precision,F1Scoreof1.0andFNRof0%)acrossallattacktypesinthe
detectioncapabilities.Thesemetricsprovidedaholisticview HCRLCar-Hackingdataset.Performanceconsistencyisparticularly
ofthemodel’seffectivenessinidentifyingbothnormaland evidentwhencomparedtoothermodelssuchastheTransformer
anomalousCANmessages. [23]andtheTime-EmbeddedTransformer[15],bothofwhichalso
• NumberofParameters: achievedhighmetricsbutwithgreatercomputationaldemands.
𝐿
∑︁
NumberofParameters= Parameters(𝑖) (4) 4.4 ComparativeAnalysisonCICIoV2024
𝑖=1
Dataset
where𝐿isthenumberoflayersinthemodel,andParameters(𝑖)
representsthenumberofparametersinthe𝑖-thlayer. Table5highlightstheperformanceofKD-XVAEcomparedtotra-
ditionalmachinelearningmodelsontheCICIoV2024dataset.The
• InferenceTimeperBatch:
resultsclearlydemonstratethesuperiorityofKD-XVAEinterms
InferenceTime(ms)=
(cid:18) EndTime−StartTime(cid:19)
(5) ofaccuracyanddetectioncapabilities.
BatchSize
• Accuracy:KD-XVAEachievesaperfectaccuracyscoreof
Inferencetimeperbatchmeasuresthetimetakenbythe 1.0,surpassingLogisticRegression(0.89),AdaBoost(0.92),
modeltomakepredictionsonabatchofinputdata.This DeepNeuralNetwork(0.96),andRandomForest(1.0)[22].
metricindicatestheefficiencyandspeedofthemodelduring ThisindicatesKD-XVAE’sabilitytoclassifyallinstances
inference. correctly.
Thesecomprehensivebaselinecomparisonsillustratetherobust- • Recall: With a recall of 1.0, KD-XVAE detects all attack
ness, efficiency, and advanced capabilities of our proposed IDS instances.Incomparison,LogisticRegressionandAdaBoost
model,establishingitasaleadingsolutionforenhancingIVNsecu- showrecallsof0.50and0.66,respectively,whileDeepNeural
rityinautonomousvehicles. NetworkandRandomForestachieve0.76and1.0.TransformingIn-VehicleNetworkIntrusionDetection:VAE-basedKnowledgeDistillationMeetsExplainableAI CPSIoTSec’24,October14–18,2024,SaltLakeCity,UT,USA
Table2:DatasetsUsedforVehicleAttackAnalysis
Dataset Vehicle AttacksIncluded Conditions DataFeatures NumberofSamples
Timestamp
DoS CANID(HEXtoDEC)
Fuzzing DataLength
HCRLCar-Hacking[29] HyundaiYFSonata Realconditions ∼16,558,462
RPMSpoofing Databytes
GearSpoofing Normal/InjectedFlag
Sequentialsamples(n=29)
Timestamp
DoS
CANID(HEXtoDEC)
GasSpoofing
DLC
CIC-IoV[22] 2019Fordvehicle SteeringWheelSpoofing Controlledconditions ∼1,408,219
Databytes
SpeedSpoofing
Normal/InjectedFlag
RPMSpoofing
Sequentialsamples(n=7)
Table3:ComparisonofModelComplexityandInferenceTimeperBatch
Model Parameters(millions) Inferencetime/batch(ms)
Time-embeddedTransformerwithAutoEncoder[15] 0.259 3.58
Transformer[23] 2.67 11.6
Time-embeddedTransformer[15] 0.256 3.42
TeacherModel 0.00435 0.3
StudentModel 0.0016 0.3
• Precision:KD-XVAE’sprecisionisalso1.0,indicatingno Intermsofinferencetime,KD-XVAEdemonstratesexceptional
falsepositives.TraditionalmodelslikeLogisticRegression performance,requiringonly0.3msperbatch,measuredonthe
and AdaBoost have lower precision (0.48 each), whereas HCRLCar-Hackingdataset.Thisisasubstantialimprovementover
DeepNeuralNetworkandRandomForestshow0.83and1.0, the3.58msneededbytheTime-EmbeddedTransformerwithAu-
respectively. toencoder[15].Suchefficiencygainsarecriticalforreal-timeappli-
• F1ScoreandBalancedPerformance:KD-XVAE’sF1scores cations,ensuringpromptdetectionandresponsetocyberthreats.
of1.0,reflectingtheharmonicmeanofprecisionandrecall, MinimumcycletimesforCANmessagesona500kBit/sbusas
were consistently perfect, showcasing a balanced perfor- usedforthetwodatasetsstandat10ms[24].Asaresult,anyla-
manceindetectingintrusionswhilemaintaininghighpre- tencyoverheadcausedbyKD-XVAEneedstobesmallerthan10
cisionandrecallrates.LogisticRegressionandAdaBoost mswhichalsoincludesnetworklatencyandregularcomputation
havelowerF1scoresof0.49and0.51,respectively,while time.Ournumberseasilysatisfythisrequirement,displayingthe
DeepNeuralNetworkandRandomForestscore0.78and real-timecapabilityofKD-XVAE.
1.0.ThisbalanceisessentialforeffectiveandreliableIDS
performanceindynamicandvariedIVNenvironments.
4.6 XAIAnalysis
Thus,KD-XVAEoutperformstraditionalmachinelearningmod- TofurtherunderstandtheinnerworkingsofKD-XVAEandensure
elsintheCICIoV2024datasetacrossallkeyperformancemetrics, transparency,weconductedanXAIanalysistoidentifythemost
showcasingitsexceptionalcapabilityindetectingandclassifying andleastinfluentialfeaturesandlatentvariablesrelatedtodifferent
intrusionsaccuratelyandefficiently.Theseresultsvalidatetheef- classesanddatasets.Theinsightsgainedfromthisanalysisare
ficacyandsuperiorityofouradvanceddeeplearningapproachin crucialforvalidatingmodeldecisionsandensuringtrustworthiness
enhancingthesecurityofin-vehiclenetworks. incriticalapplicationslikeautomotivecybersecurity.
4.6.1 LatentVariablesandFeatureInfluenceinHCRLCar-Hacking
4.5 ModelComplexityandInferenceTime
Dataset. IntheHCRLCar-Hackingdataset,KD-XVAE’slatentdi-
KD-XVAE’sarchitecture,designedtobemorecompact,utilizesonly mensionsareinfluencedbyspecificfeaturesasfollows:
1669parametersprovidedinTable3.Thisisaconsiderablereduc-
tioncomparedtotheTime-EmbeddedTransformerwithAutoen- • Latentdimension0,11,22:InfluencedbyTimestamp.
coder,whichoperateswith259kparameters[15].Thestreamlined • Latentdimension1,12,23:InfluencedbyCANID.
parametercountdirectlycorrelateswithreducedcomputational • Latentdimension2,13,24:InfluencedbyDLC.
overhead,makingKD-XVAEmoresuitableforresource-constrained • Latentdimension3-10,14-21,25-31:InfluencedbyDATA[0]
environmentstypicalofautonomousvehicles. toDATA[7].CPSIoTSec’24,October14–18,2024,SaltLakeCity,UT,USA MuhammetAnilYagiz,PedramMohajerAnsari,MertD.Pesé,&PolatGoktas
Table4:PerformanceMetricsComparisonforDifferentIDSModelsontheHCRLCar-HackingDatasetAcrossVariousAttack
Types
Attack Type Model FNR (%) Recall Precision F1 Score
DCNN ResNet [29] 0.3 0.9970 0.9999 0.9985
CE ResNet [11] 0.21 0.9979 0.9997 0.9987
Rec-CNN [6] 2.0 0.9800 0.9924 0.9862
LSTM [23] 0.74 0.9926 0.9911 0.9919
DoS
CNN-LSTM [23] 0.5 0.9945 0.9994 0.9969
Transformer [23] 0 1.0 1.0 1.0
Time-Embedded Transformer [15] 0 1.0 1.0 1.0
KD-XVAE 0 1.0 1.0 1.0
DCNN ResNet [29] 0.33 0.9967 0.9992 0.9979
CE ResNet [11] 0.24 0.9976 0.9997 0.9987
Rec-CNN [6] 17.0 0.8300 0.8964 0.8619
LSTM [23] 3.27 0.9673 0.9666 0.9670
Fuzzing
CNN-LSTM [23] 0.9 0.9908 0.9991 0.9949
Transformer [23] 0.01 0.9999 0.9999 0.9999
Time-Embedded Transformer [15] 0 1.0 1.0 1.0
KD-XVAE 0 1.0 1.0 1.0
DCNN ResNet [29] 0.2 0.9980 0.9996 0.9988
CE ResNet [11] 0.11 0.9992 0.9994 0.9997
Rec-CNN [6] 7.63 0.9237 0.824 0.8763
LSTM [23] 3.12 0.9688 0.9683 0.9685
Gear Spoofing
CNN-LSTM [23] 0.78 0.9922 0.9968 0.9945
Transformer [23] 0.32 0.9968 0.9938 0.9953
Time-Embedded Transformer [15] 0 1.0 1.0 1.0
KD-XVAE 0 1.0 1.0 1.0
DCNN ResNet [29] 0.19 0.9982 0.9995 0.9988
CE ResNet [11] 0.12 0.9994 0.9996 0.9995
Rec-CNN [6] 15.50 0.9345 0.8547 0.8923
LSTM [23] 2.50 0.9726 0.9701 0.9713
RPM Spoofing
CNN-LSTM [23] 0.6 0.9912 0.9907 0.9909
Transformer [23] 0.06 0.9998 0.9998 0.9998
Time-Embedded Transformer [15] 0 1.0 1.0 1.0
KD-XVAE 0 1.0 1.0 1.0
Thisdetailedmappingindicatesthatthemodelreliesheavilyon 4.6.2 LatentVariablesandFeatureInfluenceinCIC-IoVDataset.
data-relatedfeaturestodetectvarioustypesofattack.Forexam- Similarly,intheCIC-IoVdataset,theinfluentialfeaturesforthe
ple,theperfectdetectionofDoSattackscanbeattributedtothe latentdimensionsareasfollows:
influentialroleofCANIDandDATAfields,whicharecriticalin
identifyinganomaliesindatatransmission. • Latentdimension0,9,18,27:InfluencedbyCANID.TransformingIn-VehicleNetworkIntrusionDetection:VAE-basedKnowledgeDistillationMeetsExplainableAI CPSIoTSec’24,October14–18,2024,SaltLakeCity,UT,USA
Table5:PerformanceMetricsComparisonforDifferentMLModelsontheCIC-IoVDataset.
Metrics LogisticRegression[22] AdaBoost[22] DeepNeuralNetwork[22] RandomForest[22] KD-XVAE
Accuracy 0.89 0.92 0.95 0.96 1.0
Recall 0.50 0.66 0.76 0.76 1.0
Precision 0.48 0.48 0.83 0.76 1.0
F1-score 0.49 0.51 0.78 0.76 1.0
• Latentdimension1-8,10-17,19-26,28-31:Influencedby featuresarecriticalforaccuratedetection.Forexample,the
DATA[0]toDATA[7]. teachermodel’smeanSHAPvalueforCANIDis0.35com-
paredtothestudentmodel’s0.28.
Here,theimportanceofCANIDandDATAfieldsisevident
• Class2:FuzzyAttack:HigherSHAPvaluesforCANID
acrossmultiplelatentdimensions,reflectingthemodel’sfocuson
andDATAfieldsintheteachermodelemphasizetheirimpor-
thesefeaturesforaccurateclassification.
tanceinidentifyingfuzzyattacks,withmeanSHAPvalues
4.6.3 FeatureImportanceandClass-SpecificAnalysis. TheXAIanal- of0.42forCANIDintheteachermodelversus0.33inthe
ysisprovidesadetailedunderstandingoftheimportanceoffea- studentmodel.
turesindifferentclassesintheHCRLCarHackingandtheCIC-IoV • Class3:GearSpoofingAttack:Theteachermodel’shigher
dataset. relianceonCANID(meanSHAPvalueof0.38)andDATA
• HCRLCar-HackingDataset: fields indicates these are key indicators of gear spoofing,
– HighImportance: comparedtothestudentmodel’s0.30.
∗ CANID:CrucialfordetectingDoS,Fuzzing,GearSpoof- • Class4:RPMSpoofingAttack:HigherSHAPvaluesin
ing,andRPMSpoofingattacks. theteachermodelforCANID(0.40)andDATAfieldsagain
∗ DATA Fields: All data bytes (DATA[0] to DATA[7]) underscore their significance in detecting RPM spoofing,
arehighlyinfluentialinidentifyingDoS,Fuzzing,Gear comparedtothestudentmodel’s0.32.
Spoofing,andRPMSpoofingattacks.
– LowImportance: Thestudentmodel,whilestillrelyingonthesefeatures,showsa
∗ Timestamp:Lowsignificanceinidentifyingattack-free generallyloweremphasis,whichmayreflectthatitsdesignismore
instances(onlyforAttack-Freeclass). generalizedandlessdependentonspecificfeatures.
∗ DLC (Data Length Code): Low importance in distin- IntheCIC-IoVdataset,thedifferencesbetweentheteacherand
guishingnormaltraffic(onlyforAttack-Freeclass). studentmodelsaremorepronouncedforcertainclasses,particularly
• CIC-IoVDataset: intermsoffeatureimportance:
– HighImportance:
∗ CANID:IdentifiestheIDsinvolvedinDoS,RPMspoof- • Class1:DoSAttack:Theteachermodelreliesmoreon
ing,Speedspoofing,Steeringwheelspoofing,andGas CANIDandDATAfields,indicatingtheircrucialrolewith
spoofing. meanSHAPvaluesof0.36forCANIDcomparedto0.29in
∗ DATA Fields: Reflects payload patterns indicative of thestudentmodel.
DoSAttack,RPMSpoofing,SpeedSpoofing,Steering • Class2:RPMSpoofing:Theteachermodelplaceshigher
WheelSpoofing,andGasSpoofingattacks. importanceonCANIDandDATAfieldsthanthestudent
– LowImportance: model,withmeanSHAPvaluesof0.41forCANIDversus
∗ Timestamp:Lowsignificanceinidentifyingattack-free 0.34inthestudentmodel,highlightingtheirsignificance.
instances(onlyforAttack-Freeclass). • Class3:SpeedSpoofing:HigherSHAPvaluesforCAN
IDandDATAfieldsintheteachermodelsuggesttheseare
4.6.4 ComparativeAnalysisofMeanSHAPValueRatioBetween
criticalforidentifyingspeedspoofingattacks,withmean
TeacherandStudentModels. Thissectionprovidesacomparative
SHAPvaluesof0.39forCANIDintheteachermodelversus
analysisofthemeanSHAPvalueratiosbetweentheteacherandstu-
0.31inthestudentmodel.
dentmodelsacrossdifferentclassesinboththeHCRLCar-Hacking • Class4:SteeringWheelSpoofing:Theteachermodel’s
andCIC-IoVdatasets.Theanalysisrevealsmeaningfuldifferences
relianceonCANIDandDATAfieldsunderscorestheirim-
infeatureimportancebetweenthemodelsforspecificclasses.
portance,showingmeanSHAPvaluesof0.40forCANID
FortheHCRLCar-Hackingdataset,theteachermodelconsis-
comparedto0.32inthestudentmodel,whichshowsless
tentlyshowshighermeanSHAPvalueratiosforkeyfeaturessuch
dependence.
asCANIDandDATAfieldsacrossvariousattackclasses.Thisindi- • Class5:GasSpoofing:Similartootherclasses,theteacher
catesthattheteachermodelreliesmoreheavilyonthesefeatures
modelplacesmoreimportanceonCANIDandDATAfields,
toidentifyattackscomparedtothestudentmodel.
withmeanSHAPvaluesof0.37forCANIDversus0.30in
• Class 1: DoS Attack: The teacher model places greater the student model, indicating these features are vital for
importanceonCANIDandDATAfields,suggestingthese detectinggasspoofingattacks.CPSIoTSec’24,October14–18,2024,SaltLakeCity,UT,USA MuhammetAnilYagiz,PedramMohajerAnsari,MertD.Pesé,&PolatGoktas
Overall,theteachermodeldemonstratesamorefocusedreliance ontheHCRLCar-Hackingdatasethighlightsthemodel’srobust-
onspecificfeatures,especiallyCANIDandDATAfields,across nessandadaptability,withperfectscoresinRecall,Precision,and
bothdatasets,whilethestudentmodelexhibitsamorebalanced F1Score.Comparatively,KD-XVAEoutperformstraditionalma-
andgeneralizedfeatureimportance. chinelearningmodelsontheCICIoV2024dataset,validatingthe
efficacyofadvanceddeeplearningtechniquesinenhancingIVN
5 Discussion security.Additionally,theintegrationofXAImethodsprovides
valuableinsightsintothedecision-makingprocess,enhancingthe
5.1 Limitations
transparencyandtrustworthinessofKD-XVAE.Movingforward,
Despitethesignificantadvancementsintroducedbyourproposed furtheroptimizationandreal-worldvalidationwillbecrucialto
IDSmodel,leveragingaVAE-basedknowledgedistillationapproach, ensurethemodel’spracticaleffectivenessandreliabilityindiverse
thereareseverallimitationsthatneedtobeaddressed.Onenotable automotivescenarios.
limitationisthemodel’sdependencyonthequalityanddiversity
ofthetrainingdata.WhileKD-XVAEhasdemonstratedrobustper-
formanceacrossvariousattacktypesontheHCRLCar-Hacking References
dataset,itseffectivenessindetectingnovelorpreviouslyunseenat- [1] A.Altalbe.2023. Enhancedintrusiondetectioninin-vehiclenetworksusing
tackpatternsremainstobefullyvalidated.Additionally,themodel’s advancedfeaturefusionandstacking-enrichedlearning.IEEEAccess12(2023),
2045–2056. https://doi.org/10.1109/ACCESS.2023.3347619
performance,althoughsuperiorintermsofparameterefficiency [2] JavedAshraf,AsimDBakhshi,NourMoustafa,HasnatKhurshid,AbdullahJaved,
andinferencetime,maystillencounterchallengeswhendeployed andAminBeheshti.2020. Noveldeeplearning-enabledLSTMautoencoder
architecturefordiscoveringanomalouseventsfromintelligenttransportation
inenvironmentswithextremecomputationalconstraintsorinsce-
systems. IEEETransactionsonIntelligentTransportationSystems22,7(2020),
narioswherereal-timedecision-makingiscrucial.Therelianceon 4507–4518.
specificfeaturessuchasCANIDandDATAfields,whilebeneficial [3] M.Bhavsar,Y.Bekele,K.Roy,J.Kelly,andD.Limbrick.2024.FL-IDS:Federated
learning-basedintrusiondetectionsystemusingedgedevicesfortransportation
fordetectionaccuracy,mayalsolimitthemodel’sadaptabilityto
IoT.IEEEAccess12(2024),52215–52226. https://doi.org/10.1109/ACCESS.2024.
differenttypesofautomotivenetworksorconfigurations. 3386631
[4] M.J.Choi,I.R.Jeong,andH.M.Song.2024.Fastandefficientcontext-aware
embeddinggenerationusingfuzzyhashingforin-vehiclenetworkintrusion
5.2 FutureWork detection.VehicularCommunications47(2024),100786. https://doi.org/10.1016/j.
vehcom.2024.100786
Futureworkwillprimarilyfocusonaddressingtheaforementioned [5] G.VandenBroeck,A.Lykov,M.Schleich,andD.Suciu.2022.Onthetractability
limitationstoenhancethepracticalapplicabilityandrobustnessof ofSHAPexplanations.JournalofArtificialIntelligenceResearch74(2022),851–886.
https://doi.org/10.1613/jair.1.13283
KD-XVAE.Onekeyareaoffocuswillbetheoptimizationofthe
[6] ArayaKibromDesta,ShujiOhira,IsmailArai,andKazutoshiFujikawa.2022.
modelfordeploymentindiversereal-worldscenarios,including Rec-CNN:In-vehiclenetworksintrusiondetectionusingconvolutionalneural
environmentswithvaryingcomputationalresourcesandnetwork networkstrainedonrecurrenceplots. VehicularCommunications35(2022),
100470.
configurations.Thiswillinvolveextensivetestingandvalidationof [7] W.Ding,I.Alrashdi,H.Hawash,andM.Abdel-Basset.2024.DeepSecDrive:An
themodel’sperformanceacrossdifferentautomotiveplatformsand explainabledeeplearningframeworkforreal-timedetectionofcyberattackin
in-vehiclenetworks.InformationSciences658(2024),120057. https://doi.org/10.
undervaryingoperationalconditions.Additionally,futureresearch
1016/j.ins.2023.120057
willaimtoimprovethemodel’sabilitytodetectnovelandevolving [8] KoyelDattaGupta,DeepakKumarSharma,RinkyDwivedi,andGautamSri-
cyberthreatsbyincorporatingadvancedtechniquesforanomaly vastava.2023. AHDNN:attention-enabledhierarchicaldeepneuralnetwork
frameworkforenhancingsecurityofconnectedandautonomousvehicles.Jour-
detectionandcontinuouslearning.Enhancingtheinterpretability
nalofCircuits,SystemsandComputers32,04(2023),2350058.
ofKD-XVAEthroughtheintegrationofmoresophisticatedXAI [9] A.Haddaji,S.Ayed,andL.C.Fourati.2024. Anovelandefficientframework
methodswillalsobeapriority,ensuringthatthedecision-making forin-vehiclesecurityenforcement.AdHocNetworks158(2024),103481. https:
//doi.org/10.1016/j.adhoc.2024.103481
processremainstransparentandtrustworthy.Finally,collaborative [10] GeoffreyHinton,OriolVinyals,andJeffDean.2015.DistillingtheKnowledgein
effortswithindustrypartnerswillbepursuedtofacilitatetheprac- aNeuralNetwork. arXiv:1503.02531[stat.ML] https://arxiv.org/abs/1503.02531
[11] Thien-NuHoangandDaeheeKim.2024. SupervisedcontrastiveResNetand
ticaldeploymentandreal-worldvalidationofKD-XVAEinmodern
transferlearningforthein-vehicleintrusiondetectionsystem.ExpertSystems
automotivesystems. withApplications238(2024),122181.
[12] MdDelwarHossain,HiroyukiInoue,HideyaOchiai,DoudouFall,andYouki
Kadobayashi.2020.LSTM-BasedIntrusionDetectionSystemforIn-VehicleCan
6 Conclusion BusCommunications.IEEEAccess8(2020),185489–185502. https://doi.org/10.
1109/ACCESS.2020.3029307
OurproposedIDSmodel,KD-XVAE,setsanewbenchmarkinIVN [13] ZAEHouda,BBrik,LKhoukhi,SGCetin,CGoztepe,GKKurt,HYanikomeroglu,
securitybyachievingstate-of-the-artperformancewithacompact KZia,AChiumento,PJMHavinga,etal.2022.BigDataandMachineLearning
forCommunications1164“WhyShouldITrustYourIDS?”:AnExplainable
andefficientdesign.Thepresentedresultsunderscorethesignif-
DeepLearningFrameworkforIntrusionDetectionSystemsinInternetofThings
icantadvancementsbroughtbyKD-XVAE,particularlyinterms Networks.(2022).
ofmodelcomplexityandresourceefficiency,whichmakeithighly [14] NarayanKhatri,SihyungLee,andSeungYeobNam.2023.TransferLearning-
BasedIntrusionDetectionSystemforaControllerAreaNetwork.IEEEAccess11
suitablefordeploymentinreal-worldautomotiveenvironments.
(2023),120963–120982. https://doi.org/10.1109/ACCESS.2023.3328182
Themodel’sreducedparametercountsignificantlylowersthecom- [15] Tien-DatLe,HoangBaoHuyTruong,VanPhuPham,andDaeheeKim.2024.
putationalburden,enhancingitsfeasibilityforvehicleswithlimited Multi-classificationin-vehicleintrusiondetectionsystemusingpacket-and
sequence-levelcharacteristicsfromtime-embeddedtransformerwithautoen-
processingcapabilities.Moreover,KD-XVAE’ssuperiorinference coder.Knowledge-BasedSystems299(2024),112091. https://doi.org/10.1016/j.
times,averaging0.3msperbatch,ensureitsreal-timeapplicability, knosys.2024.112091
[16] H.C.Lin,P.Wang,K.M.Chao,W.H.Lin,andJ.H.Chen.2022.Usingdeeplearning
enablingimmediatedetectionandresponsetopotentialthreats.
networkstoidentifycyberattacksonintrusiondetectionforin-vehiclenetworks.
The consistent high performance across all tested attack types Electronics11,14(2022),2180. https://doi.org/10.3390/electronics11142180TransformingIn-VehicleNetworkIntrusionDetection:VAE-basedKnowledgeDistillationMeetsExplainableAI CPSIoTSec’24,October14–18,2024,SaltLakeCity,UT,USA
[17] W.Lo,H.Alqahtani,K.Thakur,A.Almadhor,S.Chander,andG.Kumar.2022.A [27] S.Rajapaksha,H.Kalutarage,M.O.Al-Kadri,A.Petrovski,G.Madzudzo,andM.
hybriddeeplearningbasedintrusiondetectionsystemusingspatial-temporal Cheah.2023.AI-basedIntrusionDetectionSystemsforIn-VehicleNetworks:A
representationofin-vehiclenetworktraffic.VehicularCommunications35(2022), Survey.Comput.Surveys55,11(2023),1–40. https://doi.org/10.1145/3570954
100471. https://doi.org/10.1016/j.vehcom.2022.100471 [28] AlessandroRenda,PietroDucange,FrancescoMarcelloni,DarioSabella,Mil-
[18] S.M.LundbergandS.-I.Lee.2017. Aunifiedapproachtointerpretingmodel tiadisC.Filippou,GiovanniNardini,GiovanniStea,AntonioVirdis,Davide
predictions.Advancesinneuralinformationprocessingsystems30(2017). https: Micheli,DamianoRapone,andLeonardoGomesBaltar.2022.FederatedLearning
//doi.org/10.48550/arXiv.1705.07874 ofExplainableAIModelsin6GSystems:TowardsSecureandAutomatedVehicle
[19] AVShreyasMadhavandAmitKumarTyagi.2022. ExplainableArtificialIn- Networking.Information13,8(2022). https://doi.org/10.3390/info13080395
telligence(XAI):connectingartificialdecision-makingandhumantrustinau- [29] HyunMinSong,JiyoungWoo,andHuyKangKim.2020. In-vehiclenetwork
tonomousvehicles.InProceedingsofThirdInternationalConferenceonComputing, intrusiondetectionusingdeepconvolutionalneuralnetwork.VehicularCommu-
Communications,andCyber-Security:IC4S2021.Springer,123–136. nications21(2020),100198.
[20] SkTanzirMehedi,AdnanAnwar,ZiaurRahman,andKawsarAhmed.2021.Deep [30] PengfeiSun,PengjuLiu,QiLi,ChenxiLiu,XianglingLu,RuochenHao,and
transferlearningbasedintrusiondetectionsystemforelectricvehicularnetworks. JinpengChen.2020. DL-IDS:ExtractingFeaturesUsingCNN-LSTMHybrid
Sensors21,14(2021),4736. NetworkforIntrusionDetectionSystem.SecurityandCommunicationNetworks
[21] MinkiNam,SeungyoungPark,andDukSooKim.2021. IntrusionDetection 2020,1(2020),8890306. https://doi.org/10.1155/2020/8890306
MethodUsingBi-DirectionalGPTforin-VehicleControllerAreaNetworks.IEEE [31] AnumTalpurandMohanGurusamy.2021. MachineLearningforSecurityin
Access9(2021),124931–124944. https://doi.org/10.1109/ACCESS.2021.3110524 VehicularNetworks:AComprehensiveSurvey. CoRRabs/2105.15035(2021).
[22] EuclidesCarlosPintoNeto,HamidehTaslimasa,SajjadDadkhah,ShahrearIqbal, arXiv:2105.15035 https://arxiv.org/abs/2105.15035
PuleiXiong,TaufiqRahman,andAliA.Ghorbani.2024.CICIoV2024:Advancing [32] S.Ullah,M.A.Khan,J.Ahmad,S.S.Jamal,Z.eHuma,M.T.Hassan,andW.J.
realisticIDSapproachesagainstDoSandspoofingattackinIoVCANbus.Internet Buchanan.2022. HDL-IDS:ahybriddeeplearningarchitectureforintrusion
ofThings26(2024),101209. https://doi.org/10.1016/j.iot.2024.101209 detectionintheInternetofVehicles.Sensors22,4(2022),1340. https://doi.org/
[23] TrieuPhongNguyen,HeungwooNam,andDaeheeKim.2023. Transformer- 10.3390/s22041340
basedattentionnetworkforin-vehicleintrusiondetection.IEEEAccess11(2023), [33] Y.Wang,G.Qin,M.Zou,Y.Liang,G.Wang,K.Wang,andZ.Zhang.2024. A
55389–55403. lightweightintrusiondetectionsystemforinternetofvehiclesbasedontransfer
[24] MertDPesé,JayWSchauer,JunhuiLi,andKangGShin.2021.S2-CAN:Suffi- learningandMobileNetV2withhyper-parameteroptimization.MultimediaTools
cientlysecurecontrollerareanetwork.InProceedingsofthe37thAnnualComputer andApplications83,8(2024),22347–22369. https://doi.org/10.1007/s11042-023-
SecurityApplicationsConference.425–438. 14578-1
[25] AdnanQayyum,MuhammadUsama,JunaidQadir,andAlaAl-Fuqaha.2020. [34] L.YangandA.Shami.2022. AtransferlearningandoptimizedCNNbased
Securingconnected&autonomousvehicles:Challengesposedbyadversarial intrusiondetectionsystemforInternetofVehicles.InICC2022-IEEEInternational
machinelearningandthewayforward.IEEECommunicationsSurveys&Tutorials ConferenceonCommunications.IEEE,NewYork,NY,USA,2774–2779. https:
22,2(2020),998–1026. //doi.org/10.1109/ICC4585.2022.9839780
[26] HongmaoQin,MengruYan,andHaojieJi.2021.ApplicationofControllerArea [35] HaoZhao,YaokaiFeng,HiroshiKoide,andKouichiSakurai.2019.AnANNBased
Network(CAN)busanomalydetectionbasedontimeseriesprediction.Vehicular SequentialDetectionMethodforBalancingPerformanceIndicatorsofIDS.In
Communications27(2021),100291. https://doi.org/10.1016/j.vehcom.2020.100291 2019SeventhInternationalSymposiumonComputingandNetworking(CANDAR).
239–244. https://doi.org/10.1109/CANDAR.2019.00039
Building multiscale models with PhysiBoSS, an
agent-based modeling tool
MarcoRuscone1,2,3,(cid:0) ,AndreaCheccoli4,5,RandyHeiland6,EmmanuelBarillot1,2,3,PaulMacklin6,LaurenceCalzone1,2,3,*,(cid:0)
,
andVincentNoël1,2,3,*,(cid:0)
1InstitutCurie,UniversitéPSL,F-75005,Paris,France
2INSERM,U900,F-75005,Paris,France
3MinesParisTech,UniversitéPSL,F-75005,Paris,France
4CentredeRecherchedesCordeliers,SorbonneUniversitéF-75005,Paris,France
5INSERM,U1138,F-75005,Paris,France
6DepartmentofIntelligentSystemsEngineering,IndianaUniversity,Bloomington,IN,USA
*Bothauthorscontributedequallytothiswork.
Multiscale models provide a unique tool for studying complex abroaderrepresentationofbiologicalsystems,blendingdis-
processesthatstudyeventsoccurringatdifferentscalesacross crete agent-based techniques with continuous mathematical
spaceandtime. Inthecontextofbiologicalsystems,suchmod- models(1). Thisapproachallowsforadetaileddepictionof
elscansimulatemechanismshappeningattheintracellularlevel individualcellbehaviorswhilesimultaneouslycapturingthe
suchassignaling,andattheextracellularlevelwherecellscom-
broader,continuousdynamicsofthebiologicalenvironment.
municateandcoordinatewithothercells. Theyaimtounder-
Suchmodelsareinstrumentalinaccuratelysimulatingthein-
stand theimpact ofgenetic or environmental deregulation ob-
tricate interactions within cancerous tissues, shedding light
served in complex diseases, describe the interplay between a
on the complex interplay of cellular and molecular factors.
pathologicaltissueandtheimmunesystem,andsuggeststrate-
However,developingthesemodelscanbechallenging,often
giestorevertthediseasedphenotypes.Theconstructionofthese
multiscale models remains a very complex task, including the requiringproficiencyinprogramminglanguageslikeC++or
choiceofthecomponentstoconsider,thelevelofdetailsofthe Python,whichmightnotbeaccessibletoallresearchers.
processestosimulate,orthefittingoftheparameterstothedata. An important advancement in this field was the introduc-
Oneadditionaldifficultyistheexpertknowledgeneededtopro- tion of PhysiBoSS(2, 3). This add-on to PhysiCell(4) en-
gramthesemodelsinlanguagessuchasC++orPython,which hances the modeling process by integrating intracellular de-
may discourage the participation of non-experts. Simplifying scriptions into the agent-based approach. PhysiBoSS uti-
thisprocessthroughstructureddescriptionformalisms—cou-
lizes MaBoSS(5, 6), a tool that models signaling pathways
pledwithagraphicalinterface—iscrucialinmakingmodel-
asBooleannetworks,thussimplifyingthedescriptionofin-
ingmoreaccessibletothebroaderscientificcommunity,aswell
tracellularmodels.Inaddition,PhysiCellStudio(7),agraphi-
asstreamliningtheprocessforadvancedusers. Thisarticlein-
calinterfacecompatiblewithbothPhysiCellandPhysiBoSS,
troducesthreeexamplesofmultiscalemodelswhichrelyonthe
further streamlines model development, catering to users
frameworkPhysiBoSS,anadd-onofPhysiCellthatincludesin-
tracellular descriptions as continuous time Boolean models to withvaryingprogrammingexpertise. Despitetheseadvance-
the agent-based approach. The article demonstrates how to ments, building a model can still prove complex for non-
easily construct such models, relying on PhysiCell Studio, the computationalresearcherswhoapproachthesoftwareforthe
PhysiCell Graphical User Interface. A step-by-step tutorial is first time. However, we have streamlined the process sig-
providedasaSupplementaryMaterialandallmodelsarepro- nificantly, making it more accessible and user-friendly. The
videdat:https://physiboss.github.io/tutorial/. models presented in this paper showcase a range of com-
plexitiesandfeatures,eachhighlightingadifferentaspectof
Multiscalemodeling|Agent-basedmodeling|Booleanmodeling
multiscalemodelingchallengesandtheirsolutions. Thispa-
Correspondence: vincent.noel@curie.fr, laurence.calzone@curie.fr,
marco.ruscone@curie.fr per aims to demonstrate the construction of such multiscale
models to answer biological questions, and guides the read-
Introduction ers through the practical implementation of these models,
demonstratingtheirutilityincancerresearch.
Multiscalemodelingisavaluabletoolinunderstandingcom-
plex biological systems, as it considers events occurring at
Methods
various spatial and temporal scales. Such models are in-
strumentalininvestigatingtheinterplaybetweenintracellular Agent-based modeling with PhysiCell.Agent-based
level mechanisms, and intercellular interactions where cells modeling relies on a computational approach that uses au-
communicateandcoordinate. Thisisespeciallypertinentin tonomous,interactingsoftwareagentstostudythebehaviors
thecontextofcancer,wheremultiscalemodelscanbeuseful of a system. An agent represents a single individual with
whenstudyingthecross-talkbetweenthemicroenvironment its own state and behaviors that can react to other agents or
components,offeringinsightsintothemechanismsofdisease thesurroundingenvironment. Agent-basedmodelsallowfor
progressionandpotentialtherapeuticstrategies. studyingtheemergenceofcomplexpopulationeventsfroma
Inthiscontext,wedevelopedhybridmodels,whichresultin simplesetofagents’behaviors. Inmedicalscience,anagent
Rusconeetal. | June27,2024 | 1–9
4202
nuJ
62
]MQ.oib-q[
1v17381.6042:viXracanrepresentacellthatcaninteractwithothercellsoritsmi- secretion, uptake, death, etc.). PhysiBoSS uses as input the
croenvironment.Withthisapproach,itispossibletosimulate sameconfigurationfilesofPhysiCell,andtheBNDandCFG
differentbiologicalscenarios,studycollectivecellularbehav- MaBoSSinputfiles.
iors, and test hypotheses in silico. At present, many agent-
basedframeworksareavailable,withdifferentcharacteristics Mappingagent-basedtointracellularmodels.PhysiCell
to better answer different modeling needs (1). In this con- provides a dictionary of signals and a dictionary for behav-
text, the C++ PhysiCell framework uses a center-based ap- iors,aimedatgivingbetteraccessibilitytoallthesignalsper-
proach,simulatingmechanicalandphenotypicalcelldynam- ceivedbyeachagentandallpossiblebehaviorsthatanagent
ics,aswellasthediffusionofsubstratestorepresentcellular can express. PhysiBoSS uses these data structures to sim-
respiration, paracrine communication, and more (4). Physi- plifytheconnectionbetweenPhysiCellandMaBoSS,giving
Cell enables the customization of the simulations through a access to the PhysiCell/MaBoSS mapping through the con-
generalconfigurationXMLfile, withoptionalspecifications figuration file and so, drastically diminishing the amount of
ofinitialcellpositionsandcellrulesinCSVfiles. Morere- C++codenecessarytodevelopamodel. Mappingcanbeof
cently, it was extended with a modeling grammar that con- twotypes: (1)inputmapping,whichlinksaPhysiCellsignal
nects signals (e.g., diffusing chemical factors) with changes toaMaBoSS(input)nodebyusingactivationthresholds,or
in cell behaviors, to help users straightforwardly model the (2)outputmapping,whichlinksaMaBoSS(output)nodetoa
stimuliperceivedbyanagentanditsbehavioralreactions(8). PhysiCellbehaviorbyusingvaluesrepresentingtheBoolean
PhysiCell includes dictionaries of available signals and be- state.Implementationdetailsaboutthemappingareavailable
haviors for use in PhysiBoSS models, and PhysiCell Studio inthesupplementarysectionS1.2.
can use these pre-populated dictionaries to graphically con-
structmodelrules. Time synchronisation.The intracellular model
is updated periodically, according to the value of
Logical modeling with MaBoSS.Logical modeling pro- intracellular_dt. The scaling parameter is
videsanefficientwaytostudyandrepresentcomplexbehav- also available to match the time scale of the intracellular
ioralpatternsinbiology. Thismethodinvolvesrepresenting model to the time scale of the agent-based model. Finally,
biologicalentities,suchasgenes,proteins,orfullpathways, toaccountforbiologicalphenomenasuchascellulardesyn-
asnodeswithinanetwork. UsingaBooleanapproach,each chronization, an option is available for stochastic update
nodeisavariableofthemodelthatcantaketwovalues,0for time. Moreinformationabouttheimplementationoftimein
absentorinactiveand1forpresentoractive,andtheupdate PhysiBoSS is available in the supplementary sections S1.3
of these variables is monitored by logical rules that link all andS1.4.
the inputs of a node with the logical connectors OR, AND,
and NOT. This type of models can be used to explore pa-
Results
tients’responsesbysimulatingvariousinitialconditionsand
accountingformutationsobservedinpatientsbyforcingthe PhysiBoSSperformssimulationsofmodelsthatcombinein-
valuesofthecorrespondingvariablesinthemodel. MaBoSS tracellularmoleculardescription(withMaBoSS)andphysi-
is a C++ software package for simulating Boolean models cal intercellular communication (with PhysiCell). With this
using continuous time Markov processes (5, 6). It applies approach,itispossibletostudytheimpactofeventsthatoc-
an asynchronous update scheme, which allows the descrip- curinsidethecellatthelevelofthepopulationandtheeffect
tion of heterogeneous responses. By associating transition atreatmentmayhaveconsideringphysicalfeatures.
rates to each variable, for both activation and inactivation, Wepresentthreeexamplesofmultiscalemodels: (1)amod-
itgeneratescontinuoustrajectorieswithanotionofphysical ifiedversionofapreviouslypublishedmodelofcellfatede-
time. MaBoSS uses two files for describing the model: the cision processes in response to death receptor engagement
BNDfilewhichcontainstheinformationabouttheBoolean and the effect of a TNF treatment on these decisions, (2) a
network,andtheCFGfilewhichcontainsthesimulationset- cell cycle model for investigating the consequences of ge-
tings. netic perturbations in signaling, and (3) a simplified model
ofimmunecelldifferentiation. Foreachofthesemodels,we
PhysiBoSS framework.PhysiBoSSisanadd-onofPhysi- provide step-by-step procedures as supplementary materials
CellthatintegratesaMaBoSSengineinsideeachagent. This to build these models, which can be used as templates for
approach adds a new layer of description of the cell, with a anyotherproject. Inthetextbelow, wepresentandanalyze
specificBooleanmodelthatrepresentsthecell’sintracellular theexpectedbehaviorsforeachofthethreesamplemodelsto
signaling dynamics. The Boolean network can be the same serveasareferenceforself-learnersastheyworkthroughthe
forallthecellsorseparatenetworkscanbeassignedtoeach article and demonstrate the range of integrated model types
cell type. At each simulation step, the agent (cell) can col- thatcanreadilybebuilt. Thematerialsalsoincludeanaddi-
lectdifferentstimulithatmodifytheactivityofsomespecific tional improved version of a model of cell invasion already
nodes of the network (input nodes). Next, the MaBoSS en- published(9).
ginecomputesthemodeltrajectorythatcancausetheswitch
of the so-called phenotypic nodes (or output nodes). Those Cell fate model upon TNF treatment.Upon cell death
nodes can then trigger some specific cell actions (motility, receptor engagement, different phenotypes can be triggered
2 Rusconeetal. | BuildingmultiscalemodelswithPhysiBoSSdepending on the status of some cell components. Pro- of the distribution, and is explained in the supplementary
grammedcelldeath,throughnecroptosisorapoptosis,orsur- section S1.4). The next step consists in the mapping of the
vivalthroughtheNF-κBpathwaycanbeactivated. Aprevi- twomodels,describedbythreerules. Thefirstmappingrule
ously published Boolean model of the complex intertwined is an input rule, which describes the condition in which the
networks leading to these cell fates was used (10) and inte- TNF ligand in the vicinity of the cell will be able to acti-
gratedintoPhysiBoSS(2)tostudytheeffectofaTNFtreat- vatetheTNFinputnodeoftheintracellularmodel,thentrig-
mentonapopulationofinteractingcellsbyvaryingthetype gering downstream intracellular events. The next two map-
oftreatments(continuousvs. pulsating)andthecomposition pingrulesareoutputrules, connectingtheintracellularphe-
ofthepopulation(toexploretheefficacyofthetreatmentof notypestobehaviorsofthePhysiCellsimulation. Inthecell
aheterogeneouspopulation). Themodelpresentedhereisan fatemodel,therearethreeoutputs,twoofwhichcorrespond
improved version of the initially published one modified to to the two death phenotypes. The first output mapping rule
fittheevolutionofthetool. will link the Apoptosis node to the Apoptosis behavior,
which in PhysiCell is controlled by a fixed activation rate.
Analysis of the intracellular model.The intracellular model TobeuniquelycontrolledbytheApoptosisnode,wesetthis
considerstworeceptors,FasandTNF,andstudiesthecondi- rateto0whenthenodeisinactive,andtoaveryhighvalue
tionsthatleadtoeithersurvival(Survival),programmedcell (1e+6) when the node is active (thus ensuring the apopto-
death(Non_apoptotic_Cell_DeathorNonACD),orapoptosis sis is deterministically activated at the next PhysiCell time
(Apoptosis) (see Supplementary Materials, figure S9). With step). The second output mapping rule rule is similar for
MaBoSS(6), the proportion of the three cell fates can be the necrosis node (NonACD) which is linked to the activa-
quantifiedanddifferencesappearwithvaryinginitialcondi- tionratecontrollingthePhysiCellNecrosisbehavior. Fi-
tions or types of treatments: upon continuous TNF recep- nally, the last phenotype, Survival is left without any map-
toractivation,mostofthecells(95%)willtriggerapoptosis, ping, as it represents the complement of the two death phe-
whileasmallpopulationofcellswillactivateeithernecropto- notypes,soitcanbedescribedasaresistantphenotypetothe
sis(referredtoasnon-apoptoticcelldeathorNonACD)(3%) TNF treatment. Note that variations on this cell fate model
or NF-κB-driven survival (2%); when cells are treated in a exist where the NFkB pathway is linked to an autocrine se-
pulsatingmanner(every40hoursfor20hours), thesimula- cretion of TNF, which could create a feedback loop in our
tionofapopulationofindividualnon-interactingcellsshows model(11). Abriefdescriptionofhowtocreatethisbehavior
very little difference, even though, in contrast with the con- isdescribedinthesupplementary,sectionS3.8. Tosimulate
tinuoustreatment,attime100,allcellshaveundergoneapop- theTNFtreatmentintime,afunctionwasadded,controlled
tosis(FigureS11). byuserparameters. NotethatPhysiPKPD(12),arecentadd-
Thismodelcanalsosimulategenemutationsandtheimpact onofPhysiCell,alsofacilitatesthesimulationofmanytypes
theyhaveonthecellfatedistribution. Forexample,thedou- of treatment. For the prolonged TNF treatment, the param-
blemutantIKK++/cFLIP++showsashiftofphenotypesfol- etertreatment_durationwassetto11520minutes(8
lowingTNFtreatmenttoonlyobtainresistantcells,withNF- days),morethanoursimulationmaximaltime. InFigure1A,
κBfullyactive. itcanbeobservedthat,whilemostofthepopulationiskilled
either by apoptosis or necrosis on day 2, a resistant popula-
IntegrationoftheBooleanmodelinPhysiBoSS.Wheninte- tionemergesandleadstoalargeproliferatingpopulationon
grating a Boolean model into PhysiBoSS, there are several day8.
aspects to consider: (1) the time scales of the two models
Toreproducetheeffectofapulsatiletreatment,theparame-
which may require synchronization between the two scales,
ters treatment_duration and treatment_period
and (2) the connection between the Boolean intracellular
weremodifiedtosimulateatreatmentof2000minuteshap-
modelandtheagent-basedmodel.
pening every 3440 minutes. In Figure 1B, the size of the
Thesynchronizationofthetwotimescalesisadifficulttask
population of tumor cells decreases after each treatment.
as intracellular and extracellular events may not have the
Such treatments—if clinically validated—could potentially
same scales. The two parameters controlling timing are:
beusedtopreventtheformationofapopulationresistingthe
scaling and intracellular_dt. Since the standard
TNFtreatment,aswellastoreducethetoxicityofthetreat-
PhysiCell simulation time unit is in minutes, while the cell
ment.
fatemodel’sunitisinhours,thescalingparameterneeds
to be set to 60, thus converting the MaBoSS model unit to Finally, to explore more functionalities of PhysiBoSS, we
minutes. The second parameter specifies how often the cell alsoproducedaversionofthemodelaccountingfortheob-
agentsshouldexecuteandupdatetheirMaBoSSmodels. In served necrotic core of the tumor due to the lack of oxygen
this specific case, the asymptotic behavior of the system is (see supplementary materials, section S3.6), and describing
considered,whichisreachedafter24h,settingtheparameter the impact of IKK++ - cFLIP++ double mutations on the
intracellular_dt to 1440 min (24h = 1440min). To outcome of the treatment (supplementary materials, section
avoid having all our cells respond in synchrony to the TNF S3.7). By building this model from the original PhysiBoSS
treatment, we set the value of time_stochasticity, a intoPhysiBoSS2.2,weshowedthatonlyafewsimplesteps
parameter responsible for producing slightly different peri- are now needed, allowing a much wider user base to build
odic updates, to 0.5 (this parameter describes the deviation complexmodelseasily. Acompletedescriptionofthesteps
Rusconeetal. | BuildingmultiscalemodelswithPhysiBoSSFig.1.SimulationofthecellfatemodeluponTNFtreatment,att=2,4,8days.A)MaBoSSsimulationofaprolongedandcontinuousTNFtreatment.B)MaBoSSsimulation
ofpulsesofTNFtreatment.
necessary to build this model is available in the supplemen- of the model to decide which nodes would be responsible
tary,sectionS3. for the switch between cell cycle phases. The analysis was
doneusingMaBoSS(6)andincludedinaJupyterNotebook
Boolean cell cycle model.The cell cycle is a complex where we simulated the wild-type model with different ini-
system, controlled by cyclins and cyclin-dependent kinases tial conditions, and mutants (see supplementary materials,
(CDKs) which act as checkpoints to ensure that the neces- Cell_cycle_boolean_analysis.pdf).
sarystepsareperformedandthecyclecanprogress. Theloss
Themodelanalysisshowsaninterplaybetweencomponents
of control in proliferation is one of the hallmarks of cancer,
ofthecellcycleandtheapoptoticpathway, highlightingthe
whichmaybeduetosomealterationsinthesignalingpath-
roleofCasp3,aread-outofcelldeath,whichspontaneously
waysthatleadtothetranscriptionofcellcyclegenes. Physi-
andgraduallygetsactivatedafterseveralcycles. Themodel
Cell however represents this cycle as a straightforward pro-
canreproducethesequentialactivationofthecyclins:Cyclin
cess,whereeachphasehasafixedtransitionrate,andnosig-
E,CyclinA,andCyclinB,andtheiroscillationuntilCasp3
nalingisinvolvedtoperturbit.Withthisexample,wewanted
getsfullyactivated.However,weobservedthatthissequence
tointegratewithPhysiBoSSamorerealisticcellcyclemodel
isnotalwayspreservedandcanleadtoanincompletecellcy-
and show how we can reproduce the effect of known muta-
cle,suchasCyclinEandCyclinAactivationnotfollowedby
tions. To this end, we used a published Boolean model of
aCyclinBactivation. Ananalysisofthetransitionsbetween
thecellcyclefromSizeketal.(13)asanintracellularmodel,
phases is also available in the Jupyter notebook mentioned
andlinkedittothetransitionsbetweenthedifferentphasesto
above.
controltheprogressionofthePhysiCellcellcycle.
The initial model reported published mutations and repro-
Analysis of the model.In their work, Sizek and colleagues ducedtheirphenotypes,whichwerethenconfirmedwiththe
builtaBooleanmodelthatreproducesthecellcycleprogres- MaBoSSsimulations(seeCell_Cycle_Analysisnote-
sion, including apoptosis and growth signals. The model bookinsupplementary).Amongthesemutations,wefocused
is composed of 87 nodes and captures PI3K/AKT1 activ- ontheroleofPLK1,FOXO3,p110,andPI3K.Thelossfunc-
ity during the cell cycle and its role in the deregulation tionofPLK1(PLK1nodeissetto0)leadstoanoveractiva-
of PLK1 and FOXO3. The perturbations can lead to dif- tion of Cyclin B, indicating that the cells may be stuck in
ferent cell fates such as G2 arrest characterized by a sus- the G2 phase, with no observed apoptosis. A knock-out of
tainedactivityofCyclinB,ormitoticcatastrophecausedby FOXO3(Foxo3nodeissetto0)leadstoafailureofcytoki-
Casp2 activation during mitosis. To integrate the Boolean nesis. Inthiscondition,mostcellsareunabletoseparatethe
network into PhysiBoSS, we first performed some analysis cytoplasmandtocompletedivision. Somewillstartapopto-
4 Rusconeetal. | BuildingmultiscalemodelswithPhysiBoSSFig.2.SimulationoftheSizekcellcyclemodel.A)Wild-typesimulationatbothtime0andafter96simulatedhours.B)Knock-inofp110inactivatestheapoptosispathway
whichincreasesthegrowthrateofthepopulation,with520cellsafter96hoursvs.310cellsinWildTypecondition.C)FoxO3knock-outsimulationslowsdownthecellcycle,
diminishingthenumberofcelldivisions,with22cellsafter48simulatedhours.D)Plk1knock-outsimulationcausesthemajorityofcellstobestuckinG2/Mphase.Allthe
simulationswereexecutedwithavalueofscalingof37.5andintracellular_dtof2.5
sis, while the majority of them will stay in this failed state and G2M_entry. The state of these nodes is determined by
(characterizedbynoneofthecyclinsnodesbeingactive). Fi- the activity of one or more Cyclins: CyclinD1 and CyclinA
nally, theknock-inmutationofp110(p110nodeissetto1) control the G0G1_entry, CyclinA and CyclinE control the
showsanincreaseintheactivityofAKTleadingtoadecrease S_entryandfinallyCyclinBcontrolstheG2M_entry. Thein-
intheactivityoftheapoptosispathway. troduction of these three read-out nodes does not affect the
behaviorofthenetworkbutprovidesasingleBooleannode
Amongthein-builtcellcyclemodelsproposedbyPhysiCell,
foreachtransitionbetweenthethreephases.
weselectedoneofthesimplest,theFlowCytometrymodel,
composedof3phasesand3rates. Inthismodel,acellstarts
Integration of the Boolean model in PhysiBoSS.To include
atthedefaultphase"G0G1"andentersthecellcyclewitha
theSizekmodelinPhysiBoSS,wefocusonthetwoparam-
rater01toreachthe"S"phase. Fromthe"S"phase,itmoves
etersthatcontrolthetimesynchronizationandthemapping.
tothe"G2M"phasewitharater12. Finally,thecelldivides
Tosynchronizethetimebetweenthetwomodels,westarted
andreturnstothe"G0G1"phaseatarater20.
by considering a cell cycle duration of 24 hours. Since a
WithPhysiBoSS,itispossibletoassociatethetransitionrates fullcellcycleinMaBoSSisachievedin24unitsoftime,we
of a cell cycle phase, to the state of a node of the Boolean proceededtosetthescalingvalueto60,similartowhatwas
model. To facilitate this pairing, we included in the Sizek done with the previous TNF model. However, this choice
model three phenotypic nodes that match the three transi- did not result in a 24-hour cell cycle, but a longer one of
tions of the Flow Cytometry model: G0G1_entry, S_entry 39 hours, partially due to the incomplete cycles mentioned
Rusconeetal. | BuildingmultiscalemodelswithPhysiBoSSin the previous section. To fix this, we calculated a correc- PhysiBoSS, it is possible to consider interactions among
tion for the scaling factor, setting it to 40 and reproducing severalcelltypeswithdifferentintracellularmodels. Inthis
the expected cellular behaviors (see supplementary materi- example,weshowcaseasimplemodelofcelldifferentiation,
als, section S4.2). The time interval is set to a small value whereacellofaspecifictypecantransitionintoadifferent,
(intracellular_dt=1min)since,contrarytothepre- user-defined cell type. Moreover, we demonstrate how
viousmodel,hereitisimportantinthismodeltocapturetran- different signals (diffusible chemical factors, type-specific
sienteffects. Themodeldoesnottakeintoaccountenviron- contacts)canbeusedasinputstoregulatekeycellbehaviors.
mental conditions, making irrelevant the mapping of input Themodelencompassessixdifferentcelltypesandrelieson
nodes. However, it is possible to specify in the intracellu- twodifferentBooleanmodels.
lar configuration the initial state of the inputs of the model,
such as the node Trail (death signal) or GF (growth factor).
We proceeded to connect the previously defined phenotype Analysisoftheintracellularmodels.TheBooleanmodelfor
nodes to the corresponding behaviors, associated with the cell differentiation is adapted from a previously published
controls of the cell cycle transition rates. The S_entry node model of Corral-Jara and colleagues (14), which describes
is connected to the behavior Cycle entry, G2M_entry theprocessesofTcelldifferentiation. Themodelisbasedon
to exit from cycle phase 1, G0G1_entry to exit experiments performed on naive CD4+ T cells (referred to
from cycle phase 2. Finally, the node Casp3 is con- asT0),whichdependingupontheeffectofexternalstimuli,
nectedtothebehaviorapoptosiswhichconcretelymod- can differentiate into either a Type 1 helper cell (Th1), a T
ifiestherateofactivationoftheapoptoticdeathmodel. The helper17cell(Th17),oraregulatoryTcell(Treg). Notethat
basalvalueofalltheratesissetto0. Whenoneofthenodes Corral-Jara’s model has been designed in GINsim software
regulating the phenotype is activated, the transition rate is insuchawaythatsomenodesaremulti-valuedtorepresent
fixed to a very high value (1e+6) to immediately trigger the different levels of activation. MaBoSS does not allow dis-
phaseswitchortheapoptoticdeath. Whenthenodeisinhib- crete levelsand all multi-valued nodesare Booleanized into
ited,itrestoresthebasalvalueofthetransitionrate. twovariables,e.g.,MHCCIIhasbeensplitintotwovariables
The initial population of the PhysiBoSS simulations are set MHCII_b1, MHCII_b2. We also use a simple phenomeno-
to 13 cells (agents) growing to 310 in 96 hours (Figure2A). logical model for dendritic cells with a small set of nodes
Thephasesfollowaproperorderinindividualcells,butnot to describe their behavior. The model (Figure S24) encom-
all cells are in the same phase of the cycle as expected in a passesatotalof4nodes,ofwhich3inputs(Maturation,Con-
desynchronizedpopulationofcells. tact, CCL21) and 1 phenotype node (Migration). A more
We further tested the impact of mutations at the population complexmodelcanlaterreplacethissimplemodel.
level,byselectingtheappropriatenodetomutateandassign- Inthismodel,underthechemoattractanteffectoftheCCmo-
ing it a value of 0 (knock-out) or 1 (knock-in). The mu- tif chemokine ligand 21 (CCL21), a cytokine constitutively
tant p110 overexpressed (p110 nodes fixed to 1) results in expressed in secondary lymphoid organs (such as lymph
decreasing the apoptosis with a consequent increase of the nodes), apopulationofmaturedendriticcells(mDCs)isat-
proliferationrate,bringingthefinalnumberofcellsafter96 tractedtowardsthedraininglymphnode. Concretely,theac-
hours from 13 to about 520 (Figure 2B). Next, we tested tivation of the node CCL21), when the node Maturation is
FoxO3 knock-out (Foxo3 node fixed to 0). The simulations alreadyactive,activatesthenodeMigration.
show that the cells go through one cell cycle before either mDCsexpressasetofligandscapableoftriggeringthedif-
dying or slowing down the proliferation. The cells are not ferentiationoftheT0cellpopulationinto3differentsubsets
arrestedinaspecificphaseofthecycle,buttheykeepprolif- of CD4+ T cells, once in the lymph nodes. Among these
eratingataverylowrate(Figure2C).Finally,Plk1knock-out ligands, we can cite Interleukin-12 (IL-12), Interleukin-1β
(Plk1 node fixed to 0), as expected from the MaBoSS anal- (IL-1β),andothercytokinesasInterleukin-6(IL-6)orTrans-
ysis, causes the majority of the cells to get stuck in G2/M forming growth factor beta (TGF-β). We chose not to in-
phase,inacellcyclearrest(Figure2D). clude all those nodes in our mDC model and just represent
In conclusion, the multiscale model of a detailed molecular them by a single node Contact. The activation of this node
descriptionofthecellcyclereproducesthecomplexityofthe turnsoffthemigrationofthemDCs.WithintheCorral-Jara’s
cell cycle at the single and multicellular level, allowing not MaBoSS model, these ligands’ nodes are already present as
only the modification of the duration of the cell cycle but inputnodes. TheCD4+Tcellmodelincludes3mastertran-
alsotherealizationofmutationsandtheexplorationmultiple scription factors considered as markers of differentiated T
initial conditions (corresponding different extracellular con- cells: RORgt(Th17), FOXP3(Treg)andTbet(Th1). Based
texts). Somephenotypeswerenotobservablewiththeintra- on these nodes, we built three phenotype nodes (Th1, Treg,
cellularmodelonly,suchastheslowingdownofthecycles, andTh17),usedlaterasoutputnodes,tobetterrepresentthe
but could be observed with the PhysiBoSS model. A com- differentcelltypes. Therelativelogicalequationshavebeen
pletedescriptionofthestepsnecessarytobuildthismodelis constructedtoavoidoverlapbetweenphenotypessothateach
availableinthesupplementary,sectionS4. oneismutuallyexclusive.
The model has been tested for mutants, to search for possi-
Immune cell differentiation.The examples previously bletargetsthatcaninfluencetheprobabilityofdifferentiation
presentedassumedthatallcellswereofthesametype. With forthethreecelltypes. Thosemutants,introducedatthebe-
6 Rusconeetal. | BuildingmultiscalemodelswithPhysiBoSSFig.3.SimulationoftheTcelldifferentiationmodelin2and3dimensions.A)InitialpopulationofTcell(gray),withanendothelialcell(pink)secretingCC21.Apopulation
ofdendriticcells(blue)isattractedtowardsthesourceofCCL21.B)Uponcontact,thedendriticcellstriggerthereceptorsofthenaiveTcell,whichstartthedifferentiation
processaccordingtotheoutputsoftheintracellularmodel,intoTreg(red),Th1(yellow),andTh17(green). C)SimulationoftheTcelldifferentiationwithNFkBknock-out,
resultinginonlyTreg.D)SimulationoftheTcelldifferentiationwithFOXP3knock-out,resultinginonlyTh1andTh17.
ginningofthesimulation,shouldnottriggerimmediatelythe sented above into PhysiBoSS, two intracellular models are
differentiationoftheT0cell,butratherhaveanimpactonthe createdforthenaiveTCellsandthedendriticcells(seesup-
differentiation process after contact with the mDC. Among plementary materials, Figure S25 and S26). The other cell
the mutants, we found some cells differenting into Treg ex- typesareconsideredasagentswithnointracellulardescrip-
clusively: (inhibitionsofAPI,NFKB,LCK,TCR,RAS,ITK, tion. As for the TNF example, the asymptotic behaviors of
ERK,cFOS,cJUN,orIKK),intoamixofTh1andTh17: in- boththenaiveTcellanddendriticcellareconsidered. Based
hibitionofIL1RAP,IL1R1,IL1R,FOXP3_2,oractivationof ontheMaBoSSsimulations,thetwoparameters,scaling
MINA);andamixofTregandTh17(inhibitionSTAT1,Tbet, andintracellular_dtaresetto1(defaultvalue)and6
or PLCG). We also investigated the effect of modifying the (standardphenotypetimestepofPhysiCell),respectively.
activationrateparameters,tocontrolmorefinelythepropor- Forsimplicity,wecreatedonesingleendothelialcellsecret-
tionsofTreg,andfoundthat,forexample,theactivationrate ingCCL21,locatedinanarearepresentingthelymphnode.
ofNFKBcanbeloweredtoincreasetheproportionofTreg, We also created a population of T0 cells in the same area,
while the activation rate of FOXP3_2 can be lowered to re- aswellasadistantpopulationofdendriticcells(Figure3A).
duce their proportion (See supplementary materials, section TheinitialstateofthePhysiBoSSsimulationassumesthatthe
S5.4). dendriticcellsaremature, aconditioninwhichtheyareex-
pressingCCR7,areceptorthatdrivesthemigrationofmature
Integration of the Boolean models in PhysiBoSS.In this DCs(mDCs)towardssecondarylymphoidstructures(i.e.,the
model, there are several different cell types: naive T cells
lymphnodes).Wethencreatedoneinputmappingintheden-
(T0), dendritic cells, type 1 helper cells (Th1), T helper 17 driticcells,linkingthesubstrateCCL21tothenodeCCL21.
cells, regulatory T cells, and finally lymphoid endothelial
UponactivationoftheCCL21nodewithintheDCnetwork,
cells. For the integration of the two Boolean models pre-
Rusconeetal. | BuildingmultiscalemodelswithPhysiBoSSmDCsmovetowardsthesourceofCCL21,followingitsgra- a model from existing templates. These improvements are
dientcombinedwitharandomwalk.Onceinthelymphnode, important both to the new users discovering the framework,
theDCmoveswitharandomwalk,ashypothesizedin(15). andalsotospeedupthedevelopmentofmodelsbyexisting
To achieve this, we used the rules’ mechanism described in users. For some specific functionalities which still require
(8) and created a rule where the stochasticity of the chemo- writing code, such as the mechanisms regulating drug
taxisisdependentonthequantityofCCL21, creatingasat- treatments,newadd-onsofPhysiCellarebeingdevelopedto
uratingeffectthatprogressivelylowersthemigrationbiasas simplifytheiraccessibility.
theCCL21quantityincreases. While simple, we believe that the three models presented
When mDCs and T0 cells are in contact, the differentiation herecoverenoughfunctionalitiestogiveagoodoverviewof
processofnaiveTcellsistriggered. ThemDCssecretema- PhysiBoSS and provide broad examples to start from. We
jor cytokines that are essential to mediate first the contact are providing in the supplementary materials a step-by-step
betweenDCsandT0cells(asetconsistingofIL-12, IL-1β, guide for installing PhysiBoSS and PhysiCell Studio, and
IL-6, TGF-β, and IL-23), and then to trigger the cascades for building these models to allow newcomers to follow the
leading to the three subsets of differentiated T cells, Th1, processofcreatingthem. Theexampleofcancerinvasionin
Th17, and Treg. For the sake of simplicity, instead of al- the supplementary shows a better real-world example, and
lowingeachagentrepresentingadendriticcelltoreleasecy- itscomparisonwiththeoriginalmodelsshowsthesimplicity
tokines,weencodedsuchinteractionsbyactivatingtheinput andpowerofthemappingsystem.
corresponding to the cytokines within the T0 model. To do
this, we created many input mappings that connect the con- Integratingbiologicaldataintothesemodelsisthenextlogi-
tact of the dendritic cell with a T0 to the activation of the calstepforthemtogobeyondtoymodels. Differenttypesof
inputnodescorrespondingtothecytokinesthatarereleased datacanbeusedtoaddressthedifferentpartsofthemodel:
by the dendritic cells. In addition to the above-mentioned spatial data (spatial transcriptomic, multiplex immunofluo-
listofcytokines,inputnodestriggereduponcontactbetween rescence, ...) can be used for reproducing the disposition of
dendritic cellsand T0 include also: MHCII_b1, MHCII_b2, the cell in the tissue (8). Single-cell expression data can be
CD80,CD4andPIP2. Theactivationofthesenodesisnec- used to infer cell-cell communication (16), and to person-
essary to trigger the differentiation into Th1, Th17 or Treg alize the intracellular model (17). Finally, many physical
(Figure3.B).Toachievethis,weaddedthreeoutputmapping parameters could be obtained using time-lapse microscopy
rules, linking the transformation into these cell types to the data. However,tuningtheseparameters,evenwithappropri-
phenotypenodesTh1,Th17,Tregpresentedpreviously.None atedatasets,wouldstillbeadifficultendeavor. Inthisarticle,
ofthesenewcelltypeshaveanintracellularmodel, soupon we did not want to put too much emphasis on this, but it is
differentiation, they lose all the T0 properties. This choice a real challenge that may be addressed with machine learn-
wasmadetoallowtheimplementationofspecificbehaviors ing approaches. New methods are needed in this field, and
forthedifferentTcelltypesinfutureversionsofthePhysi- we believe the use of surrogate models (18, 19) will prove
BoSSmodel. itself fundamental. Despite these challenges, the improve-
We also included variants of this model representing the ef- mentsinPhysiBoSSpresentedherewillfacilitatetheuseof
fect of two of the Th0 mutants described in the previous multiscale modeling and allow a larger community of users
section: the knock-out of NFKB, leading to a differentia- toapplythesetoolstotheirquestions.
tion exclusively in Treg (Figure 3.C), and the knock-out of
FOXP3_2, leading to a complete absence of differentiation
Competing interests
inTreg(Figure3.D).Wealsoshowedtwoothervariantswith
loweractivationratesofthesetwonodes(FigureS27.Band Nocompetinginterestisdeclared.
D), representing an incomplete inhibition. These examples
showed how PhysiBoSS can describe the pharmacological
Author contributions statement
control of T-cell differentiation. A complete description of
thestepsnecessarytobuildthismodelisavailableinthesup- M.R., V.N., R.H., L.C. developed the new PhysiBoSS func-
plementary,sectionS5. tionalities. M.R., A.C., L.C., V.N. developed the models.
E.B., P.M., L.C. and V.N. supervised the project. M.R.,
A.C., R.H., E.B., P.M., L.C., V.N. wrote and reviewed the
Discussion
manuscript.
Inthispaper,wepresentednewfunctionalitiesofPhysiBoSS,
which are drastically simplifying the process of creating
Funding
models. We show that using the new mapping system, we
can now easily connect the agent-based model to Boolean M.R.,L.C.andV.N.werepartiallyfundedbythePerMedCoE
intracellularmodels. projectwhichispartoftheEuropeanUnion’sHorizon2020
While the previous version of PhysiBoSS required knowl- research and innovation program under the grant agreement
edge in C++ programming to allow the creation of models, n951773,andbytheCertaintyprojectwhichispartoftheEu-
withthisnewversiontheusercancompletelyrelyonPhysi- ropeanUnion’sHorizonEuroperesearchandinnovationpro-
Cell Studio, the graphical interface of PhysiCell, to build gram under Grant agreement n101136379. M.R., L.C. and
8 Rusconeetal. | BuildingmultiscalemodelswithPhysiBoSSV.N. work also received funding from the Inserm amorçage
19. HeberL.Rocha,JoãoVitordeO.Silva,RenatoS.Silva,ErnestoA.B.F.Lima,andReginaC.
project. R.H. and P.M. received funding from the National Almeida.Bayesianinferenceusinggaussianprocesssurrogatesincancermodeling.Com-
puterMethodsinAppliedMechanicsandEngineering,399:115412,2022.ISSN0045-7825.
Science Foundation (Awards 1720625 and 2303695), the
doi:https://doi.org/10.1016/j.cma.2022.115412.
National Institutes of Health (U01-CA232137-01), and the
JayneKoskinasTedGiovanisFoundationforHealthandPol-
icy. A.C,L.C.andV.N.werepartlysupportedbyModICeD
projectfromMICITMO2020.
Acknowledgments
We thank John Metzcar for testing PhysiBoSS implementa-
tionandFurkanKurtogluandArnauMontagudforthefruit-
fuldiscussionaboutPhysiBoSSmapping.
Bibliography
1. JohnMetzcar,YafeiWang,RandyHeiland,andPaulMacklin.Areviewofcell-basedcom-
putationalmodelingincancerbiology.JCOclinicalcancerinformatics,2:1–13,2019.
2. GaelleLetort,ArnauMontagud,GautierStoll,RandyHeiland,EmmanuelBarillot,Paul
Macklin,AndreiZinovyev,andLaurenceCalzone. PhysiBoSS:amulti-scaleagent-based
modellingframeworkintegratingphysicaldimensionandcellsignalling.Bioinformatics,35
(7):1188–1196,April2019.ISSN1367-4803.doi:10.1093/bioinformatics/bty766.
3. MiguelPonce-deLeon,ArnauMontagud,VincentNoël,GerardPradas,AnnikaMeert,Em-
manuelBarillot,LaurenceCalzone,andAlfonsoValencia.PhysiBoSS2.0:asustainablein-
tegrationofstochasticBooleanandagent-basedmodellingframeworks,April2022.Pages:
2022.01.06.468363Section:NewResults.
4. AhmadrezaGhaffarizadeh,RandyHeiland,SamuelH.Friedman,ShannonM.Mumen-
thaler,andPaulMacklin. PhysiCell:Anopensourcephysics-basedcellsimulatorfor3-D
multicellularsystems.PLOSComputationalBiology,14(2):e1005991,February2018.ISSN
1553-7358.doi:10.1371/journal.pcbi.1005991.Publisher:PublicLibraryofScience.
5. GautierStoll,EricViara,EmmanuelBarillot,andLaurenceCalzone. Continuoustime
booleanmodelingforbiologicalsignaling:applicationofGillespiealgorithm.BMCSystems
Biology,6(1):116,August2012.ISSN1752-0509.doi:10.1186/1752-0509-6-116.
6. GautierStoll,BarthélémyCaron,EricViara,AurélienDugourd,AndreiZinovyev,Aurélien
Naldi,GuidoKroemer,EmmanuelBarillot,andLaurenceCalzone. MaBoSS2.0: anen-
vironmentforstochasticBooleanmodeling. Bioinformatics,33(14):2226–2228,July2017.
ISSN1367-4803.doi:10.1093/bioinformatics/btx123.
7. RandyHeiland,DanielR.Bergman,BlairLyons,JulieCass,HeberL.Rocha,MarcoRus-
cone,VincentNoël,andPaulMacklin. Physicellstudio: agraphicaltooltomakeagent-
basedmodelingmoreaccessible.Gigabyte,2024.doi:10.46471/gigabyte.128.
8. JeanetteAIJohnson,GenevieveLStein-O’Brien,MaxBooth,RandyHeiland,FurkanKur-
toglu,DanielBergman,ElmarBucher,AtulDeshpande,AndreForjaz,MichaelGetz,etal.
Digitizeyourbiology! modelingmulticellularsystemsthroughinterpretablecellbehavior.
bioRxiv,pages2023–09,2023.
9. MarcoRuscone,ArnauMontagud,PhilippeChavrier,OlivierDestaing,IsabelleBonnet,
AndreiZinovyev,EmmanuelBarillot,VincentNoël,andLaurenceCalzone.Multiscalemodel
ofthedifferentmodesofcancercellinvasion.Bioinformatics,39(6):btad374,2023.
10. LaurenceCalzone,LaurentTournier,SimonFourquet,DenisThieffry,BorisZhivotovsky,
EmmanuelBarillot,andAndreiZinovyev. MathematicalModellingofCell-FateDecisionin
ResponsetoDeathReceptorEngagement.PLOSComputationalBiology,6(3):e1000702,
March2010.ISSN1553-7358.doi:10.1371/journal.pcbi.1000702.Publisher:PublicLibrary
ofScience.
11. GautierStoll,AurélienNaldi,VincentNoël,EricViara,EmmanuelBarillot,GuidoKroemer,
DenisThieffry,andLaurenceCalzone. Upmaboss: Anovelframeworkfordynamiccell
populationmodeling. FrontiersinMolecularBiosciences,9,2022. ISSN2296-889X. doi:
10.3389/fmolb.2022.800152.
12. DanielBergman,LaurenMarazzi,MuktiChowkwale,SupriyaBidanta,TarunenduMapder,
JialunLi,etal.Physipkpd:Apharmacokineticsandpharmacodynamicsmoduleforphysi-
cell.Gigabyte,2022,2022.
13. HerbertSizek,AndrewHamel,DávidDeritei,SarahCampbell,andErzsébetRavaszRegan.
Booleanmodelofgrowthsignaling,cellcycleandapoptosispredictsthemolecularmech-
anismofaberrantcellcycleprogressiondrivenbyhyperactivePI3K.PLOSComputational
Biology,15(3):e1006402,March2019.ISSN1553-7358.doi:10.1371/journal.pcbi.1006402.
Publisher:PublicLibraryofScience.
14. Karla Fabiola Corral-Jara, Camille Chauvin, Wassim Abou-Jaoudé, Maximilien Grand-
claudon,AurélienNaldi,VassiliSoumelis,andDenisThieffry. InterplaybetweenSMAD2
andSTAT5AisacriticaldeterminantofIL-17A/IL-17Fdifferentialexpression. Molecular
Biomedicine,2(1):9,April2021.ISSN2662-8651.doi:10.1186/s43556-021-00034-3.
15. IvanAzarov,KirillPeskov,GabrielHelmlinger,andYuriKosinsky.Roleoftcell-to-dendritic
cellchemoattractionintcellpriminginitiationinthelymphnode:anagent-basedmodeling
study.Frontiersinimmunology,10:443009,2019.
16. DanielDimitrov,PhilippSvenLarsSchäfer,EliasFarr,PabloRodriguezMier,Sebastian
Lobentanzer,AurelienDugourd,JovanTanevski,RicardoOmarRamirezFlores,andJulio
Saez-Rodriguez.Liana+:anall-in-onecell-cellcommunicationframework.BioRxiv,pages
2023–08,2023.
17. JonasBéal,ArnauMontagud,PaulineTraynard,EmmanuelBarillot,andLaurenceCal-
zone.Personalizationoflogicalmodelswithmulti-omicsdataallowsclinicalstratificationof
patients.Frontiersinphysiology,9:369984,2019.
18. RichardJPreen,LarryBull,andAndrewAdamatzky.Towardsanevolvablecancertreatment
simulator.Biosystems,182:1–7,2019.
Rusconeetal. | BuildingmultiscalemodelswithPhysiBoSS
BrainSLAM: SLAM on Neural Population Activity Data
KippFreud NathanLepora
UniversityofBristol UniversityofBristol
Bristol,UnitedKingdom Bristol,UnitedKingdom
km14740@bristol.ac.uk n.lepora@bristol.ac.uk
MattW.Jones CianO‚ÄôDonnell
UniversityofBristol UlsterUniversity
Bristol,UnitedKingdom Derry/Londonderry,UnitedKingdom
Matt.Jones@bristol.ac.uk C.ODonnell2@Ulster.ac.uk
ABSTRACT isformed,itcanbereactivatedwhenananimalsubsequentlyenters
Simultaneous localisation and mapping (SLAM) algorithms are thesameenvironmentandupdatedusinginformationfromnew
commonlyusedinroboticsystemsforlearningmapsofnovelenvi- experiencesthatoccurinthatenvironment.Whenfamiliarroutes
ronments.Brainsalsoappeartolearnmaps,butthemechanismsare to a goal are blocked, use of the cognitive map enables naviga-
notknownanditisunclearhowtoinferthesemapsfromneural tionthroughalternativepathsbecauseinformationaboutnovel(i.e.
activitydata.WepresentBrainSLAM;amethodforperforming neverbeforetraveled)routesisincludedinasinglerepresentational
SLAMusingonlypopulationactivity(localfieldpotential,LFP) structureoftheenvironment.
datasimultaneouslyrecordedfromthreebrainregionsinrats:hip- Evidencesupportingthecognitivemaphypothesiswaspresented
pocampus,prefrontalcortex,andparietalcortex.Thissystemuses in[20].Here,researchersrecordedrodenthippocampalactivityas
aconvolutionalneuralnetwork(CNN)todecodevelocityandfa- theseanimalsmovedfreelyinanenvironment.Analysisofthe
miliarityinformationfromwaveletscalogramsofneurallocalfield gathered data showed the presence of place cells; hippocampal
potentialdatarecordedfromratsastheynavigatea2Dmaze.The cellswithfiringratesmodulatedbythelocationoftheanimal.The
CNN‚ÄôsoutputdrivesaRatSLAM-inspiredarchitecture,poweringan firingratesofeachcellincreaseddramaticallywhentheanimal
attractornetworkwhichperformspathintegrationplusaseparate wasmovingthroughaspecificregionofanenvironment,known
systemwhichperforms‚Äòloopclosure‚Äô(detectingpreviouslyvisited astheplacefieldofthatcell[21].Furtherresearchhasdiscovered
locationsandcorrectingmapaliasingerrors).Together,thesethree manyothertypesofspatiallysensitiveneuronwhicharebelieved
componentscanconstructfaithfulrepresentationsoftheenviron- toformthebasisofthecognitivemap[6].
mentwhilesimultaneouslytrackingtheanimal‚Äôslocation.Thisis Thoughtheconceptofaninternalcognitivemaphasbeenex-
thefirstdemonstrationofinferenceofaspatialmapfrombrain ploredinmuchdetail[25],noalgorithmshaveyetbeenpresented
recordings.OurfindingsexpandSLAMtoanewmodality,enabling whichattempttoinferanexplicitrepresentationoftheinternal
anewmethodofmappingenvironmentsandfacilitatingabetterun- cognitivemapfromindividualanimalsorpeople.Theextractionof
derstandingoftheroleofcognitivemapsinnavigationanddecision suchrepresentationswouldbevaluablefortworeasons.First,these
making. representationswouldbeusefulforbothneurobiologyresearchand
bio-inspiredcontrol.Forexample,wecouldexaminetowhatextent
KEYWORDS thenavigationaldecisionsananimalmakesasitmovesthroughan
environmentcanbepredictedbyitsinferredcognitivemapofthat
NeuralDecoding;Mapping;SLAM;RatSLAM;DeepLearning;Bio-
environment.Thiswouldhelpusunderstandifandhowanimals
logicalRobots
usecognitivemapsfornavigation,testhowmapusevariesde-
ACMReferenceFormat: pendingoncontext,anddesigncontrolalgorithmsbasedonthese
Kipp Freud, Nathan Lepora, Matt W. Jones, and Cian O‚ÄôDonnell. 2024. observations.Secondly,methodswhichextractedcognitivemaps
BrainSLAM:SLAMonNeuralPopulationActivityData.InProc.ofthe
couldbeusedwithinbrain-computerinterfaces(BCIs)toprovide
23rdInternationalConferenceonAutonomousAgentsandMultiagentSystems
aninnovativeapproachforhumanstomapouttheirsurroundings.
(AAMAS2024),Auckland,NewZealand,May6‚Äì10,2024,IFAAMAS,7pages.
Bydecodingcognitivemapsfromneuraldata,wecouldbetterun-
derstandhowweinteractwithandperceiveourspaces,offering
1 INTRODUCTION
applicationsinareaslikevirtualreality,augmentedreality,and
Cognitivemapscanbeconceivedasspatialrepresentationswithin evenphysicalnavigationassistanceforthosewithimpairments.
thebrainthatarederivedacrossanynumberofindividualexpe- Simultaneouslocalisationandmapping(SLAM)istheproblem
riences.Suchspatialrepresentaitonswouldincludeinformation ofusinganagenttobuildamapofanunknownenvironmentwhile
aboutpathsnotdirectlytraveledbutthatcanbeinferredfromthe at the same time maintaining a location estimate of that agent
relationshipsamongexperiencedroutes[8].Onceacognitivemap asitmovesthroughthatenvironment.Therearemanyproposed
solutionstotheSLAMproblem[1],themajorityofwhichcanbe
Proc.ofthe23rdInternationalConferenceonAutonomousAgentsandMultiagentSystems
(AAMAS2024),N.Alechina,V.Dignum,M.Dastani,J.S.Sichman(eds.),May6‚Äì10,2024, summarizedasmethodsfortakingnoisydataencodingvelocity
Auckland,NewZealand.¬©2024InternationalFoundationforAutonomousAgents andlocationinformationandgeneratingmaps.
andMultiagentSystems(www.ifaamas.org).ThisworkislicencedundertheCreative
CommonsAttribution4.0International(CC-BY4.0)licence.
4202
beF
1
]OR.sc[
1v88500.2042:viXraThegoalofthisprojectwastouselocalfieldpotential(LFP)data Whileperformingthistask,datawascollectedfrom16chronically-
recordedfromthebrainsofratsastheynavigateda2Dmazeto implantedadjustabletetrodesplacedinthreedistinctbrainregions
performSLAM.LFPisameasureofthespatially-weightedaverage ofeachrat;dorsalCA1ofhippocampus(HPC),prefrontalcortex
ofelectricalpotentialintheextracellularspacearoundpopulations (PFC), and the parietal cortex (PC). LFP from each tetrode was
ofneuronsandtheirsynapticconnections[3].Thisdataisgathered sampledat2kHz,bandpassfilteredat0.5-475Hzandreflectsthe
usingintracranialtetrodesimplantedinthehippocampus.Notably, aggregateactivityofpopulationsofneuronsandsynapsesnearthe
LFPdatatakenfromthehippocampus,prefrontalcortex,andpari- tetrodetip[11].Theanimals‚Äôlocation,speed,anddirectiondata
etalcortex,suchasthatusedintheresearchpresentedhere,hasall wasalsocalculatedbytrackinghead-mountedLEDsat25Hz.
beenshowntoencodevelocityandlocationinformationtosomede- Headlocations,asmeasuredbyLEDs,werefirstprojectedonto
gree[2,19,26];thus,onemightexpectthatsomeSLAMalgorithms askeletonrepresentationofthemazetoreducenoisecausedby
maybeextendabletothisformofinput. headmovementsthatdonotrepresenttruemovementsthrough
Inthiswork,weproposeanovelapproachthatfacilitatestheuse themaze‚Äìforexample,aratmovingtheirheadfromlefttorightas
ofLFPdataasaninputtoSLAMsystems.Ourproposedsystemuses theytraveldownthecentralarmofthemaze.Thispreprocessing
adeepconvolutionneuralnetwork(CNN)topredictvelocityandlo- stepalsosimplifiedthedirectionestimationproblem,asitreduced
cationinformationfromLFPdata[5],andusesthesepredictionsto thesearchspaceofpossibledirectionstoonlythosewhichcanbe
poweraRatSLAMarchitecture[16]whichproducesgraphicalrep- travelledontheskeletonrepresentation(i.e.fourdirections,each
resentationsoftheenvironmentbeingexplored.Predictionsfrom ¬±10degreesof0‚ó¶,90‚ó¶,180‚ó¶,or270‚ó¶).Speedanddirectionvalues
theCNNareusedtotransformactivationwithina3-dimensional werecalculatedbyexaminingpositionchangeacrosstimesteps.
attractornetworkencodingpositionwithinanenvironment;path Location,direction,andspeedvaluesareallusedasoutputstotrain
integrationisperformedontheseestimatedpositionsandmapped thedeepneuraldecodingsystemdescribedinSection2.2.
toacorrespondingexperiencemaprepresentingourcurrentknowl- Following the approach described in [5], raw LFP data was
edgeoftheenvironmentbeingexplored.Aseparatesystemuses transformedusingawaveletdecompositiontogenerateathree-
locationfeaturesextractedfromtheconvolutionalnetworktoinfer dimensionalrepresentationdepictingtime,channels,andfrequency
uniquenessofthecurrentlocationanddetectwhentherodenthas bands[31].Forthewavelettransformation,weusedtheMorlet
returnedtoapreviouslyvisitedlocation;atwhichpoint,discrepan- wavelet:
ciesbetweencurrentestimatedlocationandthispreviouslyvisited ùúì(ùë°)=ùúã‚àí 41 exp(ùëñùúî 0ùë°)exp(‚àíùë°2/2), (1)
locationwillbeminimizedinourexperiencemaprepresentation, whereùë°istimeandùúî 0isanon-dimensionalfrequencyconstant(in
preventingaliasinginthesystem. ourcaseùúî 0=6).Additionally,channelandfrequency-wisenormal-
Weprovidevisualisationsoftheinferredcognitivemaps,show-
izationwasappliedusingamedianabsolutedeviationapproach.
ingthatoursystemiscapableofoutputtinghighfidelitygraphical
Medianandcorrespondingmedianabsolutedeviationvalueswere
mapsgivenonlyLFPdata.Suchvisualisationshaveneverbeen
calculatedforeachfrequencyandchannelinourdataset,andinputs
produced before, and represent a new path to researching how
werethennormalizedusing
cognitivemapsareformedinthebrain,whichbrainregionsare
necessary,andhowthesemapsreflectexperienceandaffectconse- ùëã ùëñ ‚Üê
ùëã
ùëñ
‚àíùëãÀÜ
ùëñ , (2)
quentbehaviour. median(|Xi‚àíXÀÜ i|)
whereùëãÀÜ
ùëñ
denotesthemeanactivityforchannelùëñ.Waveletimages
weregeneratedusing64subsequentLFPvalues,meaningeachim-
2 METHODS
agerepresented32msofrecordeddata.Thusforeach32mswindow,
2.1 Dataset&DataPreprocessing asetof16waveletimagesweregenerated:oneforeachtetrode
presentintherodent.
Thedataforthisprojectwasrecordedfromthebrainsof3adult,
Foreachsetofwaveletimagesgenerated,thereexistsinthe
maleLong-Evansratsnavigatingamemoryanddecision-making
datasetacorrespondinggroundtruthlocation,speed,anddirection
tasktofindsucroserewardsonamaze[7].Wenotethatallproce-
value.Asinglemazesessionconsistingof20-30minutesofactivity
dureswereperformedfrom2009-2010,andinaccordancewith
wasusedforeachrodent,withthefirst80%ofthedatacollectedfor
the UK Animals Scientific Procedures Act (1986) and approved
eachratusedtotrainthedeepneuraldecodingsystemdescribedin
bytheUniversityofBristolAnimalWelfareandEthicalReview
Section2.2,andthefinal20%usedbothastestingdataandasinput
Board.Thisdatahasbeenutilizedaspartofnumerousotherstudies
toourextendedRatSLAMsystemtogeneratethemapsshownin
[4,7,10,24].
Section3.2.
Theratshadtochoosebetweenleftandrightmazearmsbasedon
thedirectionofaninitialguidedturn(seeFigure1a).Animalswere
2.2 Deepneuraldecodingforodometryand
trainedinitiallyundera‚Äúmatchturn‚Äùrule(i.e.ifinitiallyforcedto
loopclosuremodules
turnright,turnrightagainatthechoicepoint,andviceversa).The
mazewasofdimension1.3m√ó1.7m,andthistaskwasdesigned In[5],ageneralizabledeeplearningframeworkispresentedforde-
toincorporatebothvisualdiscriminationandamemory-guided codingsensoryandbehaviouralvariablesdirectlyfromwide-band
responses.Ratsran15‚Äì25trialsper20-to30-minrecordingsession, neuraldata.Theapproachrequireslittleuserinputandgeneralizes
andeachtrialofthetaskconsistedofa‚Äòforced-turn‚Äôand‚Äòchoice‚Äô acrossstimuli,behaviours,brainregions,andrecordingtechniques.
epoch. ThisframeworkhasbeenshowntoachievestateoftheartresultsFigure1:Intheresearchpresentedhere,localfieldpotentialdatacollectedfromthedorsalCA1ofhippocampus(HPC),
prefrontalcortex(PFC),andtheparietalcortex(PC)ofrodentsastheycompletedasimplebehaviouraltaskwithinamaze
is transformed into wavelet decomposition images (a). This data is used to train a deep neural decoding system with 13
downsamplinglayersandseparatefullyconnectedlayersforeachoutput;thisnetworkpredictsbothodometryvalues(speed
anddirection)andlocation(b).Thesepredictionsareusedtoshiftactivationwithinacompetitive3Dattractornetwork,
poweringaRatSLAMarchitecturewhichproducesgraphicalrepresentationsoftheenvironmentbeingexplored(c).Panelc
adaptedwithpermissionfromMilfordandWyeth[14]
onneurallocalizationtasksusingMorletwaveletdecompositions Amodifiedversionofthearchitectureoriginallypresentedin[5]
ofLFPrecordingstakenfromtheCA1pyramidalcelllayerinthe isusedhere.Ourdeepconvolutionalnetworkusesonly13down-
hippocampus of freely foraging rodents, and is also capable of samplingtime-distributed(i.e.withsharedweightsacrosschannels)
accuratelydecodingheaddirectionandspeed.Wenotethatthis layersfollowedbytwofullyconnectedlayersforeachoutput.A
approachtodecodinghasbeenshowntobeversatiletomultiple kernelsizeof3wasusedthroughoutthemodel,andthenumberof
formsofinputincludingcalciumimagingdata[22],thusitisnatu- filterswaskeptconstantat64forthefirst10layerswhilesharing
raltoassumethatthemethodpresentedinthispaperwouldalso weightsacrossthechanneldimension,thendoublingthenumber
beversatiletotheseothermodalities. offiltersforthefollowing3layers.Fordownsamplingtheinput,
weusedastrideof2intermixedbetweenthetimeandfrequencydimension.Weused2D-convolutionswhichshareweightsacross 2.3.1 PoseCells. Theposecellmoduleisresponsibleformaintain-
the channel dimension for the first 10 convolutions and across inganestimateoftheagent‚Äôspositionwithintheenvironment;it
the time dimension for the last 3 convolutional layers. Sharing consistsofacompetitive3-dimensionalattractornetwork,with
weightsacrosschannelspreventsoverfittingtochannel-specific eachnoderepresentingapointonadiscretisedversionoftheen-
featuresandthusimprovesgeneralisationbymakingsurethere vironmentbeingexplored,withthedimensionsoftheattractor
existsaglobalrepresentationofimportantfeaturese.g.ofspikes networkrepresentingtheùë•,ùë¶,andùúÉ coordinates.
orotherprominentoscillationsinthelocalfieldpotential.Thefull Eachnodeinthisnetworkhasstrongexcitatoryconnectionsto
architectureofthenetworkusedispresentedinthesupplemental nearbynodes,andweakerinhibitoryconnectionstomoredistal
material. nodes.Globalinhibitionandnormalisationalsooccursatevery
Notably,asthissystemtakesminimally-processedinput,itisable timestep;encapsulatedbythefollowingactivationupdaterules,
toperformsensorydecodingwithoutspikesorting(acomputationally- calledinsequenceateverytimestep:
intensiveprocessfordetectingactionpotentialsandassigningthem
t to ios np ie nc fifi rec qn ue eu nr co yn bs a[ n9 d]) s. oN ue tc se ids esa or fil ty h, esp spik ike eso rart ni gn eg wdi hs ic ca hrd ps oi tn enfo tr iam lla y-
ùëÉ ùëñ‚Ä≤ ùëóùëò ‚ÜêùëÉ ùëñùëóùëò
+‚àëÔ∏ÅùëÅùë• ‚àëÔ∏ÅùëÅùë¶ ‚àëÔ∏ÅùëÅùúÉ
ùúñe (ùëéxc ‚àíùëñ)(ùëè‚àíùëó)(ùëê‚àíùëò)ùëÉ ùëéùëèùëê, (3)
introducesbiasesimplicitinthealgorithm.Also,asthesystemis
ùëé=0ùëè=0ùëê=0
v Se Lr Asa Mtil se yt so ted miff pe rr ee sn et nf to er dm hs eo refi mn ap yut a, li st ois bena et xu tr ea nl dt ao bt lh ei tn ok nt oh na -t Lt Fh Pe
ùëÉ ùëñ‚Ä≤ ùëóùëò ‚ÜêùëÉ ùëñùëóùëò
+‚àëÔ∏ÅùëÅùë• ‚àëÔ∏ÅùëÅùë¶ ‚àëÔ∏ÅùëÅùúÉ
ùúñi (n ùëéh ‚àíùëñ)(ùëè‚àíùëó)(ùëê‚àíùëò)ùëÉ ùëéùëèùëê, (4)
formsofneuralinput,forexampletwo-photoncalciumimaging
ùëé=0ùëè=0ùëê=0
data[29]. ùëÉ ùëñùëóùëò ‚Üêmax(0,ùëÉ ùëñùëóùëò ‚àíùúì), (5)
Separatenetworksweretrainedforeachratusingthetraining ùëÉ‚Ä≤ ‚Üê ùëÉ ùëñùëóùëò , (6)
wpo or rt kio sn wo ef rt ehe trd aa inta edge tn oe dra et ce od df ero lom caa tis oin ng ,l se pm eea dz ,e at nas dk ds ie rs es ci to in o. nN fe ot r- ùëñùëóùëò (cid:205) ùë•ùëÅ =ùë• 0(cid:205)ùëÅ ùë¶=ùë¶ 0(cid:205) ùëßùëÅ =ùúÉ 0ùëÉ ùë•ùë¶ùëß
1000epochswith250trainingstepsperepoch.Abatchsizeof8 whereexcitatoryweightsùúñexcaregeneratedusingathree-dimensional
wasused,aswasanAMSGradoptimizer[23]withalearningrate
discreteGaussiandistributionwithvariance1,inhibitoryweights
of7ùëí‚àí4.Thedecodingaccuracyofthefinishednetworksforeach
ùúñinharegeneratedusingathreedimensionaldiscreteGaussiandis-
consideredratareshownanddiscussedinSection3.1. tributionwithvariance2,andùúì isaglobalinhibitionconstant,in
Trainednetworksforeachratareusedfortwofunctionsinour ourcasesetto2ùëí‚àí5.WealsonotethattheùúÉ dimensioniswrapped,
extendedRatSLAMsystem:speed-anddirection-decodingfunc- withnodesnearthetopoftheùúÉ dimensionhavingconnectionsto
tionalityisusedasanodometrymoduleinthesystem(discussedin
thoseatthebottom.
Section2.3.2)andlocationdecodingfunctionalityisusedaspartof
Togetherthesepropertiesforcethenetwork‚Äôsactivitytocon-
aloopclosuremoduleinthesystemtoproduceasimilaritymetric
vergetoasingle3Dbump.Ifactivityisinjectedintothenetwork
whencomparingtwounitsofinput(discussedinSection2.3.3).
farfromtheexistingactivitybump,anewbumpwillbecreated
whichcompeteswiththeoriginal.Ifenoughactivityisinjected
intothisnewbump,itcanbecomedominantandtheoldbumpwill
2.3 RatSLAM disappear.
Wenoteherethatactivationisnotonlymodulatedbyinternal
RatSLAM[16]isanapproachtotheSLAMprobleminspiredby
dynamics,butcanalsobeinjectedintothenetworkviaexcitatory
computationalmodelsofthehippocampusofrodents;namely,the
connectionsfromlocalviewcells(discussedinSection2.3.2),and
conceptofplacefields[18]andtheirmodulationbytherodent‚Äôs
activationcanbemovedwithinthenetworkviainputfromthe
movement,visualstimuliorothersensoryinformation.Though
odometrymodule(discussedinSection2.3.3).
RatSLAMhasonlybeenshowntofunctionusingcamerainput,
Locationestimatesarefoundbycalculatingthecenterofactiva-
inprincipleitcouldbeextendedtoacceptanyformofinputthat
tionwithinthisposecellnetwork:thisisthemeanofactivation
fulfilstwoconditions:first,itmustbepossibletoinfervelocity
locationsinthenetwork,weightedbytheactivationateachloca-
frominput(orbycomparingsubsequentinputs);second,itmust
tion.
bepossibletoexaminepairsofinputsandproduceafamiliarity
score,givingameasureofconfidencethatthetwoinputsignals 2.3.2 ViewCells. IntheoriginalRatSLAMsystem,localviewcells
arosewhiletheagentwasinthesamelocation.Herewepresenta eachrepresentadistinctsceneobservedbytheagentasittraverses
modifiedRatSLAMsystemthatachievesgoodresultsusingonly theenvironmentbeingexplored.Whennewimagedataisprocessed,
localfieldpotentialdata. itisfirstexaminedbytheviewcellmoduletoseeifthedatais
TheRatSLAMsystemrepresentsanagentsposebytheactivity similarenoughtopreviouslyobserveddata.Ifsimilarityisabovea
inacompetitive3-dimensionalattractornetworkcalledthepose certainthreshold,theviewcellcorrespondingtothemostsimilar
cellnetwork(Figure1c).Pathintegrationisperformedbyinjecting previouslyseendatawillbeactivated,injectingactivityintothe
activityintotheposecellnetwork,shiftingthecurrentactivity posecellnetworkattheposecellassociatedwiththeactivatedlocal
bump.Newinputdataiscomparedwithdataassociatedwithpre- viewcell.If,ontheotherhand,allexistingviewcellscorrespondto
viouslyvisitedlocations;ifsimilarityishigh,activationisinjected datawhichisdeemeddissimilartothedatabeingexamined,anew
intotheparticularposecellassociatedwiththispreviouslyvisited viewcellisaddedandisassignedexcitatoryconnectionstothemost
location. currently-activatedposecell.Theexcitatorylinksbetweenviewcellsandposecellsrepresenttheestimatedpositionanddirection areassignedapositionbasedonthelastexperience‚Äôspositionand
oftheagentwhenthecorrespondingdatawasobserved. theagent‚Äôsmovementthathasoccurredsince.
Inthesystempresentedhere,localviewcellsdonotrepresent Eachexperiencenodehasconnectionstoasinglelocalview
distinctvisualscenes,butinsteadrepresentdistinctperiodsofneu- cell,representinginourcasethedistinctiveneuraldataobserved
ralactivitythatarerepresentativeofparticularlocationswithinthe whentheratislocatedsomewherewithinthemaze.Thelocalview
maze.Forexample,whileinastandardRatSLAMimplementation cellsactsasacontrollerfortheexperiencemap,activatingand
alocalviewcellmaybeactivatedwhiletheagentisobserving deactivatingtheircorrespondingexperiencenodesaccordingto
adistinctivereddoor,inoursystemthiscellmayactivatewhen theirownactivation:
t ch ee rta ag inen tet to rob dse er .veshighfrequencyLFPoscillationscomingfroma ùê∏ ùëñ =(cid:26) 0 1, , i if fùëâ ùëâc cu ur rr r‚â† =ùëâùëâ ùëñùëñ ,, (7)
Necessarily,wemustprovideamethodtoevaluatesimilarity whereùê∏ ùëñ istheactivationoftheùëñthexperiencenode,ùëâ curristhe
betweenpiecesofinputdata.InstandardRatSLAMsystems,this currentlyactivatedlocalviewcell,andùëâ ùëñ istheviewcellassociated
oftenmakesuseofanappearance-basedviewrecognitionsystem withexperienceùëñ.
[15].Inoursystem,however,weusetheEuclideandistancebetween
Newexperiencenodesarecreatedduringthecreationoftheir
positionestimatesaspredictedbythedeepneuraldecodingsystem
correspondinglocalviewcells,whentheinputdataisdeemeddis-
describedinSection2.2asameasureofdifference;piecesofneural
similarenoughtodataassociatedwithotherlocalviewcells.Upon
datawhichleadtosimilardecodedlocationsarelikelytohavebeen
instantiation,experiencenodesareassignedlocationaccordingto
generatedwhentheratwasinsimilarlocations.Ifanewpieceof
thelocationrepresentedbythecurrentcenterofactivationofthe
datahasadecodedpositionswithinsomedistance(here20pixels;
posecellnetwork.
about58mm)ofapreviouslyobservedpieceofdata,thelocalview
cellcorrespondingtothepreviously-observedpieceofdatawillbe 3 RESULTS
activated.Thisprocessiscalledloopclosure,andisinstrumental
3.1 NeuralDecodingResults
forpreventingerroraccumulationinthegeneratedmaps.
Whenalocalviewcellisactivated,activationisinjectedinto
theposecellnetworkbeforetheinternaldynamicsofthenetwork
areappliedatthelocationoftheposecellcorrespondingtothe
activatedlocalviewcell.
2.3.3 Odometry. Theodometrymoduleisusedtoexaminenew
inputandinfervelocity.Aftervelocityisestimated,activationis
shifted in the pose cell network accordingly; i.e if a clockwise
rotationof60‚ó¶ispredictedandtheposecellnetwork‚ÄôsùúÉdimension
isofsize360,thenallactivationwillbeshifted60cellsupwards,
withanyactivationhittingthetopofthisdimensionwrapping
backtothebottom.Activationisshiftedviastimulationfromthe
odometrymoduleateachtimestepaftertheinternaldynamicsof
theattractornetworkshavebeenapplied.
InastandardRatSLAMimplementation,thisisimplementedby
usingasimplevisualodometrysystemtocomparetwosubsequent
visualimagescapturedbytheagentusingavisualodometrysystem
[17],yieldingabsolutespeedandrelativerotationbetweenimages.
Inthesystempresentedhere,however,absolutespeedandro- Figure2:Angularhistogramsshowingthedistributionsof
tationvaluesarepredictedbythedeepneuraldecodingsystem estimateddirectionsforeachtruedirectionvalueforonerat;
describedinSection2.2.Relativerotationisfoundbycalculating (a)North,(b)East,(c)South,and(d)West.Weseethatthe
thedifferencebetweenabsoluterotationandcurrentrotationes- systemisabletodecodealldirectionswithgoodaccuracy.
timate,asrepresentedbythecentreofactivationoftheposecell Wenotethatperfectalignmentwithcardinalanglesisnot
network.Speedandinferredrelativerotationarethenusedtoshift expectedduetoimperfectionsinthemazeshape.
activationintheposecellnetworkidenticallytoastandardRat-
SLAMsystem[16]. Experimentswereconductedforthreeratsusingdatacollected
fromonemazetasksessionperrat,withdatarangingfrom28to
2.3.4 ExperienceMap. Activityintheposecellsandlocalview 34minutesinduration.Theinitial80%ofdatawasusedtotrain
cellsdrivesthecreationofexperiences.Experiencesarerepresented thedeepneuraldecodingsystem,whilethefinal20%wasusedfor
bynodesin(ùë•,ùë¶,ùúÉ)spaceconnectedbylinksrepresentingtransi- testingpurposesandtogeneratethedecodedmapsshowninFigure
tionsbetweenexperiences[13].Thesenodesformtheexperience 3.Trainingmodelsforeachrattookanaverageof13.5hoursusing
map;agraphicalrepresentationoftheenvironmentbeingexplored. anNVIDIA1070GPU.
Thefirstexperiencelearnedisinitialisedwithanarbitrary(0,0,0) Highdecodingaccuracywasachievedforeachrat,withmean
positionwithintheexperiencemap,andsubsequentexperiences absoluteerror(MAE)forlocationdecodingat2.188cm,1.641cm,andTable1:Meanabsolutelocation,direction,andspeederror andunrelatednodes,soitisencouragingtonotethatthishasnot
forallratsconsidered. happenedforthemapsshowninFigure3.
Wenotethatforonerat,asignificantdecodingerrorhasoc-
Location(cm) Direction(deg) Speed(cm/s) curredontherightdecisionpointofthemaze(Figure3c).This
Rat1 2.188 7.816 0.486 error is due to the deep neural decoder producing an incorrect
Rat2 1.641 6.997 0.316 speed prediction during the first navigation through this point
Rat3 1.849 12.354 1.487 presentinthetestingdata.Asthealgorithmpresentedherehas
nomethodforiterativelyimprovinglocationestimatesofexperi-
1.849cm,directionMAEat7.816‚ó¶,6.997‚ó¶,and12.354‚ó¶,andspeed encenodesuponre-exploration,anincorrectpredictiongenerated
duringinitialexplorationwillremaininthegeneratedmaps.
MAEat0.486cm/s,0.316cm/s,and1.487cm/s,respectively(shown
Duringcreationofofthesemaps,anestimateoftherat‚Äôsposition
inTable1).Notably,thisisthefirstexampleofadeepconvolutional
withintheenvironmentisalsomaintained.TheMAEofthisloca-
neuralnetworkdecodingdirectionoftraveldirectly(asopposed
tionestimateforeachratwas18.353cm,13.808cm,and28.118cm,
toheaddirection,whichistypical).Asonlyfourdirectionsare
respectively.Wenotethatthoughthiserrorishigherthanachieved
possiblewithintheconsideredmaze,weshowhistogramsinFigure
bypredictinglocationdirectlyusingthedeepneuraldecoder(Table
2visualisingthedistributionofestimateddirectionsforeachtrue
1),ourSLAMmethodmaybeextendabletopredictinglocation
directionvalueforonerat.Weseethatthesystemisabletodecode
eveninnovelenvironments,whichwouldbepreviouslyunseenby
alldirectionshighlyaccurately,thisisdespitelargeclassimbalances,
boththedeepneuraldecoderandtherodent.Incontrast,predicting
withthe‚Äòeast‚Äôdirectionbeingover-representedinthetrainingdata
locationdirectlywithadeepnetworkrequiresthenetworktofirst
forthisrat.
betrainedusinglocationtrainingdatafromthatsameenvironment.
3.2 SLAMResults
4 DISCUSSION&FURTHERWORK
Thispaperhasprovidedanapproachfordecodingandvisualising
cognitivemapsusingintracranialneuralactivitydata.Allmaps
generatedwerehighfidelitygraphicalrepresentationsoftheenvi-
ronmentsbeingexplored,capturingthecorrectshapeandscaleof
theenvironmentbeingexplored.
Ithasbeenshownthatheaddirectionandspeeddecodingis
partiallyinvarianttoenvironment[30].Thus,anaturalavenue
forfurtherresearchwouldbetoextendBrainSLAMtodatasets
withmultipleenvironments;wheretrainingdataisgeneratedin
oneenvironment,andtestingdatainanother.Nosuchdatawas
availableforuseinthisproject.
Otherworkshouldaimtoincorporateanexperiencemapcor-
rectionprocessforminimizingthediscrepanciesbetweenrelative
spatialinformationencodedintheedgesbetweenexperiencenodes,
andthelocationsofthoseexperiencenodesinexperiencemapspace.
Forexample,twoexperiencenodesmaybefarawayintheexpe-
riencemapbutlinkedduringamovementwhichourodometry
Figure3:Thetrueshapeoftheenvironmentbeingexplored
modulecalculatestobeamuchsmallerdistance.Inthiscase,by
bytherats(a),andinferredcognitivemapsfromeachofthe
minimizingthediscrepanciesbetweentherelativelocationsofex-
threeratsasgeneratedbythesystempresentedherefrom
periencesintheexperiencemapandtheinter-experiencespatial
‚àº 6minutesoftestdata(b,c,d).Theshapeandscaleofthe
transitioninformation,theexperiencemapcouldconvergeover
inferredmapswasaccurateinallcases.Aphotographofthe
timetoahigherfidelityrepresentationofthemapbeingexplored
truemazeisshowninFigure1forcomparison.
[12,13]
Furtherworkshouldalsoexploretowhatextentthemapsgen-
Usingeachrat‚Äôscorrespondingdeepneuraldecoder,weper- eratedbythesystempresentedherecanbeusedtopredictarats
formed the RatSLAM algorithm on testing data to produce the behavioursasitmovesthroughthemaze.Ifitcanbeshownthat
decodedcognitivemapspresentedinFigure3.Weseethatforall errorsinthegeneratedmapareassociatedwithrelatedsub-optimal
rats,theshapeandscaleofthemazewascorrectlyinferred.We navigation decisions in the maze, this is evidence that this sys-
alsonotethatthereisverylittlealiasinginthesystem,indicatinga temisgeneratingmapswhichareinsomewaycongruenttothe
functionalandeffectiveloopclosuresystem;forcomparison,maps trueinternalcognitivemapoftheanimal.Asanexample,consider
generatedwithnofunctionalloopclosuremodulearepresentedin anexperimentshowingthataratwithwilltakearoutewhichis
thesupplementalmaterial.Mapsgeneratedusinginaccurateloop perceivedasshorterinthegeneratedcognitivemapofthemaze,
closuremodulesmayalsocreateerroneouslinksbetweendistant despiteitbeingthesamelengthasalternativeroutesinreality.Morerecentresearchintohippocampalfunction[27],suggests [7] MatthewWJonesandMatthewAWilson.2005. Thetarhythmscoordinate
thathippocampalactivitytracksdistanceinsemanticspaceaswell hippocampal‚Äìprefrontalinteractionsinaspatialmemorytask.PLoSbiol3,12
(2005),e402.
as physical. This supports the growing consensus that the hip-
[8] RobKitchin.2001. Cognitivemaps. InternationalEncyclopaediaofSocialand
pocampusispartiallyresponsibleforthemaintenanceofadomain- BehaviouralSciences3(2001),2120‚Äì2124.
[9] MichaelSLewicki.1998.Areviewofmethodsforspikesorting:thedetection
generalcognitivemap[28].Thustheresearchpresentedherecould
andclassificationofneuralactionpotentials.Network:ComputationinNeural
not only facilitate the use of biological agents to map physical Systems9,4(1998),R53‚ÄìR78.
spaces,butalsotomapmoreabstractsemanticspaces. [10] KevinLloyd,NadineBecker,MatthewWJones,andRafalBogacz.2012.Learning
touseworkingmemory:areinforcementlearninggatingmodelofruleacquisition
inrats.Frontiersincomputationalneuroscience6(2012),87.
5 CONCLUSION [11] NicholasMalingandCameronMcIntyre.2016.LocalFieldPotentialAnalysisfor
Closed-LoopNeuromodulation.InClosedLoopNeuroscience.67‚Äì80.
UsinganovelcombinationofRatSLAMandadeeplearningap-
[12] MichaelMilford,DavidPrasser,andGordonWyeth.2005.Experiencemapping:
proachtodecodingbehaviouralvariablesfromwide-bandneural producingspatiallycontinuousenvironmentrepresentationsusingRatSLAM.
activity,thispaperhaspresentedthefirstapproachtodecodingand InProceedingsofthe2005AustralasianConferenceonRoboticsandAutomation.
AustralianRoboticsandAutomationAssociationInc.,1‚Äì10.
visualisingcognitivemapsusingonlyintracraniallocalfieldpo- [13] MichaelMilford,RuthSchulz,DavidPrasser,GordonWyeth,andJanetWiles.
tentialdata.Mapshavebeengeneratedusingdatafromthebrains 2007. LearningspatialconceptsfromRatSLAMrepresentations. Roboticsand
AutonomousSystems55,5(2007),403‚Äì410.
of three rats, with data being gathered from the dorsal CA1 of
[14] MichaelMilfordandGordonWyeth.2010.Persistentnavigationandmapping
hippocampus,prefrontalcortex,andtheparietalcortex.Allmaps usingabiologicallyinspiredSLAMsystem.TheInternationalJournalofRobotics
generatedwerehighfidelitygraphicalrepresentationsoftheenvi- Research29,9(2010),1131‚Äì1153.
[15] MJMilford,GordonWyeth,andDavidPrasser.2004.Simultaneouslocalization
ronmentsbeingexplored,capturingthecorrectshapeandscaleof
andmappingfromnaturallandmarksusingratslam.InAustralasianConference
theenvironmentbeingexplored.Whilemapswerebeinginferred, onRoboticsandAutomation,Canberra,Australia.
thesystemwassimultaneouslyabletomaintainreasonablelocation [16] MichaelJMilford,GordonFWyeth,andDavidPrasser.2004.RatSLAM:ahip-
pocampalmodelforsimultaneouslocalizationandmapping.InIEEEInternational
estimatesforallrats. ConferenceonRoboticsandAutomation,2004.Proceedings.ICRA‚Äô04.2004,Vol.1.
Theabilitytovisualiseandquantifythecognitivemapofan IEEE,403‚Äì408.
[17] DavidNist√©r,OlegNaroditsky,andJamesBergen.2004. Visualodometry.In
animalopensupnewavenuesofresearchintotheroleofthese
Proceedingsofthe2004IEEEComputerSocietyConferenceonComputerVisionand
thesemapsinnavigationanddecisionmaking.Webelievethis PatternRecognition,2004.CVPR2004.,Vol.1.Ieee,I‚ÄìI.
workhasvalueinthefieldofbio-inspiredcontrol;sheddinglight [18] JohnO‚ÄôKeefeandNeilBurgess.1996.Geometricdeterminantsoftheplacefields
ofhippocampalneurons.Nature381,6581(1996),425‚Äì428.
onthewaysthatanimalsformandutilizemapsofenvironments,
[19] JohnO‚ÄôKeefe,NeilBurgess,JamesGDonnett,KathrynJJeffery,andEleanorA
andperformnavigationinacomplexworld.Further,theresearch Maguire.1998.Placecells,navigationalaccuracy,andthehumanhippocampus.
presentedhereextendsSLAMalgorithmstoutilizeanovelmodality; PhilosophicalTransactionsoftheRoyalSocietyofLondon.SeriesB:Biological
Sciences353,1373(1998),1333‚Äì1340.
neurallocalfieldpotentials.Thiscouldfacilitateawidevarietyof [20] JohnO‚ÄôKeefeandJonathanDostrovsky.1971.Thehippocampusasaspatialmap:
furtherapplicationsrelatedtobraincomputerinterfaces,automated Preliminaryevidencefromunitactivityinthefreely-movingrat.Brainresearch
(1971).
mappingusingbiologicalagents,andenvironmentexploration.
[21] JohnO‚ÄôkeefeandLynnNadel.1978.Thehippocampusasacognitivemap.Oxford:
ClarendonPress.
ACKNOWLEDGMENTS [22] EftychiosAPnevmatikakis.2019.Analysispipelinesforcalciumimagingdata.
Currentopinioninneurobiology55(2019),15‚Äì21.
We thank the EPSRC, BBSRC (BB/G006687/1), Wellcome Trust [23] SashankJReddi,SatyenKale,andSanjivKumar.2019.Ontheconvergenceof
(202810/Z/16/Z),MRCandLeverhulmeTrustforsupport.Forthe adamandbeyond.arXivpreprintarXiv:1904.09237(2019).
[24] EleonoraRusso,NadineBecker,AleksPFDomanski,DanielDurstewitz,and
purposeofopenaccess,theauthorhasappliedaCCBYpubliccopy-
MatthewWJones.2023.Integrationofrateandtemporalcodesbyhippocampal
rightlicencetoanyAuthorAcceptedManuscriptversionarising cell-assembliessupportsthetaphasecodingofepisodicinformation. bioRxiv
fromthissubmission. (2023),2023‚Äì12.
[25] DanielaSchiller,HowardEichenbaum,ElizabethABuffalo,LilaDavachi,DavidJ
Foster,StefanLeutgeb,andCharanRanganath.2015.Memoryandspace:towards
REFERENCES anunderstandingofthecognitivemap. JournalofNeuroscience35,41(2015),
13904‚Äì13911.
[1] JosepAulinas,YvanRPetillot,JoaquimSalvi,andXavierLlad√≥.2008.Theslam
[26] DMSmall,DRGitelman,MDGregory,ACNobre,TBParrish,andM-MMesu-
problem:asurvey.CCIA184,1(2008),363‚Äì371.
lam.2003. Theposteriorcingulateandmedialprefrontalcortexmediatethe
[2] CarolLColbyandJean-Ren√©Duhamel.1996.Spatialrepresentationsforaction
anticipatoryallocationofspatialattention.Neuroimage18,3(2003),633‚Äì641.
inparietalcortex.CognitiveBrainResearch5,1-2(1996),105‚Äì115.
[27] EthanASolomon,BradleyCLega,MichaelRSperling,andMichaelJKahana.
[3] GauteTEinevoll,HenrikLind√©n,TomTetzlaff,Szymon≈Åeski,andKPettersen.
2019.Hippocampalthetacodesfordistancesinsemanticandtemporalspaces.
2013.Localfieldpotentials.PrinciplesofNeuralCoding37(2013).
ProceedingsoftheNationalAcademyofSciences116,48(2019),24343‚Äì24352.
[4] KippFreud,MattJones,NathanLepora,andCianO‚ÄôDonnell.2023.Deeplearning-
[28] HugoJSpiers.2020. TheHippocampalCognitiveMap:OneSpaceorMany?
baseddecodingofspatialinformationfromlimbic-corticallocalfieldpotentials
Trendsincognitivesciences24,3(2020),168‚Äì170.
revealdriftingspatialrepresentationswithincreasingstability.InConferenceon
[29] ChristophStosiek,OlgaGaraschuk,KnutHolthoff,andArthurKonnerth.2003.
CognitiveComputationalNeuroscience.
Invivotwo-photoncalciumimagingofneuronalnetworks.Proceedingsofthe
[5] MarkusFrey,SanderTanni,CatherinePerrodin,AliceO‚ÄôLeary,MatthiasNau,Jack
NationalAcademyofSciences100,12(2003),7319‚Äì7324.
Kelly,AndreaBanino,ChristianFDoeller,andCaswellBarry.2020.Interpreting
[30] JeffreySTaube,RobertUMuller,andJamesBRanck.1990.Head-directioncells
wide-bandneuralactivityusingconvolutionalneuralnetworks.bioRxiv(2020),
recordedfromthepostsubiculuminfreelymovingrats.II.Effectsofenvironmen-
871848.
talmanipulations.JournalofNeuroscience10,2(1990),436‚Äì447.
[6] RoddyMGrievesandKateJJeffery.2017. Therepresentationofspaceinthe
[31] ChristopherTorrenceandGilbertPCompo.1998.Apracticalguidetowavelet
brain.Behaviouralprocesses135(2017),113‚Äì131.
analysis.BulletinoftheAmericanMeteorologicalsociety79,1(1998),61‚Äì78.
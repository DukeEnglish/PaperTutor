JOTA manuscript No.
(will be inserted by the editor)
Nash equilibrium seeking for a class of quadratic-bilinear Wasserstein
distributionally robust games
Georgios Pantazis, Reza Rahimi Baghbadorani, Sergio Grammatico
Received: date/Accepted: date
Abstract WeconsideraclassofWassersteindistributionallyrobustNashequilibriumproblems,
whereagentsconstructheterogeneousdata-drivenWassersteinambiguitysetsusingprivatesam-
ples and radii,in line with their individual risk-aversebehaviour.By leveragingrelevantproper-
ties of this class of games, we show that equilibria of the originalseemingly infinite-dimensional
problem can be obtained as a solution to a finite-dimensional Nash equilibrium problem. We
then reformulate the problem as a finite-dimensional variational inequality and establish the
connection between the corresponding solution sets. Our reformulation has scalable behaviour
with respect to the data size and maintains a fixed number of constraints, independently of the
number of samples. To compute a solution, we leverage two algorithms, based on the golden
ratio algorithm. The efficiency of both algorithmic schemes is corroborated through extensive
simulation studies on an illustrative example and a stochastic portfolio allocation game, where
behavioural coupling among investors is modeled.
Keywords Data-drivenNashequilibrium seeking · Wassersteinambiguity sets · Heterogeneous
uncertainty
1 Introduction
A wide range of applications, from smart grids [1] and communication networks [2] to social
networks [3] can be modelled as a collection of self-interested interacting decision makers op-
timizing different cost functions under operational constraints. Game theory [4] provides the
fundamental theoretical framework for analyzing such systems. Although investigating deter-
ministic gamescanbe adequateinsomecasestudies[2],[5],mostreal-worldapplicationsinvolve
decision making under uncertainty, which stresses the need for the inclusion of stochasticity in
the existing models. Several studies have explored uncertainty within a game theoretic context,
based on particular assumptions on the probability distribution [6], [7] and/or the properties of
the uncertainty sample space [8,9].
When the probability distribution is unknown and distribution models are not an accurate
descriptionofthe stochasticaspectofthe problem,sampling-basedordata-drivenmethods have
Theauthors wouldliketo thankProf. DimitrisBoskos forhisusefulfeedback and discussionsduringthe prepa-
rationofthiswork.
DelftCenterforSystemsandControl (DCSC){G.Pantazis, R.Rahimibaghbadorani,S.Grammatico}@tudelft.nl.
4202
voN
41
]CO.htam[
1v63690.1142:viXra2 Georgios Pantazis,RezaRahimiBaghbadorani, SergioGrammatico
shownstrongpotentialforproposingrobustsolutionsagainstuncertainty.Workssuchas[10–16]
design distribution-free approaches for data-driven Nash equilibria based on statistical learn-
ing techniques.Morespecifically,[13–16]accountforpossible strategicperturbationsaroundthe
Nashequilibrium.Separately,worksbasedonSampleAverageApproximation(SAA)techniques,
suchas [17,18],developalgorithmsfor finding Nashequilibriain stochastic settings by using ex-
pected values of cost functions. The works mentioned above constitute data-driven methods for
stochastic equilibriumseeking.These works,however,do not accountfor ambiguityin the prob-
ability distribution, where the distribution itself may be uncertain within some known bounds.
The challenge of ambiguity in the distributions becomes pronounced in multi-agent settings,
where heterogeneous uncertainties affect the agents’ costs, often necessitating the consideration
of different ambiguity sets, each representing the individual risk-averse nature of each agent.
To account for distributional uncertainty, distributionally robust optimization (DRO) uses
a so-called ambiguity set of possible probability distributions to make decisions robust against
probabilisticvariationswithinthisset.Unlikescenario-basedmethods,whichrequiremanysam-
ples for robustness, DRO can perform well with limited data by adjusting the ambiguity set.
DRO includes special cases like sample average approximation (SAA) and robust optimization
(RO). At the same time, DRO can be less conservative than RO and offer better out-of-sample
performancethanSAA,makingitespeciallyusefulindata-drivenapplicationswithlimiteddata.
Recently, Wasserstein ambiguity sets [19], which use empirical data and the Wasserstein metric
tomeasuredistributionaldeviations,havegainedattention.Thesesetsarefavoredforpenalizing
horizontalshifts andprovidingfinite-sample guarantees.Researchhasfocusedonconvergenceof
empirical estimates in the Wasserstein distance [20–25], as well as obtaining tractable reformu-
lations of Wasserstein distributionally robust optimization problems [21,26–28]. Extensions of
those works include distributionally robust chance-constrainedprograms [29–31].
Despite the considerable body of literature on DRO with Wasserstein ambiguity sets, the
exploration of data-driven Wasserstein distributionally robust Nash equilibrium problems with
heterogeneous uncertainty in the cost functions represents a notably underexplored topic. Most
works in the literature consider moment-based methods or other measures of distance between
distributions. For instance, [32] considers a non-cooperative game with distributionally robust
chance-constrained strategy sets applied to duopoly Cournot competition. The work [33] devel-
ops distributionally robust equilibrium models based on the Kullback-Leibler (KL) divergence
forhierarchicalcompetitioninsupplychains.Otherworksmainlyconsiderambiguityinthecon-
straints,suchastherecentwork[34],whichstudiesagamewithdeterministiccostforeachagent
and distributionally robust chance constraints with the centre of the Wasserstein ambiguity set
being an elliptical distribution; [35] reformulates an equilibrium problem with a deterministic
cost and distributionally robust chance-constraints as a mixed-integer generalized Nash equilib-
rium problem leveraging the results in [36]. The contributions of this work with respect to the
related literature are the following:
(i) We study a class of heterogeneous data-driven Wasserstein distributionally robust games,
where each agent’s ambiguity set is centered around an empirical probability distribution
based on their individual data, while the Wasserstein radius is also set by each individual
agent.We reformulate the originalgame as a robustNashequilibrium problemand establish
the connection between the distributionally robust and robust Nash equilibria of the corre-
sponding problems.For this classofgames,we demonstratethatthe inner maximizationcan
be solvedwithout the use of epigraphic variables[37], [38], which in a game-theoreticsetting
can lead to unshared coupling constraints. As such, our approach decreases computational
complexity significantly.Tothe bestofourknowledge,this isthe firstdistributionallyrobust
game-theoretic reformulation that leads to data-scalable results by leveraging the structure
of the problem at hand.Nashequilibriumseekingforaclassofquadratic-bilinearWasserstein distributionallyrobustgames 3
(ii) The robust Nash equilibrium problem is then reformulated as a variational inequality (VI).
Unlike results of similar classes of problems in optimization [39], where the reformulated
variationalinequality is monotone under certainassumptions, the mapping correspondingto
the game can be nonmonotone in general due to the heterogeneity of the agents’ ambiguity
setsandcosts.However,weshowthatthisproblemcanbeefficientlysolvedempiricallyusing
two algorithms: the adaptive golden ratio algorithm (aGRAAL) [40] and a hybrid version of
thisalgorithm(Hybrid-Algin[41]).Notably,ournumericalresultsshowthatinseveralcases,
the convergence speed is close to linear, and increasing the number of samples does not slow
down the convergence.Our results are then applied to a portfolio allocationgame that takes
into account market uncertainty and behavioural coupling of market participants.
2 Problem formulation
Notation:Inthissection,weintroducesomebasicnotationandresultsrequiredforthesubsequent
developments. To this end, consider the index set N ={1,...,N}. The decision vector of each
agent i ∈ N is denoted by x = col((x(j))n ) ∈ X ⊆ Rn, where x(j),j = 1,...,n, denotes an
i i j=1 i i
element of the decision vector; let x = col((x )N ) ∈ X = N X ⊆ R(N−1)n be
−i j j=1,j6=i −i i=1,i6=j j
the decision vector of all other agents’ decisions except for that of agent i and x = col((x )N )
Q i i=1
be the collective decision vector. We denote ||·|| = k·k . The projection operator proj (x)
2 X
of a point x to the set X is given by proj (x) = argmin kx−yk. F is monotone on X if
X y∈X
(x−y)⊤(F(x)−F(y))≥0forallx,y ∈X.Ifthe conditionisnotsatisfied,themappingiscalled
nonmonotone.
Let us denote P(Rm) as the set of all probability measures on Rm and define
M(Rm)= Q|Q is a distribution on Rm and E [kξk]= kξkQ(dξ)<∞ .
P
(cid:26) ZΞ (cid:27)
In other words, M(Rm) considers the sets of all distributions defined on Rm with a bounded
first-order moment. We are now ready to define the Wasserstein metric to quantify the distance
between two probability distributions.
Definition 2.1 The Wasserstein metric d : M(Rm)×M(Rm)→R between two distribu-
W ≥0
tions Q ,Q ∈M(Rm) is defined as
1 2
d (Q ,Q ):= inf kξ −ξ kΠ(dξ ,dξ ),
W 1 2 1 2 1 2
Π∈J(ξ1∼Q1,ξ2∼Q2) ZRm×Rm
where J(ξ ∼ Q ,ξ ∼ Q ) represent the set of joint probability distributions of the random
1 1 2 2
variables ξ and ξ with marginals Q and Q , respectively. (cid:3)
1 2 1 2
The Wasserstein metric can be viewed as the optimal transport plan to fit the probability dis-
tribution Q to Q [19].
1 2
2.1 Problem formulation
Consider a population of agents with index set N = {1,...,N}. Each agent i ∈ N , given the
decisions of the other agents x , solves the following optimization problem:
−i4 Georgios Pantazis,RezaRahimiBaghbadorani, SergioGrammatico
min max {f (x ,x )+E [g (x ,x ,ξ )]},
xi∈XiQi∈P
i
i i −i ξi∼Qi i i −i i
wheref :Rn×Rn(N−1) →R,g :Rn×Rn(N−1)×Rm →Rforalli∈N andP istheambiguity
i i i
set of the uncertain parameter ξ . We call the collection of the coupled optimization problems
i
aboveforallagentsi∈N asgameG.ForgameG,wedefinethenotionofdistributionally robust
Nash equilibrium as follows:
Definition 2.2 A decision vector x∗ ∈ N X is a distributionally robust Nash equilibrium
i=1 i
(DRNE) of game G if, given the decisions of all other agents x∗ ∈X it holds that
Q −i −i
x∗ ∈argmin max {f (x ,x∗ )+E [g (x ,x∗ ,ξ )]}, ∀i∈N . (1)
i
xi∈Xi
Qi∈P
i
i i −i ξi∼Qi i i −i i
Inotherwords,adecisionvectorx∗ isaDRNEofGif,foreachagenti,giventheequilibrium
strategies x∗ of all other agents with their respective local sets, the following holds: player i
−i
chooses their strategy x in a way that minimizes their objective, considering both their deter-
i
ministic cost f and the worst-case expected effect of distributional uncertainty in ξ of g . This
i i i
must hold for all agents simultaneously, ensuring that no agent can improve their outcome by
unilaterally changing their strategy, even in the face of worst-case distribution.
In this work, we follow a data-driven approach and consider heterogeneous Wasserstein am-
biguity sets constructed by each individual agent on the basis of their own individual data.
Thus, we define an appropriate notion of distance between probability distributions. Due to its
ability to penalize horizontal dislocations of distributions and often capturing realistic shifts in
distributions, in this work we will use the Wasserstein distance. Specifically, for each i ∈ N
the empirical probability distribution is constructed based on K independent and identically
i
distributed (i.i.d.) samples ξ ={ξ(1),...,ξ(K1)} drawn by agent i as follows:
Ki i i
1
Ki
Pˆ = δ
Ki K ξ(ki)
i i
k Xi=1
where δ is the Dirac delta measure that assigns the full probability mass at the point ξ . We
ξi i
then consider a radius ε , based on the Wasserstein distance, and construct the data-driven
i
Wasserstein ambiguity ball of agent i as follows:
P ={Q ∈P(Rm):d (Q ,Pˆ )≤ε }, (2)
i i W i Ki i
where P(Rm) denotes the collection of all probability distributions defined on the support set
Rm. We impose the following assumption:
Assumption 1 (i) For each i∈N , f is convex in x for any given x ∈X ;
i i −i −i
(ii) For each i∈N , g has the form g (x ,x ,ξ )=ξ⊤Q ξ +P (x)ξ ;
i i i −i i i i i i i
(iii) P is affine in x, i.e. P (x)=A x+b , where A ∈Rm×nN and b ∈Rm for all i∈N ;
i i i i i i
(iv) ThereexistsanorthogonalmatrixL suchthatQ =L⊤D L ,whereD isadiagonalpositive
i i i i i i
semidefinite matrix with sorted eigenvalues.
Note that A can be written as A =(A(1),A(2),...,A(N)), where A(j) ∈Rm×n corresponds
i i i i i i
to the submatrix to be multiplied with the elements of x for each j ∈ N . The structure of
j
function g allowsforeachagentto determineindividually howmuchthey wishtopenalize large
i
deviations of the uncertain parameter, represented by the quadratic term ξ⊤Q ξ . Furthermore,
i i i
thebilineartermP (x)ξ modelstheinterplaybetweenuncertaintyanddecisionsandisimportant
i iNashequilibriumseekingforaclassofquadratic-bilinearWasserstein distributionallyrobustgames 5
in models where the collective decision of the agents amplifies the effects of uncertainty in the
cost. Assumption (iv) allows Q to be represented as Q =L⊤D L , where L is orthogonaland
i i i i i i
D is a diagonal positive semidefinite matrix with sorted eigenvalues. This form leverages the
i
benefits of orthogonal transformations and simplifies the analysis of quadratic forms, while still
being general enough to cover a wide range of practical scenarios.
Considering an ambiguity set per agent as in (2), we then obtain the following result:
Lemma 2.1 Let Assumption 1 hold. Fix the Wasserstein radii ε and consider a multi-sample
i
ξ
Ki
∈ RmKi for each agent i ∈ N. Then, each optimization problem admits the following dual
reformulation:
min J (x ,λ ,x ), (3)
i i i −i
xi∈Xi
λi≥0
where
1
Ki
J (x ,λ ,x )=f (x ,x )+λ ε2+ sup [ξ⊤Q ξ +P (x)ξ −λ kξ −ξ(ki) k2]. (4)
i i i −i i i −i i i K i i i i i i i i
i
k
Xi=1ξi∈Rm
Proof: The proof follows by application of the Kantorovichduality [42]. (cid:4)
We call the collection of the coupled optimization problems above for all agents i ∈ N as
game G¯. Note that this reformulation has an additional dual variable λ for each i ∈ N that
i
corresponds to the Lagrange multiplier associated with each individual Wasserstein constraint.
Throughthisreformulation,a distributionallyrobustNashequilibriumproblemcanbe recastas
an augmented robust Nash equilibrium problem. To connect the solutions of G and G¯, we first
provide the definition of the robust Nash equilibrium (RNE) for game G¯ as follows:
Definition 2.3 A decision vector (x∗,λ∗), where λ∗ =col((λ i) i∈N ) is a RNE of G if
(x∗,λ∗)∈ argmin J (x ,λ ,x∗ )
i i i i i −i
xi∈Xi,λi≥0
for all i∈N , with J as in (4). (cid:3)
i
The following lemma establishes the connection between the set of DRNE of G and the set
of RNE of G¯ defined as follows:
Lemma 2.2 Let (x∗,λ∗) be an RNE of G¯ in (3). Then, x∗ is a DRNE of G in (1). (cid:3)
Proof: For a given x∗ ∈X , since (x∗,λ∗) is an RNE of G¯, we have
−i −i
max {f (x∗,x∗ )+E [ξ⊤Q ξ +P (x∗,x∗ )ξ }
Qi∈P
i
i i −i ξi∼Qi i i i i i −i i
1
Ki
= minf (x∗,x∗ )+λ ε2+ sup [ξ⊤Q ξ +P (x∗,x∗ )ξ −λ kξ −ξ(ki)k2]
λi≥0 i i −i i i K i
k
Xi=1ξi∈Rm i i i i i −i i i i i
1
Ki
=f (x∗,x∗ )+λ∗ε2+ sup [ξ⊤Q ξ +P (x∗,x∗ )ξ −λ∗kξ −ξ(ki)k2]
i i −i i i K i i i i i −i i i i i
i
k
Xi=1ξi∈Rm
1
Ki
≤ min f (x ,x∗ )+λ ε2+ sup [ξ⊤Q ξ +P (x ,x∗ )ξ −λ kξ −ξ(ki)k2]
xi∈Xi,λi≥0 i i −i i i K i
k
Xi=1ξi∈Rm i i i i i −i i i i i
= min max {f (x ,x∗ )+E [ξ⊤Q ξ +P (x ,x∗ )ξ ]}, (5)
xi∈XiQi∈P
i
i i −i ξi∼Qi i i i i i −i i6 Georgios Pantazis,RezaRahimiBaghbadorani, SergioGrammatico
where the inequality holds from Definition 2.3. (cid:4)
Note that the inverse direction does not necessarily hold, as one should determine an ap-
propriate value for λ∗. From Lemma 2.2 we can instead solve game G¯ and obtain the solution
(x∗,λ∗) and, from this solution, select x∗ as the DRNE of our original problem G. To achieve
this, we impose the following standing assumption:
Assumption 2 The set of RNE of G¯ in (3) is non-empty. (cid:3)
The non-emptiness of the set of RNE of G¯ then directly implies the non-emptiness of the set
of DRNE of game G. To solve the inner maximization over the uncertain parameter ξ , we
i
show that the class of games that satisfies Assumption 1 can be exploited to provide a finite-
dimensionalformulation,without the use ofan epigraphic reformulation.The following theorem
leverages the structure of the problem to obtain a more computationally efficient reformulation
thus circumventing those challenges.
Theorem 1 Under Assumption 1, G admits the reformulation
1
Ki
G :∀i∈N : min {f (x ,x )+λ ε2− (ξ(ki))⊤ξ(ki) +
R xi∈Xi,λi>λmax(Qi) i i −i i i K i
k Xi=1
i i !
1
Ki
+ W˜(ki)(x ,x ,λ )⊤Q˜ (λ )W˜(ki)(x ,x ,λ )},
4K
i −i i i i i −i i
i
k Xi=1
whereQ˜ i(λ i)=diag( λi−λm1 ax(Di),..., λi−λm1 in(Di))andW˜(ki)(x i,x −i,λ i)=P˜ i(x i,x −i)+2λ iξ˜ i(ki),
P˜(x ,x )=L P (x ,x ) and ξ˜(ki) =L ξ(ki). (cid:3)
i i −i i i i −i i i i
Proof: For each agent i∈N it holds that:
1
Ki
sup [ξ⊤Q ξ +P (x ,x )ξ −λ kξ −ξ(ki)k2]
K i i i i i −i i i i i
i
k
Xi=1ξi∈Rm
1
Ki
= sup [ξ⊤Q ξ +P (x ,x )ξ −λ (ξ⊤ξ −2ξ⊤ξ(ki)+(ξ(ki))⊤ξ(ki))]
K i i i i i −i i i i i i i i i
i
k
Xi=1ξi∈Rm
1
Ki
= −λ (ξ(ki))⊤ξ(ki)+ sup [ξ⊤(Q −λ I )ξ +(P (x ,x )+2λ ξ(ki))⊤ξ ]
K i i i i i i m i i i −i i i i
i
k Xi=1
ξi∈Rm !
Since for each i ∈ N , Q is diagonalizable, there exists matrix L such that Q = L⊤D L ,
i i i i i i
where D is a diagonal matrix, whose eigenvalues decrease along the diagonal. Denote the max-
i
imum eigenvalue of D by λ (D ) and the minimum eigenvalue of D by λ (D ). As such,
i max i i min i
the following equalities hold:
1
Ki
−λ (ξ(ki))⊤ξ(ki)+ sup [ξ⊤(Q −λ I )ξ +(P (x ,x )+2λ ξ(ki))⊤ξ ]
K i i i i i i m i i i −i i i i
i
k Xi=1
ξi∈Rm !
1
Ki
= −λ (ξ(ki))⊤ξ(ki)+ sup [ξ⊤(D −λ I )ξ +[L P (x ,x )+2λ L ξ(ki)]⊤ξ ]
K i i i i i i m i i i i −i i i i i
i
k Xi=1
ξi∈Rm !
1
Ki
= −λ (ξ(ki))⊤ξ(ki)+ sup [ξ⊤(D −λ I )ξ +W˜(ki)(x ,x ,λ )⊤ξ ] (6)
K i i i i i i m i i −i i i
i
k Xi=1
ξi∈Rm !Nashequilibriumseekingforaclassofquadratic-bilinearWasserstein distributionallyrobustgames 7
Consider now G(ki) (x ,x ,λ ,ξ )=ξ⊤(D −λ I )ξ +[P˜(x ,x )ξ +2λ ξ˜(ki) )]⊤ξ . Due to the
i i −i i i i i i m i i i −i i i i i
presence of the supremum in (6), we wish to study for which value of the uncertainty ξ we
i
achieve the maximum value for G(ki)(x ,x ,λ ,ξ ). This maximum value will be parametrized
i i −i i i
by the corresponding sample
ξ(ki).
We distinguish between two different cases:
i
(i) For λ > λ (Q ) we note that (D −λ I )−1 is negative semidefinite. Thus, given other
i max i i i m
agents’ decisions x , the resulting cost function is concave which yields the solution
−i
sup ξ⊤(D −λ I )ξ +[P˜(x ,x )+2λ ξ˜(ki))]⊤ξ =G(ki)(x ,x ,λ ,ξ∗), (7)
i i i m i i i −i i i i i i −i i i
ξi∈Rm
where ξ i∗ is obtained by the first order optimality condition ∇
ξ
i∗G i(ki)(x i,x −i,λ i,ξ i) = 0. As
such, the maximum is attained at ξ∗ = 1(λ I −D )−1(P˜(x ,x )+2λ ξ˜(ki) ) with optimal
i 2 i m i i i −i i i
value:
G(ki)(x ,x ,λ ,ξ∗)=(ξ∗)⊤(D −λ I )ξ∗+[P˜(x ,x )+2λ ξ˜(ki))]⊤ξ∗
i i −i i i i i i m i i i −i i i i
1
= (P˜(x ,x )+2λ ξ˜(ki))⊤(λ I −D )−1(P˜(x ,x )+2λ ξ˜(ki))) (8)
4 i i −i i i i m i i i −i i
(ii) Forλ ∈[0,λ (Q )),wenotethatD −λ I ispositivesemidefinite,hencethecostfunction
i max i i i m
of the inner maximization problem is convex in ξ , which implies that sup ξ⊤(D −
i ξi∈Rm i i
λ I )ξ +[P˜(x ,x )+2λ ξ˜(ki))]⊤ξ =∞.
i m i i i −i i i i
As such, given the agents’ decisions x each agent i∈N solves
−i
1
Ki
min {f (x ,x )+λ ε2− (ξ(ki))⊤ξ(ki) +
xi∈Xi,λi>λmax(Qi) i i −i i i K i
k Xi=1
i i !
1
Ki
+ W˜(ki)(x ,x ,λ )⊤Q˜ (λ )W˜(ki)(x ,x ,λ )},
4K
i −i i i i i −i i
i
k Xi=1
whereQ˜ (λ )=(λ I −D )−1.Then,the connectionbetweenthe gamesGandG¯ asestablished
i i i m i
in Lemma 2.1 and their corresponding solutions in Lemma 2.2 concludes the proof. (cid:4)
2.2 Reformulation as a data-drivenvariational inequality problem
In this section, we establish the connection of the Nash equilibria of G with the solutions of a
R
variational inequality (VI) problem. For the ease of the reader, we define the notion of a Nash
equilibrium for a general game.
Definition 2.4 Consider the following game:
∀ i∈N : min J (z ,z ), (9)
i i −i
zi∈Zi
Apointz∗ =(z∗,z∗ )∈Z = N Z isNashequilibrium(NE)of(9)if,givenx∗ ,thefollowing
i −i i=1 i −i
condition holds:
Q
J (z∗,z∗ )≤J (z ,z∗ ),
i i −i i i −i
for all z ∈Z and for all i∈N . (cid:3)
i i8 Georgios Pantazis,RezaRahimiBaghbadorani, SergioGrammatico
The following statement then holds:
Proposition 2.1 Consider the following game:
∀ i∈N : min J (z ,z ), (10)
i i −i
zi∈Zi
where J is convex on Z for any z ∈Z and Z = N Z is convex and closed. Furthermore,
i i −i −i i=1 i
consider the following variational inequality problem:
Q
F⊤(z∗)(z−z∗)≥0, ∀ z ∈Z∩V(z∗) for all i∈N .
where F(z)=col((F i(z)) i∈N) with F i(z)=∇ ziJ i(z i,z −i) is a (possibly nonmonotone) mapping
and V(z∗) is a small enough convex neighbourhood around z∗. Then, any local solution z∗ of the
VI is a Nash equilibrium of (10).
Proof: This result is a direct extension of the proofline of Proposition 1.4.2 in [43] for a non-
monotone mapping defined over a small enough convex neighbourhood V(z∗) of the solution.
(cid:4)
Returning to game G , note that, according to Definition 2.4, a point (x∗,λ∗) ∈ X ×
R
N (λ (Q )),∞) is a Nash equilibrium of G if, given x∗ ∈ X , the following condition
i=1 max i R −i −i
holds:
Q
1
Ki
1
Ki
f (x∗)+λ∗ ε2− (ξ(ki))⊤ξ(ki) + W˜(ki)(x∗,λ∗)⊤Q˜ (λ∗)W˜(ki)(x∗,λ∗)≤
i i i K i i 4K i i i i
i ! i
k Xi=1 k Xi=1
1
Ki
1
Ki
f (x ,x∗ )+λ ε2− (ξ(ki))⊤ξ(ki) + W˜(ki)(x ,x∗ ,λ )⊤Q˜ (λ )W˜(ki)(x ,x∗ ,λ )
i i −i i i K i i 4K i −i i i i i −i i
i ! i
k Xi=1 k Xi=1
for all (x ,λ )∈X ×(λ (Q ),∞) .
i i i max i
Finally, from the proofline of Theorem 1, it immediately follows that the set of NE of G
R
coincideswiththesetofRNEof(3).Letusnowdenotebyz =(x ,λ )∈R(n+1)N thecollectionof
i i i
thedecisionvectorandtheLagrangemultiplierforalli∈N andz =col((z i) i∈N ).Furthermore,
denote the feasible set Z = {z ∈ R(n+1)N : x ∈ X ,λ ≥ λ (Q )+ζ , ∀i ∈ N }, where ζ
i i i max i i i
is an arbitrarily small positive parameter, ensuring that the local constraint set is closed and
thus gameG ,where λ >λ (Q ), canbe solvedwith anya prioridefinedaccuracy.An exact
R i max i
solution is obtained when ζ →0+. The following lemma then holds:
i
Lemma 2.3 A solution z∗ of the VI problem with mapping F(z)=col(F i(z)) i∈N, where
∇ xif i(x i,x −i)+
2K1 Ki
(A i(i))⊤Q˜ i(λ i)W˜(ki)(x i,x −i,λ i)
F i(z)=

ε2
i
− K1
i
kK i=i 1kξ i(ki)k2+ 4K1
i
kK
i=ii 1k 4Pi ξ= i(k1
i)⊤Q˜ i(λ i)W˜(ki)(x,λ i)−kW˜(ki)(x,λ i)k2
d dQ λ˜
ii

.
 P P (11)
over Z∩V(z∗), with V(z∗) being a convex local neighbourhood around z∗, is a Nash equilibrum
of G over Z.
RNashequilibriumseekingforaclassofquadratic-bilinearWasserstein distributionallyrobustgames 9
Proof: The proof follows from direct application of Proposition 2.1 by taking the pseudo-
gradient of game G considering that Q˜ is a diagonal matrix, hence dQ˜ i(λi) is obtained by
differentiating the
coR
rresponding
diagonali
elements.
dλi
(cid:4)
The resulting VI mapping can in general be nonmonotone. However, for a fixed set of best-
response strategies x∗ , the resulting optimization problem for each agent i ∈ N is convex.
−i
This is an immediate result of the quadratic over linear structure of each optimization problem,
whose Jacobian is positive semidefinite, given x∗ . Nonmonotonicity of the corresponding VI
−i
mapping implies that depending on the initialization point within the region X, different sets
of equilibrium solutions may be reached with an equilibrium seeking algorithm.Note that those
points satisfy the equilibrium condition of G .
R
An advantage of this reformulation is that it has good scalability properties with respect to
thedatasize,whichisimportantfordata-drivenapplications.Equilibriumseekingusingavailable
algorithms in the literature often leads to a large number of oscillations,which are avoidedwith
our problem formulation.Thus, throughTheorem 1, we can obtain data-scalable reformulations
for the class of heterogeneous data-driven Wasserstein distributionally robust games in (1). In
the next section, we assess the computational performance of our theoretical results through
an illustrative example and a risk-aware portfolio allocation game, which takes into account
behavioural coupling of the investors’decisions.
3 Numerical simulations
Inthe simulationresults,weuse twoalgorithmsto solvethe variationalinequalityproblems:the
adaptive golden ratio algorithm(aGRAAL) [40], and the Hybrid method, Algorithm 1 (Hybrid-
Alg). The Hybrid method is similar to aGRAAL but differs in the choice of the momentum
parameter, as will be explained below.
3.1 Illustrative example
In this section, we reformulate a case study of the distributionally robust game in (1), under
Assumption1,asavariationalinequalityproblemandsolveitusingbothaGRAALandHybrid-
Alg.Thekeydifferencebetweenthesetwoalgorithmsisthat,unlikeaGRAAL,whichusesafixed
momentum parameter,Hybrid-Alg employs a variable momentum parameter.We believe this is
a testimony to the potential of switching the momentum parameter between a small (used in
aGRAAL) anda largevalue,whichhasa significantimpactonconvergencespeed.Inparticular,
having larger,variablemomentum parameterin Algorithm1 makes x¯ closerto the mostrecent
k
iterate, x , rather than x¯ , which allows us to estimate the local Lipschitz constant of the
k k−1
corresponding VI mapping F more precisely compared to aGRAAL.
For the simulation, the parameters in the problem are generated as follows: Each drawn
sample ξ(ki) is generated from the uniform distribution with support set [0,1], while P is given
i i
by P (x) = a x . The values a , and the eigenvalues of D in the reformulation (11) are
i i∈N i i i i
randomized.Eachagent’sWassersteinradiusε ischosenrandomlyaccordingtothedistribution
i
ε·U[1,5], wP here ε takes fixed values in {10−6,10−3,10−2,1} and U[1,5] is a uniform discrete
distribution with support set {1,2, ..., 5}. Figure 1 shows the residual of the corresponding
mapping F for the illustrative example for different Wasserstein radii and a fixed number of
samples.We note thatthe convergencerateofbothalgorithmsisalmostlinear,whichillustrates
that, even though the VI mapping can be nonmonotone, fast solutions can be obtained using
both algorithms. Figure 2 shows the residual for an increasing number of invividual data for10 Georgios Pantazis,RezaRahimiBaghbadorani, SergioGrammatico
Algorithm 1 Hybrid DRNE seeking algorithm (Hybrid-Alg) [41]
Require: Choose x0,x1, τ0 >0,τ¯≫0,α=(1,1+ 2√5],θ0 =1,ρ= α1 + α1 2,φ¯≫ 1+ 2√5,sum1
0
=0, sum2 0=0,
flg=1.
1: Fork=0,1,2,...do
2: Findthestepsize:
τk =min (cid:26)ρτk −1,α 4τθ kk − 11 kF(k xx kk )− −x Fk (− xk1 −k2 1)k2,τ¯
(cid:27)
−
3: x¯k=
(φk−1)xk+x¯k −1
φk
4: Updatethenextiteration:
5: Update:
θx kk ++ 11 ==p αr τo kx τkg(x¯k−τkF(xk))
τk 1
6: computethefollowings−ummationswithφk+1=φ¯:
sum1 =sum1 +(Eq.16in[41])
k+1 k
sum2 =sum2 +(Eq.17in[41])
k+1 k
7: if (sum1 ≤0 ∧ flg=1) ∨ (sum2 ≤0 ∧ flg=0)then
k+1 k+1
8: φk+1=φ¯,flg=1
9: else
10: if flg=1then
11: xk+1=xk,x¯k =x¯k −1
12: φk+1=α,θk =θk 1,τk =τk 1
13: sum1 =0,sum2− =0,flg=−0
k+1 k+1
14: else
15: φk+1=α
16: sum2 k+1=sum2
k
+(Eq.17in[41]withφk+1=α)
17: sum1 =0
k+1
18: endif
19: endif
each agent and individual radii per agent. The number of each agent’s samples for each case
study is drawn from a discrete integer distribution in [10,20],[40,60] and [80,120],respectively.
Note that even if we increase the number of samples, the convergence rate does not change,
thus leading to results that scale well with the sample size. Finally, Figure 3 illustrates how
the cost of each agent at the equilibrium is affected by the Wasserstein radii and the number
of samples of each agent for 10 different problem instances represented by boxplots. In Figure
3(a) we consider different radii ε per agent obtained from the distribution ε · U[1,5], where
i
ε ∈ {10−6,10−3,10−2,1} to investigate the effect of increasing Wasserstein radii on the cost
of each agent; In Figure 3(b) the number of samples per agent follows a uniform distribution
withsupportsets{[10,20],[40,50],[80,120],[200,300]}percasestudytoinvestigatethe effectan
increasing number of samples has on the cost of each agent.
We observe that as we increase the value of the radii, the cost functions of each agent are
higher representing a more conservative but robust behaviour against distrubutional shifts. Fi-
nally, for fixed radii, as the number of samples increases, the empirical variance of the costs
decreases as well, as a result of a more accurate estimation of the probability distribution, used
as the center of each ambiguity set.
3.2 Risk-awareportfolio allocation under market uncertainties and behavioural influences
We consider a multi-investor robust portfolio allocation problem, where each investor i ∈ N
allocates capital seeking to maximize their profits or minimize their costs taking into account
theirexposuretomarketrisks.ThedecisionvariableforeachinvestoristheirportfolioallocationNashequilibriumseekingforaclassofquadratic-bilinearWasserstein distributionallyrobustgames 11
(a)ε=10−6. (b)ε=10−3. (c)ε=1.
Fig.1:Residualofvariational inequalityproblemwithdifferentradiiεi peragentchosenaccordingtothedistri-
butionε·U[1,5],whereεtakes valuesin{10−6,10−3,1}.
(a)Ki=randi((10,20),1,n). (b)Ki=randi((40,60),1,n). (c)Ki=randi((80,120),1,n).
Fig.2:Residualofvariational inequalityproblemwithdifferentnumberofsamplesKi peragentandradiiǫi
chosenaccording tothedistributionε·U[1,5]withfixedradius ε=0.01.
140
140
130
120
120
100 110
80 100
60 90
40 80
20 70
60
10-6 10-3 10-2 1 [10, 20] [40, 60] [80, 120] [200, 300]
(a)Differentradiiε. (b)Differentnumberofsamples.
Fig. 3: Costfunction values of four agents at the equilibrium for 10 different scenarios represented by box plots
with(a)differentradii(b)Bothdifferentsamplesanddifferentnumberofsamplesperagent.
x ∈X , where X represents the set of feasible portfolios for investori, normalizedto a simplex
i i i
representing the percentage of capital split among investments. Furthermore, we wish to model
behavioural impacts of other investors onto each individual investor. Finally, we consider that
agents are not only aware of the possible high variance of market uncertainties, but also aware
that, when multiple investors accumulate to a single asset, this could lead to market bubbles
which affects the returns fromsuch investments.Thus,eachinvestor’sobjective,giventhe other
investors’ strategies x , is defined according to the following optimization problem:
−i
min max x⊤C x +x⊤C x −r⊤x +E ξ⊤Q ξ +P (x)ξ .
xi∈XiQi∈P
i
i ii i i ij j i i ξi∼Qi i i i i i
(cid:8) (cid:2) (cid:3)(cid:9)12 Georgios Pantazis,RezaRahimiBaghbadorani, SergioGrammatico
(a)ε=10−6. (b)ε=10−2. (c)ε=1.
Fig.4:Residualfordifferentinstancesoftheportofolioallocationproblemwitheachagent’sεi chosenaccording
toε·U[1,5]withε∈{10−6,10−2,1}.
6
4
2
0
-2
-4
10-6 10-3 10-2 1
Fig. 5: Cost function values of four agents at the equilibrium for 10 different scenarios represented by box plots
fordifferentradiiεi peragentobtainedfromtheuniformdistributionε·U[1,5],whereε∈{10−6,10−3,10−2,1}
toinvestigatetheeffectofincreasingWassersteinradiionthecostofeachagent.
The term r⊤x represents the deterministic part of the returns based on the allocation of cap-
i i
ital to assets. The quadratic deterministic terms models (possible) behavioural coupling due
to competition of the investors according to performance metrics often used to make such in-
vestments. The ambiguity set P models investor i’s ambiguity in the distribution of uncertain
i
market parameters affecting the returns. The term ξ⊤Q ξ represents i’s aversion to volatility,
i i i
indicating each agent’s individual sensitivity to uncertain fluctuations. The term P (x)ξ , where
i i
P (x) = x , models herding behavior, where multiple investors investing heavily in the
i j∈N j
sameassetsincreaseasset-specificrisks.This crowdingeffect candrivepricesup, raisingthe risk
of marketP bubbles. In Figure 4, we set the Wasserstein radii at ε ∈ {10−6,0.01,1} and consider
10differentinstancesoftheproblemwithdifferentvaluesofmatricesQ ,C ,C ,r anddifferent
i ii ij i
multi-samples per agent i ∈ N obtained from different t-distributions. Note that even though
the mapping is in general nonmonotone, most case studies lead to satisfactory (mostly linear)
convergence results with both schemes, Hybrid-Alg (red lines) and aGRAAL (blue lines). In
most of the case studies, the superiority of the hybrid algorithm is evident. Figure 5 shows the
valuesofthe costfunctions ofthe agentsatthe equilibrium pointforthose 10differentinstances
representedbyaboxplot.Eventhoughthe problemis nonmonotone,increasingthe Wasserstein
radius of the agents leads in general to a larger value of the cost function.Nashequilibriumseekingforaclassofquadratic-bilinearWasserstein distributionallyrobustgames 13
4 Conclusion
This work explores data-driven distributionally robust games using individual Wasserstein am-
biguity sets and private data, thus allowing agents to develop their own personalized risk-
aversedecisions.We reformulatea seemingly-infinitedimensionalgameinto adata-drivenfinite-
dimensional variational inequality problem, which evidently enjoys data-scalability properties.
Future work will focus on introducing coupling constraints to our model. Extending on that we
wishto investigatethis problemunder the presenceofdistributionally robustchanceconstraints
coupling the agents decisions and in particular,whether certain assumptions such as linearity of
the constraintscanaidinobtainingasatisfactoryreformulationorapproximationoftheoriginal
game.
Acknowledgements Thisresearch ispartiallysupportedbytheERCunderprojectCOSMOS(802348).
References
1. W. Saad, Z. Han, H. V. Poor, and T. Basar, “Game-theoretic methods for the smart grid: An overview
of microgrid systems, demand-side management, and smart grid communications,” IEEE Signal Processing
Magazine,vol.29,no.5,pp.86–105, 2012.
2. G.Scutari, F.Facchinei, J.Pang, andD.P.Palomar, “Realandcomplexmonotone communicationgames,”
IEEE Transactions on Information Theory,vol.60,pp.4197–4231, 2014.
3. D. Acemoglu and M. K. Jensen, “Aggregate comparative statics,” Games and Economic Behavior, vol. 81,
pp.27–49, 2013.
4. T.BaşarandG.Olsder,“Dynamicnon-cooperative gametheory,” 1999.
5. D. Paccagnan, B. Gentile, F. Parise, M. Kamgarpour, and J. Lygeros, “Nash and wardrop equilibria in
aggregative games withcouplingconstraints,” IEEE Transactions on Automatic Control, vol.64, no. 4, pp.
1373–1388, 2019.
6. P.Couchman,B.Kouvaritakis,M.Cannon,andF.Prashad,“Gamingstrategyforelectricpowerwithrandom
demand,” IEEE Transactions on Power Systems,vol.20,no.3,pp.1283–1292, 2005.
7. V.V.Singh,O.Jouini,andA.Lisser,“Existenceofnashequilibriumforchance-constrained games,” Opera-
tions Research Letters,vol.44,no.5,pp.640–644,2016.
8. M.AghassiandD.Bertsimas,“Robustgametheory,” Math. Program., vol.107,no.1-2,pp.231–273, 2006.
9. S.Hayashi,N.Yamashita,andM.Fukushima,“RobustNashequilibriaandsecond-orderconecomplementarity
problems,” Journal of Nonlinear and Convex Analysis,vol.6,2005.
10. F.FeleandK.Margellos,“ProbabilisticsensitivityofNashequilibriainmulti-agentgames:await-and-judge
approach,” pp.5026–5031, 2019.
11. F. Fele and K. Margellos, “Probably approximately correct Nash equilibrium learning,” IEEE Transactions
on Automatic Control,vol.66,no.9,pp.4238–4245, 2021.
12. D. Paccagnan and M. C. Campi, “The scenario approach meets uncertain game theory and variational in-
equalities,” in2019 IEEE 58th Conference on Decisionand Control (CDC),2019, pp.6124–6129.
13. G. Pantazis, F. Fele, and K. Margellos, “A posteriori probabilistic feasibility guarantees for Nash equilibria
inuncertainmulti-agentgames,” IFAC-PapersOnLine,vol.53,no.2,pp.3403–3408, 2020,21stIFACWorld
Congress.
14. ——, “Onthe probabilistic feasibility of solutions inmulti-agent optimization problems under uncertainty,”
European Journal of Control, vol.63,pp.186–195, 2022.
15. M. Mammarella, V. Mirasierra, M. Lorenzen, T. Alamo, and F. Dabbene, “Chance-constrained sets
approximation: Aprobabilisticscalingapproach,” Automatica,vol.137,p.110108, 2022.[Online].Available:
https://www.sciencedirect.com/science/article/pii/S0005109821006373
16. G. Pantazis, F. Fele, and K. Margellos, “A priori data-driven robustness guarantees on strategic deviations
fromgeneralisednashequilibria,” pp.1–16,042023.
17. B. Franci and S. Grammatico, “A distributed forward–backward algorithm for stochastic generalized nash
equilibriumseeking,” IEEE Transactions on Automatic Control,vol.66,no.11,pp.5467–5473, 2021.
18. ——, “Stochastic generalized nash equilibrium-seeking in merely monotone games,” IEEE Transactions on
Automatic Control,vol.67,no.8,pp.3905–3919, 2022.
19. C.Villani,“Topicsinoptimaltransportation,” no.58,2016.
20. S.Dereich,M.Scheutzow,andR.Schottstedt,“Constructivequantization:Approximationbyempiricalmea-
sures,” Annales de l’Institut Henri Poincaré, Probabilités et Statistiques,vol.49,2011.14 Georgios Pantazis,RezaRahimiBaghbadorani, SergioGrammatico
21. P.MohajerinEsfahaniandD.Kuhn,“Data-drivendistributionallyrobustoptimizationusingtheWasserstein
metric:performanceguarantees andtractablereformulations,” MathematicalProgramming,vol.171,no.1-2,
pp.115–166, Sep.2018.
22. J. Dedecker and F. Merlevède, “Behavior of the empirical wasserstein distance in Rd under moment condi-
tions,” Electronic Journal of Probability,vol.24,2019.
23. J. Weed and F. Bach, “Sharp asymptotic and finite-sample rates of convergence of empirical measures in
wassersteindistance,” Bernoulli,vol.25,2017.
24. J.WeedandQ.Berthet, “Estimationofsmoothdensitiesinwassersteindistance,” 2019.
25. N.Fournier,“Convergenceoftheempiricalmeasureinexpectedwassersteindistance:Non-asymptoticexplicit
boundsinRd,” 2023.
26. D.Kuhn,P.M.Esfahani,V.A.Nguyen, andS.Shafieezadeh-Abadeh, “WassersteinDistributionallyRobust
Optimization:TheoryandApplicationsinMachineLearning,” Operations Research & Management Science
inthe Age of Analytics,pp.130–166, Oct.2019.
27. L.M.Chaouach,T.Oomen,andD.Boskos,“Comparingstructuredambiguitysetsforstochasticoptimization:
Application to uncertainty quantification,” 2023 62nd IEEE Conference on Decision and Control (CDC),
pp.8274–8279, 2023.
28. L. M. Chaouach, D. Boskos, and T. Oomen, “Uncertain uncertainty in data-driven stochastic optimization:
towardsstructuredambiguitysets,” 2022 IEEE 61st Conference onDecisionand Control(CDC),pp.4776–
4781,2022.
29. Z. Chen, D. Kuhn, and W. Wiesemann, “Data-driven chance constrained programs over wasserstein balls,”
Operations Research, 2018.
30. A.R.Hota,A.K.Cherukuri,andJ.Lygeros,“Data-drivenchanceconstrainedoptimizationunderwasserstein
ambiguitysets,” 2019 American Control Conference (ACC),pp.1501–1506, 2018.
31. M. Heinlein, T. Alamo, and S. Lucia, “On the risk levels of distributionally robust chance
constrained problems,” IEEE Transactions on Automatic Control (submitted), 2024. [Online]. Available:
https://doi.org/10.48550/arXiv.2409.01177
32. S. Peng, A. Lisser, V. V. Singh et al., “Games with distributionally robust joint chance constraints,” Opti-
mization Letters,vol.15,pp.1931–1953, 2021.
33. Y.Liu,H.Xu,S.-J.S.Yang,andJ.Zhang,“Distributionallyrobustequilibriumforcontinuous games:Nash
andstackelberg models,” European Journal of Operational Research,vol.265,no.2,pp.631–643, 2018.
34. T. Xia, J. Liu, and A. Lisser, “Distributionally robust chance constrained games under wasserstein ball,”
Operations Research Letters,vol.51,no.3,pp.315–321, 2023.
35. F. Fabiani and B. Franci, “On distributionally robust generalized nash games defined over the wasserstein
ball,” Journal of Optimization Theory and Applications, vol.199,no.2,pp.298–309, 102023.
36. Z. Chen, D. Kuhn, and W. Wiesemann, “On approximations of data-driven chance constrained programs
over wasserstein balls,” Operations Research Letters, vol. 51, no. 3, pp. 226–233, 2023. [Online]. Available:
https://www.sciencedirect.com/science/article/pii/S0167637723000317
37. D. Kuhn, P. Mohajerin Esfahani, V. A. Nguyen, and S. Shafieezadeh-Abadeh, “Wasserstein distribution-
allyrobust optimization: Theory andapplications inmachine learning,” INFORMS Tutorials in Operations
Research,pp.130–166, 2019.
38. G. Pantazis, B. Franci, and S. Grammatico, “On data-driven wasserstein distributionally robust
nash equilibrium problems with heterogeneous uncertainty,” arXiv preprint, 2023. [Online]. Available:
https://arxiv.org/abs/2312.03573
39. D. Boskos, J. Cortés, and S. Martínez, “High-confidence data-driven ambiguity sets for time-varying linear
systems,” IEEE Transactions on Automatic Control,vol.69,no.2,pp.797–812, 2024.
40. Y.Malitsky,“Goldenratioalgorithmsforvariationalinequalities,”MathematicalProgramming,vol.184,no.1,
pp.383–410, Nov.2020.
41. R. Rahimi Baghbadorani, P. Mohajerin Esfahani, and S. Grammatico, “A hybrid algorithm for
monotone variational inequalities,” 2024, manuscript submitted for publication. [Online]. Available:
https://pure.tudelft.nl/admin/files/222286247/Variational_Inequality.pdf
42. L. Kantorovich and G. S. Rubinstein, “On a space of totally additive functions,” Vestnik Leningrad. Univ,
vol.13,pp.52–59, 1958.
43. F. Facchinei and J.-S. Pang, “Finite-dimensional variational inequalities and complementarity problems,”
2003.
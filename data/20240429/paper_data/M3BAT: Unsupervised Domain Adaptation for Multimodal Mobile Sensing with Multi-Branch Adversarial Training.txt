M3BAT: Unsupervised Domain Adaptation for Multimodal Mobile
Sensing with Multi-Branch Adversarial Training
LAKMALMEEGAHAPOLA∗,
IdiapResearchInstitute&EPFL,Switzerland
HAMZAHASSOUNE,
IdiapResearchInstitute&EPFL,Switzerland
DANIELGATICA-PEREZ,
IdiapResearchInstitute&EPFL,Switzerland
Overtheyears,multimodalmobilesensinghasbeenusedextensivelyforinferencesregardinghealthandwell-being,behavior,
andcontext.However,asignificantchallengehinderingthewidespreaddeploymentofsuchmodelsinreal-worldscenarios
istheissueofdistributionshift.Thisisthephenomenonwherethedistributionofdatainthetrainingsetdiffersfromthe
distributionofdataintherealworld—thedeploymentenvironment.Whileextensivelyexploredincomputervisionand
naturallanguageprocessing,andwhilepriorresearchinmobilesensingbrieflyaddressesthisconcern,currentworkprimarily
focusesonmodelsdealingwithasinglemodalityofdata,suchasaudiooraccelerometerreadings,andconsequently,thereis
littleresearchonunsuperviseddomainadaptationwhendealingwithmultimodalsensordata.Toaddressthisgap,wedid
extensiveexperimentswithdomainadversarialneuralnetworks(DANN)showingthattheycaneffectivelyhandledistribution
shiftsinmultimodalsensordata.Moreover,weproposedanovelimprovementoverDANN,calledM3BAT,unsupervised
domainadaptationformultimodalmobilesensingwithmulti-branchadversarialtraining,toaccountforthemultimodalityof
sensordataduringdomainadaptationwithmultiplebranches.Throughextensiveexperimentsconductedontwomultimodal
mobilesensingdatasets,threeinferencetasks,and14source-targetdomainpairs,includingbothregressionandclassification,
wedemonstratethatourapproachperformseffectivelyonunseendomains.Comparedtodirectlydeployingamodeltrained
inthesourcedomaintothetargetdomain,themodelshowsperformanceincreasesupto12%AUC(areaunderthereceiver
operatingcharacteristicscurves)onclassificationtasks,andupto0.13MAE(meanabsoluteerror)onregressiontasks.
CCSConcepts:•Human-centeredcomputing→Ubiquitouscomputing;•Computingmethodologies→Learning
undercovariateshift;Transferlearning.
AdditionalKeyWordsandPhrases:mobileandwearablesensing,multimodalsensing,domainadaptation,distributionshift,
generalization,transferlearning,mood,socialcontext,energyexpenditureestimation
ACMReferenceFormat:
LakmalMeegahapola,HamzaHassoune,andDanielGatica-Perez.2024.M3BAT:UnsupervisedDomainAdaptationfor
46
MultimodalMobileSensingwithMulti-BranchAdversarialTraining.Proc.ACMInteract.Mob.WearableUbiquitousTechnol.8,
2,Article46(May2024),30pages.https://doi.org/10.1145/3659591
1 INTRODUCTION
Inrecentyears,theprevalenceofmobileandwearabledevicesequippedwithmultimodalsensorshasincreased
significantly,offeringawiderangeofapplicationsinhealth,well-being,contextawareness,anduserexperience
[41,50].Thesesensorscancapturediversedata,includingaccelerometers,gyroscopes,photoplethysmography
∗nowatETHZurich,Switzerland
Authors’addresses:LakmalMeegahapola,lakmal.meegahapola@epfl.ch,IdiapResearchInstitute&EPFL,Switzerland;HamzaHassoune,
IdiapResearchInstitute&EPFL,Switzerland;DanielGatica-Perez,IdiapResearchInstitute&EPFL,Switzerland.
Permissiontomakedigitalorhardcopiesofallorpartofthisworkforpersonalorclassroomuseisgrantedwithoutfeeprovidedthat
copiesarenotmadeordistributedforprofitorcommercialadvantageandthatcopiesbearthisnoticeandthefullcitationonthefirstpage.
Copyrightsforcomponentsofthisworkownedbyothersthantheauthor(s)mustbehonored.Abstractingwithcreditispermitted.Tocopy
otherwise,orrepublish,topostonserversortoredistributetolists,requirespriorspecificpermissionand/orafee.Requestpermissionsfrom
permissions@acm.org.
©2024Copyrightheldbytheowner/author(s).PublicationrightslicensedtoACM.
2474-9567/2024/5-ART46$15.00
https://doi.org/10.1145/3659591
Proc.ACMInteract.Mob.WearableUbiquitousTechnol.,Vol.8,No.2,Article46.Publicationdate:May2024.
4202
rpA
62
]GL.sc[
1v19371.4042:viXra46:2 • Meegahapolaetal.
(PPG)readings,andlocation,aswellasdeviceusagedatalikeapplicationusageandtypingandtouchevents.This
wealthofdatapresentsexcitingopportunitiesforunderstandinghumanbehavior[7],physiologicalresponses
[27],andcontextualinformation[87]inanunobtrusivemanner.Someexamplesincludeactivityrecognition
[7,8,11],stressdetection[33,48,55],moodinference[44,49,72],eatinganddrinkingbehaviorunderstanding
[51,53,54,70],andsocialcontextrecognition[36,46,52].However,despitethegrowinginterestinutilizing
multimodalsensordata,severalchallengesmustbeaddressedtofullyharnesstheirpotentialindeployment
settings.Onesuchunder-exploredchallengeisthegeneralizationofmodelsacrossdifferentusers,populations,
andenvironments[3,49,85].Aseachindividualexhibitsuniquebehavioralpatternsandphysiologicalresponses,
buildingmodelsthatarerobustandadaptableacrossdiversepopulationsposesachallenge[57,71].Additionally,
variations in the context of data collection can significantly impact sensor readings and behavior patterns
(e.g.,trainingamodelinItalyandexpectingittoworkforpeopleinIndia)[7,49].Achievinggeneralizationis
challengingduetodistributionshiftsinthedata.
The data collected from various sensors in different environments may not align perfectly, resulting in a
distributionshiftbetweenthesourcedataset(datathatthemodelistrainedon)andthetargetdataset(datathat
themodelwouldencounterindeployment)[13,78].Thesedistributionshiftscanhaveanegativeimpactonmodel
performancewhenappliedinnewandunseencontexts.Addressingdistributionshiftsrequirestheuseoftransfer
learningtechniques,includingrobustdomainadaptationapproaches[24].Despitenumerousstudiesexploring
theapplicationsofmultimodalsensorsinmobileandwearabledevices,discussionsaroundthechallengesof
generalizationanddistributionalshiftshavebeenrelativelylimited[49,85].Thisisincontrasttootherdomains,
suchascomputervision,naturallanguageprocessing,andspeechprocessing,wheresignificantprogresshasbeen
madeinunderstandingandmitigatingdomainshifts[90].However,priorstudieshaveemphasizedthatblindly
adaptingtechniquesfromotherdomainstomobilesensingdatasetsisnottrivialandneedsdeeperinvestigation
becauseofthedifferencesinthewaydataarecollected,processed,andmadesenseof[13,82,85].Therefore,
moreinvestigationsareneededinmultimodalsensingsettingstoovercomechallengesregardingdistribution
shifts.
Inmobilesensingsettings,trainingmodelsoftenrelyonlarge-scaledatasetscollectedfrommultipleusers.In
deployment,modelsneedtopersonalizeforbetterperformance,andhavinggroundtruthlabelsfromusersisa
primarywaytodothis.However,obtaininglabeledgroundtruthfromusersposeschallengesduetothesparse
natureofdatacollectionanddifficultiesinacquiringaccurateandreliableself-reports[84].Consequently,the
lackoflabeleddataimpedesthepersonalizationofmodelsforindividualusers,makingitdifficulttocatertotheir
uniquecharacteristicsandpreferences.Therefore,thecrucialstepofadaptingmodelstotargetpopulations(i.e.,
genders,agegroups,countries,sub-populations,etc.)becomesessentialevenbeforepersonalization[7,49].By
adaptingthemodelstothetargetpopulation,wecanensuretheireffectivenessindiversecontexts,providinga
strongfoundationforsubsequentpersonalizationefforts.Unsuperviseddomainadaptation(UDA)[23]techniques
playavitalroleinbridgingthegapbetweendifferentdomains,renderingthemodelsmoreversatileandadaptable
tovarioususersandenvironments.However,eventhoughUDAhasbeenexploredinveryfewpriorstudiesin
mobilesensing[13,47,49],howsuchtechniquesperformwhenmultimodaldataarepresenthasrarelybeen
explored.
Consideringtheseaspects,inthispaper,wefirstconductastatisticalanalysisofdatasetstounderstandthe
dynamicsofdistributionshiftsacrosssource-targetdomainpairsanddifferentsensingmodalities.Then,we
evaluateunsuperviseddomainadaptationwithdomainadversarialtraining(DANN)[13,24],andalsoother
baselinessuchasmaximummeandiscrepancy(MMD)[13]andadversarialdiscriminativedomainadaptation
(ADDA)[76],ontwodifferentmultimodalmobileandwearablesensingdatasetsacrossbothregressionand
classificationtasks.Then,weproposeanovelmodelarchitectureforMultimodalMobileSensingdatacalled
Multi-BranchdomainAdversarialTraining(M3BAT),showingimprovedperformanceoverbaselinesacrossa
majorityofinferencetasks.Indoingthis,weanswerthefollowingresearchquestions:
Proc.ACMInteract.Mob.WearableUbiquitousTechnol.,Vol.8,No.2,Article46.Publicationdate:May2024.UnsupervisedDomainAdaptationforMultimodalMobileSensingwithMulti-BranchAdversarialTraining • 46:3
RQ1: Whatdynamicsregardingdistributionshiftcanbeobservedbyconductingastatisticalanalysisonmulti-
modalsensingdatasets?
RQ2: DoesDANNonmultimodalsensingdatasetsleadtoimprovedUDAperformance?Howdoesitcompareto
transferlearning-basedfine-tuningwhenlabelsareavailableinthetargetdomain?
RQ3: Doeshavingmultiplebranchesfordifferentfeaturesets(basedonmodalityordistributionshift-based
featuregroups)leadtoimprovedUDAperformance?
Byaddressingtheaboveresearchquestions,thispaperprovidesthefollowingcontributions:
Contribution1: Weconductedananalysisoftwomultimodalsensingdatasets,namelyWENETandWEEE.
Thesedatasetsprovidevaluableinsightsintodistributionshiftsacrossvariousdimensions—WENETexplores
distribution shifts across different countries with modalities such as wifi, steps, proximity, location, screen
events,appusage,activity,etc.,whileWEEEcapturesshiftsacrossdeviceswornondistinctbodypositionswith
accelerometer,photoplethysmography(PPG),andgyroscopedata.OurapproachinvolvedcalculatingCohen’s-d
valuesforindividualfeaturesandthenaggregatingthemtodiscernpatternsatthemodalityandfeatureset
level.Thisanalysisallowedustopinpointthemodalitiesthatexhibitedhighdistributionshiftsacrossvarious
sourceandtargetdomainpairs.Forinstance,intheWENETdataset,activityandscreeneventdatademonstrated
minimaldifferencebetweenItalyandIndia,whilewifiandstepcountfeaturesdisplayedsubstantialdissimilarity,
attributabletolowandhighshifts,respectively.Thesetrendscontrastedacrosssource-targetpairs,underscoring
theimportanceofamultimodality-awarearchitecturethataccountsforindividualmodalityandfeaturesetlevel
shiftsduringthedomainadaptationprocess.Thisleadstothequestionofwhetheritisworthexploringmodel
architecturesthatexplicitlycatermultimodalityofdatainunsuperviseddomainadaptation.
Contribution2: The datasets employed in our study provide a platform for exploring diverse inferences,
encompassingmood,socialcontext,andenergyexpenditureestimationviaclassificationandregressiontasks.In
ordertocomprehensivelyassesstheimpactofmultimodality,wetransformedthedatasetsintotabularformats
andconducteddomainadaptationusingdomainadversarialtrainingwithgradientreversal,employingtheDANN
approach.Notably,ourresultsshowedanimprovementinperformance,demonstratinganincreaseofupto8%in
AUCforclassificationtasks,andareductionof0.08inMAEforregressiontaskswhencomparedtodeploying
themodeldirectlyontargetdomains.Remarkably,inthecontextoftheWENETdataset,unsuperviseddomain
adaptationdemonstratedcompetitiveperformancewithtransferlearning-basedfine-tuning,highlightingits
potentialtoenhanceperformanceevenwhennotexplicitlytailoredtomultimodality.However,fortheWEEE
dataset,whiledomainadversarialtrainingledtoperformanceimprovement,itfellshortoftransferlearning.
Thisdisparitycouldbeattributedtothepresenceofhigh-qualitygoldstandardlabelsinbothsourceandtarget
domainsinWEEE(asopposedtobothsubjectiveandobjective,butsilver-standardlabelsinWENET),which
wereeffectivelyharnessedformodelfine-tuningwhenlabelswereaccessibleinthetargetdomain.Thisanalysis
underscoresthesignificanceoflabelqualityanditsinterplaywithdomainadaptationtechniques,offeringinsights
intothediverseimpactsofdatasetsandlabeltypesonoverallperformance.
Contribution3: We introduce an improvement to DANN, in the form of a novel architecture for domain
adversarialtraining,denotedasM3BAT,whichemploysamulti-branchneuralnetworkstructurefeaturing
multipleencoderstailoredtohandledifferentfeaturesets.Eachencoderisdesignedtoaccommodatespecific
features,takingintoaccountfactorssuchastheextentofdistributionshifts;andfeaturesstemmingfromvarious
modalities.Throughtheconcatenationofencoderoutputs,ourarchitectureincorporatesdomainadversarial
trainingtechniques,includingparameterannealingandstagedtraining.Ouranalysissuggeststhatemploying
threebranchesyieldsmorestabletrainingforthedatasetsandtasksunderconsiderationforWENET.These
branchescorrespondtohigh,moderate,andlowshiftfeatures.ForWEEE,weemploy2-3branchesindifferent
setups.Onaverage,weobserveanincreaseofupto12%inAUCforclassificationtasks,alongwithareductionof
upto0.13inMAEforregressiontasks,ascomparedtodeployingmodelsfromthesourcetothetargetdomain.
Proc.ACMInteract.Mob.WearableUbiquitousTechnol.,Vol.8,No.2,Article46.Publicationdate:May2024.46:4 • Meegahapolaetal.
These findings underscore the potential advantages of our methodology in managing distribution shifts in
multimodaldata.
Thestudyisorganizedasfollows.InSection2,wedescribethebackgroundandrelatedwork.Thenwedescribe
theproposedarchitectureinSection3.Section4providesadescriptionofthedataused.InSection5,Section6,
andSection7,wedefinethemethodsandpresentresultstoanswerRQ1,RQ2,andRQ3,respectively.Wediscuss
implications,limitations,andfutureworkinSection8,andconcludethepaperinSection9.
2 BACKGROUNDANDRELATEDWORK
2.1 DistributionShift
Inthecontextofmachinelearning,distributionshiftreferstothemismatchbetweentheprobabilitydistributions
ofthedatainthesourcedomain(wherethemodelistrained)andthetargetdomain(wherethemodelisdeployed)
[78]:𝑝 𝑋,𝑌(source)(𝑥,𝑦) ≠ 𝑝 𝑋,𝑌(target)(𝑥,𝑦).Whenthismismatchoccursasaresultofepistemicuncertainty
[34],themodel’sperformancecandegradesignificantlyinthetargetdomain,asithasnotseendatafromthat
domain during training. The epistemic uncertainty could be due to many sampling biases such as temporal
bias,populationbias,andsocialbias[59].Hence,inotherterms,distributionshiftscanariseduetovarious
factors,suchasdifferencesindatacollectionsettings,userpreferences,environmentalconditions,andcultural
variations.Whiletherearemanynitty-grittydetails,threeprimarytypesofdistributionshiftcanbeidentified
[78]:covariateshift,labelshift,andconceptdrift.Understandingthesetypesiscrucialforeffectivelyaddressing
thechallengesposedbydistributionshifts.Thefirsttype,namelycovariateshift,alsoknownasinputshiftor
featureshift,occurswhentheinputdata’sdistributiondiffersbetweenthesourceandtargetdomains,butthe
conditionaldistributionofthelabelsgiventheinputremainsthesame.Inotherwords,therelationshipbetween
theinputfeaturesandthelabelsisconsistentacrossdomains,butthefrequencyofdifferentfeaturevaluesmay
vary.Thiscanberepresentedas:𝑝 𝑋(source)(𝑥) ≠𝑝 𝑋(target)(𝑥) and 𝑝 𝑌|𝑋(source)(𝑦 |𝑥) =𝑝 𝑌|𝑋(target)(𝑦 |
𝑥).Therefore,differencesindatacollectionmethods,sensorcharacteristics,oruserbehavioracrossdifferent
domainscancausecovariateshifts.Toillustratecovariateshift,considerasentimentanalysismodeltrained
on movie reviews from the source domain (e.g., American movies) and deployed in the target domain (e.g.,
Indianmovies).Thelanguageandwritingstyleofthereviewsmaydifferbetweenthetwodomains,eventhough
thesentimentexpressedbythereviewsisthesame.Inthiscase,thecovariateshiftarisesfromvariationsin
languageusagewhilethesentimentremainsconsistent.Thesecondtypeofdistributionshift,priorprobability
shift,alsoknownaslabelshift,occurswhenthelabeldistributionsaredifferentbetweenthesourceandtarget
domains,whiletheconditionaldistributionsoffeaturesgiventhelabelsarethesame.Itcanberepresentedas:
𝑝 𝑌(source)(𝑦) ≠ 𝑝 𝑌(target)(𝑦) and 𝑝 𝑋|𝑌(source)(𝑥 | 𝑦) = 𝑝 𝑋|𝑌(target)(𝑥 | 𝑦).Labelshiftcanarisewhen
thelabelingprocessisbiasedorwhenthetargetdomainhasdifferentclassdistributionscomparedtothesource
domain.Continuingwiththesentimentanalysisexample,labelshiftmayoccurifthesentimentexpressionin
moviereviewsisperceiveddifferentlyindifferentcultures.Forinstance,positivereviewsinthesourcedomain
mightbelabeledasnegativeinthetargetdomainduetoculturaldifferencesinhowsentimentsareconveyed.
Finally,thethirdtypeofdistributionshift,conceptdrift,isamuchmorecomplexaspecttomitigate[78]andnot
thefocusofthispaper.Inthispaper,theprimaryobjectiveistohandlecovariateshifts.
2.2 UnsupervisedDomainAdaptation
Unsuperviseddomainadaptation(UDA)isatransferlearningtechniqueusedtomitigatetheeffectsofdistribution
shiftsbetweenthesourceandtargetdomainswithoutrequiringlabeleddatafromthetargetdomain[13,23,78].
The process was primarily developed to handle the covariate shift. As described in [32], there are multiple
methodsthatachievethis.Self-superviseddomainadaptation,mostlyexploredincomputervision[2,45,83],
isacommontechniquethatlearnsdomaininvariantfeaturesthroughpretextlearningtaskswherethetarget
Proc.ACMInteract.Mob.WearableUbiquitousTechnol.,Vol.8,No.2,Article46.Publicationdate:May2024.UnsupervisedDomainAdaptationforMultimodalMobileSensingwithMulti-BranchAdversarialTraining • 46:5
canbeobtainedwithoutsupervision.Statisticaldivergencecanalsobeusedinthiscontext.Theapproachseeks
toderivefeaturesthatareconsistentacrossdomainsbyminimizingdomaindiscrepanciesinalatentfeature
space.Differenttechniquesareusedtoimplementthis:Maximummeandiscrepancy(MMD)[68],Correlation
alignment(CORAL)[75],orcontrastivedomaindiscrepancy(CDD)[37].Furthermore,Test-Timeadaptation
(TTA)[35,42,43,79]canalsomitigatecaseswherethetestdatadistributiondiffersfromthetrainingdata.TTA
reliesonadaptingapre-trainedmodelfromsourcedomaintothetargetdomainbeforemakingpredictions,not
requiringtofinetunethemodelonlabeleddatafromthetargetdistributionandnotevenrequiringthesource
dataset.Lastly,domainadversarialtraining(DANN),introducedbyGaninetal.[24],isapopularapproachfor
UDA[24,81,88].Variationsofthistechniquehaveshowntoperformwellonsensordata[13,82],motivatingusto
explorethetechniquefurther.WhileDANNcanindirectlyinfluencethealignmentoflabeldistributionsorprior
probabilitiesbetweendomainsthroughthesharedfeaturespace,itisnottheprimarymechanismforaddressing
priorprobabilityshifts.Hence,thisprocessissuitedtocoverbothcovariateandlabelshiftstovaryingextents.
Thekeyideaistolearnafeaturerepresentationthatisdomain-invariant,enablingthemodeltogeneralizewell
acrossdomains.Indomainadversarialtraining,adomaindiscriminatorisintroducedalongwiththeprimarytask
model(e.g.,classificationorregression).Thedomaindiscriminatoraimstopredictthedomainoftheinputdata
(sourceortarget)basedonthefeaturerepresentationlearnedbytheprimarytaskmodel.Simultaneously,the
primarytaskmodeltriestominimizethetask-specificlossandmaximizethedomaindiscriminator’sconfusion,
effectivelyaligningthefeaturedistributionsbetweenthesourceandtargetdomains.Toincreasetheconfusion,
gradientreversalcanbeusedbymultiplyingthelossby−𝜆(𝜆isascaler)whenpropagatinglosstothefeature
extractor.Thedomaindiscriminator,inturn,triestodistinguishbetweenthesourceandtargetdomainsaccurately.
Thisadversarialprocessencouragestheprimarytaskmodeltolearnfeaturesthatarelesssensitivetodomain
variationsandmoretransferablebetweendomains,leadingtoimprovedgeneralizationinthetargetdomain.
Consequently,unsuperviseddomainadaptationwithdomainadversarialtrainingprovidesapowerfulsolutionto
adaptmodelstonewdomainsandimprovetheirperformanceindiversereal-worldsettings,suchasmultimodal
mobileandwearablesensing.
2.3 AdaptingModelstoIndividuals
Severalstudieshavedelvedintodomainadaptationbytreatingindividualsasdistinctdomains,focusingon
trainingmodelswithdatafrommanyindividualsandadaptingthemtoanunseenindividual[29].Thisapproach,
whilehighlyvaluable,presentsarelativelylessnoisyandmorestraightforwarddomainadaptationtasksimilar
topersonalizingthemodelforthetargetindividual,butwithouthavinglabeleddata.Datausedintheadaptation
process comes only from a certain individual. In our work, however, we confront a more nuanced scenario.
Our domain adaptation tasks involve adapting the model across larger source and target domains, broader
thanindividuals.Thisundertakingaddslayersofcomplexity,asitrequiresaddressingthechallengesposedby
variationsacrossgeographicregions,bodypositions,andindividualbehaviorswithinthetargetdomain.Asprior
workhashighlighted[7,49],itisworthadaptingmodelstolargercontextsbeforepersonalizingmodelsbecause
wemightnotbeabletoaccessdatafromindividuals,butwemighthaveaccesstodatafromthebroadertarget
domainanindividualbelongsto.Thisistheaimofthispaper.Hence,weintroducenovelconsiderationsand
methodologiestotacklethismorechallengingandmultifacetedadaptationtask.
2.4 MobileSensingforInferencesRegardingHealthandWell-Being,Behavior,andContext
Mobilesensingusingsmartphonesandwearabledeviceshasfacilitatedthedevelopmentofcontext-awaresystems
thatcaninfervariousaspectsrelatedtohealthandwell-being,behavior,andcontext[41].Thesestudiesleverage
diversesensordatacapturedbymobiledevices,includingaccelerometer,gyroscope,gps,heartratemonitor,
proximity,bluetooth,andappusage,amongothers,togaininsightsintoindividuals’activities,mood,social
Proc.ACMInteract.Mob.WearableUbiquitousTechnol.,Vol.8,No.2,Article46.Publicationdate:May2024.46:6 • Meegahapolaetal.
context, and energy expenditure [6, 9, 10, 41, 50]. Various studies have explored mood inference, aiming to
understandandpredictusers’emotionalstates[44,72].Servia-Rodríguezetal.[72]collectedalarge-scaledataset
frommultiplecountriestoinferbinarymoodusingthecircumplexmoodmodelwithpopulation-levelmodels.
Moodinstabilityhasalsobeenexaminedusingmoodreportsandphonesensordata[56,89].Context-aware
systems have been extended to infer social context, including whether individuals are alone or with others
duringdifferentactivities[51,52].Forexample,Meegahapolaetal.[52]usedsensordatafromSwitzerlandand
Mexicotoinfersocialcontextduringeatingactivities,whileanotherstudy[51]examinedthesocialcontextof
youngadultsduringalcoholdrinkingepisodes.Further,energyexpenditureestimation(EEE)playsacrucialrole
inunderstandingandmanagingchronicdiseaseslikeobesity,diabetes,andmetabolicdisorders[6,91].Italso
enablespersonalizedhealthmanagementbyprovidinginsightsintophysicalactivity,energyconsumption,and
netcalorieintake[40].Wearabledevicessuchasfitnesstrackersandsmartwatcheshavebeenwidelyusedfor
EEEduetotheirconvenienceandcapabilitytomeasureactivity,heartrate,andsleeppatterns[17].Thesedevices
overcomethelimitationsofcostlygoldstandardEEEmethodsandhavebeenpositionedatvariousbodylocations
toestimateenergyexpenditure[18,67].Overall,theexistingliteratureinthefieldofmultimodalsensingoffers
valuableinsightsandtoolsforinferringvariousattributesfromsmartphoneandwearablesensordata.However,
thereisaresearchgapinunderstandinggeneralizationanddistributionalshiftsacrossmanydifferentsettings,
whichthispaperaimstoaddressinthecontextofUDA.TheproposedUDAapproachseekstoimprovethe
generalizationofinferencemodels,makingthemmoreadaptableandrobustindiversesettings.
2.5 DomainGeneralizationinMobileSensing
Achieving model generalization across multiple domains or datasets has been a challenging problem in the
machine learning community. Transfer learning addresses this issue through domain adaptation, where the
modelcanaccesssomedatawithlabelsfromthetargetdomainsinadditiontothesourcedomains[78].Amore
challengingtaskisdomaingeneralization,wherethemodelcanonlyaccessdatafromthesourcedomains[85].In
mobilesensingsettings,Xuetal.[85]examinedthisproblemandsuggestedamodelbasedonmulti-taskneural
networkstocreatearobustmodelthatwouldworkwellintargetdomainswithoutaccesstodataorlabelswhen
training.Eventhoughtheperformanceincreasethattheyreportedwasnothigh(2%to5%),itwasjustifiable
giventhattheinferencetheyperformedregardingdepressiondetectionisalreadyachallengingone.Inaddition,
theyhighlightthatdeeplearning-baseddomaingeneralizationtechniquesdesignedforcomputervisiontasks
donotworkwellonlongitudinalandmultimodalpassivesensingdata.Whiletheyalsousedmultimodaldata,
theyfocusedondomaingeneralizationandnotunsuperviseddomainadaptation,whichisadifferentproblem
setting.AnotherstudybyQianetal.[66]introducedtheGeneralizableIndependentLatentExcitation(GILE)
methodfordomaingeneralization.GILEishighlyadaptabletovaryingactivitypatternsamongindividuals.It
automaticallydisentanglesdomain-agnosticanddomain-specificfeatures,minimizingcorrelationsbetweenthem.
GILE’send-to-endtrainingwiththreelossfunctionsenhancesitsexpressivenessandinformativeness,andthe
empiricalresultsonbenchmarkdatasetsdemonstrateitssuperiorityinhandlingdomainshiftsandimproving
modelgeneralizationacrossindividuals.Whiletheabovepaperslookedintodomaingeneralization,ouranalysis
suggestsashiftfromdomaingeneralizationtodomainadaptation,allowingthemodeltoaccessasmallfraction
ofunlabelleddatafromtargetdomains.
2.6 DomainAdaptationinMobileSensing
Acommonapproachforconductingdomainadaptationisusingdifferentlossfunctions.Reyetal.[22]used
contrastive loss, while Chang and Mathur et al. [13] used maximum mean discrepancy (MMD) loss. Many
other studies [12, 60, 69] also used contrastive learning-based techniques and looked into aligning features
of the latent space to achieve domain adaptation. In this paper, we opted to leverage adversarial training
Proc.ACMInteract.Mob.WearableUbiquitousTechnol.,Vol.8,No.2,Article46.Publicationdate:May2024.UnsupervisedDomainAdaptationforMultimodalMobileSensingwithMulti-BranchAdversarialTraining • 46:7
overcontrastivelearning-basedorotherdiscrepancy-basedtechniquesforseveralreasons.Firstly,ourdomain
adaptationtaskinvolvedlargedistributionshiftsbetweensourceandtargetdomains,wheredatadistributions
differedsubstantially.Domainadversarialtrainingissuitedtoaddressandmitigatesuchdomaindiscrepancies
explicitly,makingitamoreappropriatechoiceforourscenario.Additionally,domainadversarialtraininghas
demonstrateditseffectivenessinvariousdomainadaptationtasks,offeringarobustandestablishedframework
evenforsensordata[13,82].Whilecontrastivelearningisvaluableinmanymachinelearningapplications,it
mayrequiremoreadaptationandnuanceddesigntohandledomainadaptationtaskseffectivelyinmultimodal
sensingsetups.Giventheseconsiderations,wefounddomainadversarialtrainingtobeapragmaticandreliable
choicetoenhanceourmodel’sperformanceinthecontextofmultimodaldata.
Finally,itisalsoworthmentioningtheUDAhasbeenpreviouslytriedformobilesensordatabyChangand
Mathuretal.[13],withdomainadversarialtraining.Theyalsousedadversarialdomainadaptation,similarto
ours.However,theyonlyconsideredasinglemodalityofdataintheirexperiments,hencemakingthetasksimpler
comparedtoourexperiments,whichconsiderfeaturesfrommultimodaldatawithvaryingdegreesofshifts
acrosssourceandtargetdomains.Forexample,insinglemodalitysettings,ifthedataareaccelerometeroraudio
data,dependingontheshiftforthespecificmodality,UDAtechniqueswouldfacilitateadaptation.However,in
mobilesensing,multiplemodalitiesofdataarepresent.Themultimodalsettinghasbeenstudiedinarecent
study[82],byusingallfeaturesasinputusingasingleencoder.Theyalsoperformeddomainadversarialtraining
andobtainedpromisingresults.Nevertheless,existingworkshavelargelyoverlookedthepotentialofleveraging
themultimodalityinherentindataduringthedomainadaptationprocess.Consequently,techniquesspecifically
designedtoharnessthismultimodalityinUDAformobilesensingapplicationsarescarce.Ourpaperattemptsto
bridgethisresearchgapbyintroducingandevaluatingmethodsthatcapitalizeonmobilesensingdata’srichand
multimodalnaturetoenhancedomainadaptationoutcomes.
2.7 Summary
Insummary,ourworkstandsoutfrompreviousstudiesbyspecificallytargetingpassivesensingdatasetscollected
from mobile and wearable devices, diverging from the commonly explored data types like images or audio
[47, 65]. Moreover, we focus on domain adaptation instead of domain generalization [85]. Furthermore, our
approachfocusesonthecomplexityofmultimodaldata,asopposedtothesinglemodalityfocusfrommost
existingliterature[13]ornotconsideringmultimodality[82].Thismultimodalperspectiveiscriticalgiventhe
distinctnatureofmobilesensingdata,whichencompassesavarietyofuserbehaviors,environmentalcontexts,
andhealthindicators.WithM3BAT,weimplementamulti-branchapproachtoaddresstheinherentchallenges
ofmultimodalmobilesensing.Thisframeworkfeaturesmultiplebranches,eachtailoredtohandledistinctsets
ormodalitiesoffeatures,therebyenhancingthemodel’sabilitytoadapt.Byseparatingthedataintodifferent
streams,wehypothesizethatourmodelcanspecializeinprocessingeachmodalityorfeatureset,applyingspecific
transformationsandlearningdomain-invariantrepresentationsmoreeffectively.Thismulti-branchstrategynot
onlysimplifiesthelearningprocessforeachdatatypebutalsoleadstoamorerefinedandrobustadaptation
performance.Ourframeworkallowsforthenuancedintegrationofthediverseandheterogeneousdatasources
thatcharacterizemultimodalmobilesensing,suchasaccelerometerreadings,GPSlocations,activitypatterns,
andappusagelogs.Byleveragingthismulti-brancharchitecture,weshowthatourmodelachievessuperior
generalizationacrossdifferentusersandenvironments.
3 M3BATARCHITECTURE
Inthissection,weaimtodefinetheproposedarchitecture,includingtheintuitionbehindit.Wewillfirstdefinean
unsuperviseddomainadaptationsettingforclassificationandregression(Section3.1).Thiscanberepresentedin
Proc.ACMInteract.Mob.WearableUbiquitousTechnol.,Vol.8,No.2,Article46.Publicationdate:May2024.46:8 • Meegahapolaetal.
agenericformsimilartoDANN[24],asshowninFigure1.TheninSection3.2,wedefinehowmultiplebranches
couldbeusedinbothclassificationandregressioninsteadofasingleencoderthatoutputsafeatureembedding.
ThisisalsoshowninFigure2.Finally,inSection3.3,wedescribehowdifferent𝜆 couldbeusedfordifferent
branches,dependingontheshiftofinputfeaturestothatbranchinsourceandtargetdomains,toimprovethe
performanceofthemodel.ThisissummarizedinFigure3.
3.1 UnsupervisedDomainAdaptationwithDomainAdversarialTraining(DANN)
Giventwodomains,asourcedomain D𝑠 = {(𝑥 𝑖𝑠,𝑦 𝑖𝑠)}𝑛 𝑖=𝑠
1
andatargetdomain D𝑡 = {𝑥𝑡 𝑗}𝑛 𝑗=𝑡 1,where𝑥 𝑖𝑠 and𝑥𝑡
𝑗
represent the input feature vectors from the source and target domains, respectively,
and𝑦𝑠
represents the
𝑖
corresponding class labels in the source domain. The goal is to learn a classifier or regressor 𝑓(𝑥) that can
accuratelyinfertargets𝑦 inthetargetdomainusingthelabeledsourcedomaindataandtheunlabeledtarget
domaindata.Thedomainadversarialtrainingprocessconsistsofthreemaincomponents:
• Encoder:Amulti-layerperceptronneuralnetworkrepresentedby𝐺(𝑥),whichmapstheinputfeature
vectorsindimensionallyreducedsharedfeaturespace,where𝐺 𝑠 =𝐺(𝑥 𝑖𝑠) and𝐺 𝑡 =𝐺(𝑥𝑡 𝑗) representthe
featuresofthesourceandtargetdomainsamples,respectively.
• TargetClassifierorRegressor:Aheadrepresentedby𝐶(𝐺 𝑠),whichtakesthesharedfeatures𝐺 𝑠 asinput
andpredicts𝑦𝑠
inthesourcedomain.
• Domain Classifier: A domain discriminator represented by 𝐷(𝐺 𝑠) and 𝐷(𝐺 𝑡), which takes the shared
features𝐺 𝑠 and𝐺 𝑡 asinput,respectively,andpredictswhetherthefeaturesarefromthesourceortarget
domain.
The overall objective function for unsupervised domain adaptation with domain adversarial training for
classificationorregressioncanbewrittenas:
m 𝐺,i 𝐶nm 𝐷ax 𝑛1
𝑠
∑︁ 𝑖𝑛 =𝑠
1
L𝑦(𝐶(𝐺(𝑥 𝑖𝑠)),𝑦 𝑖𝑠)−
𝑛
𝑠
+𝜆
𝑛
𝑡
𝑛 ∑︁𝑠 𝑖=+ 1𝑛𝑡 L d(𝐷(𝐺(𝑥 𝑖𝑠)),𝐷(𝐺(𝑥 𝑖𝑡)))
where L𝑦 is the classification loss (e.g., cross-entropy loss) or the regression loss (e.g., mean squared error)
functionforthesourcedomainsamples;L istheadversariallossfunction,suchasthebinarycross-entropy
d
loss,forthedomaindiscriminatortodistinguishbetweenthesourceandtargetdomainfeatures;𝜆isaparameter
thatcontrolsthetrade-offbetweentheclassification/regressionandadversarialloss—alsoknownasgradient
reversallayer(usually0 ≤𝜆 ≤ 1),Thefirsttermaimstominimizetheclassificationlossforthesourcedomain
samples,encouragingthemodeltoinferthetargetsinthesourcedomainaccurately;andthesecondtermaims
tomaximizethedomaindiscriminator’sconfusionbetweenthesourceandtargetdomainfeatures,effectively
aligningthefeaturedistributionsofthetwodomainsinthesharedfeaturespace.
In both classification and regression settings, unsupervised domain adaptation with domain adversarial
trainingisapowerfultechniquetoadaptmodelstrainedonalabeledsourcedomaintoperformwellonadifferent,
unlabeled target domain. The adversarial training process encourages the model to learn domain-invariant
features,therebyimprovingthemodel’sgeneralizationtonew,unseendatafromthetargetdomain.Inaddition,
whendefining,whethertouse−𝜆or+𝜆dependsonthelossfunctionusedforthedomaindiscriminator.When
thedomaindiscriminatorisbinarycross-entropywhichprovidesanegativevalue,using−𝜆asaboveworks[24].
3.2 MultipleBranchestoProcessMultimodalData
Torepresentthesetupwithmultiplebranchesforprocessingmodalitiesorfeaturesetsfrommultiplemodalities,
wecanintroduceseparatebranches.Let’sdenotetheencodersas𝐸(𝑚)(𝑥(𝑚)),where𝑚representsthenumber
ofbranchesand𝑥(𝑚) istheinputdatafrombranch𝑚,whichcouldbemultiplefeaturesinthetabulardatasets
thatweconsider.Eachencoderprocessestheinputdatafromitscorrespondingmodalityandmapsittoashared
Proc.ACMInteract.Mob.WearableUbiquitousTechnol.,Vol.8,No.2,Article46.Publicationdate:May2024.UnsupervisedDomainAdaptationforMultimodalMobileSensingwithMulti-BranchAdversarialTraining • 46:9
Architecture I Architecture II Architecture III
∂ ∂L θy y , -λ∂ ∂L θd d ∂ ∂L θy y , -λ∂ ∂L θd d ∂ ∂L θy y , -λ∂ ∂L θd d
∂ ∂L θy
y
∂ ∂L θy
y
∂ ∂L θy
y
loss Ly loss Ly loss Ly
Gradient
loss Ld loss Ld loss Ld
Rev -e λrsal ∂ ∂L θd d RG era v -d e λrie sn at l ∂Ld ∂Ly RG era v -d e λrie sn at l ∂Ld
∂θd ∂θy ∂θd
Fig.1. BasearchitectureforUDAwith Fig.2. Modificationtothebasearchi- Fig. 3. Using different 𝜆 for branches
featuresfrommultimodalsensors,en- tecturetohavemultiplebranchesthat dependingontheaveragedistribution
coder,domainandtargetclassifier/re- concatenatetocreateafeatureembed- shift of features in the branch. When
gressor,andgradientreversallayer. ding. thereislittletonoshift,𝜆≈0(green).
featurespace.Inthiscase,theoverallfeatureextractor𝐺(𝑥),whichusedtobeasingleencoderintheprevious
setups mentioned in Section 3.1, can now be defined as a combination of these multiple encoders for each
modality.Wecanrepresentthisas:𝐺(𝑥) =concat(cid:0)𝐸(1)(𝑥(1)),𝐸(2)(𝑥(2)),...,𝐸(𝑀)(𝑥(𝑀))(cid:1) .Here,𝐺(𝑥)contains
theoutputsfromalltheencoderscorrespondingtothedifferentbranches,andtheseoutputsareconcatenatedto
formasharedfeaturerepresentationthatcapturesinformationfromallfeatures.Withthemultiplebranches,
theobjectivefunctionforunsuperviseddomainadaptationwithdomainadversarialtrainingcanbeextendedto
includeallthemodalities.Withthissetup,eachspecificencoderlearnsafeaturerepresentationspecifictoits
inputdata,andthesharedfeaturespacecreatedbycombiningtheoutputsoftheseencoderscapturesinformation
fromallthemodalities.Thisapproachallowsthemodeltoadapttomultipledatamodalitiessimultaneouslyand
improvesthedomainadaptationperformancebyconsideringthesharedinformationamongdifferentmodalities.
3.3 TrainingProcesswithMultimodalDomainAdversarialTraining
Thetrainingprocessformultimodaldomainadversarialtraininginvolvesastagedapproachtoadaptthemodel
tothetargetdomainwhileconsideringthedistributionshiftacrossdifferentmodalities.Theprocessincludesthe
followingsteps:
3.3.1 Step1:TrainCommonEncoderwithTargetDiscriminator. Inthefirststep,wetrainacommonencoder,𝐺(𝑥),
withonlythetargetdiscriminator(classifierorregressor),𝐷(𝐺(𝑥𝑠)).Thetargetdiscriminatorisresponsiblefor
𝑖
performingeitherclassificationorregression.Duringthisstep,onlythesourcedomaindataisusedfortraining.
Theobjectivefunctionforthisstepistominimizethetargetdiscriminationloss,dependingonwhetheritis
regressionorclassification(Section3.1).
3.3.2 Step 2: Introduce Unlabeled Target Domain Data. After training the common encoder with the target
discriminator,weintroducetheunlabeledtargetdomaindata,D𝑡 = {𝑥𝑡 𝑗}𝑛 𝑗=𝑡 1,intothetrainingprocesstogether
withdomaindiscriminator.Thisisdonetofurtheralignthefeaturedistributionsofthesourceandtargetdomains
inthesharedfeaturespace.Duringthisstep,theobjectivefunctionchangesabitasweaimtoperformboth
domainandtargetinferences,similartowhatwouldhappenifweusedamulti-taskneuralnetwork.Intermsof
gradientreversal,the𝜆=0atthisstage.
3.3.3 Step 3a: Increase𝜆 for Adversarial Objective with Annealing. To increase the impact of the adversarial
objectivegradually,weannealthevalueof𝜆fromzerotooneduringtraining,assuggestedinpriorwork[23,86]
(𝜆 𝑝 = 1+exp2 (−𝛾·𝑝) −1,where𝛾=10and0<=𝑝<=1basedontheepoch).Theparameter𝜆 controlsthetrade-off
betweenthetargetlossandthedomainloss.Increasing𝜆overtimeencouragesthecommonencodertolearn
moredomain-invariantrepresentations,inastableway.InFigure1,weshowthearchitectureatthisstage,which
Proc.ACMInteract.Mob.WearableUbiquitousTechnol.,Vol.8,No.2,Article46.Publicationdate:May2024.
gniddebme
erutaeF
gniddebme
erutaeF
gniddebme
erutaeF46:10 • Meegahapolaetal.
issimilartotheDANNarchitecture[24].Annealing𝜆fromzerotooneworksbecauseitfacilitatesacontrolled
andadaptiveprocessofaligningfeaturerepresentationsbetweenthesourceandtargetdomains,ultimately
leadingtoimproveddomainadaptationperformance.Therationalebehindthisapproachistostartwithminimal
domainalignment(𝜆=0),allowingthemodeltoinitiallyfocusonlearningsourcedomainknowledgewithout
beinginfluencedbythetargetdomain.Astrainingprogressesandthe𝜆parametergraduallyincreases,themodel
isencouragedtoalignthefeaturerepresentationsofbothdomains[23].
3.3.4 Step3b:ReplaceEncoderwithMultipleBranches. Aftertrainingwiththecommonencoderandgradually
increasingtheadversarialobjective,wereplacethecommonencoder,𝐺(𝑥),withamulti-branchsetup(Section3).
Eachencoder,𝐸(𝑚)(𝑥(𝑚)),processestheinputdatafromitscorrespondingmodalityorasetoffeaturesand
mapsittothesharedfeaturespace.Thecombinedfeaturerepresentationisthenformedbyconcatenatingthe
outputsofallthebranches.Withthissetup,steps1andstep2canbefollowedtotrainthemodelwithstagingand
annealing.Inourexperiments,weobservedthathavingastagedprocesswasusefulforstabletraining.Moreover,
thedecisiontotrainthetargetdiscriminatoralongsidethecommonencoderwasmadetoenhancethestabilityof
thetrainingprocess.Startingwithacommonencodersimplifiestheinitialtrainingstageswhilealsoensuring
satisfactoryperformanceonthetargetinference.Upontransitioningtothemulti-branchsetup,wewerepresented
withtwooptions:wecouldeitherfreezethetargetdiscriminator,allowingtheencoderstoindependentlyadjust
todomainshiftsforoptimaltargetinference,orwecouldallowthetargetdiscriminatortocontinuefine-tuning
intandemwiththenewmulti-branchconfiguration.Ourpreliminaryexperimentsindicatedthatmaintainingthe
adaptabilityofthetargetdiscriminatoryieldedbetterresults,whichiswhythisapproachwasadoptedinour
study.Additionally,weobservedthatcommencingthetrainingwithmultipleencodersfromtheoutsetdidnot
leadtoconvergence,suggestingthatagradualbuilduptothemulti-branchsystemwasnecessaryforeffective
training.Moreover,heremaximum𝜆 =1acrossallbranches.InFigure2,weshowthearchitectureatthisstage.
3.3.5 Step 3c: Increase𝜆 for Different Branches with Annealing. We train the model as in Step 3b. Then, we
adaptivelydecreasethevalueof𝜆from1ifneeded,foreachbranchwithannealing,untilitreaches𝜆 𝑚(0 ≤𝜆 𝑚 ≤𝜆
=1).The𝜆 𝑚values,whichcontroltheimpactoftheadversarialobjectiveforeachspecificencoder,aredetermined
basedontheaverageCohen’s-dvalue[16]foreachfeaturegroup.Then,theCohen’s-dvaluesacrossthebranches
werenormalizedtoavaluebetween0and1.IftheCohen’s-dofthelowestbranchisabove0.2(abovesmalleffect
size),azerowasintroducedartificiallybeforenormalizingtoensureaconsiderableshiftdoesnotgounnoticed
whenperformingadversarialtrainingwithdifferent𝜆 𝑚.Asanexample,iftheCohen’s-dvalueswere0.8,0.6,
and 0.05, the𝜆 𝑚 values would be 1, 0.58, and 0. If the Cohen’s-d values from branches were 0.9 and 0.4, we
wouldintroducea0tomakeit0.9,0.4,and0because0.4isabovesmalleffectsize,andobtain𝜆 𝑚s1and0.44
forthetwobranches.Hence,thisaccountsforthedistributionshiftbetweenthesourceandtargetdomains
specifictoinputfeaturestoeachbranch.Figure3,weshowthearchitectureatthisstage.Itisalsoworthnoting
thatweconsideredtwoprimarysetupswhenselectingfeaturesfordifferentbranchesintheencodersection
of the model: Setup 1 utilized branches based on modalities in the WENET dataset, creating three branches
correspondingtothemodalitieswiththehighest,lowest,andintermediatelevelsofshift.Duetooptimization
challengesdiscussedinSection6,welimitedthenumberofbranchestothree,normalizingtheCohen’s-dvalues
forthesebranches,withthehighestshiftsetto1andthelowestto0.Experimentswerefirstconductedwitha
uniformweight(𝜆 =1)acrossbranches,followedbyvaryingweights(𝜆 𝑚)inaccordancewiththelevelofshift.
Asimilartwo-branchapproachwasadoptedintheWEEEdataset,withonlytwomodalities.Thiswasmainly
becausetherewereonlythreemodalitiesinthisdatasets.ForSetup2,appliedtobothdatasets,wesortedfeatures
byshiftmagnituderegardlessofthemodality,dividingthemintothreeequalgroups(top33%,bottom33%,and
middle33%).Different𝜆 𝑚 valueswereassignedtothesebranchesbasedontheirrespectiveshifts.Bothsetups,
involvingtailored𝜆 𝑚 adjustments,representourmethodicalapproachtoeffectivelymanagedomainshiftsin
multimodalmobilesensingdata.MoredetailsregardingthesetwosetupswillbediscussedinSection7.1.
Proc.ACMInteract.Mob.WearableUbiquitousTechnol.,Vol.8,No.2,Article46.Publicationdate:May2024.UnsupervisedDomainAdaptationforMultimodalMobileSensingwithMulti-BranchAdversarialTraining • 46:11
Withthisstagedtrainingprocess,themultimodaldomainadversarialtrainingalgorithmcaneffectivelyadapt
themodeltothetargetdomainwhileconsideringthedistributionshiftacrossdifferentmodalitiesorfeature
groups(e.g.,regardlessofthemodality,featureswithahigh,moderate,andlowdistributionshiftinseparate
branches).Thehypothesisisthatthisapproachwouldallowthemodeltolearndomain-invariantrepresentations
capable of capturing relevant information from all modalities, improving the generalization and adaptation
performancetonew,unseendatainthetargetdomain.
4 DATASETSANDINFERENCES
Toexamineourarchitecture,weusedmultipledatasets.Boththesedatasetshavebeenusedinpreviouspublica-
tions,andinferencesthatcanbemadewiththemtoo,aredefined.Hence,theobjectiveistoperformthesame
inferenceswhileexaminingtheproposedarchitectures.
4.1 WENET:MultimodalSmartphoneSensingDatasetfrom8Countries
TheWENETdatasetcomesfromourpreviouswork[49].Thedatacollectionspannedfourweeksandinvolved
over670collegestudentsfromeightuniversitiesineightcountries:Italy,Denmark,theUnitedKingdom,China,
India,Mongolia,Paraguay,andMexico.Participantscontributedthreedistincttypesofdata:(i)closed-ended
questionnaires (to capture demographic information such as age, sex, country, etc.), (ii) hourly self-reports
throughout the day (to capture hourly mood, social context, etc.), and (iii) sensor data (continuous sensing
modalitiessuchasactivitytype,stepcount,Bluetooth,WiFi,location,cellular,andproximity;andinteraction
sensing modalities including app usage, touch events, screen on/off episodes, and notifications.). All sensor
measurementswereaggregatedwithself-reportstocreatefeaturescharacterizingthetimewindowduringwhich
thereportoccurred.Thefinaldatasetweobtainedhasover100features(formoredetailedinformationonthe
dataprocessingpipelineandextractedfeatures,pleasereferto[49]).Regardingmissingdatainthecontextof
smartphonesensing,itcanariseduetovariousreasonssuchasthedevicebeinginlow-consumptionmode,
sensorfailure,userprivacysettings,airplanemode,orhardwarelimitationsincertainphonemodels.Toaddress
thisissue,featuremodalitieswithmorethan70%missingdata,namelyBluetoothlowenergy,Bluetoothnormal,
CellularGSM,andCellularWCDMA,weredroppedsimilartopriorwork[7,70].Moredetailsregardingtheused
featurescanbefoundinAppendixA.
4.2 WEEE:MultimodalWearableSensingDatasetforEnergyExpenditureEstimation
TheWEEEdatasetwascollectedfrom17participants(12menand5women)bytheauthorsof[25].Theprocessed
versionofthedatasetweusedinthispaperwasobtainedfromtheauthorsof[6].Thedatacollectionprocess
involvedcapturinginformationduringtheexecutionofthreespecificactivities:resting,cycling,andrunning.
Participantswereequippedwitheightdifferentwearabledevices,includinganIndirectCalorimeterdevice,which
servedastheground-truthmeasurementforenergyexpenditureestimation.Alongsidesensordata,thedataset
alsoencompassesdemographicandbodycompositiondetails,activityspecifics,andquestionnaire-baseddata
obtainedfromeachparticipant.Despitetheuseofeightdevicesduringdatacollection,onlythreedeviceswere
selectedforthisstudyduetoinconsistencies,missingdata,andalsobecausetheycontaincomparablemultimodal
data,allowingustoconductdomainadaptation.Thesedevicesandtheirrespectivesensorsareabbreviatedas
follows:i)NokiaBellLabsEarbuds:accelerometer,gyroscope,PPG;ii)EmpaticaE4Wristband:accelerometer,
PPG;iii)MuseSHeadband:accelerometer,gyroscope.Hence,theobjectiveistoinferandestimateaperson’s
energy expenditure in a particular moment (the ground truth values come from VO2 Master Analyzer Face
Proc.ACMInteract.Mob.WearableUbiquitousTechnol.,Vol.8,No.2,Article46.Publicationdate:May2024.46:12 • Meegahapolaetal.
Table1. Summaryofdatasets,sourceandtargetdomains,modalitiesused,andtheperformedinferences.Cstandsfor
classificationandRstandsforregression.
Dataset Source Targets Modalities Inferences
Location,Bluetooth,Wifi,
India,China,
Cellular,Notifications,Proximity, Mood(C)[49]
WENET Italy Mexico,Paraguay,
ActivityType,Steps,ScreenEvents, SocialContext(C)[36,46,52]
UK,Denmark
Userpresence,Touchevents,Appevents
Location,Bluetooth,Wifi,
India,China,
Cellular,Notifications,Proximity, Mood(C)[49]
WENET Mongolia Mexico,Paraguay,
ActivityType,Steps,ScreenEvents, SocialContext(C)[36,46,52]
UK,Denmark
Userpresence,Touchevents,Appevents
WEEE EarBuds Empatica Accelerometer,Photoplethysmography EEE(R)[6]
WEEE EarBuds Muse Accelerometer,Gyroscope EEE(R)[6]
Mask:VO2(ml/kg/min)asthegoldstandardgroundtruth1),basedondatafromwearabledata.Sourceandtarget
domaincombinationsweredeterminedbasedontheavailabilityofcommonsensorsinwearabledevices.Further,
moredetailsregardingtheusedfeaturescanbefoundinAppendixB.
4.3 DomainsandInferenceTasks
Ourintentionhereistodelineatethevariousexperimentalsettingsencompassingmultipledatasetsandinferences.
AsdepictedinTable1,ourfocusisontwospecificdatasets:WENETandWEEE.
WENET dataset was employed to facilitate domain transfer across distinct countries, a problem setting
motivated by previous studies [7, 49]. Accordingly, we considered Italy (𝑁 𝑖𝑡𝑎𝑙𝑦=151,342 from 240 users) and
Mongolia(𝑁 𝑚𝑜𝑛𝑔𝑜𝑙𝑖𝑎=94,006from214users)assourcedomains.Thiswasdonebecausethesetwocountrieshave
largerdatasets.Multipletargetdomains,namelyIndia(𝑁 𝑖𝑛𝑑𝑖𝑎=4,233from39users),China(𝑁 𝑐ℎ𝑖𝑛𝑎=22,289from41
users),Mexico(𝑁 𝑚𝑒𝑥𝑖𝑐𝑜=11,662from20users),Paraguay(𝑁 𝑝𝑎𝑟𝑎𝑔𝑢𝑎𝑦=9,744from28users),UK(𝑁 𝑢𝑘=26,688from72
users),andDenmark(𝑁 𝑑𝑒𝑛𝑚𝑎𝑟𝑘=10,010from24users)wereconsideredforeachsourcedomain.Thesecountries
havecomparativelysmallerdatasetscomparedtosources.Thisalsoshowshowthetechniqueperformswell
withlimitedtargetdata.Consequently,ouranalysisspannedatotalof12source-targetpairswithintheWENET
dataset.Foreachpair,weundertooktwoclassificationtaskspreviouslydefined:atwo-classmoodinference
(positivevs.negative)[49]andatwo-classsocialcontextinference(alonevs.withothers)[36,46,52].Boththese
tasksholdsignificanceinthecontextofdigitalhealthandmobilefooddiaryapplications.Itisworthnotingthat
thegroundtruthfortheinferencesare:i)mood,whichissubjective,andsilver-standard2becauseitiscaptured
withself-reports;andii)socialcontext,whichismoreobjective,butstillsilver-standardbecauseofself-reports.
OurapproachwiththeWEEEdatasetrevolvedarounddomaintransferacrossdiversedevicessharingcommon
sensormodalities.Thistaskisalsomotivatedbypriorworkthathighlightstheimportanceofdomainadaptation
fordevicesacrossbodypositions[13,22].Itisnoteworthythatnotalldevicesintheoriginaldatasetpossess
identicalsensors.Forinstance,theNokiaBellLabsearbudscompriseanaccelerometer,gyroscope,andPPG
sensor,whiletheEmpaticaE4wristbandlacksagyroscope.Consequently,ourexperimentsencompasstwosetups:
1Inmachinelearningterms,theterm"gold-standard"referstothehighestlevelofaccuracyorreliabilityingroundtruthlabelsorannotations.
Gold-standardannotationsareoftenobtainedusingmethodsthatareconsideredhighlyreliableoraccurate,suchasexpertmanualannotations,
precisemeasurements,orcomprehensiveandwell-establishedcriteria[21,82].
2Inmachinelearningterms,theterm"silver-standard"isusedtodescribeannotationsorgroundtruthlabelsthatareofloweraccuracy
orreliabilitycomparedtothegold-standardbecauseofuncertainty,bias,and/ornoise.Theyarestillconsideredusefulandinformative,
andarecommonlyusedininferences.Theseannotationsmightbeobtainedthroughlessstringentmethods,suchasautomatedalgorithms,
self-reports,surrogatemeasures,orindirectobservations[21,82].
Proc.ACMInteract.Mob.WearableUbiquitousTechnol.,Vol.8,No.2,Article46.Publicationdate:May2024.UnsupervisedDomainAdaptationforMultimodalMobileSensingwithMulti-BranchAdversarialTraining • 46:13
firstly,treatingEarBuds(𝑁 𝑒𝑎𝑟𝑏𝑢𝑑𝑠=9,226from17users)asthesourcedomainandEmpatica(𝑁 𝑒𝑚𝑝𝑎𝑡𝑖𝑐𝑎=9,226from
17users)asthetargetdomain,utilizingaccelerometerandPPGdatafrombothdevices;secondly,considering
EarBuds as the source domain and the Muse S headband (𝑁 𝑚𝑢𝑠𝑒=9,226 from 17 users) as the target domain,
leveragingaccelerometerandgyroscopeasthesensingmodalities.Itisworthnotingthatdatafromalldevices
werecollectedsimultaneouslyfromdifferentbodypositions,hencethesamenumberofdatapoints.Inboth
setups,weadoptedenergyexpenditureestimation[26]asthetargetinference,constitutingaregressiontask.
Thisinferenceisfurthercharacterizedandvalidatedinpriorstudies[5,6,19,61].Itisworthnotingthatthe
groundtruthhereisthegoldstandardforenergyexpenditureestimation.
5 RQ1:USINGSTATISTICALTESTSTOQUANTIFYDISTRIBUTIONSHIFTOFSENSORS
5.1 Methodology
Theaimofthisanalysisistoprovideempiricalevidencefortherationalebehindthedevelopmentofamulti-
brancharchitecture.Inaccordancewithpreviousstudies[78],twoprimarymethodsforquantifyingdistribution
shiftarestatisticaltests[58]andinferenceperformancemetrics[49].Statisticaltest-basedtechniquesareknown
fortheircost-effectivenessandabilitytoofferageneralestimationoftheshiftforeachsensingmodality[58].
Thus,wecouldemploycommonstatisticaltestssuchast-test[38],PERMANOVAandPERMDISP[58],and
Cohen’s-d[16]toassessthedistributionshiftofsensormodalitiesforeachtargetinference.Inthiscontext,after
aninitialanalysisofthesetests,weselectedCohen’s-dforouranalysisduetoitsrelativelylineardistribution
ofvalues[7,49,58],withinarangeapproximating0and1.Mostimportantly,itallowedthebestdownstream
performancefordomainadaptation.Inaddition,theruleofthumbof0.8orabove:largeeffectsize,0.5:moderate
effectsize,and0.2:smalleffectsizeallowseasyinterpretation[16].Thischaracteristicfacilitatedtheutilization
ofnormalizedvaluesinourarchitecturefor𝜆 𝑚 (Section3.3).Pleasenotethatweusethetermsdistributionshift
orshiftbetweentwomodalitiesinterchangeablytorefertoCohen’s-dfromthispointonward.
For the WENET dataset, our initial step involved calculating Cohen’s-d values for all captured features.
Subsequently,weaggregatedthesevaluesbycomputingthemeanforeachmodality(e.g.,wifi,steps,proximity,
location, etc.). By designating Italy and Mongolia as source domains, we plotted the results for other target
domains(Figure4andFigure5).Thisapproachenabledustocomprehendhowmodalitiescouldexhibitvarying
degreesofdistributionshiftsforthesamesourceandtargetdomains.Theunderlyingconceptistodemonstrate
thataggregatingfeaturesbymodalitiesfacilitatethedifferentiationofhighandlowlevelsofdistributionshifts.
Continuing,weproceededtovisualizeCohen’s-dvaluesforallfeatures,assigningdistinctmodality-specific
colorstoeachbarforenhancedclarity(Figure6).Thisvisualizationaimedtoprovideinsightsintowhether
distributionshiftsoftenemanatefromthesamesetofmodalitiesorifthereareinstancesofoutlierswithhigh
Cohen’s-dvaluesfromspecificmodalitiesexhibitingrelativelylowlevelsofdistributionshiftoverall.Dueto
spacelimitations,weonlyshowthedistributionforthecasewhenItalyisthedomain,andIndiaisthetarget
domain.
FortheWEEEdataset,wedidasimilaranalysis.WeaggregatedCohen’s-dvaluesbycomputingthemean
for each modality (e.g., acc, ppg, gyro — Figure 7). It is worth noting that, in the setup of transferring from
EarBudstoEmpatica,onlyaccelerometerandPPGdataareavailable.IntheothercaseofEarBudstoMuse,only
accelerometerandgyroscopedataareavailableascommonfeatures.Continuing,weproceededtovisualize
Cohen’s-dvaluesforallfeatures,assigningdistinctmodality-specificcolorstoeachbarforenhancedclarity.This
wasdoneseparatelyforpairsEarBudsandEmpatica(Figure8)andEarBudsandMuse(Figure9).
5.2 Results
ForWENET,Figures4and5presentthequantificationofdistributionshiftusingCohen’s-dvalues,whichindicate
theeffectsize.Thex-axesrepresentmodalities,whilethey-axesshowtheshift.Eachmodalityiscolor-codedto
Proc.ACMInteract.Mob.WearableUbiquitousTechnol.,Vol.8,No.2,Article46.Publicationdate:May2024.46:14 • Meegahapolaetal.
Fig.4. AverageCohen’s-dvaluesformodalities.Italyisthesourcedomain.
Fig.5. AverageCohen’s-dvaluesformodalities.Mongoliaisthesourcedomain.
Fig.6. Cohen’s-dValuesItalyandIndia,sortedindescendingorder.Modalitiesaremarkedindifferentcolors.
representthetargetdomain.Notably,thefiguresrevealthatvariouscountrieshavediversemodalitiesthatexhibit
thehighestandlowestdistributionshiftscomparedtoItaly.Forinstance,WiFiisprominentforIndiaandtheUK,
proximityforChinaandDenmark,screenforMexico,andtouchforParaguay.Thispatternremainsconsistent
whenthesourceisMongolia,exceptfortouchinMexicoandDenmark,andWiFiinParaguay.Moreover,when
analyzingshiftswithinthetargetcountries,thevaluesfordifferentmodalitiescontrast.Forinstance,withItaly
asthesource,thetargetdomainIndiaexhibitsWiFiandstepswithaCohen’s-dofaround0.5(mediumeffect
size).Conversely,allmodalitiessuchasapp,screen,user,andactivityhavevaluesbelow0.1(verysmalleffect
size),indicatingminimaldistributionshift.Similartrendsareobservedforothercountries,evenwhenMongolia
isthesource.However,itisimportanttonotethatthesediagramsdonotaccountforindividualfeatureswithin
modalities,whichcouldhavehighdistributionshifts,buttheirimpactmightbemitigatedbynumerousother
featureswithinthesamemodalitywithlowshifts.ThisaspectisdemonstratedinFigure6,wherethedistribution
shiftofeachfeatureforsourceItalyandtargetIndiaisplotted,withcolorsdenotingmodalities.Whilewecannot
visualizeallsuchfeaturesacrossvarioussource-targetdomainpairs,wehaveidentifiedaconsiderablenumberof
suchcasesthathighlightsignificantshiftsdespitetheoveralllowshiftinthemodality.
Proc.ACMInteract.Mob.WearableUbiquitousTechnol.,Vol.8,No.2,Article46.Publicationdate:May2024.UnsupervisedDomainAdaptationforMultimodalMobileSensingwithMulti-BranchAdversarialTraining • 46:15
Fig.8. Cohen’s-dvaluesforEarBuds
Fig.9. Cohen’s-dvaluesforEarBudsand
andEmpatica,sortedindescending
Fig. 7. Average Cohen’s-d values for Muse, sorted in the descending order.
order.Modalitiesaremarkedindiffer-
modalities.EarBudsisthesourcedomain Modalitiesaremarkedindifferentcolors.
entcolors.
Moving to the WEEE dataset, in Figure 7, we illustrate the modality-specific shifts for the source-target
pairsofEarbudsandEmpatica,aswellasEarbudsandMuse.FortheEarBudsandEmpaticapair,itisevident
thataccelerometerfeaturesexhibitasubstantialshift(Cohen’s-dof≈1—indicatingalargeeffectsize),whereas
PPGfeaturesdemonstrateonlyasmallershift(Cohen’s-dof≈0.2—reflectingasmalleffectsize).Similarly,a
contrastingpatternisobservedfortheEarBudsandMusepair,withaccelerometerandgyroscopemodalities
showcasingnoticeableshifts.Notably,eventhegyroscopeexhibitsaconsiderableshiftinthiscontext(Cohen’s-d
around 0.6—indicating an above-medium effect size). To delve deeper into this analysis, we present feature-
specificshiftsinFigure8andFigure9.RegardingtheEarBudsandEmpaticapair,feweroutliersareobserved
comparedtothemodality-specificpattern.Mostfeatureswithabove-mediumeffectsizesprimarilyoriginate
fromtheaccelerometer,whilePPGfeaturestendtoexhibitsmalltomediumeffectsizes,indicatingsmallershifts.
Conversely,inthecaseoftheEarBudsandMusepair,thefeaturesexhibitamoremixeddistribution,deviating
fromthemodality-specificshiftshighlightedinFigure7.
Insummary,inansweringRQ1,thestatisticalanalysissuggeststhatitmightbepossibletocategorizefeatures
intogroupswithhigh,medium,orlowdistributionshiftsbasedonmodalitiesorbyconsideringmixedfeature
groupsderivedfrommultiplemodalitieswithprominenteffectsizes.Theseinsightsdirectlyaddressthedesignof
thearchitecturethatweusetoanswerRQ3,whereweproposetheuseofmultiplebranchesfordistinctfeature
groups,asdetailedinSection3.2.
6 RQ2:DOMAINADVERSARIALTRAININGWITHMULTIMODALSENSINGFEATURES
6.1 Methodology
Asthenextstep,weperformeddomainadversarialtrainingusingthebasearchitecturedescribedinSection3.1.
OurexperimentswereimplementedinPython,withTensorFlow[1],Keras[14],andPyTorch[62].Thearchitecture
consistsofanencoderwithoutconsideringthemultimodalityofthedata.Ourdatasetsplittinginvolvedseparating
training(70%)andtesting(30%)setstoensurenon-overlappingusers,facilitatingleave-k-outcross-validation
[31].Weconductedfivesuchrandomtrainingandtestingsplitstoensurerobustnessandreportedtheaverage
results.Thisexperimentalsetupissimilartotheapproachproposedin[13],withthedistinctionthatweemployed
processedtabularfeaturesfrommultiplemodalities,similarto[54,82],insteadoftherawsensorvalueswitha
featureextractor.
FortheWENETdataset,weinitiatedouranalysisbytrainingmodelsonthetrainingsetsforItalyandMongolia
assourcedomains.OurmodelarchitecturewasdesignedtoinferMoodandSocialContext,withintermediate
Proc.ACMInteract.Mob.WearableUbiquitousTechnol.,Vol.8,No.2,Article46.Publicationdate:May2024.46:16 • Meegahapolaetal.
layersizesof128,128,and64,allwiththeReLUactivation[4].Dropout[74]wasusedwithratesof50%,50%,and
20%tomitigateoverfitting.Weusedsigmoidactivation[20]andbinarycross-entropylossfunction[80],suitable
for the two-class nature of our inferences. Adam optimizer [39] and a batch size of 32 was chosen. We also
implementedearlystoppingtopreventoverfittingafterfiveepochsofnon-improvingvalidationlosswithin{0,
300}epochs.Performanceevaluationemployedtheareaunderthereceiveroperatingcharacteristiccurve(AUC)
withmacroaveraging,whichconsidersclassimbalance[7,49].Evaluationofthemodelsbeganbyassessingthe
performanceoftheSourcemodelontheSourcetestingset(S->S).Theseresultswereaveragedacrossthefive
iterations.Subsequently,weevaluatedtheSourcemodelontheTargetdatasets(S->T).Duetomultipletargets
foreachsource,weaveragedtheresults.Wealsofine-tunedthesourcemodelontargettrainingsetswithtransfer
learningandevaluatedonthetargetdomaintestingset(S->T(w/TL)).Notethatthissetupisnotunsupervised
andneedslabelsinthetargetdomain.Wethenproceededwithdomainadversarialtraining(DANN[24]),as
outlinedinSection3.3—Step3a,wherewefirsttrainedtheencoder(withlayersizes128and64)andlaterthe
targetclassifier(withintermediatelayersizes64and32)anddomainclassifier(withintermediatelayersizes64
and32).Theseclassifiersemployedsigmoidactivationandbinarycross-entropylossattheirrespectivefinal
layers.Afixed𝜆 =1wasusedforgradientreversalduringencodertraining.Datawithlabelsfromthesource
domaincontributedtothelossforbothdomainandtargetclassifiersduringtraining,whileunlabelledtarget
domaindataonlycontributedtothedomainclassifierloss.
EvenforWEEEdataset,themethodologywassimilartothatoftheWENETdataset,albeitwithsmallermodels
duetothedataset’ssize.WetrainedmodelsforEarBuds,utilizingaccelerometerandPPGdata,andforEarBuds
withaccelerometerandgyroscopedata.Thesemodalitycombinationswerechosentoallowdomainadaptation
fortwodevices,asdescribedinTable1.Themodelsweredesignedtoinferenergyexpenditureestimation,with
intermediatelayersizesof64and32,andusingtheReLUactivationfunction.Dropoutwithratesof30%and20%
wasusedforregularization.Themeansquarederrorlossfunctionwasutilizedgiventhatitisaregression—Adam
optimizerandabatchsizeof16facilitatedmodeltraining.Earlystoppingwasalsoimplemented.Theevaluation
processmirroredthatoftheWENETdataset.DANN,followingtheprocessoutlinedinSection3.3,involved
trainingtheencoder(withlayersizes64and32)andlaterthetargetregressor(withintermediatelayersize32)
anddomainclassifier(withintermediatelayersizes32and16).Thetargetregressoremployedmeansquared
error,andthedomainclassifieremployedsigmoidactivationandbinarycross-entropylossattheirfinallayers.
Hence,insummary,theinferencesthatweconductedacrossbothdatasetsaregivenbelow.
• S->S:performanceofthemodeltrainedinthesourcedomain,forthesourcetestingset.Thisprovidesan
upperboundforthepossibleresultsinthetargetdomain.
• S->T (w/ TL): performance of the model trained in the source domain for the target testing set after
fine-tuningthetargettrainingsetwithtransferlearning.Thissetupassumesthatlabelsareavailableinthe
targetdomain,hencecouldleadtohigherperformanceandactasanotherceilingforperformance.Itisalso
worthnotingthatgroundtruthlabelsusedintrainingmodelscanbegold-standardorsilver-standardas
mentionedinSection4.InWENET,groundtruthisthesilverstandardastheyareself-reportsthatcanbe
noisy.However,moodreportscanbesubjectiveandsocialcontextreportsaremoreobjective,potentially
leadingtodifferencesintheaccuracyandnoisyness[50].InWEEE,thegroundtruthisthegoldstandard.
• Random:performanceofarandomclassifier/regressoronthetargettestingset.
• S->T:performanceofthemodeltrainedinthesourcedomainforthetargettestingset.
• DANN [24], MMD [13], ADDA [76]: performance of the model trained in the source domain and
unlabelledtargetdata(trainingset),onthetargettestingset.Methodsusedincludedomainadversarial
training(DANN)assuggestedinearliersectionsand[24];maximummeandiscrepancy(MMD)loss-based
adaptationassuggestedby[13];andadversarialdiscriminativedomainadaptation(ADDA)assuggestedby
[76].Thesetechniqueshavebeenshowntoperformreasonablyinsensing-basedinferencetasks[13,65,82].
Proc.ACMInteract.Mob.WearableUbiquitousTechnol.,Vol.8,No.2,Article46.Publicationdate:May2024.UnsupervisedDomainAdaptationforMultimodalMobileSensingwithMulti-BranchAdversarialTraining • 46:17
Table2. Resultsforclassificationtasks.ResultsarepresentedasaverageAUCscores(higherthebetter).TLreferstotransfer
learningwherelabelledtargetdomaindataareavailable.
Dataset WENET WENET WENET WENET
Inference Mood Mood SocialContext SocialContext
Source Italy Mongolia Italy Mongolia
Targets Avg.ofCountries Avg.ofCountries Avg.ofCountries Avg.ofCountries
RQ2
Random 0.45±0.12 0.46±0.08 0.42±0.14 0.44±0.11
S->S 0.61±0.04 0.59±0.06 0.63±0.03 0.65±0.04
S->S–Meegahapolaetal.[49] 0.55±0.05 0.49±0.08 - -
S->S–Maderetal.[46] - - 0.66±0.02 0.73±0.06
S->T 0.46±0.08 0.48±0.07 0.44±0.03 0.49±0.08
S->T(w/TL) 0.51±0.05 0.52±0.06 0.56±0.05 0.55±0.07
S->T–Meegahapolaetal.[49] 0.48±0.01 0.50±0.00 - -
S->T–Maderetal.[46] - - 0.57±0.06 0.55±0.08
MMD[13] 0.49±0.08 0.54±0.08 0.51±0.04 0.52±0.09
ADDA[76] 0.49±0.11 0.50±0.07 0.51±0.08 0.51±0.06
DANN[24] 0.52±0.07 0.53±0.02 0.52±0.03 0.54±0.05
RQ3
Ours(𝜆=1,Setup1) 0.55±0.05 0.52±0.06 0.55±0.06 0.57±0.05
Ours(w/𝜆 𝑚,Setup1) 0.56±0.04 0.53±0.07 0.56±0.04 0.57±0.05
Ours(w/𝜆 𝑚,Setup2) 0.58±0.04 0.54±0.03 0.55±0.05 0.55±0.03
Inadditiontotheaforementionedresults,wehavealsoincludedthestate-of-the-artperformancesforS->S
andS->T,asreportedintheoriginalpapersthatproposedthesespecifictasks,usingthesamedatasets.Mood
inferenceresultswereextractedfrom[49],socialcontextinferencefrom[46],andtheEEEfrom[6].Itisimportant
tonotethattheoriginalstudyconductedexperimentsusingonlyfivecountriesforsocialcontextinference.
Consequently, the S->T performance reported therein cannot be directly compared with the performance
presentedhere.Furthermore,alltheaforementionedpapersachievedthebest-performingmodelsusingclassic
machinelearningtechniques,suchasrandomforestclassifiersandXGBoostmodels.Whilethesemodelsyield
highperformanceonthedatasets,theycannotbedirectlyappliedtothedomainadaptationalgorithmsunder
investigationinthiswork.
6.2 Results
Table2presentstheclassificationoutcomesfortheWENETdataset,formoodandsocialcontextinferences.The
resultsshowthemodel’sperformanceunderdifferentscenarios.Specifically,S->Sshowcaseshowthemodel
performs when evaluated on the source testing set. The inferred values fall within the range of 0.59 to 0.61
AUC.Althoughtheperformanceinthesourcedomainisnotnotablyhigh,thisalignswithtrendsobservedin
recentresearchfocusedonmentalwell-beingandcontextualinferenceusingmultimodalmobilesensingdatasets
[49,85].Despitenotachievinghighlevelsofperformance,theseresultsstillprovideafoundationforinvestigating
domainadaptationtechniques,whereevensmallenhancementsinperformanceontargetdomainsarecrucial.
S->Tiswherethemodeltrainedonthesourcedomainisevaluatedonthetargetdomain’stestingset.Asexpected,
performanceexperiencesadeclineacrossallfourinferencescomparedtoS->S.Withtransferlearningfine-tuning
(S->T(w/TL)),theperformanceimprovesacrossallfourinferencesasexpectedbecauseituseslabelsinthe
targetdomain.Interestingly,theapplicationof DANNleadstofurtherperformanceenhancementsacrosssocial
contextinferenceswhileshowingaslightperformancedeclinecomparedtoS->T(w/TL)formoodinference.
Thiscouldbebecausemoodlabelsaremoresubjective;henceevenhavinglabelsinthetargetdomainisless
Proc.ACMInteract.Mob.WearableUbiquitousTechnol.,Vol.8,No.2,Article46.Publicationdate:May2024.46:18 • Meegahapolaetal.
useful,whereasDANNleadstomarginallybetterresults.However,forsocialcontext,whichismoreobjective
groundtruth,havinglabelsledtoincreasedperformance,evenmorethantheadaptedmodelwithDANN.Hence,
whilefurtherworkisneeded,thiscouldsuggestthatthelabelsourcequalityandobjectivitymighthaveaneffect
onfine-tuningordomainadaptationperformance.
Table3presentstheregressionoutcomesfortheWEEEdataset,focusingonenergyexpenditureestimation
(EEE)inference.Inthiscontext,EarBudsservesasthesourcedomain,whileEmpaticaorMuseservesasthetarget
domain.Thesourcedomainperformance(S->S)yieldsMAEvaluesof0.62and0.59forEarBuds,representing
the desired ceiling performance. The random baseline, on the other hand, delivers poor results. In the S->T
scenario, the performance exhibits a reduction of approximately 0.17 MAE and 0.21 MAE for Empatica and
Muse,respectively.Notably,theapplicationoftransferlearning(S->T(w/TL))resultsinimprovedperformance
comparedtoDANN.ThisstandsincontrasttomoodinferenceintheWENETdatasetresults,whereDANN
marginallyoutperformedtransferlearningformoodinference.Thedivergenceinresultscanbeattributedtothe
natureoflabels;theWENETdatasetemployssilverstandardlabelsderivedfromuserself-reports,however,with
highandlowsubjectivityformoodandsocialcontext,respectively,whilebothlabelscouldalsobesusceptibleto
noise.Ontheotherhand,theWEEEdatasetleveragesgold-standardlabelsderivedfromlab-basedmeasurements.
Ourfindingsunderscorethatwhiletransferlearningwithsilverstandardlabels,especiallywhenhavingsubjective
groundtruth,doesnotuniversallyguaranteeperformancegains,itcouldpotentiallyprovideanalternativeceiling
performance(abaselineforthemaximumperformancethemodelcouldreach).Itisnoteworthy,however,that
transferlearningnecessitatestheavailabilityoflabelsinthetargetdomain,whichisnottheprimaryscenariowe
areaddressing.
In conclusion, when tackling RQ2, our exploration revealed that domain adversarial training applied to
multimodalmobilesensingdatasetstranslatestoenhancedperformancecomparedtoS->Tsetting.Notably,for
moodinferenceintheWENETdataset,theobservedincreaseevensurpassed/equaledthatachievedthrough
transferlearning.Thisphenomenoncanlikelybeattributedtothepresenceofsilverstandard,andpotentially
subjectivelabelsinthisdataset.Ontheotherhand,whenexaminingtheWEEEdataset,DANNcontributedto
improvedperformance,althoughnotreachingthesamelevelastransferlearning,whichwastobeexpected.
Thisdiscrepancycouldbeattributedtothepresenceofhigh-qualitygoldstandardlabelsavailableinboththe
sourceandtargetdomains,whichwereeffectivelyutilizedfortrainingmodels.Thiscallsforfurtherresearchin
thisdirectioninthefuture.
7 RQ3:MULTI-BRANCHDOMAINADVERSARIALTRAINING
RQ3inourstudyismotivatedbythenuancedfindingsfrombothRQ1andRQ2,whichhighlightthevariable
degreesofdomainshiftacrossdifferentmodalities.Theseinsightssuggestthatdistinctivelytreatingmodalitiesor
featuregroupscouldyieldimprovedperformance.Thishypothesisstemsfromtheunderstandingthatmodalities
withlesserdistributionshiftsmaybenefitfromminimaladaptation,whilethosewithhighershiftsmightrequire
moreintensiveadaptationstrategies.Asingleencoderstructure,asusedinDANN,doesnotallowforthislevel
oftailoredadaptationacrossmodalities.Therefore,RQ3explorestheconceptofmultipleencoderbranches,each
adjustedforvaryingdegreesofshifts,toaddressthesedisparities.Thisapproachaimstooptimizetheadaptation
processbytreatingeachmodalityaccordingtoitsspecificdomainshiftcharacteristics,potentiallyleadingto
moreeffectiveoverallperformance.
7.1 Methodology
7.1.1 ExperimentswithMultipleBranches. Thenextstepistoreplacetheencoderwithmultiplebranchesas
describedinSection3.2.Weconsideredexperimentalapproacheswithtwodistinctsetups.Thesesetupswere
basedontheresultsweobtainedforexperimentsinSection5.There,wediscussedhowdistributionshiftcouldbe
Proc.ACMInteract.Mob.WearableUbiquitousTechnol.,Vol.8,No.2,Article46.Publicationdate:May2024.UnsupervisedDomainAdaptationforMultimodalMobileSensingwithMulti-BranchAdversarialTraining • 46:19
quantifiedbyaggregatingfeaturesbasedonmodalities(e.g.,activity,steps,wifi,location,etc.)orbyaggregating
basedonfeaturelevelshiftasquantifiedbystatisticaltests(e.g.,top33%offeatures,bottom33%offeatures,and
therest,etc.regardlessofthemodality).
Setup1—BranchesBasedonModalities:IntheWENETdataset,thereareovertenmodalities.Havingseparate
branchesforallmodalitiesleadstoacomplexoptimizationproblem.Hence,inthispaper,wefocusonhaving
threebranchesforwhichwewereabletoobtaindecentresults.Beyondthethreebranches,wedidnotobtain
goodresults,asitbecameadifficultoptimizationgiventhedatasetsizeandthechallengingnatureofthetask,as
describedinSection6.Hence,whenhavingthreebranches,foreachtargetcountry,weusedthemodalitywiththe
highestshiftasonebranch,themodalitywiththelowestshiftasanotherbranch,andtherestofthemodalities
inonebranch,asvisualizedinFigure2.Whenconsideringmodalities,wenormalizedthehighestCohen’s-d
modalities𝜆 𝑚to1,andiftheCohen’s-dofthelowestmodalitywasbelow0.2(belowsmalleffectsize),normalized
itsuchthatitis𝜆 𝑚 = 0(allsource-targetpairshadbelow0.1modalities,asshowninFigure4andFigure5).
𝜆 𝑚 forthesetoffeaturesinthemiddlewasnormalizedtoasuitablevalue,asdescribedinSection3.3—Step3c.
WeonlyhavetwomodalitiesintheWEEEdatasetforbothinferences.Hence,weusedtwobranchesandagain
normalizedbetween0and1toobtainthe𝜆 𝑚 valuesforthetwomodalities,followingSection3.3.Finally,forthis
setup,wefirstconductedexperimentswith𝜆 =1forallbranches(𝜆 =1,Setup1).Then,weuseddifferent𝜆
𝑚
valuesforbranchesbasedontheshiftandconductedexperiments(w/𝜆 𝑚,Setup1).
Setup2—BranchesBasedonFeatureGroup:
Inbothdatasets,wecouldsortallfeatures Table3. Resultsforregressiontasks.Resultsarepresentedasmeanabsolute
indescendingorderbasedonshiftforeach errors(MAE)(thelowerthebetter).
source-targetpair.Then,wecouldconsider
threegroupssimilartoSetup1,byconsider-
Dataset WEEE WEEE
ing33%ofdatawiththehighestshift,33% Inference EEE EEE
of data with the lowest shift, and finally, Source EarBuds EarBuds
the rest of the 33% of data in the middle. Target Empatica Muse
Whilethepercentagecouldbechanged,we RQ2
didnotdelvedeeperintothatinthisanal- Random 1.35±0.31 1.41±0.43
ysisandfocusedonobtainingequalsplits S->S 0.62±0.11 0.52±0.06
for the three feature sets. In Figures 6, 8, S->S–Amarasingheetal.[6] - 0.61±N/A
S->T 0.79±0.15 0.73±0.10
and9,thesesplitsaremarkedwithvertical
S->T(w/TL) 0.67±0.07 0.56±0.04
dottedlines.Finally,forthissetup,weused
S->T–Amarasingheetal.[6] - -
different𝜆 𝑚 valuesforbranches,basedon
MMD[13] 0.71±0.05 0.69±0.06
the shift, as suggested in Section 3.3 (w/
ADDA[76] 0.76±0.05 0.70±0.16
𝜆 𝑚,Setup2). DANN[24] 0.73±0.05 0.65±0.06
RQ3
7.1.2 Experiments with Multiple Modali- Ours(𝜆=1,Setup1) 0.74±0.04 0.62±0.06
tiesinHighandLowBranchesforSetup1. Ours(w/𝜆 𝑚,Setup1) 0.69±0.06 0.60±0.03
An identified limitation of Setup1 is evi- Ours(w/𝜆 𝑚,Setup2) 0.69±0.05 0.64±0.03
dentininstanceswhereasinglemodality,
representingbrancheswiththehighestor
lowestshift,encompassesonlyalimitednumberoffeatures.Forinstance,whenthesourcedomainisItalyandthe
targetisIndia,themodalitywiththehighestshift,‘wifi’(𝜆 =1),includesmerelysevenfeatures.Incontrast,the
0
‘activity’modalitywiththelowestshiftcontainseightfeatures(𝜆 =0),whiletheremainingfeatures(over80)fall
2
withinthemoderateshiftrange(𝜆 =0.62).Thisscenarioresultsinanimbalanceamongthebranches.However,
1
suchanimbalancedoesnotmanifestinSetup2,wheretheequitabilityofsizesacrossbranchesismaintained.We
performedanotherexperimenttoassessthepotentialimplicationsofthislimitationonperformance.Specifically,
Proc.ACMInteract.Mob.WearableUbiquitousTechnol.,Vol.8,No.2,Article46.Publicationdate:May2024.46:20 • Meegahapolaetal.
we introduced additional modalities to the high and low-shift branches. To accomplish this, we define𝛼 to
indicatethenumberofmodalitiespresentwithinthehighandlowshiftbranches.Thus,𝛼 =1correspondsto
onemodalityeachinthehighandlowbranches,𝛼 = 2signifiestwomodalitieseach,𝛼 = 3representsthree
modalitieseachwithinthesebranches,andsoon.Subsequently,weconductaseriesofexperimentssimilarto
thosedescribedinSection7.1.1,systematicallyvaryingthe𝛼 values.Thisexperimentationenablesustogauge
theinfluenceofmodifyingthenumberofmodalitiesonperformance.Giventheinadequacyofmodalitieswithin
theWEEEdataset,itisimportanttounderscorethatthisspecificexperimentpertainsonlytotheWENETdataset.
7.2 Results
7.2.1 Experiments with Multiple Branches. The results for the
WENET dataset are presented in Table 2. When 𝜆 is set to 1,
indicating domain adversarial training with uniform 𝜆 values
acrossallbranches,theperformanceexceedsthatof DANNin
all instances except for mood inference with Mongolia as the
source. Within Setup1, the introduction of distinct 𝜆 𝑚 values
forbranches,determinedbymodalitydistribution,yieldsminor
performanceenhancementsacrossallscenarioscomparedtothe
uniform𝜆 =1configuration,exceptforsocialcontextinference
withMongoliaasthesourcewherebothsetupsyieldedanAUCof
0.57.Moreover,thesuperiorityofSetup1overSetup2isnotclear,
aseachconfigurationdisplayedbetterperformanceindifferent
inferences. However, a discernible trend emerged with mood
inference, which is a more subjective task reliant on nuanced Fig.10. Inferenceresultsforvarious𝛼 values.
labeling,indicatingthatfine-tuningwithlabels(S->T(w/TL))
failedto elevateperformance,evenrelative toDANNandour
proposedapproach.Conversely,transferlearningachievedperformanceonparwithourmethodfortheobjective
ground truth of social context inference, again underscoring the possible impact of ground truth nature on
inferenceaccuracyasdiscussedinSection6.2.Fromanothersense,thishighlightsthatourtechniqueachieves
decentperformance,evencomparedtotransferlearning,forsocialcontextinferencesintheWENETdataset.
ThefindingsfortheWEEEdatasetareshowninTable3.Here,ourapproachonceagainoutperformedDANN
andotherbaselinesacrossbothinferences.However,theperformancedoesnotsurpassthatoffine-tuningwith
transferlearning.Thisdiscrepancycanbeattributedtothepresenceofgold-standardgroundtruthlabelsinthis
dataset,allowingfine-tuningtoexhibitsuperiorperformance.Furthermore,distinguishingbetweentheefficacy
ofSetup1andSetup2remainsinconclusive,despiteSetup1’ssuperiorperformancefortheEarbudsandMuse
source-targetpair.AsmirroredintheresultsfortheWENETdataset,evenhere,employingdiverse𝜆valuesfor
thebranchesprovedtobemoreeffectivethanadoptingauniform𝜆 =1strategy.Thus,theadjustmentof𝜆based
onbranch-specificshiftstatisticsyieldedmorebetterresults.
7.2.2 ExperimentswithMultipleModalitiesinHighandLowBranchesforSetup1. Theoutcomesoftheexperiment
conducted to explore the effects of varying𝛼 values are presented in Figure 10. The results exhibit distinct
patternsacrossdifferentinferencesandsource-targetdomainpairings.Inspecificscenarios,suchasthe’Italy-All
Mood’and’Mongolia-AllSocialContext’,employing𝛼 =2yieldedslightlysuperiorresultscomparedtowhen𝛼
wassetto1.Similarly,forthe’Mongolia-AllMood’inference,𝛼 =2yieldedresultssimilartothoseof𝛼 =1,while
𝛼 =3ledtonotablyimprovedperformance.Intriguingly,inallinstances,setting𝛼 =4resultedinconsistently
subpar performance. These findings underscore the nuanced nature of determining optimal configurations
forthenumberofbranchesandthenumberofmodalitieswithineachbranchduringmodeltraining.There
Proc.ACMInteract.Mob.WearableUbiquitousTechnol.,Vol.8,No.2,Article46.Publicationdate:May2024.UnsupervisedDomainAdaptationforMultimodalMobileSensingwithMulti-BranchAdversarialTraining • 46:21
appearstobenouniversalformulafortheseselections,astheirefficacydependsonthespecificinferenceand
source-targetdomains.Nevertheless,arecurringtrendacrosstheanalysesisthatemployingmultiplebranches
withanappropriatelychosen𝛼 and𝜆consistentlyoutperformsutilizingasingleencoderwithfixed𝜆,exceptin
veryfewexperiments(e.g.,WEEEEarbuds-EmpaticaDANN=0.73performedbetterthan𝜆 =1,Setup1;WEEE
Earbuds-Muse𝜆 =1,Setup1performedbetterthanw/𝜆 𝑚 Setup2;WENETMoodw/sourceMongoliaDANN=
0.53performedsimilarto𝜆 =1,Setup1andw/𝜆 𝑚,Setup1).
Asasummary,inansweringRQ3,theanalysisshedlightonthenuancedinterplaybetweendiversefactors
suchasthenatureofgroundtruth(gold/silverstandard,subjective/objective),modalitydistributionsandrelated
distributionshifts,andbranch-specificadaptationdynamics.Hence,theconductedexperimentsprovideevidence
thatincorporatingmultiplebranchesfordifferentfeaturesets,basedoneithermodalityordistributionshift-based
featuregroups,yieldsimprovedperformanceinunsuperviseddomainadaptation.TheresultsforboththeWENET
andWEEEdatasetsconsistentlyindicatethatthisapproachoutperformsbaselinemethodsandenhancesdomain
adaptationperformance.Further,thefindingsemphasizetheimportanceofadaptabilityinadjustingparameters
suchas𝜆and𝛼 basedonspecificcontexts,inferencetasks,andsource-targetdomainpairings.Thisadaptability
provescrucialineffectivelyharnessingtheadvantagesofdomainadversarialtraining,highlightingitspotentialto
significantlyenhancemodelgeneralizationandperformanceacrossdiversemultimodalmobilesensingdatasets.
8 DISCUSSION
8.1 Implications
Theuseofmulti-branchencoderswithvaryinglambdavaluesindomainadaptationcarriesbothmodelingand
practicalimplications.First,wediscussafewmodelingimplicationsrelatedtoourproposedapproach.
(1) AdaptationStrategyCustomization:Theinsightsdrawnfromtheexperimentsunderscoretheimportance
of adopting good adaptation strategies. The observed performance improvements achieved through tuning
parameterssuchas𝜆 and𝛼 valuesemphasizetheimportanceoftailoringthetrainingprocesstothespecific
characteristicsofthedataandthenatureoftheinferencetasks.Theresultshighlighttheneedforflexibilityin
adaptationtechniques,acknowledgingthatdifferentdatamodalitiesandinferencetasksmaydemanddistinct
strategiesforoptimalperformance.Thisimplicationencouragesresearchersandpractitionerstoconsiderthe
intricaciesofthedataandtheproblemdomainwhencraftingadaptationmethodologies,contributingtoamore
effectiveapproachtodomainadaptation.Moreover,insomeofourexperimentsthatwerenotreportedinthe
study,wemodifiedtheannealingscheduleof𝜆suggestedbyGaninetal.[23,24],bybothdoublingandhalving
itsratetoevaluatetheimpactonmodelperformance.Thisadjustmentaimedtodiscernwhethervariationsinthe
rateatwhich𝜆transitionsfromitsinitialtofinalvaluewouldaffectthetrainingdynamicsorthemodel’sfinal
evaluationmetrics,suchasAUCinclassificationorMAEinregression.Ourfindingsrevealedthatalteringthe
annealingscheduledidnotyieldresultswithsubstantialorclearconclusions.Specifically,doublingtheannealing
rate resulted in marginally lower training durations without commensurate benefits in model performance.
However,theobserveddifferencesinAUCandMAEwerenegligible,suggestingthatwhiletherateofannealing
influencestrainingtime,itdidnotimpactthemodel’seffectivenessaccordingtothesemetrics.Thiscouldbea
matteroffurtherexplorationinthefuture.Finally,itisalsoworthnotingthatintroducingseparateparameters
acrossbranches,asdiscussedinSection7,ledonlytoaminorincreaseinperformanceforbothregressionand
classificationtasks.Thisobservationpromptsthequestionofwhethertheaddedcomplexityofthissetupjustifies
itsimplementation.Wearguethatitdoes,particularlyconsideringthatthemaximumperformanceenhancement
observed for the WENET dataset, transitioning from S->S to S->T, was approximately 15% (See Table 2). In
thiscontext,evenamarginalimprovementof1%isreasonable.Futureresearchcouldfurtherinvestigatethese
findingsacrossotherdatasetsandtasksthatmaypresentlessofachallenge,todeterminethisapproach’sbroader
applicabilityandbenefit.
Proc.ACMInteract.Mob.WearableUbiquitousTechnol.,Vol.8,No.2,Article46.Publicationdate:May2024.46:22 • Meegahapolaetal.
(2) ImpactofGroundTruthNature:Thedivergentperformancetrendsobservedacrossvariousinferencetasks,
particularlydistinguishingbetweensubjectivetaskslikemoodinference,moreobjectivetaskslikesocialcontext
inference,andgoldstandardgroundtruth-basedtaskslikeenergyexpenditureestimation,provideevidence
thatconfirmstheimpactofgroundtruthnatureonthedomainadaptationmodel’sperformance.Thesefindings
highlight the intricate interplay between ground truth labels’ quality and reliability and domain adaptation
methods’success.Theoutcomesshowcasetheneedtotakeintoaccounttheinherentsubjectivityandpotential
noiseingroundtruthlabels,particularlyincontextswherehumanjudgmentandperceptionplayacrucialrole.
Theimplicationsunderscorethepivotalroleofdomainadaptationnotonlyinmitigatingdistributionshiftsbut
alsoinaccommodatingthepeculiaritiesofthegroundtruthdata.
Inaddition,thefollowingpracticalimplicationscouldbeconsideredinthedeploymentofthiskindofmodel.
(1) EnhancingReal-worldApplicability:Theperformanceimprovementsobtainedbythemulti-branchadaptation
strategieshaveimplicationsforreal-worldapplicationsreliantonmultimodalmobilesensingdata.Thesefindings
suggestthatpractitionersintegratingdatafromdiversesensorscouldeffectivelyenhancetheutilityoftheir
models by customizing their adaptation strategies based on the nuanced characteristics of the data and the
demandsofspecificinferencetasks.Thisadaptabilityoffersaconcretemeanstoincreasepredictiveaccuracyin
data-drivenapplicationssuchasmentalwell-beingmonitoring,personalizedhealthcare,andbehavioranalysis.
Byfine-tuningadaptationtechniquestotheintricaciesofdatadistributionsanddomainshifts,practitionerscan
achievemorerobustandmeaningfuloutcomesinthesecriticaldomains.
(2) GuidanceforModelDesign:Theinsightsobtainedfromtheexperimentsoffervaluableguidanceforpractition-
ersandresearchersengagedindesigninganddeployingadaptationmodelsformultimodaldata.Bycomprehending
theimpactoffactorssuchasgroundtruthqualityandmodalitydistributiononmodelperformance,informed
decisionscouldbemadeaboutthearchitectureandconfigurationoftheirmodels.Thisunderstandingstreamlines
experimentation, minimizes trial-and-error efforts, and accelerates the development of effective adaptation
techniquestailoredtospecificusecases.
Inconclusion,thetheoreticalandpracticalimplicationsderivedfromtheexperimentalresultscollectivelyun-
derscoretheinherentflexibility,adaptability,andperformance-enhancingcapabilitiesoftheM3BATarchitecture
forunsuperviseddomainadaptation.Theseimplicationsadvancetheunderstandingofadaptationtechniques
andprovideactionableinsightsforresearchersseekingtousethesestrategiestoimprovemodelperformance
and generalization capabilities. As the field of multimodal mobile sensing continues to mature, the insights
derivedfromtheseimplicationsinformthedevelopmentofsophisticatedtechniquesthateffectivelyaddressthe
complexitiesofdomainshiftsinreal-worldsettings.
8.2 LimitationsandFutureWork
Inthispaper,wehavechosentofocusonDANNasourprimarytechniqueformultimodalmobilesensing,a
decisionguidedbyitsproveneffectivenessinaddressingdomainshiftsandenhancingdatasetgeneralization.
DANN, as an adversarial-based method, is particularly suited for the variability and complexity inherent in
mobilesensingdata.Whiledomainadversarialtrainingisafoundationalapproach,itisimportanttonotethat
itmaynotfullyencapsulatethesubtletiesofreal-worlddomainvariations.Thislimitation,however,doesnot
underminethevalueofDANNinourstudy;rather,ithighlightsthenecessityofexploringarangeofdomain
adaptationtechniques,bothdiscrepancy-basedandadversarial-based,assuggestedbyGoeletal.[28]andWuet
al.[82].OurchoiceofDANNismotivatedbyitsbalancebetweentheoreticalrobustnessandpracticalapplicability,
makingitafittingstartingpointforourexplorationintodomainadaptationinmobilesensing.Nonetheless,we
acknowledgetheimportanceoffurtherresearchintoothermethods.Techniquesstemmingfromadversarial
discriminativedomainadaptation[76],self-ensembling[64],andmomentmatching[63]representpotential
avenuesforfutureinvestigation.Thesemethodscouldofferalternativeorcomplementarystrategiesformore
Proc.ACMInteract.Mob.WearableUbiquitousTechnol.,Vol.8,No.2,Article46.Publicationdate:May2024.UnsupervisedDomainAdaptationforMultimodalMobileSensingwithMulti-BranchAdversarialTraining • 46:23
intricateandchallengingdomainshifts.ByfocusingonDANN,webelievethatthisstudysetsafoundational
groundworkforsuchexplorations,emphasizingtheneedtocontinuallyevolveandenhancedomainadaptation
methodologies.
Therelianceonpriorprobabilityshiftorlabelshiftassumptions,thoughinsightful,maynotfullycapture
the complexities of real-world data distributions. This challenge is not exclusive to ubiquitous and mobile
sensing—however,theuniquedatacharacteristicsandcomplexitiesinthisfieldunderscoretheneedtoinvestigate
alternativeassumptionsormethodologiesinsituationswithambiguouslabeldistributions.Thisapproachis
criticaltomoreeffectivelyaddressthediverserangeofdomainvariationsandchallenges.Recentstudiesin
ubicomphavepointedoutthenecessityforsuchresearch[58].Itisalsoimportanttonotethatthetechniques
wehaveproposedinthispaperarenotspecificallydesignedtohandlelabelshiftscomprehensively,although
theypartiallyaddressthem.Therefore,futureresearchshoulddelvedeeperintotheseaspectstoenhanceour
understandingandmanagementoflabelshiftsinthesecontexts.Further,thecurrentmethodologyleverages
separatebranchesforindividualsensormodalities(Setup1),apragmaticapproachthateffectivelyconsidersthe
uniquecharacteristicsofeachmodality.However,exploitingpotentialsynergiesbetweenmodalitiesremainsa
compellingavenueforfutureresearch.EventhoughthiswaspartiallydonewithSetup2,thedevelopmentof
moresophisticatedmultimodalfusiontechniquescouldenableamorecomprehensiveintegrationofinformation
acrossdifferentsensorsources,potentiallyyieldingfurtherperformancegains.Scalabilityandapplicabilityin
real-worlddeploymentscenariosaretwoconsiderationsforthepracticalutilityofthetechnique.Tothisend,
futureresearchshouldprioritizerefiningthemethod’sefficiencyandrobustnessindiversereal-worldsettings.
Another limitation of our current approach in domain adversarial training is the requirement for a large,
well-labeleddatasetfromthesourcedomain.Thisnecessityarisesbecausetheeffectivenessofdomainadversarial
traininghingessignificantlyonthemodel’sabilitytolearncomprehensiveandgeneralizedfeaturerepresentations
fromthesourcedomain.Theserepresentationsarecrucialastheyenablethemodeltoperformwellonthetarget
domain,whichmightdiffersubstantiallyintermsofdatadistribution.Alargedatasetinthesourcedomain
ensuresadiverserangeofexamples,encompassingawidevarietyoffeaturesandscenarios.Thisdiversityiskey
totrainingarobustmodelthatcaneffectivelyreducethedomaindiscrepancybyaligningthefeaturedistribution
ofthesourcedomainwiththatofthetargetdomain.Inourcase,wespecificallychoseItalyandMongoliainthe
WENETdatasetsasoursourcedatasetsduetotheirextensiveanddiversedatapools.Thesedatasetsprovidearich
setoffeaturesandexamplesthataidinthedevelopmentofamodelcapableofgeneralizingwelltoothercountries.
Conversely, smaller datasets might not offer the same level of diversity and comprehensiveness, potentially
leadingtoamodelthatislesseffectiveatgeneralizingacrossdomains.Thislimitationisparticularlypronounced
indomainadversarialtraining,wherethegoalistolearnfromthesourcedomainandtobridgethegaptoa
potentiallydifferenttargetdomain.
OnemorelimitationisthatweexclusivelyusedCohen’s-dtoquantifydistributionshifts.However,thischoice
wasmadewithcarefulconsideration.WeselectedCohen’s-dasourprimarystatisticalmethodbecauseallthe
dataweused,suchasactivityandappusage,arenumeric(detailedintheAppendix).Cohen’s-diseffectivefor
thistypeofdata.ForthesensordatafromtheaccelerometerandgyroscopeintheWEEEdataset,wecalculated
statisticalfeaturesthatreflectspecificcharacteristicswithintimewindowsandthenappliedCohen’s-dtothese
features.InthecaseoftheperiodicPPGsignal,wefocusedonextractingnumericfeaturessuchasbloodvolume
pulseandheartrate.ThismakesCohen’s-darelevantandsuitablechoiceforouranalysis.Itisalsoimportantto
notethatCohen’s-d,withvaluestypicallytakingarangecloserto0-1,couldbeseenasavaluablemetricfor
approximatelyquantifyingdistributionshift,giventhat𝜆valuealsofallsinthesamerange.However,Cohen’s-d
isnottheonlyoptionthatcouldbeusedforthispurpose.Inourpreviousresearch[58],weconsideredother
statisticalmeasureslikethet-statistic,permanova,andpermadispasalternativesforquantifyingdistribution
shifts.Moreover,whilewehaveclarifiedthescopeofouranalysistofocusonnumericalstatisticalfeaturesacross
bothdatasets,itiscrucialtoemphasizethatmoretechniquesbeyondCohen’s-dshouldbeconsideredwhenthere
Proc.ACMInteract.Mob.WearableUbiquitousTechnol.,Vol.8,No.2,Article46.Publicationdate:May2024.46:24 • Meegahapolaetal.
arecategoricalinputfeatures.Therefore,futurestudiesmightbenefitfromexploringstatisticalmeasuresbeyond
Cohen’s-d,forsuchfeatures.Hence,eventhoughintuitive,thecurrentmappingbetweenCohen’s-dand𝜆is
naiveandrule-based,asdescribedinSection3.3.5.Thiscouldalsobeimprovedinfuturestudies.
Expandingthetechnique’sversatilityandusefulnesscouldinvolveextendingittoencompasstransferlearning
andpersonalizedmodelscenarios.Thisbroaderscopecouldcatertodiverseapplicationneedsanduser-specific
requirements,enhancingthetechnique’sadaptabilityandapplicability.Forexample,givenourfindings,sometimes
itmightmakesensetododomainadaptationfirstandpersonalizeamodeltotargetusersinatargetdomainrather
thandirectlypersonalizingamodel.Thesedirectionsneedfurtherinvestigation.Additionally,thetechnique’s
applicationhasbeenprimarilycenteredaroundtimeseriesdataprocessedthroughtimewindows,asiscustomary
inthiscontextacrossmanystudies[7,49,73,82].Futureresearchcouldexploreitsadaptabilitywhenconfronted
with raw time series data alongside convolutional neural network-based feature extraction, similar to how
multimodaldataarehandledin[85].Thisexpansionwouldofferinsightsintothemethod’seffectivenessunder
differentdatarepresentationsandprocessingtechniques.Furthermore,whilethetechniquehasbeendemonstrated
withinthedomainofmobilesensing,itcouldalsobeapplicabletotabulardatasetswithmultimodalattributes.
Futureworkcouldexploreitsutilityacrossotherdomains.Inconclusion,whiletheproposeddomainadaptation
techniqueexhibitspromisingresults,theselimitationsandfutureresearchlinesprovideimpetustoadvance
multimodaldomainadaptationmethodologiesinthecontextofmobilesensing.
9 CONCLUSION
Inthiswork,wehaveexploredtheeffectivenessofamulti-branchdomainadaptationtechniqueformultimodal
mobile sensing data. Our experiments on the WENET and WEEE datasets highlight the adaptability of the
approachthroughparametercustomization,leadingtoenhancedperformanceandgeneralization.Theresults
underscoretheneedfortailoredadaptationstrategies,whilethedistinctionbetweensubjectiveandobjectivetasks
emphasizestheroleofgroundtruthquality.Thetechnique’spotentialforscenarioswithlimitedlabeleddataand
itsapplicabilitytopracticalsettingsfurtherdemonstrateitssignificance.However,challengesremain,andfuture
researchshouldfocusonrefiningthetechnique’sscalability,real-worlddeployment,andfusionofmultimodal
data.Asmobilesensinggainsmomentuminvariousdomains,thisstudycontributestotheadvancementof
unsupervised domain adaptation with M3BAT architecture, with a range of additional, real-world machine
learningapplications.
ACKNOWLEDGMENTS
ThisworkwasfundedbytheEuropeanUnion’sHorizon2020WeNetproject,undergrantagreement823783.We
thankallthevolunteersacrosstheworldfortheirparticipationintheproject.
REFERENCES
[1] MartínAbadi,AshishAgarwal,PaulBarham,EugeneBrevdo,ZhifengChen,CraigCitro,GregS.Corrado,AndyDavis,JeffreyDean,
MatthieuDevin,SanjayGhemawat,IanGoodfellow,AndrewHarp,GeoffreyIrving,MichaelIsard,YangqingJia,RafalJozefowicz,Lukasz
Kaiser,ManjunathKudlur,JoshLevenberg,DandelionMané,RajatMonga,SherryMoore,DerekMurray,ChrisOlah,MikeSchuster,
JonathonShlens,BenoitSteiner,IlyaSutskever,KunalTalwar,PaulTucker,VincentVanhoucke,VijayVasudevan,FernandaViégas,
OriolVinyals,PeteWarden,MartinWattenberg,MartinWicke,YuanYu,andXiaoqiangZheng.2015.TensorFlow:Large-ScaleMachine
LearningonHeterogeneousSystems. https://www.tensorflow.org/Softwareavailablefromtensorflow.org.
[2] IdanAchituve,HaggaiMaron,andGalChechik.2021.Self-supervisedlearningfordomainadaptationonpointclouds.InProceedingsof
theIEEE/CVFwinterconferenceonapplicationsofcomputervision.123–133.
[3] DanielAAdler,FeiWang,DavidCMohr,andTanzeemChoudhury.2022. Machinelearningforpassivementalhealthsymptom
prediction:Generalizationacrossdifferentlongitudinalmobilesensingstudies.Plosone17,4(2022),e0266516.
[4] AbienFredAgarap.2018.Deeplearningusingrectifiedlinearunits(relu).arXivpreprintarXiv:1803.08375(2018).
Proc.ACMInteract.Mob.WearableUbiquitousTechnol.,Vol.8,No.2,Article46.Publicationdate:May2024.UnsupervisedDomainAdaptationforMultimodalMobileSensingwithMulti-BranchAdversarialTraining • 46:25
[5] FahdAlbinali,StephenIntille,WilliamHaskell,andMaryRosenberger.2010.Usingwearableactivitytypedetectiontoimprovephysical
activityenergyexpenditureestimation.InProceedingsofthe12thACMinternationalconferenceonUbiquitouscomputing.311–320.
[6] YasithAmarasinghe,DarshanaSandaruwan,ThilinaMadusanka,IndikaPerera,andLakmalMeegahapola.2023.MultimodalEarable
SensingforHumanEnergyExpenditureEstimation.In202345thAnnualInternationalConferenceoftheIEEEEngineeringinMedicine&
BiologySociety(EMBC).IEEE.
[7] KarimAssi,LakmalMeegahapola,WilliamDroz,PeterKun,AmaliaDeGötzen,MiriamBidoglia,SallyStares,GeorgeGaskell,Altangerel
Chagnaa,AmarsanaaGanbold,etal.2023.Complexdailyactivities,country-leveldiversity,andsmartphonesensing:Astudyindenmark,
italy,mongolia,paraguay,anduk.InProceedingsofthe2023ACMCHIConferenceonHumanFactorsinComputingSystems.1–23.
[8] AlejandroBaldominos,AlejandroCervantes,YagoSaez,andPedroIsasi.2019.Acomparisonofmachinelearninganddeeplearning
techniquesforactivityrecognitionusingmobiledevices.Sensors19,3(2019),521.
[9] WageeshaBangamuarachchi,AnjuChamantha,LakmalMeegahapola,HaeeunKim,SalvadorRuiz-Correa,IndikaPerera,andDaniel
Gatica-Perez.2023. InferringMood-While-EatingwithSmartphoneSensingandCommunity-BasedModelPersonalization. arXiv
preprintarXiv:2306.00723(2023).
[10] WageeshaBangamuarachchi,AnjuChamantha,LakmalMeegahapola,SalvadorRuiz-Correa,IndikaPerera,andDanielGatica-Perez.
2022.SensingEatingEventsinContext:ASmartphone-OnlyApproach.IEEEAccess10(2022),61249–61264.
[11] EmmaBouton-Bessac,LakmalMeegahapola,andDanielGatica-Perez.2022.YourDayinYourPocket:ComplexActivityRecognition
fromSmartphoneAccelerometers.InInternationalConferenceonPervasiveComputingTechnologiesforHealthcare.Springer,247–258.
[12] ZhaoyangCao,HanYu,HuiyuanYang,andAkaneSano.2023. PiRL:Participant-InvariantRepresentationLearningforHealthcare
UsingMaximumMeanDiscrepancyandTripletLoss.arXivpreprintarXiv:2302.09126(2023).
[13] YoungjaeChang,AkhilMathur,AntonIsopoussu,JunehwaSong,andFahimKawsar.2020.Asystematicstudyofunsuperviseddomain
adaptationforrobusthuman-activityrecognition.ProceedingsoftheACMonInteractive,Mobile,WearableandUbiquitousTechnologies4,
1(2020),1–30.
[14] FrançoisCholletetal.2015.keras.
[15] MaximilianChrist,NilsBraun,JuliusNeuffer,andAndreasWKempa-Liehr.2018.Timeseriesfeatureextractiononbasisofscalable
hypothesistests(tsfresh–apythonpackage).Neurocomputing307(2018),72–77.
[16] JackCohen.1988.StatisticalPowerAnalysisforthebehavioralsciences.L.ErlbaumAssociates.
[17] StevenSCoughlinandJessicaStewart.2016. Useofconsumerwearabledevicestopromotephysicalactivity:areviewofhealth
interventionstudies.Journalofenvironmentandhealthsciences2,6(2016).
[18] BožidaraCvetković,BoštjanKaluža,RadojeMilić,andMitjaLuštrek.2013. Towardshumanenergyexpenditureestimationusing
smartphoneinertialsensors.InAmbientIntelligence:4thInternationalJointConference,AmI2013,Dublin,Ireland,December3-5,2013.
Proceedings4.Springer,94–108.
[19] KathrynLDannecker,NadezhdaASazonova,EdwardLMelanson,EdwardSSazonov,andRaymondCBrowning.2013.Acomparison
ofenergyexpenditureestimationofseveralphysicalactivitymonitors.Medicineandscienceinsportsandexercise45,11(2013),2105.
[20] ShivRamDubey,SatishKumarSingh,andBidyutBaranChaudhuri.2022.Activationfunctionsindeeplearning:Acomprehensive
surveyandbenchmark.Neurocomputing(2022).
[21] AmandaDy,Ngoc-NhuJenniferNguyen,SeyedHosseinMirjahanmardir,DimitriosAndroutsos,MelanieDawe,AnthonyFyles,Wei
Shi,Fei-FeiLiu,SusanDone,andAprilKhademi.2023.DomainAdaptationusingSilverStandardLabelsforKi-67ScoringinDigital
PathologyAStepClosertoWidescaleDeployment.InMedicalImagingwithDeepLearning.
[22] VitorFortesRey,SunghoSuh,andPaulLukowicz.2022.LearningfromtheBest:ContrastiveRepresentationsLearningAcrossSensor
LocationsforWearableActivityRecognition.InProceedingsofthe2022ACMInternationalSymposiumonWearableComputers.28–32.
[23] YaroslavGaninandVictorLempitsky.2015.Unsuperviseddomainadaptationbybackpropagation.InInternationalconferenceonmachine
learning.PMLR,1180–1189.
[24] YaroslavGanin,EvgeniyaUstinova,HanaAjakan,PascalGermain,HugoLarochelle,FrançoisLaviolette,MarioMarchand,andVictor
Lempitsky.2016.Domain-adversarialtrainingofneuralnetworks.Thejournalofmachinelearningresearch17,1(2016),2096–2030.
[25] ShkurtaGashi,ChulhongMin,AlessandroMontanari,SilviaSantini,andFahimKawsar.2022.Amultideviceandmultimodaldatasetfor
humanenergyexpenditureestimationusingwearabledevices.ScientificData9,1(2022),537.
[26] ShkurtaGashi,ChulhongMin,AlessandroMontanari,SilviaSantini,andFahimKawsar.2022.Amultideviceandmultimodaldatasetfor
humanenergyexpenditureestimationusingwearabledevices.ScientificData(2022).
[27] ShrutiGedamandSanchitaPaul.2021.Areviewonmentalstressdetectionusingwearablesensorsandmachinelearningtechniques.
IEEEAccess9(2021),84045–84066.
[28] ParthGoelandAmitGanatra.2023.UnsupervisedDomainAdaptationforImageClassificationandObjectDetectionUsingGuided
TransferLearningApproachandJSDivergence.Sensors23,9(2023),4436.
[29] TaesikGong,YewonKim,AdibaOrzikulova,YunxinLiu,SungJuHwang,JinwooShin,andSung-JuLee.2023.DAPPER:Label-Free
PerformanceEstimationafterPersonalizationforHeterogeneousMobileSensing.ProceedingsoftheACMonInteractive,Mobile,Wearable
andUbiquitousTechnologies7,2(2023),1–27.
Proc.ACMInteract.Mob.WearableUbiquitousTechnol.,Vol.8,No.2,Article46.Publicationdate:May2024.46:26 • Meegahapolaetal.
[30] Google.2022.Adaptyourappbyunderstandingwhatusersaredoing. RetrievedFebruary12,2022fromhttps://developers.google.com/
location-context/activity-recognition
[31] TrevorHastie,RobertTibshirani,JeromeHFriedman,andJeromeHFriedman.2009.Theelementsofstatisticallearning:datamining,
inference,andprediction.Vol.2.Springer.
[32] HuanHe,OwenQueen,TeddyKoker,ConsueloCuevas,TheodorosTsiligkaridis,andMarinkaZitnik.2023.DomainAdaptationfor
TimeSeriesUnderFeatureandLabelShifts.arXivpreprintarXiv:2302.03133(2023).
[33] JenniferAHealeyandRosalindWPicard.2005. Detectingstressduringreal-worlddrivingtasksusingphysiologicalsensors. IEEE
Transactionsonintelligenttransportationsystems6,2(2005),156–166.
[34] EykeHüllermeierandWillemWaegeman.2021.Aleatoricandepistemicuncertaintyinmachinelearning:Anintroductiontoconcepts
andmethods.MachineLearning110(2021),457–506.
[35] YusukeIwasawaandYutakaMatsuo.2021.Test-timeclassifieradjustmentmoduleformodel-agnosticdomaingeneralization.Advances
inNeuralInformationProcessingSystems34(2021),2427–2440.
[36] NathanKammoun,LakmalMeegahapola,andDanielGatica-Perez.2023.UnderstandingtheSocialContextofEatingwithMultimodal
SmartphoneSensing:TheRoleofCountryDiversity.Proceedingsofthe25thACMInternationalConferenceonMultimodalInteraction
(ICMI)(2023).
[37] GuoliangKang,LuJiang,YiYang,andAlexanderGHauptmann.2019. Contrastiveadaptationnetworkforunsuperviseddomain
adaptation.InProceedingsoftheIEEE/CVFconferenceoncomputervisionandpatternrecognition.4893–4902.
[38] TaeKyunKim.2015.Ttestasaparametricstatistic.Koreanjournalofanesthesiology68,6(2015),540–546.
[39] DiederikPKingmaandJimmyBa.2014.Adam:Amethodforstochasticoptimization.arXivpreprintarXiv:1412.6980(2014).
[40] YlvaTrolleLagerrosandPagonaLagiou.2007.Assessmentofphysicalactivityandenergyexpenditureinepidemiologicalresearchof
chronicdiseases.Europeanjournalofepidemiology22,6(2007),353–362.
[41] NicholasDLane,EmilianoMiluzzo,HongLu,DanielPeebles,TanzeemChoudhury,andAndrewTCampbell.2010.Asurveyofmobile
phonesensing.IEEECommunicationsmagazine48,9(2010),140–150.
[42] JianLiang,RanHe,andTieniuTan.2023.Acomprehensivesurveyontest-timeadaptationunderdistributionshifts.arXivpreprint
arXiv:2303.15361(2023).
[43] JianLiang,DapengHu,andJiashiFeng.2020.Dowereallyneedtoaccessthesourcedata?sourcehypothesistransferforunsupervised
domainadaptation.InInternationalconferenceonmachinelearning.PMLR,6028–6039.
[44] RobertLiKamWa,YunxinLiu,NicholasDLane,andLinZhong.2013. Moodscope:Buildingamoodsensorfromsmartphoneusage
patterns.InProceedingofthe11thannualinternationalconferenceonMobilesystems,applications,andservices.389–402.
[45] YaMa,BiaoChen,ZiweiLi,andGangBai.2022.Self-supervisedDomainAdaptationModelBasedonContrastiveLearning.In202214th
InternationalConferenceonMachineLearningandComputing(ICMLC).44–50.
[46] AurelRubenMader,LakmalMeegahapola,andDanielGatica-Perez.2024. LearningAboutSocialContextfromSmartphoneData:
GeneralizationAcrossCountriesandDailyLifeMoments.InProceedingsofthe2024ACMCHIConferenceonHumanFactorsinComputing
Systems.
[47] AkhilMathur,AntonIsopoussu,NadiaBerthouze,NicholasDLane,andFahimKawsar.2019. Unsuperviseddomainadaptationfor
robustsensorysystems.InAdjunctProceedingsofthe2019ACMInternationalJointConferenceonPervasiveandUbiquitousComputing
andProceedingsofthe2019ACMInternationalSymposiumonWearableComputers.505–509.
[48] KatieMatton,RobertLewis,JohnGuttag,andRosalindPicard.2023.ContrastiveLearningofElectrodermalActivityRepresentationsfor
StressDetection.InConferenceonHealth,Inference,andLearning.PMLR,410–426.
[49] LakmalMeegahapola,WilliamDroz,PeterKun,AmaliaDeGötzen,ChaitanyaNutakki,ShyamDiwakar,SalvadorRuizCorrea,Donglei
Song,HaoXu,MiriamBidoglia,etal.2023.GeneralizationandPersonalizationofMobileSensing-BasedMoodInferenceModels:An
AnalysisofCollegeStudentsinEightCountries.ProceedingsoftheACMonInteractive,Mobile,WearableandUbiquitousTechnologies6,4
(2023),1–32.
[50] LakmalMeegahapolaandDanielGatica-Perez.2020.SmartphoneSensingfortheWell-BeingofYoungAdults:AReview.IEEEAccess9
(2020),3374–3399.
[51] LakmalMeegahapola,FlorianLabhart,Thanh-TrungPhan,andDanielGatica-Perez.2021.ExaminingtheSocialContextofAlcohol
DrinkinginYoungAdultswithSmartphoneSensing.ProceedingsoftheACMonInteractive,Mobile,WearableandUbiquitousTechnologies
5,3(2021),1–26.
[52] LakmalMeegahapola,SalvadorRuiz-Correa,andDanielGatica-Perez.2020.Aloneorwithothers?understandingeatingepisodesof
collegestudentswithmobilesensing.In19thInternationalConferenceonMobileandUbiquitousMultimedia.162–166.
[53] LakmalMeegahapola,SalvadorRuiz-Correa,andDanielGatica-Perez.2020.Protectingmobilefooddiariesfromgettingtoopersonal.In
Proceedingsofthe19thInternationalConferenceonMobileandUbiquitousMultimedia.212–222.
[54] LakmalMeegahapola,SalvadorRuiz-Correa,ViridianadelCarmenRobledo-Valero,EmilioErnestoHernandez-Huerfano,Leonardo
Alvarez-Rivera,RonaldChenu-Abente,andDanielGatica-Perez.2021.OneMoreBite?InferringFoodConsumptionLevelofCollege
StudentsUsingSmartphoneSensingandSelf-Reports.ProceedingsoftheACMonInteractive,Mobile,WearableandUbiquitousTechnologies
Proc.ACMInteract.Mob.WearableUbiquitousTechnol.,Vol.8,No.2,Article46.Publicationdate:May2024.UnsupervisedDomainAdaptationforMultimodalMobileSensingwithMulti-BranchAdversarialTraining • 46:27
5,1(2021),1–28.
[55] VarunMishra,SougataSen,GraceChen,TianHao,JeffreyRogers,Ching-HuaChen,andDavidKotz.2020.Evaluatingthereproducibility
ofphysiologicalstressdetectionmodels.ProceedingsoftheACMoninteractive,mobile,wearableandubiquitoustechnologies4,4(2020),
1–29.
[56] MehrabBinMorshed,KoustuvSaha,RichardLi,SidneyKD’Mello,MunmunDeChoudhury,GregoryDAbowd,andThomasPlötz.2019.
Predictionofmoodinstabilitywithpassivesensing.ProceedingsoftheACMonInteractive,Mobile,WearableandUbiquitousTechnologies
3,3(2019),1–21.
[57] SandrineRMüller,XiLeslieChen,HeinrichPeters,AugustinChaintreau,andSandraCMatz.2021. Depressionpredictionsfrom
GPS-basedmobilitydonotgeneralizewelltolargedemographicallyheterogeneoussamples.ScientificReports11,1(2021),1–10.
[58] AlexandreNanchen,LakmalMeegahapola,WilliamDroz,andDanielGatica-Perez.2023.KeepSensorsinCheck:DisentanglingCountry-
LevelGeneralizationIssuesinMobileSensor-BasedModelswithDiversityScores.Proceedingsofthe2023AAAI/ACMConferenceonAI,
Ethics,andSociety(AIES)(2023).
[59] AlexandraOlteanu,CarlosCastillo,FernandoDiaz,andEmreKıcıman.2019.Socialdata:Biases,methodologicalpitfalls,andethical
boundaries.Frontiersinbigdata2(2019),13.
[60] YilmazcanOzyurt,StefanFeuerriegel,andCeZhang.2022.Contrastivelearningforunsuperviseddomainadaptationoftimeseries.
arXivpreprintarXiv:2206.06243(2022).
[61] RuairiO’Driscoll,JakeTuricchi,KristineBeaulieu,SarahScott,JamieMatu,KevinDeighton,GrahamFinlayson,andJamesStubbs.
2020.Howwelldoactivitymonitorsestimateenergyexpenditure?Asystematicreviewandmeta-analysisofthevalidityofcurrent
technologies.BritishJournalofSportsMedicine54,6(2020),332–340.
[62] AdamPaszke,SamGross,FranciscoMassa,AdamLerer,JamesBradbury,GregoryChanan,TrevorKilleen,ZemingLin,NataliaGimelshein,
LucaAntiga,AlbanDesmaison,AndreasKopf,EdwardYang,ZacharyDeVito,MartinRaison,AlykhanTejani,SasankChilamkurthy,
BenoitSteiner,LuFang,JunjieBai,andSoumithChintala.2019.PyTorch:AnImperativeStyle,High-PerformanceDeepLearningLibrary.
InAdvancesinNeuralInformationProcessingSystems32.CurranAssociates,Inc.,8024–8035. http://papers.neurips.cc/paper/9015-
pytorch-an-imperative-style-high-performance-deep-learning-library.pdf
[63] XingchaoPeng,QinxunBai,XideXia,ZijunHuang,KateSaenko,andBoWang.2019. Momentmatchingformulti-sourcedomain
adaptation.InProceedingsoftheIEEE/CVFinternationalconferenceoncomputervision.1406–1415.
[64] ChristianSPerone,PedroBallester,RodrigoCBarros,andJulienCohen-Adad.2019. Unsuperviseddomainadaptationformedical
imagingsegmentationwithself-ensembling.NeuroImage194(2019),1–11.
[65] ArvindPillai,SubigyaKumarNepal,WeichenWang,MatthewNemesure,MichaelHeinz,GeorgePrice,DamienLekkas,AmandaC
Collins,TessGriffin,BenjaminBuck,etal.2024.InvestigatingGeneralizabilityofSpeech-basedSuicidalIdeationDetectionUsingMobile
Phones.ProceedingsoftheACMonInteractive,Mobile,WearableandUbiquitousTechnologies7,4(2024),1–38.
[66] HangweiQian,SinnoJialinPan,andChunyanMiao.2021.Latentindependentexcitationforgeneralizablesensor-basedcross-person
activityrecognition.InProceedingsoftheAAAIConferenceonArtificialIntelligence,Vol.35.11921–11929.
[67] MeganPRothney,MeganNeumann,AshleyBéziat,andKongYChen.2007.Anartificialneuralnetworkmodelofenergyexpenditure
usingnonintegratedaccelerationsignals.Journalofappliedphysiology(2007).
[68] ArtemRozantsev,MathieuSalzmann,andPascalFua.2018.Beyondsharingweightsfordeepdomainadaptation.IEEEtransactionson
patternanalysisandmachineintelligence41,4(2018),801–814.
[69] AndreaRosalesSanabria,FrancoZambonelli,SimonDobson,andJuanYe.2021. ContrasGAN:Unsuperviseddomainadaptationin
HumanActivityRecognitionviaadversarialandcontrastivelearning.PervasiveandMobileComputing78(2021),101477.
[70] DarshanSantani,FlorianLabhart,SaraLandolt,EmmanuelKuntsche,DanielGatica-Perez,etal.2018.DrinkSense:Characterizingyouth
drinkingbehaviorusingsmartphones.IEEETransactionsonMobileComputing17,10(2018),2279–2292.
[71] LauraSchelenz,IvanoBison,MatteoBusso,AmaliaDeGötzen,DanielGatica-Perez,FaustoGiunchiglia,LakmalMeegahapola,and
SalvadorRuiz-Correa.2021.TheTheory,Practice,andEthicalChallengesofDesigningaDiversity-AwarePlatformforSocialRelations.
InProceedingsofthe2021AAAI/ACMConferenceonAI,Ethics,andSociety(AIES).905–915.
[72] SandraServia-Rodríguez,KiranKRachuri,CeciliaMascolo,PeterJRentfrow,NealLathia,andGillianMSandstrom.2017. Mobile
sensingattheserviceofmentalwell-being:alarge-scalelongitudinalstudy.InProceedingsofthe26thInternationalConferenceonWorld
WideWeb.103–112.
[73] DimitrisSpathis,SandraServia-Rodriguez,KatayounFarrahi,CeciliaMascolo,andJasonRentfrow.2019.Passivemobilesensingand
psychologicaltraitsforlargescalemoodprediction.InProceedingsofthe13thEAIInternationalConferenceonPervasiveComputing
TechnologiesforHealthcare.272–281.
[74] NitishSrivastava,GeoffreyHinton,AlexKrizhevsky,IlyaSutskever,andRuslanSalakhutdinov.2014.Dropout:asimplewaytoprevent
neuralnetworksfromoverfitting.Thejournalofmachinelearningresearch15,1(2014),1929–1958.
[75] BaochenSunandKateSaenko.2016.Deepcoral:Correlationalignmentfordeepdomainadaptation.InComputerVision–ECCV2016
Workshops:Amsterdam,TheNetherlands,October8-10and15-16,2016,Proceedings,PartIII14.Springer,443–450.
Proc.ACMInteract.Mob.WearableUbiquitousTechnol.,Vol.8,No.2,Article46.Publicationdate:May2024.46:28 • Meegahapolaetal.
[76] EricTzeng,JudyHoffman,KateSaenko,andTrevorDarrell.2017.Adversarialdiscriminativedomainadaptation.InProceedingsofthe
IEEEconferenceoncomputervisionandpatternrecognition.7167–7176.
[77] PaulvanGent,HaneenFarah,NicoleNes,andB.Arem.2018.HeartRateAnalysisforHumanFactors:DevelopmentandValidationof
anOpenSourceToolkitforNoisyNaturalisticHeartRateData.
[78] KushR.Varshney.2022.TrustworthyMachineLearning.IndependentlyPublished,Chappaqua,NY,USA.
[79] DequanWang,EvanShelhamer,ShaotengLiu,BrunoOlshausen,andTrevorDarrell.2020.Tent:Fullytest-timeadaptationbyentropy
minimization.arXivpreprintarXiv:2006.10726(2020).
[80] QiWang,YueMa,KunZhao,andYingjieTian.2020.Acomprehensivesurveyoflossfunctionsinmachinelearning.AnnalsofData
Science(2020),1–26.
[81] QingWang,WeiRao,SiningSun,LeibXie,EngSiongChng,andHaizhouLi.2018. Unsuperviseddomainadaptationviadomain
adversarialtrainingforspeakerrecognition.In2018IEEEInternationalConferenceonAcoustics,SpeechandSignalProcessing(ICASSP).
IEEE,4889–4893.
[82] YuWu,DimitrisSpathis,HongJia,IgnacioPerez-Pozuelo,TomasGonzales,SorenBrage,NicholasWareham,andCeciliaMascolo.
2023. UDAMA:UnsupervisedDomainAdaptationthroughMulti-discriminatorAdversarialTrainingwithNoisyLabelsImproves
Cardio-fitnessPrediction.arXivpreprintarXiv:2307.16651(2023).
[83] JiaolongXu,LiangXiao,andAntonioMLópez.2019.Self-superviseddomainadaptationforcomputervisiontasks.IEEEAccess7(2019),
156694–156706.
[84] XuhaiXu,PrernaChikersal,JanineMDutcher,YasamanSSefidgar,WoosukSeo,MichaelJTumminia,DaniellaKVillalba,Sheldon
Cohen,KaseyGCreswell,JDavidCreswell,etal.2021. LeveragingCollaborative-FilteringforPersonalizedBehaviorModeling:A
CaseStudyofDepressionDetectionamongCollegeStudents.ProceedingsoftheACMonInteractive,Mobile,WearableandUbiquitous
Technologies5,1(2021),1–27.
[85] XuhaiXu,XinLiu,HanZhang,WeichenWang,SubigyaNepal,YasamanSefidgar,WoosukSeo,KevinSKuehn,JeremyFHuckins,
MargaretEMorris,etal.2023.GLOBEM:Cross-DatasetGeneralizationofLongitudinalHumanBehaviorModeling.Proceedingsofthe
ACMonInteractive,Mobile,WearableandUbiquitousTechnologies6,4(2023),1–34.
[86] LuyuYang,YogeshBalaji,Ser-NamLim,andAbhinavShrivastava.2020. Curriculummanagerforsourceselectioninmulti-source
domainadaptation.InComputerVision–ECCV2020:16thEuropeanConference,Glasgow,UK,August23–28,2020,Proceedings,PartXIV16.
Springer,608–624.
[87] ÖzgürYürür,ChiHaroldLiu,ZhengguoSheng,VictorCMLeung,WilfridoMoreno,andKinKLeung.2014.Context-awarenessfor
mobilesensing:Asurveyandfuturedirections.IEEECommunicationsSurveys&Tutorials18,1(2014),68–93.
[88] WeichenZhang,WanliOuyang,WenLi,andDongXu.2018.Collaborativeandadversarialnetworkforunsuperviseddomainadaptation.
InProceedingsoftheIEEEconferenceoncomputervisionandpatternrecognition.3801–3809.
[89] XiaoZhang,FuzhenZhuang,WenzhongLi,HaochaoYing,HuiXiong,andSangluLu.2019.Inferringmoodinstabilityviasmartphone
sensing:Amulti-viewlearningapproach.InProceedingsofthe27thACMInternationalConferenceonMultimedia.1401–1409.
[90] KaiyangZhou,ZiweiLiu,YuQiao,TaoXiang,andChenChangeLoy.2022.Domaingeneralization:Asurvey.IEEETransactionson
PatternAnalysisandMachineIntelligence(2022).
[91] JuanA.ÁlvarezGarcía,BožidaraCvetković,andMitjaLuštrek.2020. ASurveyonEnergyExpenditureEstimationUsingWearable
Devices.(2020).
Proc.ACMInteract.Mob.WearableUbiquitousTechnol.,Vol.8,No.2,Article46.Publicationdate:May2024.UnsupervisedDomainAdaptationforMultimodalMobileSensingwithMulti-BranchAdversarialTraining • 46:29
A WENETDATASETFEATURES[49]
Table4. Summaryoffeaturesextractedfromsensingdata,aggregatedaroundactivityself-reportsusingatimewindow.
Modality Description
Location radiusofgyration,distancetraveled,meanaltitude
Bluetooth numberofdevices(thetotalnumberofuniquedevicesfound),mean/std/min/max
[lowenergy, rssi(ReceivedSignalStrengthIndication–measureshowclose/distantother
normal] devicesare)
connectedtoanetworkindicator,numberofdevices(thetotalnumberofunique
WiFi
devicesfound),mean/std/min/maxrssi
Cellular[GSM, numberofdevices(thetotalnumberofuniquedevicesfound),mean/std/min/max
WCDMA,LTE] phonesignalstrength
notificationsposted(thenumberofnotificationsthatcametothephone),
Notifications notificationsremoved(thenumberofnotificationsthatwereremovedbythe
user)–thesefeatureswerecalculatedwithandwithoutduplicates.
Proximity mean/std/min/maxofproximityvalues
timespentdoingactivities:still,in_vehicle,on_bicycle,on_foot,running,tilting,
Activity
walking,other(derivedusingtheGoogleactivityrecognitionAPI[30])
stepscounter(stepsderivedusingthetotalstepssincethelastphoneturnedon
Steps at10samplespersecond),stepsdetected(stepsderivedusingeventtriggeredfor
eachnewstepcapturedonchange)
numberofepisodes(episodeisfromturningthescreenofthephoneonuntilthe
Screenevents screenisturnedoff),mean/min/max/stdepisodetime(atimewindowcouldhave
multipleepisodes),totaltime(totalscreenontimewithinthetimewindow)
timetheuserispresentusingthephone(derivedusingandroidAPIthatindicate
Userpresence
whetherapersonisusingthephoneornot)
Touchevents touchevents(numberofphonetouchevents)
timespentonappsofeachcategoryderivedfromGooglePlayStore[44,70]:
action,adventure,arcade,art&design,auto&vehicles,beauty,board,books&
reference,business,card,casino,casual,comics,communication,dating,
education,entertainment,finance,food&drink,health&fitness,house,lifestyle,
Appevents
maps&navigation,medical,music,news&magazine,parenting,personalization,
photography,productivity,puzzle,racing,roleplaying,shopping,simulation,
social,sports,strategy,tools,travel,trivia,videoplayers&editors,weather,word,
not_found
Proc.ACMInteract.Mob.WearableUbiquitousTechnol.,Vol.8,No.2,Article46.Publicationdate:May2024.46:30 • Meegahapolaetal.
B WEEEDATASETFEATURES[6]
Table5. Summaryofthefeaturesusedintheanalysis.
Modality Description
Statisticalfeaturescalculatedusingtsfresh[15]:sum_values,median,mean,length,
Accelerometer
standard_deviation,variance,root_mean_square,maximum,absolute_maximum,minimum
Statisticalfeaturescalculatedusingtsfresh[15]:sum_values,median,mean,length,
Gyroscope
standard_deviation,variance,root_mean_square,maximum,absolute_maximum,minimum
FeaturesderivedusingHeartPy[77]:bpm,ibi,sdnn,sdsd,rmssd,pnn20,
Photoplethysmography
pnn50,hr_mad,sd1,sd2,s,sd1/sd2,breathingrate
Proc.ACMInteract.Mob.WearableUbiquitousTechnol.,Vol.8,No.2,Article46.Publicationdate:May2024.
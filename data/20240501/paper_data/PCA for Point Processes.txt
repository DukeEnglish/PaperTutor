SubmittedtotheAnnalsofStatistics
PCA FOR POINT PROCESSES
BY FRANCK PICARD1,a VINCENT RIVOIRARD2,b
ANGELINA ROCHE2,c AND VICTOR PANARETOS3,d
1LaboratoiredeBiologieetModélisationdelaCellule,CNRSENSdeLyon,,afranck.picard@ens-lyon.fr
2CEREMADE,UniversitéParisDauphine,,brivoirard@ceremade.dauphine.fr;croche@ceremade.dauphine.fr
3InstitutdeMathématiques,EcolePolytechniqueFédéraledeLausanne,,dvictor.panaretos@epfl.ch
Weintroduceanovelstatisticalframeworkfortheanalysisofreplicated
pointprocessesthatallowsforthestudyofpointpatternvariabilityatapop-
ulationlevel.Bytreatingpointprocessrealizationsasrandommeasures,we
adoptafunctionalanalysisperspectiveandproposeaformoffunctionalPrin-
cipalComponentAnalysis(fPCA)forpointprocesses.Theoriginalityofour
methodistobaseouranalysisonthecumulativemassfunctionsoftheran-
dom measures which gives us a direct and interpretable analysis. Key the-
oreticalcontributionsincludeestablishingaKarhunen-Loèveexpansionfor
the random measures and a Mercer Theorem for covariance measures. We
establishconvergenceinastrongsense,andintroducetheconceptofprinci-
palmeasures,whichcanbeseenaslatentprocessesgoverningthedynamics
oftheobservedpointpatterns.Weproposeaneasy-to-implementestimation
strategyofeigenelementsforwhichparametricratesareachieved.Wefully
characterizethesolutionsofourapproachtoPoissonandHawkesprocesses
andvalidateourmethodologyviasimulationsanddiverseapplicationsinseis-
mology, single-cell biology and neurosiences, demonstrating its versatility
andeffectiveness.OurmethodisimplementedinthepppcaR-package.
1. Introduction. Point processes constitute a ubiquitous framework that is essential in
probabilityandstatisticsaswellasinnumerousapplicationfields.Inthemostgeneralsense,
point processes are discrete random sets in an arbitrary space, serving as the natural math-
ematical formalism for discrete random patterns. Depending on the ambient space, point
processes can model spatial/temporal events, tessellations of space, or random geometrical
configurations.Poissonprocessesarearguablyfundamental[40],duetotheirsimplicity,and
because they serve as building blocks for more elaborate point process models. Key models
includerenewal,marked,cluster,ordoublystochasticpointprocesses[22,23],andgeomet-
rical aspects have also long been reviewed [16]. When the ambient space is the real line,
point processes represent sequences of discrete events in time and are referred to as tempo-
ral point processes, among which Hawkes processes [32, 33] are crucial for enhancing the
flexibility of modeling temporal events, introducing a tractable and interpretable model of
temporal dependency [8, 9]. The Poisson and Hawkes processes are among the most funda-
mental,popular,andanalytically/statisticallytractable,servingasbasicexamples,including
inthepresentwork.Giventheirformidableflexibilityinhandlingparticularcharacteristicsof
thedata,thescopeofapplicationofpointprocessmodelsisvast,rangingfromneurosciences
[6, 17, 42] to genomics [12, 30], ecology [56], epidemiology [15], seismology [48], social
sciences[20,28,46]andstockpricesmoves[26]tonamebutafew.
Statistical inference for point processes has a long history [1, 39], with non-parametric
approaches being favored for analyzing Poisson [4, 41, 52, 57] and Hawkes processes
[3,13,31,53].Maximumlikelihood[5,17,48]andtheBayesianframeworkhavealsoshown
MSC2020subjectclassifications:Primary62M,62P;secondary60G55,62H25.
Keywordsandphrases:Pointprocesses,Karhunen-Loèveexpansion,PCA.
1
4202
rpA
03
]EM.tats[
1v16691.4042:viXra2
goodperformance[25,50,55].However,currentframeworksareprimarilybasedontheob-
servationofasinglepointprocess,whileincreasingly,variousfieldsareprovidingdatainthe
formofreplicatedpointprocesses.Forexample,inthefieldofearthsciences,pointprocesses
areessentialtoassesstheseismicrisk,whichcanhavesignificantimplicationsforcivilengi-
neering and insurance, for example. In the seminal work of [48], dependent point processes
were proposed to study preseismic quiescence and foreshocks that are expected to precede
major earthquakes. This accurate modeling of earthquake hazards appears crucial to antici-
patefutureearthquakesbeforetheyoccur.Analyzingearthquakeoccurrencesacrossvarious
sitescouldhelpinidentifyingcitiesthatshowunusualearthquakeaccumulationpatterns,or
tomore clearlyidentify thecharacteristicpatterns ofseismic activitybeforeand aftermajor
earthquakes.InthisworkwewillconsiderTurkishcitiessubjecttorecordedearthquakesover
time,investigatingthevariabilityofthesetemporalpatternsamongcities[38].Insingle-cell
genomics,itisnowpossibletoindividuallycharacterizegenomesbasedonepigeneticmarks
organizedalongchromosomesinaone-dimensionalarray[60].Furthermore,theserepeated
pointpatternsareinstrumentalincharacterizingthediversityofcancercellsandtheiremer-
gence of drug resistance. In neuroscience, observing spiking neurons has become routine
for investigating whether their coordinated activity relates to the function of specific brain
regions[21].Whatunifiestheseexamplesisthatreplicatedpointprocessesofferanopportu-
nitytostudythevariabilityofpointpatternsfromanewperspective,characterizingdataata
populationlevel.Thisposesnewmathematical,statistical,andmethodologicalchallenges,as
moststandardstatisticalframeworksarededicatedtocontinuousvalueddataandnottosets
ofpoints.
Inthisworkweproposetoputforwardadifferentstatisticalperspectiveonpointprocesses
by developping a new framework for dimension reduction and visualisation of replicated
point processes. Our framework is based on a functional analysis perspective - to be con-
trastedtotheperspectivebasedonrandomsets.Viewingtherealizationofapointprocessas
arandommeasure,andthusaboundedlinearfunctionaloveranappropriatelyregularspace
of functions, we obtain uniform series representations and associated notions of principal
modes of variation. This allows us to develop a Principal Component Analysis framework
paralleling that of functional PCA (fPCA). fPCA is the workhorse of functional data analy-
sis[43].Itenablesthevisualizationoffunctionaldata,seenasrandomcurvesovercompact
sets (as described in [54]), enables dimensionality reduction and regularisation in regres-
sion/testing/classification[24,34,51],andprovidesabridgetoextendclassicalmultivariate
procedures(likemodelbasedclustering)tofunctionaldata[27,37].Thetheoreticalunderpin-
ningsoffPCArelyontwofundamentalresults:theKarhunen-LoèveTheoremandMercer’s
Theorem [35]. In particular, the Karhunen-Loève theorem asserts that the approximation of
functional data by their principal components is uniformly convergent (in the mean-square
sense).However,thetheoryoffPCAdoesnotapplytopointprocesseswhicharemoreintri-
catemathematicalobjects.
Thelinkbetweenpointprocessesandfunctionaldataisanaturalapproachtodefineequiv-
alent of PCA for samples of point processes, and has been attempted before, albeit via the
intensity function: [58] have considered PCA based on kernel estimators of the intensities
of the point processes and they obtained a Karhunen-Loève decomposition for the corre-
sponding intensities. A similar approach, based on the estimation of L-functions, has been
adopted in [36] in the case of spatial processes. However these approaches have notable
drawbacks. First, instead of relying on the observed point process, they relate to an inten-
sity (heuristically, a derivative) that is not observable. Furthermore, and most importantly,
theydonotallowforaKarhunen-Loèveexpansionforthemeasuresassociatedtotheinitial
process; this is a theoretical but also practical drawback, in terms of interpretation. Other
approachesinclude[44]whoproposedaconvenientHilbertiansettingforPCAofmeasuresPCAFORPOINTPROCESSES 3
fortheanalysisofdistributionfunctionsappearinginthestudyofgrain-sizecurve.Closestin
spirittoourapproach,[11]recentlyobtainedKarhunen-Loèveexpansionsofgeneralrandom
measures. More precisely, Theorem 4.1 of [11] proves that under mild assumptions, a finite
regular random measure over Rd can be written as a series expansion of deterministic real
finite measures weighted by uncorrelated real random variables with summable variances.
The convergence of the series is in a weak sense, though, and hence does not constitute a
Karhunen-Loèveexpansion.Consequently,theresultisnotused(ordirectlyusable,forthat
matter)forthepurposesofstatisticalanalysis.
Todescribeourcontributions,weconsider n i.i.d.pointprocesses (N ,N ,...,N ),and
1 2 n
their associated random measures, (Π ,...,Π ). We start with Theorem 3.2, which estab-
1 n
lishestheKarhunen-LoèveexpansionfortherandommeasuresΠ ,aswellasaMercerThe-
i
oremforthecovariancemeasureoftheprocess(seeTheorem3.4).Weestablishconvergence
inastrongsense.UtilizingtheseriesexpansionprovidedbytheKarhunen-Loèvedecompos-
tion, we introduce the concept of principal measures, which can be seen as latent processes
governingthedynamicsoftheobservedmeasures.Theseresultsarebasedontheembedding
of the measures Π in a functional space using their associated cumulative mass functions
i
defined in Equation (2). This embedding allows us to integrate our model within the func-
tional PCA framework. We then construct a natural associated covariance operator whose
eigenfunctions are the cumulative mass functions of the principal measures. Eigenelements
arecharacterizedforPoissonprocessesandHawkesprocesseswithexponentialself-exciting
function by solving second-order differential systems provided in Equation (10). When the
Poisson process is homogeneous, the eigenfunctions of the covariance operator consist of a
Fourier-like basis, and we also show that the eigenvalues exhibit a polynomial decay. When
the Poisson process is inhomogeneous, the eigenfunctions are implicit; however, a detailed
qualitative analysis allows us to show that the eigenfunctions are oscillatory. Surprisingly,
we demonstrate that similar phenomena occur in the case of the Hawkes process. We pro-
pose a full estimation framework based on the observation of the N ’s that does not require
i
any smoothing, and provide convergence of estimators at the parametric rate. Our theoret-
ical results are complemented by a simulation study that exemplifies the convergence of
eigenvaluesandeigenfunctions.Wethenapplyourframeworkinseismology,genomics,and
neuroscience, illustrating the versatility and power of our methodology. We also provide a
R-package,pppca1,thatimplementsourmethod.
The article is organized as follows. Section 2 introduces the setting of our work. Sec-
tion 3 establishes Karhunen-Loève and Mercer Theorems for point processes. In Section 4,
we study the Poisson process and a specific class of Hawkes processes in detail by using
the analytical point of view. Section 5 introducess our estimators of the eigenelements and
establishesratesofconvergence.OurnumericalstudyiscarriedoutinSection6.Section7is
devotedtoapplications.TheproofsofourresultsarecollectedinSection 8.
Notation. Weintroducesomenotationthatwillbeusefulthroughoutthearticle.Foraset
I,wedenote
(cid:110) (cid:111)
L2(I)= f :I →R: ∥f∥<+∞ ,
where∥f∥standsfortheL -normoff:∥f∥=(cid:0)(cid:82) |f|2(cid:1)1/2 .Theassociatedscalarproductis
2 I
denoted⟨f,g⟩=(cid:82) f(t)g(t)dt.Finally,forf ∈L2(I)andµameasureonI,wealsousethe
(cid:82)I
notation⟨f,µ⟩= f(t)dµ(t).
I
1https://github.com/franckpicard/pppca4
2. A signed-measure model for dimension reduction. Consider n independent and
identically distributed (i.i.d.) temporal point processes (N ,N ,...,N ), observed on the
1 2 n
timeinterval[0,1].Theseprocesses,definedontheprobabilityspace(Ω,A,P),areassociated
withsomerandommeasures(Π ,...,Π )sothat:
1 n
(cid:88)
Π (B)= 1 =Card(N ∩B), B∈B,
i {T∈B} i
T∈N
i
where B is the Borel σ-field of subsets of [0,1]. Hence, Π ,...,Π is a sample of random
1 n
measures on ([0,1],B). We denote by Π a random measure following the same distribution
as the Π ’s and N the point process associated with Π. Assuming that E[Π([0,1])]<+∞,
i
wedenotethefirstmomentofΠbyW:
W(B)=E(cid:2) Π(B)(cid:3)
, B∈B.
In the initial step of our dimension reduction framework, we center the observed data by
definingasignedrandommeasure
∆ (B)=Π (B)−W(B), B∈B.
i i
The ∆ ’s have the same distribution as ∆ = Π−W. Then, we define of a second-order
i
momentfor∆,inspiredfromtheformalismproposedby[49]and[11].Forthispurpose,we
definethesignedmeasureofcovariance:forallB×B′∈B⊗B
C
(B×B′):=Cov(Π(B),Π(B′))=E(cid:2) ∆(B)∆(B′)(cid:3)
∆
(cid:34) (cid:35)
(cid:88)
= E 1 −(W ⊗W)(B×B′)
{(T,T′)∈B×B′}
T∈N,T′∈N
with B⊗B theproduct σ-algebraof [0,1]×[0,1],andwhere,fortwomeasures µ and ν on
([0,1],B)theproductmeasureµ⊗ν on([0,1]2,B⊗B)isdefinedsuchthat
(µ⊗ν)(B×B′)=µ(B)ν(B′), B,B′∈B.
Weassumethroughoutthat
(cid:104) (cid:105)
(1) E Π2([0,1]) <∞,
whichimpliesthatC isafinitemeasure.
∆
Now, to perform dimension reduction of the N ’s (equivalently the Π ’s) we shall take
i i
advantage of the rich framework of the functional perspective. Following [18] for instance,
givenarandommeasureµ,weconsidertheassociatedcumulativemassfunctiondefinedby
(2) F (t)=µ([0,t]), t∈[0,1].
µ
Then, we introduce K , the bivariate cumulative mass function of the covariance measure
∆
C ,suchthat:
∆
K (s,t)=C ([0,s]×[0,t])=E[F (s)F (t)], s,t∈[0,1]
∆ ∆ ∆ ∆
andtheassociatedintegraloperator
(cid:16) (cid:17)
Γ =E F ⊗F
∆ ∆ ∆
where ⊗ is the tensor product between two elements of L2([0,1]) denoted by f ⊗g(h)=
⟨f,h⟩g.ThecovarianceoperatorΓ isexpressedas
∆
Γ (f)(·)=E(⟨f,F ⟩F (·)), f ∈L2,
∆ ∆ ∆
(cid:90) 1
= K (·,t)f(t)dt.
∆
0PCAFORPOINTPROCESSES 5
Then, dimension reduction is based on the Mercer expansion of the covariance kernel K .
∆
Indeed, in the case where K is continuous, Mercer’s Theorem applies and ensures the ex-
∆
istenceofasequenceofnon-negativerealnumbers(λ ) ∈ℓ1(N∗)andorthonormalfunc-
j j≥1
tionalbasis(η ) ofL2([0,1])suchthat
j j≥1
(cid:88)
(3) K (s,t)= λ η (s)η (t), s,t∈[0,1],
∆ j j j
j≥1
with uniform and absolute convergence of the series (see Theorem 4.6.5 of [35]). Further-
more,η isaneigenfunctionoftheoperatorΓ associatedwiththeeigenvalueλ .Now,the
j ∆ j
questionisthefollowing.Howcanweusethedecomposition(3)tobuildaseriesexpansion
forΠandC ?Thisissueistackledinthenextsection.
∆
3. Karhunen-Loève expansion and Mercer theorem for point processes. This sec-
tionisdevotedtoproveaKarhunen-LoèvetheoremfortherandommeasureΠandaMercer
theorem for the covariance measure C . The obtained expansions will be based on specific
∆
sequencesofmeasures(µ ) ,calledprincipalmeasures.
j j
We start from the decomposition (3). Since Γ is a compact self-adjoint operator, the
∆
eigenvalues(λ ) areisolated,withfinitemultiplicitiesandwehave
j j≥1
λ ≥λ ≥0, ∀j≥1,
j j+1
withλ →0whenj→+∞(seeChapter6of[10]).Inthesequel,weassumethatin(3),all
j
the λ ’s are strictly positive. The following proposition is a central result that allows us to
j
defineourprincipalmeasuresfromthebasisfunctions(η ) .
j j≥1
PROPOSITION 3.1. WesupposethatAssumption(1)issatisfiedandthatK
∆
iscontinu-
ous.Then,forallj≥1,thederivativeinthedistributionalsenseofη isameasure,denoted
j
byµ ,thatverifies
j
η (t)=µ ([0,t])=F (t), t∈[0,1]
j j µ
j
(cid:110)
and,forallφ∈H1= f ∈L2(I):f′∈L2(I)andf(t)=0forallt∈/I},
0
(cid:90) 1
(4) ⟨η ,φ′⟩=⟨F ,φ′⟩=− φ(s)dµ (s)=−⟨φ,µ ⟩.
j µ j j
j
0
Now,usingtheµ ’sderivedinProposition3.1andfollowingtheproofofTheorem4.1of
j
[11],weobtainthatforallmeasurableandboundedfunctionφon[0,1],
(cid:34) (cid:35)
√
(cid:88) (cid:88) (cid:88)
φ(T)=E φ(T) + λ ξ ⟨µ ,φ⟩.
j j j
T∈N T∈N j≥1
(cid:80)
This result allows us to interpret the variations of φ(T) around its mean as a sum of
T∈N
randomvariableswithdecreasingvariance.Itcanalsobeexpressedasfollows:
√
(cid:88)
(5) Π(B)=W(B)+ λ ξ µ (B), B∈B.
j j j
j≥1
The convergence of the series holds then pointwise, i.e. for all B∈B (or for all measurable
and bounded function φ). However, the strength of the Karhunen-Loève theorem for gen-
eral stochastic processes is that the convergence holds uniformly on [0,1] which prevents
problems on the boundaries (typically Gibbs effect type phenomena). This is not ensured
by Theorem 4.1 of [11]. Therefore, we first establish a Karhunen-Loève decomposition for6
point processes for which the convergence holds uniformly for all sufficiently regular func-
tions.Uniformity,however,cannotbeinthetotalvariationdistance:asillustratedinSection4
for Poisson and Hawkes processes, the measures (µ ) are signed measures with very reg-
j j
ular densities (typically C∞). On the contrary, the measure Π is discrete. This implies that
the convergence cannot hold uniformly for all continuous and bounded functions, that is to
say, unifromly in total variation. For this reason, in the sequel, uniform convergence will be
relatedtoSobolevspacesinstead.Forthispurpose,weintroduce,forI =(0,1)orI =(0,1)2
(cid:110)
Hk= f ∈L2(I):∂ f ∈L2(I)forall|α|≤k andf(t)=0forallt∈/I},
0 α
where, for a bivariate function f :(s,t)(cid:55)→f(s,t), and a bi-index α =(α ,α )∈N2, we
1 2
set |α|=α +α and ∂ f = ∂|α|f ; when f is a univariate function ∂ f =f(α). The
1 2 α ∂sα1∂sα2 α
derivativesandpartialderivativesaretakeninthedistributionsensemeaningthat∂ f verifies
α
theequality
⟨∂ f,φ⟩=(−1)|α|⟨f,∂ φ⟩,
α α
forallinfinitelydifferentiablefunctionsφwithsupportinI.Sobolevnormsofnegativeorder
arealsointroducedasthenormofthedualspaceofHk,namely
0
(cid:40) (cid:41)
(cid:88)
∥µ∥ =sup |⟨f,µ⟩|:f ∈Hk and ∥∂ f∥2≤1 .
H−k 0 α
|α|≤k
ThedefinitionandpropertiesofthesespacesaredescribedinBrezis[10,Chapters8,9].With
thesedefinitionsinplace,wemaynowstate:
THEOREM 3.2 (Karhunen-Loève Theorem for point processes). Suppose that Assump-
tion (1) is satisfied and that K is continuous. Then, there exists a sequence {ξ } of
∆ j j≥1
uncorrelatedrealrandomvariablesofmeanzeroandvarianceonesuchthat
(cid:13) (cid:13)2 
(cid:13) J √ (cid:13)
lim E (cid:13) (cid:13)Π−W −(cid:88) λ jξ jµ j(cid:13) (cid:13) =0.
J→+∞ (cid:13) (cid:13)
(cid:13) j=1 (cid:13)
H−1
REMARK 3.3. Usingthefactthat,foranyBorelfunctionφ,
(cid:34) (cid:35)
(cid:88) (cid:88)
⟨φ,Π−W⟩= φ(T)−E φ(T)
T∈N T∈N
adirectconsequenceofTheorem3.2isthat

(cid:34) (cid:35)
2
J
lim sup E
(cid:88)
φ(T)−E
(cid:88)
φ(T)
−(cid:88)(cid:112)
λ jξ j⟨µ j,φ⟩ =0.
J→+∞φ∈H1,∥φ∥+∥φ′∥≤1
0 T∈N T∈N j=1
ByanalogywithfPCA,theelementsofthesequence{ξ } arecalledthescoresassoci-
j j≥1
atedtothemeasureΠ(orassociatedtothepointprocessN).Theyplayacentralroleinthe
studyofthedataweconsider(seeSection6).Indeed,foreachindividuali,itcanbededuced
fromtheKarhunen-LoèvedecompositionthatforJ large,
J
(cid:88)(cid:112)
(6) Π (B)≈W(B)+ λ ξ µ (B), B∈B
i j i,j j
j=1PCAFORPOINTPROCESSES 7
or
J
(cid:88)(cid:112)
(7) Π ([0,t])≈W([0,t])+ λ ξ F (t), t≥0
i j i,j µ
j
j=1
with
⟨F ,F ⟩
µ ∆
(8) ξ = √j i .
i,j
λ
j
AstowhatconcernsthecovariancemeasureC ,weestablishthefollowingMercertheorem:
∆
THEOREM 3.4(Mercer’sTheoremforC ∆). WesupposeAssumption(1)issatisfiedand
thatK iscontinuous.Then
∆
(cid:13) (cid:13)
(cid:13) J (cid:13)
(cid:13)(cid:88) (cid:13)
(9) (cid:13) λ jµ j ⊗µ j −C ∆(cid:13) −−−−−→0.
(cid:13) (cid:13) J→+∞
(cid:13)j=1 (cid:13)
H−2
Inthenextsections,wefocusonthestudyoftheeigenelements (λ ,F ) .Recallthat
j µ j≥1
j
wehaveaneasycorrespondencebetweenthemeasuresµ andthemassfunctionsF thanks
j µ
j
to Eq. (2). In Section 4, we study Poisson and specific classes of Hawkes processes analyt-
ically. For these central examples of points processes, we derive the asymptotic behavior of
(λ ,F )whenj goesto+∞.Weevenobtaintheexplicitformoftheeigenelementsforthe
j µ
j
homogeneousPoissonprocessforallj’s.InSection5,forthegeneralsetting,weprovidean
estimationschemefortheeigenelementsbasedonrealizationsof(N ,N ,...,N ).
1 2 n
4. Study of eigenelements for Poisson and Hawkes processes. The goal of this sec-
tionistocomplementthegeneralresultsofSection3withsomeconcreteandexplicitcases,
by adopting a constructive point of view to determine how eigenelements behave, at least
asymptotically. For the two classical point process models, Poisson and Hawkes with expo-
nential self-exciting functions, we show that determining their eigenelements involves solv-
ingsecond-orderdifferentialequationsoftheform
 (cid:90) 1
−λy′′(t)=w(t)y(t)+ M(s,t)y(s)ds,t∈(0,1),
(10)
0
y(1)=0, y′(0)=0.
Moreprecisely,
1. forthePoissonprocess,w istheintensityoftheprocessandM =0,
2. for the Hawkes process with exponential self-exciting function, w is a constant propor-
tionaltothebaselineintensityandM isanexponentialconvolutionkernel(seeEq.(18)).
Observethatforanyconstantc>0,(λ,y)isasolutionof(10)ifandonlyif(λ,c×y)isalso
asolution.Forj≥1,weintroduce
(cid:90) 1
(11) H (t)= F (s)ds, t∈[0,1],
j µ
j
t
and we shall prove that the eigenelements (λ ,F ) of Γ correspond to solutions
j µ j≥1 ∆
j
(λ ,H ) ofSystem(10),onceH isrenormalizedsothat∥F ∥ =1.
j j j≥1 j µ 2
j
RelationshipsthatconnectingKarhunen-Loèveexpansionstodifferentialequationsofor-
der 2 have already been established in the study of stochastic processes. See for instance8
Section A of [19] for the case of the Ornstein-Uhlenbeck process. The system of equations
(10)appearsnaturallywhenwestudytheequation
(cid:90) 1
λ F (t)= K (t,s)F (s)ds, t∈[0,1]
j µ ∆ µ
j j
0
bytakingderivativesofleftandrighthandsides.Seeforinstancethestraighfrowardproofof
Theorem 4.1, below. In the sequel, except in Remarks 4.2 and 4.9, we assume that the λ ’s
j
arepositive.
4.1. EigendecompositionforPoissonpointprocesses. HerewesupposethatN isaPois-
sonprocesswithintensityt∈[0,1](cid:55)−→w(t)assumedtobecontinuousandpositiveon(0,1).
Inthiscase,
(cid:90)
W(B)= w(t)dt, B∈B
B
and Π(B) is a Poisson variable with parameter W(B). Furthermore, for two disjoint Borel
setsB andB′,Π(B)andΠ(B′)areindependentsothat
(cid:90) t
F (t)=W([0,t])= w(u)du, 0≤t≤1
W
0
and
(cid:90) min{s;t}
(cid:0) (cid:1)
K (s,t)=F min{s;t} = w(u)du, 0≤s,t≤1.
∆ W
0
Thefollowingresult,whichinvolvesthefunctions H introducedin(11),providesthePCA
j
dimensionreductionforPoissonprocesses.
THEOREM 4.1. Assuming w is continuous and positive on (0,1), then (λ j,F
µ
)
j≥1
are
j
theeigenelementsoftheoperatorΓ ifandonlyif(λ ,H ) aresolutionsofthefollowing
∆ j j j≥1
Sturm-Liouvilleproblem:
(cid:26) −λy′′(t)=w(t)y(t), t∈(0,1),
(12)
y(1)=0, y′(0)=0.
Mercer’sandKarhunen-LoèveexpansionsforPoissonprocessesarethenprovidedbyso-
lutionsofSystem(12)andbyusingtherelationship
F (t)=−H′(t), t∈[0,1].
µ j j
REMARK4.2. TheproofofTheorem4.1showsthatifF
µ
isacontinuouseigenfunction
0
of Γ associated with the zero eigenvalue, then F is solution of (12) with λ=0 and then
µ
0
F =0.
µ
0
Unfortunately, solutions of System (12) are typically not explicit. However, the specific
case where w is constant, corresponding to the homogeneous Poisson process, is of interest
andcanbeeasilydealtwith.PCAFORPOINTPROCESSES 9
4.1.1. Homogeneous Poisson processes. In the case of homogeneous Poisson process,
thefunctionw isconstanton[0,1]:forsomew ∈R∗,
0 +
w(t)=w , t∈[0,1]
0
andthesolutionsofEquation(12)canbeobtainedexplicitly
4w
0
λ = , H (t)=A cos(π(2j−1)t/2), t∈[0,1], j≥1
j π2(2j−1)2 j j
whichimplies,takingintoaccounttheconstraint∥F ∥=1,
µ
j
√
(13) F (t)= 2sin(π(2j−1)t/2), t∈[0,1], j≥1.
µ
j
In particular, the eigenfunctions F are highly oscillating functions with exactly j zeros
µ
j
on[0,1]atpointsx =2k/(2j−1),k=0,...,j−1.
k
Then,wecanfinallywritethatifN isahomogeneousPoissonprocesswithintensityw ,
0
√
2 2w 0 (cid:88) ξ j
Π([0,t])=w t+ sin(π(2j−1)t/2), t∈[0,1],
0
π 2j−1
j≥1
with{ξ } uncorrelatedcentredrealrandomvariablesofunitvariance.
j j≥1
REMARK4.3. ObservethatinthehomogenousPoissonsetting,K ∆(s,t)=w 0min{s;t},
which corresponds to the covariance kernel of the Brownian motion, so that the Karhunen-
LoèvedecompositionofΠcanbededucedfromtheoneoftheBrownianmotion(seee.g.[2],
pp.41–42).ThemaindifferencewiththeBrownianmotionisthatthescores{ξ } arenot
j j≥1
Gaussian.
4.1.2. Inhomogeneous Poisson processes. The general Poisson case is much more in-
volved,since,whenwisnotconstant,wecannotderiveexplicitsolutionsof(12),infullgen-
erality. But we prove in this section that solutions of (12) exist and some useful qualitative
properties of them can be obtained. Actually, system (12) is a self-adjoint Sturm-Liouville
problem with separated boundary conditions, which has been extensively considered in the
literature. We refer the reader to Chapter 4 of [59] and more precisely to equations (4.1.1)-
(4.1.4)with
p≡1, q≡0, λ−1 insteadofλ.
Therefore,wehavethefollowingresult[59].
THEOREM 4.4 (Theorems 4.3.1 and 4.6.2 of [59]). We consider the solutions (λ j,H j)
j
oftheSturm-Liouvilleproblem(12)withw∈L [0,1]andassumethatwispositiveon(0,1).
1
Wehave:
1. Theeigenvalues(λ ) aresimpleandasymptotically,wehave
j j≥1
(cid:16) (cid:82)1(cid:112) (cid:17)2
w(u)du
j→+∞ 0
λ ∼ .
j π2j2
2. Forj≥1,ifH isthesolutionassociatedwithλ ,thenH isuniqueuptoamultiplicative
j j j
constantandhasexactlyj−1zeroson(0,1).10
3. Thesequence(H ) canbenormalizedtobeanorthonormalsequenceinL ([0,1],w),
j j≥1 2
i.e.
(cid:90) 1 (cid:26) 0ifj̸=j′
H (u)H (u)w(u)du=
j j′ 1ifj=j′
0
REMARK 4.5. ByusingthethirdpointofTheorem4.4,weobservethatforj̸=j′,
(cid:90) 1 (cid:90) 1
F (u)F (u)du= H′(u)H′ (u)du
µ j µ j′ j j′
0 0
(cid:90) 1
=H′(1)H (1)−H′(0)H (0)− H′′(u)H (u)du
j j′ j j′ j j′
0
(cid:90) 1
=λ−1 H (u)H (u)w(u)du=0,
j j j′
0
sothat,onceconvenientlynormalized, (F ) isan L -orthonormalbasis,asrequiredby
µ j≥1 2
j
ourtheory.
Unlikethehomogeneouscase,wedonotobtaintheexactvaluesoftheeigenvaluesλ for
j
allj’s,butthefirstpointofTheorem4.4providestheirasymptoticbehaviorwhenj→+∞.
The numerical study of Section 6 goes further since it shows that, for even small values of
j, λ is close to
((cid:82)1(cid:112)
w(u)du)2/(jπ −π/2)2, exactly as for the homogeneous case (see
j 0
Figure2).
Combining the second point of Theorem 4.4 and the boundary condition H (1) = 0,
j
we obtain that H has exactly j zeros on (0,1]. Since F (t)=−H′(t) for t∈[0,1] and
j µ j j
F (0)=0, Rolle’s theorem yields that F has at least j zeros on [0,1) and is therefore
µ µ
j j
a highly oscillating functions, exactly as for the homogeneous case for which the functions
F aresinefunctions(see(13)).Thesequalitativepropertiesareconfirmedbythenumerical
µ
j
study of Section 6 (see Figure 1). The numerical examples considered show that the F ’s
µ
j
haveexactlyj zeroson[0,1).
Toconclude,whenwisnotconstant,wecannotgiveaclosedexpressionofeigenelements
of the operator Γ , but through the study of their behavior provided by the Surm-Liouville
∆
theory,wehaveestablishedthattheycanbeviewedasperturbationsoftheeigenelementsof
thehomogeneousPoissoncase.
4.2. Eigendecomposition for Hawkes processes with exponential self-exciting functions.
We extend our analytical results by providing results on dimension reduction for (linear)
Hawkes processes. Hawkes processes were designed by Alan G. Hawkes [32, 33] to model
thepropertiesofself-excitation.Thismodelseemsparticularlynaturaltoaccountfordepen-
denciesinourpointprocessmodel.Hawkesprocessescanbeviewedasabranchingprocess
over a homogeneous Poisson process but they are also characterized by their stochastic in-
tensityw(t)definedby
(cid:104) (cid:105)
w(t)= limδ−1E Π[0,t+δ]−Π[0,t]|F ,
t
δ→0
where the filtration F stands for the information available up to (but not including) time t;
t
w(t) can also be interpreted as the probability to have a new occurence at time t given the
past.PCAFORPOINTPROCESSES 11
DEFINITION 4.6. The (linear) Hawkes process with baseline intensity w 0>0 and self-
excitingfunctionh:R (cid:55)−→R isapointprocessN withintensity
+ +
(cid:90) t−
(cid:88)
(14) w(t)=w + h(t−s)dN =w + h(t−T).
0 s 0
−∞
T∈N,T<t
Observe that the larger h, the stronger the influence of the past. If h=0, the associated
HawkesprocesscorrespondstoahomogeneousPoissonprocesswhoseintensityisthebase-
line intensity w . In the sequel, we mainly consider an exponential self-exciting function,
0
i.e.
(15) h(t)=αexp(−βt), t>0,
andinthiscase,theintensitybecomes
(cid:90) t−
(cid:88)
w(t)=w +α exp(−β(t−s))dN =w +α exp(−β(t−T)),
0 s 0
−∞
T∈N,T<t
meaning that the influence of the past decreases exponentially in time. The intensity as-
sociated with an exponential self-exciting function becomes a Markov process [47]. In the
sequel, we assume that ∥h∥ <1. For the case of exponential self-exciting function h given
1
in(15),thisconditionisequivalenttoα<β.Ifthisassumptionisviolated,thatis,inthecase
∥h∥ >1,wewouldeventuallygetsomeclustersthatproduceoffspringindefinitely,causing
1
the process to explode. Furthermore, assuming ∥h∥ <1 ensures that there exists a unique
1
stationaryversionoftheHawkesprocessN withintensitygivenby(14).Underthisassump-
tion,wecanderivethemeanandthecovariancekernelofN.Ifweconsidertheexponential
case,weobtainexplicitexpressions.
PROPOSITION 4.7. Weassumethatfort>0,h(t)=αe−βt,with0<α<β.Then,
w βt
0
(16) F (t)=W([0,t])= , t>0,
W
β−α
and
(17)
K (s,t)=
β3w 0 s+w 0αβ(2β−α)(cid:0) −1−e(α−β)(t−s)+e(α−β)t+e(α−β)s(cid:1)
, 0<s≤t.
∆ (β−α)3 2(β−α)4
The proof of Proposition 4.7 can easily be deduced from results in Section 3 of [29].
Subsequently, using the functions H introduced in (11), the following result provides the
j
PCAdecompositinforHawkesprocesseswithexponentialself-excitingfunction.
THEOREM 4.8. We assume that for t > 0, h(t) = αe−βt, with 0 < α < β. Then,
(λ ,F ) are the eigenelements of the operator Γ if and only if (λ ,H ) are so-
j µ j≥1 ∆ j j j≥1
j
lutionsofthefollowingsystem:
 βw w αβ(2β−α)(cid:90) 1
−λy′′(t)= 0 y(t)+ 0 e−(β−α)|t−s|y(s)ds,t∈(0,1),
(18) β−α 2(β−α)2
0
y(1)=0, y′(0)=0.
REMARK 4.9. Similarly to the Poisson case, if F
µ
is a continuous eigenfunction of Γ
0
associatedwiththezeroeigenvalue,thenF =0.
µ
012
Thefollowingresultshowsthatifαissmall,thesolutionsoftheODE(18)areoscillating
functions.Inthisparticularsetting,wethenobtainabehaviorclosetothebehaviorobserved
forthePoissoncase.
THEOREM 4.10. Assumeα<β and
α(2β−α)(cid:16) 3−2e−(β−α)/2−e−(β−α)(cid:17)
(19) 2+ <1.
β−α β−α
Let
βw
0
w = .
1
β−α
Then, the eigenvalues (λ ) are simple and for all j ≥1, there exists a solution (λ ,H )
j j≥1 j j
tothesystem(18)suchthat∥F ∥ =1andwehave
µ 2
j
(cid:12) (cid:12)
(cid:12) 4w (cid:12)
(20) (cid:12)λ − 1 (cid:12)≤C j−4
(cid:12)
(cid:12)
j π2(cid:0) 2j−1(cid:1)2(cid:12)
(cid:12)
1
and
√
(21) sup (cid:12) (cid:12)F
µ
(t)− 2sin(π(2j−1)t/2)(cid:12) (cid:12)≤C 2j−1.
j
t∈[0,1]
forC andC twoconstantsnotdependingonj.
1 2
LetusdiscussAssumption(19).Observethattheterm
(cid:16) 3−2e−(β−α)/2−e−(β−α)(cid:17)
2+
β−α
belongstotheinterval[2,4]whateverthevalues0<α<β<∞maybe.Therefore,setting
α
r=
β
assumption(19)mainlydependsontheterm
α(2β−α) r(2−r)
=β× .
β−α 1−r
r(2−r)
Since the function r (cid:55)−→ is increasing on (0,1) from 0 to +∞, Assumption (19)
1−r
is satisfied if both r and β take small values. Observe that r measures the strength of the
dependence(thelargerr,thelargerthenumberofoccurrences,see(16))andβ itsrange(the
largerβ theclosertothepresentpastoccurrencesare).
Surprisingly, we observe that the eigenvalues have an asymptotic behavior similar to the
homogeneous Poisson case, except that it involves the constant w instead of w . Since the
1 0
upperbound(20)ispolynomialinj,approximationsaresharp.Ofcourse,w =w ifα=0
1 0
and w is close to w when β takes large values with fixed α. This is expected since both
1 0
cases correspond to situations where the past has small influence on new occurrences. The
PoissonanalogyforeigenfunctionsF isvalidaswell(see(13)).Theseresultsareconfirmed
µ
j
bythenumericalstudyofSection6.PCAFORPOINTPROCESSES 13
5. Estimation of eigenelements. In practice, dimension reduction of point processes
isperformedbyestimatingtheprincipalmeasures µ ,theassociatedeigenvalues λ andthe
j j
scores ξ (see (6)). The estimation of the principal measures µ is based on the estimation
i,j j
of the associated cumulative mass functions F and hence necessitates the estimation of
µ
j
eigenfunctions and eigenvalues of the covariance operator Γ . To proceed, we first define
∆
an empirical version of the covariance operator Γ using the empirical counterparts of the
∆
covariancemeasureC andkernelK .Let
∆ ∆
n
1 (cid:88)
W(cid:99)= Π
i
and ∆(cid:98)i=Π i−W(cid:99).
n
i=1
Thenwedefine
n
1 (cid:88) (cid:88)
C(cid:98) ∆(cid:98)(B×B′)=
n
1 {(T,T′)∈B×B′}−W(cid:99)(B)×W(cid:99)(B′), B,B′∈B,
i=1T,T′∈N
i
whichprovidesthedefinitionoftheempiricalcovariancekernel:
K(cid:98) (s,t)=C(cid:98) ([0,s]×[0,t]), s,t∈[0,1]
∆(cid:98) ∆(cid:98)
alongwiththeempiricalintegraloperator:
(cid:90) 1
Γ(cid:98) (f)(·)= K(cid:98) (·,t)f(t)dt,
∆(cid:98) ∆(cid:98)
0
thatcanbeexpressedusingthecumulativemassfunctionsoftheempiricalmeasures,namely
F ∆(cid:98)i(t)=∆(cid:98)i([0,t]),whichleadsto
n
1 (cid:88)
Γ(cid:98) = F ⊗F .
∆(cid:98) n ∆(cid:98)i ∆(cid:98)i
i=1
Then,Im(Γ(cid:98) )∈span{F ,...,F },whichimpliesthatΓ(cid:98) isafinite-rankoperator.Since
∆(cid:98) ∆(cid:98)1 ∆(cid:98)n ∆(cid:98)
it is also self-adjoint, the covariance operator is compact and the diagonalization theorem
ensures the existence of a basis (η (cid:98)j)
j≥1
of eigenfunctions of Γ(cid:98) ∆(cid:98). We denote by (λ(cid:98)j)
j≥1
the
associatedeigenvaluesequence,sortedinnon-increasingorder,sothat:
(cid:88)
Γ(cid:98)
∆(cid:98)
= λ(cid:98)jη
(cid:98)j
⊗η (cid:98)j.
j≥1
In particular, the eigenelements (λ j,η j)
j≥1
are estimated by (λ(cid:98)j,η (cid:98)j) j≥1. Finally, for any
processN withi∈{1,...,n}andanyj≥1,weestimatethescoresξ definedinSection3
i i,j
by
⟨η ,F ⟩
ξ(cid:98)i,j = (cid:98) (cid:113)j ∆(cid:98)i ifλ(cid:98)j >0.
λ(cid:98)j
The case λ(cid:98)j =0 is not considered since it corresponds to eigenfunctions η
(cid:98)j
that are in the
kernelofΓ(cid:98) ;thisisnotencounteredinpractice.
∆(cid:98)
SincetheoperatorΓ(cid:98) isafinite-rankoperator,itispossibletobuildamatrix,denotedby
∆(cid:98)
G(cid:98) , such that the eigenelements of Γ(cid:98) can be derived explicitly from the eigenelements of
∆(cid:98) ∆(cid:98)
G(cid:98) .ToconstructG(cid:98) ,weconsideralloccurrencessortedinnon-decreasingorder:
∆(cid:98) ∆(cid:98)
n
(cid:91) (cid:91) (cid:110) (cid:111)
T = N {0;1}= T ,...,T ,
i 0 |T|
i=114
sothat T =0 and T =1. Ifsometiesoccurwhenwetaketheunionoftheprocesses N ,
0 |T| i
weidentifytheminonlyoneT sothatforanyℓ̸=ℓ′,wehaveT ̸=T .Then,wedefinethe
ℓ ℓ ℓ′
histogramsystem(e ,...,e )associatedtothisgrid
1 |T|
1
e (t)= 1 (t), ℓ=1,...,|T|,
ℓ (cid:112) [T ;T )
T −T ℓ−1 ℓ
ℓ ℓ−1
andweset
(cid:16) (cid:17)
G(cid:98)
∆(cid:98)
= ⟨Γ(cid:98) ∆(cid:98)e ℓ,e ℓ′⟩ 1≤ℓ,ℓ′≤|T|.
Since Γ(cid:98) is self-adjoint operator, G(cid:98) is a self-adjoint matrix. In the following Lemma, we
∆(cid:98) ∆(cid:98)
showthat G(cid:98) canbeeasilycomputed.Furthermore,weshowthateigenelementsofΓ(cid:98) can
∆(cid:98) ∆(cid:98)
bededucedfromeigenelementsofG(cid:98) .
∆(cid:98)
LEMMA 5.1.
1. TheelementsofG(cid:98) areinaclosedform:forany1≤ℓ,ℓ′≤|T|,
∆(cid:98)
(cid:112) n
(cid:16) (cid:17) (T ℓ−T ℓ−1)(T
ℓ′
−T ℓ′−1) (cid:88)(cid:16) (cid:17)
G(cid:98)
∆(cid:98) ℓ,ℓ′
=
n
× F
Π
i(T ℓ′−1)F
Π
i(T ℓ−1)−F W(cid:99)(T ℓ′−1)F W(cid:99)(T ℓ−1) .
i=1
Inparticular,ifforall ℓ,thereexistsaunique i suchthat T ∈N ,wehave F (T )=
ℓ i W(cid:99) ℓ−1
(ℓ−1)/nand
(cid:16) (cid:17)
(cid:112)
(T ℓ−T ℓ−1)(T
ℓ′
−T ℓ′−1)
(cid:88)n (cid:18) ℓ−1ℓ′−1(cid:19)
G(cid:98)
∆(cid:98) ℓ,ℓ′
=
n
× F
Π
i(T ℓ′−1)F
Π
i(T ℓ−1)−
n n
.
i=1
2. Let Sp(Γ(cid:98) ) (resp. Sp(G(cid:98) )) be the set of eigenvalues of the operator Γ(cid:98) (resp. of G(cid:98) ).
∆(cid:98) ∆(cid:98) ∆(cid:98) ∆(cid:98)
Wehave:
Sp(Γ(cid:98) )\{0}⊂Sp(G(cid:98) )⊂Sp(Γ(cid:98) ).
∆(cid:98) ∆(cid:98) ∆(cid:98)
3. Letv
(cid:98)j
=(v (cid:98)j1,...,v (cid:98)j|T| )t aunit-normeigenvectorofG(cid:98)
∆(cid:98)
associatedwiththeeigenvalueλ(cid:98)j
andlet
|T|
(cid:88)
η = vℓe .
(cid:98)j (cid:98)j ℓ
ℓ=1
Then η
(cid:98)j
is a unit-norm eigenfunction of the operator Γ(cid:98)
∆(cid:98)
associated with the eigenvalue
λ(cid:98)j andthereexistsauniquemeasureµ
(cid:98)j
suchthatF
µ
=η (cid:98)j.
(cid:98)j
REMARK 5.2. If0∈Sp(G(cid:98) ),thenthepreviousresultshowsthatSp(G(cid:98) )=Sp(Γ(cid:98) ).
∆(cid:98) ∆(cid:98) ∆(cid:98)
REMARK5.3. Ofcourse,thedefinitionofη
(cid:98)j
isarbitrarysinceseveraleigenvectorsmay
beassociatedtotheeigenvalueλ(cid:98)j.Inparticular,wecouldconsider−η (cid:98)j.Actually,inpractice,
thedimensionoftheestimatedeigenspacesassociatedtoeach λ(cid:98)j isequalto1.Inthiscase,
thedefinitionofη isuniqueuptoitssign.
(cid:98)j
REMARK 5.4. Theestimatedscorescanbewritten
ξ(cid:98)i,j = ⟨η (cid:98) (cid:113)j,F λ(cid:98)∆ j(cid:98)i⟩ =λ(cid:98)−
j
1/2(cid:88) ℓ| =T 1|
(cid:112)
T
ℓ−v (cid:98) 1jℓ
−T
ℓ
(cid:90) TT ℓ−ℓ 1F ∆(cid:98)i(t)dt=λ(cid:98) j−1/2(cid:88) ℓ| =T 1| v (cid:98)jℓ(cid:112) T ℓ−T ℓ−1F ∆(cid:98)i(T ℓ−1),
wherethelastequalitycomesfromEquation(49).PCAFORPOINTPROCESSES 15
The following theorem shows that the estimates introduced previously achieve the para-
metricrateforestimatingeigenelementsλ ,η andµ .
j j j
THEOREM 5.5. Weassumethat
(22) E[∥F ∥4]<+∞.
∆
Wehave:
(cid:104) (cid:105) E[∥F ∥4]
(23) E sup|λ(cid:98)j −λ j|2 ≤4 ∆ .
n
j≥1
IfwefurtherassumethattheeigenvaluesofΓ aresimple,then,byintroducingtheeigengaps
∆
δ =λ −λ
1 1 2
and
δ =min{λ −λ ;λ −λ }, j≥2,
j j j+1 j−1 j
withη =sign(⟨η ,η ⟩)η ,wehave
(cid:101)j (cid:98)j j j
E[∥F ∥4]
(24) E[∥η −η ∥2]≤32δ−2 ∆
(cid:98)j (cid:101)j j n
and
(25) E(cid:2) ∥µ −µ ∥2 (cid:3)
≤32δ−2E[∥F ∆∥4]
,
(cid:98)j (cid:101)j H−1 j n
withµ =sign(⟨η ,η ⟩)µ .
(cid:101)j (cid:98)j j j
ThemomentAssumption(22)isverymild.Furthermore,Theorem4.4showsthatforPois-
sonprocesses,theeigenvaluesofΓ aresimple.ForHawkesprocessesstudiedinSection4.2,
∆
this condition holds under Assumption (19) (see Theorem 4.10). Even if our framework is
nonparametric in nature, observe that regularization is not necessary to achieve parametric
rates.
6. Numericalstudy. Wenowcomplementourtheoreticalcontributionswithsomeem-
pirical results. We probe, in particular, the following questions: how does the truncated ap-
proximation behave? In particular, to what extent are the properties of eigenfunctions pre-
servedinanon-asymptoticsetting?ForHawkesprocesses,somerestrictionsduetoAssump-
tion(19)appear.Aretheselimitationspurelytheoreticalones?Wediscussthesepointsinthe
sequel.
We first simulate n = 100 Poisson processes using the hawkesbow package [14].
We consider different intensity functions: constant, w(t) = 100, linear, w(t) = t, w(t) =
exp(−0.005t), sinusoidal, w(t) = (1+sin(0.11t)). Then we compute the average eigen-
functionsandeigenvaluesover50replicates(Figures1and2respectively).Foreigenvalues,
the empirical asymptotic regime in j conforms to the theoretical regime in (jπ)−2 (with a
slight modification (jπ −π/2)−2 that better fits for small j’s, which matches the remarks
followingTheorem4.4).Theformoftheintensitydoesnotimpactmuchtheconvergenceof
eigenvalue estimates, even for large scales (j small). As expected, eigenfunctions show in-
creasing oscillations with j. However, the form of the intensity induces different oscillatory
patterns in eigenfunctions but the number of zero crossings is preserved with j zeros on the
interval[0,1)forallfunctions.
Then, to investigate the impact of dependencies in the data, we simulated n = 1,000
Hawkesprocesseson[0,100],withw =100,andself-excitingfunctionh(t)=αe−βt.Data
016
j=1 j=3 j=5 j=7 j=9
2
1
0
−1
2
1
0
−1
2
1
0
−1
2
1
0
−1
0.00 0.25 0.50 0.75 1.000.00 0.25 0.50 0.75 1.000.00 0.25 0.50 0.75 1.000.00 0.25 0.50 0.75 1.000.00 0.25 0.50 0.75 1.00
FIG1.AverageeigenfunctionsforPoissonprocesseswithdifferentintensityfunctionsover50replicates
constant exp linear sin
4
2
0
−2
−2 0 2 4 −2 0 2 4 −2 0 2 4 −2 0 2 4
FIG2. Averageeigenvalues(log-scale)forPoissonProcessesover50replicated.Eachdotcorrespondstoavalue
ofj∈{1,...,10}.Theempiricalaverageisplottedvstheexpectedtheoreticalasymptoticregimeofeigenvalues
in ((cid:82)1(cid:112) w(u)du)2 /(jπ−π/2)2, as expected from Theorem 4.4. Note that Theorem 4.4 provides a (jπ)−2
0
regime. The black line corresponds to the first bisector, so that the points align if the empirical convergence
matchesthetheoreticalregime.
were finally rescaled in [0,1]. To explain briefly the simulation method, the package con-
siders a reproduction function h that is decomposed such as h=mh∗, with m=(cid:82) h(t)dt
and h∗ a true density function such that (cid:82) h∗(t)dt = 1. In our setting, this means that
h∗(t) = βexp(−βt), and that h(t) = r × h∗(t), with r = α/β. Since Theorem 4.10 ex-
hibits the central role of r and β, in our simulation we consider β ∈{0.01,0.1,1,10} and
noitcnuf
negie
constant
exp
linear
sinPCAFORPOINTPROCESSES 17
β 0.01 0.1 1 10
j=1 j=3 j=5 j=7 j=9
2
1
0
−1
2
1
0
−1
2
1
0
−1
0.00 0.25 0.50 0.75 1.000.00 0.25 0.50 0.75 1.000.00 0.25 0.50 0.75 1.000.00 0.25 0.50 0.75 1.000.00 0.25 0.50 0.75 1.00
FIG3.AverageeigenfunctionsforHaw √kesProcesseswithdifferenttransfertfunctionsover50replicates.Dotted
lines:asymptoticeigenfunctionst(cid:55)−→ 2sin(π(2j−1)t/2)(seeTheorem4.10).
r∈{0.1,0.3,0.5,0.7,0.9}.Thissettingallowsustoexploredifferentstrengthsandrangesof
dependency.
Theeigenfunctionsshowaperiodicpatternwithzerocrossingsdependingonj (Figure3).
Interestingly,thenumberofzerocrossingsdonotdependontheparameters(α,β)andagree
with the values predicted by the theory. However, the quality of eigenfunctions estimation
deteriorates for large j’s, and when r or β increase. These results are not surprising in view
of Assumption (19). As for eigenvalues, their asymptotics in j differs from the expected
theoreticalregimeforlargevaluesofrandβ (Figure4).Theempiricalresultsoneigenvalues
illustratethe criticalimportance of r onconvergence, butalso thatof β,which confirmsthe
centralroleofAssumption(19)inourtheoreticalresults.
From this study, we can conclude that many of the theoretical conclusions of Section 4
whicharevalidwhenj islargeseemtoextendforsmallvaluesofj forPoissonandHawkes
processes(forthelatteratleastwhenr andβ arenottoolarge).Notethattheeigenfunctions
for the Poisson and Hawkes processes have a very similar oscillating behavior, and this at
eachscale.
7. Applications.
7.1. PCAonpointprocessesrevealsmultiscalevariabilityinearthquakeoccurrencedata.
WebeginbyillustratingourmethodthroughtheanalysisofdataobtainedfromtheKandilli
Observatory and Earthquakes Research Institute at Bog˘aziçi University2. The dataset com-
prises earthquake occurrences in Turkey and neighboring regions of Greece, recorded be-
tween January 2013 and January 2023, spanning 1181 cities (Fig. 5-A). In recent years, the
Gulf of Gökova in Southwest Turkey has witnessed two significant seismic events: the Bo-
drumearthquakeonJuly20,2017(magnitude6.6,alsofeltontheGreekislandofKos)[38],
2http://www.koeri.boun.edu.tr/sismo/2/earthquake-catalog/
nufnegie
α=0.1β
α=0.5β
α=0.9β18
β 0.01 0.1 1 10
α=0.1β α=0.3β α=0.5β α=0.7β α=0.9β
5
0
−5
−10
−5 0 −5 0 −5 0 −5 0 −5 0
FIG4.Averageeigenvalues(log-scale)forHawkesProcessesover50replicated.Eachdotcorrespondstoavalue
ofj∈{1,...,50}.Theempiricalaverageisplottedvstheexpectedtheoreticalasymptoticregimeofeigenvalues
inw1/(jπ−π/2)2,asexpectedfromTheorem4.10.Theblacklinecorrespondstothefirstbisector,sothatthe
pointsaligniftheempiricalconvergencematchesthetheoreticalregime.
andtheAegeanSeaearthquakeonNovember1,2020,withamomentmagnitudeof7.0(the
highestmagnitudeobservedduringtheperiod).Inthefollowing,weillustratehowourframe-
work can be employed to investigate the fine-scale dynamics of earthquake occurrences in
the region, focusing on the 195 cities that experienced more than two earthquakes over the
specifiedperiod.
AsinclassicalPCA,wefirstinspectthepercentageofvariancecarriedbyeachaxis(Fig.
(cid:80)
5-B), the first axis carrying λ(cid:98)1/ jλ(cid:98)j =89% of the variability. This implies that the first
sourceofvarianceinthedataisassociatedwiththedeviationofcitiesintheaccumulationof
earthquakesovertimecomparedtotheaveragetemporalpatternofearthquakesintheregion
(as shown by η (cid:98)1, Fig. 5-C). Also, scores on Axis 1 ((ξ(cid:98)i1) i) directly correspond to the total
numberofearthquakesineachcityoverthespecifiedperiod(Fig.5-D).WeidentifyAkdeniz
asanoutlierwithanunusuallyhighnumberofearthquakescomparedtotheregionalaverage.
Thiscitywillbeexcludedfromsubsequentanalysesthatinvestitagethefiner-scaledynamics
ofearthquakeactivityinthearea.
In order to interpret the subsequent axes, we recall that our method summarizes the dy-
namics of earthquake occurrences through simple functions, as expressed in Equation (6).
Consequently, we focus on the variations of the estimated eigenfunctions (η ) , and repre-
(cid:98)j j
sent the positions of cities according to their scores (ξ(cid:98)j)
j
on successive axes as in any PCA
analysis(Fig.6).Theserepresentationsallowustoidentifycities(likeGokovaKorfezi,Onika
Adalar)thathavetypicalaccumulationsofearthquakesovertheperiod.
Interestingly, the second axis, η (Fig. 6-C) reveals a distinct change in seismic activity
(cid:98)2
betweenthetwomainearthquakes(2017and2020).Citiesexhibitingpositivescoresonthis
axis(Fig.6-A)indicateaglobalincreaseinearthquakeratesbetweenJuly2017andNovem-
ber2020,followedbyadecreasebelowtheaverageregionalrateafterNovember2020.Con-
versely, cities with negative scores on η (Fig. 6-A) show an accumulation of earthquakes
(cid:98)3
beforeJuly2017.Overall,ourmethodprovidesahighlyaccuratedescriptionofthevariabil-
ity in earthquake occurrences among different cities. It offers a means to represent and po-
sitioncitiesrelativetoeachotherbasedontheirearthquakedynamicsvariability.Moreover,
ourestimationframework,relyingonoccurrencedatawithoutsmoothing,capturessharpand
fine-scalevariationsinthisdynamics,asshownbythedistinctpeaksinη andη (Fig.6-E-
(cid:98)4 (cid:98)5
F).
7.2. PCAonpointprocessestoinvestigatesingle-cellepigenomicvariations. Thefield
ofsingle-cellbiologyhasemergedasasignificantframeworkforgeneratingdetailedmolec-PCAFORPOINTPROCESSES 19
A B160
120
80
40
2014 2016 2018 2020 2022 0 10 20 30 40 50
Date Nb of eigen elements
C D
1.0e−04
7.5
7.5e−05
5.0
5.0e−05
2.5
2.5e−05
0.0
0.0e+00
2014 2016 D2 a01 t8 e 2020 2022 0 N50 umber of O1 c0 c0 urrences 150
FIG5.A:Rasterplotofearthquakesduringtheperiod2013-2023.Eachlinecorrespondstoacityandeachdot
toanearthquakeoccurrence.Breakpointdates(greyverticallines)correspondto2017.07.20and2020.11.01B:
Percentageofvarianceaccordingtothenumberofeigenelements(logscale).C:Firsteigenfunctionη (cid:98)1according
tothedateofearthquakes(left).Breakpointdates(greyverticallines)correspondto2017.07.16and2020.11.01.
D:PlotofPCAscoresforthefirstaxisξ(cid:98)i1accordingtothenumberofoccurrencesW([0,t]).
ular portraits of cell populations, providing valuable insights into the complexity of liv-
ing tissues [60]. While gene expression analysis has traditionally been instrumental in un-
derstanding fundamental biological processes, epigenomic-based gene regulation is receiv-
ing increasing attention, especially when mediated by chromatin modifications measured
bysequencing-basedchromatinimmuno-precipitationassays(chIP-Seq).Briefly,chromatin
comprises the fiber that constitutes chromosomes. ChIP-Seq assays enable the mapping of
chromatin modifications, generating data in the form of 1D-spatial coordinates. However,
thereiscurrentlynodedicatedmethodforanalyzingsingle-cellepigenomicprofilesthatad-
equatelyaccountsforboththespatialnatureofthesignalandthesingle-cellresolution.
A recent study [45] has shown that a particular histone modification (H3K27me3) is in-
volved in the emergence of drug persistence in breast cancer cells. Drug persistence occurs
when only a subset of cells, known as persister cells, survives the initial drug treatment,
therebycreatingareservoirofcellsfromwhichresistantcellswillemerge.Persistercellsex-
hibitdynamicchangesinH3K27me3modificationsatthesingle-celllevel,butthevariability
of this pattern makes it difficult to relate to the emergence of resistance within tumor cells.
h
ytiC
1
)gol(
ecnairav%
x
120
A 6 GGOOKKOOVVAA KKOORRFFEEZZII B KUSADASI KORFEZI
5 SISAM ADASI
3
EGE DENIZI
KKUUSSAADDAASSII KKTTOOUURRRRFFKKSSEEIIIIZZYYSSIIEE AA−−MM GKIIRR K OAIAAMALAA RKYDDRNN UAACEAAA SBSSS EGSSKAOLII AIIENN U LAHR II ARDRRR MKRTE− LEBB −−NKUTOO KAII−RZ−IKLL RAIAKGG H KKKAEE IHASHGSS GIAIASII S RACAAC RR GGIIRRIITT AADDSAAASSRIIO GS UKLOPRINFAERZI− AYVACIK
0
0 GKOAKIMKLRAYCURAAESBASAAOKLHLAURAMRRKRE−TL−KT−UAI−K−RKAIAKRHKKAKIHSHGAIAISGASRACAA R CR
TURGUT−ULA
TTUURRKKIIYYEE−−IIRRAANN SSIINNIIRR BBOOLLGGEESSII
−3 OONNIIKKII AADDAALLAARR −5
SAROS KORFEZI
GIRIT ADASI ACIKLARI
−6 GIRIT ADASI OONNIIKKII AADDAALLAARR
−10 −5 0 5 10 −10 −5 0 5 10
x x
2 4
C D
2014 2016 2018 2020 2022 2014 2016 2018 2020 2022
Date Date
E F
2014 2016 2018 2020 2022 2014 2016 2018 2020 2022
Date Date
FIG 6.A:Estimatedscoresofcities ξ(cid:98)i2 vs. ξ(cid:98)i3.B:Estimatedscoresofcities ξ(cid:98)i4 vs. ξ(cid:98)i5.C-D-E-F:Estimated
eigenfunctionsη (cid:98)j overtimeforj=2,3,4,5.
Previousanalyseshavesuggestedthatapoolofuntreatedcellscouldcontributetothepersis-
tercellpopulationlateruponexposuretochemotherapy.However,thelackofanappropriate
methodologicalframeworktohandlethespatialcharacteristicsofthedatahasmadetheclear
identificationofthispoolofprecursorcellsdifficult.
We propose using our PCA framework to explore the variability of H3K27me3 binding
along the chromosomes 2 and 3 genomes among untreated cancer cells. To proceed, we
performed PCA on n=4722 cells, with each cell described by the 1D spatial positions of
H3K27me3 modifications along chromosomes. Eigenfunctions estimated by this approach
allow us to visualize the basic components of spatial variability in H3K27me3 occurrences
among untreated cancer cells (Fig. 7 A-B). Our PCA framework then provides principal
3x
2
h
4
h
5e−05
0e+00
−5e−05
−1e−04
0.00005
0.00000
−0.00005
−0.00010
−0.00015
5x
3
h
5
h
5e−05
0e+00
−5e−05
−1e−04
2e−04
1e−04
0e+00
−1e−04PCAFORPOINTPROCESSES 21
scores ξ(cid:98)ij, on which we conducted k-means clustering. Using J =50 principal components
and selecting the number of clusters based on a silhouette criterion, we identified clusters
ofcellswithsimilarprofilesofhistonemodificationaccumulationacrossthegenome.Since
k-means clustering assigns label variables to each observed process (Z(cid:98)ik =1 if cell i is in
group k),we representthe estimatedcluster-wiseprobability massfunction(Π(cid:98)k([0,t]),Fig.
7C-D)andintensity(w (t),Fig.7E-F):
k
n n
1 (cid:88) 1 (cid:88) (cid:88)
Π(cid:98)k([0,t])=
n
Z(cid:98)ikΠ i([0,t]), w (cid:98)k(t)=
n
Z(cid:98)ik1 {T=t}.
k k
i=1 i=1T∈N
i
Thisanalysisrevealsthespatialvariabilityofhistonemodificationsamongcancercells,offer-
inganewperspectiveonepigenomicheterogeneitybyrevealingthreesub-populationswithin
untreatedcancercells,characterizedbyzonesalongchromosomesthatconcentratehigheror
lower numbers of occurrences. Further research is needed to fully understand the biological
implicationsofthesevariabilitiesandtheirroleinformingapoolofpersistercells.Nonethe-
less, our PCA for point processes framework marks an important step towards investigating
spatialepigenomicvariationsamongcellpopulations.
7.3. PCAonpointprocessformulti-electrodesspikedata. Neurosciencehaswitnessed
high-paced developments in recent years, thanks to the convergence of experimental and
computational approaches. Signal processing and machine learning, in general, are deeply
connected to the analysis of neuroscience data, often in the form of spike trains that corre-
spondtoneuronalactivities.Thesespiketrainsaretypicallymodeledaspointprocesses,and
technological advancements now allow for the recording of such spikes in populations of
neurons,pavingthewayfortheanalysisframeworkofmultipleneuralspiketraindata[21].
Among many methodological challenges, dimension reduction emerges as a key challenge
for visualizing, exploring, and understanding the structure and variability of population ac-
tivity.Thegoalofdimensionalityreductionistocharacterizehowthefiringratesofdifferent
neurons co-vary, while discarding the spiking variability as noise. We present how PCA on
point processes can be utilized in this context. In particular, the principal measure we infer
can be interpreted as a latent common point process from which individual action poten-
tialsaregeneratedinastochasticmanner.Hence,ourrepresentationwithprincipalmeasures
enables us to define a latent space that represents shared activity patterns prominent in the
populationresponse.
We consider data from an optogenetic therapy experiment performed on non-human pri-
mates retina. The aim of this experiment is to restore light sensitivity in the residual retinal
tissue after photoreceptor generation like macular degeneration. These diseases affect pho-
toreceptor cells, but the retinal ganglion cells (RGC) can still communicate with the brain
via the optic nerve. Then the data consists in the recording the neuronal activity of reti-
nal fragments placed on Multi-Electrods-Array (MEA, n=256 electrods) grid. Theses 256
electrodes form a 16 x 16 grid onto a device that is positionned on the retina of macaques.
The activity of each electrode can be related to a particular retina region, so that the data
aretypicallyspatio-temporal,butweonlyconsideritstemporalcomponents.Differentvisual
stimuliareappliedtoretinalfragmentsandtheactivityofelectrodesisrecorded.
Thanks to our framework, we can easily visualize the variability in the response of each
electrode(Fig8A),aswellasthetemporaldynamicsthatexplainthisvariabilityinspiketrain
occurrences (Fig 8 B). These principal components can be interpreted as latent spike trains
that compose the dynamics of the population. For instance, principal measure 3 (η ) shows
(cid:98)3
achangeindynamicsfollowingthestimulus.Theselatentprocessescouldbeofinterestfor
understanding the neuronal coordination underlying the population response. Additionally,22
A B
2 j = 2 j = 3 j = 4 j = 5
2
1
1
0
0
−1
−1
−2
−2 j = 2 j = 3 j = 4 j = 5
250 300 350 400 450 500 500 550 600 650
Genomic Position (Mb) Genomic Position (Mb)
C D
200
90
150
60
100
30
50
0 0
250 300 350 400 450 500 500 550 600 650
Genomic Position (Mb) Genomic Position (Mb)
E F
2.0
1.5
1.5
1.0
1.0
0.5
0.5
250 300 350 400 450 500 500 550 600 650
Genomic Position (Mb) Genomic Position (Mb)
(cid:113)
FIG7.A-B:Eigenfunctionsweightedbytheirrespectiveeigenvalues λ(cid:98)jη (cid:98)j accordingtothepositionalongthe
genome. Chromosome 2 (left) and Chromosome 3 (right). C-D: Cluster-wise probability mass functions. E-F:
scaledcluster-wiseintensityfunctions.
the score of each electrode can be represented with respect to the position of the electrodes
on the device (Fig 8 C,D) to visualize variations in each principal component across the
device. Identifying regions on the device that show high or low scores could be related to
brain regions whose responses are governed by the corresponding latent spiking process.
Finally, this dynamical system can also be summarized by representing trajectories in the
principalmeasurespace(Fig8E-F).Inthisrepresentation,eachtimepointtcorrespondstoa
singlepointinthelatentfiringratespaceη (t),η (t).Thisrepresentationallowsustofollow
(cid:98)2 (cid:98)3
the temporal dynamics of the observed neuron population. Hence, we expect that PCA on
pointprocessescanbecomeanaturalframeworktodecomposethesecomplexphenomenaof
j
h j
l
FMP
ytisnetnI
j
h j
l
FMP
ytisnetnIPCAFORPOINTPROCESSES 23
A B 10
30 237
74
121
253
2 156 5
63 19547 87
0 1 58 4221 33 111 81 25 02 311 2 41 1 1029 999 5 2 1162 82 1823 1 1 42 428 11 12112 41 213 2 02 35 913 107 541 8177 1 4122 1 8 42 78 741 8 60 2 4342 35 52 711 89 4 5176 30 01 01 2 8714 7 5 42 3232 230 423 8 441 7 21 59 36 115 11 18270 3 3 21 01 3 1131 6 78 1 093 0184 67 004 21714 91 614 3009 1 8530 29 4 14225 571 80 558 561171 12 1931 792 69 45 40 886736 2012 8877 56 480 2 511 1521 454 13 41 7 15 845 808 270 96 211 1 199 1 21 27 2 120 −0
5
j = 2
−2
2125 543 319 130 8956 254 j = 3
25 −10 j = 4
183
100 j = 5
−4 −2 x0
2
2 4 7 8
Time
(9
ms)
10 11
C D
10 10
5 5
0 0
0 5 10 15 0 5 10 15
x−Electrodes x−Electrodes
E F
0.5
0.5
0.0
0.0
−0.5
−0.5
−1.0
−0.5 h 0.0 0.5 −1.0 −0.5 h 0.0 0.5
2 3
FIG 8.A:scoresξ(cid:98)2 vsξ(cid:98)3 forelectrodesn=1,...,256.B:Eigenfunctionsweightedbytheirrespectiveeigen-
1/2
values λ(cid:98) j η (cid:98)j according to time (in ms). The vertical line corresponds to the stimulus at t=8.86ms. C-D:
visualisationofscoresξ(cid:98)2,(C)andξ(cid:98)3 (D)accordingtothepositionofeachelectrodeontheretinaldevice.Red:
highvalue,blue:lowvalue.E-F:representationofthedatainthelatentspace(E,η (cid:99)3 vsη (cid:99)2,andF,η (cid:99)4 vsη (cid:99)3).
Timeisrepresentedbycolors(yellow:beginingoftheassay,purple:endoftheassay).Reddot:stimulustime.
population-based spike train analysis by providing simple decompositions that help unravel
thediversityandvariabilityofneuronalpopulationspikingactivities.
Acknowledgments. TheauthorswouldliketothankEmmanuelTrélatforvaluablesug-
gestionsconcerningsolutionsofSturm-Liouvilletheory,CelineVallotfordiscussionsonthe
single-cell epigenomic data, and Gregory Gauvain, Fabrice Arcizet and Pierre Pouget for
sharingtheneurosciencedata.
3 x
sedortcelE−y
3
h
j h j l
sedortcelE−y
4
h24
Funding. The research was supported by a grant from the Agence Nationale de la
Recherche ANR-18-CE45-0023 SingleStatOmics, by the projects AI4scMed, France 2030
ANR-22-PESN-0002.
8. Proofs.
8.1. ProofsofSection3.
8.1.1. ProofofProposition3.1. Letj≥1.Weobservethat,sinceλ >0,
j
(cid:90) 1
(26) η (t)=λ−1 K (t,s)η (s)ds, t∈[0,1].
j j ∆ j
0
We prove that η is of finite variation on [0,1]. We recall that a function f is a function of
j
finitevariationonaninterval[a,b]ifthequantity
(cid:40) p (cid:41)
(cid:88)
V := sup |f(t )−f(t )|
f ℓ ℓ−1
a≤t <t <...<t ≤b
0 1 p ℓ=1
isfinite.Foranygrid(t ,...,t )of[0,1],wehave:
0 p
p p (cid:12)(cid:90) 1 (cid:12)
(cid:88) |η j(t ℓ)−η j(t ℓ−1)|=λ−
j
1(cid:88)(cid:12) (cid:12)
(cid:12)
(K ∆(s,t ℓ)−K ∆(s,t ℓ−1))η j(s)ds(cid:12) (cid:12)
(cid:12)
0
ℓ=1 ℓ=1
p (cid:12)(cid:90) 1 (cid:12)
=λ−
j
1(cid:88)(cid:12) (cid:12)
(cid:12)
(E[F ∆(s)F ∆(t ℓ)]−E[F ∆(s)F ∆(t ℓ−1)])η j(s)ds(cid:12) (cid:12)
(cid:12)
0
ℓ=1
p (cid:12)(cid:90) 1 (cid:12)
=λ−
j
1(cid:88)(cid:12) (cid:12)
(cid:12)
E[F ∆(s)(F ∆(t ℓ)−F ∆(t ℓ−1))]η j(s)ds(cid:12) (cid:12)
(cid:12)
0
ℓ=1
(cid:90) 1 (cid:34) p (cid:35)
(cid:88)
≤λ−1 E |F (s)| |F (t )−F (t )| |η (s)|ds
j ∆ ∆ ℓ ∆ ℓ−1 j
0
ℓ=1
(cid:90) 1 (cid:34) p (cid:35)
(cid:88)
≤λ−1 E |F (s)| |∆(]t ,t ])| |η (s)|ds
j ∆ ℓ−1 ℓ j
0
ℓ=1
(cid:90) 1 (cid:34) p (cid:35)
(cid:88)
≤λ−1 E |F (s)| (Π(]t ,t ])+W(]t ,t ])) |η (s)|ds
j ∆ ℓ−1 ℓ ℓ−1 ℓ j
0
ℓ=1
(cid:90) 1
≤λ−1 E[|F (s)|(Π([0,1])+W([0,1]))]|η (s)|ds,
j ∆ j
0
whichisindependentofthegrid.Weobservethat
(cid:114)
(cid:104) (cid:105) (cid:104) (cid:105)
E[|F (s)|(Π([0,1])+W([0,1]))]≤ E |F (s)|2 ×E (Π([0,1])+W([0,1]))2
∆ ∆
(cid:114)
(cid:104) (cid:105)
≤2 E |F (s)|2 E[Π2([0,1])]
∆
and
(cid:90) 1
E[|F (s)|(Π([0,1])+W([0,1]))]|η (s)|ds
∆ j
0PCAFORPOINTPROCESSES 25
(cid:32) (cid:33)1/2
≤2∥η ∥
(cid:112)
E[Π2([0,1])]
(cid:90) 1 E(cid:104)
|F
(s)|2(cid:105)
ds
j 2 ∆
0
≤4∥η ∥
E(cid:2) Π2([0,1])(cid:3)
<∞.
j 2
Then,η isafunctionoffinitevariation.SinceK iscontinuous,η isalsocontinuous(and
j ∆ j
thenright-continuous).Wealsohavethatη (0)=0.Then,applyingProposition4.4.3of[18],
j
weobtainthatthereexistsasignedmeasureµ suchthat
j
η (t)=µ ([0,t]), t∈[0,1].
j j
FromFubini’sTheoremwehavethatforanyfunctionφ∈H1
0
(cid:32) (cid:33) (cid:32) (cid:33)
(cid:90) 1 (cid:90) 1 (cid:90) t (cid:90) 1 (cid:90) 1
φ′(t)η (t)dt= φ′(t) dµ (s) dt= φ′(t)dt dµ (s)
j j j
0 0 0 0 s
(cid:90) 1
(27) =− φ(s)dµ (s),
j
0
sinceφ(1)=0.
8.1.2. Proof of Theorem 3.2. By the Karhunen-Loève theorem (see e.g. [35], Theorem
7.3.5)appliedtothestochasticprocessF ,
Π
 2
J
(28) lim sup E F Π(t)−F
W(t)−(cid:88)(cid:112)
λ jξ jη j(t) =0.
J→+∞t∈[0,1]
j=1
Furthermore,similarlyto(27),wehave,forallφ∈H1,
0
⟨φ,Π−W⟩=−⟨F −F ,φ′⟩.
Π W
Then,using(4),
(cid:34) (cid:35) (cid:34) (cid:35)
E (cid:13) (cid:13)Π−W −(cid:88)J √ λ ξ µ (cid:13) (cid:13)2 ≤E sup (cid:16) ⟨φ,Π−W⟩−(cid:88)J (cid:112) λ ξ ⟨φ,µ ⟩(cid:17)2
(cid:13) j j j(cid:13) j j j
H−1 φ∈H1,∥φ′∥≤1
j=1 0 j=1
(cid:34) (cid:35)
J
≤E sup
(cid:68)
F −F
−(cid:88)(cid:112)
λ ξ η
,φ′(cid:69)2
Π W j j j
φ∈H1,∥φ′∥≤1
0 j=1
(cid:34) (cid:35)
J
≤E sup
∥φ′∥2(cid:13)
(cid:13)F −F
−(cid:88)(cid:112)
λ ξ η
(cid:13) (cid:13)2
(cid:13) Π W j j j(cid:13)
φ∈H1,∥φ′∥≤1
0 j=1
(cid:34) (cid:35)
≤E (cid:90) 1(cid:16) F (t)−F (t)−(cid:88)J (cid:112) λ ξ η (t)(cid:17)2 dt
Π W j j j
0
j=1
andtheresultcomesfrom(28).
8.1.3. ProofofTheorem3.4. AdirectconsequenceofMercer’stheoremisthat
(cid:42) (cid:43)
(cid:28) ∂2φ(cid:29) (cid:88) ∂2φ (cid:88) (cid:28) ∂2φ(cid:29) (cid:88)
K , = λ η ⊗η , = λ η ⊗η , = λ ⟨φ,µ ⊗µ ⟩.
∆ j j j j j j j j j
∂t∂s ∂t∂s ∂t∂s
j≥1 j≥1 j≥126
Indeed,Fubini’stheoremandthedefinitionofµ implies
j
(cid:28) ∂2φ(cid:29) (cid:90) ∂2φ
η ⊗η , = η (s)η (t) (s,t)dsdt
j j j j
∂t∂s ∂t∂s
[0,1]2
(cid:90) 1 (cid:18)(cid:90) 1 ∂2φ (cid:19)
= η (s) η (t) (s,t)dt ds
j j
∂t∂s
0 0
(cid:90) 1 (cid:28) ∂2φ (cid:29)
= η (s) η , (s,·) ds
j j
∂t∂s
0
(cid:90) 1 (cid:28) ∂φ (cid:29)
=− η (s) (s,·),µ ds
j j
∂s
0
(cid:90) 1 (cid:90) 1 ∂φ
=− η (s) (s,t)dµ (t)ds
j j
∂s
0 0
=⟨φ,µ ⊗µ ⟩,
j j
usingFubini’stheoremandthedefinitionofµ asecondtime.Hencewecanwrite
j
(cid:28) ∂2K ∆ (cid:29) (cid:88)
,φ = λ ⟨φ,µ ⊗µ ⟩.
j j j
∂t∂s
j≥1
Nowremarkalsothat,
∂2K
∆
C = .
∆
∂t∂s
Indeed,forafunctionφ∈H1,weget
0
(cid:90) 1 (cid:90) 1 (cid:90) 1
(cid:88) (cid:88)
F (t)φ′(t)dt= 1 φ′(t)dt= φ′(t)dt
Π T≤t
0 0 T
T∈N T∈N
(cid:88)
= (φ(1)−φ(T))=−⟨Π,φ⟩.
T∈N
Inparticular
(cid:20)(cid:90) 1 (cid:21)
E F (t)φ′(t)dt =−E[⟨Π,φ⟩]=−⟨W,φ⟩.
Π
0
Thisimplies
(cid:90) ∂2φ (cid:90) ∂2φ
K (s,t) (s,t)dsdt= E[F (s)F (t)] (s,t)dsdt
∆ ∆ ∆
∂t∂s ∂t∂s
[0,1]2 [0,1]2
(cid:34) (cid:35)
(cid:90) ∂2φ
=E F (s)F (t) (s,t)dsdt
Π Π
∂t∂s
[0,1]2
(cid:90) ∂2φ
− F (s)F (t) (s,t)dsdt
W W
∂t∂s
[0,1]2
(cid:20)(cid:90) 1 (cid:18)(cid:90) 1 ∂2φ (cid:19) (cid:21)
=E F (s) F (t) (s,t)dt ds
Π Π
∂t∂s
0 0
(cid:90) 1 (cid:20)(cid:90) 1 ∂2φ (cid:21)
− F (s)E F (t) (s,t)dt ds
W Π
∂t∂s
0 0PCAFORPOINTPROCESSES 27
(cid:34) (cid:35)
(cid:90) 1 (cid:88) ∂φ
=−E F (s) (s,T)ds
Π
∂s
0
T∈N
(cid:90) 1 (cid:90) 1 ∂φ
+ F (s) (s,t)W(t)dtds
W
∂s
0 0
 
(cid:88)
=E  φ(T′,T)−⟨φ,W ⊗W⟩
T,T′∈N
=⟨C ,φ⟩.
∆
Then,forallφ∈H2,fromCauchy-Schwarz’sinequalitywededuce
0
(cid:12) (cid:12) (cid:12) (cid:12) (cid:13) (cid:13)
(cid:12) (cid:12)(cid:42) (cid:88)J (cid:43)(cid:12)
(cid:12)
(cid:12) (cid:12)(cid:42) (cid:88)J ∂2φ(cid:43)(cid:12)
(cid:12)
(cid:13)
(cid:13)
(cid:88)J (cid:13) (cid:13)(cid:13) (cid:13)∂2φ(cid:13)
(cid:13)
(cid:12) λ jµ j ⊗µ j −C ∆,φ (cid:12)=(cid:12) λ jη j ⊗η j −K ∆, (cid:12)≤(cid:13)K ∆− λ jη j ⊗η j(cid:13)(cid:13) (cid:13),
(cid:12) (cid:12) (cid:12) ∂s∂t (cid:12) (cid:13) (cid:13)(cid:13)∂s∂t(cid:13)
(cid:12) j=1 (cid:12) (cid:12) j=1 (cid:12) (cid:13) j=1 (cid:13)
whichimplies
(cid:13) (cid:13) (cid:13) (cid:13)
(cid:13) J (cid:13) (cid:13) J (cid:13)
(cid:13)(cid:88) (cid:13) (cid:13)(cid:88) (cid:13)
(cid:13) λ jµ j ⊗µ j −C ∆(cid:13) ≤(cid:13) λ jη j ⊗η j −K ∆(cid:13),
(cid:13) (cid:13) (cid:13) (cid:13)
(cid:13)j=1 (cid:13) (cid:13)j=1 (cid:13)
H−2
andMercertheoremimpliestheexpectedresult.
8.2. ProofsofSection4.
8.2.1. Proof of Theorem 4.1. First, assume that F is an eigenfunction of the operator
µ
j
Γ associatedtotheeigenvalueλ .Wehave:
∆ j
(cid:90) 1
(29) λ F (t)= K (t,s)F (s)ds, t∈[0,1].
j µ ∆ µ
j j
0
Wehaveforany(t,t′)∈[0,1]2,sinceλ >0,
j
(cid:32) (cid:33)1/2
(cid:90) 1
|F (t)−F (t′)|≤∥F ∥ ×λ−1 (cid:0) K (t,s)−K (t′,s)(cid:1)2 ds .
µ j µ j µ j 2 j ∆ ∆
0
AndsinceK iscontinuous,|F (t)−F (t′)|goesto0whent′→t.SoF iscontinuous.
∆ µ µ µ
j j j
Equation(29)gives
(cid:90) 1(cid:16)(cid:90) min{s;t} (cid:17)
λ F (t)= w(u)du F (s)ds
j µ µ
j j
0 0
(cid:90) t (cid:16)(cid:90) s (cid:17) (cid:90) 1 (cid:16)(cid:90) t (cid:17)
(30) = F (s) w(u)du ds+ F (s) w(u)du ds.
µ µ
j j
0 0 t 0
Now,consider
(cid:90) 1
H (t)= F (s)ds, t∈[0,1].
j µ
j
t
SinceF iscontinuous,H isadifferentiablefunctionand
µ j
j
H′(t)=−F (t).
j µ j28
Actually, previous computations show that F is an infinitely-differentiable function and
µ
j
differentiatingEquation(30)gives
(cid:90) 1
(31) λ F′ (t)=w(t) F (u)du
j µ j µ j
t
andthenH issolutionofasecond-orderdifferentialequation,
j
(32) −λ H′′(t)=H (t)w(t),
j j j
withboundaryconditions:
H (1)=0, H′(0)=−F (0)=0.
j j µ j
Therefore,(λ ,H )issolutionofthesystem(12).
j j
Conversely,assumethat(λ ,H )isasolutionof(12).Then,setting
j j
F (s)=−H′(s), s∈[0,1],
µ j j
weobtain,byusingintegrationbypart,foranyt∈[0,1],
(cid:90) 1 (cid:90) t (cid:16)(cid:90) s (cid:17) (cid:90) 1 (cid:16)(cid:90) t (cid:17)
K (t,s)F (s)ds= F (s) w(u)du ds+ F (s) w(u)du ds
∆ µ µ µ
j j j
0 0 0 t 0
(cid:90) t (cid:16)(cid:90) s (cid:17) (cid:16)(cid:90) t (cid:17)(cid:90) 1
=− H′(s) w(u)du ds− w(u)du H′(s)ds
j j
0 0 0 t
(cid:90) t (cid:90) t (cid:16)(cid:90) t (cid:17)(cid:16) (cid:17)
=−H (t) w(u)du+ H (s)w(s)ds− w(u)du H (1)−H (t)
j j j j
0 0 0
(cid:90) t
= H (s)w(s)ds,
j
0
sinceH (1)=0.Then,sinceH′(0)=0,foranyt∈[0,1],
j j
(cid:90) 1 (cid:90) t
K (t,s)F (s)ds=−λ H′′(s)ds
∆ µ j j j
0 0
=−λ H′(t)=λ F (t).
j j j µ j
Then,(λ ,F )areeigenelementsoftheoperatorofkernelK .
j µ ∆
j
8.2.2. ProofsofTheorem4.8andoftheresultofRemark4.9. Inthesequel,weset
β3w w αβ(2β−α)
0 0
θ=β−α, C = , C =− .
1 (β−α)3 2 2(β−α)4
Weobserve
(cid:16)w αβ(2β−α) β3w (cid:17)
(α−β)−2(2C (α−β)−C )=(α−β)−2 0 − 0
2 1 (β−α)3 (β−α)3
=w
β(β−α)−5(cid:0) α(2β−α)−β2(cid:1)
0
w β
=− 0 =−C β−2
(β−α)3 1
and
(33) 2C θ+C =C β−2θ2.
2 1 1PCAFORPOINTPROCESSES 29
UsingEquation(17),wehave,bysymmetryofthebivariatekernel
(cid:16) (cid:17)
K (s,t)=C min{s;t}−C −1−e−θ|t−s|+e−θt+e−θs , s,t∈[0,1].
∆ 1 2
Furthermore, using definitions of C and C , (λ ,H ) is solution of (18) if and only if we
1 2 j j
have:
 (cid:90) 1
−λ H′′(s)=C β−2θ2H (s)−C θ2 e−θ|t−s|H (t)dt,s∈(0,1),
j j 1 j 2 j
0
H (1)=0, H′(0)=0
j j
Then,letusexpressΓ F .Foranys∈[0,1],
∆ µ
j
(cid:90) 1
Γ F (s)= K (s,t)F (t)dt
∆ µ ∆ µ
j j
0
(cid:90) 1(cid:16) (cid:16) (cid:17)(cid:17)
= C min{s,t}−C −1−e−θ|t−s|+e−θt+e−θs F (t)dt
1 2 µ
j
0
(cid:90) s (cid:90) 1 (cid:90) 1
=C tF (t)dt+C s F (t)dt+C (1−e−θs) F (t)dt
1 µ 1 µ 2 µ
j j j
0 s 0
(cid:90) 1 (cid:90) 1 (cid:90) s
−C e−θtF (t)dt+C eθs e−θtF (t)dt+C e−θs eθtF (t)dt.
2 µ 2 µ 2 µ
j j j
0 s 0
Wehave
(cid:90) 1
H (s)= F (t)dt, s∈[0,1].
j µ
j
s
SinceK iscontinuous,theeigenfunctionsarecontinuousaswell(eigenvaluesarepositive).
∆
SinceF iscontinuous,wehave
µ
j
F (s)=−H′(s), s∈[0,1]
µ j j
withboundaryconditions
H (1)=0, H′(0)=0.
j j
Then,wecanwrite
Γ F (s)=(I)+(II)−(III)+(IV)+(V)
∆ µ
j
with
(cid:90) s (cid:90) 1
(I)=C tF (t)dt+C s F (t)dt
1 µ 1 µ
j j
0 s
(cid:90) s
=C t(−H′(t))dt+C sH (s)
1 j 1 j
0
(cid:90) s
=C H (t)dt,
1 j
0
(cid:90) 1
(II)=C (1−e−θs) F (t)dt
2 µ
j
0
=C (1−e−θs)H (0),
2 j30
(cid:90) 1
(III)=C e−θtF (t)dt
2 µ
j
0
(cid:90) 1
=C e−θt(−H′(t))dt
2 j
0
(cid:90) 1
=C H (0)−C θ e−θtH (t)dt
2 j 2 j
0
and
(cid:90) 1
−(III)=−C H (0)+C θ e−θtH (t)dt.
2 j 2 j
0
Now,
(cid:90) 1
(IV)=C eθs e−θtF (t)dt
2 µ
j
s
(cid:90) 1
=C eθs e−θt(−H′(t))dt
2 j
s
(cid:16) (cid:90) 1 (cid:17)
=C eθs e−θsH (s)−θ e−θtH (t)dt
2 j j
s
(cid:90) 1
=C H (s)−C θeθs e−θtH (t)dt
2 j 2 j
s
and,finally,
(cid:90) s
(V)=C e−θs eθtF (t)dt
2 µ
j
0
(cid:90) s
=C e−θs eθt(−H′(t))dt
2 j
0
(cid:90) s
=C e−θs(cid:0) H (0)−eθsH (s)(cid:1) +C θe−θs eθtH (t)dt
2 j j 2 j
0
(cid:90) s
=C e−θsH (0)−C H (s)+C θe−θs eθtH (t)dt.
2 j 2 j 2 j
0
Therefore
Γ F (s)=(I)+(II)−(III)+(IV)+(V)
∆ µ
j
(cid:90) s
=C H (t)dt+C (1−e−θs)H (0)
1 j 2 j
0
(cid:90) 1 (cid:90) 1
−C H (0)+C θ e−θtH (t)dt+C H (s)−C θeθs e−θtH (t)dt
2 j 2 j 2 j 2 j
0 s
(cid:90) s
+C e−θsH (0)−C H (s)+C θe−θs eθtH (t)dt
2 j 2 j 2 j
0
(cid:90) s (cid:90) 1 (cid:90) 1
=C H (t)dt+C θ e−θtH (t)dt−C θeθs e−θtH (t)dt
1 j 2 j 2 j
0 0 s
(cid:90) s
+C θe−θs eθtH (t)dt.
2 j
0PCAFORPOINTPROCESSES 31
Setting
(cid:90) s (cid:90) 1
U(s)=e−θs eθtH (t)dt−eθs e−θtH (t)dt, s∈[0,1],
j j
0 s
wefinallyobtainthatforanys∈[0,1],
(cid:90) s (cid:90) 1
(34) Γ F (s)=C H (t)dt+C θ e−θtH (t)dt+C θU(s).
∆ µ 1 j 2 j 2
j
0 0
Wethenobtainthat
(35) Γ F (s)=λ F (s), s∈[0,1]
∆ µ j µ
j j
ifandonlyif
(cid:90) s (cid:90) 1
λ F (s)=C H (t)dt+C θ e−θtH (t)dt+C θU(s), s∈[0,1].
j µ 1 j 2 j 2
j
0 0
Inthesequel,weusethefollowinglemma.
LEMMA 8.1. Setting
(cid:90) 1
(36) Z(s)= e−θ|t−s|H (t)dt,
j
0
wehaveforanys∈[0,1],
(cid:90) s (cid:90) s
U(s)=U(0)+2 H (t)dt−θ Z(t)dt.
j
0 0
PROOF OF THE LEMMA. Wehaveforanys∈[0,1],
(cid:90) s (cid:90) 1
U′(s)=−θe−θs eθtH (t)dt+H (s)−θeθs e−θtH (t)dt+H (s)
j j j j
0 s
=2H (s)−θZ(s).
j
Thisprovidestheresultofthelemma.
Now,weassumethat(35)istrue.Wehave
λ F′ (s)=C H (s)+C θU′(s)
j µ 1 j 2
j
(cid:16) (cid:17)
=C H (s)+C θ 2H (s)−θZ(s)
1 j 2 j
C θ2
= 1 H (s)−C θ2Z(s),
β2 j 2
byusing(33)andthelemma.Thisgives
C θ2
(37) −λ H′′(s)= 1 H (s)−C θ2Z(s), s∈[0,1],
j j β2 j 2
meaningthat(λ ,H )issolutionof(18).
j j
Conversely,assumethat(λ ,H )issolutionof(18).Weprovethat(35)issatisfied.Indeed,
j j
using(34),theresultofthelemmaand
(cid:90) 1
U(0)=− e−θtH (t)dt,
j
032
wehaveforanys∈[0,1],
(cid:90) s (cid:90) 1
Γ F (s)=C H (t)dt+C θ e−θtH (t)dt+C θU(s)
∆ µ 1 j 2 j 2
j
0 0
(cid:90) s (cid:90) 1 (cid:16) (cid:90) s (cid:90) s (cid:17)
=C H (t)dt+C θ e−θtH (t)dt+C θ U(0)+2 H (t)dt−θ Z(t)dt
1 j 2 j 2 j
0 0 0 0
C θ2 (cid:90) s (cid:90) s
= 1 H (t)dt−C θ2 Z(t)dt.
β2 j 2
0 0
byusing(33).Since(λ ,H )issolutionof(18),wefinallyobtainforanys∈[0,1],
j j
(cid:90) s
Γ F (s)=−λ H′′(t)dt
∆ µ j j j
0
=λ
(cid:0) H′(0)−H′(s)(cid:1)
j j j
=λ F (s)
j µ
j
andtheresultisproved.
Now,weprovetheresultofRemark4.9.UsingEquation(37),weobtain
C θ2
−λ H(4) (s)= 1 H′′(s)−C θ2Z′′(s), s∈[0,1].
j j β2 j 2
BydefinitionofZ givenin(36),wehaveforanys∈[0,1],
(cid:90) s (cid:90) 1
Z′(s)=−θe−θs eθuH (u)du+θeθs e−θuH (u)du
j j
0 s
and
(cid:90) s (cid:90) 1
Z′′(s)=θ2e−θs eθuH (u)du+θ2eθs e−θuH (u)du−2θH (s)
j j j
0 s
=θ2Z(s)−2θH (s).
j
Now,weobtain,stillusingEquations(37)and(33),
C θ2
−λ H(4) (s)= 1 H′′(s)−C θ4Z(s)+2C θ3H (s)
j j β2 j 2 2 j
C θ2 (cid:16) C θ4(cid:17)
= 1 H′′(s)−λ θ2H′′(s)+ 2C θ3− 1 H (s)
β2 j j j 2 β2 j
C θ2
= 1 H′′(s)−λ θ2H′′(s)−C θ2H (s).
β2 j j j 1 j
Finally,weobtainforanys∈[0,1],
C θ2(cid:16) (cid:17)
(38) −λ H(4) (s)+λ θ2H′′(s)= 1 H′′(s)−β2H (s) .
j j j j β2 j j
Inparticular,ifλ =0,then
j
H (s)=c eβs+c e−βs, s∈[0,1],
j 1 2
forc andc twoconstants.TheboundaryconditionH′(0)=0givesc =c andH (1)=0
1 2 j 1 2 j
givesc =c =0.Thenλ =0entailsH =0andthenF =0.WehaveassumedthatF
1 2 j j µ µ
j j
iscontinuous,whichallowstousepreviouscomputations.PCAFORPOINTPROCESSES 33
8.2.3. ProofofTheorem4.10. Weset
βw w αβ(2β−α)
0 0
w = , c= , θ=β−α
1 β−α 2(β−α)2
and
c (cid:90) 1
I(y)(t)= e−θ|t−s|y(s)ds, t∈[0,1].
w
1 0
Inthesequel,weassumethat(19)issatisfied,whichisequivalentto
2c(cid:16) 3−2e−θ/2−e−θ(cid:17)
(39) 2+ <1.
w θ
1
Now(18)writes
(cid:26) −λy′′(t)=w y(t)+w I(y(t)),t∈(0,1),
1 1
y(1)=0, y′(0)=0.
LetH asolutionofthisODEasexpressedinTheorem4.8.Wehave
j
(cid:26) H′′(t)+ρ2H (t)=−ρ2I(H )(t),t∈(0,1),
j j j j j
H (1)=0, H′(0)=0
j j
with
(cid:114)w
1 j→+∞
(40) ρ := −→ +∞.
j
λ
j
WewriteH andH′ as
j j
(cid:26)
H (t)= a(t)cos(ρ t)+b(t)sin(ρ t),
j j j
H′(t)=−ρ a(t)sin(ρ t)+ρ b(t)cos(ρ t),
j j j j j
withaandbC2-functionsthatmustsatisfy
(cid:26) a′(t)cos(ρ t)+b′(t)sin(ρ t)=0
j j
−a′(t)ρ sin(ρ t)+b′(t)ρ cos(ρ t)=−ρ2I(H )(t).
j j j j j j
Thismeansthat
(cid:18)
cos(ρ t) sin(ρ
t)(cid:19)(cid:18) a′(t)(cid:19) (cid:18)
0
(cid:19)
j j = ,
−sin(ρ t)cos(ρ t) b′(t) −ρ I(H )(t)
j j j j
orequivalently
(cid:18) a′(t)(cid:19) (cid:18)
cos(ρ t)−sin(ρ
t)(cid:19)(cid:18)
0
(cid:19)
= j j .
b′(t) sin(ρ t) cos(ρ t) −ρ I(H )(t)
j j j j
Therefore
(cid:26) (cid:82)t
a(t)=a+ρ sin(ρ s)I(H )(s)ds
j 0 j j
(cid:82)t
b(t)=b−ρ cos(ρ s)I(H )(s)ds,
j 0 j j
withaandbtwoconstants.Finally,foranyt∈[0,1],
(cid:90) t (cid:90) t
H (t)=acos(ρ t)+bsin(ρ t)+ρ cos(ρ t) sin(ρ s)I(H )(s)ds−ρ sin(ρ t) cos(ρ s)I(H )(s)ds,
j j j j j j j j j j j
0 0
and
(cid:90) t (cid:90) t
H′(t)=−aρ sin(ρ t)+bρ cos(ρ t)−ρ2sin(ρ t) sin(ρ s)I(H )(s)ds−ρ2cos(ρ t) cos(ρ s)I(H )(s)ds,
j j j j j j j j j j j j j
0 034
withaandbtwoconstants.TheboundaryconditionsH′(0)=0impliesthatb=0.Wethen
j
obtainthatH mustwrite
j
(41)
(cid:90) t (cid:90) t
H (t)=acos(ρ t)+ρ cos(ρ t) sin(ρ s)I(H )(s)ds−ρ sin(ρ t) cos(ρ s)I(H )(s)ds,
j j j j j j j j j j
0 0
and
(cid:90) t (cid:90) t
H′(t)=−aρ sin(ρ t)−ρ2sin(ρ t) sin(ρ s)I(H )(s)ds−ρ2cos(ρ t) cos(ρ s)I(H )(s)ds.
j j j j j j j j j j j
0 0
Inparticular,wehave
(cid:90) t
H (t)=acos(ρ t)−ρ sin(ρ (t−s))I(H )(s)ds
j j j j j
0
(cid:90) ρ jt (cid:0) (cid:1)(cid:16) u (cid:17)
=acos(ρ t)− sin(u)I H t− du.
j j
ρ
0 j
We denote J : L [0,1] (cid:55)→ L [0,1] the linear operator defined for f ∈ L [0,1], for t ∈
j ∞ ∞ ∞
[0,1],by
(cid:90) t (cid:90) t
J (f)(t):=ρ cos(ρ t) sin(ρ s)I(f)(s)ds−ρ sin(ρ t) cos(ρ s)I(f)(s)ds
j j j j j j j
0 0
(cid:90) t
=−ρ sin(ρ (t−s))I(f)(s)ds
j j
0
(cid:90) ρ jt (cid:0) (cid:1)(cid:16) u (cid:17)
=− sin(u)I f t− du.
ρ
0 j
Finally,ifH satisfiesEquation(18),H satisfies
j j
(42) H (t)=acos(ρ t)+J (H )(t), t∈[0,1].
j j j j
Conversely,ifH satisfiesEquation(42),fort∈[0,1],
j
H′′(t)=−aρ2cos(ρ t)+J′′(H )(t)
j j j j j
(cid:90) t
=−aρ2cos(ρ t)−ρ3cos(ρ t) sin(ρ s)I(H )(s)ds−ρ2sin2(ρ t)I(H )(t)
j j j j j j j j j
0
(cid:90) t
+ρ3sin(ρ t) cos(ρ s)I(H )(s)ds−ρ2cos2(ρ t)I(H )(t)
j j j j j j j
0
=−aρ2cos(ρ t)−ρ2J (H )(t)−ρ2I(H )(t)
j j j j j j j
=−ρ2H (t)−ρ2I(H )(t).
j j j j
ItmeansthatifH satisfiesEquation(42),thenitsatisfies(18).Wehaveproved:
j
(43) H satisfiesEquation(18) ⇐⇒ H satisfiesEquation(42).
j j
Now,letusdealwithF (t)=−H′(t),fort∈[0,1].Wehave:
µ j j
F (t)=−H′(t)
µ j j
(cid:90) t (cid:90) t
=aρ sin(ρ t)+ρ2sin(ρ t) sin(ρ s)I(H )(s)ds+ρ2cos(ρ t) cos(ρ s)I(H )(s)ds
j j j j j j j j j j
0 0PCAFORPOINTPROCESSES 35
(cid:90) t
=aρ sin(ρ t)+ρ2 cos(ρ (t−s))I(H )(s)ds
j j j j j
0
(cid:90) ρ jt (cid:0) (cid:1)(cid:16) u (cid:17)
=aρ sin(ρ t)+ρ cos(u)I H t− du
j j j j
ρ
0 j
=aρ jsin(ρ jt)+
cρ
j
(cid:90) ρ jt cos(u)(cid:16)(cid:90) 1
e−θ|t−ρ− j1u−s|
H
j(s)ds(cid:17)
du.
w
1 0 0
Itgives
(44) F (t)=aρ sin(ρ t)+ρ K (H )(t), t∈[0,1],
µ j j j j j
j
withforanyboundedfunctionf,
K j(f)(t)=
c (cid:90) ρ jt cos(u)(cid:16)(cid:90) 1
e−θ|t−ρ− j1u−s|
f(s)ds(cid:17)
du.
w
1 0 0
LEMMA 8.2. Weset
|||J ||| := sup ∥J (f)∥ .
j ∞ j ∞
f:∥f∥ =1
∞
If (39)issatisfied,wehave
1
|||J ||| < .
j ∞
2
Furthermore,thereexistc ,c andc threepositiveconstantsonlydependingonc,θandw
1 2 3 1
suchthat
∥J (cos(ρ ·))∥ ≤c ρ−1, ∥K (cos(ρ ·))∥ ≤c ρ−1 and |||K ||| ≤c .
j j ∞ 1 j j j ∞ 2 j j ∞ 3
PROOF OF LEMMA 8.2. Wehave
(cid:90) ρ jt (cid:0) (cid:1)(cid:16) u (cid:17)
−J (f)(t)= sin(u)I f t− du
j
ρ
0 j
=
c (cid:90) ρ jt sin(u)(cid:16)(cid:90) 1
e−θ|t−ρ− j1u−s|
f(s)ds(cid:17)
du
w
1 0 0
(cid:32) (cid:33)
=:Im J(1)(f)(t)+J(2)(f)(t)+J(3)(f)(t) ,
with
J(1)(f)(t)=
c (cid:90) ρ jt eiu(cid:16)(cid:90) t−ρ− j1u
e−θ(t−ρ− j1u−s)
f(s)ds(cid:17)
du
w
1 0 0
=
c (cid:90) t e−θ(t−s)f(s)(cid:16)(cid:90) ρ j(t−s)
e(i+θρ−
j1)udu(cid:17)
ds
w
1 0 0
c (cid:90) t (cid:16) (cid:17)
= e−θ(t−s)f(s) eiρ j(t−s)+θ(t−s)−1 ds
w (i+θρ−1)
1 j 0
c(−i+θρ−1) (cid:90) t (cid:16) (cid:17)
=
(cid:113)
j f(s) eiρ j(t−s)−e−θ(t−s) ds,
w 1+θ2ρ−2 0
1 j36
J(2)(f)(t)=
c (cid:90) ρ jt eiu(cid:16)(cid:90) t
eθ(t−ρ− j1u−s)
f(s)ds(cid:17)
du
w
1 0 t−ρ−1u
j
=
c (cid:90) t eθ(t−s)f(s)(cid:16)(cid:90) ρ jt
e(i−θρ−
j1)udu(cid:17)
ds
w
1 0 ρ (t−s)
j
c (cid:90) t (cid:16) (cid:17)
= eθ(t−s)f(s) eiρ jt−θt−eiρ j(t−s)−θ(t−s) ds
w (i−θρ−1)
1 j 0
c(−i−θρ−1) (cid:90) t (cid:16) (cid:17)
=
(cid:113)
j f(s) eiρ jt−θs−eiρ j(t−s) ds
w 1+θ2ρ−2 0
1 j
and
J(3)(f)(t)=
c (cid:90) ρ jt eiu(cid:16)(cid:90) 1
eθ(t−ρ− j1u−s)
f(s)ds(cid:17)
du
w
1 0 t
=
c (cid:90) 1 eθ(t−s)f(s)(cid:16)(cid:90) ρ jt
e(i−θρ−
j1)udu(cid:17)
ds
w
1 t 0
c (cid:90) 1 (cid:16) (cid:17)
= eθ(t−s)f(s) eiρ jt−θt−1 ds
w (i−θρ−1)
1 j t
c(−i−θρ−1) (cid:90) 1 (cid:16) (cid:17)
=
(cid:113)
j f(s) eiρ jt−θs−eθ(t−s) ds.
w 1+θ2ρ−2 t
1 j
Thisyields
(45)
(cid:32) (cid:33)
2cθρ−1 (cid:90) t c (cid:90) 1
−J j(f)(t)=
(cid:113)
j Im f(s)eiρ j(t−s)ds +
(cid:113)
f(s)e−θ|t−s|ds
w 1+θ2ρ−2 0 w 1+θ2ρ−2 0
1 j 1 j
(cid:32) (cid:33)
c(−i−θρ−1) (cid:90) 1
+Im
(cid:113)
j f(s)eiρ jt−θsds .
w 1+θ2ρ−2 0
1 j
Weobtainforanyt∈[0,1],
(cid:16)2c c (cid:90) 1 c (cid:90) 1 (cid:17)
|J (f)(t)|≤ + e−θ|t−s|ds+ e−θsds ∥f∥
j ∞
w w w
1 1 0 1 0
(cid:16)2c ce−θt (cid:90) t ceθt (cid:90) 1 c (cid:90) 1 (cid:17)
≤ + eθsds+ e−θsds+ e−θsds ∥f∥
∞
w w w w
1 1 0 1 t 1 0
c (cid:16) 3−e−θt−eθ(t−1)−e−θ(cid:17)
≤ 2+ ∥f∥
∞
w θ
1
c (cid:16) 3−2e−θ/2−e−θ(cid:17)
≤ 2+ ∥f∥
∞
w θ
1
and
c (cid:16) 3−2e−θ/2−e−θ(cid:17)
|||J ||| ≤ 2+ .
j ∞
w θ
1
Thisyieldsthefirstresult.PCAFORPOINTPROCESSES 37
Forthesecondresult,observethatwithf =cos(ρ ·),weobtainfrom(45),
j
2cθ c (cid:12)(cid:90) 1 (cid:12) c (cid:12)(cid:90) 1 (cid:12)
|J j(cos(ρ j·))(t)|≤
w ρ
+
w
(cid:12)
(cid:12)
eiρ jse−θ|t−s|ds(cid:12) (cid:12)+
w
(cid:12)
(cid:12)
eiρ jse−θsds(cid:12) (cid:12).
1 j 1 0 1 0
But
(cid:90) 1 (cid:90) t (cid:90) 1
eiρ jse−θ|t−s|ds=e−θt e(iρ j+θ)sds+eθt e(iρ j−θ)sds
0 0 t
(cid:16)e(iρ j+θ)t−1(cid:17) (cid:16)eiρ j−θ−e(iρ j−θ)t(cid:17)
=e−θt +eθt
iρ +θ iρ −θ
j j
andthereexistsc onlydependingonc,θ andw suchthat
1 1
∥J (cos(ρ ·))∥ ≤c ρ−1.
j j ∞ 1 j
Forthethirdresult,observethat
(cid:32) (cid:33)
K j(f)(t)=Re
c (cid:90) ρ jt eiu(cid:16)(cid:90) 1
e−θ|t−ρ− j1u−s|
f(s)ds(cid:17)
du
w
1 0 0
(cid:32) (cid:33)
=Re J(1)(f)(t)+J(2)(f)(t)+J(3)(f)(t)
(cid:32) (cid:33)
2cθρ−1 (cid:90) t cθρ−1 (cid:90) 1
=
(cid:113)
j Re f(s)eiρ j(t−s)ds +
(cid:113)
j f(s)e−θ|t−s|ds
w 1+θ2ρ−2 0 w 1+θ2ρ−2 0
1 j 1 j
(cid:32) (cid:33)
c(−i−θρ−1) (cid:90) 1
+Re
(cid:113)
j f(s)eiρ jt−θsds .
w 1+θ2ρ−2 0
1 j
Therefore,aspreviously,thereexistsc onlydependingonc,θ andw suchthat
2 1
∥K (cos(ρ ·))∥ ≤c ρ−1.
j j ∞ 2 j
andthereexistsc onlydependingonc,θ andw suchthat
3 1
|||K ||| ≤c .
j ∞ 3
Now, we end the proof of the theorem and use Equivalence (43). Since J is a linear
j
operator,foranyintegerN,wehave,fort∈[0,1],
H (t)=acos(ρ t)+J (H )(t)
j j j j
=acos(ρ t)+aJ (cos(ρ ·))(t)+(J ◦J )(H )(t)
j j j j j j
N−1
(cid:88)
=a Jk◦(cos(ρ ·))(t)+(JN◦)(H )(t),
j j j j
k=0
withforanyboundedfunctionf,
Jk◦(f)=(J ◦···◦J )(f).
j j j
(cid:124) (cid:123)(cid:122) (cid:125)
ktimes38
SinceH isboundedand|||J ||| <1/2(seeLemma8.2),wehave
j j ∞
limsup∥(JN◦)(H )∥ ≤limsup|||J |||N∥H ∥ =0.
j j ∞ j ∞ j ∞
N→+∞ N→+∞
Therefore
+∞
(cid:88)
(46) H (t)=a Jk◦(cos(ρ ·))(t), t∈[0,1].
j j j
k=0
Thisimpliesthat,uptorenormalization,wehaveatmostonesolutiontotheproblem.Now,
we obtain a solution of the system (18) if and only if the boundary condition H (1)=0 is
j
satisfied.Using(46),thisisequivalentto
+∞
(cid:88)
cos(ρ )=− Jk◦(cos(ρ ·))(1).
j j j
k=1
We can write ρ =(k −1/2)π+u π, with k ∈N∗ and −1/2<u ≤1/2 (k and u are
j j j j j j j
uniquelydefined).Then,H (1)=0writes
j
+∞
(cid:88)
(47) (−1)k jsin(u jπ)+ J jk◦(cos(((k
j
−1/2)π+u jπ)·))(1)=0.
k=1
Since |||J ||| <1/2 (see Lemma 8.2), for k fixed, the left hand side is a continuous fonc-
j ∞ j
tion of u taking positive and negative values when u describes the interval (−1/2;1/2].
j j
Therefore,foranypositiveinteger k ,thereexists u ∈(−1/2;1/2] suchthatEquation(47)
j j
issatisfied.Now,letusgiveacontrolofu .Wehave:
j
+∞ +∞
2|u |≤|sin(u π)|≤(cid:88) |||J |||k−1×∥J (cos(ρ ·))∥ ≤(cid:88)(cid:16)1(cid:17)k−1 × c 1 = 2c 1 .
j j j ∞ j j ∞ 2 ρ ρ
j j
k=1 k=1
leadingto
c
1
|u |≤ .
j
ρ
j
Thesecomputationsholdforanyintegerk andinparticular,wecanconsiderk =j.Inthis
j j
case,weobtain
ρ =(j−1/2)π+u π
j j
and,using(40),
w w w (cid:16) u (cid:17)−2
1 1 1 j
λ = = = 1+ .
j ρ2 (cid:0) (j−1/2)π+u π)(cid:1)2 (cid:0) jπ−π/2(cid:1)2 (j−1/2)
j j
We have finally proved that for any j ≥1, System (18) has a solution (λ ,H ) and there
j j
existsaconstantC dependingonlyonc,θ andw suchthatforanyj≥1,
1 1
(cid:12) w (cid:12)
(cid:12)λ − 1 (cid:12)≤C j−4.
(cid:12) j (cid:0) (cid:1)2(cid:12) 1
jπ−π/2
Now,itremainstodetermineF .Using(44),wehaveforanyt∈[0,1],
µ
j
F (t)=aρ sin(ρ t)+ρ K (H )(t)
µ j j j j j
j
+∞
=aρ sin(ρ t)+aρ K (cos(ρ ·))(t)+aρ (cid:88) K (cid:0) Jk◦(cos(ρ ·))(cid:1) (t).
j j j j j j j j j
k=1PCAFORPOINTPROCESSES 39
andwehavetodeterminethevalueofabyusingtheproperty∥F ∥ =1.Setting
µ 2
j
+∞
v (t):=ρ K (cos(ρ ·))(t)+ρ (cid:88) K (cid:0) Jk◦(cos(ρ ·))(cid:1) (t), t∈[0,1],
j j j j j j j j
k=1
sothat
(48) F (t)=aρ sin(ρ t)+av (t), t∈[0,1],
µ j j j
j
wehave,usingLemma8.2,
+∞
(cid:88)
∥v ∥ ≤c +c ρ 21−k∥J (cos(ρ ·))∥ ≤c +2c c
j ∞ 2 3 j j j ∞ 2 1 3
k=1
and,sinceρ−1=O(j−1),
j
(cid:90) (cid:90) 1(cid:16) v (t)(cid:17)2 (cid:16)1 (cid:17)
1= F2 (t)dt=a2ρ2 sin(ρ t)+ j dt=a2ρ2× +O(j−1) .
µ j j j ρ j 2
0 j
√ √
This implies aρ = 2+O(j−1) and a= 2 +O(j−2). Using again Equation (48) yields
j ρ
j
theresultstatedin(21).Equation(46)showsthattheeigenvalues(λ ) aresimple.
j j≥1
8.3. ProofsofSection5.
8.3.1. Proof of Lemma 5.1. We first prove some intermediate results. First remark that
given i=1,...,n, if T ∈N , there exists k ∈{0,...,|T|} such that T =T , then for all
i k
ℓ∈{1,...,|T|},
(cid:90) T (cid:90) T
ℓ ℓ
1 dt= 1 dt=(T −T )1 =(T −T )1 .
T≤t T ≤t ℓ ℓ−1 T ≤T ℓ ℓ−1 T≤T
k k ℓ−1 ℓ−1
T T
ℓ−1 ℓ−1
Thisimplies
(cid:90) T (cid:90) T (cid:90) T
ℓ ℓ (cid:88) (cid:88) ℓ
F (t)dt= 1 dt= 1 dt
Π T≤t T≤t
i
T T T
ℓ−1 ℓ−1T∈N T∈N ℓ−1
i i
(cid:88)
= (T −T )1 =(T −T )F (T ),
ℓ ℓ−1 T≤T ℓ ℓ−1 Π ℓ−1
ℓ−1 i
T∈N
i
andconsequently
(cid:90) T ℓ 1 (cid:88)n
F (t)dt=(T −T ) F (T )=(T −T )F (T ).
W(cid:99) ℓ ℓ−1 n Π i ℓ−1 ℓ ℓ−1 W(cid:99) ℓ−1
T
ℓ−1 i=1
andalso
(cid:90) T
ℓ
(49) F (t)dt=(T −T )F (T ).
T
∆(cid:98)i ℓ ℓ−1 ∆(cid:98)i ℓ−1
ℓ−1
Weturnnowtotheproofofthefirstpoint.Letℓ∈{1,...,|T|},
1 (cid:90) T ℓ
Γ(cid:98) ∆(cid:98)e ℓ(s)=
(cid:112)
T −T
K(cid:98) ∆(cid:98)(s,t)dt
ℓ ℓ−1 T ℓ−1
 
1 (cid:90) T ℓ 1 (cid:88)n (cid:88)
= (cid:112)
T −T

n
1 T≤s1 T′≤t−F W(cid:99)(s)F W(cid:99)(t)dt
ℓ ℓ−1 T ℓ−1 i=1T,T′∈N
i40
 
1 1 (cid:88)n (cid:88) (cid:90) T ℓ (cid:90) T ℓ
= (cid:112)
T −T n
 1 T≤s 1 T′≤tdt−F W(cid:99)(s) F W(cid:99)(t)dt
ℓ ℓ−1 i=1 T,T′∈N T ℓ−1 T ℓ−1
i
(cid:32) (cid:33)
n
1 1 (cid:88) (cid:88)
= F (s) (T −T )1 −F (s)F (T )(T −T ) .
(cid:112) T −T n Π i ℓ ℓ−1 T′≤T ℓ−1 W(cid:99) W(cid:99) ℓ−1 ℓ ℓ−1
ℓ ℓ−1 i=1 T′∈N
i
(cid:112) n
T ℓ−T ℓ−1 (cid:88)(cid:0) (cid:1)
= F (s)F (T )−F (s)F (T ) .
n Π i Π i ℓ−1 W(cid:99) W(cid:99) ℓ−1
i=1
Followingthesamelines,forallℓ′∈{1,...,|T|},
1 (cid:90) T ℓ′
⟨Γ(cid:98) ∆(cid:98)e ℓ,e ℓ′⟩=
(cid:112)
T −T
Γ(cid:98) ∆(cid:98)e ℓ(s)ds
ℓ′ ℓ′−1 T ℓ′−1
(cid:112) T ℓ−T ℓ−1 (cid:88)n (cid:90) T ℓ′ (cid:0) (cid:1)
= F (s)F (T )−F (s)F (T ) ds
n(cid:112) T −T Π i Π i ℓ−1 W(cid:99) W(cid:99) ℓ−1
ℓ′ ℓ′−1 i=1 T ℓ′−1
(cid:112) n
(T ℓ−T ℓ−1)(T
ℓ′
−T ℓ′−1)(cid:88)(cid:0)
(cid:1)
= F (T )F (T )−F (T )F (T ) .
n Π i ℓ′−1 Π i ℓ−1 W(cid:99) ℓ′−1 W(cid:99) ℓ−1
i=1
In particular, if for all ℓ, there exists a unique i such that T ∈N , we have F (T )=
ℓ i W(cid:99) ℓ−1
(ℓ−1)/nand
(cid:90) T ℓ ℓ−1
F (t)dt= (T −T ),
W(cid:99) n ℓ ℓ−1
T
ℓ−1
whichconcludestheproofofthefirstpoint.
Now,westarttheproofofthesecondpointbyprovingthat
(50) Im(Γ(cid:98) ∆(cid:98))⊂span{e 1,...,e |T|}.
Since Γ(cid:98)
∆(cid:98)
is a finite rank operator, both spaces Im(Γ(cid:98) ∆(cid:98)) and span{e 1,...,e |T|} are finite-
dimensionalvectorspacesanditissufficienttoprove
span{e 1,...,e |T|}⊥⊂Im(Γ(cid:98) ∆(cid:98))⊥.
Moroever,sinceΓ(cid:98) isaself-adjointoperator,
∆(cid:98)
Im(Γ(cid:98) )⊥=Ker(Γ(cid:98) ).
∆(cid:98) ∆(cid:98)
Then,toprove(50),itissufficienttoprovethat
span{e 1,...,e |T|}⊥⊂Ker(Γ(cid:98) ∆(cid:98)).
Letf ∈span{e ,...,e }⊥,wehaveforanyℓ∈{1,...,|T|},
1 |T|
⟨f,e ⟩=0,
ℓ
then,bydefinitionofe ,
ℓ
(cid:90) T
ℓ
f(t)dt=0.
T
ℓ−1PCAFORPOINTPROCESSES 41
This implies that, for all i=1,...,n, for all T ∈N , since, by construction of the grid T,
i
thereexistsℓsuchthatT =T ,
ℓ−1
(cid:90) 1 (cid:88)|T| (cid:90) T ℓ′
f(t)dt= f(t)dt=0.
T
ℓ′=ℓ
T ℓ′−1
Hence
(cid:90) 1 1 (cid:88)n (cid:88) (cid:90) 1 1 (cid:88)n (cid:88) (cid:90) 1
⟨F W(cid:99),f⟩= W(cid:99)([0,t])f(t)dt=
n
1 {T≤t}f(t)dt=
n
f(t)dt=0
0 0 T
i=1T∈N i=1T∈N
i i
and
1 (cid:88)n (cid:88) (cid:90) 1
Γ(cid:98) ∆(cid:98)f(t)=
n
1 {T≤s,T′≤t}f(s)ds−W(cid:99)([0,t])⟨F W(cid:99),f⟩,
0
i=1T,T′∈N
i
1 (cid:88)n (cid:88) (cid:90) 1
=
n
1
{T′≤t}
f(s)ds−W(cid:99)([0,t])⟨F W(cid:99),f⟩=0.
T
i=1T,T′∈N
i
Thisconcludestheproofof(50).
NowweidentifytheeigenfunctionsofΓ(cid:98) withtheeigenvectorsofthematrixG(cid:98) .
∆(cid:98) ∆(cid:98)
• Letj≥1.Weconsiderλ(cid:98)j anon-zeroeigenvalueofΓ(cid:98) ∆(cid:98).Letη
(cid:98)j
anassociatedeigenfunction
suchthat∥η ∥=1.Weset
(cid:98)j
v =(⟨η ,e ⟩) .
(cid:98)j (cid:98)j ℓ ℓ=1,...,|T|
Wehave
 
|T|
(cid:88)
G(cid:98) ∆(cid:98)v
(cid:98)j
= ⟨Γ(cid:98) ∆(cid:98)e ℓ,e ℓ′⟩⟨η (cid:98)j,e ℓ′⟩
ℓ′=1
ℓ=1,...,|T|
 
(cid:42) |T| (cid:43)
(cid:88)
(51) = Γ(cid:98) ∆(cid:98)e ℓ, ⟨η (cid:98)j,e ℓ′⟩e ℓ′  .
ℓ′=1
ℓ=1,...,|T|
(cid:80)|T|
Now remark that ⟨η ,e ⟩e is the orthogonal projection of the function η on the
ℓ′=1 (cid:98)j ℓ′ ℓ′ (cid:98)j
spacespan{e 1,...,e |T|}.Then,sinceΓ(cid:98) ∆(cid:98)η
(cid:98)j
=λ(cid:98)jη
(cid:98)j
andλ(cid:98)j >0,from(50),wededuce
η
(cid:98)j
∈Im(Γ(cid:98) ∆(cid:98))⊂span{e 1,...,e |T|},
meaningthat
|T|
(cid:88)
⟨η ,e ⟩e =η
(cid:98)j ℓ′ ℓ′ (cid:98)j
ℓ′=1
and∥v (cid:98)j∥=1.Then,sinceΓ(cid:98)
∆(cid:98)
isaself-adjointoperator, (51)canbewritten
(cid:16)(cid:68) (cid:69)(cid:17) (cid:16)(cid:68) (cid:69)(cid:17)
G(cid:98) ∆(cid:98)v
(cid:98)j
= Γ(cid:98) ∆(cid:98)e ℓ,η
(cid:98)j
ℓ=1,...,|T|= e ℓ,Γ(cid:98) ∆(cid:98)η
(cid:98)j
ℓ=1,...,|T|=λ(cid:98)j(⟨e ℓ,η (cid:98)j⟩) ℓ=1,...,|T|=λ(cid:98)jv (cid:98)j.
Thismeansthatλ(cid:98)j ∈Sp(G(cid:98) ∆(cid:98))and,consequently
Sp(Γ(cid:98) )\{0}⊂Sp(G(cid:98) ).
∆(cid:98) ∆(cid:98)42
• Conversely, let v
(cid:98)j
= (v (cid:98)j1,...,v (cid:98)j|T| )t a unit-norm eigenvector of G(cid:98)
∆(cid:98)
associated with the
eigenvalueλ(cid:98)j andlet
|T|
(cid:88)
η = vℓe .
(cid:98)j (cid:98)j ℓ
ℓ=1
Wehave:
|T| |T| |T|
(cid:88) (cid:88) (cid:88)(cid:104) (cid:105)
Γ(cid:98) ∆(cid:98)η
(cid:98)j
= ⟨Γ(cid:98) ∆(cid:98)η (cid:98)j,e ℓ′⟩e
ℓ′
= v (cid:98)jℓ⟨Γ(cid:98) ∆(cid:98)e ℓ,e ℓ′⟩e
ℓ′
= G(cid:98) ∆(cid:98)v
(cid:98)j
ℓ′e
ℓ′
ℓ′=1 ℓ,ℓ′=1 ℓ′=1
|T|
(cid:88)
=λ(cid:98)j v (cid:98)jℓ′e
ℓ′
=λ(cid:98)jη (cid:98)j.
ℓ′=1
Then, η
(cid:98)j
is a unit-norm eigenfunction of the operator Γ(cid:98)
∆(cid:98)
associated with the eigenvalue
λ(cid:98)j and
Sp(G(cid:98) )⊂Sp(Γ(cid:98) ).
∆(cid:98) ∆(cid:98)
To end the proof of the third point, it remains to remark that, since the functions e ’s are
ℓ
rightcontinuousfunctions,thenη alsoisaright-continuousfunction.Moreover,following
(cid:98)j
the same lines than the proof of Proposition 3.1, η is a function with bounded variations
(cid:98)j
and η (t)=0 for t<0. Then, applying Proposition 4.4.3 of [18], we obtain the expected
(cid:98)j
result:thereexistsauniquemeasureµ suchthatF =η .
(cid:98)j µ (cid:98)j
(cid:98)j
8.3.2. ProofofTheorem5.5. Wefirstprovethefirstpoint.From[7],Lemma4.2,p.103,
wecandeducethat
(52) sup|λ(cid:98)j −λ j|≤|||Γ ∆−Γ(cid:98) ∆(cid:98)|||,
j≥1
where,foranoperatorS onL2([0,1]),
∥Sx∥
|||S|||= sup
∥x∥
x∈L2([0,1])
denotestheusualoperatornorm.LetΓ(cid:98)∆= n1 (cid:80)n i=1F
∆
i
⊗F
∆
i
weget
(53) |||Γ ∆−Γ(cid:98) ∆(cid:98)|||≤|||Γ(cid:98)∆−Γ ∆|||+|||Γ(cid:98)
∆(cid:98)
−Γ(cid:98)∆|||.
Wedealwiththefirstterm.Wegetclassically,
n
1 (cid:88)
Γ(cid:98)∆−Γ ∆= F
∆
⊗F
∆
−E[F ∆⊗F ∆].
n i i
i=1
We remark that F ⊗F −E[F ⊗F ], i = 1,...,n is an i.i.d. sequence of centered
∆ ∆ ∆ ∆
i i
random variables taking values in the space of Hilbert-Schmidt operators equipped with its
usual norm ∥·∥ defined by ∥S∥2 =(cid:80) ∥Se ∥2 for (e ) an orthonormal (hilber-
HS HS j≥1 j j j≥1
tian)basisof L2([0,1]) (recallthatthedefinitionofthenormdoesnotdependonthebasis).
Furthermore,wehave
|||Γ(cid:98)∆−Γ ∆|||≤∥Γ(cid:98)∆−Γ ∆∥
HSPCAFORPOINTPROCESSES 43
and
n
1 (cid:88)
∥Γ(cid:98)∆−Γ ∆∥2
HS
=
n2
⟨F
∆ i
⊗F
∆ i
−E[F ∆⊗F ∆],F
∆ j
⊗F
∆ j
−E[F ∆⊗F ∆]⟩ HS,
i,j=1
where, for two Hilbert-Schmidt operators S and T, the Hilbert-Schmidt scalar product is
(cid:80)
defined by ⟨S ,S ⟩ = ⟨S e ,S e ⟩ and does not depend on the considered basis.
1 2 HS j≥1 1 j 2 j
Then,taking(e ) =(η ) ,weremarkthat
j j j j
E[⟨F ⊗F −E[F ⊗F ],F ⊗F −E[F ⊗F ]⟩ ]
∆ ∆ ∆ ∆ ∆ ∆ ∆ ∆ HS
i i j j
=(cid:88) E(cid:2) ⟨(F ⊗F −E[F ⊗F ])η ,(F ⊗F −E[F ⊗F ])η ⟩(cid:3)
∆ ∆ ∆ ∆ ℓ ∆ ∆ ∆ ∆ ℓ
i i j j
ℓ≥1
(cid:90) 1
(cid:88) (cid:0) (cid:1)
= Cov F ⊗F η (t),F ⊗F η (t) dt
∆ ∆ ℓ ∆ ∆ ℓ
i i j j
0
ℓ≥1
(cid:90) 1
(cid:88)
=1 Var(F ⊗F η (t))dt
i=j ∆ ∆ ℓ
0
ℓ≥1
(cid:90) 1
(cid:88)
=1 Var(⟨F ,η ⟩F (t))dt
i=j ∆ ℓ ∆
0
ℓ≥1
(cid:20) (cid:90) 1 (cid:21)
≤1 (cid:88) E ⟨F ,η ⟩2 F2(t)dt =1 E(cid:2) ∥F ∥4(cid:3) .
i=j ∆ ℓ ∆ i=j ∆
0
ℓ≥1
Then,finally,weget
(cid:104) (cid:105)
E(cid:2)
∥F
∥4(cid:3)
(54) E |||Γ(cid:98)∆−Γ ∆|||2 ≤ ∆ .
n
Thenforthesecondterm,
|||Γ(cid:98)∆−Γ(cid:98) ∆(cid:98)|||=|||(F
W(cid:99)
−F W)⊗(F
W(cid:99)
−F W)|||=∥F
W(cid:99)
−F W∥2.
Then,sinceF (t)=F (t)−E[F (t)],
∆ Π Π
E[|||Γ(cid:98)∆−Γ(cid:98) ∆(cid:98)|||]=E[∥F
W(cid:99)
−F W∥2]
(cid:20)(cid:90) 1 (cid:21)
=E (cid:0) F (t)−F (t)(cid:1)2 dt
W(cid:99) W
0
(cid:90) 1
(cid:0) (cid:1)
= Var F (t) dt
W(cid:99)
0
(cid:32) (cid:33)
(cid:90) 1 1 (cid:88)n
= Var F (t) dt
Π
n i
0
i=1
1 (cid:90) 1 1 (cid:90) 1 1
(55) = Var(F (t))dt= E[F (t)2]dt= E[∥F ∥2].
Π ∆ ∆
n n n
0 0
Finally,combiningeq.(53),(54)and(55),weget
E(cid:2)
∥F
∥4(cid:3)
(56) E[|||Γ ∆−Γ(cid:98) ∆(cid:98)|||2]≤4 n∆ ,
andInequality(23)followsfromBosqinequality(52).44
From[7],Lemma4.3,p.104,wehavetheupper-bound
√
∥η
(cid:98)j
−η (cid:101)j∥≤2 2δ j−1|||Γ ∆−Γ(cid:98) ∆(cid:98)|||,
andInequality(24)followsfrom(56).Now,wealsohave,byCauchy-Schwarz’sinequality,
forallφ∈H1,
0
|⟨µ
(cid:98)j
−µ (cid:101)j,φ⟩|2=(cid:12) (cid:12)⟨η
(cid:98)j
−η (cid:101)j,φ′⟩(cid:12) (cid:12)2 ≤∥η
(cid:98)j
−η (cid:101)j∥2∥φ′∥2.
Then
∥µ −µ ∥2 ≤∥η −η ∥2
(cid:98)j (cid:101)j H−1 (cid:98)j (cid:101)j
andInequality(25)follows.
REFERENCES
[1] ANDERSEN, P., BORGAN, O., GILL, R. and KEIDING, N. (1993).Statisticalmodelsbasedoncounting
processes.NewYork:Springer-Verlag.
[2] ASH,R.B.andGARDNER,M.F.(1975).Topicsinstochasticprocesses.AcademicPress[HarcourtBrace
JovanovichPublishers],NewYork.ProbabilityandMathematicalStatistics,Vol.27. MR0448463(56
##6769)
[3] BACRY, E., BOMPAIRE, M., GAÏFFAS, S. and MUZY, J.-F. (2020). Sparse and low-rank multivariate
Hawkesprocesses.J.Mach.Learn.Res.21PaperNo.50,32. MR4095329
[4] BELITSER, E., SERRA, P. and VAN ZANTEN, H. (2015).Rate-optimalBayesianintensitysmoothingfor
inhomogeneousPoissonprocesses.J.Statist.Plann.Inference16624–35. https://doi.org/10.1016/j.
jspi.2014.03.009MR3390131
[5] BONNET,A.,MARTINEZHERRERA,M.andSANGNIER,M.(2023).Inferenceofmultivariateexponential
Hawkesprocesseswithinhibitionandapplicationtoneuronalactivity.Stat.Comput.33PaperNo.91,
26. https://doi.org/10.1007/s11222-023-10264-wMR4606276
[6] BONNET,A.,DION-BLANC,C.,GINDRAUD,F.andLEMLER,S.(2022).Neuronalnetworkinferenceand
membrane potential model using multivariate Hawkes processes. Journal of Neuroscience Methods
372109550. https://doi.org/10.1016/j.jneumeth.2022.109550
[7] BOSQ,D.(2000).LinearProcessesinFunctionSpaces:TheoryandApplications.SpringerNewYork.
[8] BRÉMAUD,P.andMASSOULIÉ,L.(1996).StabilityofnonlinearHawkesprocesses.Ann.Probab.241563–
1588. https://doi.org/10.1214/aop/1065725193MR1411506
[9] BRÉMAUD,P.andMASSOULIÉ,L.(2001).Hawkesbranchingpointprocesseswithoutancestors.J.Appl.
Probab.38122–135. https://doi.org/10.1017/s0021900200018556MR1816118
[10] BREZIS, H. (2011). Functional analysis, Sobolev spaces and partial differential equations. Universitext.
Springer,NewYork. MR2759829
[11] CARRIZOVERGARA,R.(2022).Karhunen-LoèveexpansionofRandomMeasures.arXiv:2203.14202.
[12] CARSTENSEN,L.,SANDELIN,A.,WINTHER,O.andHANSEN,N.R.(2010).MultivariateHawkespro-
cessmodelsoftheoccurrenceofregulatoryelements.BMCbioinformatics11456.
[13] CHEN,S.,WITTEN,D.andSHOJAIE,A.(2017).Nearlyassumptionlessscreeningforthemutually-exciting
multivariate Hawkes process. Electron. J. Stat. 11 1207–1234. https://doi.org/10.1214/17-EJS1251
MR3634334
[14] CHEYSSON,F.(2023).hawkesbow:EstimationofHawkesProcessesfromBinnedObservationsRpackage
version1.0.2.
[15] CHIANG,W.-H.,LIU,X.andMOHLER,G.(2022).HawkesprocessmodelingofCOVID-19withmobility
leadingindicatorsandspatialcovariates.InternationalJournalofForecasting38505-520. https://doi.
org/10.1016/j.ijforecast.2021.07.001
[16] CHIU,S.N.,STOYAN,D.,KENDALL,W.S.andMECKE,J.(2013).Stochasticgeometryanditsapplica-
tions.JohnWiley&Sons.
[17] CHORNOBOY,E.,SCHRAMM,L.andKARR,A.(1988).Maximumlikelihoodidentificationofneuralpoint
processsystems.Biologicalcybernetics59265–275.
[18] COHN, D. L.(1993).Measuretheory.BirkhäuserBoston,Inc.,Boston,MAReprintofthe1980original.
MR1454121
[19] CORLAY, S. and PAGÈS, G. (2015). Functional quantization-based stratified sampling methods. Monte
CarloMethodsAppl.211–32. https://doi.org/10.1515/mcma-2014-0010MR3318550PCAFORPOINTPROCESSES 45
[20] CRANE,R.andSORNETTE,D.(2008).Robustdynamicclassesrevealedbymeasuringtheresponsefunc-
tionofasocialsystem.ProceedingsoftheNationalAcademyofSciences10515649–15653.
[21] CUNNINGHAM, J. P. and YU, B. M. (2014).Dimensionalityreductionforlarge-scaleneuralrecordings.
NatNeurosci171500–1509.
[22] DALEY,D.J.andVERE-JONES,D.(2003).Anintroductiontothetheoryofpointprocesses.Vol.I,second
ed.ProbabilityanditsApplications(NewYork).Springer-Verlag,NewYorkElementarytheoryand
methods. MR1950431
[23] DALEY,D.J.andVERE-JONES,D.(2008).Anintroductiontothetheoryofpointprocesses.Vol.II,second
ed. Probability and its Applications (New York). Springer, New York General theory and structure.
https://doi.org/10.1007/978-0-387-49835-5MR2371524
[24] DELAIGLE, A., HALL, P. and BATHIA, N. (2012).Componentwiseclassificationandclusteringoffunc-
tionaldata.Biometrika99299–313.
[25] DONNET,S.,RIVOIRARD,V.andROUSSEAU,J.(2020).NonparametricBayesianestimationformultivari-
ateHawkesprocesses.Ann.Statist.482698–2727. https://doi.org/10.1214/19-AOS1903MR4152118
[26] EMBRECHTS,P.,LINIGER,T.andLIN,L.(2011).MultivariateHawkesprocesses:anapplicationtofinan-
cialdata.J.Appl.Probab.48A367–378. https://doi.org/10.1239/jap/1318940477MR2865638
[27] ESCABIAS, M., AGUILERA, A. M. and VALDERRAMA, M. J. (2004). Principal component estimation
of functional logistic regression: discussion of two different approaches. Journal of Nonparametric
Statistics16365–384. https://doi.org/10.1080/10485250310001624738
[28] FARAJTABAR,M.,WANG,Y.,RODRIGUEZ,M.G.,LI,S.,ZHA,H.andSONG,L.(2016).COEVOLVE:
AJointPointProcessModelforInformationDiffusionandNetworkCo-evolution.
[29] GAO,X.andZHU,L.(2018).AfunctionalcentrallimittheoremforstationaryHawkesprocessesanditsap-
plicationtoinfinite-serverqueues.QueueingSystems90. https://doi.org/10.1007/s11134-018-9570-5
[30] GUSTO, G. and SCHBATH, S. S. (2005). FADO: A statistical method to detect favored or avoided dis-
tancesbetweenoccurrencesofmotifsusingtheHawkesmodel.StatisticalApplicationsinGenetics
andMolecularBiology4n.p.
[31] HANSEN, N. R., REYNAUD-BOURET, P. and RIVOIRARD, V. (2015). Lasso and probabilistic inequal-
ities for multivariate point processes. Bernoulli 21 83–143. https://doi.org/10.3150/13-BEJ562
MR3322314
[32] HAWKES,A.G.(1971a).Spectraofsomeself-excitingandmutuallyexcitingpointprocesses.Biometrika
5883–90. https://doi.org/10.1093/biomet/58.1.83MR278410
[33] HAWKES,A.G.(1971b).Pointspectraofsomemutuallyexcitingpointprocesses.J.Roy.Statist.Soc.Ser.
B33438–443. MR358976
[34] HILGERT,N.,MAS,A.andVERZELEN,N.(2013).Minimaxadaptivetestsforthefunctionallinearmodel.
TheAnnalsofStatistics41838–869. https://doi.org/10.1214/13-AOS1093
[35] HSING,T.andEUBANK,R.(2015).Theoreticalfoundationsoffunctionaldataanalysis,withanintroduc-
tiontolinearoperators997.JohnWiley&Sons.
[36] ILLIAN, J., BENSON, E., CRAWFORD, J. and STAINES, H. (2006). Principal Component Analysis for
SpatialPointProcesses—AssessingtheAppropriatenessoftheApproachinanEcologicalContext.
SpringerNewYork,NewYork,NY. https://doi.org/10.1007/0-387-31144-0_7
[37] JACQUES,J.andPREDA,C.(2014).Model-basedclusteringformultivariatefunctionaldata.Computational
Statistics&DataAnalysis7192-106.
[38] KARASÖZEN, E.,NISSEN, E.,BÜYÜKAKPINAR, P.,CAMBAZ, M. D.,KAHRAMAN, M.,KALKAN ER-
TAN, E., ABGARMI, B., BERGMAN, E., GHODS, A. and ÖZACAR, A. A. (2018). The 2017 July
20Mw6.6Bodrum–KosearthquakeilluminatesactivefaultingintheGulfofGökova,SWTurkey.
GeophysicalJournalInternational214185-199.
[39] KARR, A. F.(1991).Pointprocessesandtheirstatisticalinference,seconded.Probability:PureandAp-
plied7.MarcelDekker,Inc.,NewYork. MR1113698
[40] KINGMAN,J.F.C.(1993).Poissonprocesses.OxfordStudiesinProbability3.TheClarendonPress,Oxford
UniversityPress,NewYorkOxfordSciencePublications. MR1207584
[41] KOLACZYK,E.D.(1999).WaveletshrinkageestimationofcertainPoissonintensitysignalsusingcorrected
thresholds.Statist.Sinica9119–135. MR1678884
[42] LAMBERT, R., TULEAU-MALOT, C., BESSAIH, T., RIVOIRARD, V., BOURET, Y., LERESCHE, N. and
REYNAUD-BOURET,P.(2017).Reconstructingthefunctionalconnectivityofmultiplespiketrainsus-
ingHawkesmodels.JournalofNeuroscienceMethods297. https://doi.org/10.1016/j.jneumeth.2017.
12.026
[43] LI, Y.,WANG, N.andCARROLL, R. J.(2013).SelectingtheNumberofPrincipalComponentsinFunc-
tionalData.JournaloftheAmericanStatisticalAssociation1081284–1294.
[44] MANTÉ, C., YAO, A.-F. and DEGIOVANNI, C. (2007). Principal component analysis of measures, with
specialemphasisongrain-sizecurves.ComputationalStatistics&DataAnalysis514969-4983.46
[45] MARSOLIER, J., PROMPSY, P. . . . and VALLOT, C. (2022). H3K27me3 conditions chemotolerance in
triple-negativebreastcancer.NatureGenetics54459–468.
[46] MOHLER, G. O., SHORT, M. B., BRANTINGHAM, P. J., SCHOENBERG, F. P. and TITA, G. E. (2011).
Self-exciting point process modeling of crime. Journal of the American Statistical Association 106
100–108.
[47] OAKES,D.(1975).TheMarkovianself-excitingprocess.J.Appl.Probability1269–77. https://doi.org/10.
1017/s0021900200033106MR362522
[48] OGATA,Y.(1988).Statisticalmodelsforearthquakeoccurrencesandresidualanalysisforpointprocesses.
JournaloftheAmericanStatisticalassociation839–27.
[49] PANARETOS,V.M.andZEMEL,Y.(2016).Amplitudeandphasevariationofpointprocesses.TheAnnals
ofStatistics44. https://doi.org/10.1214/15-aos1387
[50] RASMUSSEN, J. G. (2013). Bayesian Inference for Hawkes Processes. Methodology and Computing in
AppliedProbability15623–642. https://doi.org/10.1007/s11009-011-9272-5
[51] REISS,P.T.andOGDEN,R.T.(2007).FunctionalPrincipalComponentRegressionandFunctionalPartial
LeastSquares.JournaloftheAmericanStatisticalAssociation102984-996.
[52] REYNAUD-BOURET, P.(2003).AdaptiveestimationoftheintensityofinhomogeneousPoissonprocesses
viaconcentrationinequalities.Probab.TheoryRelatedFields126103–153. https://doi.org/10.1007/
s00440-003-0259-1MR1981635
[53] REYNAUD-BOURET, P.andSCHBATH, S.(2010).AdaptiveestimationforHawkesprocesses;application
togenomeanalysis.TheAnnalsofStatistics382781?2822. https://doi.org/10.1214/10-aos806
[54] SILVERMAN, B. and RAMSAY, J. (2002). Applied functional data analysis: methods and case studies.
Springer,NewYork,NY.
[55] SULEM, D., RIVOIRARD, V. and ROUSSEAU, J. (2024). Bayesian estimation of nonlinear Hawkes pro-
cesses.Bernoulli301257–1286. https://doi.org/10.3150/23-bej1631MR4699552
[56] WARD, O. G., WU, J., ZHENG, T., SMITH, A. L. and CURLEY, J. P. (2022).NetworkHawkesprocess
models for exploring latent hierarchy in social animal interactions. Journal of the Royal Statistical
SocietySeriesC:AppliedStatistics711402–1426.
[57] WILLETT, R. M. and NOWAK, R. D. (2007).MultiscalePoissonintensityanddensityestimation.IEEE
Trans.Inform.Theory533171–3187. https://doi.org/10.1109/TIT.2007.903139MR2417680
[58] WU, S., MÜLLER, H.-G. and ZHANG, Z. (2013).Functionaldataanalysisforpointprocesseswithrare
events.Statist.Sinica231–23. MR3076156
[59] ZETTL,A.(2005).Sturm-Liouvilletheory.MathematicalSurveysandMonographs121.AmericanMathe-
maticalSociety,Providence,RI. https://doi.org/10.1090/surv/121MR2170950
[60] ZHENG,G.X.Y.,TERRY,J.M....andBIELAS,J.H.(2017).Massivelyparalleldigitaltranscriptional
profilingofsinglecells.NatureCommunications814049.
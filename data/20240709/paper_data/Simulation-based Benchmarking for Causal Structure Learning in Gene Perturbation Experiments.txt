Simulation-based Benchmarking for Causal Structure
Learning in Gene Perturbation Experiments
LukaKovacˇevic´ IzzyNewsham
MRCBiostatisticsUnit MRCBiostatisticsUnit
UniversityofCambridge UniversityofCambridge
Cambridge,UK Cambridge,UK
luka.kovacevic@mrc-bsu.cam.ac.uk
SachMukherjee JohnWhittaker
DZNEandUniversityofBonn,Bonn,Germany, MRCBiostatisticsUnit
MRCBiostatisticsUnit UniversityofCambridge
UniversityofCambridge,Cambridge,UK Cambridge,UK
Abstract
Causalstructurelearning(CSL)referstothetaskoflearningcausalrelationships
fromdata. AdvancesinCSLnowallowlearningofcausalgraphsindiverseappli-
cationdomains,whichhasthepotentialtofacilitatedata-drivencausaldecision-
making. Real-worldCSLperformancedependsonanumberofcontext-specific
factors,includingcontext-specificdatadistributionsandnon-lineardependencies,
thatareimportantinpracticaluse-cases. However,ourunderstandingofhowto
assessandselectCSLmethodsinspecificcontextsremainslimited. Toaddressthis
gap,wepresentCausalRegNet,amultiplicativeeffectstructuralcausalmodelthat
allowsforgeneratingobservationalandinterventionaldataincorporatingcontext-
specificproperties,withafocusonthesettingofgeneperturbationexperiments.
Usingreal-worldgeneperturbationdata,weshowthatCausalRegNetgenerates
accurate distributions and scales far better than current simulation frameworks.
WeillustratetheuseofCausalRegNetinassessingCSLmethodsinthecontextof
interventionalexperimentsinbiology.
1 Introduction
Theaimofcausalstructurelearning(CSL)istoinfercausalrelationshipsbetweenvariables,typically
intheformofadirectedgraph. CSLhasbeenextensivelystudiedandawidearrayofmethodsare
availableintheliterature[1]. Recentyearshaveseenconsiderabletheoreticalandmethodological
advancesinCSL,includingreformulationviacontinuousoptimization[2],neuralmethods[3,4]and
emerging,end-to-endsuperviseddeeplearning-basedCSLapproaches[5,6].
However,despitetheseexcitingdevelopments,CSLinscientificapplicationsremainschallenging
duetoanumberoffactors,includingproblemdimension,noise,datalimitationsandlatentvariables.
AlthoughmanyCSLmethodsaresupportedbytheory,inpracticeitischallengingtoverifyunderlying
assumptions.Thus,itisoftendifficulttoassessthelikelyefficacyofaCSLapproachinarealproblem
context. Thismeansthatinmanycontexts–ofteninvolvingarduousandcostlyexperiments–it
remainsnontrivialtojudgewhetheragivenCSLapproachiswellsuitedtothesetting.
The application of CSL to problems in biomedicine manifests many such problems. Advances
in cell and molecular biology have dramatically improved our ability to perform interventional
experimentsatscale. Notably,thecombinationofgeneeditingtechnologies(e.g. CRISPR)with
Preprint.Underreview.
4202
luJ
8
]LM.tats[
1v51060.7042:viXrasequencingprotocols[7]hasenabledmeasurementoftensofthousandsofvariablesunderthousands
ofinterventions,withrecentexperimentsspanningmillionsofcells[8]. Thesedevelopmentsarein
theprocessoftransformingbiologicalandbiomedicaldiscovery,enablingcausalexperimentsatan
unprecedentedscale. Large-scalegeneknockoutexperimentsinparticular,promisetoinformdrug
targetidentificationbyallowingforinferenceoftheeffectsofindividualandcombinatorialgenetic
interventions. AnemergingbodyofworkhasfocusedonCSLforbiologicaldata[amongothers
9,4,6],butforagivenproblemsettingitremainspracticallychallengingtounderstandefficacyand
thereforetoestablishreliableCSL-basedworkflows.
RelatedWork. TheneedtobetterunderstandCSLperformancecharacteristicshasinspiredaline
ofworkinbenchmarkingmethods[10,11]. Whileanumberofpapersincludeevaluationusingreal
biologicaldata[9,4,6],theseresultsareinevitablyspecifictotheparticularrealdatasetsusedand
relativeperformanceofCSLmethodscanvarysignificantlydependingoncontext.Thishasmotivated
work on simulation engines of various kinds. In the biological domain, Single-cell Expression
ofGenesIn-silico(SERGIO)[12]wasdevelopedasanapproachbasedonstochasticdifferential
equations. Morerecently,GRouNdGAN[13]wasproposedasatechniqueforgeneratingsingle-cell
RNA sequencing (scRNA-seq) data from a given causal graph. CausalBench [11] has also been
proposedasaframeworkforevaluatingstructurelearnersdirectlyfromreal-worlddatausinggene
regulatorynetworksderivedfromliteratureandstatisticalhypothesistesting.
Large-scaledatasimulationisanimportantpartofthedeeplearningCSLmethodreportedin[5].
Nonetheless, our approach could be used to generate data to train, or pre-train, supervised CSL
methods,apointwereturntointheDiscussion.
Contributions. WeproposeCausalRegNet,anapproachforgeneratingrealisticsyntheticdatafrom
anunderlyingdirectedacyclicgraph(DAG).CausalRegNetallowsgenerationofbothobservational
andinterventionaldatawhilstrespectinguser-specifiedstatisticalpropertiesandconformingtoa
numberofbasicdesiderata. Crucially,CausalRegNetishighlyscalable,allowingstudyofproblems
ofthesizenowseenincontemporaryexperimentsanddataacquisitionpipelines. Thissimulatorcan
beusedtostudytheperformanceofCSLmethodsinacontext-specificmanner,byfixingkeyaspects
oftheproblemsetting.
Ourworkhasseveralnovelcontributions:
(i) WepresentanoveltoolcalledCausalRegNet1forsimulatingrealisticscRNA-seqdatawith
respecttoacausalgraph;
(ii) WevalidateCausalRegnetusingdatafromrealworldlarge-scaleinterventionalexperiments
inbiology;
(iii) WedemonstratehowCausalRegNetcanbeusedtobenchmarkCSLalgorithmsinpractice.
Themethods,softwareandworkflowweprovideallowforassessmentofCSLmethodsinthecontext
ofreal-worldproblems. Ouraimisnottoprovideacomprehensiveempiricalbenchmarkingstudy
butratherdemonstratehowsuchabenchmarkcanbecarefullydevisedwhilsttakingintoaccount
manycontext-specificfactorsandcriteria. Oursimulatorgeneratesdatathatbehavessimilarlytodata
from(specific)realexperiments,allowingforinferencesthatcouldnotbemadeusinganentirely
genericsimulationmodel.
2 Background
InSection2.1weintroducethegeneralbackgroundknowledgeneededforstructuralcausalmodels
(SCMs). Thisisfollowedbytheintroductionofadditivenoisemodels(ANMs)inSection2.2,which
areaspecificsubclassofSCMsthatarecommonlyusedtogeneratedataforcomparativebenchmarks
ofCSLmethods.
1Codeisavailableathttps://github.com/luka-kovacevic/causalregnet.
22.1 StructuralCausalModels
Definition2.1(StructuralCausalModel;[14]). Astructuralcausalmodel(SCM)C=(S,PN)isa
collectionS ofdstructuralassignmentscorrespondingtoeachX
j
∈X={X 1,...,X d},
X
j
∶=f j(X pa(j),N j), j =1,...,d, (1)
whereX pa(j)⊆X/{X j}areparentsofX j,PN isajointdistributionovernoisevariables,whichwe
requiretobejointlyindependent,suchthatwecanwritePN asaproductofthemarginaldensitiesof
N
j
forj =1,...,N. IfX i∈X pa(j)thenX
j
isachildofX iandX iisaparentofX j.
ThecausalgraphG =(V,E)iscomposedofverticesV =[d]andedgesE ={i→j ∶X i∈X pa(j)}.
WeassumethatG hasnopathsoftheformj →...→i,thatis,G isacyclicandtherearenopaths
alongdirectededgesthatleadfromachildtooneofitsparents. Foranynodej ifthereexistsa
(directed)pathi→...→jalongdirectededgesthennodeiisanancestorofj. Conversely,nodejis
adescendantofnodei.
Thus,theobservationaldistributionoverXimpliedbyanSCMissuchthateachX j =f j(X pa(j),N j)
in distribution. Assuming there are no interventions, the distribution entailed by the SCM is the
observationaldistribution,alsomoregenerallycalledanentaileddistribution.
Interventions. In the SCM framework, interventions can be performed on individual nodes or
groupsofnodes,wherethesetofinterventiontargetsisdenotedbyI ⊆V. Whenconsideringmore
thanoneinterventionI,theinterventionalfamilyI ∶={I 1,...,I K}containsK distinctintervention
settings. The observational setting can be denoted as I∅. The distribution entailed by the SCM
followinganinterventionisreferredtoasaninterventionaldistribution.
Interventionsaredifficulttocarryoutinpracticeandatbestlimitedinscopeinmanysettings.
However, in many molecular biology settings interventional experiments are possible, e.g. by
interventions targeted at specific molecular mechanisms. Ongoing technological developments,
includingmethodsrootedinCRISPRandrelatedgeneeditingprotocols,arenowenablinglarge-scale
interventionalexperimentsincludingthosefurtherdescribedinAppendixA.
2.2 AdditiveNoiseModels
Definition2.2(AdditiveNoiseModel;[15]). AnSCMwithstructuralassignmentsoftheform,
X
j
∶=f j(X pa(j))+N
j
(2)
wheref j(⋅)isanarbitraryfunctionandthenoisevariablesN
j
arejointlyindependent,isanadditive
noisemodel(ANM).
Thecasewherethefunctionf j(⋅)islinearandthenoisevariablesaredistributedasN j ∼N(0,σ j2 )
yieldsthegeneralfamilyoflinearGaussianANMs. WerefertothesesimplyasGaussianANMs
throughout.
SyntheticdatageneratedthroughlinearANMshaspreviouslybeenshowntobevulnerabletoCSL
methodsthatexploitvarsortabilitytoimprovecausalstructurelearningperformance.
Definition2.3(Varsortability; [16]). Varsortability,denotedbyv,isameasureoftheagreement
betweentheorderofincreasingmarginalvarianceandthecausalorder,
∑d k− =11 ∑i→j∈Ekincreasing(Var(X i),Var(X j))
v∶= , (3)
∑d k− =11 ∑i→j∈Ek1
⎧ ⎪⎪⎪⎪1 a<b,
whereincreasing(a,b)=⎨1/2 a=b, (4)
⎪⎪⎪⎪0
a>b.
⎩
Methodsthatscorecloseto1orcloseto0arevarsortable,meaningthecorrectcausalorderingcan
beobtainedbyorderingthenodesbyascendingordescendingvariance,respectively.
33 Methodology
TotranslaterecentdevelopmentsinCSLtothereal-worldinferenceofcausalstructures,itisessential
thatweunderstandexactlywhenCSLalgorithmsfailandwhy. Thistypeofunderstandingrequires
bothbenchmarkingstudiesandtheoreticalworkthataccountsforcontext-specificdataproperties.
Motivatedbytheforegoing,wefocusoncontext-specificsimulationforCSL.InSection3.1,we
beginbyderivingsimulatordesideratathatareimportanttoacontext-specificsimulationtoolfor
large-scale gene perturbation experiments. Section 3.2 describes the model developed based on
desiderata,includinganexampleofconditionsrelatingtothefunctionalrelationshipbetweenparents
andchildrenthatensuresourmodeladherestodomainknowledgeofobservationalandinterventional
relationshipspresentinscRNA-seqdata.
3.1 Desiderata
ThedesiderataappliedtodevelopCausalRegNetareasfollows:
I. Interpretability: Simulatorsthatareparametricallyinterpretableareeasiertouseandthus
allowforsimplerreasoningwhenitcomestocomparingmodels.
II. Scalability: Contemporarydatasetscanbeveryhighdimensional,motivatinganeedfor
scalability. Scalabilityisparticularlyimportantforsimulationdatasetsthataregenerated
fromalargesetofgraphconfigurationsasneededformodelvalidationorsupervisedmodel
training.
III. Lowvarsortability: DatageneratedbysimpleANMsishighlyvarsortable. Previouswork
by[16]hasestablishedthatseveralCSLalgorithmsareabletoexploitvarsortabilitytoyield
goodbenchmarkresultsthataredrivenbythisproperty. Thusfar,thereisnoevidencethat
real-worldcausalstructuresleadtovarsortabledata, andhence, oursimulatorofchoice
shouldreflectthisfact.
IV. DistributionalProperties: Agreementbetweenthepropertiesofempiricalandsynthetic
distributionsiscrucialtoensuringthatnovelalgorithmsperformaswellintherealworldas
theydointheory.
ThesedesiderataguidethedesigndecisionsdescribedinSection3.2whereadifferentsetofdesiderata
mayhaveledtoadifferentmodel.
3.2 CausalRegNet
WeproposeamultiplicativeeffectSCMthataccuratelyreflectstheinteractiondynamicsofsingle-cell
geneexpression. Onceparameterised,samplescanbedrawnefficientlyfromthissimulator.
3.2.1 Node-wiseDistribution
Foreachnodej,therandomvariableassociatedwiththisnodeisdistributedaccordingto,
X
j
∼NegBin(µ j,σ j2 ), (5)
whereµ isthemeanexpressionandσ2isthevariance. Theparametersaredefinedas
j j
µ
j
=µ0
j
⋅f jreg (X pa(j);Θ j), and σ j2 =µ j(1+µ j/θ j), (6)
whereµ0
j
istheobservationalmeanandf jreg (⋅)representstheregulatoryeffectoftheparentsofX
j
onX . Amean-variancerelationshipisimposedviathevariance,σ2,whichisdeterminedbythe
j j
mean,µ ,andtheinversedispersionparameter,θ . Thisfunctionalformisbasedonwell-established
j j
domainknowledgemotivatedbygenericandwell-knownpropertiesofbiochemicalinterplay[17].
3.2.2 RegulatoryFunction
Theregulatoryeffectfunctiontakesasigmoidalform,
α
f jreg (X pa(j);Θ j)= j , (7)
1+exp{−γ j(w(x pa(j))+b j)}
4where α j is the maximum regulatory effect of X pa(j) on X i, and w(x pa(j)) is any function that
aggregatestheregulatoryeffectofparents. Thisregulatoryfunctionintroducesnon-linearitytothe
relationshipbetweeneachnodeanditsparents.
Forsimplicity,weusew(x pa(j))=∑i∈pa(j)w
ij
⋅x i/µ0 i,whereW ∈Rn×n isaweightedadjacency
matrix that defines the strength of relationship between X i and X j and [W]ij = w ij is the edge
weightfortheedgegoingfromX toX .
i j
3.2.3 ModelSpecification
The parameters γ
j
and b
j
are calibrated according to the aggregation function w(⋅), maximum
regulatoryeffectα
j
>1,andaminimumregulatoryeffect0<β
j
<1parameter. Todothis,wedefine
thefollowingvalueconditions:
I BaselineExpressionCondition(BEC):
if∀i∈pa(j),X i=0, thenf jreg (X pa(j))=β j,
II ObservationalExpressionCondition(OEC):
if∀i∈pa(j),X i=µ0
i
thenf jreg (X pa(j))=1.
Inotherwords,wefirsthavethatwhentheexpressionofeachoftheparentsofnodej areatzero,the
regulatoryeffectwillbeatthebaselineβ . Conversely,wheneachoftheparentsofj areexpressed
j
attheirobservationalmean,thentheregulatoryeffectisequalto1,implyingµ
j
=µ0
j
⋅1=µ0 j. That
is,X isatitsobservationalmean.
j
Thesevalueconditionsallowustofreelyspecifytheaggregationfunctionw(⋅)andcalibratethe
regulatoryeffectfunctiontoguaranteemaximumandminimumeffects.Furthermore,theseconditions
aresufficienttoyieldclosed-formsolutionsforγ
j
andb
j
giventheparameters{α j,β j,w(⋅)}.
Thus,giventhatthenode-wisedistribution,regulatoryeffectfunctionandmodelspecificationmethod
haveclearbiologicalinterpretations,CausalRegNetsatisfiesDesiderataI.
3.2.4 Example: ModelSpecificationforLinearAggregationwithMean-normalisation
AssumingthelinearaggregationfunctionintroducedinSection3.2.2,wedemonstratehowvalue
conditionscanbeusedtoderivetheparametersγ andb . ApplyingOECandBECfromSection
j j
3.2.3,wehavethatw(x pa(j)) = 0whenx i = 0,∀i ∈ pa(j)andthatw(x pa(j)) = ∑i∈pa(j)w ij when
x i=µ0 i,∀i∈pa(j),respectively. Solving,thisyields,
1
b j =−
γ
(log(α j−1)+γ jw j′ ) and, (8)
j
1 α
j
γ j = w′ [log( β −1)−log(α j−1)], (9)
j j
wherew j′ =∑i∈pa(j)w
ij
andw j′ ≠0. Assumingthatw j′ =1andsettingtheremainingparametersas
{α
j
=2,β
j
=0.1}thecalibratedregulatoryeffectfunctionisshowninFigure1. Thepointsinthis
figurehighlighttheOECandBECbeingsatisfiedontheregulatoryeffectcurve.
3.2.5 AdjustedRegulatoryFunction
Whensimulatingnodeswithexcessivelysmallobservationalmeansµ0,standardcalibrationasshown
j
inFigure1canleadtooverlylargeaggregatedregulatoryeffects. Forexample, supposethatwe
want to simulate a child of gene MTOR from [8] with µˆ0 j ≈ 0.25 and θˆ j ≈ 3.38 with freg shown
inFigure1. ThedistributionoftheexpressionofMTORisshowninFigure5(a),whereitvaries
between0and4. Withsuchexpressionrates,wehavethatx
i
=0,1,2,3,4,whichcorrespondsto
x i/µ0
i
=0,4,8,12,16,respectively. Thisregulatoryeffectismuchlargerthantherangeofvaluesfor
whichthefunctioninFigure1varies. Thatis,foranyx i>1,f jreg (X pa(j))≈2. Thus,weproposean
adjustedregulatoryfunctionwithanadditionalregulatoryadjustmentconstanta ,
j
α
f jreg (X pa(j);Θ j)=
1+exp{−γ j(w
adj
j(x pa(j))+b adj)}
(10)
52.0
1.5
[1, 1]
1.0
0.5
[0, 0.1]
0.0
2 0 2 4
x
Figure 1: Example calibrated regulatory effect function. The red line indicates the cut-off, the
regulatoryeffectwillnevergoleftofthisline.
where
b adj=b j−a j, and w adj(x pa(j))=w(x pa(j))+a j. (11)
Thisadditionalhyperparameternowallowsforfullexpressionofregulatoryeffectsevenwhenµ0is
i
verysmall. Thisadjustedregulatoryeffectfunctionisusedforsimulationsthroughoutthiswork.
3.2.6 Node-wiseDistributionFitting
ByparametrisingthedistributionofeachnodeasaNegativeBinomial,weenablenode-wisefittingof
simulateddistributionstoempiricalmarginaldistributionsinreal-worlddata. Wefittheobservational
meanandinversedispersionviatheNegativeBinomiallikelihood[17]. Theimplementedfitting
schemeusestheL-BFGS-Btofindalocallyoptimalsolutionforeachnodeindependently. Further
detailscanbeseeninAppendixC.
4 EmpiricalResults
ThedevelopmentofCausalRegnetwasmotivatedbythelackofagreementbetweeninterventional
distributionsgeneratedbySERGIOanddomain-knowledgeinbiology. Weexplorethismotivationin
Section4.1alongsideresultsfromCausalRegNet. Guidedbyourdesiderata,wethencomparethe
scalabilityandvarsortabilityofCausalRegNet,SERGIOandtheGaussianANMinSections4.2-4.3,
respectively. Finally,inSection4.4weexaminetheagreementbetweenCausalRegNetandreal-world
perturb-seqdata. ThefullparametersettingsusedforsimulationinthissectionaregiveninAppendix
D.2.
4.1 Motivation: InterventionalDistributionsunderChangingStructures
Tounderstand simulatorbehaviourunder intervention, we estimatethe averagetreatment effects
(ATEs)oftheinterventionI ={X 0},onX 1,denoted
ATE(X 0,X 1)=E [X 1∅ ]−E [X 1do(X0=0) ], (12)
withvaryingcausalstructures,where∅denotestheobservationalsetting.
First,westudytheATEasthenumberofparentsofanodeincreases. Thatis,weareinterestedin
howthedistributionofarandomvariablechangesasthenumberofparentsincreases. Figure2a
illustratesthissetting,wherethenumberofparents,k,varies.
InFigure3a,simulatingwithSERGIOgivesanaverageATEof2.5acrosssimulations,whilstthe
meanexpressionofX isrising. ThissuggeststhattheconstantATEisfacilitatedbytheincreasing
1
6
yX 0 c 1 ... c k
X 0 c 1 ... c k X 1
X (b)Moremediators
1
(a)Moreparents
Figure2: WeexaminethetreatmenteffectofX onX as(a)thenumberofparentsofX increases
0 1 1
and(b)asthenumberofmediatorsbetweenX 0andX 1increases(i.e. fork=0,...,9under(a)and
(b)).
expressionlevel,allowingeachadditionalparenttohaveanATEof2.5. Conversely,CausalRegNet
withthemean-normalisedaggregationfunctionappliedinSection3.2.3ensuresthateachregulator
hasequalcontribution,andthus,asthenumberofparentsincreases,theobservedATEtendstowards
zero. Althoughitisnotclearwhataggregationfunctionismostfaithfultotheunderlyingbiology,the
modularityofCausalRegNetmeansthattheaggregationfunctioncanbeadaptedtoemergingdomain
knowledge. ForbothCausalRegNetandSERGIO,theATEispartiallydeterminedbytheweighted
adjacencymatrix,suchthatparentswithgreateredgeweightswilldeterminemoreoftheregulatory
effectandwillresultindifferentATEs. Thiscanbedirectlyalteredwhenusingeithersimulator.
(a) (b) (c)
20 3
15 3
2
10 2
1
5 1
0 0 0
0 2 4 6 8 0 2 4 6 8 0 2 4 6 8
k k k
CausalRegNet SERGIO
Figure3: (a)showsabsoluteATEwithincreasingnumbersofparents. In(b),themeanobservational
expressionofX againstnumberofparents. (c)showstheabsoluteATEfallsforbothsimulatorsas
1
thenumberofmediatorsincreases.
Next,weconsiderthecasewherethenumberofnodesmediatingtheeffectofX onX increases.
0 1
Figure2billustratesthissetting,wherek=0,...,9. Figure3cshowsthatasthenumberofmediators
increases,theATEfalls. Thisisintuitivelyexpectedsinceancestorsfurtherawaymayplausiblylead
tosmallerchangesindownstreamnodes. Thus,bothsimulatorsbehaveasexpectedunderthiscase.
4.2 Scalability
Figure4ashowsthetimetakentosimulatedatafrompredeterminedgraphsofsize3to10,000. The
scalabilityofCausalRegNetisshowntobecomparabletothesimpleGaussianANM,whichcan
generatedatafromgraphsofsize1,000withinlessthan10seconds. Forthesamegraphs,SERGIO
takesupwardsof10,000secondsor2.78hours. Moreover,SERGIOtakesover100,000secondsor
24hourstosimulateacausalgraphof5,000ormorenodes,whichmakesitpracticallyverydifficult
tosimulatesuchlargedatasets.
ThepoorscalabilityofSERGIOiscausedbytheneedtoreachasteadystatebeforesamplescan
bedrawn. MethodsbasedonSCMssuchasCausalRegNetoranyANMaredefinedbyparametric
probability distributions and can thus be be drawn from instantaneously. The simulation time in
thisinstanceispurelyassociatedwiththetimeneededtotraversethecausalgraphaccordingtothe
topologicalorderingofnodes.
Thus,CausalRegNetsatisfiesDesiderataIIasitisscalabletothedimensionofreal-worldexperiments.
7
noisserpxE
naeM
ETA
etulosbA
ETA
etulosbA(a) (b) (c)
104 1.0 1.0
103 0.8 0.8
102
101 0.6 0.6
100
0.4 0.4
101
102 0.2 0.2
103 O(n)
0.0 0.0
0 2000 4000 6000 8000 10000 0 10 20 30 0 10 20 30 40 50
Graph Size d (Number of nodes) d (Number of nodes)
CausalRegNet SERGIO Gaussian ANM
Figure4: (a)Simulationtimefordatafromgraphsofincreasingsize. Dataisgeneratedfromthe
same causal graph structures across methods. Computational time for a single simulation with
SERGIOwith5,000nodesormoreexceeds24hoursandsoisnotincluded. Meanvarsortabilityof
datageneratedfrom(b)acausalchainand(c)acausalgraphstructurebyeachsimulatorwith95%
confidenceintervals.
Table 1: Varsortability of data generated by the largest causal chains (d = 30) and causal graphs
(d=50)with95%confidenceintervals.
Simulator CausalChainVarsort. CausalGraphVarsort.
GaussianANM 0.863±0.076 0.986±0.005
SERGIO 0.488±0.034 0.873±0.019
CausalRegNet 0.477±0.008 0.492±0.008
4.3 Varsortability
Toexaminethevarsortabilityofdatageneratedbyeachsimulatorwegenerateddatafromcausal
chainandcausalgraphstructures. Acausalchainisacausalgraphsuchthatonlyonedirectedpath
oftheformX 1→...→X nexists,startingfromthefirstnodeinthechain,X 1,tothelastX n. For
CausalRegNet,weusenodesfittedtorealgeneexpressiondatafrom[8]byrandomlyselectinggenes
fromthesetobtainedinAppendixD.4. ParametricsettingsforsimulatingfromSERGIOcanbe
foundinAppendixD.2. ParametersusedtogeneratecausalgraphsusedbybothCausalRegNetand
SERGIOareinAppendixD.3.1.
The results for the causal chain simulations are shown in Figure 4b. For causal chains of length
10ormore,CausalRegNetandSERGIOgeneratenearperfectlynon-varsortabledata. InFigure4c
CausalRegNetgeneratesdatawithverylowvarsortabilityandoutperformsbothSERGIOandthe
Gaussian-ANMinthisrespect. Further,Table1showstheaveragevarsortabilityofdatagenerated
bythecausalchainsandgraphswiththegreatestnumberofnodes(i.e. d={30,50},respectively),
withCausalRegNetachievingsignificantlylowervarsortabilitythanbothSERGIOandtheGaussian
ANM.
CausalRegNetthereforesatisfiesDesiderataIIIasitgeneratesdatawithlowvarsortability.
4.4 ComparisontoExperimentalData
ToconductanempiricalcomparisonbetweenthedatageneratedbyCausalRegNetandreal-world
data,wecollect100genesrelatedtocancerpathways(seeAppendixD.4)forthemostcommonly
referencedgenesthatwerebothmeasuredandperturbedintheexperimentaldatasetfrom[8].
Giventhissetof100genes,weaimtosimulategraphsofsized={3,10,100}withCausalRegNetto
assesswhetherthesimulateddistributionsaresimilartothoseobservedin[8]. Usingthedistribution
fittingschemeoutlinedinSection3.2.6,eachnodeintheDAGisfittedtosimulatetheexpressionof
agenefromtheoriginalsetof100genes.
Figure5ashowstherealandsimulatednodesfor3genesselectedfrom[8]. Wemeasurethedistance
betweensimulatedandrealdistributionsusingtheWassersteindistance(WD)[18,19]. Theoverlap
betweensimulatedandrealdistributionsis<0.2forallnodes. Figure5bshowstheWDsforgraphs
of size d = 100. As a comparative baseline, we shuffle the gene labels such that each synthetic
8
)s(
emiT
ytilibatrosraV(a)
WD=0.03 WD=0.03 WD=0.19
0.75 0.75 0.75
0.50 0.50 0.50
0.25 0.25 0.25
0.00 0.00 0.00
0 5 10 0 5 10 0 5 10
MTOR MTHFR CDC42
(b) (c) (d)
=2 =5
1.75 Label Assignment 5 3.5
True 3.0
1.50 Random 4
1.25 2.5 1.00 3 2.0
0.75 2 1.5
0.50 1.0
1
0.25 0.5
0.00 0 0.0
0.0 0.5 1.0 1.5 2.0 2.5 1.0 0.5 0.0 0.5 1.0 1.0 0.5 0.0 0.5 1.0
WD ATE ATE
Real Simulated
Figure5: (a)Comparisonbetweenrealandsimulateddatafornodesfittedtogenesin[8]inDAG
with3nodes. (b)Ingreen,WDforsimulatedmarginaldistributionsfittedto[8]comparedtothe
truedistributions. Inpurple,thedistributionlabelsareshuffledsuchthateachsimulatedmarginal
iscomparedtoarandomempiricalmarginal,givingabaselineforcomparison. Thedistributionof
interventionaleffectswith(c)α
j
=2and(d)α
j
=5foreachnode.
distributioniscomparedtotheexpressionofarandomgene. FromFigure5b,clearlythecomparison
tothetruedistributionleadstolowerWDs.Forbothtrueandrandomlabelassignments,therearealso
outliersintheWDs,showninFigure8(AppendixD.6),however,theseaccountforasmallnumber
ofnodes. Toassessthesyntheticinterventionaldistributions,sincethetruecausalgraphisunknown
wecannotcomparedistributionsdirectly. Instead,inFigures5c-dwecomparethedistributionof
interventionaleffectsbetweentherealandsimulateddata. Wecanseethatweobtaingoodcoverage
withsomeexcessive0effectsin5c,however,modifyingα leadstoasmallernumberof0asshown
j
inFigure5d.
Hence,CausalRegNetalsosatisfiesDesiderataIVasitgeneratesobservationalandinterventional
distributionsthatarecomparabletoreal-worlddata.
4.5 BenchmarkStudy
Thegoalofthisworkistointroduceacontext-specificsimlulatorforuseinstudyingCSL.Todemon-
strateitsuse,wecarriedoutanillustrativestudybenchmarkingsomeCSLalgorithmscommonly
usedasbaselines(seeAppendixD.3). Here,weseethatinthespecificcontextused,thevarious
methodsperformpoorly. Weemphasisethatfullyleveragingoursimulatorsforbenchmarkingperse
goesbeyondthescopeofthispaperandwouldbeakeydirectionforfuturework.
5 Discussion
Inthiswork,weproposedCausalRegNet,asimpleyetflexibleSCM-basedapproachtosimulationin
thecontextoflarge-scalegeneperturbationscreens. WefoundthatCausalRegNetledtosignificantly
improved scalability over existing approaches whilst coping with the issue of varsortability and
providingsyntheticdatamatchedtokeypropertiesofrealdatadistributions. Recentwork[20]has
shownthatvarsortabilitycorrespondstoanecessaryassumptionforsomeANMs,asshownby[21],
thusCausalRegNetagainprovidesanapproachforcomparingmethodswithvaryingassumptions
underafair,realisticsetting. Inadditiontoitsuseforbenchmarkingandcontext-specificassessment,
we think CausalRegNet can be a useful tool in training machine learning approaches for causal
discoveryandinferencebyallowingforrealisticandrapidsimulation. Rapidsimulationframeworks
9
ytisneD
ytisneD ytisneDcan also contribute to the design of real-world experiments, including active learning schemes
[22–24].
Individualexistingsimulatorssatisfysomebutnotallofthedesideratasetoutinthiswork. SERGIO
isabletogenerateaccurateobservationaldistributionsbutlackstheabilitytorealisticallysimulate
interventions and scalability to large problems. GRouNdGAN generates accurate observational
distributionsandisscalablebutlacksinterpretabilityandhasnotyetbeenassessedonitsabilityto
simulateinterventions. GRouNdGANalsorequirestrainingandvalidationonareferencedatasetto
accuratelysimulatedata,whichcanbecomputationallyexpensive. Incontrast,weprovidealibrary
ofparametersderivedfrom[8]thatallowssimulationstobecarriedoutparsimoniously.
Limitations&FutureWork. Severalpropertiesoftheframeworkandtoolhererequirefurther
worktofacilitatedevelopmentofeffectivecontext-specificbenchmarkingtools. Thesimplicityof
theSCM-basedapproachmeansthattemporaldynamicscannotbesimulated,whichispossiblein
lessscalabletoolssuchasSERGIOandapproachesthatallowtime-dependentdynamicssimulation
willbeimportantinsomeapplicationsofCSL.Furtherworkisalsoneededtoexplorealternative
parameterisationsoftheaggregationfunctionsw(⋅). Akeydirectionforfutureempiricalworkwill
betoconductacomprehensivebenchmarkingstudyusingCausalRegNettocomparetheperformance
ofalibraryofexistingCSLalgorithms.
AcknowledgmentsandDisclosureofFunding
LK acknowledges the support of an Ivan D Jankovic Studentship at Clare Hall, University of
Cambridge. ThisworkwasfundedbyUKRIProgrammeGrantMC_UU_00002/18. Forthepurpose
of open access, the author has applied a Creative Commons Attribution (CC BY) licence to any
AuthorAcceptedManuscriptversionarising.
References
[1] ChristinaHeinze-Deml,MarloesHMaathuis,andNicolaiMeinshausen. Causalstructurelearning. Annual
ReviewofStatisticsandItsApplication,5:371–391,2018.
[2] XunZheng,BryonAragam,PradeepKRavikumar,andEricPXing. Dagswithnotears: Continuous
optimizationforstructurelearning. Advancesinneuralinformationprocessingsystems,31,2018.
[3] PhillipLippe,TacoCohen,andEfstratiosGavves. Efficientneuralcausaldiscoverywithoutacyclicity
constraints. arXivpreprintarXiv:2107.10483,2021.
[4] RomainLopez,Jan-ChristianHütter,JonathanPritchard,andAvivRegev.Large-scaledifferentiablecausal
discoveryoffactorgraphs. AdvancesinNeuralInformationProcessingSystems,35:19290–19303,2022.
[5] NanRosemaryKe,SilviaChiappa,JaneWang,AnirudhGoyal,JorgBornschein,MelanieRey,Theophane
Weber, Matthew Botvinic, Michael Mozer, and Danilo Jimenez Rezende. Learning to induce causal
structure. arXivpreprintarXiv:2204.04875,2022.
[6] Kai Lagemann, Christian Lagemann, Bernd Taschler, and Sach Mukherjee. Deep learning of causal
structuresinhighdimensionsunderdatalimitations. NatureMachineIntelligence,5(11):1306–1316,2023.
[7] Atray Dixit, Oren Parnas, Biyu Li, Jenny Chen, Charles P Fulco, Livnat Jerby-Arnon, Nemanja D
Marjanovic,DanielleDionne,TylerBurks,RaktimaRaychowdhury,etal.Perturb-seq:dissectingmolecular
circuitswithscalablesingle-cellrnaprofilingofpooledgeneticscreens. cell,167(7):1853–1866,2016.
[8] Joseph M Replogle, Reuben A Saunders, Angela N Pogson, Jeffrey A Hussmann, Alexander Lenail,
AlinaGuna,LaurenMascibroda,EricJWagner,KarenAdelman,GilaLithwick-Yanai,etal. Mapping
information-richgenotype-phenotypelandscapeswithgenome-scaleperturb-seq.Cell,185(14):2559–2575,
2022.
[9] StevenMHill,LauraMHeiser,ThomasCokelaer,MichaelUnger,NicoleKNesser,DanielECarlin,Yang
Zhang,ArtemSokolov,EvanOPaull,ChrisKWong,etal. Inferringcausalmolecularnetworks:empirical
assessmentthroughacommunity-basedeffort. Naturemethods,13(4):310–318,2016.
[10] Marco Eigenmann, Sach Mukherjee, and Marloes Maathuis. Evaluation of causal structure learning
algorithmsviariskestimation. InConferenceonUncertaintyinArtificialIntelligence,pages151–160.
PMLR,2020.
10[11] MathieuChevalley,YusufRoohani,ArashMehrjou,JureLeskovec,andPatrickSchwab. Causalbench:
A large-scale benchmark for network inference from single-cell perturbation data. arXiv preprint
arXiv:2210.17283,2022.
[12] PayamDibaeiniaandSaurabhSinha. Sergio:asingle-cellexpressionsimulatorguidedbygeneregulatory
networks. Cellsystems,11(3):252–271,2020.
[13] YazdanZinati,AbdulrahmanTakiddeen,andAminEmad. Groundgan:Grn-guidedsimulationofsingle-
cell rna-seq data using causal generative adversarial networks. Nature Communications, 15(1):4055,
2024.
[14] JonasPeters,DominikJanzing,andBernhardSchölkopf. Elementsofcausalinference:foundationsand
learningalgorithms. TheMITPress,2017.
[15] PatrikHoyer,DominikJanzing,JorisMMooij,JonasPeters,andBernhardSchölkopf. Nonlinearcausal
discoverywithadditivenoisemodels. Advancesinneuralinformationprocessingsystems,21,2008.
[16] Alexander Reisach, Christof Seiler, andSebastian Weichwald. Bewareof thesimulated dag! causal
discovery benchmarks may be easy to game. Advances in Neural Information Processing Systems,
34:27772–27784,2021.
[17] DavideRisso,FannyPerraudeau,SvetlanaGribkova,SandrineDudoit,andJean-PhilippeVert. Ageneral
andflexiblemethodforsignalextractionfromsingle-cellrna-seqdata. Naturecommunications,9(1):284,
2018.
[18] AadityaRamdas,NicolásGarcíaTrillos,andMarcoCuturi. Onwassersteintwo-sampletestingandrelated
familiesofnonparametrictests. Entropy,19(2):47,2017.
[19] PauliVirtanen,RalfGommers,TravisE.Oliphant,MattHaberland,TylerReddy,DavidCournapeau,
EvgeniBurovski,PearuPeterson,WarrenWeckesser,JonathanBright,StéfanJ.vanderWalt,Matthew
Brett,JoshuaWilson,K.JarrodMillman,NikolayMayorov,AndrewR.J.Nelson,EricJones,Robert
Kern,EricLarson,CJCarey,˙IlhanPolat,YuFeng,EricW.Moore,JakeVanderPlas,DenisLaxalde,
JosefPerktold,RobertCimrman,IanHenriksen,E.A.Quintero,CharlesR.Harris,AnneM.Archibald,
Antônio H. Ribeiro, Fabian Pedregosa, Paul van Mulbregt, and SciPy 1.0 Contributors. SciPy 1.0:
FundamentalAlgorithmsforScientificComputinginPython. NatureMethods,17:261–272,2020.
[20] IgnavierNg,BiweiHuang,andKunZhang. Structurelearningwithcontinuousoptimization:Asoberlook
andbeyond. InCausalLearningandReasoning,pages71–105.PMLR,2024.
[21] Po-Ling Loh and Peter Bühlmann. High-dimensional learning of linear causal networks via inverse
covarianceestimation. TheJournalofMachineLearningResearch,15(1):3065–3105,2014.
[22] ScottSussex,CarolineUhler,andAndreasKrause. Near-optimalmulti-perturbationexperimentaldesign
forcausalstructurelearning. AdvancesinNeuralInformationProcessingSystems,34:777–788,2021.
[23] PanagiotisTigas,YashasAnnadani,AndrewJesson,BernhardSchölkopf,YarinGal,andStefanBauer.
Interventions, where and how? experimental design for causal models at scale. Advances in Neural
InformationProcessingSystems,35:24130–24143,2022.
[24] PanagiotisTigas,YashasAnnadani,DesiRIvanova,AndrewJesson,YarinGal,AdamFoster,andStefan
Bauer. Differentiablemulti-targetcausalbayesianexperimentaldesign. InInternationalConferenceon
MachineLearning,pages34263–34279.PMLR,2023.
[25] AlexanderHägele,JonasRothfuss,LarsLorch,VigneshRamSomnath,BernhardSchölkopf,andAndreas
Krause. Bacadi:Bayesiancausaldiscoverywithunknowninterventions. InInternationalConferenceon
ArtificialIntelligenceandStatistics,pages1411–1436.PMLR,2023.
[26] PeterSpirtes,ClarkNGlymour,andRichardScheines. Causation,prediction,andsearch. MITpress,
2000.
[27] LiamSolus,YuhaoWang,andCarolineUhler. Consistencyguaranteesforgreedypermutation-based
causalinferencealgorithms. Biometrika,108(4):795–814,2021.
[28] YuhaoWang,LiamSolus,KarrenYang,andCarolineUhler.Permutation-basedcausalinferencealgorithms
withinterventions. AdvancesinNeuralInformationProcessingSystems,30,2017.
[29] JonathanKans. Entrezdirect:E-utilitiesontheunixcommandline. EntrezProgrammingUtilitiesHelp
[Internet],Apr2013. [Updated2024Apr4].
11[30] LiviuPirvanandShamithASamarajiwa.Pangaea:Amodularandextensiblecollectionoftoolsformining
contextdependentgenerelationshipsfromthebiomedicalliterature. bioRxiv,pages2020–04,2020.
Appendices
InAppendixA,weintroducesingle-cellRNAsequencingexperimentsandthebiologynecessaryfor
CausalRegNet. AppendixBincludesdetailsonSERGIOfurthertothoseincludedinthemainpaper.
ThelikelihoodusedtofitthenegativebinomialdistributionsofCausalRegNettorealdataisgivenin
AppendixC.Finally,AppendixDincludesabenchmarkoncommonlyusedCSLalgorithmswith
someadditionalempiricalevaluationsofCausalRegNet.
A IntroductiontoSingle-cellRNASequencing
GenesareDNAsequencesthataretranscribedintomessengerRNA(mRNA)beforebeingturned
intoproteins. ThelevelofmRNAcorrespondingtoeachgenewithinaparticularcellisreferredto
asthegeneexpressionandisameasureoftheactivityofthatgeneinthatspecificcontext. Gene
expressionishighlyplastic,varyingaccordingtothetypeofcell,tissue,timeandinternalandexternal
stimuli,includingtheexpressionofothergenes. ManydiseaseassociatedDNAvariantslieoutside
genesbutseemtoexerttheireffectsbyinfluencingRNAexpressionatgenes. Geneexpressioncan
beexperimentallymeasuredwithinindividualcells,insingle-cellRNAsequencing(scRNA-seq)
experiments,oraggregatedacrosscellswithinatissuesample,inbulkRNA-seqexperiments. This
inturnallowsforthestudyoftheregulatorystructuregoverninggeneexpression,enablingusto
identifyandanalysegene-geneinteractions.
ExperimentaltechniquesforcollectingscRNA-seqdataintroduceadditionaltechnicalnoise,which
obscuresthealreadynoisybiologicalsignalpresentinscRNA-seqdata.Existingstatisticalapproaches
forstudyingscRNA-seqdataoftenassumethatdatafollowsa(zero-inflated)NegativeBinomial
distributionandhavebeenshowntobeeffectiveforsignalextractionanddistillingbiologicaland
technicalnoise[17].
B FurtherdetailsonSERGIO
SERGIO(single-cellexpressionofgenesin-silico)isatechniqueforsimulatingscRNA-seqdynamics
using stochastic differential equations (SDEs). Given a GRN structure, SERGIOsimulates gene
expressiondynamicsasafunctionofitsregulators. ItdoessousingthechemicalLangevinequation
(CLE)(cite)wherethetime-coursemRNAconcentrationofgeneiisgivenby:
dx √ √
i
=P i(t)−λ ix i(t)+q i(α P i(t)+β λ ix i(t)) (13)
dt
wherex i(t)istheexpressionofgenei,andP i(t)istheproductionrateattimet. Noiseisadded
throughtheindependentGaussianwhitenoiseprocessesαandβ. Theproductionrateismodelledas
asumofcontributionsfromeachparent:
P i= ∑ p ij+b i (14)
j∈pa(i)
wherep istheregulatoryeffectofparentj ongeneiandb isthebasalproductionrateofgenei.
ij i
p isdeterminedbyanon-linearfunctionoftheexpressionoftheparentaccordingto:
ij
xnij
j
p
ij
=K
ij hn ijij +xn jij
(15)
ifparentj isanactivatorand
xnij
⎛ j ⎞
p
ij
=K
ij
⎝1−
hn ijij +xn jij
⎠
(16)
12ifparentj isarepressor. Here,K denotesthemaximumcontributionofregulatorj totargeti,n
ij ij
istheHillcoefficientthatmodulatesnon-linearity,andh isthehalf-maximaleffect.
ij
Theexpressionofgeneiisupdatedaccordingto:
√ √
(x i)t+∆t=(x i)t+(P i(t)−λ ix i(t))∆t+q
i
P i(t)∆W α+q
i
λ ix i(t)∆W
β
(17)
√ √
where∆W α∼ ∆tN(0,1),∆W β ∼ ∆tN(0,1). See[12]forfulldetails.
Here,wemodifySERGIOtoperformhardinterventionsbysettingx i=aforthei-thnode,asdone
byotherapplicationsofSERGIO[25].
C NegativeBinomialLikelihood
Asconductedby[17],theNegative-Binomiallikelihoodusedtofittheobservationalmeanµ0and
j
inversedispersionθ fornodej isgivenby,
j
f NB(x j;µ0 j,θ j)= Γ(Γ x( jx +j 1+ )Γθ j ()
θ
j)(
θ
jθ +j
x
j)θj
(
µ
jµ +j
θ
j)xj
. (18)
Thelog-likelihoodlogf NB(x j;µ0 j,θ j)isoptimisedusingtheL-BFGS-BimplementationinSciPy
[19].
D ExtendedEmpiricalResults
In this section, we present initial benchmarking results of commonly used CSL methods using
CausalRegNet and a description of the computational resources needed to perform these experi-
mentsinSectionD.1. Westartbydescribingtheparametersettingsusedforsimulationsinvolving
CausalRegnet and SERGIO in Section D.2. Section D.3 then shows full simulation results. The
methodologyusedforselectingthe100cancer-relatedgenesforCausalRegNetisgiveninSection
D.4. A comparison of the distribution of correlations in the CausalRegNet synthetic dataset and
Replogle as well as for the causal and non-causal relationships simulated by CausalRegNet are
showninSectionD.5. ThedistributionofWassersteindistancesbetweensyntheticandrealgene
distributionsforthetrueandrandomgenelabelsisgiveninSectionD.6.
D.1 ComputationalResources
CPUhourswereusedtorunallsimulations. Themostintenseexperimentsinvolvedgeneratingdata
usingSERGIOforthescalabilityresultsinSection4.2. Thisinvolvedover300computehourswith
over64GBofactivememory. TheremainingexperimentsinSection4.3andSection4.4wererun
locallywithbasiccomputerequirements. TheexperimentsinvolvingCSLalgorithmsalsoexceeded
over150computehourstorunthealgorithmsongraphsofsize50and100with16GBofactive
memory.
D.2 SimulationParameterSettings
ForCausalRegNet,individualnodemeansandinversedispersionsareobtainedfromfittinganegative
binomialdistributiontorandomlyselectedgenesinSectionD.4. Theminimumeffect,maximum
effectandregulatoryadjustmenteffectforeachnodeare{α
j
=2,β
j
=0.1,a
j
=10},respectively,
andedgeweightsaresampledfromtherangew
ij
∈(−2,−0.5)∪(0.5,2). ForSERGIO,wefollow
thedefaultparametersspecifiedby[12],whicharegiveninTable2. TheMRisthemasterregulator
ofeachcausalgraph,thatis,thenodewithnoparentsineachgraph. DAGsarerandomlygenerated
accordingtoTable3andidenticalDAGsareusedforbothCausalRegNetandSERGIO.
D.3 BenchmarkStudy
Here,weconductasimulationstudytoexaminetheperformanceofvariousCSLalgorithmsusing
CausalRegNetasoursyntheticdatagenerator.
13Table2: ParametersforsyntheticdatagenerationwithSERGIO.
InteractionStrength k
ij
∼Unif(1,5)
MRBasalProduction b i∼Unif(5,15)
NoiseAmplitude q=1
Decay λ=0.8
HillCoefficient(degreeofnon-linearity) n
ij
=2
Table3: ParametersforDAGgeneration.
Repetitions 10
Graphs ER-m
Nodes d∈{10,20}
Edges m∈{2⋅d,4⋅d}
SamplesPerSetting n=1000
OursimulationstudyincludesadiversesetofCSLmethods. ThePCalgorithm,introducedby[26],is
aconstraint-basedmethod,utilisingconditionalindependencetestingtoidentifythecausalstrucuture
with observational data. [2] developed a continuous optimisation scheme on the space of causal
graphsthroughNO-TEARS.Finally,weincludetheGSPandIGSPmethodsbasedontraversingthe
spaceofsparsestpermutations,whichweredevelopedby[27]and[28],respectively. IGSPisan
interventionalmethodandthuswillbeprovidedbothobservationalandinterventionaldata. Each
methodisimplementedaccordingtothesettingsshowninTable4.
D.3.1 Setting
WeuseanormalisedStructuralHammingDistance(SHD),whichwedefineasSHD/(m⋅d),false
omissionrate(FOR)andfalsediscoveryrate(FDR),toevaluatetheperformanceofeachmethod
onfullgraphretrieval. BoththeErdo˝s-Rényi(ER)andScale-Free(SF)graphstrucuresmethodsare
used. ThefullparametersforgeneratingDAGsthatareusedtogeneratedatawithCausalRegNetare
shownin3. Forobservationalmethods,datacomingfromonlytheobservationalsetting,denotedby
I =∅,isprovided.
Table4: ParametersettingsusedforCSLalgorithmsforthebenchmark.
indep_test = kci
PC stable=True
alpha = 0.05
class = mlp
NO-TEARS
max_iter = 20
ci_test=kci
GSP alpha = 1e-3
depth = 5
ci_test=kci
inv_test = kci
IGSP
alpha = 1e-3
depth = 5
D.3.2 Results
Figure6ashowsthatthenormalisedSHDforallmethodsincreaseswithgraphsize,suggestingthat
thesizeofthegraphsignificantlyincreasesthedifficultyofCSL.Furthermore,thistrendcorresponds
todecreasingspecificityofeachoftheCSLalgorithmsasshownbyincreasingFDRwithgraphsize
inFigure6c. Figure6bshowsthatasthegraphsizegrows,allmethodsarelesslikelytoomitedges
incorrectly,supportingourhypothesisoffallingspecificity. NO-TEARSconsistentlyoutperformsthe
othermethods.
14ER-2
ER-2 ER-2
1.8
0.4 0.9
1.6
0.8
1.4
0.3 0.7
1.2
0.6
1.0 0.2
0.5
0.8
0.1 0.4 Method
ER-4 PC
ER-4 ER-4 NO-TEARS
1.8 GSP
0.4 0.9 IGSP
1.6
0.8
1.4
0.3 0.7
1.2
0.6
1.0 0.2
0.5
0.8
0.1 0.4
10 20
d(NumberofNodes) 10 20 10 20
d(NumberofNodes) d(NumberofNodes)
(a) SHD performance for
(b) FOR performance for (c)FDRperformanceforvariousgraph
various causal graph set-
variousgraphsettings. settings.
tings.
Figure6: ResultsfrombenchmarkwithCausalRegNet.
ThisbenchmarkhighlightsthatdespitethetheoreticalfoundationsofmethodsinCSL,thereexist
settingswhereprovablycorrectassumptions,suchascausalsufficiency,andcausalfaithfulnessare
notenoughtoensuregoodperformance. Thus, theneedfortestingthesensitivityofmethodsto
violationsofmodellingassumptionsinacontext-specificmanneriscrucial.
D.4 SelectingCancerGenes
WeutilisedEntrezDirecttool[29]andPangaea[30]toparseabstractsfromPubMedarticlesusing
thesearchterm"cancer". Fromtheseabstracts,weidentifiedthe100mostcommonlyreferenced
cancer-relatedgenes,whichwerebothperturbedandmeasuredintheReplogledataset.
D.5 CorrelationPatterns
Furthermore,Figure7ashowsthecorrelationbetween100genessimulatedbyCausalRegNetand
theirreal-worldcorrelationin[8]. Theoveralldistributionsofcorrelationhavesimilarshapewhere
they are relatively centered about some mean correlation value. The real data shows a positive
skew,whichsuggeststhatthereismoreupregulationthandownregulationoccurringinthisparticular
setofgenesthanexpected. Forthissimulation,CausalRegNetassumesabalanceddistributionof
upregulators(w
ij
>0)anddownregulators(w
ij
<0). Sometweakingofthisbalancemaybeneeded
toachieveamorecomparabledistributionofcorrelations. Thisskewmayalsobeduetoallgenes
studiedherebeingcancer-related. Therefore,theymaybemorecorrelatedinexpressionthanwould
beexpectedwitharandomsubsetofgenestakenfrom[8]. Furtherworkwouldbeneededtoverify
this.
Wealsolookatthedifferenceincorrelationbetweennodesthathaveadirect causalrelationship
andthosethatdonot. Figure7bshowsthatthereisaclearrelationshipbetweencausallinksand
correlation.
15
DHSdesilamroN
DHSdesilamroN
ROF
ROF
RDF
RDF0.6
CausalRegNet
800 Replogleetal. (2022)
0.4
600 0.2
0.0
400
0.2
200
0.4
0
0.0 0.2 0.4 0.6
Causal Non-causal
Correlation
Relationship Type
(a)Distributionofcorrelationsbetweengenesin (b)Distributionofcorrelationsbetweennodesthat
datasimulatedbyCausalRegNetandrealdatafrom haveadirectcausalcorrelationandthosethatdo
[8]. not.
Figure7: CorrelationpatternsindatageneratedbyCausalRegNet.
D.6 WassersteinDistancebetweenRealandSyntheticData
TheresultsshowninSection4.4showthatsimulatingdatawithfittednegativebinomialparameters
inCausalRegNetleadstobetterthanrandommarginaldistributionfitwhencomparedtorealdata.
Althoughthisistrueforthemajorityofnodes,therecanstillbeoutlierswhensimulatinglargegraphs
asshowninFigure8. Theseoutliersoccurataconstantratethusforsmallergraphs,asmallernumber
ofpoorlyfittingnodeswillappear.
20
15
10
5
0
True Random
Label Assignment
Figure8: DistributionofWassersteindistances
16
tnuoC
DW
noitalerroC
Uni-ELF: A Multi-Level Representation Learning Framework for Electrolyte
Formulation Design
BoshenZeng12 SianChen1 XinxinLiu1 ChanghongChen1 BinDeng1 XiaoxuWang1 ZhifengGao1
YuzhiZhang13 WeinanE34 LinfengZhang13
Abstract
Advancementsinlithiumbatterytechnologyheavilyrelyonthedesignandengineeringofelectrolytes. However,
currentschemesformoleculardesignandrecipeoptimizationofelectrolyteslackaneffectivecomputational-
experimentalclosedloopandoftenfallshortinaccuratelypredictingdiverseelectrolyteformulationproperties. In
thiswork,weintroduceUni-ELF,anovelmulti-levelrepresentationlearningframeworktoadvanceelectrolyte
design. Our approach involves two-stage pretraining: reconstructing three-dimensional molecular structures
at the molecular level using the Uni-Mol model, and predicting statistical structural properties (e.g., radial
distributionfunctions)frommoleculardynamicssimulationsatthemixturelevel. Throughthiscomprehensive
pretraining,Uni-ELFisabletocaptureintricatemolecularandmixture-levelinformation,whichsignificantly
enhancesitspredictivecapability. Asaresult,Uni-ELFsubstantiallyoutperformsstate-of-the-artmethodsin
predictingbothmolecularproperties(e.g.,meltingpoint,boilingpoint,synthesizability)andformulationproperties
(e.g.,conductivity,Coulombicefficiency). Moreover,Uni-ELFcanbeseamlesslyintegratedintoanautomatic
experimentaldesignworkflow. WebelievethisinnovativeframeworkwillpavethewayforautomatedAI-based
electrolytedesignandengineering.
1.Introduction fornext-generationbatterieshingeonmasteringelectrolyte
design.
Lithium-basedrechargeablebatteriesareacornerstoneof
modernenergystoragetechnologies,offeringexceptional Theresearchanddevelopmentofelectrolytespresenttwo
potentialforhighenergydensity,rapidchargingcapabili- primarychallenges:innovatingmoleculardesignandmanip-
ties,andlongevity. Functioningasanionicconductorand ulatingelectrolyteformulation. Thesechallengesstemfrom
electronicinsulatorbetweenelectrodeswhilemaintaining theneedtofine-tunetheelectrolyte’sconductivity10–12,sol-
stabilityunderextremechemicalconditions,theelectrolyte, ubility13–15,stability7,16,andcompatibilitywithelectrode
which interfaces with every other component, plays a vi- materials2,3tomeetstringentperformancecriteria. Unlike
tal role in battery operation1–3. As we enter the era of other fields, such as drug design, which mainly focus on
high-energy-densitybatteriesthatplacehigherdemandson the design and synthesis of monomeric small molecules,
electrolytes, especially with high-voltage cathode materi- thedesignattheelectrolyteformulationlevelisparticularly
als4,5andhigh-energy-densityanodematerialslikelithium crucial. Thisinvolvesprovidingrecommendationsandpre-
metal6,7,thedesignandengineeringofelectrolytesemerge dictionsforthemixingratioofmolecules,includinglithium
asthemainchallenges. Currentelectrolytesystemsbased salts,solvents,andfunctionaladditives. Theinterplaybe-
onethylenecarbonate(EC)areincreasinglyinadequatefor tweenthesedifferentcomponentscansignificantlyaffect
thesenext-generationenergystoragesolutions8,9. Conse- theenergydensity,cyclelife,andoverallperformanceofthe
quently,breakthroughsinmaterialsandchemistriescrucial batteries17,18. Thevarietyofmolecularspacefurtherexac-
erbatesthechallengeforpotentialcandidatesandtheabun-
1DPTechnology, Beijing100080, P.R.China2PekingUni- danceofmixingpossibilities,especiallyinmulti-component
versity, Beijing 100871, P. R. China 3AI for Science Institute,
systems12,13,19. WerefertoFigure1(a)foranillustrationof
Beijing100080,P.R.China4CenterforMachineLearningRe-
electrolytedesignatmultiplelevels.
search and School of Mathematical Sciences, Peking Univer-
sity, Beijing, China. Correspondence to: Linfeng Zhang <lin-
Themethodologiesthatheavilyrelyontrial-and-errorlack
feng.zhang.zlf@gmail.com>.
the efficiency required for the rapid development of elec-
For trial use of Uni-ELF, please refer to the Bohrium App at trolyte systems. Over the past few decades, progress in
https://bohrium.dp.tech/apps/uni-elf computationalapproachessuchasdensityfunctionaltheory
1
4202
luJ
8
]hp-mehc.scisyhp[
1v25160.7042:viXraUni-ELF:AMulti-LevelRepresentationLearningFrameworkforElectrolyteFormulationDesign
(DFT)20,21andmoleculardynamics22hasenabledthedeci- aninnovativeapproachtounifyingrepresentationlearning
pheringofdynamicbehaviorsattheelectronicandatomic tasksforelectrolytesacrossdifferentlevelsbutalsoserves
levels, thereby deducing macroscopic properties through asatimelyandeffectivetoolforintelligentbatterydesign
statisticalmechanics. However,thecomplexnatureinside attheindustrialscale.
batteries,especiallyacrossmultiplescales,hindersacom-
plete understanding of mechanisms, the development of
2.Multi-LevelRepresentationLearning
highlycapableandpredictivesimulators,andtherealization
ofanultimatelyrationaldesignscheme19. Moreover,the In the Uni-ELF scheme, we first acquire molecular and
computational costs originating from the curse of dimen- formulationrepresentationsthroughpretraining. Afterthis
sionality—theO(N3)complexityofDFTwithrespectto phase, the model can be fine-tuned for various tasks by
atoms, and the need for adequate sampling of necessary linkingtheserepresentationstodifferentfittingnetworks.
microscopicstates—arenotcapableofmatchingthehigh- For a visual overview, please refer to Figure 1(b), which
throughputscreeninginindustrialresearchanddevelopment illustratesrepresentationlearningatboththemolecularand
scenarios. formulationlevels.
Ontheotherhand, data-drivenschemessuchasquantita-
2.1.RepresentationLearningatMolecularLevel
tivestructure-propertyrelationshipshavebeendeveloped,
wherein the molecular representation is attained through Themolecule-levelrepresentationlearningapproachisbuilt
feature engineering23–29. The manual design of features uponUni-Mol34,athree-dimensionalmolecularrepresen-
or descriptors requires extensive domain knowledge and tationframeworkthatleveragesself-supervisedpretraining
tendstobedisadvantageouswhenconfrontinglarge-scale to reconstruct molecular structures. As illustrated in Fig-
andhigh-dimensionalproblems. Furthermore,thescarcity ure1(b1),molecules,includingkeyelectrolytecomponents
ofinformativedatamakesthetransferabilityofdata-driven suchaslithiumhexafluorophosphate(LiPF ),ethylmethyl
6
modelsuncertain. Therapidgrowthofdeeplearningtech- carbonate(EMC),ethylenecarbonate(EC),andpropylene
niques,especiallymolecularrepresentationlearningalong carbonate(PC),areencodedusingtheirthree-dimensional
withthepretraining-finetuningparadigm,hasalleviatedthis coordinatesandatomtypes. Theseencodingsarerefinedto
problem30–33. Amongthesemethods,theUni-Molframe- generateatom-pairrepresentationsandatomicrepresenta-
work34, which properly incorporates the 3D information tions. Duringpretraining,themodelunmaskesatomtypes
ofamolecule,hasachievedwidespreadsuccessinaseries anddenoisesatompairdistances. Followingpretrainingon
of chemistry and material science fields, including small 209millionmolecularconformations,weemployaverage
organicmolecules35,organiclight-emittingdiodes36,and
poolingoverallatomicrepresentationstoderivemolecular
metal-organicframeworks37,mostlyfocusingontherela-
representations,whicharesubsequentlyusedforpredicting
tionshipbetweenindividualmoleculesandtheirproperties. molecularpropertiesorservingasinputfortheformulation-
However,asimilarapproachhasbeenlackingatthelevel levelmodel.
offormulations,forwhichexistingattemptsareprimarily
Ingreaterdetail,the3Dstructuresofinputmoleculesare
basedontraditionalregressionmethodologiesandconven-
tionalmachinelearningmodelssuchasrandomforest28and
generatedusingtheMMFF94forcefield39fromRDKit40.
XGBoost38.
TheUni-Molframework34servesastheencoder,compris-
ing 15 layers with an embedding dimension of 512 and
In this study, we introduce the Universal Electrolyte For- afeedforwardnetworkdimensionof2048. Eachencoder
mulation(Uni-ELF)framework,whichexcelsinpredicting layerisequippedwith64attentionheads,utilizingGELU41
electrolytepropertiesanddesigningelectrolyteformulations foractivationandtanh42 forpooleractivation. The[CLS]
throughamulti-levelpretrainingscheme: atthemolecular token43, a virtual atom positioned at the center of mass
level,itreconstructsthree-dimensionalmolecularstructures ofthemolecule,ispreservedtorepresenttheentirestruc-
using the Uni-Mol model; while at the mixture level, it tureinUni-Mol. Thisdesignenablesthemodeltocapture
predictsstatisticalstructuralproperties,suchasradialdistri- long-rangeinteractionsbetweenatoms,particularlywithin
butionfunctions,derivedfrommoleculardynamicssimula- largermolecules. Intasksinvolvingmolecularchargedis-
tions. Systematicexperimentsdemonstratethat,afterpre- tribution—such as predicting the dielectric constant and
training,Uni-ELFexceedsexistingstate-of-the-art(SOTA) refractiveindex—atomicrepresentationsareusedtosimul-
methodsacrossabroadspectrumoftasks,accuratelypre- taneouslypredictGasteigercharges44withinthemolecule,
dicting crucial properties at both molecular and mixture thereby enhancing the model’s ability to capture relevant
levels. TheperformanceofUni-ELFisanticipatedtofur- electrostatic properties. The mean squared error (MSE)
ther improve by integrating physics-driven modeling and ofthepredictedchargesisincludedasalossterm,witha
leveraginghigh-qualitydataacquiredthroughautonomous weightof0.1.
experiments. We posit that Uni-ELF not only represents
2Uni-ELF:AMulti-LevelRepresentationLearningFrameworkforElectrolyteFormulationDesign
Figure1.Electrolyteformulationrepresentationlearningframework.a,Electrolytedesignatmultiplelevels.Attheatomiclevel,
individualatomsandtheirinteractionsformmoleculargeometricstructures,creatingmolecular-levelrepresentations.Basedonthese,
individualmolecularspecies,theirproportions,andtheirinteractions(depictedbyredlines)withinthemixturescreateformulation-level
representations,whicharethenusedtopredictdevice-levelproperties. b,Multi-levelrepresentationlearning: b1. Molecule-level
representationsarelearnedthroughself-supervisedtasks,includingrecoveringmaskedatomtypesanddenoisingatompairdistances.b2.
TheserefinedrepresentationsarethenfedwithmixtureratiosintotheUni-ELFbackbone.c,Uni-ELFbackbonemodelarchitecture.
TheUni-ELFmodelisbasedonatransformerencoderdesign.Molarratiosareusedasweightsformolecularrepresentations,andpair
representationsaremaintainedformixture-levelpretraining.Symmetricalelementsinthepairrepresentationmatrixaresummedand
combinedwiththeradialfeaturesobtainedfromtheGaussiankernel.Thesecombinedfeaturesarethenusedtopredictradialdistribution
functions(RDFs),apretrainingtasktorecoverthestructuralpropertiesofthemixedsystem.
3Uni-ELF:AMulti-LevelRepresentationLearningFrameworkforElectrolyteFormulationDesign
Figure2.PredictionofmolecularpairwiseRDFsasaformulation-levelpretrainingtask,usingtheLiPF /PC/EMCsystemwitha
6
molarratioofn(Li+):n(PF−):n(PC):n(EMC)=0.12:0.12:0.54:0.22asanexample.Theplotscomparethetruevaluesobtained
6
frommoleculardynamics(MD)simulations(blue)withthepredictedvaluesfromtheUni-ELFmodel(orange)forvariousmolecular
pairs:PF−,Li+,PC,andEMC,includingallpairwisecombinationsformingalowertriangularmatrix.Therightpanelillustratesthe
6
systemconfiguration.ThestrongagreementbetweenpredictedandtrueRDFsdemonstratestheaccuracyoftheUni-ELFmodelduring
pretraining.
2.2.RepresentationLearningatFormulationLevel resentationsarethenaggregatedonthebasisoftheirmolar
ratios. For tasks that involve environmental temperature,
Toenhancepredictivecapabilities,theformulationmodel
we introduce a temperature embedding block utilizing a
shouldintegratespecificinductivebiases. Recognizingthat
Gaussian kernel. This block encodes temperature values
entities are characterized not only by their intrinsic prop-
throughasetofevenlydistributedGaussianbasisfunctions
ertiesbutalsobytheirinteractionswithotherentities,the
withspecifiedmeansandstandarddeviations.
modelmustdistinguishbetweenidenticalmolecularspecies
invaryingcontexts. Additionally,itshouldupholdpermu- Themodelundergoespre-trainingtopredictsolutionstruc-
tationinvarianceformolecularinputsequences,ensuring tures,therebylearningformulationrepresentations. Given
consistentoutputregardlessoftheorderofinputs. thescarcityofexperimentaldata,wesupplementthiswith
physicalmodelingtoprovideanadditionalsourceofstruc-
Toachievethesegoals,wedesignedtheUni-ELFbackbone
turaldatafortransferlearning. WithintheUni-ELFframe-
employingatransformerencoderarchitecture,asdepicted
work,moleculardynamicssimulationsgenerateextensive
in Figure 1(b2, c). At the formulation level, the model
data on the trajectories of solution particles. These tra-
processesmolecularrepresentationsweightedbytheirmo-
jectoriesarestatisticallyaveragedtoextractthestructural
lar ratios, refining the representations of both individual
characteristicsofthesolution. Specifically,theradialdistri-
molecularspeciesandtheirinteractions. Theserefinedrep-
butionfunctions(RDFs)providethedensityprobabilityfor
4Uni-ELF:AMulti-LevelRepresentationLearningFrameworkforElectrolyteFormulationDesign
aparticletohaveaneighboratagivendistancer,revealing
thefinestructureofthesolution. TheRDFsofmolecular
pairs(detailedinSupplementaryInformation)areparticu-
larlysuitableforedge-leveltasksusingpairrepresentations
inthetransformerencoder,thuschosenasthedataforthe
pretrainingtask.
Duringpretraining,Uni-ELFreceivesnotonlymolecular
speciesandtheirmolarratiosbutalsoarangeofradialdis-
tancevaluesr. Theseradialdistancesareembeddedusinga
Gaussiankernel. Themodelmaintainspairwiserepresenta-
tionsofmolecularspecies,leveragingthesymmetryinherent
in the RDF between molecules. Specifically, it sums the
attentionrepresentationsofmatrixelementsi,j andj,ito
formthepairwiserepresentation. Thissummedrepresenta-
tionisthenconcatenatedwiththeembeddedradialdistance
valuestopredicttheRDFg (r)forthemolecularpairi,j
ij
Figure3.Comparative performance in predicting molecular
atagivenradialdistancer.
propertiesforelectrolytedesign.Uni-ELF(inpurple)surpasses
InpredictingRDFs,themodelachievesafinaltestsetroot previouslyreportedstate-of-the-art(SOTA)methods(inblue)in
meansquareerror(RMSE)of0.06. AsillustratedinFig- predictingsevenmolecularproperties(meltingpoint,boilingpoint,
vaporpressure, dielectricconstant, refractiveindex, densityon
ure 2, the strong concordance between the predicted and
R²scores,andsynthesizabilityontheAUC),whichareessential
true RDFs for a test set comprising the LiPF /PC/EMC
6
fortheinversemoleculardesignofelectrolytes.Eachconcentric
systemunderscorestheaccuracyoftheUni-ELFmodeldur-
circlerepresentsanintervalof0.05,withtheoutermostboundary
ingpretraining. Thishighlevelofaccuracyinreproducing
correspondingtoaperfectscoreof1.0.
the structural information of the formulations indicates a
promisingtransferoftheselearnedrepresentationstodown-
streampropertypredictiontasks.
WerefertotheSupplementaryInformationformoredetails
To further explore the model’s capability in identifying
offormulation-levelmodelarchitecture,pretrainingscheme,
promising electrolyte molecules, we evaluate its perfor-
aswellasmoleculardynamicssimulations.
mance on molecular synthesizability prediction. Predict-
ing the synthesizability of new molecules is a challeng-
3.ResultsonDownstreamTasks ingtask, oftendependentontheintuitionandexperience
of chemists. Lee et al.29 curated a dataset from QM946,
3.1.Molecule-LevelTasks
comprising126,405entries,toassessmolecularsynthesiz-
Webeginbyleveragingthemolecularrepresentationcapabil- ability. TheyclassifiedQM9moleculesassynthesizableif
itiesofUni-ELFtopredictpropertiescriticalforelectrolyte
theywerelistedineitherthePubChem47oreMolecules48
design. AsillustratedinFigure3,Uni-ELFdemonstrates databases,whileunlistedmoleculeswerepresumedunsyn-
superiorperformancecomparedtostate-of-the-artmethods. thesizable. Inthistask,ourmodelachievesanareaunder
Formeltingpointprediction,itachievesanR²of0.857and thecurve(AUC)of0.965,surpassingthepreviousbestAUC
anRMSEof34.31°C,outperformingthepreviousbench- of 0.95529. Although the absence of a molecule in these
markofR²0.830andRMSE36.88°C45. Intheprediction databasesdoesnotdefinitivelyindicateunsynthesizability,
ofboilingpointsandvaporpressures,Uni-ELFsurpasses itprovidesvaluableinsightsintotherelativeeaseordiffi-
the OPERA model24, with an R² of 0.975 and an RMSE cultyofsynthesis. Bycouplingtheconditionsrequiredfor
of 13.49 °C for boiling points, and an R² of 0.951 and electrolytes,suchasawideliquidrangeandsolubilityfor
anRMSEof0.79Logmm/Hgforvaporpressures. Addi- lithiumsalts,withtrainedmodelsformeltingpoint,boiling
tionally, it exceeds QSPR models in predicting dielectric point,dielectricconstant,andsynthesizability,ourapproach
constant,refractiveindex,anddensity,achievingR²values offersarobustreferenceforevaluatingthepotentialsuitabil-
of0.966,0.982,and0.992,withcorrespondingRMSEsof ityandsyntheticfeasibilityofvirtuallygeneratedmolecules
2.70, 0.082, and 0.025 g/cm³, respectively23,25,26. These aselectrolytes.
results underscore the advantage of representation learn-
We refer to the Supplementary Information for more de-
ingovertraditionalQSPRmethodsinpredictingmolecular
tailsandadditionalbenchmarksonmolecular-leveltasks,
properties.
confirmingthesuperiorperformanceofUni-ELFinvarious
cases.
5Uni-ELF:AMulti-LevelRepresentationLearningFrameworkforElectrolyteFormulationDesign
Method Configuration LCE LiquidElectrolyteConductivity
RandomSplit GroupSplit
Kimetal.28 Randomforest 0.58
One-hotembedding XGBoost 0.246(0.033) 1.53(0.15) 3.15(1.12)
Morganfingerprint XGBoost 0.231(0.027) 1.35(0.08) 3.11(0.49)
Uni-Molfingerprint XGBoost 0.228(0.027) 1.23(0.09) 2.82(0.56)
w/opretraining 0.215(0.021) 0.53(0.02) 2.49(0.63)
Uni-ELF
w/pretraining 0.184(0.019) 0.50(0.02) 2.15(0.35)
Table1.RMSEresultsontheCoulombicefficiencyandliquidelectrolyteconductivitydatasetsfordifferentmethodsandconfigu-
rations,withthebestRMSEdenotedinbold.Therandomsplitcolumnrepresentsthedatarandomlydividedintotrainingandtest
sets,whilethegroupsplitcolumnrepresentsthedatagroupedbyformulationsystemscontainingidenticalsetsofmolecularspeciesand
randomlysplitintotrainingandtestsetsaccordingtotheirgroup.Resultsarereportedasthemeanofthreeindependentexperiments,with
standarddeviationinparentheses.
Figure4.RegressionplotsforelectrolyteformulationpropertypredictionusingUni-ELF.(a)ResultsoftheCoulombicefficiency
dataset.(b,c)Liquidelectrolyteconductivitydataset,with(b)representingtherandomsplitand(c)thegroupsplit.Theregressionplots
showtheparitybetweenexperimentalandpredictedvaluesinthetestsets,withinsetsshowingtheresultsinthetrainingsets.Toillustrate
datadistribution,kerneldensityestimationisdisplayedatthetopandrightofeachplot. Thecolorgradientsintheplotsindicatethe
magnitudeofpredictionerrors.
3.2.Formulation-LevelTasks topredictnovelformulationsystems,weemployedanad-
ditional group split method for the conductivity dataset.
To validate the efficacy of our multi-level representation
Inthismethod,datafromformulationsystemscontaining
learningarchitectureandtransferlearningstrategyforpre-
identicalsetsofmolecularspeciesweregroupedandthen
dicting solution structures, we applied the framework to
randomly divided into training and test sets according to
thepredictionofelectrolyteformulationproperties. Specifi-
thesegroups. Weutilizedfive-foldcross-validationduring
cally,wereviewedandcorrectedtwodatasetsfromoriginal
trainingtoenhancethemodel’srobustness. Thefinalmodel
sources:oneonCoulombicefficiency(CE)forlithiummetal
was an ensemble of the five models trained in each fold,
anodebatteries28,andanotheronelectrolyteconductivity27.
withperformancemetricsderivedfromtheaveragedtestset
FortheCoulombicefficiencydataset,weremovedanentry
predictions.
witharepeatedratiobutdifferentmeasurementmethodsand
values,andcorrectederrorsinsomeratiosandmolecular Weestablishseveralbaselinemethodsforconstructingfor-
information. This resulted in a refined dataset consisting mulation fingerprints at both the molecular and formula-
of149entriesoflogarithmicCoulombicefficiency(LCE, tionlevels,utilizingXGBoost38 forregressionprediction.
defined as −log(1−CE)). For the conductivity dataset, Thesemethodsinclude: one-hotencodingforalltypesof
errorsweresimilarlycorrected,andpolymerswerefiltered moleculesinthedataset,wheretheformulationfingerprint
outtofocusonliquidelectrolytes. Thefinalconductivity containsonlymolecularspeciesandratioinformationwith-
dataset,curatedatvarioustemperatures,consistedof2,588 outanymolecularorsolutionstructuredetails;Morganfin-
entries. gerprintsforencodingmolecularstructures49;andUni-Mol
fingerprintsderivedfromtheUni-Molpre-trainedmodel34,
Both datasets were split into training and test sets using
whichdonotdynamicallyadjustfeatures. Toenhancepre-
a 7:3 ratio. Additionally, to evaluate the model’s ability
dictive accuracy in the electrolyte scenario, we partition
6Uni-ELF:AMulti-LevelRepresentationLearningFrameworkforElectrolyteFormulationDesign
the formulation fingerprint into solvent and salt compo- 4.Applications
nents. Specifically, the fingerprints of molecules or ions
Althoughacomprehensivecomputational-experimentalval-
are weighted by their molar ratios to generate the corre-
idationisdeferredtofuturestudiesduetoassociatedcosts,
spondingparts’fingerprints,whicharethenconcatenatedto
wepresentthepotentialofUni-ELFformolecularandfor-
formthecompleteformulationfingerprint. Additionally,for
mulationdesignviaaconceptualapplication.Inthiscontext,
theconductivitydataset, temperatureisincorporatedasa
weillustratetherediscoveryoffluoroacetonitrile(FAN),a
one-dimensionalfeaturewithintheformulationfingerprint.
high-conductivitysolventsystemrecentlyreportedbyLuet
Asummaryoftheperformanceofvariousmolecularrep- al. inNature3,withminimalconstraintsonthemolecular
resentationschemesondifferenttasksisprovidedinTable searchspace. Westartbyconstrainingthesearchspaceto
1. Notably, all the discussed schemes significantly out- moleculesthatareorganicaproticsolventscontainingcyano
perform recent work by Kim et al.28. Across all tasks, a andfluorogroups,incorporatingatleastafour-membered
consistenttrendinperformanceisobserved: thepre-trained ringifcyclic,andcomprisinguptoeightheavyatoms.Com-
Uni-ELFmodelachievesthebestresults,followedbythe patibilitywithhigh-voltagecathodesisensuredbythein-
non-pre-trainedUni-ELFmodel,thentheUni-Molfinger- clusion of electron-withdrawing cyano (–C–––N) groups,
print,Morganfingerprint,andfinally,theone-hotembed- whileanodecompatibilityisfacilitatedbyfluorinated(–F)
ding. Forinstance,ontheLCEdataset,thepre-trainedUni- groups.
ELFmodelachievesanRMSEof0.184,reducingtheerror
AsshowninFigure5(a),theconceptualexperimentapplies
byapproximately14%comparedtothenon-pre-trainedUni-
threeobjectives: highionicconductivityforfastcharging,
ELFmodel,whichhasanRMSEof0.215. Similarly,for
wide liquid range for the solvent, and ease of synthesis,
the conductivity dataset, the pre-trained Uni-ELF model
alongside four constraints mentioned above. To address
achievesanRMSEof0.50mS/cm(randomsplit)and2.15
theseconstraints,webeginbyemployinggraphtheoryto
mS/cm(groupsplit),reducingtheerrorbyabout6%and
enumeratepotentialmolecules, startingwithformonitrile
13%,respectively,comparedtothenon-pre-trainedUni-ELF
model.
(H–C–––N). Utilizingabreadth-firstsearch(BFS),wepro-
gressivelyaddcarbon(C),oxygen(O),orfluorine(F)atoms
Thealignmentoftheseperformanceresultswithintuitive tothechain. Duplicatesarefilteredoutonthebasisofgraph
expectationsisevident. One-hotembeddings,beingsimple isomorphism, and the search continues until we generate
numerical representations without structural information, chainmoleculescontaininguptoeightheavyatoms. Subse-
performtheworst.Morganfingerprints,whichcapturesome quently,weenumerateallpossibleconfigurationstoform
molecular-levelfeatures,showmoderateimprovement. Uni- 4-6memberedrings,againeliminatingduplicates. Unstable
Mol fingerprints, containing richer molecular structures, structures,suchasthosecontainingO-Obonds,orproton
furtherenhanceperformance. Thesuperioroutcomesofthe groupsunsuitableforuseaselectrolytes,suchascarboxyl
non-pre-trainedUni-ELFmodeloverUni-Molfingerprints groups,arediscarded,resultinginasetof1,165candidate
with XGBoost highlight the efficacy of the transformer- molecules. Thisentiresearchprocessiscompletedinunder
basedUni-ELFarchitecture. Finally, thepre-trainedUni- 30secondsonastandardcomputerCPU.
ELF model, which incorporates even richer formulation-
Followingtheidentificationof1,165candidatemolecules,
levelstructuralinformation,achievesthebestperformance
weemployedUni-ELFmodelstoefficientlyscreenthese
acrossalltasks.
compoundsfortheirmolecularandformulationproperties.
AsillustratedinFigure4,theagreementbetweenUni-ELF Molecularlevelproperties,includingmeltingpoint,boiling
predictionsandexperimentalresultsisevident. Specifically, point, synthetic accessibility (synthesizability), and elec-
Figure4(c)showsthatwhileagroupsplitmayintroduce trolyteconductivity,arepredictedusingUni-ELFtrainedby
moredeviations—sincesometesteddatabelongtogroups publiclyavailabledata,withlittledirectinformationofthe
notpresentinthetrainingdata—thepredictionsstillmain- 1,165candidates. Attheformulationlevel,wegenerateda
tain a consistent trend. This demonstrates the robustness gridof120formulationpointsbysystematicallycombin-
oftheUni-ELFmodelinhandlingdiversedatasetsandits ingeachmoleculewithLiPF ,LiTFSI,andLiFSIsaltsat
6
abilitytogeneralizewellevenunderchallengingconditions. varyingconcentrations. Thisapproachenabledustopredict
the room temperature conductivity for each formulation,
Inconclusion, thepre-trainedUni-ELFmodelsetsanew
providingarobustbasisforchemiststoestablishevaluation
benchmarkforpredictiveaccuracyinthisdomain,demon-
criteriaforsubsequentexperimentaltesting.
stratingthecriticalimportanceofcapturingcomprehensive
molecularand formulation-levelinformation forsuperior Wefilterandrankthemoleculesusingthefollowingcrite-
performanceindownstreamtasks. ria: (1)predictedmeltingpoint≤ 40◦Candboilingpoint
≥40◦C;(2)presenceinPubChem47orCAS,orsynthetic
accessibilityprobability≥90%;(3)highestpredictedroom
7Uni-ELF:AMulti-LevelRepresentationLearningFrameworkforElectrolyteFormulationDesign
Figure5.ConceptualelectrolytedesignusingUni-ELF.a,Set-upoftheconceptualexperiment:Theobjectiveistoachievehighionic
conductivity,awideliquidrange,andeaseofsynthesis.Themolecularspacetosearchisconstrainedbysomepracticalexpertcriteria.
b,1,165candidatesgeneratedbygraph-theoreticenumeration,visualizedusingt-SNE50 toreducemolecularrepresentationstotwo
dimensions,andcolor-codedbypredictedmaximumconductivityandsynthesizability.Theredcirclehighlightsthehigh-conductivity
FAN(fluoroacetonitrile)moleculediscoveredbythemodel,whilethebluecirclehighlightsaseriesoffour-memberedringmolecules
withhighpredictedconductivitybutlowpredictedsynthesizability,whichwerethusscreenedout.c,Top10moleculesfromzero-shot
formulation-levelprediction,emphasizingFAN’ssuperiorperformance.Positiveandnegativevaluesindicatemodel-predictedstandard
deviations, with parentheses showing experimental values. d, Few-shot learning: Conductivity vs. concentration and temperature
forLiFSI/FANandLiTFSI/FANsystems.Themodelaccuratelypredictstheconductivity-concentrationrelationshipusingdatafrom
onlythreeexperimentalpoints: theinitialconcentrationpoint(0.1M),thefinalconcentrationpoint(4M),andthepeakconductivity
concentrationpoint(1.3MforLiFSI/FANand1.2MforLiTFSI/FAN)predictedbythemodel,whichnotablyalignswiththeexperimental
results.Fortheconductivity-temperaturerelationship,themodelaccuratelypredictsthehighconductivityperformanceofFANatlow
temperatures,fittingwelltotheArrheniusrelationship(redtext).
8Uni-ELF:AMulti-LevelRepresentationLearningFrameworkforElectrolyteFormulationDesign
temperatureconductivityamongallformulations. Through ing avenue for future integration into robotic automated
predictionandscreening,weidentifythetop10candidate experimentation.
molecules,showninFigure5(c). Thetop-rankedmolecule
isfluoroacetonitrile(FAN),withapredictedmaximumroom
5.ConclusionandOutlook
temperatureconductivityof26.35mS/cm,significantlysur-
passing the second-ranked molecule. According to Lu et In this work, we have introduced Uni-ELF, a multi-
al.3,FANexhibitsahighionicconductivityof40.3mS/cm level representation learning framework designed to ad-
asalithium-ionelectrolyte. Notably,FANwasnotpresent vance the formulation and optimization of electrolytes
inthemodel’strainingdatasets,suggestingthatthemodel for lithium batteries. By leveraging a two-stage pretrain-
independently identified FAN as a promising electrolyte ingapproach—reconstructingthree-dimensionalmolecular
material. structuresusingtheUni-Molmodelandpredictingstatisti-
calstructuralpropertiesfrommoleculardynamicssimula-
Using additional data published by Lu et al.3, we fur-
tions—wehavedemonstratedsignificantimprovementsin
therexplorethefew-shotgeneralizationcapabilityofUni-
predictivecapabilitiesforbothmolecularandformulation
ELF. As shown in Figure 5, after few-shot learning with
properties.
3 data points—corresponding to the endpoint concen-
trations (0.1 and 4 M) and the concentration with the OurresultsshowthatUni-ELFoutperformscurrentstate-of-
highestpredictedconductivity—themodelaccuratelypre- the-artmethodsinpredictingkeypropertiessuchasmelt-
dictstheconductivity-concentrationrelationshipsforboth ingpoint,boilingpoint,synthesizability,conductivity,and
LiFSI/FANandLiTFSI/FANsystems. Weperform10-fold Coulombicefficiency. Notably,Uni-ELFcanbeseamlessly
cross-validation,train10models,andaveragetheirpredic- integratedintoanautomaticexperimentaldesignworkflow,
tions. Theuncertaintyvaluesareprovidedbythestandard bridging the gap between computational predictions and
deviation,andthecurvesfittingtheexperimentalandpre- experimentalvalidation.
dictedvaluesaredisplayedusingafourth-orderpolynomial.
Looking forward, the methodology presented here holds
Inthelowconcentrationregion,thetwocurvesalmostcoin-
promiseforbroaderapplicationsbeyondelectrolytedesign.
cide;inthehighconcentrationregion,themodel’spredic-
Forexample,thisapproachcouldbeextendedtootherareas
tionuncertaintyishigher,whichcanbeattributedtofewer
requiringformulation-levelpredictionorgeneration,such
highconcentrationdatapointsinthetrainingdataset.
asthedesignofpharmaceuticalsandtheextractionoffor-
Furthermore,weusedthemodeltopredicttheconductivity- mulationinformationfromspectraldata. Weareoptimistic
temperaturerelationshipattheconcentrationwiththehigh- thatfurtherrefinementandvalidationofthisframeworkwill
estconductivityforbothLiFSI/FANandLiTFSI/FANsys- enhanceitsutilityandimpactacrossvariousscientificand
tems,asshowninFigure5. Usingonly1datapoint—the engineeringdomains.
roomtemperaturedata—forretraining,themodelsuccess-
fully predicts the high ionic conductivity performance of
DataandCodeAvailability
the LiFSI/FAN system at low temperatures. We fit the
modelpredictionsforbothsystemsusingtheArrheniusre- Data and code used in this work will be made publicly
lationship, obtaining ln(σ) =
−0.698×(cid:0)1000(cid:1)
+5.962 available after the paper is published. For trial use of
T
(R2 = 0.983) for LiFSI/FAN and ln(σ) = −1.131 × Uni-ELF, please refer to the Bohrium App at https:
(cid:0)1000(cid:1) +6.797 (R2 = 0.994) for LiTFSI/FAN. This in- //bohrium.dp.tech/apps/uni-elf.
T
dicatesthatthemodeleffectivelylearnstheArrheniusrela-
tionshipofconductivitywithtemperaturefromtheoriginal
ConflictofInterests
datasetandsuccessfullytransfersthisknowledgetotheFAN
system. DPTechnologyholdsintellectualpropertyrightspertinent
totheresearchpresentedherein.
In summary, Uni-ELF demonstrates the ability to effec-
tively integrate physical modeling and publicly available
experimentaldatatoachieveaccuratepredictionsofmolec- References
ularandformulation-levelproperties. Thispredictiveaccu-
[1] Y.S.Meng,V.Srinivasan,andK.Xu.Designingbetter
racyenabledthemodeltoindependentlyrediscoverhigh-
electrolytes. Science,378(6624):eabq3750,2022.
performingmoleculeslikeFAN,underscoringUni-ELF’s
potentialinadvancingelectrolytedesign. Furthermore,the
capability of Uni-ELF to perform few-shot learning sug- [2] JijianXu,JiaxunZhang,TravisP.Pollard,Qingdong
gests its potential for low-cost, efficient optimization of Li, Sha Tan, Singyuk Hou, Hongli Wan, Fu Chen,
high-dimensionalformulationspaces,presentingapromis- HuixinHe, EnyuanHu, KangXu, Xiao-QingYang,
OlegBorodin,andChunshengWang. Electrolytede-
9Uni-ELF:AMulti-LevelRepresentationLearningFrameworkforElectrolyteFormulationDesign
signforli-ionbatteriesunderextremeoperatingcondi- [12] AdarshDave,JaredMitchell,SvenBurke,HongyiLin,
tions. Nature,614(7949):694–700,2023. JayWhitacre,andVenkatasubramanianViswanathan.
Autonomousoptimizationofnon-aqueousli-ionbat-
[3] Di Lu, Ruhong Li, Muhammad Mominur Rahman,
teryelectrolytesviaroboticexperimentationandma-
PengyunYu, LingLv, ShengYang, YiqiangHuang,
chine learning coupling. Nature Communications,
Chuangchao Sun, Shuoqing Zhang, Haikuo Zhang,
13(1):5454,2022.
JunboZhang,XuezhangXiao,TaoDeng,LiwuFan,
LixinChen,JianpingWang,EnyuanHu,Chunsheng [13] JuranNoh,HieuA.Doan,HeatherJob,LilyA.Robert-
Wang,andXiulinFan. Ligand-channel-enabledultra- son, Lu Zhang, Rajeev S. Assary, Karl Mueller, Vi-
fast li-ion conduction. Nature, 627(8002):101–107, jayakumar Murugesan, and Yangang Liang. An in-
2024. tegratedhigh-throughputroboticplatformandactive
learning approach for accelerated discovery of opti-
[4] JohnB.GoodenoughandYoungsikKim. Challenges
malelectrolyteformulations. NatureCommunications,
forrechargeablelibatteries. ChemistryofMaterials,
15(1):2757,2024.
22(3):587–603,2010. Publisher: AmericanChemical
Society.
[14] JunerChen,HanZhang,MingmingFang,Changming
[5] Hongli Wan, Jijian Xu, and Chunsheng Wang. De- Ke,ShiLiu,andJianhuiWang. Designoflocalized
signingelectrolytesandinterphasesforhigh-energy high-concentrationelectrolytesviadonornumber.ACS
lithiumbatteries. NatureReviewsChemistry,8(1):30– EnergyLetters,8(4):1723–1734,2023.
44,2024.
[15] NanYao,XiangChen,XinShen,RuiZhang,Zhong-
[6] X.-B. Cheng, R. Zhang, C.-Z. Zhao, and Q. Zhang. HengFu,Xia-XiaMa,Xue-QiangZhang,Bo-Quan
Towardsafelithiummetalanodeinrechargeablebat- Li,andQiangZhang. Anatomicinsightintothechem-
teries: Areview. Chem.Rev.,117(15):10403–10473, icaloriginandvariationofthedielectricconstantin
2017. liquidelectrolytes. AngewandteChemieInternational
Edition,60(39):21473–21478,2021.
[7] ZhiaoYu,HansenWang,XianKong,WilliamHuang,
YuchiTsao,DavidG.Mackanic,KechengWang,Xin-
[16] Yu-ChenGao,NanYao,XiangChen,LegengYu,Rui
changWang,WenxiaoHuang,SnehashisChoudhury,
Zhang,andQiangZhang. Data-driveninsightintothe
Yu Zheng, Chibueze V. Amanchukwu, Samantha T.
reductivestabilityofion–solventcomplexesinlithium
Hung,YutingMa,EderG.Lomeli,JianQin,YiCui,
batteryelectrolytes.JournaloftheAmericanChemical
andZhenanBao. Moleculardesignforelectrolytesol-
Society,145(43):23764–23770,2023.
ventsenablingenergy-denseandlong-cyclinglithium
metalbatteries. NatureEnergy,5(7):526–533,2020. [17] Yang Yang, Wuhai Yang, Huijun Yang, and
Haoshen Zhou. Electrolyte design principles for
[8] K.Xu. Electrolytesandinterphasesinli-ionbatteries
low-temperature lithium-ion batteries. eScience,
andbeyond. Chem.Rev.,114(23):11503–11618,2014.
3(6):100170,2023.
[9] YuankunWang,ZhimingLi,YunpengHou,Zhimeng
[18] MingnanLi,CaoyuWang,KennethDavey,JingxiLi,
Hao, Qiu Zhang, Youxuan Ni, Yong Lu, Zhenhua
GuanjieLi,ShilinZhang,JianfengMao,andZaiping
Yan,KaiZhang,QingZhao,FujunLi,andJunChen.
Guo. Recent progress in electrolyte design for ad-
Emerging electrolytes with fluorinated solvents for
rechargeablelithium-basedbatteries. ChemicalSoci- vancedlithiummetalbatteries. SmartMat,4(5):e1185,
etyReviews,52(8):2713–2763,2023. 2023.
[10] M. S. Ding, K. Xu, S. S. Zhang, K. Amine, G. L. [19] N. Yao, X. Chen, Z.-H. Fu, and Q. Zhang. Apply-
Henriksen,andT.R.Jow.Changeofconductivitywith ingclassical,abinitio,andmachine-learningmolecu-
saltcontent,solventcomposition,andtemperaturefor lardynamicssimulationstotheliquidelectrolytefor
electrolytesoflipf6inethylenecarbonate-ethylmethyl rechargeablebatteries. Chem.Rev.,122:10970–11021,
carbonate. Journal of The Electrochemical Society, 2022.
148(10):A1196,2001.
[20] WalterKohnandLuJeuSham. Self-consistentequa-
[11] Alexandre Ponrouch, Elena Marchante, Matthieu tionsincludingexchangeandcorrelationeffects. Phys-
Courty,Jean-MarieTarascon,andM.RosaPalac´ın. In icalReview,140(4A):A1133,1965.
searchofanoptimizedelectrolyteforna-ionbatteries.
EnergyandEnvironmentalScience,5(9):8572–8583, [21] P.HohenbergandW.Kohn. Inhomogeneouselectron
2012. gas. PhysicalReview,136(3B):B864–B871,1964. PR.
10Uni-ELF:AMulti-LevelRepresentationLearningFrameworkforElectrolyteFormulationDesign
[22] MarkETuckerman. Statisticalmechanics: theoryand [30] KevinYang,KyleSwanson,WengongJin,ConnorW
molecularsimulation. Oxforduniversitypress,2023. Coley, Peter Eiden, Hua Gao, Armando Guzman-
Perez, Tara Hopper, BryanKelley, MichaelMathea,
[23] DidierMathieuandRe´miBouteloup.ReliableandVer- etal. Analyzinglearnedmolecularrepresentationsfor
satileModelfortheDensityofLiquidsBasedonAd- propertyprediction. JournalofChemicalInformation
ditiveVolumeIncrements. Industrial&Engineering andModeling,59(8):3370–3388,2019.
ChemistryResearch,55(50):12970–12980,December
[31] BensonChen,ReginaBarzilay,andTommiJaakkola.
2016. Publisher: AmericanChemicalSociety.
Path-augmented graph transformer network. arXiv
[24] Kamel Mansouri, Chris M. Grulke, Richard S. Jud- preprintarXiv:1905.12712,2019.
son,andAntonyJ.Williams. OPERAmodelsforpre-
[32] ThomasNKipfandMaxWelling. Semi-supervised
dictingphysicochemicalpropertiesandenvironmental
classificationwithgraphconvolutionalnetworks. In
fateendpoints. JournalofCheminformatics,10(1):10,
InternationalConferenceonLearningRepresentations
March2018.
(ICLR),2017.
[25] Re´miBouteloupandDidierMathieu. Improvedmodel [33] Petar Velivckovic, Guillem Cucurull, Arantxa
fortherefractiveindex: applicationtopotentialcom- Casanova,AdrianaRomero,PietroLio,andYoshua
ponentsofambientaerosol.PhysicalChemistryChem- Bengio. Graph attention networks. arXiv preprint
icalPhysics,20(34):22017–22026,August2018. Pub- arXiv:1710.10903,2017.
lisher: TheRoyalSocietyofChemistry.
[34] Gengmo Zhou, Zhifeng Gao, Qiankun Ding, Hang
[26] Re´miBouteloupandDidierMathieu. Predictingdi- Zheng, Hongteng Xu, Zhewei Wei, Linfeng Zhang,
andGuolinKe. Uni-mol: Auniversal3dmolecular
electricconstantsofpureliquids:fragment-basedKirk-
wood–Fro¨hlich model applicable over a wide range
representationlearningframework.InTheEleventhIn-
of polarity. Physical Chemistry Chemical Physics,
ternationalConferenceonLearningRepresentations,
2023.
21(21):11043–11057,2019.
[35] Shuqi Lu, Zhifeng Gao, Di He, Linfeng Zhang,
[27] Gabriel Bradford, Jeffrey Lopez, Jurgis Ruza,
and Guolin Ke. Highly accurate quantum chemical
MichaelA.Stolberg,RichardOsterude,JeremiahA.
property prediction with uni-mol+. arXiv preprint
Johnson,RafaelGomez-Bombarelli,andYangShao-
arXiv:2303.16982,2023.
Horn. Chemistry-Informed Machine Learning for
PolymerElectrolyteDiscovery. ACSCentralScience, [36] ZhengCheng,JiapengLiu,TongJiang,MohanChen,
9(2):206–216,February2023. Publisher: American Fuzhi Dai, Zhifeng Gao, Guolin Ke, Zifeng Zhao,
ChemicalSociety. andQiOu. Automaticscreen-outofir(iii)complex
emitters by combined machine learning and com-
[28] Sang Cheol Kim, Solomon T. Oyakhire, Constan- putational analysis. Advanced Optical Materials,
tineAthanitis,JingyangWang,ZewenZhang,Wenbo 11(18):2301093,2023.
Zhang,DavidT.Boyle,MunSekKim,ZhiaoYu,Xin
[37] JingqiWang,JiapengLiu,HongshuaiWang,Musen
Gao,TomiSogade,EstherWu,JianQin,ZhenanBao,
Zhou, Guolin Ke, Linfeng Zhang, Jianzhong Wu,
Stacey F. Bent, and Yi Cui. Data-driven electrolyte
Zhifeng Gao, and Diannan Lu. A comprehensive
designforlithiummetalanodes. Proceedingsofthe
transformer-basedapproachforhigh-accuracygasad-
NationalAcademyofSciences,120(10):e2214357120,
sorptionpredictionsinmetal-organicframeworks. Na-
March 2023. Company: National Academy of Sci-
tureCommunications,15(1):1904,March2024. Pub-
encesDistributor: NationalAcademyofSciencesIn-
lisher: NaturePublishingGroup.
stitution: NationalAcademyofSciencesLabel: Na-
tionalAcademyofSciencesPublisher: Proceedingsof
[38] TianqiChenandCarlosGuestrin.Xgboost:Ascalable
theNationalAcademyofSciences.
treeboostingsystem. InProceedingsofthe22ndACM
SIGKDDInternationalConferenceonKnowledgeDis-
[29] Andrew S. Lee, Sarah Elliott, Hassan Harb, Logan
covery and Data Mining, KDD ’16. ACM, August
Ward,IanFoster,LarryCurtiss,andRajeevS.Assary.
2016.
Emin: AFirst-PrinciplesThermochemicalDescriptor
for Predicting Molecular Synthesizability. Journal [39] Thomas A Halgren. Merck molecular force field. i.
ofChemicalInformationandModeling,64(4):1277– basis,form,scope,parameterization,andperformance
1289,February2024. Publisher: AmericanChemical ofmmff94. Journalofcomputationalchemistry,17(5-
Society. 6):490–519,1996.
11Uni-ELF:AMulti-LevelRepresentationLearningFrameworkforElectrolyteFormulationDesign
[40] GregLandrum. Rdkit: Open-sourcecheminformatics, [52] AshishVaswani,NoamShazeer,NikiParmar,Jakob
2016. Release2023 03 1. Uszkoreit, Llion Jones, Aidan N Gomez, Lukasz
Kaiser,andIlliaPolosukhin. Attentionisallyouneed.
[41] Dan Hendrycks and Kevin Gimpel. Gaussian error InAdvancesinneuralinformationprocessingsystems,
linearunits(gelus). arXivpreprintarXiv:1606.08415, pages5998–6008,2017.
2016.
[53] KaimingHe,XiangyuZhang,ShaoqingRen,andJian
[42] Yann LeCun, Yoshua Bengio, and Geoffrey Hinton. Sun. Deep residual learning for image recognition.
Deeplearning. nature,521(7553):436–444,2015. InProceedingsoftheIEEEconferenceoncomputer
visionandpatternrecognition,pages770–778,2016.
[43] Jacob Devlin, Ming-Wei Chang, Kenton Lee, and
KristinaToutanova. BERT:Pre-trainingofdeepbidi-
[54] MarkJamesAbraham,TeemuMurtola,RolandSchulz,
rectionaltransformersforlanguageunderstanding. In Szila´rd Pa´ll, Jeremy C. Smith, Berk Hess, and Erik
JillBurstein,ChristyDoran,andThamarSolorio,edi-
Lindahl. Gromacs: Highperformancemolecularsim-
tors,Proceedingsofthe2019ConferenceoftheNorth
ulationsthroughmulti-levelparallelismfromlaptops
American Chapter of the Association for Computa-
tosupercomputers. SoftwareX,1:19–25,2015.
tional Linguistics: Human Language Technologies,
Volume1(LongandShortPapers),pages4171–4186, [55] Junmei Wang, Wei Wang, Peter A. Kollman, and
Minneapolis,Minnesota,June2019.Associationfor DavidA.Case. Automaticatomtypeandbondtype
ComputationalLinguistics. perceptioninmolecularmechanicalcalculations. Jour-
nalofMolecularGraphicsandModelling,25(2):247–
[44] Johann Gasteiger and Mario Marsili. Iterative par-
260,2006.
tialequalizationoforbitalelectronegativity—arapid
accesstoatomiccharges. Tetrahedron,36(22):3219– [56] AlanW.SousadaSilvaandWimF.Vranken. Acpype
3228,1980. -antechamberpythonparserinterface. BMCResearch
Notes,5(1):367,2012.
[45] WeimingMi,HuijunChen,Donghua(Alan)Zhu,Tao
Zhang,andFengQian. Meltingpointpredictionofor- [57] M. J. Frisch, G. W. Trucks, H. B. Schlegel, G. E.
ganicmoleculesbydecipheringthechemicalstructure Scuseria, M. A. Robb, J. R. Cheeseman, G. Scal-
intoanaturallanguage. ChemicalCommunications, mani, V. Barone, G. A. Petersson, H. Nakatsuji,
57(21):2633–2636,March2021.Publisher:TheRoyal X. Li, M. Caricato, A. V. Marenich, J. Bloino,
SocietyofChemistry. B. G. Janesko, R. Gomperts, B. Mennucci, H. P.
Hratchian, J. V. Ortiz, A. F. Izmaylov, J. L. Son-
[46] RaghunathanRamakrishnan,PavloO.Dral,Matthias
nenberg, D. Williams-Young, F. Ding, F. Lipparini,
Rupp,andO.AnatolevonLilienfeld. Quantumchem-
F.Egidi,J.Goings,B.Peng,A.Petrone,T.Henderson,
istrystructuresandpropertiesof134kilomolecules.
D. Ranasinghe, V. G. Zakrzewski, J. Gao, N. Rega,
ScientificData,1(1):140022,2014.
G. Zheng, W. Liang, M. Hada, M. Ehara, K. Toy-
ota,R.Fukuda,J.Hasegawa,M.Ishida,T.Nakajima,
[47] S.Kim,J.Chen,T.Cheng,A.Gindulyte,J.He,S.He,
Y.Honda,O.Kitao,H.Nakai,T.Vreven,K.Throssell,
Q.Li,B.A.Shoemaker,P.A.Thiessen,B.Yu,L.Za-
J.A.Montgomery,Jr.,J.E.Peralta,F.Ogliaro,M.J.
slavsky,J.Zhang,andE.E.Bolton. Pubchem2023
Bearpark,J.J.Heyd,E.N.Brothers,K.N.Kudin,V.N.
update. Nucleic Acids Res., 51(D1):D1373–D1380,
Staroverov, T. A. Keith, R. Kobayashi, J. Normand,
2023.
K. Raghavachari, A. P. Rendell, J. C. Burant, S. S.
Iyengar,J.Tomasi,M.Cossi,J.M.Millam,M.Klene,
[48] Inc.eMolecules. emoleculesdatabase,2023.
C.Adamo,R.Cammi,J.W.Ochterski,R.L.Martin,
[49] David Rogers and Mathew Hahn. Extended- K. Morokuma, O. Farkas, J. B. Foresman, and D. J.
connectivityfingerprints. Journalofchemicalinfor- Fox. Gaussian˜16RevisionB.01,2016. GaussianInc.
mationandmodeling,50(5):742–754,2010. WallingfordCT.
[50] LaurensvanderMaatenandGeoffreyHinton. Visual- [58] Tian Lu and Feiwu Chen. Multiwfn: A multifunc-
izingdatausingt-sne. JournalofMachineLearning tional wavefunction analyzer. Journal of Computa-
Research,9(86):2579–2605,2008. tionalChemistry,33(5):580–592,2012.
[51] Jimmy Lei Ba, Jamie Ryan Kiros, and Geoffrey E [59] IgorV.Tetko,YuriiSushko,SergiiNovotarskyi,Luc
Hinton. Layer normalization. arXiv preprint Patiny,IvanKondratov,AlexanderE.Petrenko,Larisa
arXiv:1607.06450,2016. Charochkina,andAbdullahM.Asiri. HowAccurately
12Uni-ELF:AMulti-LevelRepresentationLearningFrameworkforElectrolyteFormulationDesign
CanWePredicttheMeltingPointsofDrug-likeCom-
pounds? JournalofChemicalInformationandMod-
eling,54(12):3320–3329,December2014. Publisher:
AmericanChemicalSociety.
[60] Jean-ClaudeBradley,AntonyWilliams,andAndrew
Lang. Jean-claudebradleyopenmeltingpointdataset.
figshare.Dataset,2014.
[61] Takuya Akiba, Shotaro Sano, Toshihiko Yanase,
TakeruOhta,andMasanoriKoyama. Optuna: Anext-
generation hyperparameter optimization framework.
InThe25thACMSIGKDDInternationalConference
onKnowledgeDiscovery&DataMining,pages2623–
2631,2019.
13Uni-ELF:AMulti-LevelRepresentationLearningFrameworkforElectrolyteFormulationDesign
SupplementaryInformation
Formulation-LevelModelArchitecture
TheUni-ELFbackboneconsistsofthreemainparts: thetemperatureembeddingblock,theformulationtransformerencoder,
andthemolecularpairRDFblock(seeFigure1(c)).
Temperature Embedding Block: The temperature input is transformed using a Gaussian kernel followed by layer
normalization51. TheGaussiankernelembedsthetemperaturevalueintoa256-dimensionalfeatureutilizing512Gaussian
basisfunctions,withanonlinearprojectionreducingthedimensionalityfrom512to256. Themeansandstandarddeviations
oftheseGaussianbasisfunctionsareinitializeduniformlybetween-80and150,and0and230,respectively. Subsequently,
layernormalizationstabilizesthetemperatureembeddings’meansandvariances,ensuringastabledistributionforfurther
processing.
FormulationTransformerEncoder: Theformulationtransformerencoderintegratesmolecularrepresentationswiththeir
correspondingnormalizedmolarratios. Initially,themolecularrepresentationsarescaledbytheirnormalizedmolarratios.
Thesescaledrepresentationsarethenfedintoamulti-headattentionlayer52,whichemploys64attentionheadstocompute
interactionscoresbetweentheinputfeatures. Eachattentionheadhasadimensionof8,resultinginatotalembedding
dimensionof512. Theoutputfromtheattentionmechanismisthennormalizedusinglayernormalizationandcombined
withtheinputoftheattentionlayerviaaresidualconnection53. Followingthis,afeedforwardnetworkcomprisingtwo
linearlayersisapplied. Thefirstlinearlayerexpandstheinputdimensionfrom512to2048. Theoutputofthislayeris
activatedusingaGELUfunction41andthenmappedbackto512dimensionsbythesecondlinearlayer. Thefeedforward
network’soutputundergoesanotherlayernormalizationandisaddedtoitsinputthroughanadditionalresidualconnection.
Afterthreesuchlayers,therefinedmolecularrepresentationsareaggregatedbyweightedsummationandconcatenatedwith
thetemperatureembeddingstoformthefinalformulationrepresentation.
MolecularPairRDFBlock: Duringpretraining,themolecularpairRDFblockrefinestheformulationrepresentationby
incorporatingradialdistanceinformation. TheradialdistanceisencodedusinganotherGaussiankernel,whichtransforms
thedistanceinto128Gaussianbasisfunctionswithmeansandstandarddeviationsuniformlyinitializedbetween0and1.5.
Anonlinearlayerfurtherreducesthe128-dimensionalencodingtoa64-dimensionalradialdistanceembedding,followedby
layernormalization. Themolecularpairrepresentation,whichhas64dimensionscorrespondingtothenumberofattention
heads,isthenconcatenatedwiththeradialdistanceembeddings. Thiscombinedrepresentationisfedintoalinearlayerwith
aninputdimensionof128(64fromthemolecularpairrepresentationand64fromtheradialdistanceembeddings)and
anoutputdimensionof128. Theoutputofthislinearlayerisactivatedusingatanhfunction42tointroducenon-linearity.
Finally,asecondlinearlayermapsthese128-dimensionalfeaturestoasinglescalarvalue,representingtheRDFprediction
foramolecularpair.
Formulation-LevelPretraining
Fortheelectrolytesystemsusedinpretraining,weselectclassicbinarymixturesoflinearcarbonateandcycliccarbonate
solvents. Thelinearcarbonatesincludeethylmethylcarbonate(EMC),dimethylcarbonate(DMC),anddiethylcarbonate
(DEC),whilethecycliccarbonatesconsistofethylenecarbonate(EC)andpropylenecarbonate(PC).Foreachtypeof
solventcomponent,onemoleculeisselected,andfivepointsareuniformlygeneratedwithinthemolarfractionrangeof0-1.
Ateachgridpoint,randomperturbationsareappliedwithinamolarfractionrangeof0.15. Thelithiumsaltsusedareeither
lithiumhexafluorophosphate(LiPF )orlithiumbis(fluorosulfonyl)imide(LiFSI),withsaltmolalitychosenas0.5,1.0,and
6
1.5mol/kgsolvent,resultingin180formulationsforclassicalmoleculardynamicssimulations.
Eachformulationcontainsuptofourtypesofmoleculesorions(withthesaltsplitintocationsandanions),resultinginup
totenpairsofmolecularRDFs. EachpairofmolecularRDFsincludesapproximately900datapoints(r,g(r))withinthe
rangeofradialdistancerfrom0to2.0nm,ultimatelygeneratingadatasetofapproximately160,000datapoints. Forthe
purposeoflearningtheinter-molecularinteractionsinthepretrainingprocedure,allinner-molecularcontributionsofRDFs
areignored. Thedatasetissplitintotraining,validation,andtestsetsinaratioof8:1:1forpretraining. Themodelistrained
tominimizetheRMSEbetweenthepredictedandtrueRDFs.
14Uni-ELF:AMulti-LevelRepresentationLearningFrameworkforElectrolyteFormulationDesign
DetailsofMolecularDynamicsSimulations
The Molecular Dynamics (MD) simulations of electrolyte formulations were carried out using GROMACS54 package.
ParametersofGeneratedAmberforcefield(GAFF)forallelectrolytesolutesandsolventswereobtainedusingAntecham-
ber55 inAmbertools23packageandACPYPEsoftware56. AtomicpartialchargesweregeneratedviaRESPschemeas
follows: AllmoleculesareoptimizedinB3LYP/6-311g(d,p)DFTlevelusingGaussian16software57,wheresolventeffect
isintroducedusingPCMmethod. Then,RESPchargesarefittedfromtheoptimizedgeometryandwavefunctionusing
Multiwfnsoftware58.
Allelectrolytemoleculeswereputintisusedforpossiblepressurecontrol. Theparticle-meshEwald(PME)methodisused
forelectrostatics. AtomslinkingwithhydrogenatomsarerestrainedbyLINCSalgorithm.
Thesystemsarefirstlyequilibratedat298K,1000atminNPTensemblefor200pswithatimestepof2fstoreacha
reasonable density. A further pre-equilibrium process of 95000 ps in total is conducted, which is consisted of several
simulated annealing processses and NPT processes. After the pre-equilibrium process, the systems are adjusted to the
averagedensityforthegenerationofa5000pstrajectoryfilesinNVTensemble. Thedetailsofsimulationsettingsarelisted
inTable1.
Table2. Mainsimulationsettingsofmoleculardynamics
Stepnumber Description Ensemble Temperature(K) Pressure(atm) Timestep(fs) Simulationsteps
1 Energyminimization – – – – <50000
2 Equilibrium NVT 298 – 1 5000
3 NPT 298 1000 2 100000
4 Anneal NVT 298-363-298 – 2 1000000
5 Equilibrium NPT 298 1 2 500000
6 Anneal NVT 298-363-298 – 2 2500000
7 Equilibrium NPT 298 1 2 500000
8 Scalingconfigurationtoaveragedensity – – – – –
9 Trajectorygeneration NVT 298 – 2 2500000
Theradialdistributionfunctions(RDFs)werecalculatedusingGROMACS,rangingfrom0totheradiusofthesimulation
boxwithabinwidthof0.002nm. ForcomponentsAandB,theRDFbetweenthemiscomputedusingthefollowing
equation:
g (r)=
⟨ρ B(r)⟩
=
1 1
(cid:88)NA (cid:88)NB
δ(r
ij
−r)
AB ⟨ρ ⟩ ⟨ρ ⟩ N 4πr2
B local B local A
i∈Aj∈B
whereg (r)istheradialdistributionfunctionbetweencomponentsAandBatadistancer,⟨ρ (r)⟩istheaveragelocal
AB B
densityofcomponentBatdistancerfromaparticleofcomponentA,⟨ρ ⟩ istheparticledensityoftypeBaveraged
B local
overallspheresaroundparticlesAwithradiusr ,N isthenumberofparticlesofcomponentA,N isthenumber
max A B
ofparticlesofcomponentB,r isthedistancebetweenparticleiofcomponentAandparticlej ofcomponentB,and
ij
δ(r −r)istheDiracdeltafunction,whichis1whenr =rand0otherwise.
ij ij
DetailsoftheDownstreamTasks
Theexperimentalevaluationmethodsvaryamongthedifferentapproacheswecompare. Toensurefaircomparisons,we
alignourevaluationsettingsascloselyaspossiblewiththoseofthecomparedmethods,particularlyinthewaytrainingand
testsetsaredivided. Iftheoriginalmethodprovidesspecifictrainingandtestsets,weusethose. Ifonlythedivisionratiois
stated,wesplitthedatausingthreerandomseedsandreporttheaveragemetricsofthreetestresults. Duringtraining,we
employfive-foldcross-validationtoenhancetherobustnessofthemodel. Ineachfold,themodelundergoestrainingfor200
epochs,selectingthecheckpointdemonstratingoptimalperformanceonthevalidationset. Thefinalmodelcombinesthe
predictionsfromthefivemodelstrainedineachfold,averagingthesepredictionstodeterminetheperformancemetrics. The
comparisonresultsarelistedinTable5.
MeltingPoint Predictingthemeltingpointhaslongbeenachallengingtaskincheminformatics59. Thehighestquality
datasetavailable,tothebestofourknowledge, isthe2014Jean-ClaudeBradleyOpenMeltingPointDataset60, which
comprises19,933entriesand28,645measurementrecords,someofwhicharemarkedaserroneous.
15Uni-ELF:AMulti-LevelRepresentationLearningFrameworkforElectrolyteFormulationDesign
Table3. Predictionperformancesofvariousmolecularproperties
Dataset MeltingPoint BoilingPoint VaporPressure DielectricConstant RefractiveIndex Density Synthesizability
DatasetSize 19572 5435 2713 1220 7243 8905 126405
TrainingSetRatio 0.90 0.75 0.75 0.70 0.50 0.53 0.79
ReferenceWork Mietal.45 Mansourietal.24 Mansourietal.24 Bouteloupetal.26 Bouteloupetal.25 Mathieuetal.23 Leeetal.29
Scores RMSE R2 RMSE R2 RMSE R2 RMSE R2 RMSE R2 RMSE R2 AUC
Ref 36.88 0.830 22.08 0.93 1.00 0.92 5.03 0.91 0.0136 0.950 0.028 0.989 0.955
Uni-ELF 34.31 0.857 13.49 0.975 0.79 0.951 2.70 0.966 0.0082 0.982 0.025 0.992 0.965
Thestate-of-the-artmethodemployednaturallanguageprocessing(NLP)techniquestoprocessmolecularSMILESstrings45.
Allocating10%ofthedatasetfortesting,themodelachievedaR²of0.830andarootmeansquareerror(RMSE)of36.88
°C.Ourdatasetpreprocessingapproachcloselyalignswiththismethodbutincludesseveralrefinements: erroneousrecords
areexcluded,inorganiccompoundswithoutcarbonareomitted,andentrieswithduplicatemeasurementsdeviatingfromthe
meanbymorethanfivedegreesareremoved. Theremainingentriesareaveragedintoasinglerecord,resultinginarefined
datasetof19,572uniquerecords.
BoilingPointandVaporPressure WeusethedatabaseforboilingpointsandvaporpressuresfromtheOPERAmodel24,
whichemployedaQSPRmodelingapproach. OPERAdesignated75%ofthedatafortraining,achievingatestR²of0.93
andanRMSEof22.08°Cacross5,435recordswithboilingpointsmeasuredat760mmHg. Forthevaporpressuredataset,
which includes 2,713 records, the test R² reached 0.92 with an RMSE of 1.00 Log mm/Hg. Our method substantially
outperformstheOPERAmodelonthesemetrics,achievingatestR²of0.975withanRMSEof13.49°Cforboilingpoints,
andatestR²of0.951withanRMSEof0.79Logmm/Hgforvaporpressures.
DielectricConstant,RefractiveIndex,andDensity BouteloupandMathieu23,25,26developedaseriesofQSPRmodels
basedonphysicalequationsforpredictingdielectricconstant,refractiveindex,anddensityproperties. Usingthesame
training-testsplitastheirstudies,ourmethoddemonstratessuperiorperformanceonthetestset.. Forthedielectricconstant,
weachieveanR²of0.966andanRMSEof2.70;fortherefractiveindex,anR²of0.982andanRMSEof0.082;andforthe
density,anR²of0.992andanRMSEof0.025.
Synthesizability Forthesynthesizabilitydataset,Leeetal.29 randomlyselected100,000entriesasatrainingsetand
utilizedchemicaldescriptorsasmolecularfeaturestotestclassificationaccuracyontheremainingdata,achievingapeak
AreaUndertheCurve(AUC)of0.955. Usingthesameevaluationsettings,ourapproachreachesanAUCof0.965onthe
testset,onceagainsurpassingmethodsthatrelyonspecificfeatureengineering.
BaselineMethodsonFormulation-LevelTasks ForallbaselinemethodsusingXGBoost,weperformedhyperparameter
optimizationusingOptuna61onthevalidationsetsinafive-foldcross-validation. Thehyperparametersoptimizedincluded
thenumberofestimators(100to1500),maximumdepth(3to9),learningrate(0.0001to0.3),columnsamplingbytree
(0.1to1.0),andalpha(1to10). Theoptimizationaimedtominimizetherootmeansquarederror(RMSE)bytuningthese
parameters.
Additional Benchmarks We also benchmark Uni-ELF against leading deep learning-based models in five property
predictiontasks(dielectricconstant,density,meltingpoint,boilingpoint,andrefractiveindex). Uni-ELFdemonstrates
thebestperformanceinfouroutofthefivetasks(Table5). Tomaintainconsistency,a9:1training-to-testsetratioisused
acrossallcomparisons. Foreachmodel, acomprehensivegridsearchoverhyperparameters—batchsize, learningrate,
andembeddingdimensions—isperformedusinga3x6x3grid. Thefinalresultsarereportedusingthebest-performing
hyperparameter set identified through this search, ensuring that each model is evaluated under optimal performance
conditions.
16Uni-ELF:AMulti-LevelRepresentationLearningFrameworkforElectrolyteFormulationDesign
Table4.PerformanceoftheUni-ELFandotherleadingdeeplearning-basedmodelsindielectric,density,meltingpoint,boilingpoint,and
refractiveindexdatasets,withthebestRMSEandR2scoresdenotedinboldandsecondbestunderlined.
Datasets DielectricConstant Density MeltingPoint BoilingPoint RefractiveIndex
Scores RMSE R2 RMSE R2 RMSE R2 RMSE R2 RMSE R2
XGBoost38 8.737 0.685 0.0915 0.897 50.343 0.693 47.710 0.731 0.0219 0.886
D-MPNN30 4.081 0.932 0.0229 0.994 44.205 0.774 24.554 0.931 0.0110 0.972
GAT33 7.018 0.832 0.0964 0.894 48.087 0.738 19.177 0.956 0.0183 0.935
GCN32 5.214 0.898 0.0796 0.918 42.358 0.785 18.713 0.959 0.0182 0.944
PAGTN31 5.216 0.904 0.0405 0.987 42.292 0.791 17.219 0.968 0.0236 0.920
Uni-ELF 3.219 0.953 0.0257 0.992 34.312 0.857 15.252 0.971 0.0087 0.982
17
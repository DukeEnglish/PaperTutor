This document is licensed under CC BY (Creative Commons Attribution 4.0 International). The document is a
2-pageabstractforapostersubmissionthatwasacceptedbytheBio+Med+VisworkshopatIEEEVIS2024.
Visual Compositional Data Analytics for Spatial Transcriptomics
DavidHa¨gele* YuxuanTang† DanielWeiskopf‡
UniversityofStuttgart UniversityofStuttgart UniversityofStuttgart
Figure1: Ourvisualanalyticstoolforexploringthecelltypeproportionsdetectedonthetissue. Attheupperleft,thehistological
imagewithhighlightablespots. Nexttoit,adimensionalityreductionoftheindividualcelltypeproportionsdetectedatthespots.
Ontheright, controlsforselectingclustersfromk-meansclusteringandhiding/showingthespots/imageintheleftview. Atthe
bottom,astackedbarchartshowingthecelltypeproportionsofselectedspots.
ABSTRACT 1 INTRODUCTION
FortheBio+Med-VisChallenge2024,weproposeavisualanalyt- Spatialtranscriptomicstechnologyenablescapturinggeneexpres-
icssystemasaredesignforthescatterpiechartvisualizationofcell sioninthespatialcontextofcellulartissue[5]. Perspot (capture
type proportions of spatial transcriptomics data. Our design uses locationonthetissue),amixtureofdifferentcelltypesisdetected.
threelinkedviews:aviewofthehistologicalimageofthetissue,a Ultimately,singlecelltypeswouldbedesirablebutarehardtocap-
stackedbarchartshowingcelltypeproportionsofthespots,anda ture due to limited resolution [2]. However, recovering cell type
scatterplotshowingadimensionalityreductionofthemultivariate proportionsperspotispossible[3],leadingtocompositionaldata
proportions. Furthermore,weapplyacompositionaldataanalysis thatcanbeanalyzedinrelationtothespatialcontextofthetissue.
framework,theAitchisongeometry,totheproportionsfordimen- Previous work has used glyph-based representation of the cell
sionality reduction and k-means clustering. Leveraging brushing typeproportions,suchassmallpiecharts,superimposedonacor-
andlinking,thesystemallowsonetoexploreanduncoverpatterns responding histological image of the tissue. Such visualizations
inthecelltypemixturesandrelatethemtotheirspatiallocations leverage human perception for identifying patterns, such as areas
onthecellulartissue. Thisredesignshiftsthepatternrecognition of similar data items. However, the use of glyphs, especially pie
workloadfromthehumanvisualsystemtocomputationalmethods chartglyphs, hasitslimitationsandproblems. Thereadabilityof
commonlyusedinvisualanalytics. Weprovidethecodeandsetup piechartsdependsonthechoiceofcolors,whichbecomesdifficult
instructionsofourvisualanalyticssystemonGitHub.1 formanypieslicesandforcolorblindnesssupport. Smallervaria-
tionsinthedataaredifficulttospotsincehumansperformworseat
IndexTerms: Visualanalytics, compositionaldata, spatialtran-
comparingareascomparedtootherretinalvariables,suchaslength
scriptomics.
orposition.Superimposedglyphsingeneralobstructtheviewonto
the image, thus, hindering the examination of the corresponding
*e-mail:david.haegele@visus.uni-stuttgart.de
†e-mail:st189806@stud.uni-stuttgart.de tissuespots.
‡e-mail:daniel.weiskopf@visus.uni-stuttgart.de Oursolutionforthisvisualizationredesignchallengeshiftsaway
fromglyphsandemploysavisualanalyticsapproachwithseveral
linkedviews.Insteadofprimarilyrelyingonhumanperception,we
leverage computational methods to recognize patterns in the dif-
ferentcelltypeproportions. Specifically,weutilizetheAitchison
1https://github.com/UniStuttgart-VISUS/ geometryintendedforcompositionaldata[4]inconjunctionwith
va-for-spatial-transcriptomics clusteringanddimensionalityreduction.
1
4202
peS
11
]CH.sc[
1v60370.9042:viXraThisdocumentislicensedunderCCBY(CreativeCommonsAttribution4.0International).Thedocumentisa2-pageabstract
forapostersubmissionthatwasacceptedbytheBio+Med+VisworkshopatIEEEVIS2024.
1
Selectioncorrespondsto
1
S elec tionc orre spon d sto
2
2
Figure2:Selectingdifferentblobsinthedimensionalityreductionviewhighlightscorrespondingareasthatexhibitdifferentproportionpatterns.
2 DESIGN 3 LIMITATIONSANDOUTLOOK
Ourvisualanalyticssystemisintendedforspatialtranscriptomics OursolutiononlyusesthedatadescribedinSection2,butthepro-
data,comprisingthefollowing: videdchallengedatasetcontainsmoredataaboutthespecificgenes
andtheirrelationtothecelltypes,whichcannotbeanalyzedcur-
• Asetofcelltypeproportions p i∈∆d−1, where∆d−1 isthe
rently.Weexcludedthisdatabecausethescatterpieplottoredesign
(d−1)-standard simplex with d non-negative components
didnotencodesuchdataeither. However,oursystemisquiteex-
thatsumupto1.
tendable.Therefore,supportingadditionaldatawouldbeeasy.
• Correspondingspatiallocationsx i∈R2 (spots)onthetissue
Whilestackedbarchartsaregenerallypronetobemisinterpreted
towhichtheproportionsareassigned.
bylaymen,oursystemisdesignedforscientistswhoweexpectto
• Ahistologicalimageofthecorrespondingtissue.
befamiliarwiththischarttype. However,theviewdoesnotscale
Figure1showsoursystem,whichconsistsofthreeseparatelinked wellwiththetotalnumberofdataitemsandthereforecannotshow
views.Weshowthespatialinformation,i.e.,thehistologicalimage theentiretyofthedata. Thislimitationismitigatedbythedimen-
andthespotsx iinoneview.Thespotscanbedisplayedassuperim- sionalityreductionview,whichprovidesanabstractionofthedata
poseddotstomarktheirlocations,butalsoaselectionofspotscan itemsbasedontheirsimilarity.Oursolutiontoshowasubsetwhen
beusedtocreateanimagemasksothatthetissuecanbeobserved therearetoomanydataitemswassimpletoimplementbutmisses
withoutocclusion(darkpurplepartsinFigure1). torepresentdiscardeditemsandlacksthepossibilityforselection
Thecelltypeproportionsp iarevisualizedbyastackedbarchart. ofthem. Thisshouldbereplacedwithamoresophisticatedsum-
Sincethenumberofspotsnislargerthanaregularmonitor’shor- marizationapproachinthefuture.
izontalresolution(n>2000),notallproportionscanbedisplayed Thepresentedsystemisinaprototypicalstate, andmanypos-
atonce.Instead,welimitthenumberofbarsto500andonlyshow sibleinteractionandencodingtechniquesthatwouldfacilitateex-
asubset. Whenaselectionofspotsistriggered(e.g.,fromanother plorationarenotimplemented,e.g.,ahoveringmethodthatwould
view),thebarchartisupdatedtoonlyshowthecorrespondingpro- allowlocatingcorrespondingitemsinthedifferentviewsquickly,
portions. or a feature that would highlight other spots with similar propor-
In a scatter plot, we show a dimensionality reduction of the tions were planned but not realized. The most limiting factor of
d-dimensional proportions. For any automated analysis or trans- thisdesignisthelackofrequirementsandevaluationfromdomain
formationofthedata p i,itiscrucialthatitistreatedascomposi- scientists regarding their data analysis. Nevertheless, our system
tionaltoaccountforthedifferencesinratiosratherthanvalues[1]. provides good explorability of the data and possibilities to relate
Therefore, weapplyacenterlog-ratiotransformationtothe p i so celltypemixturestothespatialcontextofthetissue.
thatregularlinearalgebraoperationsaredoneinAitchisongeome-
try,whichguaranteesthatwestaywithinthesimplex∆d−1.Then,a ACKNOWLEDGMENTS
2Dprojectionisobtainedusingprincipalcomponentanalysis. We This work was funded by the Deutsche Forschungsgemeinschaft
also use the projection along the first principal component as or- (DFG, German Research Foundation)—Project ID 251654672—
dering for the bars of the bar chart, which provides better visual TRR161(ProjectA01).
consistencyformanybarssincethebarsbecomeroughlyordered
bysimilarity.Asubsetincaseoftoomanydataitemscantherefore
REFERENCES
becreatedsimilartonearestneighborimagedownscaling. [1] G.B.Gloor,J.M.Macklaim,V.Pawlowsky-Glahn,andJ.J.Egozcue.
Thesamecenterlog-ratiocoordinatesareusedtoapplyk-means Microbiomedatasetsarecompositional:Andthisisnotoptional.Fron-
clustering. The cluster assignment of the corresponding spots is tiersinMicrobiology,8,2017.doi:10.3389/fmicb.2017.022242
shown by color-coding in the dimensionality reduction view and [2] L.Larsson,J.Frise´n,andJ.Lundeberg. Spatiallyresolvedtranscrip-
theimageview(whenspotmarkersareenabled). Acontrolpanel tomicsaddsanewdimensiontogenomics.NatureMethods,18(1):15–
in our system allows selecting k and triggering spot selection of 18,Jan.2021.doi:10.1038/s41592-020-01038-71
specificclusters. [3] B.F.Miller,F.Huang,L.Atta,A.Sahoo,andJ.Fan. Reference-free
celltypedeconvolutionofmulti-cellularpixel-resolutionspatiallyre-
Our system strongly relies on interactive exploration through
solvedtranscriptomicsdata.NatureCommunications,13(1):2339,Apr.
brushingofdataitemsinanyoftheviews. Forexample,selecting
2022.doi:10.1038/s41467-022-30033-z1
spotsintheimageviewprovidesanoverviewofthecelltypepro-
[4] V. Pawlowsky-Glahn, J. J. Egozcue, and R. Tolosana-
portionsoftheselectedarea. Pickingitemsinthedimensionality
Delgado. Lecture notes on compositional data analysis, 2007.
reduction view or by cluster allows us to identify similar propor-
http://hdl.handle.net/10256/297.1
tions,theircorrespondinglocationsonthetissue,andidentifythe
[5] P.L.Sta˚hl,F.Salme´n,S.Vickovic,A.Lundmark,J.F.Navarro,J.Mag-
dominantcelltypes.Figure2showsanexampleofsuchaselection
nusson, S.Giacomello, M.Asp, J.O.Westholm, M.Huss, A.Moll-
and how the corresponding patterns differ. From the stacked bar brink,S.Linnarsson,S.Codeluppi,A˚keBorg,F.Ponte´n,P.I.Costea,
chart,specificdataitemsofinterestcanbeselectedbasedontheir P.Sahle´n,J.Mulder,O.Bergmann,J.Lundeberg,andJ.Frise´n. Visu-
proportionandpattern.Furthermore,alinkedtableviewlistsallthe alizationandanalysisofgeneexpressionintissuesectionsbyspatial
dataitemsandallowsforsortingandfilteringaccordingtospecific transcriptomics. Science,353(6294):78–82,July2016.doi: 10.1126/
celltypepercentage. science.aaf24031
2
Prompt Optimizer of Text-to-Image Diffusion Models for Abstract
Concept Understanding
ZezhongFan∗ XiaohanLi∗ ChenhaoFang† TopojoyBiswas
WalmartGlobalTech WalmartGlobalTech Universityof WalmartGlobalTech
Sunnyvale,California,USA Sunnyvale,California,USA Wisconsin-Madison Sunnyvale,California,USA
zezhong.fan@walmart.com xiaohan.li@walmart.com Wisconsin,USA topojoy.biswas@walmart.com
chenhao.fang@outlook.com
KaushikiNag JianpengXu KannanAchan
WalmartGlobalTech WalmartGlobalTech WalmartGlobalTech
Sunnyvale,California,USA Sunnyvale,California,USA Sunnyvale,California,USA
kaushiki.nag@walmart.com jianpeng.xu@walmart.com kannan.achan@walmart.com
ABSTRACT CCSCONCEPTS
Therapidevolutionoftext-to-imagediffusionmodelshasopened •Computingmethodologies→Computervision;Artificial
thedoorofgenerativeAI,enablingthetranslationoftextualde- intelligence.
scriptionsintovisuallycompellingimageswithremarkablequality.
However, a persistent challenge within this domain is the opti- KEYWORDS
mizationofpromptstoeffectivelyconveyabstractconceptsinto Imagegeneration,Diffusionmodels,Promptoptimization,Abstract
concreteobjects.Forexample,textencoderscanhardlyexpress
concepts
"peace",whilecaneasilyillustrateolivebranchesandwhitedoves.
ThispaperintroducesanovelapproachnamedPromptOptimizer ACMReferenceFormat:
forAbstractConcepts(POAC)specificallydesignedtoenhancethe ZezhongFan,XiaohanLi,ChenhaoFang,TopojoyBiswas,KaushikiNag,
JianpengXu,andKannanAchan.2024.PromptOptimizerofText-to-Image
performanceoftext-to-imagediffusionmodelsininterpretingand
DiffusionModelsforAbstractConceptUnderstanding.InCompanionPro-
generatingimagesfromabstractconcepts.WeproposeaPrompt
ceedingsoftheACMWebConference2024(WWW’24Companion),May
LanguageModel(PLM),whichisinitializedfromapre-trainedlan-
13–17,2024,Singapore,Singapore.ACM,NewYork,NY,USA,8pages.https:
guagemodel,andthenfine-tunedwithacurateddatasetofabstract
//doi.org/10.1145/3589335.3651927
conceptprompts.ThedatasetiscreatedwithGPT-4toextendthe
abstractconcepttoasceneandconcreteobjects.Ourframework
1 INTRODUCTION
employsaReinforcementLearning(RL)-basedoptimizationstrat-
egy,focusingonthealignmentbetweenthegeneratedimagesbya Inhumandailycommunication,conceptsserveasamediumthat
stablediffusionmodelandoptimizedprompts.Throughextensive conveysdiverseideas.Peopleusuallyutilizetwodifferentwaysto
experiments,wedemonstratethatourproposedPOACsignificantly expresstheirthoughts:concreteobjectsandabstractconcepts.Con-
improvestheaccuracyandaestheticqualityofgeneratedimages, creteobjectsrefertotangible,observable,andmeasurablephenom-
particularlyindescriptionofabstractconceptsandalignmentwith enaorentitiesandtheyarebasedonsensoryperceptionandcanbe
optimizedprompts.Wealsopresentacomprehensiveanalysisof directlyexperiencedlikeatreeorrain.Ontheotherhand,abstract
ourmodel’sperformanceacrossdiffusionmodelsunderdifferent conceptsrefertoideasortheoriesthatarenotbasedonphysical
settings,showcasingitsversatilityandeffectivenessinenhancing orconcretephenomena,suchas"peace"and"courage".Theyare
abstractconceptrepresentation. intangibleandcannotbedirectlyobservedormeasured.Abstract
conceptsplayanimportantroleinexpressingcomplexemotions
andshapingethicalandmoralvalues.Inreallife,toalleviatetheob-
staclescausedbyabstractconceptsindailycommunication,people
∗Bothauthorscontributedequallytothisresearch.
†WorkdonewhileatWalmart. oftenexplainthemwiththeirrelatedconcreteobjectsandvisible
objects.Forexample,asshowninFigure1whenpeopleintroduce
the"Peace"concept,theyoftenrefertoolivebranchesandwhite
dovestohelpothersunderstand.
Permissiontomakedigitalorhardcopiesofallorpartofthisworkforpersonalor
Recentcutting-edgeText-to-Image(T2I)generationmodelsin-
classroomuseisgrantedwithoutfeeprovidedthatcopiesarenotmadeordistributed
forprofitorcommercialadvantageandthatcopiesbearthisnoticeandthefullcitation cludingStableDiffusion[30],DALL•E[29],Imagen[32]andDream-
onthefirstpage.Copyrightsforcomponentsofthisworkownedbyothersthanthe booth[31]haveachievedoutstandingachievementsingenerating
author(s)mustbehonored.Abstractingwithcreditispermitted.Tocopyotherwise,or
high-resolutionrealisticimages.However,thesemodelsaretrained
republish,topostonserversortoredistributetolists,requirespriorspecificpermission
and/orafee.Requestpermissionsfrompermissions@acm.org. withlarge-scaletext-imagepairsdatasetswhichmainlyconcen-
WWW’24Companion,May13–17,2024,Singapore,Singapore trateonconcreteandphysicalobjectsandattributes,thusfailingto
©2024Copyrightheldbytheowner/author(s).PublicationrightslicensedtoACM.
generateaccuratevisualizationsordescriptionsforabstractideas
ACMISBN979-8-4007-0172-6/24/05
https://doi.org/10.1145/3589335.3651927 astheirnarrowunderstandingoftheseabstractconcepts.
4202
rpA
71
]VC.sc[
1v98511.4042:viXraWWW’24Companion,May13–17,2024,Singapore,Singapore ZezhongFanetal.
generatedimagesandoptimizedpromptsgeneratedbyPLMaswell
asoriginalpromptswithdifferentweightstoimprovethealignment
betweenhumanintentsandgeneratedimages.InFigure1,wecan
seethattheimage(c)generatedbyfine-tunedSDXLwithReFL
hasabetteralignmentwiththepromptasithasbothwhitedoves
andolivebrancheswhileimage(b)onlyincludeswhitedoves.The
rewardusedinbothstagesisacombinationofrelevancescores[26]
(b) SDXL (with POAC)
andaestheticscores[36].Tohelpthemodelbetterunderstandthe
abstractconcept,wealsocreateadatasetwiththehelpofGPT-4[1]
tomapabstractconceptstoconcreteobjects.
Weconductexperimentswithoneofthecutting-edgeT2Idif-
fusionmodels,StableDiffusionXL(SDXL)[25].Weevaluateour
methodsutilizingthelatestbenchmarkandhumanevaluation.The
experimentalresultsshowthatPOACcanpreciselyexpressand
(c) SDXL (with POAC, fine-tuned with ReFL)
(a) SDXL understandabstractconceptswithvisibledetailswhileensuring
Original prompt: a group of people celebrating peace
aestheticappealandfaithfulnessofgeneratedimages.Moreover,
Prompt after PLM: A crowd gathers in the park, their hands clasping olive branches and white
doves fluttering above their heads. Their laughter and cheers echo harmoniously, creating a wealsofindthattwo-stagereinforcementlearningplaysavitalrole
symphony of peace that fills the entire space. Oil painting, nostalgic, digital painting, very
intricate inimprovingimagequalityandaligningwithhumanpreference.
Themaincontributionsofourworksareasfollows:
Figure 1: Examples of image generation with or without
• With the assistance of GPT-4, a dataset is constructed to
promptoptimizer.(a)SDXL:onlyinputtheoriginalprompt.
correlateabstractconceptswithconcreteobjects.
(b)SDXL(withPOAC):inputthepromptoptimizedbyPOAC
• Wefine-tuneaPromptLanguageModel(PLM),whichrewrites
toSDXL.(c)Generatetheimagewiththefine-tunedSDXL
theabstractconceptsintheoriginalpromptstoconcreteob-
withReFLandoptimizedprompt.
jectsintheoptimizedprompts.
• Wealsofine-tunetheSDXLwithReFLtoaligntheoptimized
promptsandoriginalpromptswiththegeneratedimages.
Therearethreemainchallengesincomprehendingandexplain-
ingtheabstractconceptinimagesusingT2Igenerationmodels. 2 RELATEDWORKS
First,thecurrentresearchhasprimarilyexaminedsubject-driven
2.1 Text-to-ImageGeneration
T2Imodels[11,12,18,31]thatconcentratesolelyonconcreteob-
jectsinimagegeneration.However,expressingabstractconcepts Text-to-Imagegenerationisacrucialtaskwhichaimstogener-
inimagesischallengingastheyrequireassociationwithconcrete ateimagesbasedonuser-inputtextualdescriptionsincomputer
objects.Currently,thereislimitedresearchonthetranslationof vision.Theexistingmodelsinthisdomaincanbecategorizedas
abstractconceptstoconcreteobjects.Second,themostrecentT2I eitherautoregressive[7,29,37]ordiffusionmodels[21,28,30,32],
modelforabstractconcepts[16]enhancespromptoptimizationby asevidencedbypriorresearch.Notably,DALL-E[29]standsout
utilizingaLargeLanguageModel(LLM)[2]andexpandingabstract asasignificantadvancementinautoregressivemodelsduetoits
conceptstoencompassmultipleconcreteobjects.However,this impressivezero-shotcapabilities.However,diffusionmodelshave
optimizationsolelyfocusesonthelanguageaspectanddoesnot alsoshownverypromisingresults.Basedonpriorworksinthedif-
alignwiththeimagegenerationprocess.Third,theutilizationof fusionmodels[4,10],GLIDEmodel[21]introducesaninnovative
LLMsrequirestheuseofalargeGPUserverorpurchasingservices approachtoconditioningthediffusionmodelbasedonaninput
fromathird-partycompany,bothofwhicharecostlyandnoteasily textcaption.Additionally,DALL-E2[28]modelisfurtherimproved
scalable.Inthispaper,weintendtodevelopacompactlanguage byincorporatingasupplementalCLIPimageembedding,which
modelthatspecificallyfocusesonpromptoptimizationtoenhance enhancesthemodel’sdiversity.Othercertainefforts,suchasStable
scalability. Diffusion[30],prioritizecomputationalefficiencybyinitiallyrep-
Toaddresstheabovechallenges,weproposeanovelPrompt resentinginputimagesaslow-dimensionallatentcodes.However,
OptimizationframeworkofText-to-ImageGenerationforAbstract duetomostoftrainingpromptsofthesemodelsonlyincluding
Concepts(POAC)thatpurposesonbridgingthediffusionmodel concreteobjectsinreal-lifeandlackofmappingofabstractcon-
andtheabstractconceptswhileensuringthegenerationfaithfulness ceptsandimages,itisstillachallengefordiffusionmodelstofully
andmaintainingaestheticappeal.Inspiredbytherecentadvancesin understandabstractconceptdirectly.
promptoptimizationandabstractconceptunderstanding[9,14,16], Tofurtheraligntext-to-imagegenerationmodelswithhuman
wefirsttrainedaPromptLanguageModel(PLM)withSupervised understandings,manyeffortshavebeenmadetoalleviatethegap
Fine-Tuning(SFT)basedonapre-trainedlanguagemodelsuchas betweenmodelsandhumanpreference[5,9,13,35,36].Forexam-
GPT2[27]onacollectionoftextinputswithabstractconceptsand ple,Leeetal.[13]emphasizetextalignmentwithdiffusionmodels,
optimizedpromptwithphysicalscenesandobjectscorresponding utilizingarewardmodelthatwastrainedondatasetsannotatedby
tothem.ThenweemployRewardFeedbackLearning(ReFL)based humanevaluatorstofine-tunethetext-to-imagemodel.Similarly,
onReinforcementLearning(RL)toalignthePLMwiththediffusion ImageReward[36]providesacomprehensivehumanpreference
model.TheReFLisappliedtofine-tunethediffusionmodelusing rewardmodelthataligntextwithimagesfromaesthetics,toxicity,PromptOptimizerofText-to-ImageDiffusionModelsforAbstractConceptUnderstanding WWW’24Companion,May13–17,2024,Singapore,Singapore
andbiases.Toenhancetheoriginalprompt,Haoetal.[9]propose withourconstructeddataset.Thenweconductreinforcementlearn-
apromptadaptationframeworktotrainalanguagemodelwitha ingontheSDXLtomaximizetargetrewardtoimprovediffusion
reinforcementlearningframework.However,therearestillagap modelunderstandingofabstractconceptsandensurealignment
ofaligningthehumanpreferenceswithabstractconcepts. withpromptsandaestheticsofgeneratedimages.
3.1 Datasets
2.2 ConceptRepresentationinImage
Generation Wefirstcollecttop-500abstractconceptsfromIBMConceptAb-
stractness1basedontheirdegreeofabstractness.Then,wemanu-
Thefieldofimage generationhaswitnessedanotablesurgein
allyextendeachabstractconceptintoashortpromptincludingit
interestintherepresentationofconcepts.Thisincludeseffortsin
asthesourceinputtoPLM.Forexample,asshowninFigure2,we
conceptcustomization[8,12,31,34]whichhavesoughttoenrich
extend"wisdom"to"anoldmanwithwisdom".Finally,weleverage
Text-to-Image(T2I)modelswithnewconcepts.Theseconceptstyp-
thestrongknowledgeandunderstandingofabstractconceptsof
icallyfocusonincorporatingspecificentities,rangingfromnovel
GPT-4[1]torewritethesourceinputintoanewpromptwitha
creationstopersonalizeditemsfromeverydaylife,suchasapet
dedicatedsceneandconcreteobjectsthatcanexpresstheabstract
dog.Additionally,theareaofconceptdisambiguation,asexplored
conceptsclearlyandeffectivelyastargetoutputs.Fromhigh-quality
in[20],addressesthechallengesposedbythesyntacticambiguity
human-engineeredpromptsfromvariousdiffusionmodelsinIn-
inhumaninstructions,whichcanobscuretheintendedmeanings
ternet[22,24],wecandiscoverthatmostpromptsarecomposed
andrelationshipsofphysicalitems,withoutextensivelyexamining
oftwoparts:maincontentthatdescribestheuser’sintention,and
thenuanceddifferencesamongabstractconcepts.Inconclusion,re-
somemodifiersexpressingimagestylesuchasartistnameandart
centresearchinimagegenerationhasfocusedonthevisualization
style.Toensurethequalityanddiversityofgeneratedimages,we
oftangibleconceptsinsteadofabstractones.Ourobjectiveisto
randomlyaddmodifierstotargetoutputs.
narrowthisresearchgapbydeepeningtheexplorationofabstract
conceptsinimagegeneration.
3.2 SupervisedFine-tuning
Wefirstfine-tunePLMinitializedwithapre-trainedlanguagemodel
2.3 PromptOptimizationforDiffusionModels
(GPT-2[27])onasetoforiginalandoptimizedpromptpairs.Apar-
Aslarge-scalemodelsreliantontextualinputscontinuetoevolve[3, allel prompt dataset D = (x,y) contains prompt pairs of short
6,17,19],thesubstantialresourcesrequiredfortheirtrainingand promptswithabstractconceptsandrewrittenpromptswithcorre-
fine-tuningpresentasignificantbarrierformanyresearchers.In spondingconcreteobjects.Thetrainingobjectiveistomaximize
response,promptoptimizationhasbeenrecognizedasaneffective thelog-likelihood:
strategy.Thisapproachenhancesimagegenerationqualitywithout
theneedforalteringtheunderlyingmodelarchitectureorengaging
L𝑆𝐹𝑇 =−E (x,y)∼Dlog𝑝(y|x) (1)
inlabor-intensivetrainingprocessesforT2Imodels.Theareaof wherePLMistrainedtobeusedtogeneratetheinputpromptsof
promptoptimizationisstillinitsearlystagesandsuffersfroma thediffusionmodel.
scarcityofexhaustivestudies.Practicaladviceonwritingeffective
T2Ipromptsisprimarilysharedthroughblogsandmanuals[22–24], 3.3 RewardFunction
whichsummarizetheessentialelementsanddescriptivetermsthat To ensure the faithfulness and quality of generated images, we
enhanceimagestyle.Promptoptimizationcanbeappliedwithintex- designourrewardfunctionfromtwoperspectives:relevanceto
tualorembeddingdimensions,includingsofttuningmethods[15], abstractconceptsandaesthetics.Thegoalmotivatesustodefine
withsomeresearchersfocusingondevelopingoptimizationmodels therewardfunctionR(·)fromtheabovetwoperspectives.First,
thatcloselyintegratewithT2Imodels[9].Whileexistingefforts weuseCLIPscores[26]tomeasuretherelevanceofbetweengen-
inT2Ipromptoptimization[14]largelyconcentrateonrefining eratedimagesandpromptscontainingabstractconceptsaswellas
thestylisticandaestheticqualitiesofgeneratedimages,ourstudy optimizedpromptswithconcreteobjects.Therelevancescoreis
intendstofocusonadvancingthevisualrepresentationofabstract definedasbelow:
concepts.
R𝑟𝑒𝑙(x,y)=E 𝑖 y∼G(y)[𝑓 𝑟𝑒𝑙(x,y,𝑖 y)] (2)
3 METHODOLOGY
TheaimsofPromptOptimizerforAbstractConcepts(POAC)isto 𝑓 𝑟𝑒𝑙(x,𝑖 y)=0.3∗𝑔 𝐶𝐿𝐼𝑃(x,𝑖 y)+0.7∗𝑔 𝐶𝐿𝐼𝑃(y,𝑖 y) (3)
automaticallyenrichabstractconceptswiththeircorresponding where𝑖 y ∼ G representssamplingimages𝑖 y fromthediffusion
concreteobjectsandfeedoptimizedpromptsintoadiffusionmodel model G with y as input prompts.𝑔 𝐶𝐿𝐼𝑃 is the CLIP similarity
togenerateaesthetic andfaithfulimages. Figure1presentsthe
function.WedeterminedifferentweightsforCLIPscoresoforigi-
overviewofourframework.POACiscomposedoftwoparts:1)
nalpromptswithabstractconceptsandoptimizedpromptswith
PromptLanguageModel(PLM)isbuiltbasedonapre-trainedlan-
concreteobjectsto0.3and0.7becausewewanttoencouragethe
guagemodel(GPT2)[27]and2)StableDiffusionXL(SDXL),which
modeltofocusmoreonphysicaldetailswhileensuringintentions
isalarge-scalediffusionmodel[25].Wealsoconstructadatasetcon-
fromoriginalabstractconcepts.
tainingpairsofabstractconceptsandtheircorrespondingconcrete
objects.WithSupervisedFine-Tuning(SFT),wefine-tunethePLM 1https://developer.ibm.com/exchanges/data/all/concept-abstractness/WWW’24Companion,May13–17,2024,Singapore,Singapore ZezhongFanetal.
Abstract Wisdom rim light, nostalgic,
concept digital painting, high relevance score
quality, cinematic aesthetics score
Original An old man with Randomly
+ ReFL
prompt wisdom select
Stable Diffusion XL
An elderly gentleman,
seated in his worn-out
Please rewrite the
armchair, leafed
“wisdom” in the
through the pages of an X 0.7
following sentence to a
ancient book, his eyes Optimized prompt
short sentence which
Input sparkling with wisdom
includes a dedicated
Prompt and concrete scene and Optimized
SFT Prompt Language
to GPT also includes concrete prompt
Model
objects about
“wisdom”: an old man X 0.3
with wisdom Original prompt
(a) Dataset construction (b) Model training
Figure2:(a)Thedatasetconstructionprocess.Wemanuallyrewritetheabstractconcept"wisdom"toashortprompt.Withthe
helpofGPT,wepromptisoptimizedwithdetailedandconcreteobjects(inred).Theartstylesarerandomlyselectedandadded
totheoptimizedprompt.(b)ThetrainingprocessofPromptLanguageModel(PLM)andStableDiffusionXL(SDXL).PLMis
fine-tunedwithoriginalandoptimizedpromptsbySupervisedFine-Tune(SFT).TheSDXLisfine-tunedbyRewardFeedback
Learning(ReFL)toalignthepromptsandtheimage.
Then,tomeasuretheaestheticpreferenceofimages,weuse where L𝑟 isthefinalrewardlossfunctionand L𝑝𝑟𝑒 istheloss
ImageReward[36]scorewhichisaT2Ihumanpreferencereward functionofSDXL.𝜙 isamapfunction.𝜖isnoise,𝜖 𝜃 isthedenois-
model.Itistrainedbasedonalargehuman-annotatedaestheticpref- ingautoencoderand𝑧 𝑡 isthelatentembeddinginthedenoising
erencedatasetcontaining137kexpertcomparisons.Theaesthetic autoencoder.WiththeReFL,wecanfine-tunetheSDXLtomakeit
scoreisdefinedas: betteralignwiththeoriginalandoptimizedpromptwithPLM.
R𝑎𝑒𝑠(y)=E 𝑖𝑦∼G(y)[𝑔 𝑎𝑒𝑠(𝑖 y)], (4)
4 EXPERIMENTS
where𝑔 𝑎𝑒𝑠 denotesImageRewardscore. Weconductexperimentstovalidateourproposedmethod.Initially,
Finallywedefinetheoverallrewardbycombiningtheabove we explain the implementation details in Section 4.1. Then we
scores: visualizetheresultsandconductcomparativeexperimentsbetween
baselinemodelsandourPOACframeworkinSection4.2
R(x,y)=R𝑟𝑒𝑙(x,y)+R𝑎𝑒𝑠(y) (5)
4.1 ImplementationDetail
3.4 RewardFeedbackLearning
DatasetConstruction.ForPLM,wecollecttop-500abstractcon-
Tomakediffusionmodelsbetteralignwithabstractconcepts,we
ceptsfromIBMConceptAbstractness2 basedontheirdegreeof
adoptastrategyknownasRewardFeedbackLearning(ReFL)[36].
abstractness.Thenwemanuallywriteeachconceptintothreedif-
DuringtheRewardFeedbackLearningstage,ReFLisemployed
ferentformsorashortpromptincludingitasthesourceinputto
tofine-tunediffusionmodelsbasedontherewardfunctionin3.3.
PLM.ThenweleverageGPT-4torewriteeachsourceinputinto
Therewardfunctionsareemployedtoback-propagateandupdate
threedifferentpromptswithadedicatedsceneandconcreteob-
thediffusionparametersafterapredeterminedrangeofsteps.In
jectscorrespondtotheirabstractconceptsastargetoutput.After
practice,tomitigatetheover-optimizationissueandstabilizethe
experimentingwithdifferentprompttemplates,wediscoverthat
fine-tuning, we re-weight reward loss and regularize with pre-
thefollowingprompttemplateforGPT-4cangeneratethemost
trainingloss.AfterReFL,thediffusionmodelisoptimizedwitha
satisfiedtargetoutputs:"Pleaserewritethe[AbstractConcept]in
focusonaligninggeneratedimageswithabstractconcepts.The
thefollowingsentencetoashortsentencewhichincludesadedi-
lossofReFLisformulatedas
catedandconcretesceneandalsoincludesconcreteobjectsabout
[SourceInput]".Thenwecollectmodifiersfromuser-inputprompts
L𝑟 =𝜆E 𝑦∼Y(𝜙(R(x,y))), (6)
L𝑝𝑟𝑒 =E (𝑦,𝑖𝑦)∼G(𝑦)(E 𝜀(𝑖𝑦),𝑦,𝜖∼N(0,1),𝑡[||𝜖−𝜖𝜃(𝑧𝑡,𝑡)|| 22]), (7) 2https://developer.ibm.com/exchanges/data/all/concept-abstractness/PromptOptimizerofText-to-ImageDiffusionModelsforAbstractConceptUnderstanding WWW’24Companion,May13–17,2024,Singapore,Singapore
(b) SDXL (with POAC) (b) SDXL (with POAC)
(a) SDXL (c) SDXL (with POAC, fine-tuned with ReFL) (a) SDXL (c) SDXL (with POAC, fine-tuned with ReFL)
Original prompt: a man with courage Original prompt: an old man with wisdom
Prompt after POAC: a firefighter with unwavering courage charges into the flaming inferno, Prompt after POAC: An elderly gentleman, seated in his worn-out armchair, leafed through
intent on saving the trapped people. 4K, HDR, Studio Photo, high quality 4K, HDR, Studio the pages of an ancient book, his eyes sparkling with wisdom. rim light, nostalgic, digital
Photo, high quality painting, high quality, cinematic
(a)Courage (b)Wisdom
(b) SDXL (with POAC)
(b) SDXL (with POAC)
(a) SDXL (c) SDXL (with POAC, fine-tuned with ReFL)
(a) SDXL (c) SDXL (with POAC, fine-tuned with ReFL)
Original prompt: a lady receives her honor
Prompt after POAC: A lady stands tall on a podium, a medal of honor gleaming against her Original prompt:a man shows his creativity
chest, bestowed upon her for her unwavering integrity and respectability. photo, 4K, detailed, Prompt after POAC: A man painting a vibrant mural on a large city wall, his paint-splattered
high quality, cinematic clothes as colorful as his artwork. high detailed, colorful, art style
(c)Honor (d)Creativity
(b) SDXL (with POAC)
(b) SDXL (with POAC)
(a) SDXL (c) SDXL (with POAC, fine-tuned with ReFL)
(a) SDXL (c) SDXL (with POAC, fine-tuned with ReFL)
Original prompt: a wealthy lady
Original prompt:a man celebrate victory Prompt after POAC: A well-dressed lady, relaxing in a spacious, luxuriously furnished living
Prompt after POAC: A triumphant athlete raises his hands high, standing on the first-place room with a grand fireplace, antique furniture, and large, floor-to-ceiling windows
podium as confetti rains down and the crowd roars in celebration of his victory. 8k,digital art overlooking a manicured garden. oil painting, 4k
(e)Victory (f)Wealth
Figure3:QualitativecomparisonofSDXLonly,SDXLwithPOACandSDXLwithPOAC,fine-tunedwithReFL.WWW’24Companion,May13–17,2024,Singapore,Singapore ZezhongFanetal.
Abstract Original
Optimizedprompts Modifiers
concepts prompts
Achild’slaughterechoedthroughtheparkasthey
theessenceof Photorealistic,high-
Happiness playedwithacolorfulkite,capturingtheessence
happiness detailed,4kUHD
ofhappiness.
amanfullof Aman,hisfaceredwithanger,clenchedhis color,depthand
Anger
anger fistsandslammedthemagainstthetable. intrigue.
Twochildrensatsidebysideonawoodenbench,
Thefriendshipof saturatedcolors,
Friendship sharingabagofgummybearsandgiggling,
children highquality,nostalgic
exemplifyingthebeautyoffriendship.
Ayoungman’sdreamtakesshapeintheformof
fujifilmxt3,outdoors,
ayoungman’s abustlingstartupoffice,filledwithinnovative
Dream beautifullighting,raw
dream gadgets,whiteboardscoveredinideas,and
photo,8kuhd,filmgrain
energeticcolleaguescollaboratingpassionately.
Aman,seeingashiveringstraydogonthestreet,
Amanshowshis saturatedcolors,
Mercy wrappeditinhisownjacketandtookittoanearby
mercy. highquality,photorealistic
animalshelter.
Abraveyoungman,equippedwithhisbackpackand
Ayoungmanis torch,isclimbingaruggedmountainterrainwith saturatedcolors,
Adventure undergoingan aperilousravineononesideandadense,mysterious highdetailed,photo,
adventure. forestontheother,underaskyablazewiththecolors 4kUHD
ofsunset.
Table1:PromptoptimizationwithourproposedPOAConabstractconcepts"Happiness","Anger","Friendship","Dream",
"Mercy"and"Adventure".Theredphrasesareconcreteobjectsabouttheabstractconcepts.
fromLexica3.Werandomlyaddmodifiers,e.g.oilpainting,nostal- • In(b)Wisdom,theinitialoutputfromplainSDXLonlyde-
gic,digitalpainting,veryintricateinFigure1,totheendoftarget pictsanoldman.However,byoptimizingthepromptwith
promptstoensurethediversityandqualityofprompts.Forreward POAC,thegeneratedimagenowincludesmorespecificde-
feedbacklearning,thepre-trainingdatasetisfroma625ksubsetof tails,suchasportrayingtheoldmanreadingabook,which
LAION-5B[33]selectedbyaestheticscore. effectivelyconveystheideaofwisdom.Afterfurtherfine-
Supervisedfine-tuning.Wefine-tuneGPT-2topredictthetar- tuningthemodelwithReFL,theresultingimagenowshows
getpromptwiththesourcepromptasconditionalinput.Theinput theoldmandressedinarespectablesuit,effectivelyillus-
formatis[Source]Rephrase:[Target].Themodelisfine-tunedwith tratingtheconceptofan"elderlygentleman"asmentioned
alearningrateof5e-5,andamaxlengthof512whilemaintaining intheprompt.Thisenhancementensuresthatthegenerated
abatchsizeof64. imagebetteralignswiththeintendedrepresentationofthe
RewardFeedbackLearning.WeuseSDXLasourmodelback- prompt.
bone.Themodelisfine-tunedinhalf-precisionwithalearningrate • In(c)Honor,SDXLgeneratesanimageoftwoladiestalk-
setto1e-5.FollowingThesamplesteprange[T1,T2]isdefinedas ing,whichisnotdirectlyassociatedwithhonor.However,
[1,10]wheretotalstepsTissetto40.Theregularizer𝜆issetto afteroptimizingthepromptwithPOAC,therevisedprompt
1e-3. includesmorespecificdetails,suchasaladywith"amedal
ofhonor".Afterfurtherfine-tuningSDXLwithReFL,the
4.2 QualitativeComparison generatedimagenowdepictsascenewhere"aladystands
tallonapodium",aligningbetterwiththeprompt.
InFigure3,weillustratethegeneratedimagesofsixabstractcon-
• In(d)Creativity,theoriginalpromptcanhardlybeunder-
cepts:(a)courage,(b)wisdom,(c)honor,(d)creativity,(e)victory.
stoodbySDXL.WithPOAC,SDXLgeneratesanimageofa
Fromtheimages,wehavethefollowingobservations.
manwearingacleanjacketandpaintingcolorfulartwork.
• In(a)Courage,theSDXLwiththeoriginalpromptonlyout- However,thepromptoptimizedbyPLMindicatesthatthe
puts a man riding a horse, which has limited relation to man’sclothesarealsosplatteredwithpaint.Afterfurther
courage.InSDXL(withPOAC),theoptimizedpromptpro- fine-tuningwithReFL,themodelisabletogenerateanimage
videsascenewhereafirefighterfacesaflaminghouse,which ofamanwearingat-shirtthatispaint-splattered.
isabetterexpressionofcourage.InSDXL(withPOAC,fine- • In(e)Victory,theoriginalpromptwithSDXLonlygenerates
tunedwithReFL),thefirefighteriswalkingonfire,which animageofalaughingman,whichisonlylooselyassoci-
matchesthe"chargesintotheflaminginferno"intheprompt. atedwithvictory.However,byoptimizingthepromptwith
PLM,therevisedpromptincludesmoreconcreteobjectsthat
3https://lexica.art directlydepictvictory,suchasan"athlete"anda"first-placePromptOptimizerofText-to-ImageDiffusionModelsforAbstractConceptUnderstanding WWW’24Companion,May13–17,2024,Singapore,Singapore
Models RelScore AesScore • SDXLwithPOAC,withouttheinclusionofReFL,exhibits
SDXL 0.21 0.19 a 38% improvement over plain SDXL. This suggests that
SDXLwithPOAC 0.29 0.25 SDXLstrugglestocomprehendabstractconcepts,whileour
SDXLwithPOACandReFL 0.32 0.26 methodgreatlyaidsSDXLinaccuratelydepictingtheim-
Table2:QualitativecomparisonofSDXL,SDXLwithPOAC agebyutilizingconcreteobjectstorepresenttheseabstract
andSDXLwithPOACandReFL. concepts.
5 CONCLUSION
ThisstudypresentsthedevelopmentandevaluationofthePrompt
podium".Afterfurtherfine-tuningwithReFL,thegenerated
Optimizer for Abstract Concepts (POAC), a pioneering method
imagenowclearlyshowsanathletewearingajersey,stand-
aimedatrefiningthecapabilitiesoftext-to-imagediffusionmodels
ingonthepodium,withpeoplecheeringinthebackground.
inaccuratelyrenderingimagesfromabstractideas.Leveraginga
• In(f)Wealth,theimagegeneratedfromtheoriginalprompt
PromptLanguageModel(PLM)derivedfromaninitiallypre-trained
canalsodepictawealthywomanholdingastackofcash.
languagemodelandfurtherfine-tunedwithaspecializeddatasetof
However,theoverallqualityoftheimageispoor.Afteropti-
abstractconceptpromptscreatedusingGPT-4,ourapproachmaps
mizingtheprompt,thegeneratedimagecanmoreeffectively
abstractconceptstodetailedscenesandconcreteobjects.Employ-
portraytheluxuriousenvironmentthatsheisin.Thecon-
ingareinforcementlearning-basedoptimizationstrategy,POAC
creteobject,a"grandfireplace,"isnowclearlyvisibleinthe
alignsthestablediffusionmodel’simagegenerationwiththeopti-
imageproducedafterfine-tuningtheSDXLwithReFL.
mizedprompts,significantlyenhancingboththeprecisionandthe
InTable1,wealsoprovidemoreexamplesabouttheoriginal visualappealoftheoutput.TheeffectivenessofPOACisvalidated
promptsandoptimizedpromptsgeneratedbyPLMaboutfourab- throughqualitativeandquantitativeexperiments,showingnotable
stractconcepts:"Happiness","Anger","Friendship","Dream","Mercy" improvementsinimagegenerationtasksandprovingitsquality
and"Adventure".Theredphrasesareconcreteobjectsaboutthe andrelevanceofpromptsunderdifferentsettingsforbetterabstract
abstractconcepts.Fromthistable,wehavethefollowingfindings: conceptvisualization.
(1)OurproposedPOAChastheabilitytotransformtheoriginal Infuturework,wewillexploreadditionalsolutionstoaddress
promptintoascenethatutilizesconcreteobjects,makingiteasier thealignmentproblembetweenpromptsandgeneratedimages.In
forSDXLtocomprehend.Forinstance,weassociate"Happiness" additiontoabstractconcepts,thereareotherbarriersthatneedtobe
with"achild’slaughter,""Anger"witha"redface,"and"Adventure" overcometoproduceaccurateandvisuallypleasingimages,suchas
witha"backpackandtorch."Inourdailylives,theseabstractcon- biasesrelatedtorace,nationality,orgenderinthegeneratedimages.
ceptsencompasshumanemotionsandexperiences,andweoften By improving the prompt language model’s ability to optimize
relyonconcreteobjectstoillustratethem.Throughourmethod, promptsforbalancedoutcomesacrossdifferentgroups,wecan
webridgethedividebetweenhumanlanguageandtheabstract effectivelyaddressbiasissueswithouthavingtotrainthediffusion
conceptsandobjectsdepictedinimages,therebyenhancingunder- modelfromscratch.
standing.
(2)Ineachoptimizedprompt,thereare2or3concreteobjects REFERENCES
highlightedinred.Theseobjectscanbeaplace,anitem,anex-
[1] JoshAchiam,StevenAdler,SandhiniAgarwal,LamaAhmad,IlgeAkkaya,Floren-
pression,oranaction,andtheycanallbeeffectivelyrepresented ciaLeoniAleman,DiogoAlmeida,JankoAltenschmidt,SamAltman,Shyamal
withimages.Byharnessingtheadvancednaturallanguageunder- Anadkat,etal.2023. Gpt-4technicalreport. arXivpreprintarXiv:2303.08774
(2023).
standingcapabilitiesoftheGPT-4model,ourmethodconnectsthis [2] TomBrown,BenjaminMann,NickRyder,MelanieSubbiah,JaredDKaplan,
powerfullanguagemodelwithadiffusionmodeltogenerateimages PrafullaDhariwal,ArvindNeelakantan,PranavShyam,GirishSastry,Amanda
Askell,etal.2020.Languagemodelsarefew-shotlearners.Advancesinneural
thataremorecloselyrelatedtoreal-lifescenarios.
informationprocessingsystems33(2020),1877–1901.
[3] JiaoChen,LuyiMa,XiaohanLi,NikhilThakurdesai,JianpengXu,JasonHD
4.3 QuantitativeComparison Cho,KaushikiNag,EvrenKorpeoglu,SushantKumar,andKannanAchan.2023.
KnowledgeGraphCompletionModelsareFew-shotLearners:AnEmpiricalStudy
Wealsoshowthequantitativeevaluationresultsoftherelevance ofRelationLabelinginE-commercewithLLMs.arXivpreprintarXiv:2305.09858
score(RelScore)andaestheticsscore(AesScore)respectivelyin (2023).
[4] PrafullaDhariwalandAlexanderNichol.2021.Diffusionmodelsbeatganson
Table2basedontherelevanceandaestheticsscoreinSection3.3. imagesynthesis. Advancesinneuralinformationprocessingsystems34(2021),
Fromthistable,wecanseethat 8780–8794.
[5] HanzeDong,WeiXiong,DeepanshuGoyal,RuiPan,ShizheDiao,JipengZhang,
• SDXLwithPOACandReFLachievesthebestperformance KashunShum,andTongZhang.2023.Raft:Rewardrankedfinetuningforgener-
intermsofbothscores,thushighlightingtheefficacyofour ativefoundationmodelalignment.arXivpreprintarXiv:2304.06767(2023).
[6] ChenhaoFang,XiaohanLi,ZezhongFan,JianpengXu,KaushikiNag,Evren
approach.TheaestheticsscoreofSDXLwithPOACandReFL
Korpeoglu,SushantKumar,andKannanAchan.2024.LLM-Ensemble:Optimal
exhibitsamere4%improvementwhencomparedtoSDXL LargeLanguageModelEnsembleMethodforE-commerceProductAttribute
withPOACalone,indicatingthatourmethodcanenhance ValueExtraction.arXivpreprintarXiv:2403.00863(2024).
[7] OranGafni,AdamPolyak,OronAshual,ShellySheynin,DeviParikh,andYaniv
theaestheticqualityofthegeneratedimage.Furthermore, Taigman.2022.Make-a-scene:Scene-basedtext-to-imagegenerationwithhuman
thereisanoteworthyimprovementofover10%intherele- priors.InEuropeanConferenceonComputerVision.Springer,89–106.
[8] RinonGal,YuvalAlaluf,YuvalAtzmon,OrPatashnik,AmitHBermano,Gal
vancescore,signifyingthatthefine-tunedSDXLmodelcan
Chechik,andDanielCohen-Or.2023.Animageisworthoneword:Personalizing
alignmoreeffectivelywiththeoptimizedprompts. text-to-imagegenerationusingtextualinversion.ICLR(2023).WWW’24Companion,May13–17,2024,Singapore,Singapore ZezhongFanetal.
[9] YaruHao,ZewenChi,LiDong,andFuruWei.2022. Optimizingpromptsfor ConferenceonResearchandDevelopmentinInformationRetrieval.2067–2071.
text-to-imagegeneration.arXivpreprintarXiv:2212.09611(2022). [25] DustinPodell,ZionEnglish,KyleLacey,AndreasBlattmann,TimDockhorn,Jonas
[10] JonathanHo,ChitwanSaharia,WilliamChan,DavidJFleet,MohammadNorouzi, Müller,JoePenna,andRobinRombach.2023.Sdxl:Improvinglatentdiffusion
andTimSalimans.2022. Cascadeddiffusionmodelsforhighfidelityimage modelsforhigh-resolutionimagesynthesis. arXivpreprintarXiv:2307.01952
generation.JournalofMachineLearningResearch23,47(2022),1–33. (2023).
[11] NupurKumari,BingliangZhang,Sheng-YuWang,EliShechtman,RichardZhang, [26] AlecRadford,JongWookKim,ChrisHallacy,AdityaRamesh,GabrielGoh,
andJun-YanZhu.2023.Ablatingconceptsintext-to-imagediffusionmodels.In SandhiniAgarwal,GirishSastry,AmandaAskell,PamelaMishkin,JackClark,
ProceedingsoftheIEEE/CVFInternationalConferenceonComputerVision.22691– etal.2021.Learningtransferablevisualmodelsfromnaturallanguagesupervision.
22702. InInternationalconferenceonmachinelearning.PMLR,8748–8763.
[12] NupurKumari,BingliangZhang,RichardZhang,EliShechtman,andJun-YanZhu. [27] AlecRadford,JeffreyWu,RewonChild,DavidLuan,DarioAmodei,IlyaSutskever,
2023.Multi-conceptcustomizationoftext-to-imagediffusion.InProceedingsof etal.2019.Languagemodelsareunsupervisedmultitasklearners.OpenAIblog
theIEEE/CVFConferenceonComputerVisionandPatternRecognition.1931–1941. 1,8(2019),9.
[13] KiminLee,HaoLiu,MoonkyungRyu,OliviaWatkins,YuqingDu,CraigBoutilier, [28] AdityaRamesh,PrafullaDhariwal,AlexNichol,CaseyChu,andMarkChen.
PieterAbbeel,MohammadGhavamzadeh,andShixiangShaneGu.2023.Aligning 2022. Hierarchicaltext-conditionalimagegenerationwithcliplatents. arXiv
text-to-imagemodelsusinghumanfeedback. arXivpreprintarXiv:2302.12192 preprintarXiv:2204.061251,2(2022),3.
(2023). [29] AdityaRamesh,MikhailPavlov,GabrielGoh,ScottGray,ChelseaVoss,Alec
[14] SeunghunLee,JihoonLee,ChanHoBae,Myung-SeokChoi,RyongLee,and Radford,MarkChen,andIlyaSutskever.2021.Zero-shottext-to-imagegeneration.
SangtaeAhn.2024.OptimizingPromptsusingIn-ContextFew-ShotLearning InInternationalConferenceonMachineLearning.PMLR,8821–8831.
forText-to-ImageGenerativeModels.IEEEAccess(2024). [30] RobinRombach,AndreasBlattmann,DominikLorenz,PatrickEsser,andBjörn
[15] BrianLester,RamiAl-Rfou,andNoahConstant.2021.Thepowerofscalefor Ommer.2022.High-resolutionimagesynthesiswithlatentdiffusionmodels.In
parameter-efficientprompttuning.arXivpreprintarXiv:2104.08691(2021). ProceedingsoftheIEEE/CVFconferenceoncomputervisionandpatternrecognition.
[16] JiayiLiao,XuChen,QiangFu,LunDu,XiangnanHe,XiangWang,ShiHan,and 10684–10695.
DongmeiZhang.2023.Text-to-ImageGenerationforAbstractConcepts.arXiv [31] NatanielRuiz,YuanzhenLi,VarunJampani,YaelPritch,MichaelRubinstein,and
preprintarXiv:2309.14623(2023). KfirAberman.2023.Dreambooth:Finetuningtext-to-imagediffusionmodelsfor
[17] JiayiLiu,TinghanYang,andJenniferNeville.2024.CliqueParcel:AnApproach subject-drivengeneration.InProceedingsoftheIEEE/CVFConferenceonComputer
ForBatchingLLMPromptsThatJointlyOptimizesEfficiencyAndFaithfulness. VisionandPatternRecognition.22500–22510.
arXivpreprintarXiv:2402.14833(2024). [32] ChitwanSaharia,WilliamChan,SaurabhSaxena,LalaLi,JayWhang,EmilyL
[18] JianMa,JunhaoLiang,ChenChen,andHaonanLu.2023.Subject-diffusion:Open Denton,KamyarGhasemipour,RaphaelGontijoLopes,BurcuKaragolAyan,Tim
domainpersonalizedtext-to-imagegenerationwithouttest-timefine-tuning. Salimans,etal.2022.Photorealistictext-to-imagediffusionmodelswithdeep
arXivpreprintarXiv:2307.11410(2023). languageunderstanding.AdvancesinNeuralInformationProcessingSystems35
[19] RezaYousefiMaragheh,ChenhaoFang,CharanChandIrugu,ParthParikh,Jason (2022),36479–36494.
Cho,JianpengXu,SaranyanSukumar,MalayPatel,EvrenKorpeoglu,Sushant [33] ChristophSchuhmann,RomainBeaumont,RichardVencu,CadeGordon,Ross
Kumar,etal.2023.LLM-TAKE:Theme-AwareKeywordExtractionUsingLarge Wightman,MehdiCherti,TheoCoombes,AarushKatta,ClaytonMullis,Mitchell
LanguageModels.In2023IEEEInternationalConferenceonBigData(BigData). Wortsman,etal.2022.Laion-5b:Anopenlarge-scaledatasetfortrainingnext
IEEE,4318–4324. generationimage-textmodels.AdvancesinNeuralInformationProcessingSystems
[20] NinarehMehrabi,PalashGoyal,ApurvVerma,JwalaDhamala,VarunKumar, 35(2022),25278–25294.
QianHu,Kai-WeiChang,RichardZemel,AramGalstyan,andRahulGupta.2022. [34] YuxiangWei,YaboZhang,ZhilongJi,JinfengBai,LeiZhang,andWangmengZuo.
Istheelephantflying?resolvingambiguitiesintext-to-imagegenerativemodels. 2023.Elite:Encodingvisualconceptsintotextualembeddingsforcustomized
arXivpreprintarXiv:2211.12503(2022). text-to-imagegeneration.ICCV(2023).
[21] AlexNichol,PrafullaDhariwal,AdityaRamesh,PranavShyam,PamelaMishkin, [35] XiaoshiWu,KeqiangSun,FengZhu,RuiZhao,andHongshengLi.2023.Bet-
BobMcGrew,IlyaSutskever,andMarkChen.2021.Glide:Towardsphotorealistic ter aligning text-to-image models with human preference. arXiv preprint
imagegenerationandeditingwithtext-guideddiffusionmodels.arXivpreprint arXiv:2303.14420(2023).
arXiv:2112.10741(2021). [36] JiazhengXu,XiaoLiu,YuchenWu,YuxuanTong,QinkaiLi,MingDing,Jie
[22] JonasOppenlaender.2022. Promptengineeringfortext-basedgenerativeart. Tang,andYuxiaoDong.2023. Imagereward:Learningandevaluatinghuman
arXivpreprintarXiv:2204.13988(2022). preferencesfortext-to-imagegeneration.arXivpreprintarXiv:2304.05977(2023).
[23] JonasOppenlaender.2022.Ataxonomyofpromptmodifiersfortext-to-image [37] JiahuiYu,YuanzhongXu,JingYuKoh,ThangLuong,GunjanBaid,ZiruiWang,
generation.arXivpreprintarXiv:2204.13988(2022). VijayVasudevan,AlexanderKu,YinfeiYang,BurcuKaragolAyan,etal.2022.
[24] NikitaPavlichenkoandDmitryUstalov.2023.Bestpromptsfortext-to-image Scalingautoregressivemodelsforcontent-richtext-to-imagegeneration.arXiv
modelsandhowtofindthem.InProceedingsofthe46thInternationalACMSIGIR preprintarXiv:2206.107892,3(2022),5.
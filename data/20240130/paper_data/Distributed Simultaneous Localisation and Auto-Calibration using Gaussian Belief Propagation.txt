IEEEROBOTICSANDAUTOMATIONLETTERS.PREPRINTVERSION.ACCEPTEDJANUARY,2024 1
Distributed Simultaneous Localisation and
Auto-Calibration using Gaussian Belief Propagation
Riku Murai, Ignacio Alzugaray, Paul H.J. Kelly and Andrew J. Davison
Abstract—We present a novel scalable, fully distributed, and
online method for simultaneous localisation and extrinsic cal- Localisation
ibration for multi-robot setups. Individual a priori unknown
robot poses are probabilistically inferred as robots sense each Robot
otherwhilesimultaneouslycalibratingtheirsensorsandmarkers
extrinsic using Gaussian Belief Propagation. In the presented
experiments, we show how our method not only yields accu-
rate robot localisation and auto-calibration but also is able to
perform under challenging circumstances such as highly noisy
measurements, significant communication failures or limited
communication range.
Index Terms—Distributed Robot Systems, Localization, Cali-
bration and Identification
Robot
Robot
I. INTRODUCTION
AS robots become increasingly ubiquitous, more of them
With Calibration Parameters Coordinate Frames
are expected to jointly operate and coordinate in shared
environments to perform complex and collaborative tasks. For
many of the tasks, it is critical to estimate the robot’s pose
accurately and precisely, also known as robot localisation.
While many localisation systems have been proposed in the
literature, most of the works focus on single-robot setups.
However,relyingsolelyonasinglerobot’sproprioceptiveand
exteroceptive sensors for localisation is challenging and often
limiting, especially in a multi-robot scenario, where relative
localisation is crucial to ensure that robots interact safely and
effectively.
Thismotivatesmulti-robotcollaborativelocalisation,where
robots utilise each other’s observations to enhance their own Fig. 1: Overview of the proposed auto-calibrating localisa-
localisationaccuracyandtherefore,theoverallaccuracyofthe tion system for three heterogeneous robots (top). Each robot
multi-robot system. The accuracy of co-localisation, however, observes the markers M placed on its peers to establish
is heavily reliant on the quality of extrinsic calibration of the measurementz¯ SM usingsensorS mountedontopofamoving
sensors(e.g.visualcamerarigs,rangefinders)andthemarkers base B. Using the proposed methodology, the robots’ relative
they can detect on other robots (e.g. AprilTags, reflective positionsandtheircalibrationparameterscanberetrievedina
markers). While most works often take such extrinsic calibra- distributed and asynchronous fashion performing probabilistic
tion for granted, in practice, the default in-factory calibration inference on a factor graph. We refer to T WB as WB for
can only be precise to a certain degree. This is particularly clarity.
important in multi-robot setups, where manual calibration
becomes impractical and highly accurate in-factory, per-robot each other while simultaneously estimating and refining the
calibration incurs high operational costs. extrinsic calibration of their sensor and their onboard marker
In this paper, we envision a system (see Fig. 1) in which on-the-fly. In summary, the contributions of our work are:
multiplerobotsco-localisethemselvesastheymoveandsense
• A novel method for distributed multi-robot localisation
Manuscript received: July, 14, 2023; Revised November, 20, 2023; Ac- and extrinsic calibration of both the sensor and the
ceptedDecember,18,2023. observed marker on the robots. Our approach builds
ThispaperwasrecommendedforpublicationbyEditorSvenBehnkeupon
on top of our previous work Robot Web [1], originally
evaluationoftheAssociateEditorandReviewers’comments.Thisworkwas
supportedbyEPSRC(EP/K008730/1andEP/P010040/1). limited to pose variables in SE(2) given range-bearing
Authors are with Department of Computing, Imperial College observations. We extend the framework by simultane-
London, UK {riku.murai15, i.alzugaray, p.kelly,
ously estimating the SE(3) pose of the robots and their
a.davison}@imperial.ac.uk
DigitalObjectIdentifier(DOI):seetopofthispage. extrinsic calibrations using Gaussian Belief Propagation
4202
naJ
62
]OR.sc[
1v63051.1042:viXra2 IEEEROBOTICSANDAUTOMATIONLETTERS.PREPRINTVERSION.ACCEPTEDJANUARY,2024
(GBP) to further improve the accuracy of multi-robot is not applicable to online robotic applications with a moving
localisation. onboard sensor. Non-parametric belief propagation is used
• We present a formulation of the inter-robot factor that in [14] to perform calibration and localisation of sensors.
avoids the sharing of the calibration variables amongst The method is sampling-based; hence less efficient than GBP
multiple robots, sparing communication effort between and assumes that the sensors are stationally. LaSLAT [15]
robots and thus enhancing the scalability of the system. performs localisation and calibration of the sensors together
• We provide an extensive evaluation of our approach in with tracking of a target. In LaSLAT, the sensor poses are
comparison with other state-of-the-art alternatives and assumedtobestaticandarenotsuitableforlocalisingmultiple
measure the performance of the method under extreme moving robots, which is the problem we address in this work.
conditions such as a large number of communication
failures,alargeproportionofoutlyingmeasurements,and
a limited communication range. B. Multi-Robot Localisation
Manyrecentadvancementsinmulti-robotlocalisationlever-
II. BACKGROUND
age the advancements in distributed pose-graph optimisation
A. Multi-Device Calibration (PGO). For example, [16] uses chordal-relaxation to make
the underlying PGO problem linear, and solves them using
Calibration is vital for robotic operations and, as such, the
a Gauss-Seidel solver. Semidefinite Programming (SDP) re-
body of literature on the subject is vast. Due to space limi-
laxation together with Riemannian block coordinate descent
tations, our literature review focuses on calibration processes
is used in [17], [18] which enables verification of the correct-
that involve multiple cameras or multiple robots.
ness of the estimates, and is decentralised and asynchronous.
Accurate extrinsic calibration is often critical in multi-
A distributed SLAM system [19] is built upon these ap-
device systems. Different robots have different base frames,
proaches,demonstratingtheirpracticality.However,theabove
andwithinarobot,theexactpositionofthesensorandobserv-
approaches require a full relative transformation between the
ableonboardmarkermaynotbeavailable.Acommoninstance
robots and can only handle isotropic covariance. This could
of this is hand-eye calibration. From a set of known relative
be limiting, for example, if the inter-robot observations are
transformations, the calibration process seeks to establish the
all range-bearing, as we will explore in this paper. More
undetermined relationship, often the relative transformation
recently, methods use range measurements [20] or bearing
between the robot base frame and sensor frame [2]. These
measurements [21] and show that it is possible to obtain
methods can be extended to support multiple robots using
certifiably optimal solutions again via SDP relaxation. While
iterativemethods[3]orprobabilisticapproaches[4].However,
all PGO-based methods achieve good localisation accuracy,
these methodologies primarily focus on offline settings where
the formulation is often tailored and these methods do not
calibration precedes operational activities. In multi-robot se-
generalise to other problem instances.
tups, [5] proposes a method to perform online calibration
More general methods for multi-robot localisation such
of infra-red sensors while estimating the parameters of the
as DDF-SAM [22], and DDF-SAM2 [23] operate on factor
underlying physical sensor model.
graphs. They rely on Gaussian elimination and require robots
Multi-camera rigs are becoming increasingly popular as
to exchange Gaussian marginals about shared variables. The
they can significantly extend the surrounding perceptive field
communication; however, increases quadratically with the
for any robot and even directly yield stereo-depth capabilities
number of shared variables. Alternating Direction Method
provided there is view overlap. However, accurate calibration
of Multipliers (ADMM) has been employed for distributed
of such these rigs is often challenging, leading to several
SLAM [24] or to efficiently share map points for distributed
works on automatic offline calibration [6], [7], [8]. The
bundle adjustment [25]. However, unlike elimination-based
method in [9] carries out continuous self-calibration using an
approaches only the point-estimates are recovered.
extendedKalmanfilterinastereosetup.Beyondtwocameras,
self-calibration of multiple cameras extrinsic is achieved on Our recent work, Robot Web [1] uses GBP to perform
an aerial vehicle in [10], whereas an information-theoretic localisation.Theproposedapproachoperatesongeneralfactor
approach described in [11] is able to operate on a rig of graphs; the underlying GBP algorithm is asynchronous and
eight cameras. Notably, while these methods are online, they decentralised, thus the system is scalable to many robots.
predominantlyaddresssetupswithasinglerobotwithmultiple
onboard sensors, rather than a truly distributed, multi-robot
III. PRELIMINARIES
system.
In the field of sensor networks, CaliBree [12] performs
A. Factor Graphs
fullydistributedsensorcalibrationbymeasuringdisagreement
between uncalibrated and calibrated sensors upon rendezvous A factor graph is a type of bipartite graph G = (X,F,E)
event.Thismethod,however,isonlylimitedtocalibrationand consisting of variable nodes X = {x i} i=1:Nv connected by
does not address the localisation of the devices. In [13], GBP edges E to factor nodes F = {f s} s=1:Nf. A factor graph
is used in a distributed fashion for intrinsic calibration and represents the factorisation of the joint distribution: p(X) ∝
refinement of the camera poses. The method solves structure-
(cid:81)Nf
f (X ), where X = n(f ). Here, n(v) is the set of
s=1 s s s s
from-motion, where multiple cameras are stationary; hence, it neighbouring nodes connected via edge to the node v.MURAIetal.:DISTRIBUTEDSIMULTANEOUSLOCALISATIONANDAUTO-CALIBRATIONUSINGGBP 3
B. Belief Propagation
Before Calibration After Calibration
Belief Propagation (BP) [26] is an algorithm used to infer
a marginal distribution of p(x ) for each variable x ∈ X Markers M
i i
of a joint distribution p(X) by passing messages among
neighbouring nodes. As such operation is local, the algorithm
is highly parallelisable and suitable for distributed inference.
BP has promising applications in robotics, including multi- Sensors S
hypothesis and non-Gaussian inference [27].
InBP,ateachiterationt,factorf sendsamessagemt
s fs→xi
to all variables x ∈ n(f ), and variable x sends back a
i s i
message mt xi→fs to all factors f s ∈ n(x i). At a variable x i, Fig. 2: Example of calibration of the extrinsic of the sensors’
the product of all the incoming messages forms the belief poseandmarkers’positionusingtheproposedmethod,where
bt(x i): we artificially set the ground-truth extrinsics to be the same
(cid:89)
bt(x )= mt−1 (x ) , (1) for visual clarity. We overlay the calibration estimates of 64
i fs→xi i
fs∈Fi robotsfromrandomlyinitialisedstates(left),andvisualisethe
estimated extrinsics after the calibration (right).
where F = n(x ). The outgoing message to f from x is
i i s i
simply the product of all other incoming messages from F :
i
the factor graph representation of the posterior P(X|Z), each
mt (x )=
bt(x i)
. (2) x i is a variable node, and each l m is a factor node connected
xj→fs j mt f− s→1 xi(x i) via edge to nodes X m. The reader is referred to [33], [34] for
more details on GBP.
The message from a factor to a variable message is:
(cid:88) (cid:89)
mt fs→xi(x i)= f s(X s) mt xj→fs(x j) , (3)
D. Gaussian Belief Propagation with Lie Groups
Xs\xi xj∈Xs\xi
Given a non-linear measurement prediction function h
m
where X s = n(f s). A factor takes a product of all the it’s first-order Taylor approximation is: h m(x) ≈ h m(x 0)+
incomingmessagestogetherwithitspotentialandmarginalises J mh m(x−x 0), J
m
= d dh xm| x=x0. We retrieve the likelihood
out all the other adjacent variables X s \x i to compute the ofthedescentdirection∆x=x−x 0 thatminimisesthelocal
outgoing message to x i. residual as in [1]:
l (∆X ;z¯ )=
m m m
C. Gaussian Belief Propagation
N−1(∆X ;JTΛ (z¯ −h (x )),JTΛ J ) . (5)
m m m m m 0 m m m
GBP[28]isasubsetofBPwhereallthefactorsand,hence,
the joint posterior distribution are Gaussians. Note that GBP Forclarity,the∆isdroppedfromthenotationofthelikelihood
has no theoretical convergence guarantees when applied to for the remaining of the paper. Energy of the factor is defined
graphs with cycles and yet, it has shown robust performance as: E m =(z¯ m−h m(x 0))⊤Λ m(z¯ m−h m(x 0)).
across many different tasks [29], [30], [31]. We further apply GBP to variables on the Lie Group as in
We use canonical representation of Gaussian: [1], which rely on the following expressions:
N−1(x;η,Λ) ∝ exp(−1x⊤Λx + η⊤x), where we
2 Y =X ⊕Xτ ≜X ◦Exp(Xτ)∈M , (6)
define information vector η = Λµ and information matrix
Λ = Σ−1. Measurements Z = {z¯}
m=1:Nz
are modelled as Xτ =Y ⊖X ≜Log(X−1◦Y)∈T XM , (7)
z¯ =h (X )+ϵ, where h (·) is a measurement prediction
m m m m where X,Y are points on the Lie Group M, and Xτ is a
function, and ϵ is a zero-mean Gaussian ϵ ∼ N(0,Σ ).
m tangent vector in Lie algebra T M defined locally around a
X
Assuming independence of the observations, the likelihood
point X. Functions Exp, Log are the exponential, logarithmic
of the observations is:
mapping from M → T M and T M → M respectively,
X X
(cid:89)Nz allowing us to move back and forth between Lie Group and
l(X;Z)= l m(X m;z¯ m)
Lie algebra. Composition operation ◦ uses the group property
m and imposes that the composition of the elements remains in
(cid:89)Nz
1 the Lie Group. To simplify the notation, we will drop ◦ when
∝ exp(− ∥z¯ −h (X )∥2 ) , (4)
2 m m m ΣM composing two transformations.
m
wherethelikelihoodl(X;Z)∝p(Z|X).Thisnotationisused
IV. DISTRIBUTEDLOCALISATIONAND
to clarify that likelihood is a function of X, with Z as its
EXTRINSICCALIBRATION
parameter [32]. We are interested in estimating the configura-
A. Gaussian Belief Propagation for Distributed Inference
tionwhichmaximisestheMaximumAPosteriori(MAP)esti-
mate: XMAP =arg max l(X;Z)P(X). GBP achieves this LetGbetheglobalfactorgraphwhichwewanttoperform
X
via marginal inference by computing the marginal posterior inference over. In distributed GBP, robots own a factor graph
P(x |Z)=N(µ ,Σ ) where µ =xMAP for all x ∈X. In Gω each, and their union is G = (cid:83) Gω. Each robot has
i i i i i i ω∈Ω4 IEEEROBOTICSANDAUTOMATIONLETTERS.PREPRINTVERSION.ACCEPTEDJANUARY,2024
ownership of its pose variables and the factors corresponding
to the observations it made, i.e. the nodes that their local Robot
graph Gω consists of. This is important as the global factor
graph G is partitioned amongst the robots Ω; hence, the Calibration
marginalestimatesobtainedbysolvingthedistributedproblem
using GBP are exactly the same as the marginal estimates of
Range Bearing Range Bearing
the global problem obtained via centralised GBP under an
assumption of perfect communication.
Odometry
Distributed inference is achieved by each robot α ∈ Ω
Robot
performing GBP message passing on their local graph Gα. Odometry
Along the edges of a factor fαβ owned by α, a factor-to-
Fig. 3: Reducing the inter-robot communication by restructur-
variable message m (xβ) is sent from α to β via inter-
fαβ→xβ ing the factor graph. We refer to T as WB for clarity.
WB
robotcommunication.Similarly,βsendsbacktoαvariable-to-
Left: The inter-robot factor (range bearing) depends on four
factor message, m (xβ). A factor-to-variable message
xβ→fαβ variables: the poses of the robots, the marker M, and the
is a Gaussian distribution N(µ ,Λ−1 ), and a variable-
f→x f→x sensor S pose with respect to the robot base B. Right
to-factor message is a linearlisation point x¯ and a Gaussian
We introduce the marker and sensor variable in the world
distribution N(µ ,Λ−1 ).
x→f x→f coordinate frame using Eq. (10). While the total number of
variables increases, the inter-robot factors depend on fewer
variables, thus reducing the communication requirements.
B. Problem Formulation
The range bearing factor relating the sensor Tα and the
WSt
marker tβ at time t is:
This section details how multi-robot localisation and the WMt
extrinsic calibration of their onboard sensors and observable l (Tα ,tβ ;z¯αβ )∝
s WSt WMt SM
markersaresimultaneouslyanddistributedlyperformed.Inthe
1
consideredsetting,eachrobotisequippedwitharange-bearing exp(− 2∥z¯α Sβ
M
−⋄ h s(Tα WSt,tβ WMt)∥2 Σs) , (8)
sensor S that observes the other robot’s onboard marker
where we use the notation −⋄ from [35], an operation on the
M. While the addressed setup is representative of realistic
composite manifold (⊖ operation is applied to each block of
constraints of many robotic applications, here we describe the
composites separately), and h is the function that predicts
formulation in general terms, so that it can easily be extended s
range bearing measurement between Tα and tβ .
tosupportmoreinformation-richmeasurementssuchasdirect WS WM
2) Robot Odometry: We assume that odometry measure-
relative transformations (e.g. using visual sensors and fiducial
ments T¯ ∈ SE(3) (e.g. IMU/wheel odometry) are
markers). Bt−1Bt
madeavailabletoeachrobot.Anodometryfactorpenalisesthe
The relative transformation from the base of the robot deviationbetweenobservationT¯ andthetwoestimated
B to its sensor S is T ∈ SE(3), where the notation Bt−1Bt
BS consecutive poses T ,T ∈SE(3):
T represents the pose of S in the coordinate frame of WBt−1 WBt
BS
B. Similarly, t BM ∈ R3 represents the marker position M l o(T WBt−1,T WBt;T¯ Bt−1Bt)∝
relativetoB.Sinceonlyrange-bearingsensorsareusedinthe 1
current setup, the orientation of the marker is not observable exp(− 2∥T¯ Bt−1Bt ⊖(T− W1 Bt−1T WBt)∥2 Σo) . (9)
andthusnotincludedinthisspecificproblemdefinition.When
This assumes that the odometry measurement is measured
the sensor Sα in robot α observes the marker Mβ in robot β,
in the base frame B. This property can be enforced by
arelativemeasurementz¯αβ isgenerated.Theinitialestimates
SM choosing a suitable base frame given prior information about
of T and t are expected to be noisy due to inaccurate
BS BM thewheel/IMUposition.However,iftheodometryisprovided
calibration. Our work optimises over the extrinsic calibration
via the sensor S (i.e. visual odometry), we can replace the
using the observations z¯αβ robots accumulate over time as
SM transformations in the base frame B with a transformation in
depicted in Fig. 2.
the sensor from S.
LetΩ={α,β,γ,...}bethesetofrobots,T bethenumber
3) Calibration Factor: In Eq. (8), we have used
of considered time-steps, and Tω denote the pose of the
WBt T WSt,t WMt position of sensor S and marker M in the
base of the robot ω at time t in the world coordinate. To
world coordinate frame W at time t. A simple solution to
perform marginal inference over all, Tω ,tω ,Tω ,∀ω ∈
BS BM WBt obtain the position in the world coordinate is to use all
Ω,∀t∈{1,...T}, we consider the following factors. Tα ,Tα ,Tβ ,tβ inside the likelihood function, as
WBt BS WBt BM
1) RangeBearingSensor: Inoursetup,robotscanobserve shown in the left row of Fig. 3. However, this has a clear
theotherrobotsusingrange-bearingsensors.Weusespherical disadvantage: robots must communicate both the calibration
coordinate (r,θ,ϕ), i.e. radial distance, azimuthal angle, and estimate and the pose estimate with each other. This not
elevationanglerespectively.Allanglesareparameterisedusing only doubles the inter-robot communication effort but also
SO(2), hence; the range bearing measurement is z¯αβ ∈ exposes internal states (i.e. sensor calibration) that do not
SM
⟨R,SO(2),SO(2)⟩, a composite manifold. need to be revealed to other robots. Furthermore, it createsMURAIetal.:DISTRIBUTEDSIMULTANEOUSLOCALISATIONANDAUTO-CALIBRATIONUSINGGBP 5
TABLE I: Accuracy of the proposed method (‘Ours’) and the
small cycles which often leads to overconfidence [28]. Hence,
global, centralised NLLS LM solver (‘LM’) at convergence
this motivates the redesign of a factor to only share the pose
as a function of the number of robots N and the enabling
estimate of the sensor and the marker between robots.
of autocalibration. Results include the RMSE ATE and ARE
The objective of the calibration is to find a transformation
T ∈ SE(3) such that: T = T T . This relation- of the robot poses of their bases in the world frame T WB,
BS WS WB BS
the extrinsic calibration of their sensor T and marker t
ship as a likelihood is defined as: BS BM
(only translation) where applicable.
l (T ,T ,T )∝
c WS WB BS
N T Initial LMw/Calib. Oursw/Calib. Oursw/oCalib.
1
exp(− ∥Log(T−1 T T )∥2 ) . (10) [m] [deg] [m] [deg] [m] [deg] [m] [deg]
2 WS WB BS Σc 16 TWB 0.432 7.422 0.065 1.858 0.084 1.970 0.093 2.313
The likelihood for calibration of the marker can be derived
TBS 0.080 8.852 0.023 1.156 0.027 1.268 – –
tBM 0.085 – 0.020 – 0.022 – – –
in a similar way. This allows us to create a factor graph as 32 TWB 0.434 7.471 0.051 1.742 0.062 1.811 0.075 2.138
illustratedintherightrowofFig.3,whereonlyT WSt,t
WMt
TBS 0.082 8.856 0.021 1.035 0.025 1.251 – –
is connected between the robots. While this formulation in-
tBM 0.087 – 0.019 – 0.022 – – –
64 TWB 0.436 7.402 0.043 1.684 0.054 1.761 0.066 2.082
creasesthetotalnumberofvariablesinthefactorgraph,fewer TBS 0.083 8.810 0.020 0.969 0.025 1.214 – –
variablesareconnectedtotheinter-robotfactor,thusreducing tBM 0.088 – 0.018 – 0.020 – – –
the data transfer between the robots.
128 TWB 0.434 7.385 0.039 1.646 0.049 1.732 0.060 2.041
TBS 0.085 8.740 0.018 0.969 0.022 1.202 – –
tBM 0.087 – 0.017 – 0.020 – – –
C. Adaptive Regulariser on the Factor
for such experiments would be extremely challenging. As a
Due to the nature of SE(3), the objective function which
verification of the applicability of our method to the real-
we are minimising is non-linear and non-convex; challenging
world, we evaluate using UTIAS MR.CLAM dataset [36].
for any iterative optimisers, but especially for local ones such
To simulate sensor noise, observations are corrupted by
asGBPwithnoaccesstotheglobalobjectivefunction.Inour
applying zero-mean Gaussian noise. Odometry measurements
case, the Lie group extension of GBP [1] was insufficient to
arecorruptedwithnoisewithσt ,astandarddeviationof0.01
consistently reach convergence. Hence, here, we introduce an B
meter per meter travelled for the translation, and with σR, a
adaptive regularisation term in GBP to assist convergence. B
standard deviation of 1 degree per 90 degrees rotated for the
For each of the factors f , with a likelihood as defined in
m rotation.Inter-robotmeasurementsarecorruptedintheirrange
Eq. (5), we add a zero-mean prior N−1(0,λ I). The term
m and bearing readings with a standard deviation of σ : (0.05m,
λt is local to the factor and is updated adaptively based on s
m 5◦). 3D range bearing measurements (r,θ,ϕ) are restricted
thedifferencebetweenthecurrentlocalfactorenergyEt and
m to the three closest observable robots, to imitate realistic
last iterations Et−1:
m and limited inter-robot observability. We further restrict the
(cid:40)
λt−1·λ Et −Et−1 >ϵ range-sensing to be limited to |θ| < 60◦ and |ϕ| < 60◦, to
λt = m ↑ m m λ , (11)
m λt−1/λ otherwise simulate the field of view limitations of, for instance, visual
m ↓ sensors. Robots are randomly initialised in translation and
where a threshold ϵ λ is required to avoid the weighting orientation within a 20m × 20m × 20m space. We assume
from increasing when the factors’ energy stops changing thattheinitialposeoftherobotsisknowntoacertaindegree,
significantly near convergence, and λ ↑,λ ↓ are the increase, within a noisy initial guess with standard deviation 0.01m, 1◦
decreasefactorrespectively.Intuitively,atthebeginningwhen respectively for the translation and the rotation. We simulate
far from optima, the adaptive regulariser encourages small therobots’motionbydrawingrandomsamplesfromauniform
descent steps. As the factors become more confident about distribution,U(0,1)mfortranslationalmotionandU(−π,π)◦
its approximation of the curvature (i.e. made multiple suc- for rotational motion, across all three dimensions. Finally, the
cessive descents), larger descent steps are performed. While initialcalibrationofsensorS andmarkerM alsodeviatefrom
the principle of this approach is the same as Levenberg- the ground-truth with a standard deviation of the translational
Marquardt, fundamental this weighting scheme is computed part of extrinsic of sensor σt and marker σt set to 0.05m,
S M
and applied purely locally, and the step is always taken even and the standard deviation of the rotation part of the sensor
if the local energy increases. This way, no synchronisation or frame σR =5◦.
S
communication is required when applied distributedly. To enhance the stability of GBP, for the adaptive regu-
Assuming that the objective function is strictly con- larisation, we use the default parameter of λ = 10,λ =
m ↓
vex, the addition of the adaptive regualisation term will 9,λ = 11, ϵ = 10−4. While not sensitive to the choice of
↑ λ
not change the optimal solution. As the GBP converges, parameters, we found GBP to diverge in many cases without
lim λm→0l s(X s;z¯ s)N−1(0,λ mI) = l s(X s;z¯ s), and λ m → 0 adaptiveregularisation.Additionally,30%ofbothinternaland
as the energy decreases or reaches local convergence. externalGBPmessagesarerandomlydropped,asanempirical
heuristics to improve the convergence of the system [37].
V. EVALUATION Unless specified otherwise, for robustness against outlying
We mainly evaluate our approach in a simulated environ- measurements,wedynamicallyscaletheinformationmatrixof
ment with a vast number of robots, as obtaining the ground- therange-bearingsensorfactorusingaDCSrobustkernel[38]:
(cid:16) (cid:17)
truth extrinsic calibration and robot poses in the real-world s =min 1, 2Φ , with Φ=10. For each range-bearing
m Φ+Em6 IEEEROBOTICSANDAUTOMATIONLETTERS.PREPRINTVERSION.ACCEPTEDJANUARY,2024
0.10 GBP SOR(γ=0.9) 0.14 0% 0.35 0.5
0.09 L S S SO O OM R R R( ( (γ γ γ= = =0 0 0. . .1 3 5) ) ) G S S SO O OS R R R(γ ( ( (= γ γ γ= = =1. 1 1 10 . . .) 1 3 5) ) ) 0.12 2 4 60 0 0% % % 0.30 0.4
0.08 SOR(γ=0.7) 8 90 0% % 0.25
0.10 95% 0.3
0.07 9 19 0% 0% 0.20
0.08
0.06 0.15 0.2
0.06 0.10
0.05 0.1
0.04 0.05
0.04 0 30 60 90 120 150 180 210 240 0 30 60 90 120 150 180 210 240 0.0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 0 4 6 8 10 20 Inf
Iterations Iterations OutlierNoiseFraction CommunicationRange[m]
0.10 0.085 0.09 0.09
0.09 0.080 0.08 0.08
0.08 0.075 0.07 0.07
0.070
0.06 0.06
0.07 0.065
0.05 0.05
0.060
0.06
0.04 0.04
0.055
0.05 0.050 0.03 0.03
0.04 0 30 60 90 120 150 180 210 240 0.045 0 30 60 90 120 150 180 210 240 0.02 0.0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 0.02 0 4 6 8 10 20 Inf
Iterations Iterations OutlierNoiseFraction CommunicationRange[m]
0.10
0.09
0.09 0.08 0.20 0.08
0.07
0.08
0.07 0.15 0.06
0.07
0.05
0.06 0.10
0.06 0.04
0.05 0.05 0.05 0.03
0.02
0.04 0 30 60 90 120 150 180 210 240 0 30 60 90 120 150 180 210 240 0.0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 0 4 6 8 10 20 Inf
Iterations Iterations OutlierNoiseFraction CommunicationRange[m]
Fig. 4: From top to bottom: RMSE ATE for T , T , Fig. 5: From top to bottom: RMSE ATE for T , T ,
WB BS WB BS
t . RMSE ARE omitted as it follows the same trend. t . RMSE ARE omitted as it follows the same trend.
BM BM
Left: Comparison of different distributed alternatives (Final Left: Effect of increasing the fraction of outlier noise. Non-
RMSE ATE of global, non-distributed LM shown for refer- Gaussiannoiseisaddedtotheinter-robotsensormeasurement
ence).Right:Analysisofrobustnessregardingcommunication to simulate outliers. Right: Impact on the overall accuracy
failures by randomly dropping a percentage of the inter-robot when robots are limited to only communicating with peers
GBP messages in each iteration. 100% indicates that all inter- within the specified range.
robot messages are dropped, preventing co-localisation.
measurement, the information matrix Λ is scaled by s2 .
m m
Inallthepresentedexperiments,unlessspecifiedotherwise,
weconsiderN =64robotsthatrandomlyexecute50motions,
incrementally growing the underlying factor graph (see Sec- from enabling or disabling auto-calibration for the proposed
tionIV-B)andperforming30GBPmessage-passingiterations method,i.e.whethertheinitialnoisycalibrationisoptimisable
aftereachofthesemotions.Theexperimentalresultsaggregate orremainsfixed,respectively.Therobustkernelisdisabledfor
information from a total of 10 randomised runs, where we this experiment to simplify the comparison. The accuracy of
oftenreporttheaverageRootMeanSquaredError(RMSE)of the different alternatives is compared in Table I. Despite the
Absolute Trajectory Error (ATE) and Absolute Rotation Error proposed method being distributed and without any global,
(ARE) to measure the accuracy of the system as described second-order perspective of the whole problem, experimental
in [16] for multi-robot setup. results show no significant differences with respect to the
global LM solver at convergence. As expected, the larger the
number of robots N, the higher the accuracy of all methods
A. Comparison with Centralised Factor-Graph Solvers
as the underlying factor graph becomes denser and thus,
Here we compare the proposed incremental GBP-based more information-rich. Observe that the proposed GBP-based
approach with a global Non-Linear Least Squares (NLLS) approach is still able to profit from a denser graph despite
Levenberg-Marquardt (LM) solver (implemented in The- including more cycles. We additionally report the results of
seus [39]) that processes the full graph as a whole batch. We our method while considering that the noisy initial calibration
evaluate how the accuracy of the overall system varies as a is correct. This yields obviously worse results than when we
function of the number of robots N and the effect resulting optimisethegraphwhichconsidersthecalibrationparameters.
]m[BWTETAESMR
]m[SBTETAESMR
]m[MBtETAESMR
]m[BWTETAESMR
]m[SBTETAESMR
]m[MBtETAESMR
]m[BWTETAESMR
]m[SBTETAESMR
]m[MBtETAESMR
]m[BWTETAESMR
]m[SBTETAESMR
]m[MBtETAESMRMURAIetal.:DISTRIBUTEDSIMULTANEOUSLOCALISATIONANDAUTO-CALIBRATIONUSINGGBP 7
TABLE II: Evaluation of our method on real-world data.
B. Comparison with Distributed Factor-Graph Solvers
ResultsincludetheRMSEATEofoursystemwithandwithout
We compare our method against other distributed solvers: the autocalibration enabled, on UTIAS MR.CLAM dataset 1-
block Gauss-Seidel (GS) and its relaxations block Successive 4. The noise column indicates whether a noise was artificially
Over-Relaxation(SOR)[40].InGBPmessagesareexchanged added to the sensor calibration to simulate an uncalibrated
in parallel and thus do not require coordinated updates. We system.
favour GS and SOR by counting each iteration as an ordered
Noise AutoCalib. 1 2 3 4 Avg.
sweep,whererobotssequentiallyexchangetheirupdatedstate ✗ ✗ 0.102 0.0976 0.0690 0.0712 0.0851
in a specific order. In this comparison, all the methods are ✗ ✓ 0.102 0.0967 0.0706 0.0694 0.0847
provided with the whole graph to be optimised from the ✓ ✗ 0.122 0.121 0.0974 0.0855 0.107
✓ ✓ 0.111 0.120 0.0825 0.0809 0.0984
beginning instead of incrementally growing and solving the
problem, with 16 robots making 10 random motions. We
3) Communication Range: To mimic realistic, real-world
use the same relaxation parameter as reported in [16]. The
conditions, we further limit the communication radius of the
robust kernel is disabled for this experiment to simplify the
robots to 4, 6, 8, 10 and 20m and report the results on the
comparison.
rightrowofFig.5,includingalsonocommunication(0m)and
Results are presented in the left column of Fig. 4. GBP infinite communication range (‘Inf’) for completeness. While
showsafasterconvergenceratethanGSandSORinthenum- a longer communication range proves to be indeed beneficial,
ber of iterations (the aforementioned global and centralised our method is able to optimise all the parameters effectively
LM method is also shown for reference). Presented results even with a severely limited communication radius. For refer-
match prior comparisons between GBP and Successive Over- ence, only 24% of the robots are within communication range
Relaxationin[28].NotethatGSandSORproducemarginally at a 10m radius whereas the percentage increases to 85%
better extrinsic at by trading off a significantly worse body at a 20m radius and yet such a drastic increase only yields
frame localisation. insignificant returns in terms of accuracy.
Theimposedlimitonthecommunicationrangealsoteststhe
system’s asynchronicity. Since an agent cannot communicate
C. Robustness Analysis
at the time of observation if the other agent is too far away,
1) CommunicationFailureandAsynchronicity: Weanalyse the agent needs to wait for a rendezvous event in order to
the robustness of the system regarding potential communica- exchange information. Our result hence further highlights that
tion failures, modelled by randomly dropping a percentage of our system is capable of handling asynchronous events.
the inter-robot GBP messages in each iteration, and present 4) Real-world Experiments: To verify the applicability
the results in the right column of Fig. 4. In this experiment, of our approach to real-world data, we have performed
the whole graph is available from the beginning of the localisation and auto-calibration using UTIAS MR.CLAM
proposed algorithm with 16 robots and 50 random motions dataset[36].Astherobotsaregroundvehicles,wemodelthem
to clearly identify the convergence trends. The behaviour withSE(2)posesand2Drange-bearingobservations.Weuse
of the system remains largely unaffected by communication datasets1-4,wherethelandmarksandtherobotsarerandomly
failure up to around 80%, communication failure. ATE of scattered. We set σ Bt = (0.05m,0.01m),σ BR = 5◦,σ s =
T initially increases as poses are initially uncertain and (0.08m,2◦). The dataset is subsampled at 1s intervals, and
WB
are down-weighted by the robust kernel. However, within a we use sliding window-based GBP [1] with a window size of
few iterations, the poses are correctly optimised, reducing 30.
the ATE. Even at an extremely high communication failure As presented in Table II, as the robots are calibrated, auto-
rate, the RMSE ATE still gradually decreases as we perform calibration does not yield better RMSE ATE. We simulate an
more iterations and thus, more rounds of communication. uncalibrated system by artificially adding noise to the sensor
The experiment further demonstrates the asynchronicity of calibration with a standard deviation of 0.05m and 10◦ for
our approach, where the message order does not significantly translation and rotation respectively. While this manipulation
impact the overall performance. This is a crucial property of calibration is artificial, this data still contains challenging
requiredforreal-worlddeployment,wherethecommunication real-world sensor and odometry noise. In such a case, auto-
channel is potentially unreliable, especially at scale. calibration reduces the ATE, indicating that our method has
2) Robustness to Outlier Measurements: As real-world successfully filtered out the biases even with real-sensor data.
inter-robotsensingisoftenchallenging(e.g.misidentification,
sensor failure), we investigate the robustness of the system
VI. CONCLUSION
to extreme, non-Gaussian outlier measurements following a In this paper, we presented a method for online, simul-
uniform noise. As presented in the left row of Fig. 5, results taneous localisation and automatic extrinsic calibration of
indicatethat,whileperformanceisreasonablyimpactedasthe sensors and observable markers, by building on our previous
fraction of outliers increases, the system remains stable even work Robot Web [1]. Our work performs distributed and
for an extremely high percentage of non-Gaussian outliers. asynchronous inference on the factor graph using GBP, and
Even at 40%, we observe a relatively small increase in we have demonstrated its robustness against large amounts of
the error compared to no outlying noise, demonstrating the communication failure, outlying measurements, and restricted
robustness of our approach. communication ranges.8 IEEEROBOTICSANDAUTOMATIONLETTERS.PREPRINTVERSION.ACCEPTEDJANUARY,2024
Distributed and asynchronous properties of GBP offer at- [19] Y. Tian, Y. Chang, F. H. Arias, C. Nieto-Granda, J. P. How, and
tractivefeaturesformulti-robotsystems.Automaticcalibration L. Carlone, “Kimera-multi: Robust, distributed, dense metric-semantic
SLAMformulti-robotsystems,”IEEETransactionsonRobotics(T-RO),
ensuresthattherobotsrequireaslittlemaintenanceaspossible
vol.38,no.4,2022. 2
and the accurate localisation provides the basis required for [20] A. Papalia, A. Fishberg, B. W. O’Neill, J. P. How, D. M. Rosen, and
multi-robot interaction. J. J. Leonard, “Certifiably correct range-aided SLAM,” arXiv preprint
arXiv:2302.11614,2023. 2
[21] Y. Wang, X. Wen, L. Yin, C. Xu, Y. Cao, and F. Gao, “Certifiably
ACKNOWLEDGMENT optimal mutual localization with anonymous bearing measurements,”
IEEE Robotics and Automation Letters, vol. 7, no. 4, pp. 9374–9381,
TheauthorswouldliketothankEricDexheimerforinsight-
2022. 2
ful discussions. [22] A. Cunningham, M. Paluri, and F. Dellaert, “DDF-SAM: Fully dis-
tributedSLAMusingconstrainedfactorgraphs,”inProceedingsofthe
REFERENCES IEEE/RSJConferenceonIntelligentRobotsandSystems(IROS),2010.
2
[1] R.Murai,J.Ortiz,S.Saeedi,P.H.Kelly,andA.J.Davison,“Arobot [23] A.Cunningham,V.Indelman,andF.Dellaert,“DDF-SAM2.0:Consis-
web for distributed many-device localisation,” IEEE Transactions on tent distributed smoothing and mapping,” in Proceedings of the IEEE
Robotics,2023. 1,2,3,5,7 InternationalConferenceonRoboticsandAutomation(ICRA),2013. 2
[2] Y.ShiuandS.Ahmad,“Calibrationofwrist-mountedroboticsensorsby [24] D. McGann, K. Lassak, and M. Kaess, “Asynchronous distributed
solvinghomogeneoustransformequationsoftheformAX=XB,”IEEE smoothing and mapping via on-manifold consensus ADMM,” arXiv
RoboticsandAutomationLetters,vol.5,no.1,pp.16–29,1989. 2 preprintarXiv.2310.12320,2023. 2
[3] J.Wang,L.Wu,M.Q.-H.Meng,andH.Ren,“Towardssimultaneous [25] P. Ba¨nninger, I. Alzugaray, M. Karrer, and M. Chli, “Cross-agent
coordinatecalibrationsforcooperativemultiplerobots,”inProceedings relocalizationfordecentralizedcollaborativeSLAM,”inProceedingsof
oftheIEEE/RSJConferenceonIntelligentRobotsandSystems(IROS), theIEEEInternationalConferenceonRoboticsandAutomation(ICRA),
2014. 2 2023. 2
[4] Q.Ma,Z.Goh,S.Ruan,andG.S.Chirikjian,“Probabilisticapproaches [26] J.Pearl,“ReverendBayesoninferenceengines:Adistributedhierarchi-
to the AXB= YCZ AXB= YCZ calibration problem in multi-robot cal approach,” in Proceedings of the National Conference on Artificial
systems,”AutonomousRobots,vol.42,pp.1497–1520,2018. 2 Intelligence(AAAI),1982. 3
[5] S. Gowal, A. Prorok, and A. Martinoli, “Two-phase online calibration [27] D.Fourie,J.Leonard,andM.Kaess,“Anonparametricbeliefsolution
for infrared-based inter-robot positioning modules,” in Proceedings of to the Bayes tree,” in Proceedings of the IEEE/RSJ Conference on
the IEEE/RSJ Conference on Intelligent Robots and Systems (IROS), IntelligentRobotsandSystems(IROS),2016. 3
2011. 2 [28] Y. Weiss and W. T. Freeman, “Correctness of belief propagation in
[6] S.Esquivel,F.Woelk,andR.Koch,“CalibrationofaMulti-cameraRig Gaussiangraphicalmodelsofarbitrarytopology,”inNeuralInformation
from Non-overlapping Views,” in Pattern Recognition. DAGM, 2007, ProcessingSystems(NIPS),2000. 3,5,7
pp.82–91. 2 [29] A.Patwardhan,R.Murai,andA.J.Davison,“Distributingcollaborative
[7] G. Carrera, A. Angeli, and A. J. Davison, “SLAM-based automatic multi-robotplanningwithGaussianbeliefpropagation,”IEEERobotics
extrinsiccalibrationofamulti-camerarig,”inProceedingsoftheIEEE andAutomationLetters,vol.8,no.2,pp.552–559,2023. 3
InternationalConferenceonRoboticsandAutomation(ICRA),2011. 2 [30] J.Ortiz,M.Pupilli,S.Leutenegger,andA.J.Davison,“Bundleadjust-
[8] Y. Lin, V. Larsson, M. Geppert, Z. Kukelova, M. Pollefeys, and mentonagraphprocessor,”inProceedingsoftheIEEEConferenceon
T. Sattler, “Infrastructure-based multi-camera calibration using radial ComputerVisionandPatternRecognition(CVPR),June2020. 3
projections,”inProceedingsoftheEuropeanConferenceonComputer [31] R. Scona, H. Matsuki, and A. Davison, “From scene flow to visual
Vision(ECCV),2020. 2 odometry through local and global regularisation in Markov random
[9] T.Dang,C.Hoffmann,andC.Stiller,“Continuousstereoself-calibration fields,”IEEERoboticsandAutomationLetters,vol.7,no.2,pp.4299–
bycameraparametertracking,”IEEETransactionsonImageProcessing, 4306,2022. 3
vol.18,no.7,pp.1536–1550,2009. 2 [32] F. Dellaert and M. Kaess, “Factor Graphs for Robot Perception,”
[10] L. Heng, G. H. Lee, and M. Pollefeys, “Self-calibration and visual FoundationsandTrendsinRobotics,vol.6,no.1–2,pp.1–139,2017.
SLAM with a multi-camera system on a micro aerial vehicle,” Au- 3
tonomousRobots,vol.39,pp.259–277,2015. 2 [33] J.Ortiz,T.Evans,andA.J.Davison,“AvisualintroductiontoGaussian
[11] E.Dexheimer,P.Peluse,J.Chen,J.Pritts,andM.Kaess,“Information- BeliefPropagation,”arXivpreprintarXiv:2107.02308,2021. 3
theoreticonlinemulti-cameraextrinsiccalibration,”IEEERoboticsand [34] A.J.DavisonandJ.Ortiz,“FutureMapping2:GaussianBeliefPropa-
AutomationLetters,vol.7,no.2,pp.4757–4764,2022. 2 gationforSpatialAI,”arXivpreprintarXiv:1910.14139,2019. 3
[12] E.Miluzzo,N.D.Lane,A.T.Campbell,andR.Olfati-Saber,“CaliBree: [35] J. Sola`, J. Deray, and D. Atchuthan, “A micro Lie theory for state
A self-calibration system for mobile sensor networks,” in Distributed estimationinrobotics,”arXiv:1812.01537,2018. 4
Computing in Sensor Systems. Berlin, Heidelberg: Springer Berlin [36] K. Y. Leung, Y. Halpern, T. D. Barfoot, and H. H. Liu, “The UTIAS
Heidelberg,2008,pp.314–331. 2 multi-robotcooperativelocalizationandmappingdataset,”International
[13] D.Devarajan,Z.Cheng,andR.J.Radke,“Calibratingdistributedcamera JournalofRoboticsResearch(IJRR),vol.30,no.8,pp.969–974,2011.
networks,” Proceedings of the IEEE, vol. 96, no. 10, pp. 1625–1639, 5,7
2008. 2 [37] J.Ortiz,T.Evans,E.Sucar,andA.J.Davison,“IncrementalAbstraction
[14] A. Ihler, J. Fisher, R. Moses, and A. Willsky, “Nonparametric belief inDistributedProbabilisticSLAMGraphs,”inProceedingsoftheIEEE
propagation for self-calibration in sensor networks,” in Third Interna- InternationalConferenceonRoboticsandAutomation(ICRA),2022. 5
tionalSymposiumonInformationProcessinginSensorNetworks,2004, [38] P. Agarwal, G. D. Tipaldi, L. Spinello, C. Stachniss, and W. Bur-
pp.225–233. 2 gard, “Robust map optimization using dynamic covariance scaling,”
[15] C.Taylor,A.Rahimi,J.Bachrach,H.Shrobe,andA.Grue,“Simultane- in Proceedings of the IEEE International Conference on Robotics and
ouslocalization,calibration,andtrackinginanadhocsensornetwork,” Automation(ICRA),2012. 5
in 2006 5th International Conference on Information Processing in [39] L.Pineda,T.Fan,M.Monge,S.Venkataraman,P.Sodhi,R.T.Chen,
SensorNetworks,2006. 2 J. Ortiz, D. DeTone, A. Wang, S. Anderson, J. Dong, B. Amos,
[16] S. Choudhary, L. Carlone, C. Nieto, J. Rogers, H. Christensen, and and M. Mukadam, “Theseus: A Library for Differentiable Nonlinear
F.Dellaert,“Distributedmappingwithprivacyandcommunicationcon- Optimization,”inNeuralInformationProcessingSystems(NIPS),2022.
straints:Lightweightalgorithmsandobject-basedmodels,”International 6
Journal of Robotics Research (IJRR), vol. 36, no. 12, pp. 1286–1311, [40] D. Bertsekas and J. Tsitsiklis, Parallel and distributed computation:
2017. 2,6,7 numericalmethods. AthenaScientific,2015. 7
[17] Y.Tian,A.Koppel,A.S.Bedi,andJ.P.How,“Asynchronousandparal-
leldistributedposegraphoptimization,”IEEERoboticsandAutomation
Letters,vol.5,no.4,pp.5819–5826,2020. 2
[18] Y.Tian,K.Khosoussi,D.M.Rosen,andJ.P.How,“Distributedcerti-
fiablycorrectpose-graphoptimization,”IEEETransactionsonRobotics
(T-RO),vol.37,no.6,pp.2137–2156,2021. 2
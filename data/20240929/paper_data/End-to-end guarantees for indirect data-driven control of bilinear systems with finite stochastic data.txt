End-to-endguaranteesfor indirectdata-drivencontrolof
⋆
bilinearsystemswithfinitestochasticdata
NicolasChatzikiriakos,RobinStra¨sser,Frank Allg¨ower, AndreaIannelli
University of Stuttgart, Institute forSystems Theory andAutomatic Control, 70550 Stuttgart, Germany
Abstract
Inthispaperwe proposean end-to-endalgorithm for indirect data-drivencontrolfor bilinearsystemswith stability guarantees.
We consider the case where the collected i.i.d. data is affected by probabilistic noise with possibly unbounded support and
leveragetoolsfromstatisticallearningtheorytoderivefinitesampleidentificationerrorbounds.Tothisend,wesolvethebilinear
identification problem by solving a set of linear and affine identification problems, by a particular choice of a control input
duringthe data collection phase. Weprovidea priori as well as data-dependentfinite sample identification error boundson the
individual matrices as well as ellipsoidal bounds, both of which are structurally suitable for control. Further, we integrate the
structure of the derived identification error bounds in a robust controller design to obtain an exponentially stable closed-loop.
Bymeansofanextensivenumericalstudyweshowcasetheinterplaybetweenthecontrollerdesignandthederivedidentification
errorbounds.Moreover,wenoteappealingconnectionsofourresultstoindirectdata-drivencontrolofgeneralnonlinearsystems
throughKoopman operator theoryand discusshow ourresultsmay beapplied in thissetup.
Keywords: Bilinear Systems,Finite SampleIdentification,IndirectData-DrivenControl, Statistical LearningTheory
1 Introduction systems, there is significant interest in learning the be-
haviorofabilinearsystemfromdata.However,currently
there are only very few methods that allow to analyze
Bilinear systems are an important class of nonlinear
the identification error from a finite-sample perspective.
systems that naturally appears across different domains
Such finite-sample results are of particular importance
suchasbiologicalprocesses(Mohler etal., 1980),socioe-
when it comes to indirect data-driven control of bilinear
conomics (Mohler, 1973) but also in engineering, e.g.,
systems, where the identified system model is used to
nuclear reactor dynamics (Mohler, 1973) and thermal
controltherealsystem.Sinceusuallyonlyfinitedatacan
control processes such as building control (Underwood,
be collected and this data is often affected by noise, it is
2002). Further, the class of bilinear systems has re-
important to account for the introduced uncertainty to
centlyreceivedgreatattentionforits abilitytorepresent
obtainend-to-endguarantees.
nonlinear systems through a higher-dimensional lifting,
e.g., Carleman linearization or Koopman operator the-
ory (Mauroyetal., 2020; Surana, 2016; Huangetal.,
Related works There exists a rich literature in clas-
2018). Due to the wide-ranging occurrences of bilinear
sical system identification for both linear and nonlinear
systems (Ljung, 1998). The special case of bilinear sys-
⋆ This work is funded by Deutsche Forschungsgemeinschaft temshasreceivedconsiderableinterestsincemanyofthe
(DFG, German Research Foundation) under Germany’s Ex- techniques used in linear system identification can be
cellence Strategy - EXC 2075 – 390740016 and within grant carried over to the bilinear setting (FnaiechandLjung,
AL 316/15-1 – 468094890. We acknowledge the support by 1987). In particular, Favoreeletal. (1999) generalize
the Stuttgart Center for Simulation Science (SimTech). N. linear subspace identification to the bilinear setting
ChatzikiriakosandR.Str¨asserthanktheGraduateAcademy
under the assumption of white noise excitation. Fur-
of theSCSimTech for itssupport.
ther, BerkHizir etal. (2012) reduce the bilinear identifi-
Emailaddress:
cationproblemtotheidentificationofanequivalentlinear
nicolas.chatzikiriakos@ist.uni-stuttgart.de (Nicolas
model by choosing suitable sinusoidal inputs. The prob-
Chatzikiriakos), robin.straesser@ist.uni-stuttgart.de
(Robin Str¨asser), frank.allgower@ist.uni-stuttgart.de lem of persistency of excitation and input selection for
(Frank Allg¨ower), andrea.iannelli@ist.uni-stuttgart.de theidentificationofbilinearsystemshasbeenconsidered,
(AndreaIannelli). e.g.,byDasgupta etal.(1989)andSontagetal.(2009).
4202
peS
62
]YS.ssee[
1v01081.9042:viXraNote that the previously discussedclassicalsystemiden- for passive bilinear systems (LinandByrnes, 1994).
tification literature only provides asymptotic results in Moreover, Huang andJadbabaie (1999) propose to view
thepresenceofstochasticnoise,i.e.,resultsthatconsider the state of bilinear systems as a scheduling variable,
the case where the number of data collected goes to in- which leads to a convex controller design using results
finity. Building on recent advances in high dimensional for (quasi-)linear parameter-varying systems. Another
statistics (Wainwright, 2019; Abbasi-Yadkorietal., approach is to use linear matrix inequalities (LMIs)
2011), first finite-sample system identification results to design controllers for bilinear systems in a local re-
have recently emerged for linear time-invariant (LTI) gion, see, e.g., Amato etal. (2009) for a polytopic re-
and certain classes of nonlinear systems. For LTI sys- gion and Khlebnikov (2018) for an ellipsoidal region,
tems, where the ordinary least squares (OLS) estimator or Coutinho etal. (2019) for input-delayed systems. Re-
is predominantly used, Deanetal. (2020) provide in- lying on robust control techniques, Stra¨sseretal. (2023)
dividual identification error bounds for the unknown deriveanLMI-basedcontrollerwithclosed-loopstability
system matrices assuming that the available data is in- guaranteesfor bilinearsystemsby reformulatingthe sys-
dependent. Correlation in trajectory data was handled tem as a linear fractional representation. However, most
by Simchowitzetal. (2018) using the block martingale of the available results require model knowledge or are
small-ball condition. Allowing for dependent data comes restrictedtonoise-freesystems.
atthecostofbeingrestrictedtomarginallystablesystems
andnotrecoveringindividualidentificationerrorbounds
ontheunknownmatrices.Whilethestabilityassumption Contribution Inthis work,weconsiderthe problemof
is overcome in the works of ShiraniFaradonbehetal. identifying a bilinear system from noisy data to control
(2018)andSarkarandRakhlin(2019),findingindividual theunderlyingsystemwithend-to-endguarantees.Specif-
error bounds for each of the matrices from trajectory ically,weleveragetoolsfromstatisticallearningtheoryto
data is still an open problem. Extending the LTI litera- enable robust control of bilinear systems using collected
ture, Foster etal. (2020) and SattarandOymak (2022) data. First, we present novel finite-sample error bounds
provide a finite-sample identification analysis for gener- foridentifyingbilinearsystemsfromfiniteandi.i.d.data.
alized linear systems with a known nonlinearity. When Here,weusethecontrolinputtosolveasetoflinearand
it comes to bilinear systems, Sattaretal. (2022) estab- affine identification problems in order to identify the bi-
lish finite-sample identification error bounds for data linear system from data. We note that the novel finite-
collectedfromasingle trajectory.However,their derived sampleanalysisofaffineidentificationproblemsmightbe
boundreliesonapotentiallyrestrictivestabilityassump- of independent interest. The fact that the corresponding
tion and comes in the form of a single upper bound of OLS solutions do no longer depend on purely random
the identification errors for all the identified system ma- matrices is dealt using properties of symmetric matrices
trices. Since we can only provide a brief overview of the to analyze the random part and the determinist parts of
field of non-asymptotic system identification, we refer thecorrespondingmatricesseparately.Bycombiningthis
to Tsiamisetal. (2023) and Ziemannetal. (2023) for with (anti-)concentrationinequalitiesweareableto pro-
moredetaileddiscussions. videhigh-probabilityidentificationerrorbounds.Wenot
onlypresentaprioriidentificationerrorboundsrevealing
Despite the interest in applying statistical learning the- the structural dependencies on key problem parameters,
orytoolstotheproblemofboundingidentificationerrors, but alsodata-dependent identificationerrorbounds that
there have been comparably less works using the finite- prove to be less conservative. Compared to Sattaretal.
sample error bounds for a robust controller design. One (2022), where finite-sample identification error bounds
importantreasonforthisisthattheboundsareoftennot fromtrajectorydataareprovided,theidentificationerror
directly usable for a (robust) controller design, s.t. pro- bounds derived in this work are structurally tailored for
viding end-to-end guarantees for an indirect data-driven indirect data-drivencontrol. This enables combining the
control scheme can prove to be difficult. For the linear- identificationerrorboundwitharobustcontrolapproach
quadraticregulator,Deanetal.(2020) establishanindi- for bilinear systems. More precisely, we provide an easy-
rectdata-drivencontrolscheme with end-to-endguaran- to-use algorithm to derive an indirect data-driven con-
tees.IntheworkofManiaetal.(2019)thisanalysisisim- trolleralongwithclosed-loopstabilityguarantees.Tothe
proved.Further,Tsiamisetal.(2022)provideupper and bestofourknowledge,thisisthefirstworkprovidingsuch
lowerboundsonthesamplecomplexityofstabilizingLTI an end-to-end result for finite data affected by stochas-
systemsusing indirectdata-drivencontrol. tic noise with possibly unbounded support in the case of
bilinear systems.Further, we show that the proposedre-
There exists a rich literature on model-based controller sults maybe applicable beyondbilinearsystems through
designs for bilinear systems, including Lyapunov-based theKoopmanoperatorandnoteappealingconnectionsto
methods(Pedrycz,1980;Derese andNoldus,1980),bang- Koopman-basedindirectdata-drivencontrolofmoregen-
bang control with linear switching policy (Longchamp, eralclassesofnonlinearsystems.Finally,weshowcasethe
1980), quadratic state feedback (Gutman, 1981, 1980), effectivenessofthe resultsinseveralnumericalinvestiga-
nonlinear state feedback (Benallouet al., 1988), con- tions, where we demonstrate the interplay between the
stantfeedback(LuesinkandNijmeijer,1989),orschemes controllerdesignandthe derivederrorbounds.
2Outline Thispaperisstructuredasfollows.Section2in- accounting for the identification error to obtain a data-
troducestheproblemsetupincludingtheconsideredbilin- drivencontrollerwithend-to-endguarantees.
earsystems.InSection3,wederivefinite-sampleidentifi-
cationerrorboundsforbilinearsystems.Then,weusethe Thestructurein(2)canbeleveragedtoreducethenonlin-
obtainedboundsforthedesignofanindirectdata-driven ear identification problem of identifying the bilinear sys-
controller guaranteeing closed-loop exponential stability tem (2) to n u+1 linear identification problems. To this
ofbilinearsystemsinSection4.Finally,we illustratethe end, we conduct n u+1 experiments in which we choose
effectivenessof the derivedidentificationerrorbounds in theconstantcontrolinputsu t u0 :=0andu t ui :=e i
≡ ≡
comparisonto Monte Carlo simulations as well as in the for i [1,n u], respectively, where e i are the elements of
controllerdesigninSection5beforeconcludingthepaper the ca∈ nonicalbasisofRnu.Thisyieldsthen u+1system
inSection6. descriptions
: x+ =Ax +w (3a)
S0 t t t
tN F eo ro r et daat api ro o on s ui nti dvT e th he s ecu a oln a ri irt gics np ∈ oh fer R Re > ni 0n ww iR te hn d ri es an dd o iue ten so cate wsd p ithb hey r ce SS nn c −− en 11 - .. deS sci r: ibinx g+ t t= = heA [B bx 0 et ] hi+ a+ v[ iB B or0 i] xi ot+ f+( twB heti ,− unA ∀ ki) nx = ot w+ 1 n,w .. bt . il, in nu ea,
r
( s3 yb s)
-
Given a matrix A, we denote the spectral norm with tem (2) under the respective control inputs. In the fol-
vk eA ck t2 o. rT ah oe rop the era it -i to hn c[a o] li ue mx ntra wc hts enth ae pi p- lt ih edele tome ant mo af trt ih xe . l wo hw ii cn hg ,, aw se sc ho on wsi nde pr reth ve iop ur so lyb ,le ism eo qf ui id ve an let nif tyi tn og iS d0 e, n. t. if. yS innu g
We denote matrix blocks that can be inferred from sym- the bilinearsystem(2).
metry by ⋆, i.e., we write Λ ΣΛ = [⋆] ΣΛ. By we
⊤ ⊤
⊗
denote the Kronecker product. Further, we write X Remark1 Note that we choose the canonical basis
stN
r ui
b( bµ Gu,
t
(Σ
e
σd) 2)i wf iit fth
h
te hmr ea en
ra
ad
n
no dµm
oa
mv ne dc vt aco ror
iv
aX
a br li
ea∈
n
YcR enx Σ.i Rs WG
ie
sa wu zs ers rii
t
oa
e
-n mYd eai ∼∼ s n-
o{
tie
t
oh1
ne, r. t. ob. a, tse
hin esu
{
z}
ev
r1a o,s
.
i.i nn
.
p,p uvu tnt .us C}f lo
o
er
f
arRs li ynm ,up thcli
o
ec
u
ri et ly
d
e.
b
xP
e
isa
c
tr sht oi ac
s
nu enl ia nr
i
vnly e,
ra
tda
id
bn liy
e-
sub-Gaussianwithvarianceproxyσ2.M∈
oreover,wewrite matrix T that maps between the two bases, i.e., v = Te
i i
mX e∼ ansu sub bG -n Gx a( uσ s2 s) iai nf th we itr han vd ao rim anv ce ect po rr oxX y∈ σ2R ,n tx hais tz ie sro i-
f
f so yr stea mll i (2)∈ re[ s1 u, ln tsu] i. nApplying the input u t ≡ v i to the
theone-dimensionalmarginals X,v arezero-meansub- x+ =Ax +B v +A (v x )
Gaussianrandomvariableswithh varii anceproxyσ2 forall t =Axt +B0 Ti e +Aux (i T⊗ e t x )
t 0 i ux i t
v Snx−1. Finally, Y U(a) and Y subExp(ν2,α)
=Ax +B Te +A (Te
⊗
I )x .
de∈ note a random variab∼ le Y R which∼ is uniformly dis- t 0 i ux i ⊗ nx t
tributed on [ a,a]and sub-e∈ xponentialwith parameters Defining B˜ i = A ux(Te i ⊗ I nx)+A and B˜ 0 = B 0T we
(ν2,α),respe−
ctively.
obtain x+
t
=B˜ ix t+[B˜ 0]
i
yielding astructurallyidentical
identificationproblemto (3b).Choosingaspecificbasisin
this setting can be considered as an instance of an input
2 Problemsetup design problem, butweleave this for futureresearch.
To solve the linear and affine identification problems (3)
We consideranunknownbilinearsystemofthe form
we resort to the OLS estimator to obtain finite sam-
nu ple guarantees. Identifying the autonomous LTI sys-
x+ t =Ax t+B 0u t+ [u t] iA ix t+w t, (1) tem (3a) from finite data has already been considered,
i=1 see, e.g., MatniandTu (2019) for a detailed analysis.
X
where w i.i.d. subG (σ2) is unknown process noise, However, the finite-sample identification of the affine
x tit m,x e+ t st∈ ept R ,n rx e∼ sa pr ee ctt ih ve elsn yt ,x a ate nw dve uc ttora Rt nt uhe isc aur cr oe nn tt ra on ld inn pe ux tt
.
s m tiy fias ct in aem tt ioec n( h3 nb ei r) c ra oh l ra chs ba on l ulo e nnt dg sb ee f te o an r ilo oc b ro etn das ini fd i one rr ge cfid on niy t te e rt os la .a mn Pd p rl eei cs i id set eh ln ye -
,
∈
Note that by defining B := A +A, the system (1) can
i i the robust controller design requires identification error
equivalentlybe describedby
bounds which are proportional to the state and input.
nu For this reason, we seek finite sample identification er-
x+ t =Ax t+B 0u t+ [u t] i(B i −A)x t+w t
(2)
ror bounds that hold for all the unknown matrices in-
i=1 dividually, hence named individual identification error
X
=Ax +B u +A (u x )+w , bounds hereafter. Obtaining individual identification er-
t 0 t ux t t t
⊗
ror bounds from correlated data is an open problem in
where A ux = B 1 −A ... B nu −A . We consider an literature (Ziemannetal., 2023). Hence, we restrict the
indirect data-drhiven control schemeiwhich consists of sampling accordingtothe followingassumption.
two steps. First we identify the unknown matrices
A ∈Rnx×nx, B
0
∈Rnx×nu, B 1,...,B
nu
∈Rnx×nx from A 1,s .s .u .,m np ,ti to hn
e
d2 atF aor ise oa bc th aio nf edth be yre sa al miz pa lt ii no gns
acS
ci o, rdi in=
g
t0 o,
data and characterize the uncertainty regions for the u
i.i.d.
estimates. Second, we deploy a robust control scheme x subG (σ2).
t ∼ nx x
3Algorithm1 Proposedidentificationalgorithm θˆ =(Y Y) 1(Y X+), i [1,n ] (5b)
i⊤ ⊤ − ⊤
∀ ∈
u
Require: Sampling scheme andthe errorscanbe writtenas
for Ci h∈ o[ o0 s, en iu n] pd uo t ui (Aˆ −A) ⊤ =(X ⊤X) −1(X ⊤W), (6a)
fort ≤T i do (θˆ i −θ i) ⊤ =(Y ⊤Y) −1(Y ⊤W), ∀i ∈[1,n u]. (6b)
Sample statex accordingto samplingscheme
t Theidentificationerror(6a)hasbeenpreviouslyanalyzed
Evaluatebilinearsystemwithx andui
t for Gaussian noise, e.g., by MatniandTu (2019). Next,
end for
we extendthe resultsto sub-Gaussiannoise.
end for
Compute OLSestimates for(3)
Theorem 4 Consider the autonomous system (3a). Fix
afailureprobabilityδ (0,1)andletthedata x+,x Ti
While the independence of the data is key for the pro- ∈ { t t }t=1
becollected according toAssumption2. If
posedindividualbounds,assumingthesamedistribution
foreach Siiswithoutlossofgenerality.Assumption2can T 0 ≥128log(8 ·9nx/δ), (7)
be satisfied by, e.g., rolling out the unforced system for then the identification error of the OLS estimate (5a) is
sometimebeforeapplyingthenecessaryinputtothesys- bounded by
tem.Infact,thedatacollectedfromtheunforcedsystem
could be used to learn the matrix A, where the bounds Aˆ A σ w 16 T 0log(4 ·9nx/δ) (8)
2
derivedin, e.g.,Simchowitzetal.(2018) couldbe usedif k − k ≤ σ T
x p 0
Ais marginallystable.
with probability at least 1 δ.
− 2
Remark3 ComparedtotheworksofDean etal.(2020);
Matniand Tu(2019)usingGaussiannoiseandsampling,
the extension to sub-Gaussian sampling allows for more PROOF. See Appendix A. (cid:3)
correlations inside the sampled state vector. This intro-
duceslargerburn-intimeconditionsbutpavesthewayfor
applications in Koopman-based control(Section 3.4). In the following,we use toolsfromVershynin(2010) and
Wainwright(2019)toderiveapriorianddata-dependent
Algorithm1summarizesthe proposedidentificationpro- upper bound onthe identificationerrorin(6b).
cedure, where the deployed sampling scheme is deter-
mineddepending onthe desirederrorbounds.
3.1 Apriori identification error bounds
3 Finitesampleidentificationerror bounds First,weprovidenovelaprioriidentificationerrorbounds,
which reveal fundamental dependencies on key parame-
Inthefollowing,wepresenthighprobabilityfinitesample ters, e.g., the problem size or the desired confidence for
identification error bounds for each of the unknown ele- the affineidentificationproblem(3b).
ments in (3) in order to identify the bilinear system (2).
Since we use the OLS estimator to identify the true sys- Theorem 5 Consider the unknown system i as defined
S
temparametersfromdata,itis usefulto define in (3b) for any i [1,n u]. Fix a failure probability δ
∈ ∈
(0,1)andletthedata x+,x Ti becollectedaccordingto
θ i := B i [B 0] i ∀i ∈[1,n u], y t := x ⊤t 1 ⊤. Assumption 2. If { t t }t=1
Withthihs, the OLiSestimatoris givenby h i T
i
64(3+2√2)log(8n u9nx/δ),
≥
T0
then the identification error of the OLS estimate (5b) is
Aˆ argmin x+ Ax 2, (4a)
0 ∈ k t − t k2 bounded by
A
t=1
θˆ i ∈arg θm
i
inX tT =i 1kx+ t −θ iy t k2 2 ∀i ∈[1,n u]. (4b) k(Bˆ i −B i) k2 ≤ σ σw x T i/4√ 231 −0 p4 32T 2i Tlo ig lo( g4 (n 4u n9 un 9x n/ xδ /) δ),
Bydefining
X
([Bˆ ] [B ] ) σ
4√ 310 2pT ilog(4n u9nx/δ)
X := x x x ⊤, Y := y y y ⊤,
k 0 i− 0 i k2 ≤ w T i/2 −p4
3
2T ilog(4n u9nx/δ)
1 2
···
Ti 1 2
···
Ti
with probability at least 1 δ . p
h i h i − 2nu
X+ := x+ x+ x+ ⊤, W := w w w ⊤,
1 2 ··· Ti 0 1 ··· Ti
h i h i
the closed-formsolutionsto (4)read
PROOF. While this proof is structured similar to the
Aˆ =(X X) 1(X X+), (5a) proofofLTI finite sample identificationresults(see,e.g.,
⊤ ⊤ − ⊤
4MatniandTu (2019)), there are some key difficulties in- ControllingthesmallesteigenvalueofM Since M
i i
troducedbytheaffinestructurein(3b).Importantly,the isnotapurelyrandommatrixweneedtodeploydifferent
regressory is notpurelyrandom,s.t.,alsothe matrix tools than the ones presentedin MatniandTu (2019) to
t
controlλ (M ). Inparticular,we proceedin twosteps.
Ti Ti
x x x
min i
t ⊤t t First,weshowthatwecanexpressthesmallesteigenvalue
Y⊤Y = y ty t⊤ =
t=1 t=1" x ⊤t 1# of the full matrix as the smallest eigenvalue of the block
X X diagonal terms and an error term depending on the off-
is nota purelyrandommatrixandhence cannotbe han- diagonalelements.Then,weuseHoeffding’sinequalityto
dled using the existing arguments. Analyzing these par- show that the off-diagonal elements are small compared
tiallyrandomquantitieswillpose themaintechnicaldif- totheblock-diagonaltermsifwecollectenoughsamples.
ficulty ofthis proof. ForthesubsequentanalysisweapplytheCourant-Fisher
minimax theorem (GolubandVanLoan, 2013, Theorem
F
ξ
to ∼rt sh ue bs Gub nxse (1q )ue an nt danalysis,wedefineσ xξ t :=x t.Hence, 8 w. e1. o2 b) ta an indconsiderλ min =λ nx+1 and kv k=1,suchthat
λ (M )=λ (M )
σ I 0 σ I 0 min i nx+1 i
Y ⊤Y =
x nx
M i
x nx
, v Ti ξ ξ Ti ξ v
" 0 1# " 0 1# = min 1⊤ t=1 t t⊤ t=1 t 1
wherewe defined v ∈Snx"v 2⊤#"P T t=i 1ξ t⊤ PT i #"v 2#
M
i
:= "PT t=
T
ti =i1 1ξ ξtξ t⊤t⊤ PT t T=i i1ξ t #. (10) = vm ∈Si nn xv 1⊤ XtT =i 1P ξ tξ t⊤ !v 1+2v 2v 1⊤ XtT =i 1ξ t+v 22T i
Ti Ti
Thus,the error(6b) caPnbe writtenoutas ≥vm Si nn xv 1⊤ ξ tξ t⊤ !v 1+v 22T i −2 |v 2 ||v 1⊤ ξ t |.
(θˆ i −θ i)⊤ = "σ1 x 0I nx 0 1#M i−1 "ξ 11 ··· ξ 1Ti #W. N eigo ete nvt ah l∈ uat ecw oe ndc ia tX nt io= n1 co om nb ain be lot ch ke -dfi iars gt ont aw lo mt ae tr rm ixs ,Xt= sin .1 tt .o an
···
Since we are interested in individual error bounds of B i λ (M ) λ T t=i 1ξ tξ t⊤ 0
and[B 0] i,we observethat min i ≥ min "P 0 T i#!
(Bˆ i −B i) ⊤ = I nx 0 nx×1 (θˆ i −θ i) ⊤
max 2v v
Ti
ξ . (13)
([Bˆ 0] i−[B 0] i) ⊤ =h 0 1 ×nx 1 (i θˆ i −θ i) ⊤. −v ∈Snx | 2 || 1⊤ Xt=1 t |
More precisely, (13) shows that the minimum eigenvalue
h i
This resultsinthe individualerrorbounds
of the block-diagonal matrix as well as the error term
ξ ξ servesasalower-boundofthe true minimum eigenvalue.
(Bˆ i −B i)⊤ = σ1 xI nx 0 nx×1 M i−1 "11 ··· 1Ti #W
h i ··· We first derive an upper bound for the term
([Bˆ 0] i −[B 0] i) ⊤ = 0 1 ×nx 1 M i−1 "ξ 11 ··· ξ 1Ti #W(1 .1a) vm k ¯ 1va k =x 2v v∈ = 1S /nx 12 1| wv −2 h|| i vv c 22h1⊤ yPi im elT t dp=i sl1 ie v¯ξ s 1t |. ∈kv S1T k no 2 2 x−+ 1th .|i Hvs 2 e| n2e cn e=d ,, w1 en . ro eDt we e rfi itnt eh ina gt
h i ··· Ti Ti
(11b) max 2vp v ξ = max 2v 1 v2 v¯ ξ .
N ofo tw hew met aa tk rie xt nh oe rn mor tm oo of bt( a1 i1 n)andusesubmultiplicativity v ∈Snx | 2 || 1⊤ Xt=1 t | v¯v 12 ∈∈S[ −nx1 −,1 1] | 2 | q − 2| 1⊤ Xt=1 t |
Observethatwecanmaximizeoverv¯ andv separately.
1 2
ξ ξ Thus,weuse Lemma 16with δ to obtain
1
···
Ti
W
4nu
1 (cid:13)"1 1 # (cid:13)
Ti
k(Bˆ
i
−B i)
k2
≤ σ
x(cid:13)
(cid:13)
(cid:13)
λ· m· i·
n(M i)
(cid:13)
(cid:13)
(cid:13)2, (12a) vm ∈Sa nx x2 |v 2 ||v 1⊤ t=1ξ t
|
(cid:13) (cid:13) X
4
k([Bˆ 0] i−[B 0] i) k2
≤
(cid:13) (cid:13) (cid:13)
(cid:13)"ξ 11 λ·· m·· i·· nξ
(1
MTi
#
i)W
(cid:13) (cid:13) (cid:13) (cid:13)2, (12b)
=≤v
2
32m ∈[ −a 2x 1 T,1 i] lo3 g| (v 42 n|
q
u1 ·9− nxv /22
δp )
2T ilog(4n u ·9nx/δ)
(cid:13) (cid:13) with probpabilityatleast1 δ .Note that the laststep
where λ min(M i) denotes the smallest eigenvalue of the − 4nu
matrixM .Wesplittheanalysisofthetermsontheright- followsby plugginginthe maximizer
i
1
h Ma in ad ns did ce onin tt ro ollt ih ne ga thn eal ny osi rs mof inth the esm nua mlle es rt ate oig r.envalue of v 2∗ = va 2r ∈g
[
−m 1a ,1x ]|v 2
|
q1 −v 22 = √2.
5Ti ξ ξ 0 Using similar techniques as in the analysis of (13) and
Nowconsiderλ min t=1 t t⊤ .Clearly, introducing u¯ =u / 1 u2 leadsto
"P 0 T i#! 1 1 − 2
p
ξ ξ
λ min
T t=i 1ξtξt⊤ 0
=min λ min
T i
ξtξt⊤ ,Ti .
(cid:13)"11 ··· 1Ti #W
(cid:13)
  P 0 Ti 

( Xt=1 ! ) (cid:13)
(cid:13)
(cid:13)
···
Ti
(cid:13)
(cid:13)
(cid:13)2
(cid:13)= sup (cid:13)1 u2(u¯ ξ ) w v +u w v
Then,weuse Pr To iposition15to obtain
δ
u
u¯v
1 2∈ ∈
∈S
S
[n −nx
x
1−
−
,11
1
]Xt=1q − 2 ⊤1 i
(cid:0)
t⊤
(cid:1)
2
(cid:0)
t⊤
(cid:1)
and,P
th"
uλ s,min Xt=1ξ tξ t⊤ !≥T i(1 −2c)2 #≥1
− 4n u
≤
u2∈su
[
−p
1,1]"
q1 −u2
2 u¯v
1∈
∈s
S
Su
n
np
x x− −1 1"
XtT =i
1(u¯ ⊤1ξ t) (cid:0)w t⊤v
(cid:1)#
Ti
+ u sup w v . (16)
λ min(M i) ≥T i(1 −2c)2 −34 2T ilog(4n u9nx/δ) (14) | 2 | v ∈Snx−1(cid:12) (cid:12) (cid:12)Xt=1 t⊤ (cid:12) (cid:12) (cid:12)#
p Noting that (cid:12) (cid:12) (cid:12) (cid:12)
withprobabilityatleast 1 δ 1 δ 1 δ
− 4nu − 4nu ≥ − 2nu Ti Ti
ifT i ≥ c8 2 log(8n u9nx/δ).(cid:16)Toensure(cid:17)t(cid:16)hat(14)y(cid:17)ieldsanon- sup (u¯ ⊤1ξ t) w t⊤v = ξ tw t⊤ ,
t imriv pi oa sl eb to hu en ad d( da in tid ont ah le ci on nv de ir ts ie onin (12)exists), we need to u¯v 1∈ ∈S Sn nx x− −1 1" Xt=1 (cid:0) (cid:1)# (cid:13) (cid:13) (cid:13) (cid:13)Xi=t (cid:13) (cid:13) (cid:13) (cid:13)2
(cid:13) (cid:13)
4 we can apply Proposition 14 with δ to obtain that if
T i(1 −2c)2
− 3
2T ilog(8n u9nx/δ)>0
T i
≥
1 2log(4n u92nx/δ),thenthe
upp4 en ru
bound
p
w c=hic √h
22
√i −s 21sa ,t wis hfi ie cd hi yf iT ei ld>
s
9(1 −32 2c)4 log(8n u9nx/δ).Weselect
u¯v
1∈
∈s
S
Su
n
np
x x− −1 1"
XtT =i 1(u¯ ⊤1y t) (cid:0)w t⊤v (cid:1)#≤4σ
w
pT ilog(4n u92nx/δ)
(17)
T 4
λ min(M i)
≥
2i
− 3
2T ilog(4n u ·9nx/δ) (15) holds with probability at least 1
−
4nδ u. To upper bound
p sup v Snx−1 T t=i 1w t⊤v weuse Lemma 16toobtain
withprobabilityatleast1 δ if ∈
− 2nu h(cid:12) (cid:12)P (cid:12) (cid:12)i
(cid:12) Ti (cid:12)4
128 sup v ⊤ w t σ w 2T ilog(4n u9nx/δ) (18)
T i >max 9 ,64(3+2√2) log(8n u9nx/δ) v ∈Snx−1| Xt=1 |≤ 3 p
(cid:26) (cid:27)
=64(3+2√2)log(8n u9nx/δ). with probability at least 1 δ . Union bounding (17)
− 4nu
and(18)andpluggingtheresultinto(16)weobtainthat
Controllingthe noiseterm To handle the numerator
in(12),considerthat
ξ ξ
1
···
Ti
W
(cid:13)"1 1 # (cid:13)
ξ 1
···
ξ Ti
W
(cid:13)
(cid:13)
··· (cid:13) (cid:13)2
(cid:13)
(cid:13) (cid:13)
(cid:13)"1
···
1 # (cid:13)
(cid:13) (cid:13) (cid:13)T2
i ξ
(cid:13) (cid:13)
≤
u2∈su
[
−p
1,1]
4q1 −(cid:13) (cid:13)u2 24σ w pT ilog(4n u92nx/δ)
(cid:13)=
u
∈Snxs ,u
v
∈p
Snx−1
X(cid:13)
t T= i1
u ⊤ "1t
#!
(cid:0)w t⊤v
(cid:1)
≤
+
su|
pu 2 |3σ 1w
−p
u2T
2
24i σlo wg(4 2n Tu i9 ln ox g/ (δ 4)
n u9nx/δ)
= sup u⊤1ξ t+u 2 w t⊤v u2∈[ −1,1] q p
u ∈Snx,v ∈Snx−1 Xt T= i1
(cid:0) (cid:1)(cid:0) (cid:1)
+ |u
2
|4 3σ
w
2T ilog(4n u9nx/δ)
=
u
∈Snxs ,u
v
∈p
Snx−1
Xt=1(u⊤1ξ t) (cid:0)w t⊤v (cid:1)+u 2 (cid:0)w t⊤v (cid:1). = u2∈su
[
−p 1,1]4σ
w
pp 2T ilog(4n u9nx/δ) (cid:18)q1 −u2 2+ |u 32 |
(cid:19)
6Fw ii nth alp lyr ,o pb la ub gi gli it ny ga it nle ta hs et m1 − ini2 mnδ u izi ef rT ui ∗2≥ =1 2 √lo 1 1g 0( w4n eu o9 b2 tn ax i/ nδ). (L 3e bm ),m foa ra7 nyC io ∈ns [i 1d ,e nr uth ]e anu dnk wn ito hw wn ts iy . ∼s i.t de .m NS (0i ,a σs w2d Ie nfi xn )e .d Fi in x
afailureprobabilityδ (0,1)andletthedata x+,x Ti
∈ { t t }t=1
besampled i.i.d. withT n +1.Define
(cid:13)"ξ 11 ··· ξ 1Ti #W
(cid:13) ≤
4√ 310 σ
w
2T ilog(4n u9nx/δ).
C 1(n x,δ)=σ w2 √n
x+i ≥ 1+x
√n x+ 2log(2n u/δ)
2
.
(cid:13) ··· (cid:13)2 p
(cid:13) (cid:13) (19) Then with probab(cid:16)ility at least 1 δ pwehave (cid:17)
(cid:13)
(cid:13)
(cid:13)
(cid:13)
− 2nu
C pluo gm gb ini gni tn hg emthe inp tore (v 1i 2o )u ,s ar ne dsu ul st ins gTa uk ni in og n( b15 o) ua nn dd a( r1 g9 u) -, ⋆ "([Bˆ(B 0ˆ
]
ii − [B Bi 0) ⊤
] i)
⊤#⊤ (cid:22)C 1(n x,δ)M i−1
ments we obtain the desired result. Further, we compare h i −
the twoburn-intime conditions where the matrix M i is defined according to (10). If M i
has zero as an eigenvalue, we define the inverse of that
1 eigenvalue tobe infinity.
max log(4n u92nx/δ),64(3+2√2)log(8n u9nx/δ)
2
(cid:26) (cid:27)
=64(3+2√2)log(8n u9nx/δ) n x,n u 1 PROOF. We only provide a short version of the
∀ ≥
proof, for a more detailed version we refer to the proof
whichconcludesthe proof. (cid:3)
of(MatniandTu,2019,PropositionV.1). First,define
E = (Bˆ B ) ([Bˆ ] [B ] ) ⊤.
i i 0 i 0 i
NotethatlikeintheLTIcaseassumingi.i.d.dataallows − −
Assuming N hn +1 the singular valueidecomposition
ustoprovideerrorboundsonthe individualmatricesin- ≥ x
of Z is given by Z = UΛV . Hence, when the inverse of
dependentlyofthestabilitypropertiesofthesystemcon- ⊤
Λ exists,we canwrite
sidered. Further, the bounds in Theorem 5 can be com-
EE =VΛ 1U WW UΛ 1V U W 2(Z Z) 1.
putedbefore collectingdata,relyingonlyonknowledgeof ⊤ − ⊤ ⊤ − (cid:23)k ⊤ k2 ⊤ −
the systemdimensionsandthe noisevariance. Each of the elements of the matrix U ⊤W R(nx+1) ×nx
is i.i.d. (0,σ2) and, thus, we can apply∈ (Vershynin,
N w
3.2 Data-dependent identification error bounds 2010, Corollary 5.35) to show that with probability at
least 1
−
2nδ
u
we have kU ⊤W
k2
≤
σ
w
√n x+1+√n
x
Dependingontheapplicationitmightnotbenecessaryto + 2log(2n u/δ) . (cid:0) (cid:3)
provideidentificationerrorboundsbeforedatacollection.
Instead,onecanturntodata-dependenterrorboundsthat p (cid:17)
accountonlyforthedataobservedand,hence,willbeless
Lemma 7 can be easily extended to sub-Gaussian
conservative.To this end, recall the matrices M defined
i noise using (Vershynin, 2010, Proposition 5.39) instead
in(10)andnotethattheycanbeevaluatedfromdata,i.e.,
of(Vershynin,2010,Corollary5.35)inthe proof.
we do not need to control the respective inverses. Thus,
wecanleveragethederivationsfromtheprevioussection
3.3 Samplecomplexity of identifying bilinear systems
toobtainindividualboundsforeachoftheunknownma-
trices.
Toobtainfinitesampleidentificationerrorboundsforthe
Corollary6 Considertheunknownsystem asdefined bilinear system (2) we apply Algorithm 1 and combine
i
in (3b) for any i [1,n ]. Fix a failure proS bability δ the results from Sections 3.1 and 3.2 using union bound
u
(0,1)andlettheda∈ ta x+,x Ti becollectedaccordingt∈ o arguments.
{ t t }t=1
Assumption 2. If T
i
≥
21log(2n u92nx/δ), then the identi-
Theorem 8 Consider Algorithm 1 where the data has
fication error of theOLSestimate (5b)is bounded by
been collected from the bilinear system (2) according to
(Bˆ B ) σ w 4√ 310 2T ilog(2n u ·9nx/δ) Assumption 2. Fix afailure probability δ (0,1).If
k i − i k2 ≤ σ x p λ min(M i) T 0 T¯ 0, ∈
≥
([Bˆ
] [B ] ) σ
4√ 310 2T ilog(2n
u
·9nx/δ) T
i
≥T¯
i
∀i ∈[1,n u],
k 0 i− 0 i k2 ≤ w
p
λ min(M i) thenAlgorithm1resultsinestimatesAˆ,Bˆ 0,Bˆ 1,...,Bˆ
nu
with probability at least 1 δ , where the matrix M is that satisfy
definedin (10).IfM
i
hasz− ero2n au saneigenvalue,wedefii ne Aˆ A
2
ε A, (21a)
k − k ≤
theinverseof that eigenvalue tobeinfinity. Bˆ B ε i [1,n ], (21b)
k
i
−
i k2
≤
Bi
∀ ∈
u
Alternatively, we can use similar proof techniques to k[Bˆ 0] i −[B 0] i k2 ≤ε [B0]i ∀i ∈[1,n u] (21c)
(Deanetal., 2020, Proposition 3) to obtain ellipsoidal, with probability at least 1 δ, where identification error
−
data-dependentidentificationerrorbounds. bounds and burn-intimes arespecified as follows:
7(1) A priori identification error bounds: Theorem 9 Consider Algorithm 1 with i.i.d. collected
datafromthebilinearsystem (2).Fixafailureprobability
ε A =
σ
σw
x
16 pT 0lo Tg( 04 ·9nx/δ)
, (22a) δ ∈(0,1)and let w t i. ∼i.d. N(0,σ w2I nx). If
ε Bi =
σ σw
x T
i/4√ 231 −0 p342T 2i Tlo ig lo( g4 (n 4u n9 un 9x n/ xδ /)
δ), (22b) t th he an
t
sA al
tgT iso0
fr
y≥ ithn mx 1ra en sd ultsT ini ≥ esn tix m+ ate1 sAˆ∀ ,i B∈
ˆ
0[ ,1 B, ˆn 1u ,] .,
..,Bˆ
nu
ε [B T0
T¯
¯] 0i
i
==
=
61σ 42w (8T 3li
o
+/4 g√ 2 (3 281
−
√0 ·p 2934
)n
p2p
lx
oT /2 gi δT (l )o 8i ,g nlo( ug4 9(n n4u xn9 /un δ9x )n/ .xδ /) δ), (( (22 222 2dc e))
)
h⋆
i"([( BA ˆ(ˆ
B
0ˆ−
]i i−
−A)
B
[( BA iˆ
0) ⊤
]−
i)
⊤A #)⊤
⊤
(cid:22)(cid:22) EE BA i,
∀i ∈[1,n u]
(( 22 44 ba ))
(2) Data-dependent identification error bounds: with probability at least 1 δ,where
−
2
ε =
σ w 4 T 0log(4 ·9nx/δ)
, (23a)
EA =σ w2 2√n x+ 2log(2/δ) M 0−1,
A
ε Bi =
σσ σwx
x
4p √ 310 pλ m 2i Tn λ(
i
mM lo ing0 () ( M2n
i)u
·9nx/δ)
, (23b)
IfE MBi i,=
i
∈σ w2 [0(cid:16)(cid:16) ,√
n
un ]x ,h+ as1p z+ er√ on asx a+ npei(cid:17) 2 gelo ng va(2 lun eu ,/ wδ e)
(cid:17)
d2 eM fini− e1 t.
he
inverse of that eigenvalue tobeinfinity.
ε =σ
4√ 310 2T ilog(2n u9nx/δ)
, (23c)
[B0]i w λ (M )
p min i
T¯ = 1 log(2 9nx/δ), (23d) PROOF. TheseresultsdirectlyfollowbyusingLemma7
0 2 · and (Dean etal., 2020, Proposition 2.4) with δ followed
1 by unionboundarguments. 2 (cid:3)
T¯
i
= log(2n u92nx/δ). (23e)
2
With this, we have established a priori as well as data-
PROOF. ThisresultfollowsdirectlybyusingTheorem5 dependentfinitesampleidentificationerrorboundsforthe
(Corollary6) and(the data-dependentversionof) Theo- identification of bilinear systems from i.i.d. data. While
rem4 andleveragingunionboundarguments. (cid:3) the results hold for bilinear systems, Koopman operator
theoryprovidesanappealingtooltoextendtheresultsof
thisworktomoregeneralnonlinearsystems.Whileade-
tailed analysisis outof the scope ofthis work,we sketch
WhilewedemonstrateinSection5.1thattheaprioriiden-
someofthelinksbetweenourresultsandthegeneralnon-
tification error bounds (22) are less tight than the data-
linearcasein the following.
dependentidentificationones(23),theyprovidethepossi-
bilitytoboundtheamountofuncertaintyintheestimates
beforerunningtheexperiment.Further,theaprioriiden- 3.4 Implicationsfordata-drivencontrolofnonlinearsys-
tification error bounds provide additional insights that tems
helptounderstandthedifficultyinidentifyingthesystem
matricesintermsofthesamplecomplexity.First,wecan Asalreadydiscussed,Koopmanoperatortheory(Koopman,
observe that the identification of every unknown matrix 1931; Mauroyetal., 2020) allows to accurately repre-
scales with (1/√T) which is the known rate of OLS for sent nonlinear systems by higher-dimensional bilinear
O
linear systems. Further, the problem size influences the systems (Surana, 2016; Huangetal., 2018). Identifying
identificationerrors(22a)-(22c)oforder ( n xlog(n u)), this lifted bilinear system from data collected from the
O
whereas the overall number of samples T = T 0 + n uT i true system is an active field of research. Although (ex-
p
needs to be of order (n x(n u +1)). In accordance with tended) dynamic mode decomposition (Williams etal.,
O
thelinearcase,thefailureprobabilityentersinverselyin- 2015) is shown to suitably approximate the Koopman
side log-terms and lastly, we observe the signal-to-noise operator (KordaandMezi´c, 2018; Bevandaetal., 2021)
ratio (SNR) σ x/σ x for the identification error bounds of while being scalable to large-scale systems and robust
AandB i, i [1,n u],whereasthe identificationof[B 0] i w.r.t. noise (Bevanda etal., 2024; Meantietal., 2024),
∀ ∈
lacks the dependence on σ x. This is because [B 0] i enters finitesampleidentificationerrorboundsareusuallyhard
affinelyin(3b)andiscausedbychoosingthe normalized to obtain for noisy systems (Mezi´c, 2022; Nu¨ske etal.,
controlinputs ui = e i, such that the denominator of the 2023; Philippet al., 2024). One particular challenge
SNRis equalto one. lies in the fact that we cannot sample from the high-
dimensionallifted state-spacedirectly,butonly fromthe
Equivalently, we can use the ellipsoidal, data-dependent lower-dimensional original state-space, where the two
identificationerrorboundstoobtainthefollowingresult. are related by known lifting functions. At this stage,
8we emphasize that sampling in the original state space in the context of a Koopman-based bilinear surrogate
and lifting the samples afterwards does not violate the model. To this end, we expressthe obtainederrorbound
assumptions of Theorem 9, thus this result can still be asaquadraticmatrixinequalitythatboundstheresidual
appliedtoasettingwherethesystemisbilinearinalifted ina proportionalmanner,i.e.,
state space. Regarding Theorem 8, the following propo-
sition demonstrates for a particular choice of a lifting x ⊤ x
f liu tn erc ati to un r, e,w thh aic th suh ba -s Gb ae ue sn siaw nid se al my pu ls ined
g
ii nn tt hh ee liK fto edop sm taa tn
e
kr(x,u) k2 2 ≤"u# Q ∆ "u#. (27)
space (Assumption 2) can still be satisfied, enabling the
To this end, we assume that the control inputs u satisfy
applicationofTheorem8inthis setup.
u U, where U Rnu is a user-defined compact set.
∈ ⊂
This ismotivatedbythe factthatuis typicallybounded
i.i.d.
Lemma10 Consider a scalar random variable x in practice, e.g., due to physical constraints. Further,
∼
U(a). Then, the random vector ξ = x sin(x) ⊤ is sub- the later established controller design is based on a pre-
definedstateregion Rnx,whichisusedtodefinethe
Gaussian distributed withvariance prohxy i X ⊂
region where stability of the closed-loop system can be
σ2
≤
a2a 2++ 21 a,
,
i if
f
a a∈( (0 1, ,1],
).
g nu eea dra sn tt oee sd at. isS fi ync te hax ti us =wi uth (xin
)
XUfo fr oral al llti xmes, t .he set U
(cid:26) ∈ ∞ ∈ ∈X
PROOF. SeeAppendix C. (cid:3) 4.1 Individual identification error bounds
Inthissection,weconsidertheindividualidentificationer-
Notethat,whileweprovidetheproofforascalarvariable rorboundspresentedinTheorem8.Thefollowingpropo-
xforclarityofexposition,theLemma10canbeeasilyex- sition characterizeshow the results in Theorem8 can be
tendedtovector-valuedrandomvariables,wheresin()is transferredtothe errorbound(27).
·
appliedelement-wise.Although we can showthat a suit-
ablesamplinginthe originalstatespaceensuresthe nec-
Proposition11 Considerthebilinearsystem (2)andlet
essarysub-Gaussiansamplingintheliftedspaceforaspe-
the identification error be bounded according to (21) with
cificliftingfunction,itremainsanopenquestionforgen-
probabilityatleast1 δwithδ (0,1).Then,theresidual
eralliftingfunctions.However,wesuspectthatLemma10 − ∈
r(x,u) of the uncertain bilinear system (25) satisfies the
canbeextendedtootherclassesofliftingfunctionsusing
quadratic bound (27)for
boundedsampling.Further,wenotethatthederivedup-
per bound of the variance proxy is not sharp, but shows 2c2I 0
that lifted samples are sub-Gaussian distributed. Find- Q =
x nx
(28)
∆
ing the necessary exact variance proxy (or a tight lower " 0 2c2 uI nu#
bound)is left forfuture research.
with probability at least 1 δ,where
−
4 Controllerdesignforbilinearsystems nu nu
c = max 1 [u] ε + max [u] ε ,
x
"u U | −
i
|#
A
"u U |
i
|
Bi
#
∈ i=1 ∈ i=1
For the controller design, we consider the system repre- X X
sentationin(2)butfocusonthenoise-freepartofthedy- nu
namicssinceourcontrolobjectiveisstabilization.Inpar- c u =
v
ε2 [B0]i.
ticular, we express (2) in terms of the OLS estimates Aˆ, u uXi=1
t
Bˆ 0 = [Bˆ 0] 1
···
[Bˆ 0] nu , Bˆ 1,...,Bˆ nu and define Aˆ ux =
Bˆ 1 −h Aˆ
···
Bˆ nu −Aˆ i to obtain the uncertain bilinear PROOF. See Appendix D. (cid:3)
hsystem i
x+ =Aˆx +Bˆ u +Aˆ (u x )+r(x ,u ). (25)
t t 0 t ux t ⊗ t t t
Here, r(x,u) is the residual capturing the identification
Based on the individual identification error bounds de-
errorresultingfromthe OLSestimationandis givenby
rived in Theorem 8, Proposition 11 yields a quadratic
r(x,u)=(A Aˆ)x+(B Bˆ )u+(A Aˆ )(u x). boundontheresidual.Inparticular,theboundispropor-
0 0 ux ux
− − − ⊗
(26) tionaltothestateandinput,allowingarobustcontroller
Inthefollowing,wedemonstratethatthenon-asymptotic design since the error bound vanishes at the equilibrium
identification error bounds derived in Section 3 are suit- (x,u) = (0,0). As shown in Theorem 13, this allows a
able for robustcontrolof bilinearsystems.Therefore,we controller design stabilizing the system in a regionof at-
followthedesignproposedinStra¨sseretal.(2023,2024b) traction(RoA) aroundthe equilibrium.
94.2 Ellipsoidal identification error bounds arebasedonrewritingthebilinearsystemasalinearfrac-
tional representation (Zhouetal., 1996) within a user-
defined stateregion .To this end,wedefine the set
Next, we use the ellipsoidal identification error bounds X
presented in Theorem 9 and derive a corresponding ma- x ⊤ Q S x
trix Q . Here, we consider a block-wise decomposition = x Rnx x x 0 , (30)
of the∆ matrices EBi = "[ [E EB Bi i] ]1 21 1 [ [E EB Bi i] ]1 22 2# in (24b), where w deh se igrX e nQ gux a  ≺ ra0 n∈ ta en ed
s
iR n(cid:12) (cid:12) (cid:12) (cid:12) (cid:12) (cid:12)z v" a1 > r# ia0 n." cT eS hx⊤ oe fnR ,tx h# ae n" p d1 r# o rep≥ go is oe n  d alco sn tat bro ill il te yr
[ EBi] 11 ∈Rnx×nx,[ EBi] 12 =[ EBi] ⊤21 ∈Rnx,[ EBi] 22 ∈R. ofthe closedloopforinitialcondX itions inasubsetof .
X
Proposition12 Considerthebilinearsystem (2)andlet Possible choices are, e.g., Q = I, S = 0, and R = c
x x x
the identification error be bounded according to (24) with defining a norm bound on the s− tate x 2 c. An algo-
probabilityatleast1 δwithδ (0,1).Then,theresidual rithmtoheuristicallyoptimizethegeomk ek try≤ of basedon
r(x,u) of the uncert− ain bilinea∈ r system (25) satisfies the theidentifiedsystemdynamicsisgivenin(Stra¨X sseretal.,
quadratic bound (27)for 2024a,Procedure8).Further,weassumethattheinverse
Q
∆
= (n u+1)m u ∈a Ux |1 − n i=u 1[u] i |2 EA 0 +(n u+1) Eˆ
B
hmSQ ˜ a˜ x⊤x inRS ˜˜ tx x hieo:= remhSQ ox⊤x fRS thx x iis− s1 ece tx iois nt .s.Nowwecanformulatethe
0 P 0
  (29a) Theorem 13 Considerthebilinearsystem (2),wherethe
withprobability at least 1 δ, where residualofthesystemidentificationsatisfies (27)forsome
−
Q with probability at least 1 δ with δ (0,1). If there
∆
Eˆ
B
=[⋆]⊤ E˜
B
(m
u
∈a Ux |u |⊗I nx) 0
, (29b)
e Lxist Ra ns uy ×m nm x,et Lri wcma Rtr ni ux ×P nx= nu− P
,⊤
a
≻
sym0 mof es∈ ti rz ie cn
mx
a, tm ria xtr Λice =s
0 I nu Λ ⊤∈ 0of size n u,∈ and scalars ν >0,τ >0 suchthat the
  linea≻ r matrix inequalities (31)and
[ ] [ ]
EB1 11 EB1 12

..
.
..
. 
νR˜
x
−1 −νS˜
x⊤ 0 (32)
˜
=

[ EBnu]
11
[ EBnu] 12
.
" −νS˜ x νQ˜ x+P#(cid:22)
EB 
 [ EB1]
21
[ EB1]
22



hold, then uth (e x)co =nt (r Iolle Lr
(Λ 1 x)) 1LP 1x (33)


... ... 
 −
w −
⊗
− −
  ensures exponential stability of the closed-loop system for
 


[ EBnu]
21
[ EBnu] 22

all initial conditions in
XRoA
:= {x
∈
Rnx
|
x ⊤P −1x
≤
 (29c) 1 with probability at least 1 δ.
}⊆X −
PROOF. Thisisadirectcombinationof(Stra¨sseretal.,
PROOF. SeeAppendix E. (cid:3) 2023, Theorem 4) and (Stra¨sseretal., 2024b, Theo-
rem4.1),wherewegeneralizetheresultbyexploitingQ
∆
in(27)forthe errorbound onthe residual. (cid:3)
Similar to the discussion for the individual identification
errorbounds,Proposition12establishesanerrorcharac-
Theorem 13 establishes a controller design for the un-
terizationofthe residualwhich is tailoredto controland
known bilinear system (2) with end-to-end guarantees
vanishesatthe origin.
basedonmeasureddata.Inparticular,the controllerde-
sign ensures exponential stability of the closed-loop sys-
tem for all initial conditions in the RoA with high
4.3 Controllerdesignbasedonlinearrobustcontroltech- XRoA
probability. To this end, we exploit the identified system
niques
dynamics and the identification error bounds derived in
Section 3 to establish a controller design that is robust
Inthefollowing,wepresenttheproposedcontrollerdesign tothe residual.Here,wecanusethe individualorthe el-
forsystem(2)basedontheidentifiedbilinearsystem(25). lipsoidal identification errorbounds to derive the matrix
More precisely, we rely on the state-feedback controller Q used in the controller design, see (28) and (29), re-
∆
designpresentedinStra¨sseretal.(2023,2024b).Here,the spectively. The design scheme requires and ensures that
controllerdesignoftheuncertainbilinearsystem(25),(27) the state x remains within the set . Thus, the set
X X
is addressed by linear robust control techniques, which needstobecarefullychosenwhenapplyingthecontroller
10P −τInx −Aˆ ux(Λ ⊗S˜ x) −Bˆ 0Lw(Inu⊗S˜ x) 0 AˆP +Bˆ 0L Aˆ ux(Λ ⊗Inx)+Bˆ 0Lw
 0 

⋆ Λ ⊗R˜ x −Lw(Inu ⊗S˜ x) −(Inu⊗S˜ x⊤)L⊤ w −(Inx⊗S˜ x⊤)
Lw
L Lw

 
 
   P 0  0 (31)
 

⋆ ⋆ τQ− ∆1
L −Lw
  ≻
 
 
 ⋆ ⋆ ⋆ P 0  
 
  ⋆ ⋆ ⋆ ⋆ Λ Q˜− x1  
 − ⊗ 
 
Algorithm2 IndirectDDC withend-to-endguarantees For the remainderofthis sectionthe setup willbe asfol-
i.i.d.
1: Chooseδ, T 0,...,T nu and
X
lows. Data is collected by sampling x k
∼
N(0,I) and
2: CollectdataandidentifysystemmatricesusingAlgo- evaluating the unknown,affine function
rithm 1 with the sampling scheme chosen according
to the desirederrorbounds x+ =B x +B +w ,
t 1 t 0 t
3: if LMIs(31)and(32)aresatisfiedthen
4: Controller (33) yields closed loop exponentially
5:
est la sb elein XRoA ⊆X with highprobability Rw nh xe ×re nxw t ani. d∼i.d t. hN e( v0 e, cσ tw2 orI n Bx) 0, σ w R= nx0 a.5 re. T dh rae wm na rt ar nix doB m1 ly∈ .
∈
6: Modify parametersin1until successful We estimateB 1 andB 0 using the OLSestimate (5b).
7: end if
First, we consider the influence of the sample size on
design. More precisely,if the controller designis not fea- the identification error. To this end, we select n = 25.
x
sible for a given set of data, feasibility might be ensured Further, we empirically estimate the identification error
byeithercollectingmoredatatoreducetheidentification throughMonteCarlosimulationstoaverageouttheran-
errororadjustingtheset toshrinktheguaranteedRoA domness in the noise and data-sampling.Since the data-
X
RoA . Thus, the controller design can be iterated dependent identification error bound (23b) also depends
X ⊆ X
untilsuccessful,seeAlgorithm2. ontheobserveddataweconsiderthemeanovertheMonte
Carlo simulations. The mean and 3σ-band of the em-
pirically approximated identification error as well as the
5 Numericalexample mean of the data-based bound are displayed in Fig. 1a
along with the a priori sample complexity bounds. The
In this section, we first provide numerical simulations to results show that the a prioriidentification error bounds
illustrate the derived identification error bounds of Sec- are more conservative than their data-dependent coun-
tion3(Section5.1),wherewecomparetheaprioriidentifi- terparts.Thisistobeexpectedsincethedata-dependent
cationerrorbounds(Theorem5)withthedata-dependent identification error bounds only take into account the
bounds (Theorem 6). Second, we use both types of the data that is observedand need less potentially conserva-
identification error bounds to design a controller for dif- tivestepsintheirderivation.Further,eveninahigh-data
ferent bilinear systems and provide end-to-end guaran- regime, both bounds overestimate the true identification
teesforindirectdata-drivencontrolofthesesystems(Sec- error,whereasexpectedtheabsolutevalueofthegapde-
tion 5.2). Finally, we apply our results to a nonlinear in- creasesasthenumberofsamplesincreases.Additionally,
verted pendulum using the link with Koopman operator Fig.1bshowsthatthedependencyonthesamplesizecap-
theory(Section5.3).1 tured in the a-priori identification error bound, which is
(1/√T) iscorrect.
O
5.1 Error bounds
Now we focus on the dependence on the problem dimen-
sionn .Tothisend,weconsiderrandomB andB with
Inthissection,weanalyzetheidentificationerrorbounds x 1 0
n varyingbetween1and30.Again,weuseMonteCarlo
x
derivedinSection3withrespecttoconservatismandde-
simulationstoevaluatetheidentificationerrorsandiden-
pendenceonkeyproblemparameters.Here,wefocusour
tification error bounds for T = 250.000 samples. The re-
analysis on the identification problem (3b) and refer to
sultsaredisplayedinFig.1c.Itisapparentthattheidenti-
the works by Deanetal. (2020) or MatniandTu (2019)
ficationerrorincreasesasexpectedwiththeproblemsize.
fortheanalysisoftheidentificationerrorboundsof (3a).
However,asshowninFig.1d,theconservatismoftheer-
rorboundsdecreasesastheproblemsizen increases.As
x
1 The code for the numerical examples can be accessed before, the data-based bound is consistently less conser-
at:https://github.com/col-tasas/2024-bilinear-end-to-end vative thanthe aprioribound.
11102
10 1 −
101
10 2
−
0.5 1 1.5 2 0.5 1 1.5 2
T 105 T 105
· ·
(a) Error for differentsample sizes. (b) Errortimes √T oversample size.
0.125 30
0.1 25
0.075 20
15
0.05
10 0.025
5
0
1 5 10 15 20 25 30 1 5 10 15 20 25 30
nx nx
(c) Error for differentproblem dimensions. (d)Error boundsrelative tomean MonteCarlo error.
Fig. 1. Mean of the identification error ( ), data-based bounds ( ), and a priori error bounds ( ) through 100 Monte
Carlo simulations. Shadedareas are respective3σ-bands.
5.2 Controller design Table 1
Required data length for a feasible controller design for the
academic example in Section 5.2.1.
Next,westudytheincorporationofthedifferenttypesof
identification error bounds in control. In particular, we = x x 2 c c=0.1 c=0.6 c=0.9
X { |k k ≤ }
design a controller for the bilinear system (2) following
Individualbounds T =360 T =2263 T =34668
Theorem13with both the individual identificationerror
bounds ofSection4.1aswellas the ellipsoidalidentifica- Ellipsoidal bounds T =33 T =213 T =3999
tion error bounds of Section 4.2. Here, we study 1) the
feasibility of the controller design, and 2) the size of the
weselectw i.i.d. (0,σ2I)withσ =0.1,δ =0.05,sam-
guaranteed RoA for the different error bounds. We note t ∼ N w w
i.i.d.
that we do not consider the a priori identification error ple x (0,I), and numerically determine the min-
∼ N
bounds inthe controllerdesign,asthey aremoreconser- imally required data lengths. Here, we restrict ourselves
vative than the data-dependent bounds according to the to data lengths T = T = T, but note that generally
0 1
previoussection.ThesimulationsareperformedinMAT- thelengthscouldbechosendifferently.TheresultsinTa-
LABusingtheYALMIPtoolbox(Lo¨fberg,2004)withthe ble 1 show that the ellipsoidal error bounds require less
solverMOSEK(MOSEK,2022). data todesignafeasiblecontrollercomparedto the indi-
vidual errorbounds. In other words,the ellipsoidalerror
5.2.1 Academic example bounds allow for larger regions of attraction for a given
data length. This is in line with Fig. 2, where we show
theregionsofattractioncorrespondingtothesimulations
We startby consideringthe academicdynamicalsystem
inTable1.We emphasizethatthe RoAisdeterminedby
x+ = 1 1 x + 1 u + 1 0 u x . (34) P whosetraceismaximizedinthe controllerdesignand,
t t t t t thus,theobtainedRoAformoredataisnotnecessarilya
"0 1# "1# "0 1#
supersetoftheRoAforlessdata.However,thiscouldbe
We define the region of interest in (30) via the norm ensured by adding a suitable set-containment constraint
bound x t 2 c. Moreover,we aX ssume a compact input to the optimization problem, which would come at the
space Uk =k [ ≤ 2,2]2. We emphasize once again that with costoflessdegreesoffreedominthe controllerdesign.
−
highprobabilitytheRoA isinvariantunderour
RoA
X ⊆X
controllaw(33),where correspondstothesublevel
RoA
set V(x) 1 of the LyaX punov function V(x) = x P 1x 5.2.2 Continuous stirred-tankreactor
⊤ −
≤
with P 0. Hence, we maximize the trace of P subject
≻
tothe LMIs(31),(32)to findthe largestRoA. Next,weconsiderthecoolingofacontinuousstirred-tank
reactor(CSTR)asconsideredin,e.g.,Longchamp(1980)
First, we study the feasibility ofthe controllerdesign for withfeedbackcontrolorK¨ohleretal.(2020),(Rawlingset al.,
thetwotypesofidentificationerrorbounds.Inparticular, 2020, Example 1.11) with model predictive control. The
12
B
Bˆ
B
Bˆ
2
k1
−1
k
2k1
−1
k
B
Bˆ
T√
1Bε
2
k1
−1
k
2k1B
−1Bˆ
k1 3
c=0.1
c=0.6
2
c=0.9
0.5
1
0
0
1
−
0.5
− 2
−
3
−
1
− 1 0.5 0 0.5 1 3 2 1 0 1 2 3
− − − − −
[x t] 1 [z t] 1
Fig. 2. RoA for given = x x 2 c and the minimum Fig.3.RoA( )andclosed-looptrajectories ( )forthe
required data length fX or ind{ ivi| dk uak l er≤ ror} bounds ( ) and nonlinear invertedpendulumexamplein Section 5.3.
ellipsoidal error bounds( ) as well as theRoA with ellip-
soidalerrorboundsfortheminimumdatalengthrequiredfor the nonlinear inverted pendulum (Tiwarietal., 2023;
individualerrorbounds( ). Verhoek etal.,2023;Stra¨sseretal.,2024a)
Table2
[z ] +T [z ]
Required data length for a feasible controller design for the z+ = t 1 s t 2 (36)
CSTR examplein Section 5.2.2. t "[z t] 2+ Ts lg sin([z t] 1)
−
mTs lb 2[z t] 2+ mT ls 2u t#
Rx 1 10−4 1 10−3 1 10−2
× × × with mass m = 1kg, length l = 1m, damping coefficient
Individualbounds T =8430 T =8767 T =11409 b=0.5,gravitationalaccelerationg =9.81m/s2andT s =
0.1s.WefollowSection3.4anddefinetheliftingfunction
Ellipsoidal bounds T =1650 T =1797 T =2497
x=Φ(z)= [z] [z] sin([z] ) ⊤ leading toanuncertain
1 2 1
correspondingbilinearmodelis givenby bilinearsystehmrepresentationiinx.Here,weassumethat
the lifting function Φ gives an exact finite-dimensional
1.425 0.1 0.025 0.1 0
x+ = x + − u + − u x , Koopman representation of the system dynamics. How-
t " 0.625 0.8# t " 0 # t " 0 0# t t ever,weemphasizethat,whenanexactliftingisunknown,
− theapproximationerrorofthe(finite-dimensional)Koop-
(35)
manrepresentationcannotbe neglectedinthe controller
where [x ] and [x ] denote the deviation from the out-
t 1 t 2 design,see Stra¨sseretal.(2024a,b) for a detaileddiscus-
puttemperatureandconcentration,respectively.Forthe
sion. For the simulation, we choose the set in (30) via
simulation, the set in (30) is defined via fixed val- X
ues R x, S x = 0 andX an heuristically optimized Q x ma- the norm bound kx t k2 ≤ 11. Further, we select w t i. ∼i.d.
trixfollowing(Stra¨sseretal.,2024a,Procedure8).More- (0,σ2I) with σ = 1 10 3, δ = 0.05, sample z i.i.d.
over, we assume a compact input space U = [ 2,2]2. N (0,I)w
. Then,
wew assum×
e
a−
compact input space
U∼
=
−
Similar to the academic example, we study the feasibil- N
[ 2,2]andcollectT =T =50000datasamples.Follow-
0 1
ity of the controller design for the two types of error −
ing Lemma 10 and Algorithm 2 we determine the corre-
bounds and different choices of R . In particular, we se-
x sponding ellipsoidal error bounds and the respective Q
∆
lect w i.i.d. (0,σ2I) with σ = 0.1, δ = 0.05, sam- in (29). For the controller design, we observe that fea-
t ∼ N w w
i.i.d. sibility improves when over-estimating the error bound
ple x (0,I), and numerically determine the mini-
mallyr∼ equN ireddatalengthsT 0 =T 1 =T.Table2depicts by choosing Q˜ ∆ = kQ ∆ k2I in the quadratic expression
in(27).Clearly,ifthe controllerisrobustw.r.t.the over-
that the ellipsoidal error bounds require less data to de-
estimatederrorbound,thenitisalsorobustw.r.t.theac-
signafeasiblecontrollercomparedtotheindividualerror
bounds,andthe requireddatalengthincreaseswithR . tualerrorbound.TheobtainedRoAisdepictedinFig.3,
x
where we alsoinclude some closed-looptrajectoriesto il-
lustrate the controller’s performance. Overall, these re-
5.3 Nonlinear inverted pendulum
sults show that our approach can be applied to nonlin-
ear systems using the link with Koopman operator the-
Finally, we illustrate the application of our results to a ory, paving the way towards the design of data-driven
nonlinear system using the link with Koopman operator controllers for nonlinear systems using data affected by
theory discussed in Section 3.4. To this end, we consider stochasticnoise.
13
] x[
2
t
]
z[
2t6 Conclusion dynamical systems from a single trajectory. In: Proc. 2nd
Conf. on Learningfor DynamicsandControl. PMLR.
Golub, G. H., Van Loan, C. F., 2013. Matrix computations.
In this work,we leveragedtools from statistical learning
JHU press.
theoryto derivefinite sampleidentificationerrorbounds
Gutman,P.-O.,1980. Controllers for Bilinear Systems.Tech-
for the identification of unknown bilinear systems from nicalReportsTFRT-7210. DepartmentofAutomaticCon-
noisy data. To this end, the derived identification error trol, LundInstituteof Technology (LTH).
boundsarecombinedwithrobustcontrolforbilinearsys- Gutman, P.-O., 1981. Stabilizing controllers for bilinear sys-
tems to obtain a regionally exponentially stable closed tems. IEEETrans. Autom.Control 26(4), 917–922.
loop.Thepresentednumericalstudiesshowtheinterplay Huang, B., Ma, X., Vaidya, U., 2018. Feedback stabilization
betweenidentificationerrorboundsandcontrollerdesign. using Koopman operator. In: Proc. 57th IEEE Conf. on
Decision and Control (CDC).pp.6434–6439.
To the best of our knowledge, this is the first work con-
nectingstatisticallearningtheoryresultswithrobustcon-
Huang, Y., Jadbabaie, A., 1999. Nonlinear H∞ control: An
enhancedquasi-LPVapproach.IFACProceedingsVolumes
trol to provide end-to-end guarantees for indirect data-
32 (2),2754–2759.
drivencontrolofbilinearsystemsfromfinitedataaffected
Khlebnikov, M. V., 2018. Quadratic stabilization of discrete-
by potentially unbounded stochasticnoise.We note that timebilinearsystems.AutomationandRemoteControl79,
theresultsofthisworkprovideapromisingavenueforin- 1222–1239.
directdata-drivencontrolofnonlinearsystemsbymeans K¨ohler, J., Mu¨ller, M. A., Allg¨ower, F., 2020. A nonlinear
of Koopman operator theory but and view this as an in- trackingmodelpredictivecontrolschemefordynamictarget
terestingdirectionfor future work. signals. Automatica 118, 109030.
Koopman,B.O.,1931.Hamiltoniansystemsandtransforma-
tion in Hilbert space. Proc. of the National Academy of
Sciences of theUnitedStates ofAmerica 17 (5),315.
References
Korda, M., Mezi´c, I., 2018. On convergence of extended dy-
namicmodedecompositiontotheKoopmanoperator.J.of
Abbasi-Yadkori, Y., Pa´l, D., Szepesv´ari, C., 2011. Improved Nonlinear Science28 (2),687–710.
algorithms for linear stochastic bandits. In: Advances in Lin,W.,Byrnes,C.I.,1994.KYPlemma,statefeedbackand
NeuralInformation Processing Systems.Vol.24. dynamicoutputfeedbackindiscrete-timebilinearsystems.
Amato, F., Cosentino, C., Fiorillo, A. S., Merola, A., 2009. Systems& Control Letters23 (2),127–136.
Stabilization of bilinear systems via linear state-feedback Ljung,L.,1998.Systemidentification.In:Signalanalysisand
control. IEEE Trans. on Circuits and Systems II: Express prediction. Springer,pp.163–173.
Briefs 56 (1),76–80. L¨ofberg, J., 2004. YALMIP: A toolbox for modeling and
Benallou,A.,Mellichamp,D.A.,Seborg,D.E.,1988.Optimal optimization in MATLAB. In: Proc. IEEE Int. Conf. on
stabilizingcontrollersforbilinearsystems.Int.J.ofControl Robotics and Automation.pp.284–289.
48 (4),1487–1501. Longchamp,R.,1980. Stablefeedbackcontrolofbilinearsys-
BerkHizir,N.,Phan,M.Q.,Betti,R.,Longman,R.W.,2012. tems. IEEETrans. Autom.Control 25(2), 302–306.
Identification of discrete-time bilinear systems through Luesink,R.,Nijmeijer,H.,1989.Onthestabilization ofbilin-
equivalentlinearmodels.NonlinearDynamics69(4),2065– ear systems via constant feedback. Linear algebra and its
2078. applications 122, 457–474.
Bevanda, P., Driessen, B., Iacob, L.C., T´oth, R., Sosnowski, Mania, H., Tu, S., Recht, B., 2019. Certainty equivalence is
S., Hirche, S., 2024. Nonparametric control-Koopman op- efficient for linear quadratic control. Advances in Neural
eratorlearning:Flexibleandscalablemodelsforprediction Information Processing Systems32.
andcontrol. arXiv:2405.07312. Matni,N.,Tu,S.,2019.Atutorialonconcentrationboundsfor
Bevanda, P., Sosnowski, S., Hirche, S., 2021. Koopman op- systemidentification.In:Proc.58thIEEEConf.onDecision
erator dynamical models: Learning, analysis and control. and Control (CDC). pp.3741–3749.
AnnualReviewsin Control 52, 197–212. Mauroy, A., Mezi´c, I., Susuki, Y., 2020. The Koopman oper-
Coutinho, D., de Souza, C. E., da Silva, J. M. G., Caldeira, ator in systemsand control. Springer.
A. F., Prieur, C., 2019. Regional stabilization of input- Meanti, G., Chatalic, A., Kostic, V., Novelli, P., Pontil, M.,
delayed uncertain nonlinear polynomial systems. IEEE Rosasco, L., 2024. Estimating Koopman operators with
Trans.Autom.Control 65 (5),2300–2307. sketching to provably learn large scale dynamical systems.
Dasgupta, S., Shrivastava, Y., Krenzer, G., 1989. Persistent Advancesin NeuralInformation Processing Systems36.
excitation in bilinear systems. In: Proc. 28th IEEE Conf. Mezi´c,I.,2022.OnnumericalapproximationsoftheKoopman
on Decision andControl (CDC),. pp.1956–1961 vol.3. operator. Mathematics 10 (7),1180.
Dean,S.,Mania,H.,Matni,N.,Recht,B.,Tu,S.,2020.Onthe Mohler, R.R.,1973. Bilinear controlprocesses: withapplica-
samplecomplexityofthelinearquadraticregulator.Found. tionstoengineering,ecologyandmedicine.AcademicPress,
of Computational Mathematics 20 (4),633–679. Inc.
Derese,I.,Noldus,E.,1980.Designoflinearfeedbacklawsfor Mohler, R. R., Kolodziej, W., et al., 1980. An overview of
bilinear systems.Int.J.of Control 31 (2),219–237. bilinear system theory and applications. IEEE Trans. on
Favoreel,W.,DeMoor,B.,VanOverschee,P.,1999.Subspace Systems,Man andCybernetics 10(10), 683–688.
identification of bilinear systems subject to white inputs. MOSEK, A., 2022. The MOSEK optimization toolbox for
IEEETrans. Autom.Control 44(6), 1157–1165. MATLABmanual. Version 9.3.21.
Fnaiech, F., Ljung, L., Feb. 1987. Recursive identification of Nu¨ske,F.,Peitz,S.,Philipp,F.,Schaller,M.,Worthmann,K.,
bilinear systems.Int.J.of Control 45 (2),453–470. 2023. Finite-dataerrorboundsforKoopman-basedpredic-
Foster, D., Sarkar, T., Rakhlin, A., 2020. Learning nonlinear
14tion and control. J.of NonlinearScience 33(1), 14. ing dynamic mode decomposition. J. of Nonlinear Science
Pedrycz,W.,1980.Stabilizationofbilinearsystemsbyalinear 25 (6),1307–1346.
feedback control. Kybernetika16(1), 48–53. Zhou, K., Doyle, J. C., Glover, K., et al., 1996. Robust and
Philipp,F.M., Schaller,M., Boshoff, S.,Peitz,S.,Nu¨ske,F., optimal control. Vol.40. Prentice HallNewJersey.
Worthmann, K., 2024. Variance representations and con- Ziemann, I., Tsiamis, A., Lee, B., Jedra, Y., Matni, N., Pap-
vergenceratesfordata-drivenapproximationsofKoopman pas, G. J., 2023. A tutorial on the non-asymptotic theory
operators. arXiv:2402.02494. ofsystemidentification.In:Proc.62ndIEEEConf.onDe-
Rawlings, J. B., Mayne, D. Q., Diehl, M. M., 2020. Model cision and Control (CDC). pp.8921–8939.
PredictiveControl:Theory,Design,andComputation,2nd
Edition. NobHill Publishing,Madison, WI. A ProofofTheorem4
Sarkar,T.,Rakhlin,A.,2019.Nearoptimalfinitetimeidenti-
ficationofarbitrarylineardynamicalsystems.In:Int.Conf.
First, following similar arguments to the proof of Theo-
on MachineLearning. PMLR.
rem5,we obtain
Sattar, Y., Oymak, S., 2022. Non-asymptotic and accurate
learning of nonlinear dynamical systems. J. of Machine
Aˆ A
1 kΞ ⊤W
k ,
LearningResearch 23 (140), 1–49. k − k2 ≤ σ λ (Ξ Ξ)
x min ⊤
Sattar,Y.,Oymak,S.,Ozay,N.,2022.Finitesampleidentifi-
c Ca ot nio f.n oo nf Dbi el cin ise ia or nd ay nn da Cm oic na tl ros ly (s Cte Dm Cs. ).In p: pP .6ro 7c 0. 5–6 61 7st 11I .EEE where Ξ = ξ 1 ... ξ T0 ⊤ with σ xξ t = x t. From here we
ShiraniFaradonbeh,M.K.,Tewari,A.,Michailidis,G.,2018. canapplyPrhopositionsi14and15with δ andchoosec= 1
Finitetimeidentificationinunstablelinearsystems.Auto- to obtainthe result.
4 (cid:3)4
matica 96, 342–353.
Simchowitz, M., Mania, H., Tu, S., Jordan, M. I., Recht, B.,
2018.Learningwithoutmixing:Towardsasharpanalysisof B Technical resultsforthe proofofTheorem 5
linearsystemidentification.In:Conf.OnLearningTheory.
PMLR,pp.439–473.
In the following, we provide technical results, used
Sontag, E. D., Wang, Y., Megretski, A., 2009. Input classes
throughouttheproofofTheorem5.Thefollowingpropo-
for identifiability of bilinear systems. IEEE Trans. Autom.
sition is a generalization of (Matni andTu, 2019, Prop
Control 54(2), 195–207.
III.1) tosub-Gaussiannoiseandsampling.
Str¨asser, R., Berberich, J., Allg¨ower, F., 2023. Control of bi-
linear systems using gain-scheduling: Stability and perfor-
mance guarantees. In: Proc. 62nd IEEE Conf. on Decision Proposition14 Let x i.i.d subG (σ2) and w i.i.d
andControl (CDC). pp.4674–4681. subG (σ2). Fix a failut re∼ probabilitn yx δ x (0,1) ant d ∼ let
Str¨asser, R., Schaller, M., Worthmann, K., Berberich, J., nx w ∈
Allg¨ower, F., 2024a. Koopman-based feedback design with
T
i
≥
1 2log 92nx/δ ,then it holds that
stability guarantees. IEEE Trans.Autom.Control. Ti
(cid:0) (cid:1)
Str A¨a ls ls ge ¨or w, eR r,., FS .,c 2h 0a 2ll 4e br,
.
SM af. E, DW Mor Dth :m Aa cn en rt, ifiK e. d, lB eae rr nb ie nr gich ar, chJ i. -, P
"k
x tw
t⊤ k2
≤4σ xσ
w
T ilog(92nx/δ) #≤1 −δ.
t=1
tecturetailoredtodata-drivencontrolofnonlineardynam- X p
ical systems. arXiv:2402.03145.
Surana,A.,2016.Koopmanoperatorbasedobserversynthesis PROOF. The proofcanbe carriedoutinthesameway
for control-affine nonlinear systems. In: Proc. 55th IEEE as the proofof(MatniandTu,2019,Prop.III.1). (cid:3)
Conf. Decis. Control (CDC).pp.6492–6499.
Tiwari, M.,Nehma,G.,Lusch,B.,2023. Computationally ef-
ficient data-driven discovery and linear representation of The followingPropositionprovidesalowerboundonthe
nonlinear systems for control. IEEE Control Systems Let-
smallest eigenvalue of a covariance-like matrix and is a
ters7, 3373–3378.
variantof(Vershynin,2010,Theorem5.39).
Tsiamis,A.,Ziemann,I.,Matni,N.,Pappas,G.J.,2023.Sta-
tisticallearningtheoryforcontrol:Afinite-sampleperspec-
i.i.d
tive.IEEEControl Systems43 (6),67–97. Proposition15 Let x subG (σ2). Fix a failure
Tsiamis, A., Ziemann, I. M., Morari, M., Matni, N., Pappas, probability δ (0,1) at nd∼ some cnx (x 0,1). Let T
G.J.,2022.Learningtocontrollinearsystemscanbehard. ∈ ∈ 2 i ≥
8 log(2 9nx/δ).Then it holds that
In:Proc. 35th Conf. on Learning Theory.PMLR. c2 ·
Underwood, C. P., 2002. HVAC control systems: Modelling, Ti
analysis and design.Routledge. P λ x x σ T (1 2c)2 1 δ.
Verhoek,C.,Abbas,H.S.,T´oth,R.,2023.Directdata-driven "
min t ⊤t
!≥
x i
− #≥ −
t=1
LPVcontrolof nonlinearsystems:Anexperimentalresult. X
IFAC-PapersOnLine56 (2),2263–2268.
Vershynin,R.,2010.Introductiontothenon-asymptoticanal- PROOF. First we define σ y = x , such that y i.i.d.
x t t t
ysisof random matrices. arXiv:1011.3027. subG (1). Now note that Ti x x = σ2 Ti y y∼ ,
Wainwright, M. J., 2019. High-dimensional statistics: A non- nx t=1 t ⊤t x t=1 t t⊤
i.e., it suffices to analyze the smallest eigenvalue of Z =
asymptoticviewpoint. Vol.48. Cambridge Univ.Press. Ti
y y . Next, observe
tP
hat Z = Y
Y,P
with Y =
Williams, M., Kevrekidis, I., Rowley, C., 08 2015. A data- t=1 t t⊤ ⊤
driven approximation of the Koopman operator: Extend- Py
1
y
2
···
y
Ti
⊤ and using this definition it holds that
h i
15σ2 (Y) = λ (Z). Applying (Vershynin, 2010, Lemma i.e.,it sufficesto analyze
min min
5.36)withB = √1 TiY yields Ti Ti
max v y = y . (B.4)
T1 Y ⊤Y −I ≤max(ε,ε2) =
⇒
λ min(Z) ≥T(1 −ǫ)2. v ∈Snx−1| ⊤ Xt=1 t | k Xt=1 t k2
(cid:13) i (cid:13) Since wecannotevaluatethemaximumin(B.4)directly,
(cid:13) (cid:13) (B.1)
(cid:13) (cid:13) weresorttoǫ-netarguments(see,e.g.,Vershynin(2010)),
I(cid:13)nthefollowin(cid:13)g,wedeployanǫ-netargumenttoshowthe
bound on the l.h.s. of (B.1). To this end, let v M be where we approximate the maximum over the sphere by
wan e41 h- ac vo eve Mringo 9f nxSn ax n− d1. cB ony s( eV quer es nh ty lynin,2010,L{ emℓ } mℓ= a1 5.2) Nth ǫe tm obax ei am nu ǫm -neo tv oer fSa nn x−ǫ- 1c .o Dve er fii nn ig n. gT vo ∗t ah sis the en md, inw ime id ze efi rn oe f
≤ (B.4)itfollowsthatforsomev ℓ ǫwhichapproximates
1 1 ∈N
(cid:13)T iY ⊤Y −I (cid:13)≤2 ℓ ∈m [1,a 9x nx]|v ℓ⊤ (cid:18)T iY ⊤Y −I (cid:19)v ℓ | v w∗ he= re ǫargm [0,a 1x )v ,∈wSn ex− h1 av|v e⊤ T t=i 1y t |, s.t. kv ℓ − v ∗ k ≤ ǫ,
(cid:13) (cid:13) 1 ∈ P
(cid:13)
(cid:13)
(cid:13) (cid:13)=2
ℓ
∈m [1,a 9x
nx]|T
iv ℓ⊤Y ⊤Yv
ℓ
−1 |.
|v ℓ⊤
Ti
y t |≥|v ∗⊤
Ti
y t |−|(v ∗ −v ℓ) ⊤
Ti
y t
|
Cle Ta irl vy, yfo yr s vom =e ℓ
T∈
i
[ ζ1 2, ,9 wnx h] erw ee ζha =ve vv
ℓ⊤
yY
f⊤
oY llov
wℓ
s=
a
Xt=1 Xt=1
Ti
Xt=1
t=1 ℓ⊤ t t⊤ ℓ t=1 k k ℓ⊤ t (1 ǫ) y . (B.5)
Psub-Gaussian distri Pbution with variance proxy σ ζ2 = 1. ≥ − k
t=1
t k2
Hence, ζ2 is sub-exponentially distributed with param- X
eters (4,k 4), the sum Ti ζ2 is sub-exponentially dis- Choosingǫ= 1 4 itfollowsfrom(Vershynin,2010,Lemma
tributedwithparameterst= (41
T
ik
,4)andhasexpectedvalue
5.2)that
|Nǫ
|≤9nx,andby (B.5)we obtain
T i.Applyingthe two-sPidedversionof(Wainwright,2019, Ti Ti
Proposition2.9)with t=cT i, c ∈[0,1],weobtain
k
y t k2 = vm Sna xx −1|v ⊤ y t
|
Ti Xt=1 ∈ Xt=1
ObP
s(cid:2) e|
rv vℓ⊤ inY g⊤ tY hav tℓ −T i |≥cT i (cid:3)= ≤P
9nδ" x| Xt := =1
2ζ ek2
−− c2
8T Tii
|
.≥cT (Bi
#
.2)
[N 1o ,9te nxt ]h sa it n, cb ey
y
tco ∼ns st ur
bu≤
Gct
ni4
3
o xn
(ℓ 1∈ ,m )[ v1 .,a ℓ⊤9 Tx n
y
hx
t
u]|
∼
sv ,ℓ⊤
bs
yX
utT
=
bi
a1
G
py p(t
1
l| y.
) info gr Ha
ol(
l
eB
ℓ
ff. d6 ∈)
-
ing’s inequalityforeachv weobtain
1 ℓ
|v ℓ⊤Y ⊤Yv ℓ −T i |≥cT i
⇔|T
v ℓ⊤Y ⊤Yv ℓ −1 |≥c, Ti
δ
unionbounding overall v
ℓ,andsi
olvingthe r.h.sof (B.2)
P
"|
t=1v ℓ⊤y
t
|≥
2T ilog(9nx/δ)
#≤
9nx.
fora burn-in-timecondition,weconclude X p
Takingthe unionbounding overall v yields
ℓ ǫ
1 ∈N
Y ⊤Y I 2c (B.3) Ti
with probability
at(cid:13)
(cid:13) (cid:13)
(cid:13)T lei
ast 1
−−
δ
(cid:13)
(cid:13) (cid:13)
(cid:13)if≤
T i ≥ c8 2 log(2 ·9nx/δ).
P
"ℓ
∈m [1,a 9x
nx]|
Xt=1v˜ ℓ⊤y t
|≤
p2T ilog(9nx/δ) #≥1 −δ.
Combining (B.3) with (B.1)results in the desiredresult,
By (B.6)and(B.4),wededuce
wherewe requirec 1 fora non-triviallowerbound. (cid:3)
≤ 2 Ti
4
P max v⊤ x
t
σ
x
2T ilog(9nx/δ) 1 δ
"v Snx−1| |≤ 3 #≥ −
The following general result is a direct consequence of ∈ Xt=1 p
Hoeffding’s inequalityandacoveringargument. whichconcludesthe proof. (cid:3)
i.i.d.
Lemma16 Letx subG (σ2)andfixafailureprob-
t ∼ nx x C ProofofLemma10
ability δ (0,1).Then it holds that
∈
Ti
4 i.i.d.
P "vm Sna xx −1|v⊤ x
t |≤
3σ
x
2T ilog(9nx/δ) #≥1 −δ. mFi er ast n, rw ae nds oh mow vath ria at bi lf e,x
by∼
conU si( da e) rit nh gen sin(x) is a zero-
∈ t=1
X p E[sin(x)]= ∞ sin(x)f (x)dx= 1 a sin(x)dx
X
PROOF. First, we define σ xy t = x t such that y t i.i.d. Z−∞ 2a Z−a
∼ 1
subG nx(1).Note that = 2a[ −cos(x)]a
a
=0.
Ti Ti −
max v x =σ max v y , Further, observe that sin(x) [ 1,1] for all x R and
v Snx−1| ⊤ t | x v Snx−1| ⊤ t | let v S1 and λ R. Now∈ , l− et ε be an inde∈ pendent
∈ Xt=1 ∈ Xt=1 ∈ ∈
16Rademachervariable.2 Notethatsincev ⊤ξissymmetric, nu
v ξ andεv ξ sharethe samedistribution.Hence, c = ε2
⊤ ⊤ u v [B0]i
E eλv⊤ξ =E E eελv⊤ξ u uXi=1
ε t
h i
E
eλh2(v 2⊤h ξ)2 =Eii eλ2(v1x+v 22sin(x))2
, (C.1)
andobservewithprobabilityatleast1 −δ that
≤
(cid:20) (cid:21) (cid:20) (cid:21) r(x,u) 2 (c x +c u )2 2c2 x 2+2c2 u 2
wheretheinequalityfollowsfrom(Wainwright,2019,Ex- k k2 ≤ x k k2 u k k2 ≤ xk k2 uk k2
ample2.3).Sincethevarianceproxyneedstoholdforall x ⊤ 2c2I 0 x
v S1,weconsider = x nx .
∈ maxv2x2+v2sin2(x)+2v v xsin(x). "u# " 0 2c2 uI nu#"u#
v S1 1 2 1 2
∈
Inthe following,wecrudely boundthis by Thisensuresthequadraticboundin(27)withprobability
maxv2a2+v2+2a= max v2(a2 1)+2a+1. atleast1 δ for Q ∆ asin(28). (cid:3)
v ∈S1 1 2 v1∈[ −1,1] 1 − −
Clearly,this yields
E ProofofProposition12
E eλv⊤ξ eλ 22 (2a+1), if a ∈(0,1],
h
i≤(eλ 22 (a2+2a), if a ∈(1, ∞), I qn uat dh re af to il clo bw oi un ng d,w ine (p 2r 7o )v fe roP mro tp ho es eit lli io pn so1 i2 dab ly idd ee nr tiv ifiin cag tt ioh ne
whichconcludesthe proof. (cid:3) errorboundsin(9).Basedontherepresentationofthere-
mainderin(D.1),wededuceforitsnormwithprobability
atleast1 δ
D ProofofProposition11 −
r(x,u) 2
WeproveProposition11byderivingthequadraticbound k k2
nu
in (27) from the individual identification error bounds =(⋆)⊤ (1 [u]i)(A Aˆ)x
in(21).Tothisend,recalltheresidualr(x,u)in(26)and −
i=1
−
observethatwecanrewriteitas X nu
nu +(B
0
Bˆ 0)u+ [u]i(Bi Bˆ i)x
r(x,u)=(1
−
Xi=1[u] i)(A
−
+Aˆ n) ux [+ u]( (B B0 −Bˆ Bˆ0) )u xi
. (D.1)
=(⋆)⊤
−
(1
−
in =u
1[uXi= ]i1
)(A
−Aˆ)−
x
!
i i i X
− ⊤
Xi=1 nu (Bi Bˆ i)⊤ [u]ix
+ −
Then,the identificationerrorbounds (21)yield Xi=1([B 0]i −[Bˆ 0]i)⊤ [u]i 
 nu   
r(x,u) 2 x⊤ (nu+1)(1 [u]i)2(A Aˆ)⊤ (A Aˆ)x
k k ≤ − − −
nu nu Xi=1
≤|1 − i=1[u]i |kA −Aˆ k2 kx k+ v ui=1k[B 0]i −[Bˆ 0]i k2 2ku k + nu (nu+1)[⋆]⊤ [⋆] (Bi −Bˆ i)⊤ ⊤ [u]ix
+
XiX n =u
1|[u]i |kBi −Bˆ i k2 kx
ku tX (nXi u= +1
1) (1
nu
[u]

i)( 2[ xB ⊤0]i A− x[ +Bˆ 0 n]i u)⊤ [⋆

]⊤

B[u]i [u

]ix
,
nu nu ≤  − i=1 E i=1 E i[u]i 
≤"m u∈a Ux |1
−
Xi=1[u]i |#εA kx k+
v
u
uXi=1ε2
[B
0]iku
k
where we
ex
ploittX
he binomial
expaX
nsionfor
th
e
pen u
lti-
nu t mate inequality and(24)forthe lastinequality.Hence,
+ max [u]i εB x
"u∈U Xi=1| | i #k k
nu
withprobabilityatleast1 δ.Recall
kr(x,u) k2
2
≤x⊤ (nu+1)m u∈a Ux |1
−
[u]i |2 EAx
− i=1
X
c
x
= "m ua Ux |1
−
nu
[u]
i
|#ε A+ "m ua Ux
nu
|[u]
i
|ε
Bi
#, +(nu+1)[⋆]⊤ [⋆]⊤ E˜ B
(u
⊗
0Inx) In0 ux
u.
∈ i=1 ∈ i=1
X X   
2 ARademachervariableεtakesthevalues 1,1 withequal with probability at least 1 δ. Then, defining ˆ B as
probability. {− } in(29b)yields the Q ∆ in(29− ). E (cid:3)
17
GenoTEX: A Benchmark for Evaluating LLM-Based
Exploration of Gene Expression Data in Alignment with
Bioinformaticians
HaoyangLiu1 andHaohanWang1
1SchoolofInformationSciences,
UniversityofIllinoisatUrbana-Champaign
{hl57, haohanw}@illinois.edu
Abstract
Recentadvancementsinmachinelearninghavesignificantlyimprovedtheidentificationofdisease-
associatedgenesfromgeneexpressiondatasets. However, theseprocessesoftenrequireextensive
expertiseandmanualeffort,limitingtheirscalability.LargeLanguageModel(LLM)-basedagentshave
shownpromiseinautomatingthesetasksduetotheirincreasingproblem-solvingabilities.Tosupport
theevaluationanddevelopmentofsuchmethods,weintroduceGenoTEX,abenchmarkdatasetforthe
automaticexplorationofgeneexpressiondata,involvingthetasksofdatasetselection,preprocessing,
andstatisticalanalysis.GenoTEXprovidesannotatedcodeandresultsforsolvingawiderangeofgene
identificationproblems,inafullanalysispipelinethatfollowsthestandardofcomputationalgenomics.
These annotations are curated by human bioinformaticians who carefully analyze the datasets to
ensureaccuracyandreliability.Toprovidebaselinesforthesetasks,wepresentGenoAgents,ateam
ofLLM-basedagentsdesignedwithcontext-awareplanning,iterativecorrection,anddomainexpert
consultationtocollaborativelyexploregenedatasets.OurexperimentswithGenoAgentsdemonstrate
the potential of LLM-based approaches in genomics data analysis, while error analysis highlights
thechallengesandareasforfutureimprovement.WeproposeGenoTEXasapromisingresourcefor
benchmarkingandenhancingAI-drivenmethodsforgenomicsdataanalysis.Wemakeourbenchmark
publiclyavailableathttps://github.com/Liu-Hy/GenoTex.
1 Introduction
Inbiomedicalresearch,geneanalysisiscrucialforunderstandingbiologicalmechanismsandadvancing
clinical applications such as disease marker identification and personalized medicine. Advances in
next-generationsequencingandothertechnologieshaveledtoasurgeinthevolumeoftranscriptomic
data. Genomicsresearchisexpectedtoproducebetween2and40exabytesofdatainthenextdecade
[26],greatlyfacilitatingresearchanddiscoveriesingenomics.
Despitethescientificvalueofgenedataanalysis,thesetasksareoftenrepetitive,labor-intensive,and
pronetoerrors[5]. Therapidincreaseintranscriptomicdataandpotentiallyinefficientworkflowslead
toconsiderablefinancialburden[27]. Thegeneticsresearchindustryincursanannualexpenseofaround
$848.3milliononmanualdataanalysistasks[44],withcostsexpectedtoincreaseatacompoundannual
growthrate(CAGR)of12%[44]to16%[45]by2030. Bioinformaticiansspendsignificanteffortonthese
repetitivetasks,valuedataround$29perhour[41]. Thishighvolumeofroutinetasksgreatlyimpacts
job satisfaction among bioinformatics professionals, as surveys show that data scientists, including
bioinformaticians, prefer engaging in advanced analytical tasks rather than routine data processing.
Currently,upto45%oftheirworkhoursarespentontasksthatcouldbeautomated[65]. Thesefinancial
andworkforcechallengeshighlighttheurgentneedformoreefficientandcost-effectivedataanalysis
solutionsingeneticsresearch[3].
Meanwhile,theincreasingabilitiesofLargeLanguageModels(LLMs)[39]haveenabledmethods
forautomatingcertaindataanalysistasks[33,2],andrelevantbenchmarkshavebeenproposed[50,15].
However,thesestudieshavemostlyfocusedonsimplifiedsyntheticdatasets,orspecificstepsinthe
analyzepipelinesuchasmissingdataimputationorhyper-parametertuning. Incontrast,analysison
1
4202
nuJ
12
]GL.sc[
1v14351.6042:viXraResultsindependently
Datapreprocessing QuestionCreation obtainedbytwo
scientists
checkdataset mismatchtraits removeinvalid
quality andconditions ortrivialpairs Athirdscientist
adjudicates
missingvalues discrepancies
imputation
Gene Expression Analysis Results
Omnibus
removeinvalid
700+recordsof
records
research
The Cancer batcheffect question
Genome Atlas correction choosemachine optimizemodel interprete pairedwith
learningmodels parameters results
genes from
genenames data-driven
standardization repeatifnecessary methods
Figure1: TheoverviewoftheGenoTEXbenchmarkcuration.
real-worldgeneexpressiondatainvolvescomplexdomain-specificprocedures,andinherentlyrequires
theflexibleplanning,troubleshooting,anddomainknowledgeinferencetypicallyperformedbyahuman
bioinformatician,posinghigherdemandsonautomaticmethods.
To facilitate the evaluation and development of such methods, we propose the Genomics Data
Automatic Exploration Benchmark (GenoTEX), a benchmark dataset for the automated analysis of
geneexpressiondatasetstoidentifydisease-associatedgeneswhileconsideringtheinfluenceofother
biological factors. Following the standards of computational genomics and based on the common
practicesofskilledhumanbioinformaticians,weunifiedtheprocessofanalyzingvariousgeneexpression
datasetsforsolvingdifferentgeneidentificationproblemsintoastandardizedpipelinewithdetailed
procedures, documented in a guidelines file (Appendix B). We then trained and organized a group
of bioinformaticians to manually perform the data analysis according to these guidelines, creating
a benchmark dataset consisting of input data, annotated code, and intermediate and final analysis
results. Basedonthisbenchmark,weproposethreetasks,namely,datasetselection,datapreprocessing,
andstatisticalanalysis,withcorrespondingmetricsforevaluatingdifferentaspectsoftheautomatic
explorationofgeneexpressiondata.
Furthermore, toprovidebaselinesforthesetasks, weproposeGenoAgent, ateamofLLM-based
agentsthatsimulatethebehaviorofbioinformaticiansingenedataanalysis. Totacklethechallenges
ingenedataexploration,GenoAgentemploysacollaborativeworkflowfeaturedwithcontext-aware
planning, iterative correction, and domain expert consultation. The agents are instructed with the
detailedguidelinestoperformthefullpipelineofdataanalysisforsolvinggeneidentificationproblems.
OurevaluationsuggeststhatGenoAgentisabletoautomatetheprocessofgeneexpressiondataanalysis
withgoodoverallaccuracy,affirmingthepromiseofintegratingLLMsintogenomicsresearch.
Insummary,ourcontributionsareasfollows:
• Weproposeabenchmarkdataset,GenoTEX,thatpresentstheanalysispipelineforarichsetofgene
identification problems, with documented code and output. We believe it will serve as a useful
resourcefortheevaluationanddevelopmentofadvancedmethodsforautomaticgeneexpression
dataanalysis.
• Wedefinethreechallengingtasks: datasetselection,datapreprocessing,andstatisticalanalysis,along
withcorrespondingmetrics,tosupportmoresystematicevaluation.
• Weproposeabaselinemethod,GenoAgent,ateamofLLM-basedagentstocollaborativelyexplore
geneexpressiondatasets. OurevaluationdemonstratesthepromiseofLLM-basedapproachesin
genomicsdataanalysis,anderroranalysisrevealsareasforfutureimprovement.
2 Related work
LLMsforcollaborativeproblem-solving LargeLanguageModels(LLMs)haveshownthepotentialto
achievehuman-levelintelligence[59,38,55,56]. Researchhastriedtoenhancetheirproblem-solving
abilities through techniques such as goal decomposition [64, 75, 16, 37], tree and graph structures
[71,23,4],consistency[60],self-refinement[67,34,62,10],andtheuseofexternaltools[32,74,43].
Thecollaborationofmultipleagentscanfurtherenhanceproblem-solvingcapacities[63,52,14,58],
oftenthroughrole-playingwithdistinctexpertise[69,13]. MetaGPT[24]promotescollaborationamong
variousagentroles,andstudieshaveshowntheeffectivenessofrole-playinginsoftwaredevelopment
2[42, 13]. Other works explore sociological phenomena [48, 51, 76, 63, 31], such as virtual towns for
interactions among AI agents [40]. Recent research emphasizes task management and feedback for
performanceimprovement[25,68,20,72],withtaskmanagementshowntoenhancemulti-agentsystems
[52,69].
LLMsforscientificdiscovery ResearchershavealsobeenincorporatingLLMsintoscientificdiscovery
infieldssuchaschemistry[6,21],biotechnology[35],andmedicine[49,70]bytrainingorfine-tuning
LLMsondomain-specificdata. Incontrasttotheseworks,weleveragecurrentstate-of-the-artLLMs
withoutadditionaltraining. Weemploystructuredpromptingandcommunicationstrategiestoequip
LLM-basedagentswiththeplanning,analysis,andcodingabilitiesrequiredforscientificexploration.
Totacklethechallengingtasksinourbenchmark,weproposeabaselinemethodthatemploysateam
ofLLM-basedagents,eachcontributingtheirownexpertise,tocollaborativelyconductgeneexpression
dataanalysis.
3 Benchmark
ThissectiondescribesourGenoTEXbenchmark. Specifically,weintroduceourproposedstandardized
pipeline for gene expression data analysis, the process for creating and ensuring the quality of the
benchmark,andthetasksandmetricsdefinedforevaluation.
3.1 Standardizedpipelineofgeneexpressiondataanalysis
Ourstudyaimstoautomatethegeneexpressiondataanalysisprocesstoaddressaclassofimportant
problems: Whatarethesignificantgenesassociatedwithaspecifictrait,giventheinfluenceofsomecondition?
Here,a“trait”referstoacharacteristicsuchasadisease(e.g.,diabetes),anda“condition”referstoa
factorlikeage,gender,oraco-existingtrait(e.g.,hypertension). Thisproblemisscientificallyimportant
becausethekeygeneslinkedtotraitsoftenvarybasedonthediversephysicalconditionsofpatients. By
incorporatingthesefactorsintoouranalysis,weaimtogainamorecomprehensiveunderstandingofthe
geneticunderpinningsofthesetraits.
Evaluating the automatic exploration of this kind of problems is complex due to its nature. The
combination of different traits and conditions leads to a multitude of gene identification scenarios,
manyofwhichremainunderstudiedinbiomedicalliterature. Thisabsenceofaclear“groundtruth”
complicatestheevaluationofouranalysisresults. Moreover,whiledata-drivenapproachesprovide
valuable insights, they must ultimately be combined with interventional biological experiments or
clinicaltrialstoconfirmthesignificanceofidentifiedgenes. Definingtheexactinsightsthatshouldbe
extractedfromourdataanalysisisthereforecomplex.
Giventhesechallenges,insteadofcreatingabenchmarktotestwhethertheautomateddiscoveriescan
alignwitha“groundtruth”thatcanonlybediscoveredthroughinterventionalmethods,wedesigned
thebenchmarktoevaluatehowwelltheautomaticanalysisprocessandresultsalignwiththoseofa
skilledbioinformaticianfollowingstandardprocedures.
Thus,toenhancethereliabilityofourbenchmark,wehavedevelopedastandardizedanalysispipeline.
Thispipelinemirrorsthestepsaskilledbioinformaticianwouldfollow,enablingsystematicevaluationof
theautomatedmethodsagainstestablishedhumanexpertise. Byadheringtothisstandardizedapproach,
we aim to facilitate not only the evaluation of our method but also the future development of more
advancedmethods. Inthefollowingsubsection,weintroducethispipelineindetailandprovidethe
necessarybackgroundknowledgetounderstanditssignificanceandapplicationinourresearch.
3.1.1 Datapreprocessing
Thepreprocessingofgeneexpressiondatainvolvesacomprehensivepipelinewithseveralmainsteps
suchasdatasetfilteringandselection,genedatapreprocessing,traitdataextraction,anddatalinking.
Belowweintroducethepreprocessingstepsforgeneexpressiondatawithinourpipeline.
Datasetfilteringandselection Inourpaper,unlessotherwisespecified,a“dataset”referstoacohort
dataset,whichistheoverallcollectionofsamplesandtheirassociatedgeneticandclinicalinformation
fromabiomedicalstudy. Theselectionofdatasetsinvolvesthreesteps:
3Trait data extraction
Row Extraction Trait Conversion
Matrix •Text and tabular data •Biomedical knowledge
file
InitialFiltering DataLinking QualityVerification Output
Data
SOFT •Biomedicaltextunderstanding •Basic data wrangling •Basic data wrangling
file Gene Mapping Gene Normalization
•Tabular data •Utilizing tools
Inputfile
Gene data preprocessing
Figure2: ThepipelineforpreprocessingaGEOseriesdataset.
1. Initialfiltering Atthebeginningofanalysis,westartwithalistofpotentiallyusefuldatasets,and
determine the relevance of each dataset to the problem by reading the metadata. This involves
verifyingtheavailabilityofgeneexpressiondata(asopposedtomiRNAormethylationdata)andthe
traitsofinterest.
2. Qualityverification Incasethereareabnormalitiesinthedatasetthatwerenothandledsuccessfully
inthepreprocessingstep,wediscardthedatasettoensurequality.
3. Datasetselection Asgeneexpressiondataareoftenhigh-dimensionalandscarce,theanalysiscanbe
bottleneckedbysamplesize. Therefore,ifmultiplepreprocesseddatasetsareavailableforstatistical
analysisaboutatrait,weselecttheonewiththelargestsamplesize.Iftheanalysisrequiresintegrating
datasetsabouttwotraits,wesortthepossiblepairsofdatasetsforbothtraitsbytheproductoftheir
samplesizes,andselectthepairwiththelargestproduct.
Gene data preprocessing In this step, we prepare a data table where each attribute represents the
expressionlevelofaspecificgenewithinasample. Thepreprocessingstepsvarydependingonthe
measurementtechnique. Formicroarraydata,westartwithrawdatasetsidentifiedbyprobeIDs,which
are DNA sequences complementary to the target RNA sequences used to measure gene expression.
ForRNA-seqdata,wehandlesequencereadsthatrequirealignmenttoareferencegenome. Inboth
cases,wemaptheinitialidentifierstogenesymbolsusingplatform-specificgeneannotationdata. We
thennormalizeanddeduplicatethesegenesymbolsbyqueryinggenedatabasesviaAPIs,toprevent
potentialinaccuraciesduetodifferentgenenamingconventions. Thisprocessrequiresflexibleplanning
andproficientuseofbioinformaticstoolstoensureaccuracyandconsistency.
Traitdataextraction Theclinicalinformationofsamplesisrecordedincertainrowsorcolumnsof
therawdatatablewithindefiniteattributenamesspecifictoeachdataset. Inthisstep,weidentifythe
attributescontainingthetraitorconditioninformationofinterest,designconversionrules,andwrite
functionstoencodetheattributesintobinary,ordinal,orcategoricalvariables. Oftenthisinformationis
indirectlygiven,requiringustoinferitbasedondomainknowledgeaboutacronymsorjargonrelatedto
thetrait,combinedwithanunderstandingofthedatameasurementandcollectionprocessdescribedin
themetadata. SomeexamplesofthisstepareshowninAppendixC.
Datalinking Inthisstep,wemergethepreprocessedgenedatawiththeextractedtraitdatabasedon
thesampleIDs. Thisintegrationcreatesadatatablecontainingbothgeneticandclinicalfeaturesforthe
samesamples,readyforassociationstudiestoidentifysignificantgenes.
Thepreprocessingalsoinvolvescommonoperationssuchasmissingvalueimputationandcolumn
matching,someofwhicharesubstepsofthemainsteps. PleaserefertoourguidelinesfileinAppendixB
formoredetails. Fig. 2showsthepipelineofpreprocessingaseriesdatasetfromtheGEOdatabase.
3.1.2 Statisticalanalysis
Afterpreprocessing,onecanperformbasicregressionanalysistoidentifythegenesthatarepredictiveof
thedisease(ortrait)[18,66]. Lasso[53]isoftenchosenasthemodelduetoitsabilitytoidentifyasparse
setofgenes. Inadditiontodirectlyusingregressionmodel,someotherstepsareoftentaken.
Confoundingfactorcorrection Toensurereliableidentificationofgenes,thepipelineofteninvolves
stepstocorrectpotentialconfoundingfactors[30,8]. Onetypeofconfoundingfactorariseswhenthe
4distributionofgeneexpressionsvariesacrosssubgroupswithinthedataduetodifferentbackground
distributionsratherthanthediseaseitself[73]. Thisvariationcanintroducesignificantbias,leadingto
incorrectconclusionswheretheassociationbetweencertaingenesandthediseasemightbemistakenly
attributedtodifferencesingeneexpressiondistributionsacrossgroups,ratherthanatruelinktothe
disease[57].
Incorporating conditions in regression Additionally, one can include additional covariates in the
regressionmodel, suchaspatientdemographicsandco-occurrenceofotherdiseases[29]. Including
theseconditionsallowsforidentifyinggeneexpressionpatternsthatarenotonlyassociatedwiththe
diseasestatusbutalsomodulatedbytheseconditions. Thisnuancedanalysissupportsthedevelopment
ofmorepersonalizedtreatmentstrategiesbyidentifyinghowdifferentconditionsaffectgene-disease
relationships[46]. Thispracticeisencouragedduetotheneedfor“precisionmedicine”[22,9].
3.2 Benchmarkcreation
Thissubsectiondescribesourprocessofbuildingthebenchmark,includingthedesignofgeneidenti-
ficationproblems,downloadingdatafromopengeneexpressiondatabases,thecollectionofmanual
analysisdata,andqualitycontrolandassessment.
Geneidentificationproblemdesign Toensurethescientificrelevanceofourbenchmark,webegan
bycuratingalistofhumantraitsthatareeitherimportanttopublichealthorinterestingtogenomics
research. Acomputationalbiologistcompiledthislist,resultingin82traitsspanning9maincategories
suchascardiovasculardiseasesandneurologicaldisorders. Thisyields82problemsintheform: What
arethesignificantgenesrelatedtothetrait? (hereafterreferredtoas"unconditionalgeneidentification").
Next,eachtraitwaspairedwithacondition,whichcouldbeanothertraitfromthelistordemographic
attributeslikeageorgender,generating6806possibletrait-conditionpairs. Weselectedsomeofthemore
scientificallyimportantpairstoframeproblemsintheform: Whatarethesignificantgenesrelatedtothetrait
whenconsideringtheinfluenceofthecondition? (hereafterreferredtoas"conditionalgeneidentification").
Tochoosethesepairs,wefirstappliedmanuallydesignedcriteriaaboutwhichpairsmustormust
notbechosenbasedonthemaincategoriesorgroupingoftraits(AppendixD).Foreachundecided
pair,wemeasureditstrait-conditionassociationbycalculatingtheJaccardsimilaritybetweenthesets
ofgenesrelatedtothetraitandtheconditionretrievedfromtheNCBIGenedatabase[7]. Pairswitha
Jaccardsimilaritygreaterthan0.1werechosen,asthesepairsaremorelikelytoshareunderlyinggenetic
mechanisms,makingthemparticularlyvaluableforunderstandingthecomplexinteractionsbetween
traitsandconditionsinourgeneidentificationanalysis. Thisselectionprocessresultedin1064pairs
ofsignificantscientificinterest. Togetherwiththe82unconditionalgeneidentificationproblems,this
collectivelyformstheproblemsetofourbenchmark.
Input Dataset To address the formulated
Table1: DescriptivestatisticsofourGenoTexbenchmark.
research problems, we downloaded cohort
datasetscontaininggeneexpressionandcorre-
GeneIdentificationProblems
spondingclinicaldatafrompublicdatabases:(1)
Totalproblems 1146
TheGeneExpressionOmnibus(GEO)[11],the
Unconditionalproblems 82
largestgeneexpressiondatabasecurrentlyavail- Conditionalproblems 1064
able;and(2)TheCancerGenomeAtlas(TCGA)
InputDataset
[54], the largest gene expression database fo-
Totalsize 32.22GB
cusedoncancer. TheTCGAdatawereacquired
Datasets 795
viatheUCSCXenaplatform[19]. Additionally, Samplesperdataset 167±121
domainknowledgeregardinggenesymbolsas- Totalsamples 132,673
sociatedwithtraitswassourcedfromtheNCBI
ManualAnalysisandResults
Genedatabase[7]. Formoredetailedinforma-
Relevantdatasets 181
tion about these data sources, please refer to
Datasetssuccessfullypreprocessed 163
AppendixE. Linesofcodeforanalyzingperdataset 90±32
Totallinesofcodeforanalysis 71,669
Normalizedgenefeaturesperdataset 14174±5851
Manualanalysis Fourresearchersinourteam Significantgenesidentifiedperproblem 42±65
curatedtheproblemlistandextractedrelevant
inputdatafrompublicsources. Duringthepilot
5stage,acomputationalbiologistcollaboratedwithadoctoralstudenttodevelopaguidelinesfileforthe
standardizedpipelineandexamplecodeforsolvingproblemsrelatedtotwotraits. Thisinitialworkwas
iterativelyrefinedbasedontheirexperiencewithmanualanalysisonasubsetof200problems.
Inthesubsequentphaseofmanualcuration,ninebioinformaticiansdevelopedthegoldstandard
foranalyzingtheinputdataforallproblemsinourbenchmark. Thisinvolvedwritingcodefordata
preprocessing and regression analysis, and compiling the analysis results. Equipped with detailed
instructionsintheguidelinesfileandexampleanalysiscode,theseresearcherscraftedthegoldstandard
over 12 weeks. The data for each trait were independently analyzed by two researchers, with an
experiencedresearcheradjudicatingtheannotationbyselectingthebetteranalysisandmakingfurther
refinements.
To evaluate the consistency of annotations, we measured the Inter-Annotator Agreement (IAA)
betweenthetwoannotationversions. Theresultsindicatehighannotationquality,withanF scoreof
1
94.73%forthetaskofdatasetfiltering. WealsousedIAAasabaselineforhumanperformanceingene
dataanalysis,withadditionalresultspresentedinSection5.
3.3 Tasksandmetrics
Datasetselectionandfiltering WeevaluatetheperformanceofDatasetFilteringandDatasetSelection
seperately. Theformerisabinaryclassificationtask,andweuseF astheprimarymetric;Forthelatter,
1
weuseaccuracytomeasurethepercentageofproblemsforwhichthemethodchoosesthesamedataset
(orpairsofdatasets)asthebioinformationsdidinourbenchmark.
Preprocessing Duetothecomplexityofgeneexpressiondatapreprocessing,boththeattributesand
samplesoftheresultingpreprocesseddatadependlargelyonthedecisionsmadeduringthisprocess. To
evaluatetheperformanceofdifferentmethods,weadoptedthefollowingmetrics: (i)AttributeJaccard
(AJ)istheJaccardsimilaritybetweensetsofattributesoftwodatasets. Itevaluateshowwellthemethod
extractsattributesfromthedatasetbyencodingclinicalfeaturesandnormalizinggenesymbols. (ii)
SampleJaccard(SJ)istheJaccardsimilaritybetweensetsofsampleIDsoftwodatasets. Itmeasureshow
wellthemethodintegratesfeaturesofthesamesamplesandhandlesmissingvalues. Basedonthese
metrics,wedefine(iii)CompositeSimilarityCorrelation(CSC)astheproductoftheAttributeJaccard,
SampleJaccard,andthePearsoncorrelationofthecommonfeaturevectors(commonrowsandcolumns)
betweenthedatasets. Thismetriccapturesboththestructuralandcontentsimilarityoftheresulting
datasets,soweconsideritastheprimarymetricforevaluationpreprocessingalignment.
Statisticalanalysis Thegoalofstatisticalanalysisistoidentifysigificantgenesrelatedtotraits. To
evaluatethisprocess,weadoptmultiplemetricssuchasprecision,recall,andJaccardindex. TheJaccard
indexevaluatesthesimilaritybetweenthesetsofgenesidentifiedbyourmethodandthegoldstandard.
Wealsoconsidergeneidentificationasabinaryclassificationproblemofpredictingwhetherageneis
relatedtothetrait,andusePrecision,Recall,andF tomeasuretheperformance.
1
4 Method
RecentstudieshaveattemptedtoleverageLLM-basedagentstotacklechallengingproblems[25,72],
includingarangeofdataanalysistasks[33,2]. Whilethesemethodseachhavetheirownnoveltiesand
strengths,ourpreliminaryexperimentsrevealthatnoneofthemcangeneratefunctionalcodethatruns
dataanalysisonourbenchmark. Thisisnotsurprising,consideringthefullcomplexityoftheanalysis
requiredforsolvingreal-worldgenedataanalysisproblem,amoretailoredapproachisprobablyneeded.
Thissectiondescribesourmethodforexploringandsettingupabaselineforthistask.
4.1 Motivationandroledesign
Whenahumanexpertwritesprogramsforgeneexpressiondataanalysis,theyexhibitthefollowing
abilities: (i)Context-awareplanning. Theycompleteataskstepbystep,planningthenextactionbased
ontheoverallgoalandtheresultsofprevioussteps;(ii)Toolutilization. Theyselectanduselibrary
functionstoassistwithdatapreprocessingandstatisticalanalysis;(iii)Domainknowledgeinference.
Theyobservethemetadataofthedatasetandintermediateprocessingresults,usingdomainknowledge
6toinferthedesiredinformationfromthedataandusetheseobservationstocheckwhethertheircode
worksasexpected;(iv)Errorcorrection. theyanalyzetheerrorsinprogramexecutionandcorrectthem.
Webelievethatintegratingthesecomponentsisessentialforenablingagentsystemstoeffectively
tacklethecomplextaskofgeneexpressiondataanalysis. Thus,toproposereasonablebaselinesforour
benchmark,inspiredbytheworkflowofhumanbioinformaticiansingenedataanalysis,wepropose
GenoAgents,ateamofLLM-basedagents,eachplayingdifferentrolesinagenomicdatascienceteam
andcontributingtheirownexpertisetotheproblem. AProjectManagercoordinatestheanalysisprocess
forsolvingeachgeneidentificationproblem,assigningtaskstoagentswiththestandardizedpipeline
inourbenchmarkasinstructions. Twoprogrammingagents,DataEngineerandStatistician,focuson
thedatapreprocessingandstatisticalanalysistasks,respectivey. Toenablecontext-awareplanning,the
agentsmaintainataskcontextrecordingthetextinstruction,code,andtheexecutionoutputforeachof
theprevioussteps. Beforetakingastep,theagentsobservethecurrenttaskcontext,andthendecides
whethertoperformorskipthenextstep,orreverttoapreviousstepifnecessary. Ifitchoosestowrite
codetoperformastep,itcanreadthesourcecodeoffunctiontoolsinalibraryfileandchoosetouse
themasneeded.ACodeRevieweragentshelptheprogrammingagentsdebuggingcodeandverifyingthat
theircodefollowstheinstructions. ADomainExpertagentprovidesprofessionalknowledgeconsultation
toprogrammingagentswhenrequiredfordataprocessing.
4.2 CollaborationamongLLMagents
Thissubsectionintroducesthetwomainpatternsofcollaborationbetweenagents.
Codereviewanditerativedebugging ThisprocessinvolvestheinteractionbetweentheCodeReviewer
and a programming agent (Statistician or Data Engineer). If the execution fails, the Code Reviewer
evaluates the code based on its execution result, error-free status, and compliance with the given
instructions. Thenitmakesadecisiontoeitherapprovethecode, orrejectitwithdetailedfeedback
forrevisionandimprovements,asshowninFigure3inAppendix. Basedonthefeedback,theagent
iterativelyrefinesthecode,extendingthecontextwithnewversionsuntilapprovalorthemaximum
debuggingroundsarereached. Thismechanismfacilitatestroubleshootingandalsoimprovesadherence
totaskinstructions.
Domain-guidedprogramming ThesecondcollaborationpatterninvolvesaDataEngineerconsulting
aDomainExpertfordatapreprocessingtasksthatrequirespecializedknowledge. TheDataEngineer
sendsquestionstotheDomainExpert, providingthenecessarycontextsuchasmetadata, summary
informationaboutadataset,orotherintermediateresultsindataprocessing. TheDomainExpertthen
providesanswersintheformofexecutablecode. Thistypeofprogrammingalsoundergoesadebugging
process,buttheexecutionresultsaresentbacktothesameDomainExpert. Somequestionsarecomplex
enoughthattheDomainExpertmaynotprovidethecorrectanswerimmediately,necessitatingfurther
refinementbasedontheexecutionresults.
5 Experiment
This section describes our experiments to evaluate GenoAgent and other baseline methods on the
GenoTEXbenchmark. Weconductedanend-to-endevaluationwheremethodsprocessrawinputdata
tocompletethefullanalysisforsolvinggeneidentificationproblems. Additionally,weassessedthe
performanceofeachtaskindividuallytogainadeeperunderstandingoftheirstrengthsandweaknesses.
ThetasksandmetricsusedaredefinedinSection3.3. AllexperimentswereconductedonaRunPod
cluster[47]withtwo16-coreCPUsand62GBRAM.GenoAgentutilizesGPT-4o[39]modelsaccessed
viatheOpenAIAPI.
5.1 Results
End-to-endperformance Weevaluatedtheend-to-enddataanalysiscapabilitiesofGenoAgentand
baselinemethodsbymeasuringtheirperformanceingeneidentificationfromrawinputdata. Theresults
inTable3showthatGenoAgentachievedanF scoreof51.19%. Whilethisispromisinggiventhetask
1
difficulty,thereisstillasignificantgapcomparedtohumaninter-annotatoragreementscores,indicating
7Table3:End-to-endperformanceofGenoAgentonthegeneidentificationproblemsinourbenchmark;additional
evaluationontraitpredictionperformanceandtheefficiencyofLLMAPIrequestsforourexperiments. Code
executiontimeexcludedfromthetimemeasurement. WedidnotincludeotherbaselineLLM-as-agentmethods
suchasMetaGPT[24],becausenoneofthemareabletogeneraterunnablecodeforthepreprocessingofgenedata,
afterextensiveattemptsandgivendetailedinstructionsandfunctiontools(AppendixF).
BenchmarkPerformance TraitPrediction Efficiency
Methods
Prec.(%) Rec.(%) F1(%) Jac.(%) Acc.(%) Prec.(%) Rec.(%) F1(%) Tk.(k) Time(s)
GenoAgent(Ours) 54.64 52.28 51.19 48.07 94.40 91.97 89.48 86.26 31.90 183.36
GenoAgent(Round=1) 50.38 49.48 48.37 43.18 89.82 79.26 81.78 82.84 26.44 152.47
GenoAgent(NoReviewer) 21.35 20.20 20.10 18.77 62.81 57.76 62.58 59.31 23.85 128.63
GenoAgent(NoDomainExpert) 47.94 43.80 41.33 37.19 27.82 24.68 26.59 24.79 29.23 158.37
Inter-AnnotatorAgreement 75.58 70.64 69.66 68.64 - - - - - 10.74
GPT-4ozero-shot 8.47 0.12 2.41 2.69 - - - - 0.06 8.32
Table4: PerformanceofGenoAgentonthepreprocessingtasks.
MergedData GeneData TraitData
Methods
AJ(%) SJ(%) CSC(%) AJ(%) SJ(%) CSC(%) AJ(%) SJ(%) CSC(%)
GenoAgent(Ours) 89.82 86.98 79.71 92.80 89.87 80.63 46.81 63.71 32.28
GenoAgent(Round=1) 87.04 82.15 74.43 88.04 82.34 76.11 45.04 59.25 30.74
GenoAgent(NoReviewer) 35.18 35.06 32.73 36.01 35.7 33.62 24.02 32.58 6.45
GenoAgent(NoDomainExpert) 78.54 75.93 70.01 80.79 76.38 69.67 25.14 23.48 4.68
substantialroomforimprovement. Ablationresultsdemonstratedtheimportanceofthecollaborative
approachinvolvingtheCodeReviewerandDomainExpertagents,aswellasthenumberofreview
rounds. Additionally,weincludedasimplebaselinewhereGPT-4owasdirectlyaskedtoanswerthe
significantgenesineachproblem,resultinginlowperformance(2.4%F ),whichhighlightsthedifficulty
1
of this task. For completeness, we also reported the trait prediction accuracy of the agents’ models,
reflectingthevalidityofthedataandmodelstheyused.
Dataset filtering and selection The perfor-
Table2: PerformanceofGenoAgentondatasetfiltering
manceofdatasetfilteringandselectionisshown
andselection.WeuseF1andAccuracyforthetwosub-
in Table 2. The agents show decent perfor- tasks,respectively,whereDFstandsforDatasetFiltering,
mance, likely because determining dataset rele- andDSstandsforDatasetSelection
vancebasedonmetadataoftendoesnotrequire
complex inference. However, errors in thisstep Methods DF(%) DS(%)
can propagate to subsequent steps, impacting
GenoAgent(Ours) 87.32 80.25
overallperformance. GenoAgent(Rounds=1) 85.29 76.04
GenoAgent(NoReviewer) 82.13 69.57
GenoAgent(NoDomainExpert) 84.28 78.63
Dataset preprocessing We evaluated the pre-
processingperformanceofGenoAgentbycompar- Inter-AnnotatorAgreement 94.73 90.26
ing its output with that of human bioinformati-
ciansinourbenchmark. TheresultsarepresentedinTable4. GenoAgentgenerallyperformedwellin
preprocessinggeneexpressionandmergeddata,achievinghighCSCscores(80.63%forgenes). However,
preprocessingoftraitdatawassignificantlyweaker,withaCSCscoreof32.28%,duetothecomplexity
ofclinicaldataextractionandtheneedfornuancedknowledgeinference.
Statisticalanalysis Forthestatisticalanalysistask,weuseddatasetspreprocessedbyhumanbioin-
formaticians and instructed various baseline methods to perform statistical analysis following our
standardizedpipeline. TheresultsareshowninTable5. Unlikedatapreprocessing,thistaskprimarilyin-
volvesleveragingPythonlibrariesforgenericstatisticalmodeling,allowingseveralLLMsoragent-based
modelstoachievedecentperformance.
8Table5: Performanceofbaselinemethodsonthestatisticalanalysistask.
BenchmarkPerformance(%) TraitPrediction(%)
Methods
Prec. Rec. F1 Jac. Acc. Prec. Rec. F1
GenoAgent(Ours) 68.18 62.84 67.08 68.67 57.7 57.73 58.67 57.42
MetaGPT[24] 64.90 67.20 70.28 67.14 60.63 60.85 57.04 58.55
GPT-4o[39] 61.61 62.75 60.48 63.85 55.39 50.72 52.50 50.42
Llama3(8B)[36] 8.29 10.42 8.58 12.68 8.36 8.90 5.54 5.45
5.2 Discussions
WhiletheresultsdemonstratethepotentialofLLM-basedmethodsingeneanalysis,theyalsohighlight
thelimitationsofcurrentapproaches.
Instability of the feedback mechanism For complex tasks, the ideal scenario is for the agent to
iterativelyimproveitscodebasedonfeedbacktoeventuallyreachthecorrectsolution. However,the
resultsinTable3indicatethatwhileasingleroundoffeedbacksignificantlyimprovesperformance
comparedtonofeedback,additionalroundsprovidemarginalbenefits,leavinganotablegapcompared
tohumanperformance. Byexaminingtheagents’operations(AppendixG),wefoundthatfeedbackfrom
theCodeRevieweragentoftenvariedrandomlyandwassometimesincorrect.RLHF-tunedlargemodels
appearsusceptibletobeingmisledratherthanadheringtoinitialinsights. Apromisingdirectionisto
designcollaborativemodesthatencourageagentstodiscussdifferingopinionsiterativelytoenhance
theirunderstandingofthetask.
6 Conclusion
In this work, we introduced GenoTEX, a benchmark dataset designed to facilitate the automatic ex-
plorationofgeneexpressiondataforidentifyingdisease-associatedgenes. GenoTEXencompassesa
comprehensive analysis pipeline, reflecting the standards of computational genomics, and includes
annotatedcodeandresultscuratedbyexpertbioinformaticians. Bydefiningthreecoretasks—dataset
selection,datapreprocessing,andstatisticalanalysis—weprovidearobustframeworkforevaluating
anddevelopingautomatedmethods. Furthermore,ourproposedGenoAgent,ateamofLLM-based
agents,demonstratesthepotentialofintegratinglargelanguagemodelsintothefieldofgenomics. Our
experiments highlight both the strengths and limitations of these agents, underscoring the need for
furtherresearchtoaddresschallengesinnuancedhumanjudgmentanddataanomalies. GenoTEXis
poised to be a useful resource in advancing AI-driven genomics data analysis, promoting efficiency,
accuracy,andscalabilityinbiomedicalresearch.
Acknowledgments and Disclosure of Funding
ThisresearchwassupportedbytheAccelerateFoundationModelsResearch(AFMR)initiativefundedby
MicrosoftResearch. WeusedtheMicrosoftAzureOpenAIserviceforourexperimentsandarethankful
forthecomputationcreditsandtechnicalsupportprovided.
9References
[1] M.Akhtar,O.Benjelloun,C.Conforti,P.Gijsbers,J.Giner-Miguelez,N.Jain,M.Kuchnik,Q.Lhoest,
P. Marcenac, M. Maskey, P. Mattson, L. Oala, P. Ruyssen, R. Shinde, E. Simperl, G. Thomas,
S. Tykhonov, J. Vanschoren, J. van der Velde, S. Vogler, and C.-J. Wu. Croissant: A metadata
formatforml-readydatasets. InProceedingsoftheEighthWorkshoponDataManagementforEnd-to-
EndMachineLearning,SIGMOD/PODS’24.ACM,June2024. doi: 10.1145/3650203.3663326. URL
http://dx.doi.org/10.1145/3650203.3663326.
[2] S.T.Arasteh,T.Han,M.Lotfinia,C.Kuhl,J.N.Kather,D.Truhn,andS.Nebelung. Largelanguage
models streamline automated machine learning for clinical studies. Nature Communications, 15
(1603), 2024. doi: 10.1038/s41467-024-45879-8. URLhttps://www.nature.com/articles/
s41467-024-45879-8.
[3] K.Bartley. Bigdatastatistics: Howmuchdataisthereintheworld?,2023. URLhttps://rivery.
io/blog/big-data-statistics-how-much-data-is-there-in-the-world/.
[4] M.Besta,N.Blach,A.Kubicek,R.Gerstenberger,L.Gianinazzi,J.Gajda,T.Lehmann,M.Podstawski,
H.Niewiadomski,P.Nyczyk,andT.Hoefler. Graphofthoughts: Solvingelaborateproblemswith
largelanguagemodels. arXivpreprintarXiv: 2308.09687,2023.
[5] R. BPC. Navigating the intersection of biostatistics, bioinformatics,
and machine learning., 2023. URL https://medium.com/@RR-BPC/
navigating-the-intersection-of-biostatistics-bioinformatics-and-machine-learning-d1b1337757b9.
[6] A.M.Bran,S.Cox,O.Schilter,C.Baldassari,A.D.White,andP.Schwaller.Chemcrow:Augmenting
large-languagemodelswithchemistrytools. arXivpreprintarXiv: 2304.05376,2023.
[7] G.R.Brown,V.Hem,K.S.Katz,M.Ovetsky,C.Wallin,O.Ermolaeva,I.Tolstoy,T.Tatusova,K.D.
Pruitt, and D. R. Maglott. Gene: a gene-centered information resource at NCBI. Nucleic Acids
Research,43(D1):D36–D42,2015. doi: 10.1093/nar/gku1055. URLhttps://doi.org/10.1093/
nar/gku1055.
[8] O.Bruning,W.Rodenburg,P.F.Wackers,C.VanOostrom,M.J.Jonker,R.J.Dekker,H.Rauwerda,
W.A.Ensink,A.DeVries,andT.M.Breit. Confoundingfactorsinthetranscriptomeanalysisofan
in-vivoexposureexperiment. PLoSOne,11(1):e0145252,2016.
[9] I. S. Chan and G. S. Ginsburg. Personalized medicine: progress and promise. Annual review of
genomicsandhumangenetics,12:217–244,2011.
[10] X.Chen,M.Lin,N.Schärli,andD.Zhou. Teachinglargelanguagemodelstoself-debug. arXiv
preprintarXiv: 2304.05128,2023.
[11] E.CloughandT.Barrett. Thegeneexpressionomnibusdatabase. MethodsinMolecularBiology,1418:
93–110,2016. doi: 10.1007/978-1-4939-3578-9_5.
[12] C.Commons. Creativecommonsattribution4.0internationalpubliclicense,2013. URLhttps:
//creativecommons.org/licenses/by/4.0/.
[13] Y.Dong,X.Jiang,Z.Jin,andG.Li. Self-collaborationcodegenerationviachatgpt. arXivpreprint
arXiv: 2304.07590,2023.
[14] Y.Du,S.Li,A.Torralba,J.B.Tenenbaum,andI.Mordatch. Improvingfactualityandreasoningin
languagemodelsthroughmultiagentdebate. arXivpreprintarXiv: 2305.14325,2023.
[15] H. Eldeeb, M. Maher, R. Elshawi, and S. Sakr. Automlbench: A comprehensive experimental
evaluationofautomatedmachinelearningframeworks. ExpertSystemswithApplications,243:122877,
2024.
[16] G.Feng,B.Zhang,Y.Gu,H.Ye,D.He,andL.Wang. Towardsrevealingthemysterybehindchain
ofthought: Atheoreticalperspective. NEURIPS,2023.
[17] T.Gebru,J.Morgenstern,B.Vecchione,J.W.Vaughan,H.Wallach,H.DauméIII,andK.Crawford.
Datasheetsfordatasets. arXivpreprintarXiv:1803.09010,2020.
[18] D.GhoshandA.M.Chinnaiyan. Classificationandselectionofbiomarkersingenomicdatausing
lasso. JournalofBiomedicineandBiotechnology,2005(2):147,2005.
10[19] M.J.Goldman,B.Craft,M.Hastie,etal. Visualizingandinterpretingcancergenomicsdatavia
the xena platform. Nature Biotechnology, 2020. doi: 10.1038/s41587-020-0546-8. URL https:
//doi.org/10.1038/s41587-020-0546-8.
[20] Z.Gou,Z.Shao,Y.Gong,Y.Shen,Y.Yang,N.Duan,andW.Chen. Critic: Largelanguagemodels
canself-correctwithtool-interactivecritiquing. arXivpreprintarXiv:2305.11738,2023.
[21] T.Guo,K.Guo,B.Nan,Z.Liang,Z.Guo,N.V.Chawla,O.Wiest,andX.Zhang. Whatcanlarge
language models do in chemistry? a comprehensive benchmark on eight tasks. arXiv preprint
arXiv:2305.18365,2023.
[22] M. A. Hamburg and F. S. Collins. The path to personalized medicine. New England Journal of
Medicine,363(4):301–304,2010.
[23] S.Hao,Y.Gu,H.Ma,J.J.Hong,Z.Wang,D.Wang,andZ.Hu. Reasoningwithlanguagemodelis
planningwithworldmodel. ConferenceonEmpiricalMethodsinNaturalLanguageProcessing,2023.
doi: 10.48550/arXiv.2305.14992.
[24] S.Hong,M.Zhuge,J.Chen,X.Zheng,Y.Cheng,C.Zhang,J.Wang,Z.Wang,S.K.S.Yau,Z.Lin,
L.Zhou,C.Ran,L.Xiao,C.Wu,andJ.Schmidhuber. Metagpt:Metaprogrammingforamulti-agent
collaborativeframework. arXivpreprintarXiv: 2308.00352,2023.
[25] J.Huang,X.Chen,S.Mishra,H.S.Zheng,A.W.Yu,X.Song,andD.Zhou. Largelanguagemodels
cannotself-correctreasoningyet. arXivpreprintarXiv:2310.01798,2023.
[26] N. H. G. R. Institute. Genomic data science, 2024. URL https://www.genome.gov/
about-genomics/fact-sheets/Genomic-Data-Science. Accessed: 2024-06-03.
[27] M. Intelligence. Bioinformatics market size & share analysis - growth trends & fore-
casts source, 2023. URL https://www.mordorintelligence.com/industry-reports/
global-bioinformatics-market-industry.
[28] G.KelloggandM.Lanthaler. Json-ld1.1: Ajson-basedserializationforlinkeddata. https://www.
w3.org/TR/json-ld11/,July2020. WorldWideWebConsortium(W3C)Recommendation.
[29] B.Kyalwazi,C.Yau,M.J.Campbell,T.F.Yoshimatsu,A.J.Chien,A.M.Wallace,A.Forero-Torres,
L.Pusztai,E.D.Ellis,K.S.Albain,etal. Race,geneexpressionsignatures,andclinicaloutcomesof
patientswithhigh-riskearlybreastcancer. JAMANetworkOpen,6(12):e2349646–e2349646,2023.
[30] J.T.Leek,R.B.Scharpf,H.C.Bravo,D.Simcha,B.Langmead,W.E.Johnson,D.Geman,K.Baggerly,
andR.A.Irizarry. Tacklingthewidespreadandcriticalimpactofbatcheffectsinhigh-throughput
data. NatureReviewsGenetics,11(10):733–739,2010.
[31] H.Li,Y.Q.Chong,S.Stepputtis,J.Campbell,D.Hughes,M.Lewis,andK.Sycara. Theoryofmind
formulti-agentcollaborationvialargelanguagemodels. arXivpreprintarXiv:2310.10701,2023.
[32] B.Liu, Y.Jiang, X.Zhang, Q.Liu, S.Zhang, J.Biswas, andP.Stone. Llm+p: Empoweringlarge
languagemodelswithoptimalplanningproficiency. arXivpreprintarXiv: 2304.11477,2023.
[33] P.Ma,R.Ding,S.Wang,S.Han,andD.Zhang. Insightpilot: Anllm-empoweredautomateddata
explorationsystem. arXivpreprintarXiv:2304.00477,2023. URLhttps://arxiv.org/abs/2304.
00477.
[34] A.Madaan,N.Tandon,P.Gupta,S.Hallinan,L.Gao,S.Wiegreffe,U.Alon,N.Dziri,S.Prabhumoye,
Y.Yang,etal. Self-refine: Iterativerefinementwithself-feedback. arXivpreprintarXiv:2303.17651,
2023.
[35] A.Madani,B.Krause,E.R.Greene,S.Subramanian,B.P.Mohr,J.M.Holton,J.L.OlmosJr,C.Xiong,
Z.Z.Sun,R.Socher,etal. Largelanguagemodelsgeneratefunctionalproteinsequencesacross
diversefamilies. NatureBiotechnology,pages1–8,2023.
[36] Meta. Lamma-3,2024. URLhttps://ai.meta.com/blog/meta-llama-3/. Thestate-of-the-
artopensourcelargelanguagemodelofMeta.
[37] X.Ning,Z.Lin,Z.Zhou,H.Yang,andY.Wang. Skeleton-of-thought: Largelanguagemodelscan
doparalleldecoding. arXivpreprintarXiv:2307.15337,2023.
[38] OpenAI. Gpt-4technicalreport. PREPRINT,2023.
11[39] OpenAI. Gpt-4o, 2024. URL https://openai.com/index/hello-gpt-4o/. Latest Large
languagemodelofOpenAI.
[40] J.Park,J.C.O’Brien,C.J.Cai,M.Morris,P.Liang,andM.S.Bernstein.Generativeagents:Interactive
simulacraofhumanbehavior. ACMSymposiumonUserInterfaceSoftwareandTechnology,2023. doi:
10.1145/3586183.3606763.
[41] I. Payscale. Bioinformatics hourly rate. URL https://www.payscale.com/research/US/
Skill=Bioinformatics/Hourly_Rate. Accessed: 2024-06-20.
[42] C.Qian,X.Cong,W.Liu,C.Yang,W.Chen,Y.Su,Y.Dang,J.Li,J.Xu,D.Li,Z.Liu,andM.Sun.
Communicativeagentsforsoftwaredevelopment. arXivpreprintarXiv: 2307.07924,2023.
[43] Y.Qin,S.Liang,Y.Ye,K.Zhu,L.Yan,Y.Lu,Y.Lin,X.Cong,X.Tang,B.Qian,S.Zhao,L.Hong,
R.Tian,R.Xie,J.Zhou,M.Gerstein,D.Li,Z.Liu,andM.Sun. Toolllm: Facilitatinglargelanguage
modelstomaster16000+real-worldapis. arXivpreprintarXiv: 2307.16789,2023.
[44] Research and Markets. Next generation sequencing (ngs) data analysis - global strategic
businessreport,2024. URLhttps://www.researchandmarkets.com/reports/5303640/
next-generation-sequencing-ngs-data-analysis. Accessed: 2024-06-03.
[45] D. B. M. Research. Global next generation sequencing data analysis market – industry trends
andforecastto2030,2024. URLhttps://www.databridgemarketresearch.com/reports/
global-next-generation-sequencing-data-analysis-market. Accessed: 2024-06-03.
[46] R.Rosenquist,E.Bernard,T.Erkers,D.W.Scott,R.Itzykson,P.Rousselot,J.Soulier,M.Hutchings,
P. Östling, L. Cavelier, et al. Novel precision medicine approaches and treatment strategies in
hematologicalmalignancies. JournalofInternalMedicine,294(4):413–436,2023.
[47] RunPod. Runpod:Thecloudbuiltforai. https://www.runpod.io/,2024. Accessed:2024-06-06.
[48] D.Shapiro, W.Li, M.Delaflor, andC.Toxtli. Conceptualframeworkforautonomouscognitive
entities. arXivpreprintarXiv: 2310.06775,2023.
[49] K.Singhal,S.Azizi,T.Tu,S.S.Mahdavi,J.Wei,H.W.Chung,N.Scales,A.Tanwani,H.Cole-Lewis,
S.Pfohl,etal. Largelanguagemodelsencodeclinicalknowledge. Nature,620(7972):172–180,2023.
[50] H.Stühler,M.-A.Zöller,D.Klau,A.Beiderwellen-Bedrikow,andC.Tutschku. Benchmarkingauto-
matedmachinelearningmethodsforpriceforecastingapplications. arXivpreprintarXiv:2304.14735,
2023.
[51] T.R.Sumers,S.Yao,K.Narasimhan,andT.L.Griffiths. Cognitivearchitecturesforlanguageagents.
arXivpreprintarXiv: 2309.02427,2023.
[52] Y. Talebirad and A. Nadiri. Multi-agent collaboration: Harnessing the power of intelligent llm
agents. arXivpreprintarXiv: 2306.03314,2023.
[53] R.Tibshirani. Regressionshrinkageandselectionviathelasso. JournaloftheRoyalStatisticalSociety
SeriesB:StatisticalMethodology,58(1):267–288,1996.
[54] K.Tomczak,P.Czerwin´ska,andM.Wiznerowicz. Thecancergenomeatlas(tcga): animmeasurable
sourceofknowledge. ContemporaryOncology(Poznan),19(1A):A68–77,2015. doi: 10.5114/wo.2014.
47136.
[55] H. Touvron, T. Lavril, G. Izacard, X. Martinet, M.-A. Lachaux, T. Lacroix, B. Rozière, N. Goyal,
E.Hambro,F.Azhar,A.Rodriguez,A.Joulin,E.Grave,andG.Lample. Llama: Openandefficient
foundationlanguagemodels. arXivpreprintarXiv: 2302.13971,2023.
[56] H.Touvron,L.Martin,K.Stone,P.Albert,A.Almahairi,Y.Babaei,N.Bashlykov,S.Batra,P.Bhar-
gava,S.Bhosale,D.Bikel,L.Blecher,C.C.Ferrer,M.Chen,G.Cucurull,D.Esiobu,J.Fernandes,
J.Fu,W.Fu,B.Fuller,C.Gao,V.Goswami,N.Goyal,A.Hartshorn,S.Hosseini,R.Hou,H.Inan,
M.Kardas,V.Kerkez,M.Khabsa,I.Kloumann,A.Korenev,P.S.Koura,M.-A.Lachaux,T.Lavril,
J.Lee,D.Liskovich,Y.Lu,Y.Mao,X.Martinet,T.Mihaylov,P.Mishra,I.Molybog,Y.Nie,A.Poulton,
J.Reizenstein,R.Rungta,K.Saladi,A.Schelten,R.Silva,E.M.Smith,R.Subramanian,X.E.Tan,
B.Tang,R.Taylor,A.Williams,J.X.Kuan,P.Xu,Z.Yan,I.Zarov,Y.Zhang,A.Fan,M.Kambadur,
S.Narang,A.Rodriguez,R.Stojnic,S.Edunov,andT.Scialom. Llama2: Openfoundationand
fine-tunedchatmodels. arXivpreprintarXiv: 2307.09288,2023.
12[57] H.Wang,B.Aragam,andE.P.Xing. Trade-offsoflinearmixedmodelsingenome-wideassociation
studies. JournalofComputationalBiology,29(3):233–242,2022.
[58] K. Wang, Y. Lu, M. Santacroce, Y. Gong, C. Zhang, and Y. Shen. Adapting llm agents through
communication. arXivpreprintarXiv: 2310.01444,2023.
[59] L.Wang,C.Ma,X.Feng,Z.Zhang,H.Yang,J.Zhang,Z.Chen,J.Tang,X.Chen,Y.Lin,etal. A
surveyonlargelanguagemodelbasedautonomousagents. arXivpreprintarXiv:2308.11432,2023.
[60] X. Wang, J. Wei, D. Schuurmans, Q. Le, E. Chi, S. Narang, A. Chowdhery, and D. Zhou.
Self-consistency improves chain of thought reasoning in language models. arXiv preprint
arXiv:2203.11171,2022.
[61] X.Wang,Y.Chen,L.Yuan,Y.Zhang,Y.Li,H.Peng,andH.Ji. Executablecodeactionselicitbetter
llmagents. arXivpreprintarXiv:2402.01030,2024.
[62] Y.Wang,Z.Jiang,Z.Chen,F.Yang,Y.Zhou,E.Cho,X.Fan,X.Huang,Y.Lu,andY.Yang. Recmind:
Largelanguagemodelpoweredagentforrecommendation. arXivpreprintarXiv:2308.14296,2023.
[63] Z.Wang,S.Mao,W.Wu,T.Ge,F.Wei,andH.Ji. Unleashingtheemergentcognitivesynergyinlarge
languagemodels: Atask-solvingagentthroughmulti-personaself-collaboration. arXivpreprint
arXiv:2307.05300,2023.
[64] J.Wei,X.Wang,D.Schuurmans,M.Bosma,F.Xia,E.Chi,Q.V.Le,D.Zhou,etal. Chain-of-thought
promptingelicitsreasoninginlargelanguagemodels. AdvancesinNeuralInformationProcessing
Systems,35:24824–24837,2022.
[65] A. Woodie. Data prep still dominates data scientists’ time, sur-
vey finds, 2020. URL https://www.datanami.com/2020/07/06/
data-prep-still-dominates-data-scientists-time-survey-finds/.
[66] T.T.Wu,Y.F.Chen,T.Hastie,E.Sobel,andK.Lange. Genome-wideassociationanalysisbylasso
penalizedlogisticregression. Bioinformatics,25(6):714–721,2009.
[67] Z. Xi, S. Jin, Y. Zhou, R. Zheng, S. Gao, T. Gui, Q. Zhang, and X. Huang. Self-polish: Enhance
reasoninginlargelanguagemodelsviaproblemrefinement. arXivpreprintarXiv:2305.14497,2023.
[68] Z.Xu,S.Shi,B.Hu,J.Yu,D.Li,M.Zhang,andY.Wu. Towardsreasoninginlargelanguagemodels
viamulti-agentpeerreviewcollaboration. arXivpreprintarXiv: 2311.08152,2023.
[69] H. Yang, S. Yue, and Y. He. Auto-gpt for online decision making: Benchmarks and additional
opinions. arXivpreprintarXiv: 2306.02224,2023.
[70] R.Yang,T.F.Tan,W.Lu,A.J.Thirunavukarasu,D.S.W.Ting,andN.Liu. Largelanguagemodels
inhealthcare: Development,applications,andchallenges. HealthCareScience,2(4):255–263,2023.
[71] S. Yao, D. Yu, J. Zhao, I. Shafran, T. L. Griffiths, Y. Cao, and K. Narasimhan. Tree of thoughts:
Deliberateproblemsolvingwithlargelanguagemodels. arXivpreprintarXiv:2305.10601,2023.
[72] Z.Yin,Q.Sun,C.Chang,Q.Guo,J.Dai,X.-J.Huang,andX.Qiu. Exchange-of-thought: Enhancing
largelanguagemodelcapabilitiesthroughcross-modelcommunication. InProceedingsofthe2023
ConferenceonEmpiricalMethodsinNaturalLanguageProcessing,pages15135–15153,2023.
[73] J.Yu,G.Pressoir,W.H.Briggs,I.VrohBi,M.Yamasaki,J.F.Doebley,M.D.McMullen,B.S.Gaut,
D.M.Nielsen,J.B.Holland,etal. Aunifiedmixed-modelmethodforassociationmappingthat
accountsformultiplelevelsofrelatedness. Naturegenetics,38(2):203–208,2006.
[74] R. Zhao, X. Li, S. R. Joty, C. Qin, and L. Bing. Verify-and-edit: A knowledge-enhanced chain-
of-thoughtframework. AnnualMeetingoftheAssociationforComputationalLinguistics,2023. doi:
10.48550/arXiv.2305.03268.
[75] L.Zheng,R.Wang,andB.An. Synapse: Leveragingfew-shotexemplarsforhuman-levelcomputer
control. arXivpreprintarXiv:2306.07863,2023.
[76] P.Zhou,A.Madaan,S.P.Potharaju,A.Gupta,K.R.McKee,A.Holtzman,J.Pujara,X.Ren,S.Mishra,
A.Nematzadeh,S.Upadhyay,andM.Faruqui. Howfararelargelanguagemodelsfromagents
withtheory-of-mind? arXivpreprintarXiv: 2310.03051,2023.
13GenoTEX: A Benchmark for Evaluating LLM-Based Exploration of
Gene Expression Data in Alignment with Bioinformaticians
Supplementary Material
Thesupplementarymaterialisorganizedasfollows:
• AppendixAdescribesthedatasetaccessibility,documentation,andmaintenanceofourbenchmark.
• AppendixBintroducestheguidelinesfileusedtostandardizethemanualcurationofourbenchmark.
• AppendixCprovidesexamplesofmanualanalysisontraitdataextraction.
• AppendixDoutlinesthecriteriaforformingtrait-conditionpairsforgeneidentificationproblemsin
ourbenchmark.
• AppendixEdescribesourdataacquisitionprocess.
• AppendixFpresentsourpreliminaryexperimentshighlightingthechallengesfacedbyexistingLLMs
andagent-basedmethodsonourbenchmark.
• AppendixGdiscussesthelimitationsofGenoAgentonourbenchmark.
A Dataset accessibility, documentation, and maintenance
A.1 Documentationandintendeduses
GenoTEXisdocumentedfollowingtheDatasheetsforDatasets[17]framework,providingacompre-
hensivedescriptionofthedatacollectionprocess,preprocessingsteps,andstatisticalanalysismethods
employed.Thedetaileddatasheetisavailablehere.Eachstepofthepipelineaimstomirrorthestandards
ofcomputationalgenomics,ensuringthatthedatasetisbothaccurateandreliable. Theintendedusesof
GenoTEXarebroad,encompassingtheevaluationanddevelopmentofAI-drivenmethodsforgenomics
dataanalysis. Byprovidingastandardizedbenchmark,GenoTEXaimstofacilitatetheadvancement
ofmachinelearningmodelscapableofautomatingthecomplextaskofgeneexpressionanalysis. Re-
searchersinbioinformaticsandrelatedfieldscanleveragethisdatasettobenchmarktheiralgorithms,
fosteringinnovationandimprovingthescalabilityofgeneidentificationprocesses.
A.2 Openaccessandmaintenance
ToensuretheaccessibilityandusabilityofGenoTEX,wehavemadethedatasetpubliclyavailablehere.
The dataset is hosted on GitHub, ensuring long-term availability and ease of access. The metadata
associated with the dataset is documented here using the Croissant Metadata Record [1], providing
a structured and detailed overview of the dataset’s features and attributes. We have structured the
metadataaccordingtotheJSON-LDstandard[28]toenhanceinteroperabilityandorganization. Wewill
maintainthedatasetwithregularupdatesandongoingsupporttoaddressanyissuesorimprovements
thatmayarise.
A.3 Licensingandresponsibility
TheGenoTEXdatasetisreleasedunderaCreativeCommonsAttribution4.0International(CCBY4.0)
license[12],whichallowsforbroadusagewhileprotectingtherightsofthecreators. Theauthorsbear
fullresponsibilityforensuringthatthedatasetadherestothislicenseandforanypotentialviolations
ofrights. ThisresponsibilityincludesensuringthatalldataincludedinGenoTEXisethicallysourced
and legally compliant. Throughout the curation process, we engaged in extensive discussions and
consultations to address ethical considerations and legal requirements. Despite our best efforts, we
remainawarethatethicallandscapescanbecomplexandevolving,andwecontinuallyaskourselves
whetherwearemeetingthehigheststandards. Thisinvolvedcarefulexaminationofeachdatasetto
ensuretheabsenceofpersonallyidentifiableinformationandcompliancewithallrelevantstandards.
OurapproachaimstoensurethatGenoTEXmeetstheethicalandlegalstandardsexpectedinthefieldof
machinelearningandcomputationalgenomicsresearch.
14A.4 Dataformatandpersistentidentifiers
GenoTEX is provided in open and widely used data formats, including CSV and JSON, ensuring
compatibility with a wide range of analytical tools and platforms. Detailed instructions on how to
readandusethedatasetareincludedinthedocumentation,makingitaccessibletobothnoviceand
experiencedresearchers. Toenhancethedataset’sstabilityandeaseofreference,wehavemintedaDOI
forGenoTEX.ThisDOIwillserveasareliablemeansofaccessandcitationforthedataset,promotingits
useinacademicandprofessionalresearch.
A.5 Reproducibility
Tosupportreproducibility,wehaveincludedallthenecessarydatasets,code,andevaluationprocedures
in our documentation. We have worked diligently to ensure that others can replicate the results of
ouranalyses. Byourcommitmenttotransparencyandreproducibility,wehopetofacilitatethewider
adoptionandvalidationofAI-drivenmethodsingenomicsresearch.
B Guidelines for gene expression data analysis
Totacklethecomplexitiesofgeneexpressiondataanalysis,wehaveestablishedasetofcomprehensive
guidelinesshownbelow. Theseguidelinestrytoreplicatethedetailedprocessesofaskilledbioinformati-
cian,coveringdatasetpreprocessing,selection,andstatisticalanalysis. Byfollowingthesestandardized
procedures,weseektoimproveconsistencyandreliabilityinourmanualbenchmarkcuration.
This document describes the standardized pipeline for analyzing gene expression
data for identifying disease-associated genes, involving dataset preprocessing,
selection, and statistical analysis. These steps follow the practices of
computational genomics and ensure the reproducibility and reliability of the
analysis.
Data Sources and Organization:
- Gene expression data are sourced from two public databases, organized by trait
in specific subdirectories:
- Gene Expression Omnibus (GEO): Data are downloaded under certain criteria
and saved under the path "{data_root}/GEO". Within this directory, datasets
related to each trait are organized in subdirectories named after the trait.
- The Cancer Genome Atlas (TCGA) data via the Xena platform: Data are saved
under the path "{data_root}/TCGA". Similar to GEO, datasets related to each
cancer type are organized in subdirectories named after the specific cancer
trait.
Problem Setting Differentiation:
- If the problem is to identify significant genes predictive of a trait (
optionally conditioning on age or gender, but not involving another trait),
prepare the data related to this trait.
- If the problem is to identify significant genes predictive of a trait while
conditioning on another trait, prepare data for both traits. These datasets will
be integrated in a two-step regression process.
PART I. GEO Data Preprocessing
Step 1: Initial Data Loading
1. Identify the names of the SOFT file and Matrix file of the Series data.
2. Read the Matrix file to obtain background information and clinical trait data.
This involves extracting the text data of series titles, summaries, and overall
designs, as well as the tabular data of sample characteristics.
3. Get the unique values of all attributes in the sample characteristics table
into a Python dictionary.
4. Print the background information and the sample characteristics dictionary
for later observation.
15Step 2: Dataset Analysis and Clinical Feature Extraction
1. Read the metadata to determine if the dataset is likely to contain gene
expression data (which does not include miRNA data or methylation data).
2. Based on the metadata and the sample characteristics dictionary, for each of
the variables of interest (e.g., a specific trait, age, gender):
a. Assess the availability of data.
b. If available, identify the key in the sample characteristics dictionary
where unique values of this variable are recorded.
c. Choose the appropriate data type (continuous, binary, or categorical) and
design conversion functions to encode the features into that type.
3. Conduct initial filtering. If either the gene data or trait data is not
available, discard this dataset; otherwise, continue with the following steps.
Step 3: Gene Data Extraction
1. Read the Matrix file to extract the tabular gene expression data into a
dataframe.
2. Print the first few row identifiers in the dataframe for later observation.
3. Determine if the row identifiers are human gene symbols or other types that
require mapping.
Step 4: Gene Annotation (Conditional)
1. If gene mapping is required, extract the gene annotation table from the SOFT
file.
2. Preview the gene annotation table for later observation.
Step 5: Gene Identifier Mapping
1. If gene mapping is required, identify the columns for the identifiers and
gene symbols from the gene annotation table.
2. Create a mapping dataframe and apply it to the gene expression data. Handle
many-to-many relationships between probe IDs and gene symbols by splitting
concatenated strings of symbols using separators such as semicolons (;),
vertical bars (|), double slashes (//), and commas (,). Assign the corresponding
expression values to each gene symbol linked to an identifier. Finally,
aggregate the expression values for each gene symbol by averaging the values
from multiple probes, with the aim of accurately representing the expression
level of each gene symbol.
Step 6: Data Normalization and Merging
1. Normalize the gene symbols in the gene data by querying databases with the
Python MyGene library, setting the ‘scopes’ parameter properly. Remove data
corresponding to genes that cannot be normalized. For genes that normalize to
the same symbol, deduplicate by averaging their expression values.
2. Merge the clinical data with the normalized gene data on sample IDs.
3. Handle missing values. Drop records with the clinical trait missing or with
more than 20% of the gene features missing. Use mean imputation for other
missing values in the gene expression data.
4. Observe the resulting dataset for quality verification. If the dataset is
successfully preprocessed, save the merged data to a CSV file.
PART II. TCGA-Xena Data Preprocessing
Step 1: Initial Data Loading
1. Identify the names of the clinical data file and the genetic data file, and
load them into two separate dataframes. For gene expression, we choose the ‘gene
expression RNAseq’ dataset instead of its PANCAN normalized or percentile
versions.
Step 2: Clinical Attribute Selection
1. Print and observe the column names of the clinical data file. Identify all
columns that might hold relevant data for age and gender from the list of column
names.
2. Inspect the first few values of all candidate columns. Select a single column
16from the candidate columns that accurately records age and gender information,
respectively, considering meaningful values and minimal missing data.
3. Based on metadata of the TCGA database, use a simple rule to convert the
trait (whether the sample has the particular type of cancer) to binary values.
4. Conduct initial filtering. If all samples have the same target values, or if
the clinical dataset shows other abnormalities, discard the dataset. Otherwise,
continue with the next step.
Step 3: Data Processing and Merging
1. Normalize the gene symbols in the gene data by querying databases with the
Python MyGene library, setting the ‘scopes’ parameter properly. Remove data
corresponding to genes that cannot be normalized. For genes that normalize to
the same symbol, deduplicate by averaging their expression values.
2. Merge the clinical and genetic datasets on sample IDs.
3. Handle missing values. Drop records with the clinical trait missing or with
more than 20% of the gene features missing. Use mean imputation for other
missing values in the gene expression data.
4. Observe the resulting dataset for quality verification. If the dataset is
successfully preprocessed, save the merged data to a CSV file.
PART III. Statistical Analysis
Step 1: Data Selection and Loading
1. Select the best input data relevant to the gene identification problem, and
load the data into a dataframe. If multiple preprocessed datasets are available
for statistical analysis about a trait, we select the one with the largest
sample size.
2. If the analysis requires integrating datasets about two traits, we sort the
possible pairs of datasets for both traits by the product of their sample sizes,
and select the pair with the largest product. Load data for the trait and
condition into separate dataframes and select common gene regressors.
Step 2: Data Wrangling
1. Extract the relevant data columns and convert into numpy arrays for analysis.
Get the data matrices of features, the target variable, and also the condition
when applicable.
2. For two-step regression, this needs to be done twice. In the first step, the
features are the common gene regressors, and the target is the condition, and we
need to extract these matrices from the condition dataset. The second step
follows other cases for extracting relevant data.
Step 3: Condition Prediction (Only for Two-Step Regression)
1. Determine the variable type (binary, continuous, or categorical) of the
condition.
2. Select a simple regression model based on the type of the target variable,
and train it to regress the condition on the common gene regressors in the
condition dataset.
3. Use the trained model to predict the condition values in the trait dataset
using the common gene regressors. Remove the columns in the trait dataset
corresponding to the common regressors, and add the predicted condition values
to it as a new column.
Step 4: Model Selection Based on Batch Effect
1. Assess whether the dataset shows batch effects by observing gaps in
eigenvalues. Choose the appropriate model based on the presence of batch effects.
Use a Linear Mixed Model (LMM) if batch effects are detected. Otherwise, use a
Lasso model.
Step 5: Data Normalization
1. For the feature matrix, and the condition matrix (if applicable), apply Z-
score normalization so that each feature has a mean of 0 and standard deviation
of 1. Make sure this is done every time before training the model.
17Step 6: Hyperparameter Tuning
1. Do 5-fold cross-validation, and perform hyperparameter search on the
logarithm scale with base of 10. Record the best hyperparameter settings.
Step 7: Model Training
1. Train the model on the entire dataset, with the best hyperparameters found
during cross-validation. For conditional analyses, incorporate the condition
matrix into the model.
Step 8: Model Interpretation
1. Interpret the trained model to identify significant factors and effects. For
Lasso, choose gene variables with non-zero coefficients. For LMM, apply the
Benjamini-Hochberg correction for multiple hypothesis testing, and select
variables whose corrected p-value is less than 0.05.
2. Save the regression output to a JSON file, with the identified genes and the
corresponding coefficient or p-values.
Listing1: Guidelinesfileforgeneexpressiondataanalysis
C Examples of manual analysis
Inadditiontotheguidelinesfile,weprovideexamplefilestotheparticipantsofourbenchmarkcuration.
Theseexamplesincludecodeandresultsforanalyzinggeneidentificationproblemsrelatedtotraitssuch
asBreastCancerandEpilepsy. Theseillustrationshaveprovenhelpfulinfamiliarizingparticipantswith
thesetasksquickly. Amongthemanystepsintheanalysispipeline,akeystepisthetraitdataextraction
duringthepreprocessingofGEOdata. Thissteprequiresbiomedicalknowledgeandanunderstanding
ofthedatasetcollectionprocessdescribedinthemetadata. Inthissection,wewillintroducethepartof
themanualanalysisexamplesrelatedtothiscrucialstep.
C.1 Problemstatement
OurgoalwastoextractclinicaltraitsfromGEOdatasets.Foreachtraitofinterest,weaimedtodetermine
itsavailabilityanddevelopencodingrulestoautomatetheextractionprocess. Belowaretwoexamples
focusingonBreastCancerandEpilepsy,respectively.
C.2 BreastCancerexample
C.2.1 Inputdata
!Series_title "Unlocking Molecular mechanisms and identifying druggable
targets in matched-paired brain metastasis of Breast and Lung cancers"
!Series_summary "Introduction: The incidence of brain metastases in cancer
patients is increasing, with lung and breast cancer being the most common
sources. Despite advancements in targeted therapies, the prognosis remains poor,
highlighting the importance to investigate the underlying mechanisms in brain
metastases. The aim of this study was to investigate the differences in the
molecular mechanisms involved in brain metastasis of breast and lung cancers. In
addition, we aimed to identify cancer lineage-specific druggable targets in the
brain metastasis. Methods: To that aim, a cohort of 44 FFPE tissue samples,
including 22 breast cancer and 22 lung adenocarcinoma (LUAD) and their matched-
paired brain metastases were collected. Targeted gene expression profiles of
primary tumors were compared to their matched-paired brain metastases samples
using nCounter PanCancer IO 360 Panel of NanoString technologies. Pathway
analysis was performed using gene set analysis (GSA) and gene set enrichment
analysis (GSEA). The validation was performed by using Immunohistochemistry (IHC
) to confirm the expression of immune checkpoint inhibitors. Results: Our
results revealed the significant upregulation of cancer-related genes in primary
tumors compared to their matched-paired brain metastases (adj. p<=0.05). We
found that upregulated differentially expressed genes in breast cancer brain
18metastasis (BM-BC) and brain metastasis from lung adenocarcinoma (BM-LUAD) were
associated with the metabolic stress pathway, particularly related to the
glycolysis. Additionally, we found that the upregulated genes in BM-BC and BM-
LUAD played roles in immune response regulation, tumor growth, and proliferation.
Importantly, we identified high expression of the immune checkpoint VTCN1 in BM-
BC, and VISTA, IDO1, NT5E, and HDAC3 in BM-LUAD. Validation using
immunohistochemistry further supported these findings. Conclusion: In conclusion,
the findings highlight the significance of using matched-paired samples to
identify cancer lineage-specific therapies that may improve brain metastasis
patients outcomes."
!Series_overall_design "RNA was extracted from FFPE samples of (primary LUAD
and their matched paired brain metastasis n=22, primary BC and their matched
paired brain metastasis n=22)"
Listing2: Backgroundinformationforbreastcancer
{
0: [’age at diagnosis: 49’, ’age at diagnosis: 44’, ’age at diagnosis: 41’, ’
age at diagnosis: 40’, ...],
1: [’Sex: female’, ’Sex: male’],
2: [’histology: TNBC’, ’histology: ER+ PR+ HER2-’, ’histology: Unknown’, ’
histology: ER- PR- HER2+’, ’histology: ER+ PR-HER2+’, ’histology: ER+ PR- HER2-’,
’histology: ER- PR+ HER2-’, ’histology: adenocarcinoma’],
3: [’smoking status: n.a’, ’smoking status: former-smoker’, ’smoking status:
smoker’, ’smoking status: Never smoking’, ’smoking status: unknown’, ’smoking
status: former-roker’],
4: [’treatment after surgery of bm: surgery + chemotherpy’, ’treatment after
surgery of bm: surgery + chemotherpy + Radiotherapy’, ’treatment after surgery
of bm: surgery + chemotherapy + Radiotherapy’, ’treatment after surgery of bm:
surgery’, ’treatment after surgery of bm: surgery + chemotherapy + Radiotherapy’,
...]
}
Listing3: Samplecharacteristicsforbreastcancer. Somelonglistsaretruncatedforbrevity.
C.2.2 Inferenceprocess
Thedatasetsummaryindicatedthattissuesamplesfromprimarybreastcancer(BC)andlungadenocar-
cinoma(LUAD),alongwiththeirmatched-pairedbrainmetastases,wereincluded. Byexaminingthe
samplecharacteristicsdictionary,combinedwithdomainknowledge,weidentifiedsubtypessuchas
’TNBC’,’ER+’,’PR+’,and’HER2+’associatedwithbreastcancer,and’adenocarcinoma’associatedwith
lungcancer. Basedonthis,wedevelopedarule: tissueslabeledwith’TNBC’,’ER+’,’PR+’,or’HER2+’
arecodedashavingbreastcancer(1),while’adenocarcinoma’iscodedasnothavingbreastcancer(0).
def convert_trait(value):
if ’TNBC’ in value or ’ER+’ in value or ’PR+’ in value or ’HER2+’ in value:
return 1 # Breast Cancer
elif ’adenocarcinoma’ in value:
return 0 # Not Breast Cancer (LUAD)
else:
return None # Unknown
Listing4: PythonfunctiontoencodeBreastCancertrait
C.3 Epilepsyexample
C.3.1 Inputdata
!Series_title "Integrated analysis of expression profile and potential
pathogenic mechanism of temporal lobe epilepsy with hippocampal sclerosis"
19!Series_summary "To investigate the potential pathogenic mechanism of temporal
lobe epilepsy with hippocampal sclerosis (TLE+HS), we have employed analyzing of
the expression profiles of microRNA/ mRNA/ lncRNA/ DNA methylation in brain
tissues of hippocampal sclerosis (TLE+HS) patients. Brain tissues of six
patients with TLE+HS and nine of normal temporal or parietal cortices (NTP) of
patients undergoing internal decompression for traumatic brain injury (TBI) were
collected. The total RNA was dephosphorylated, labeled, and hybridized to the
Agilent Human miRNA Microarray, Release 19.0, 8x60K. The cDNA was labeled and
hybridized to the Agilent LncRNA+mRNA Human Gene Expression Microarray V3.0, 4
x180K. For methylation detection, the DNA was labeled and hybridized to the
Illumina 450K Infinium Methylation BeadChip. The raw data was extracted from
hybridized images using Agilent Feature Extraction, and quantile normalization
was performed using the Agilent GeneSpring. We found that the disorder of FGFR3,
hsa-miR-486-5p, and lnc-KCNH5-1 plays a key vital role in developing TLE+HS."
!Series_overall_design "Brain tissues of six patients with TLE+HS and nine of
normal temporal or parietal cortices (NTP) of patients undergoing internal
decompression for traumatic brain injury (TBI) were collected."
Listing5: BackgroundinformationforEpilepsy
{
0: [’tissue: Hippocampus’, ’tissue: Temporal lobe’, ’tissue: Parietal lobe’],
1: [’gender: Female’, ’gender: Male’],
2: [’age: 23y’, ’age: 29y’, ’age: 37y’, ’age: 26y’, ’age: 16y’, ’age: 13y’, ’
age: 62y’, ’age: 58y’, ’age: 63y’, ’age: 68y’, ’age: 77y’, ’age: 59y’, ’age: 50y
’, ’age: 39y’]
}
Listing6: SamplecharacteristicsforEpilepsy
C.3.2 Inferenceprocess
The dataset summary indicated that brain tissues from patients with temporal lobe epilepsy with
hippocampalsclerosis(TLE+HS)andcontrolsampleswereincluded. Byexaminingthesamplecharac-
teristicsdictionary,weidentifiedtissuetypessuchas’Hippocampus’,’Temporallobe’,and’Parietallobe’.
Weinferredthat’Hippocampus’and’Temporallobe’tissuesareassociatedwithTLE+HS(epilepsy),
while’Parietallobe’tissuesarefromcontrolsamples. Basedonthis,wedevelopedarule: tissueslabeled
with’Hippocampus’or’Temporallobe’arecodedashavingepilepsy(1),while’Parietallobe’iscodedas
control(0).
def convert_trait(value):
if ’Hippocampus’ in value or ’Temporal lobe’ in value:
return 1 # Epilepsy (TLE+HS)
elif ’Parietal lobe’ in value:
return 0 # Control (NTP)
else:
return None # Unknown
Listing7: PythonfunctiontoencodeEpilepsytrait
C.4 Validationandconclusion
ByexecutingtheprovidedPythonfunctions,weconfirmedtheaccuracyofourtraitextractionprocess.
Forinstance,applyingtheconvert_traitfunctionfortheepilepsydataset,weverifiedthepresence
ofexactlysixsampleswiththepositiveEpilepsytrait,consistentwiththemetadatadescription. Similarly,
forthebreastcancerdataset,thefunctionaccuratelyidentified22sampleswiththeBreastCancertrait.
Theseexampleshighlightthedatasetcontextunderstandinganddomainknowledgeinferencerequired
fortheaccuratepreprocessingofgeneexpressiondata.
20D Criteria for manual correction of trait-condition pairs
Toensurethescientificvalidityofourbenchmarkquestions,weapplyspecificrulesforincludingand
excludingcertaintrait-conditionpairs. Eachbiomedicalentityinourlistcanbeconsideredatraitand
paired with a condition, where the condition is either another entity from the list or a demographic
attributelike"age"or"gender."Thefollowingcriteriaaredesignedtomaintainscientificrelevanceand
robustness:
• Trait-ConditionRoleAssignment: Entitiessuchaslanguageabilities,VitaminDlevels,andbone
densityareincludedonlyasconditionsandnotastraits. Thisdistinctionensuresthattheprimary
focusremainsontraitswithmoredirectclinicalimplications,whiletheseentitiesserveasinfluential
factorsthatcouldaffectthosetraits.
• Universal Conditions: Entities such as obesity, hypertension, and mental disorders like anxiety
disorderandbipolardisorderaredesignatedasconditionstobepairedwithallothertraits. Thisis
becausetheseconditionsarewidespreadandsignificantlyimpactvarioushealthoutcomes,making
themcriticalfactorstoconsiderinanygeneticanalysis.
• Gender-Specific Considerations: Gender-specific entities such as prostate cancer, endometriosis,
andbreastcancerarenotconditionedongender. Furthermore,entitiesfromdifferentgendersare
notpaired. Thisapproachrespectsthebiologicaldistinctionsbetweengendersandensuresthatthe
resultingquestionsremainrelevantandmeaningful.
• CancerCategoryExclusion: Pairswhereboththetraitandtheconditionbelongtothecancercategory
areexcluded. Thisisbecauseinvestigatinggeneticfactorsbehindonetypeofcancerconditioned
onanothertypeofcancerisoftenlessscientificallyimportant. Thefocusisplacedonbroader,more
impactfulgeneticrelationshipsthatoffergreaterinsightintocancerbiology.
ThesecriteriaareusedincombinationwiththeJaccardsimilarityofrelatedgenes(Section3.2),to
upholdthescientificintegrityandrelevanceofthebenchmarkquestions,facilitatingmeaningfuland
insightfulgeneexpressionanalysis.
E Details about the data sources
GEO TheGeneExpressionOmnibus(GEO)[11]isapublicarchiveforhigh-throughputgeneexpression
dataandvariousothertypesofgenomicdata. WeleveragedtheEntrezprogrammingutilitytoperforma
systematicsearchoftheGEOdatabaseforhumanseriesdatarelevanttoeachtraitonourlist,prioritizing
datasetswithlargesamplesizes. WedownloadedbothSOFTandmatrixfilesforeachseriesandused
heuristic evaluationsof file sizesto pinpoint datasetslikely containinggene expression data. When
automated searches failed to yield results for specific traits, we conducted manual searches using
expandedsynonymsfromMedicalSubjectHeadings(MeSH)terms.
TCGA-Xena TheCancerGenomeAtlas(TCGA)[54],accessedthroughtheXenaplatform[19],offersa
richrepositoryofRNAseqgeneexpressionandclinicaldatafornumerouscancertypes. Weobtained
datafor36traitsfromtheTCGAcohortusingtheUCSCXenaplatform,whichprovideshigh-quality,
cancer-relatedgeneexpressionandclinicaldatalinkedbypatientIDs.
NCBIGene TheNCBIGenedatabase[7]isanimportantresourceforcomprehensiveinformationon
genesequences, functions, andtheirlinkstodiseasesandconditions. Foreachtrait, wequeriedthe
databasetocompilesetsofgenesymbolsassociatedwiththetrait. Thisdatawascrucialforidentifying
disease-diseaseassociationsforquestiongenerationandforselectingcommonregressorsintwo-step
regressionanalyses.
F Challenges faced by existing methods on our benchmark
Geneexpressiondataanalysisisacomplexandspecializedtask. Despitetheirproblem-solvingabilities,
state-of-the-artLLMsandagent-basedmethodsstrugglewithgeneexpressiondata. Ourevaluations
ofmethodssuchasGPT-4o[39],MetaGPT[24],andCodeAct[61]revealedconsistentfailuresacross
varioussettings.
Wetestedthesemethodsunderthreedifferentsettings: (i)providinggeneraltaskinstructions,(ii)
providingdetailedtaskinstructionsusedbyGenoAgent,and(iii)providingdetailedtaskinstructions
21andallnecessarylibraryfunctionsasinGenoAgent. Eachsettingwastestedonasubsetof50gene
identification problems. Our results show that none of the methods generated runnable code for
preprocessingdatasetsdownloadedfromGEO.Persistenterrorsinthegeneratedcodepreventedtestable
outputs,regardlessofthelevelofdetailprovided.
First,wefindthatwhenpreprocessingGEOdata,thesemethodsoftenfailatdatasetloadinginthe
initialsteps. Thegeneexpressiondatafilesfollowspecialformats. Theagentstrugglestoextracttabular
dataembeddedinthetextfilebyidentifyingspecialmarkers,skippingmetadatarows,andsettingother
parameterscorrectly,resultingindatareadingfailures.
import pandas as pd
from typing import Tuple
from utils import Utils
class DataLoader:
"""
DataLoader class is responsible for loading clinical and genetic data from
given file paths.
"""
def load_clinical_data(self, filepath: str) -> pd.DataFrame:
"""
Loads clinical data from a specified file path.
:param filepath: The path to the clinical data file.
:return: A pandas DataFrame containing the clinical data.
"""
try:
clinical_data = pd.read_csv(filepath)
Utils.log(f"Clinical data loaded successfully from {filepath}")
return clinical_data
except FileNotFoundError:
Utils.log(f"File not found: {filepath}")
raise
except pd.errors.EmptyDataError:
Utils.log(f"No data: {filepath} is empty")
raise
except Exception as e:
Utils.log(f"An error occurred while loading clinical data: {e}")
raise
Listing8: FailureexampleofMetaGPTinreadingdatasets
Wemanuallycorrectedthedataloadingcodeforthebaselinemethodsandcontinuedwiththetasks.
However,theywerestillunabletoconducttheinferencerequiredtoextractclinicalfeatures. Thisstepis
inherentlydifficultandoftenrequiresatleastoneroundofdebuggingbytheDomainExpertagentin
ourGenoAgentmethodtoachieveahighersuccessrate.
def convert_trait(self, value: str) -> str:
"""
Converts a trait value to a standardized string format.
:param value: The trait value to convert.
:return: A standardized string representation of the trait.
"""
# This is a placeholder for the actual conversion logic, which would
# depend on the specific requirements for trait conversion.
# For example, it could map various synonyms to a canonical form.
standardized_value = value.strip().lower()
return standardized_value
Listing9: FailureexampleofMetaGPTinencodingBreastCancertrait
def convert_trait(value):
22if value in [’TLE+HS’, ’control’]:
return 1 if value == ’TLE+HS’ else 0
return None
Listing10: FailureexampleofCodeActinencodingBreastCancertrait. ’TLE+HS’isindeedrelated
toepilepsyaccordingtothemetadata,butthisisnotthewaythetraitinformationisrecordedfor
eachsample. Moreover,thesefunctionsdidn’tstripthecontentbeforethecolon. Asaresult,the
codewillconvertalltraitvaluestoNone.
ThechallengesfacedbymethodslikeMetaGPTandCodeActinprocessinggeneexpressiondata
primarilystemfromtheirdifficultyinhandlingspecializeddataformatsandtheabsenceofflexible
feedbackmechanisms. MetaGPT,primarilydesignedforsoftwareengineeringtasks,operateswithan
independentexecutionmodelandlimitedcontext-awareness,whichcanimpededynamicadaptation
duringtaskexecutionandleadtoerrorswhendealingwiththenuancedformatsofgeneexpression
datasets. CodeAct, while effective at generating executable code through structured prompts, lacks
thecontext-awareplanninganditerativerefinementnecessaryfortheintricatestepsinvolvedingene
expressiondatapreprocessing.Itsstaticapproachdoesnoteasilyaccommodatethedynamicadjustments
requiredfordiverseandcomplexgeneexpressiondata,leadingtoerrorsduringinitialdataloadingand
clinicalfeatureextraction.
Incontrast,GenoAgentemploysateamofspecializedagentsthatmaintainacomprehensivetask
contextandleverageexpertconsultation,allowingforcontext-awareplanninganditerativecorrection.
ThisenablesGenoAgenttohandlethecomplexitiesofgenomicsdataanalysismoreeffectively,improving
itsreliabilityindatapreprocessing.
G Discussion on the limitations of GenoAgent
[Prompt]: obtain the information of clinical data and get the lists of column names [Prompt]: obtain the information of clinical data and get the lists of column names
[ Code ] : c # _# l , i G R n ce e li ica t na d itl ch_ at d eh l_ ae li ct sac otl s li = un o mpic fd a nc.l sor d e l =ua a m ct da h_ n ec cs nv ka( _mc rl oi en wsic sa _l a_ nfi dle __ cp oa luth m, ns se (p c= li" n\ ict" a) l_data, display=True) Step 1: Code Review [ Code ] : c # _# l , i G R n ce e li ica t na d itl ch_ at d eh l_ ae li ct sac otl s li = un o mpic fd a nc.l sor d e l =ua a m ct da h_ n ec cs nv ka( _mc rl oi en wsic sa _l a_ nfi dle __ cp oa luth m, ns se (p c= li" n\ ict" a) l_data, display=True) Step 1: Consulting
DataEngineer [Output]: SC to ad ne d aR re ds Oul ut t: DataEngineer [Output]: SC to ad ne d aR re ds Oul ut t:
The dataset has 92 rows, such as … The dataset has 92 rows, such as …
T Sth ae n d da at ra ds Ee rt r oh ra :s 105 columns, such as … Step 1: Send T ‘ah ge e _d aa tt _a is ne it t ih ala _s p 1 a0 th5 o c lo ol gu im c_n ds ia, gsu nc oh s ia s’s , …[‘s ]ampleID’,
StandardError:
[Prompt]:
Verify execution through STDERR check. If not, provide a feedback for revision.
Return "Final Decision: approved" else return "Final Decision: need revision". CodeReviewer [ inP fr oo rm mp at t] i: o F no .cus on pinpointing every column that could possibly contain age DomainExpert
[Output]:
Review: Final Decision: approved. [Output]: candidate_age_cols = [age_at_initial_pathologic_diagnosis,
day_to_birth, age_at_last_review]
Step 2: Feedback [Prompt]: Inspect all candidate columns to
[ [P Cr oo dm e]p :…t]:… appenI df " rF ei vn ia el w D te oc i psi ro on m: pn te ae nd d r e rev dis oio tn h" i. s step. a [Cv oo did e ]m : …issing values Step 2: Decision
[Output] If “Final Decision: approved”, [Output]: …
DataEngineer Move to the next step. DataEngineer
Figure3:ThecollaborationbetweenDataEngineerFigure4:ThecollaborationbetweenDataEngineer
andCodeReviewer. andDomainExpert.
Thissectiondiscussestheobservedlimitationsofourbaselinemethod,GenoAgent,ontheGenoTEX
benchmark. Weidentifiedthatcertainstepsareinherentlychallenging,andinstabilityinthefeedback
mechanismmayhindertheagents’iterativeimprovementprocess. Figures3and4illustratethetwo
typesoffeedbackmechanismsinGenoAgent.
G.1 Errorexampleinpreprocessing
The results in Table 4 of the main paper indicate that the preprocessing performance of GenoAgent
is primarily constrained by the clinical feature extraction step, which shows a CSC of only 32.28%.
ThisstepisconductedthroughDomain-GuidedProgramming(Section4.2),wheretheDomainExpert
iterativelyimprovesitsoutputbasedonfeedbackfromtheexecutionenvironment. Althoughoneround
ofself-reviewsignificantlyenhancesperformance,increasingthemaximumreviewroundsfrom1to2
yieldsonlymarginalbenefits. Detailedexaminationoftheagentsystem’soperationlogatthisstepacross
differentexperimentalrunsrevealsthattheDomainExpert’sanswerstothesamequestioncanvary
23randomly. Duringmultipleroundsofself-review,itoftenprovidesfeedbackthatcontradictsprevious
suggestions,makingitdifficulttoachieveconsistenttaskperformance.
Forexample,considerthefollowingfunctionusedtoencodetheBreastCancertrait:
def convert_trait(value):
if ’breast cancer’ in value.lower():
return 1
elif ’lung adenocarcinoma’ in value.lower():
return 0
else:
return None
Listing11: FailureexampleofGenoAgentforencodingBreastCancertrait
Inonerun,thecodereviewprovidedthefollowingfeedback:
*Issue*: The convert_trait function assumes that the input string will always
mention either "breast cancer" or "lung adenocarcinoma," which might not always
be the case. The current data may not explicitly have such a field.
*Suggestion*: Update the function to be more flexible by incorporating
biomedical knowledge. Since the dataset deals explicitly with breast cancer and
lung adenocarcinoma, we can assume breast cancer is present based on the context
or use a default binary value.
*Final Decision*: Approved
Listing12: Codereviewthatdidn’tcorrectlyfindtheissue,andapprovedthecode
However,inanotherrunwiththeidenticalsetting,thecodereviewprovideddifferentfeedback:
*Issue*: The convert_trait function does not conform to the instructions. The
traits should be inferred from the histology field.
*Suggestion*: Adjust the function to check for breast cancer subtypes in the
histology field. The current implementation checks for "breast cancer" and "lung
adenocarcinoma" in the value, which might not directly map to the provided
sample characteristics. A more context-aware approach, utilizing the provided
histology information to infer the presence of breast cancer, would be more
effective.
*Final Decision*: Rejected
Listing13: Anotherrunofcodereview,whichcorrectlyanalyzedtheissueandrejectedthecode
G.2 Errorexampleinstatisticalanalysis
Analysisoffailurecasesduringthestatisticalanalysistaskrevealsvariouslow-frequencyrandomfailures,
includingerrorsinextractingdatamatricesfromdataframesandincorrectparameterpassingtothe
regressionmodel. Althoughnosinglebottleneckwasidentified,thecumulativeerrorrisksignificantly
impactsperformance, resultinginasuboptimalF scoreof67.08%. Thistaskinvolvescollaboration
1
betweentheStatisticianandCodeReviewer(Section4.2). Similartopreprocessing,weobservedunstable
andinconsistentfeedbackfromtheCodeReviewer.
ThefollowingisanexampleoferroneouscodegeneratedbytheStatisticianagent:
from utils.statistics import *
# Set directory and trait, omitted here.
# Step 1: Load input data about the trait into a dataframe
trait_data, _, _ = select_and_load_cohort(data_root, trait, condition=None,
is_two_step=False)
# Step 2: Extract X and Y for regression analysis
24Y = trait_data[trait].values
X = trait_data.drop(columns=[trait]).values
# Step 3: Selecting appropriate model based on batch effect
batch_effect_detected = detect_batch_effect(X)
model_constructor = LMM if batch_effect_detected else Lasso
# Step 4: Hyperparameter search
param_values = [10 ** i for i in range(-6, 1)] # powers of 10 from 1e-6 to 1e0
var_names = list(trait_data.columns)
if batch_effect_detected:
fixed_params = {"fit_intercept": False}
else:
fixed_params = {"fit_intercept": True, "max_iter": 10000}
best_config, _ = tune_hyperparameters(
model_constructor, param_values=param_values, X=X, Y=Y, var_names=var_names,
trait=trait, gene_info_path=gene_info_path, condition=None, Z=None,
fixed_params=fixed_params
)
# Step 5: Normalize X
X_normalized, _ = normalize_data(X)
# Step 6: Train the model with best hyperparameter on whole dataset
model = ResidualizationRegressor(model_constructor, best_config)
model.fit(X_normalized, Y)
# Step 7: Interpret trained model for significant genes and save results
significant_genes = interpret_result(model, var_names, trait, condition=None,
print_output=True)
os.makedirs(os.path.join(output_dir, normalize_trait(trait)), exist_ok=True)
save_path = os.path.join(output_dir, normalize_trait(trait))
save_result(
significant_genes, output_dir=save_path, condition=None
)
[Output]:
[Execution Error]:
__init__() got an unexpected keyword argument ’fit_intercept’
Listing14: FailureexampleoftheStatisticianagent
Discussion TherandomnessobservedmaystemfromtheLLMitself,suggestinganeedtoprevent
oneagentfrommisleadinganother. Duringthedevelopmentofourbaselinemethods,weimplemented
several prompt engineering techniques to mitigate this issue: (i) Limiting the Reviewer’s feedback
to three main suggestions to focus on problem-solving rather than providing numerous distracting
commentsaboutcodequality,and(ii)Encouragingtheagentreceivingthereviewtocriticallyevaluate
thefeedbackandpossiblyretainitsoriginalcode. Whilethesemeasureshavealleviatedsomeissues,
theypersisttosomeextentinourGenoAgentbaseline. Apromisingfuturedirectioninvolvesdesigning
collaborativemodesthatfosteriterativediscussionsamongagentstoreconciledifferingopinionsand
enhancetheirtaskperformanceabilities.
Wehopethisdiscussionhighlightsthechallengesofourbenchmarktasksandencouragesfuture
worktoaddresstheseissues.
25
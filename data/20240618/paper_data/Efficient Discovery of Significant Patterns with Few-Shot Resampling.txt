Efficient Discovery of Significant Patterns
with Few-Shot Resampling
LeonardoPellegrina FabioVandin
Dept.ofInformationEngineering,UniversityofPadova Dept.ofInformationEngineering,UniversityofPadova
Padova,Italy Padova,Italy
leonardo.pellegrina@unipd.it fabio.vandin@unipd.it
ABSTRACT 1 INTRODUCTION
Significantpatternminingisafundamentaltaskinminingtransac- Patternminingisafundamentaltaskindataminingthat,initsmost
tionaldata,requiringtoidentifypatternssignificantlyassociated commondefinition[17],requirestofindpatternsthatoccurmore
withthevalueofagivenfeature,thetarget.Inseveralapplications, oftenthanagivenfrequencythresholdinadatabaseoftransactions.
suchasbiomedicine,basketmarketanalysis,andsocialnetworks, Patternminingfindsapplicationsinseveralareassuchasmarket
thegoalistodiscoverpatternswhoseassociationwiththetarget basketanalysis[2],graphdatabases[1,3,11],andtheanalysisof
isdefinedwithrespecttoanunderlyingpopulation,orprocess, spatialandtemporaldata[9,10,18].
ofwhichthedatasetrepresentsonlyacollectionofobservations, Significant pattern mining [16, 31] is an extension of pattern
orsamples.Anaturalwaytocapturetheassociationofapattern miningthat,initsmostgeneralformulation,requirestodiscover
withthetargetistoconsideritsstatisticalsignificance,assessing patternswithasignificantassociationwithabinarylabelfroma
itsdeviationfromthe(null)hypothesisofindependencebetween datasetconsistingofacollectionofelements,whereeachelement
thepattern andthetarget. While severalalgorithms havebeen comprisesthevaluesoffeatures,whichmaybecategorical,binary,
proposedtofindstatisticallysignificantpatterns,itremainsacom- orcontinuous,andthevalueofthebinarylabelofinterests,also
putationally demanding task, and for complex patterns such as calledthetarget.Suchformulationcapturesvarioustypesofpat-
subgroups,noefficientsolutionexists. terns,suchasitemsets,whenallfeaturesarebinary,orsubgroups[4],
WepresentFSR,anefficientalgorithmtoidentifystatistically withmoregeneralfeatures.Thistaskfindsapplicationsinawide
significantpatternswithrigorousguaranteesontheprobability rangeofdomains,suchasmarketbasketanalysis,medicine,and
offalsediscoveries.FSRbuildsonanovelgeneralframeworkfor molecularbiology,wherefindingreliableassociationsisparamount.
miningsignificantpatternsthatcapturessomeofthemostcom- Significanceisusuallyassessedusingthestatisticalhypothesis
monlyconsideredpatterns,includingitemsets,sequentialpatterns, testingframework.Insuchframeworkonedefinesameasureof
andsubgroups.FSRusesasmallnumberofresampleddatasets, qualityforpatterns,andassumesthenullhypothesisofnoassocia-
obtainedbyassigningi.i.d.labelstoeachtransaction,torigorously tionbetweenapatternandthetargetlabel.Thesignificantpatterns
boundthesupremumdeviationofaqualitystatisticmeasuringthe arethentheoneswithqualitythatsignificantlydeviatefromthe
significanceofpatterns.FSRbuildsonnoveltightboundsonthe nulldistribution,thatis,thedistributionofthequalityunderthe
supremumdeviationthatrequiretomineasmallnumberofresam- nullhypothesis.Thedeviationfromthenulldistributionisusually
pleddatasets,whileprovidingahigheffectivenessindiscovering measuredbyaùëù-value,thatistheprobability,underthenulldistri-
significantpatterns.Asatestcase,weconsidersignificantsubgroup bution,thatthepatternhasqualityaslargeastheoneobservedin
mining,andourevaluationonseveralrealdatasetsshowsthatFSR thedataset.
iseffectiveindiscoveringsignificantsubgroups,whilerequiringa Amajorcomplicationintheuseofthestatisticalhypothesis
smallnumberofresampleddatasets. testingframeworkindataminingisgivenbythehugenumber
ofcandidatepatternsthatareconsidered,resultinginamultiple
hypothesistestingproblem.Withahugenumberofcandidatepat-
PVLDBReferenceFormat:
terns,somenon-significantpatternsdisplayasubstantialdeviation
LeonardoPellegrinaandFabioVandin.EfficientDiscoveryofSignificant
fromthenulldistributionjustbychance.Therefore,itiscriticalto
PatternswithFew-ShotResampling.PVLDB,17(10):XXX-XXX,2024.
accountfortestingmultiplehypotheseswhenminingsignificant
doi:XX.XX/XXX.XX
patterns,inordertoavoidreportingalargenumberofspuriousdis-
PVLDBArtifactAvailability: coveries.Severalmethodshavebeenproposedtodealwithmultiple
hypothesistesting[6,7,46].Whilethesemethodsprovidevarious
Thesourcecode,data,and/orotherartifactshavebeenmadeavailableat
guarantees,theonemostcommonlyconsideredistheFamily-Wise
https://github.com/VandinLab/FSR
ErrorRate(FWER),whichistheprobabilityofreportinginoutput
oneormorefalsediscoveries.
Currentapproachesforsignificantpatternminingwithguar-
ThisworkislicensedundertheCreativeCommonsBY-NC-ND4.0International
License.Visithttps://creativecommons.org/licenses/by-nc-nd/4.0/toviewacopyof anteesontheFWERbelongtooneoftwoclasses.Thefirstclass
thislicense.Foranyusebeyondthosecoveredbythislicense,obtainpermissionby isgivenbyapproachesthatassessthesignificanceofeachsingle
emailinginfo@vldb.org.Copyrightisheldbytheowner/author(s).Publicationrights
licensedtotheVLDBEndowment. pattern (e.g., through aùëù-value or related quantities), and then
ProceedingsoftheVLDBEndowment,Vol.17,No.10ISSN2150-8097. performananalyticalcorrectiontoaccountformultiplehypothe-
doi:XX.XX/XXX.XX
sistesting[43‚Äì45].Awidelyusedprocedureinthisclassisgiven
4202
nuJ
71
]GL.sc[
1v30811.6042:viXrabyBonferronicorrection[6],whichcomputesacorrectedùëù-value ofthepatterninanelementofthedatasetiswelldefined.Such
bymultiplyingtheùëù-valueùëù P ofapatternPbythenumber‚Ñéof patternsincludewidelyusedpatternssuchasitemsets,subgroups,
candidatehypotheses.Ifpatternswithcorrectedùëù-value‚Ñé√óùëù P sequentialpatterns,andsubgraphs.Second,weproposeFSR,an
belowathresholdùõº areflaggedassignificant,theFWERofthe algorithmfortheefficientdiscoveryofarigorousapproximation
outputisguaranteedtobe‚â§ùõº.Whiletheseapproachesandtheir ofsignificantpatternswhilecontrollingtheFamily-WiseErrorRate,
improvedversions[29,40]arefairlyefficient,thankstotheuse whichistheprobabilityofreportingevenasinglefalsediscovery.
ofanalyticalderivations,theysufferfromalowstatisticalpower, FSRusesafew-shotresamplingapproach,thatis,itminesasmall
thatistheyoftenfailinidentifyingsignificantpatterns,duetothe numberofresampled datasets,obtainedbykeepingthefeatures
multiplehypothesiscorrectionsthatmustprovideguaranteesfor ofeachelementofthedatasetfixedandassigningi.i.d.valuesto
everysituation,independentlyoftheobserveddata. thetarget.Moreover,FSRcanleverageanyexistingalgorithmfor
Thesecondclassisgivenbyapproachesthatusethedatasetto miningthepatternsofinterest.Third,weprovidenoveltighttheo-
estimatetheoveralldistributionofthepatterns‚Äôstatistics(orcorre- reticalresultsrelatingthedistributionofpatterns‚Äôqualitiesunder
spondingmeasures,suchastheùëù-values)underthenullhypothe- theconditionalandtheunconditionaldistributions,andrelatingthe
sis[25,33,39].Thedistributionisestimatedusingpermutedver- estimatedmaximumdeviationofpatterns‚Äôqualitiesinresampled
sionsofthedata,obtainedbykeepingthefeaturesineachelement datasetswiththeir(unknown)truequalityinthecorresponding
ofthedatasetfixedandrandomlypermutingthetargetlabelsamong distribution.Theseresultsarecrucialinmakingourapproachprac-
elements.Forexample,theWestfall-Young(WY)method[46]uses tical,sincetheyimplythatminingasmallnumberofresampled
permuteddatasetstoestimatethequantilesofthesmallestùëù-value datasetsisenoughtoidentifysignificantpatterns.Fourth,wecon-
underthenullhypotheses(or,equivalently,largestqualitiesortest sidersignificantsubgroupsminingasatestcaseinourextensive
statistics),andusessuchestimatetoderiveacorrectedthreshold empiricalevaluation.WeuseouralgorithmFSRtoderivethefirst
toflagpatternsassignificant.Theseapproachesusuallyimprove approachforminingsignificantsubgroupswithunconditionaltest-
thestatisticalpowerfordetectingsignificantpatternscomparedto ing,andanapproachfortheconditionaltestingscenariowhichis
approachesinthefirstclass,butareoftencomputationallydemand- muchmoreefficientthanpermutationtestingwhilemaintaining
ing,sincetheyneedtominealargenumberofpermuteddatasets anextremelyhighpower.Forthemostchallengingdatasets,FSRis
toobtaingoodestimatesoftheoveralldistributionofthepatterns‚Äô theonlyapproachthatallowstominesignificantsubgroupswithin
statistics.Whilethiscanbeachievedfairlyefficientlyforsimple reasonabletime.Moreimportantly,weremarkthattheconsidered
patternssuchasitemsets[25,33],theoverallapproachisimpracti- testcaseofsubgroupsiswellrepresentativeofothersettings.Infact,
calformorecomplexpatternssuchassubgroups,forwhichmining weexpectthesensibleimprovementsobtainedbyFSRtotransfer
evenasingledatasetisextremelytime-consuming. toothercases(i.e.,otherpatterntypes),giventhegeneralityofour
An additional limitation of permutational approaches is that frameworkandthecharacteristicsofourpermutationalapproaches,
theyfocusonconditionaltesting[15].Inconditionaltestingone whicharesharedbyallsignificantpatterntasks.
assumesthatthevariablesofinterest,inourcasethefrequency Duetospaceconstraints,wedefersomeoftheproofsandaddi-
ofpatternsandthefractionofelementswithtargetlabel1,are tionalresultstotheAppendix.
thesameineverydatasetfromthenulldistribution.Incontrast,in
unconditionaltesting[5]oneassumesthatthevariablesofinterest
2 RELATEDWORKS
aretherealizationofcorrespondingrandomvariables.Conditional
testingandunconditionaltestingcapturedifferentassumptions Ourworkfocusesonefficientlyminingsignificantpatterns.Wenow
regardinghowdataisgeneratedandcollected,thatis,whetherthe discussthepreviousworksmostrelatedtoourcontributions.We
variablesofinterestwouldbethesameindifferentrepetitionsofthe referthereadertorecentcomprehensivereviewsandtutorialsfor
experiment.Thechoicebetweenthetwotypesoftestingdepends anoverviewofcommonlyusedtechniquesforminingsignificant
onthespecificscenarios.However,inpracticeconditionaltestsare patterns[16,31].
oftenusedforcomputationalreasons,sinceunconditionaltestsare Severalapproaches[43‚Äì45]haveusedgeneralmethodsformul-
muchmoredemandingfromthecomputationalstandpointdueto tiplehypothesestesting,suchasBonferroni[7]andHolmmeth-
theneedtoaccountforuncertaintiesintheobservedquantities. ods[19],withinsignificantpatternmining.Suchmethodsresult
Infact,whileforsimplepatternssuchasitemsets[32]significant inlowstatisticalpower,sincetheycorrecttheùëù-value,oramea-
patternminingprocedureswith(partial)unconditionaltestinghave sureofthesignificanceofapattern,bythenumberofcandidate
beendesigned,formorecomplexpatternssuchassubgroupsno hypotheses(i.e.,thenumberofpatterns),whichisextremelylarge
unconditionaltestingprocedureisavailable. indataminingapplications.LAMP[29,40]isarecentlyintroduced
methodthatpartiallyaddressessuchissuebyselectingasubsetof
patternsfortesting,whilediscardingthepatternswithnochanceof
1.1 Contributions
beingsignificant.Suchapproachleadstoidentifyinganimproved
Thisworkfocusesontheefficientdiscoveryofsignificantpatterns. (i.e.,smaller)correctionfactor,resultinginhigherstatisticalpower
Ourcontributionsarefour-fold.Firstly,weproposethefirstgeneral whilecontrollingtheFWER.However,sinceeachselectedpattern
frameworktodiscoversignificantpatternsthatcanbeusedforboth isstilltestedasadistincthypothesis,LAMPstillleadstoreduced
conditionalandunconditionaltesting.Ourframeworkisbasedon statisticalpower[25,39].OuralgorithmFSRinsteadusesresam-
anaturaldefinitionofapattern‚Äôsqualitythatcapturesitssignifi- pleddatasets,takingintoaccountdependenciesamongpatterns,to
cance,andappliestoanytypeofpatternforwhichtheappearance achievehighstatisticalpower.
2Severalpermutation-basedmethodshavebeenproposedtoiden- thesetùë†,whileforsubgroupminingitmeansthattheconditions
tify patterns significantly associated with a binary target label. definedbyPareallsatisfiedbythefeaturesofùë†.Wedefinetheset
[25,33,39]usetheWestfall-Young(WY)permutationtest[46].The CP(D)oftransactionsinthedatasetDthatsupportapatternPas
WYpermutationprocedurerequirestoestimatetheùõø-quantileof CP(D)={(ùë†,‚Ñì) ‚ààD :P ‚ààùë†}.ThefrequencyfP(D)ofapattern
thedistributionoftheminimum(overallallpatterns)ùëù-value(or, PinthedatasetDisthefractionoftransactionsofDthatsupport
equivalently,ofthedistributionofthemaximumdeviation,overall P:fP(D)= ùëö1 (cid:205)ùëö ùëñ=11[P ‚ààùë† ùëñ] = |CP ùëö(D)| .
patterns,ofthemeasureofsignificance).Theuseofsuchquantiles Finally,let ùúá(D) denotetheaveragevalueofthetarget‚Ñì for
makesWYpermutationtestingmorepowerfulthanLAMP,but transactionsinthedatasetD:ùúá(D)= |D1
|
(cid:205) (ùë†,‚Ñì)‚ààD‚Ñì.
alsomorecomputationallyexpensive,sincetheestimationofsuch
quantilesrequirestominealargenumberofpermuteddatasets. 3.1 SignificantPatterns
Forthesereasons,allsuchmethodsmayneedimpracticalresources.
Ourgoalistofindsignificantpatterns,whereapatternPissignif-
Our algorithm FSR instead requires to mine a small number of
icant ifthepresenceofP inatransactionisassociatedwiththe
resampleddatasets,leadingtoanefficientapproachevenforcom-
targetvariableofthetransactionbeing1.Inparticular,wecon-
plexpatternssuchassubgroups.Inaddition,permutation-based
siderthesignificanceofapatternintheframeworkofstatistical
methodsonlyconsidertheconditionaldistribution,wherepatterns‚Äô
frequenciesandthefractionofelementswithtargetlabelequalto
significance,assumingthatthetransactions{(ùë† 1,‚Ñì 1),...,(ùë† ùëö,‚Ñì ùëö)}
constitutingthedatasetD aresamplesfromanunknowndistri-
1areassumedfixedinallpermuteddatasets.Ourapproachinstead
butionùõæ.ApatternPisassociatedwiththetargetvariableifthe
worksforboththeconditionalandtheunconditionaldistribution.
probability of the event ‚ÄúP ‚àà ùë† and ‚Ñì = 1‚Äù is higher than the
Theidentificationofsignificantpatternswithunconditionaltest-
correspondingprobabilitywhentheevent‚ÄúP ‚ààùë†‚Äùandtheevent
inghasreceivedscantattention.Thisisdue,inpart,tothehigher
‚Äú‚Ñì =1‚Äùareindependent.Formally,thiscorrespondstoconsiderthe
computationalcostrequiredforassessingthesignificanceofeven
followingnullhypothesisforapatternP:
asinglehypothesisintheunconditionalsetting,forexampleus-
ingBarnard‚Äôstest[5].Asfarasweknow,theonlyapproachfor Pr (P ‚ààùë†‚àß‚Ñì =1)= Pr (P ‚ààùë†) Pr (‚Ñì =1).
miningsignificantpatternsinapartiallyunconditionalsettingis
(ùë†,‚Ñì)‚àºùõæ (ùë†,‚Ñì)‚àºùõæ (ùë†,‚Ñì)‚àºùõæ
SPuManTE[32].Inthepartiallyunconditionalsettingconsideredby Sinceweareinterestedinpatternswithasignificantassociation
SPuManTEonlythefrequenciesofthepatternsarenotfixed,while withthetargetvariablebeing1,weareinterestedinfindingpatterns
thetargetisfixedbydesign.IncontrastouralgorithmFSRconsid-
forwhichthefollowingalternativehypothesisholds:
ersafullyunconditionalsetting,wherethefractionofelements
Pr (P ‚ààùë†‚àß‚Ñì =1) > Pr (P ‚ààùë†) Pr (‚Ñì =1).
withtargetlabelequalto1isnotfixedeither.Moreover,SPuManTE (ùë†,‚Ñì)‚àºùõæ (ùë†,‚Ñì)‚àºùõæ (ùë†,‚Ñì)‚àºùõæ
leveragesspecializedtechniquesforminingsignificantitemsets Tothisend,wedefinethequality1ofapatternPas
thatcannotbeeasilygeneralizedtootherpatterntypes,whileour
approachappliesdirectlytoseveralpatternlanguages,including qP = Pr (P ‚ààùë†‚àß‚Ñì =1)‚àí Pr (P ‚ààùë†) Pr (‚Ñì =1).
(ùë†,‚Ñì)‚àºùõæ (ùë†,‚Ñì)‚àºùõæ (ùë†,‚Ñì)‚àºùõæ
itemsets,sequentialpatterns,andsubgroups.
Otherworks,orthogonaltoours,considerimprovingthediver- NotethatthealternativehypothesisisequivalenttoqP >0,and
sityorlimitingredundancyoftheoutput[12,21,41]. thenullhypothesisisequivalenttoqP = 0.Therefore,finding
significantpatternsisequivalenttofindingpatternswithquality
qP >0.
3 PRELIMINARIES
Forexample,considerthestudyoftheassociationbetweenthe
Weconsideradataset D asacollectionofùëö transactions D = characteristicsoftheusersofanonlinesocialnetworkandusers‚Äô
{(ùë† 1,‚Ñì 1),...,(ùë† ùëö,‚Ñì ùëö)},whereeachtransaction(ùë†,‚Ñì) ‚àà D iscom- interestsinagiventopic.Inthiscase,eachuserisatransaction,
posedbyasetùë†ofùëëfeatures,eitherbinary,categorical,orcontin- users‚Äôcharacteristicsarethefeatures,andbeinginterestedornot
uous,andabinarytargetvariable‚Ñì ‚àà {0,1}.Moregenerally,we inthetopicdefinesthetargetvariable.Significantpatternsinthis
assumethatùë† belongstoadomainX.Bydefiningthemultisets exampleareassociationsbetweenusers‚Äôcharacteristicsandusers‚Äô
A = {ùë† 1,...,ùë† ùëö}andT = {‚Ñì 1,...,‚Ñì ùëö},adatasetD isalsorepre- intereststhataresignificantlystrongerthanexpectedunderthenull
sentedbythepairD =(A,T).WeassumetohavealanguageL hypothesisofindependencebetweencharacteristicsandinterests.
containingthepatternsofpotentialinterest.Thisscenariocaptures Forexample,iftheprobabilitythatauserhasagivenbinaryfeature
widelyusedpatternminingtasks,suchas:itemsetmining,where
ùëì is0.3,andtheprobabilitythatauserisinterestedinthetopicis
allfeaturescorrespondto(binary)itemsandthelanguageLcorre- 0.5,thenunderthenullhypothesisofindependencewehavethat
spondstothesetofallitemsets,i.e.,(non-empty)subsetsofitems; theprobabilitythatauserhasfeature ùëì and isinterestedinthe
subgroupmining,wherethelanguageLcontainsallsubgroups,i.e., topicis0.15.Therefore,thefeatureùëì issignificantlyassociatedwith
thesetsofconjunctionswithatmostùëß conditionsoverfeatures thetopicofinterestiftheactualprobabilitythatauserhasfeature
fromA,whereeachconditioniseitheranequality,onacategorical ùëì andisinterestedinthetopicis>0.15.
feature,oraninterval,onacontinuousfeature.
TaskDefinition.GivenadatasetDandthecorrespondingpat-
Given a transaction (ùë†,‚Ñì), we use the notation P ‚àà ùë† to say ternlanguageL,ourgoalistoidentifysignificantpatterns,that
thatthesetùë† offeaturessupportspatternP,wherethemeaning
ofP ‚àà ùë† dependsonthespecificdataminingtask.Forexample, 1 qT uh ae litq yua gl ii vty enqP itsis reo lf ate tin onca tl oled thl eev 1e -r qag ue alf io tyrg ce on mer mal op na lytte er mns pl[ o1 y6 e], db tu ot fiw ne dus ine tt eh re est te ir nm
g
foritemsetmining,P ‚ààùë†meansthatthepatternPiscontainedin subgroups.
3is,patternsP ‚àà LwithqualityqP > 0.Sincethedistributionùõæ testassumesthatthedata-generatingprocessrepresentedbythe
isunknownandwehaveaccessonlytothedatasetDcomprising unknowndistributionùõæonlyproducesdatasetswithùëötransactions
transactionssampledfromùõæ,wecannothopetodiscoverallsignif- inwhichboththefrequencyfP(D)ofpatternPandthefraction
icantpatternswithouterrors.Asaconsequence,wemustresortto ùúá(D) oftransactionswithtargetvalue1arethesameasinthe
approximations.Inparticular,definethesubsetL‚òÖ ofthelanguage observeddataset;thatis,itconditionsontheobservedvariables
Lofpatternsforwhichthenullhypothesisholds: ofinterest.Incontrast,unconditionaltestsassumethatfP(D)and
L‚òÖ ={P ‚ààL:qP =0}. ùúá(D)aretherealizationofcorrespondingrandomvariables.Un-
conditionalteststhereforeassesstheassociationbetweenapattern
OurtaskisthentoproduceasubsetùëÇ ‚äÜ Lofallpatternsinthe andclasslabelsconsideringalsoscenarios(i.e.,datasets)whereall
languagewithFamily-WiseErrorRate(FWER)belowauser-defined
frequenciesofthepatternsand/ortheaveragetargetvaluemay
thresholdùõø,suchthattheprobabilitythatùëÇcontainsatleastone differfromwhatisobservedinthedata.Equivalently,conditional
elementfromL‚òÖ isatmostùõø: testsandunconditionaltestsarebasedondifferentassumptions
Pr(cid:0)ùëÇ‚à©L‚òÖ ‚â†‚àÖ(cid:1) ‚â§ùõø. (1) regardinghowdataisgeneratedandcollected,namely,whether
D thevariablesofinterestwouldbethesameinadifferentrepetition
Notethat(1)impliesthatùëÇ isfalsediscoveryfreeapproximation, oftheexperiment(conditionaltests)ornot(unconditionaltests).
whichhavepreviouslybeenconsideredforotherpatternmining Consider for example the scenario of online social networks
tasks[36,37]. described in Section 3.1, and assume for simplicity that we are
SinceqP dependsontheunknowndistributionùõæ,wedefinea interestedinassociationsbetweenthesinglefeaturesandthetarget.
statisticq¬ØP(D)thatcorrespondstoanestimateofqP fromdata Ifthedataiscollectedsothatthetotalnumberoftransactionsfor
andthatwewilluseinouralgorithmFSRtoidentifysignificant eachvalueofthetargetisfixedandthefractionoftransactions
patterns.ForeachpatternP,wedefinethefunctionsùëì
P
andùëî
P
withgivenvaluesofthefeaturesisfixedaswell,thenconditional
asfollows:eachùëì
P
:X ‚Üí {0,1}isdefinedasùëì P(ùë†) =1[P ‚ààùë†], testingismoreappropriate.Ifinsteadonecollectsthedatawithout
such that ùëì P(ùë†) = 1 if P ‚àà ùë†, and ùëì P(ùë†) = 0 otherwise; each constraintsonthefeatures/targetvalues(e.g.,simplycollectingas
ùëî P : X √ó{0,1} ‚Üí [‚àíùúá(D),1‚àíùúá(D)] isdefinedasùëî P(ùë†,‚Ñì) = manytransactionsaspossible),thenunconditionaltestingismore
ùëì P(ùë†)(‚Ñì‚àíùúá(D)).Then,theestimateq¬ØP(D)ofqP forpatternP appropriate.
fromthedatasetDis Conditionaltestsandunconditionaltestsarethereforebothvalid
ùëö andofinterestfordataminingapplications,andthechoicebetween
1 ‚àëÔ∏Å
q¬ØP(D)=
ùëö
ùëî P(ùë† ùëñ,‚Ñì ùëñ). thetwoclassesdependsonthespecificscenario,evenifinpractice
ùëñ=1 conditionaltestsareusuallypreferredforcomputationalreasons,
Interestingly,q¬ØP(D)correspondstothe1-qualitycommonlyused sinceunconditionaltestsneedtotakeintoaccountmoreuncer-
taintiesintheobservedquantities.Inwhatfollows,weintroducea
insubgroupmining[4](seeAppendixA.1),evenifthewayitis
generalalgorithmtoidentifysignificantpatternsforbothcondi-
usedinouralgorithmFSR(seeSection4)isdifferentfromitsusual
tionaltestingandunconditionaltesting.Ouralgorithmisextremely
application,duetoourfocusonstatisticallysignificantpatterns.
efficientinbothcasesduetotheuseoffew-shotresampling.
Intuitively,weexpectsignificantpatternstohaveasufficiently
high empirical quality q¬ØP(D) measured on the data D, since
4 FSRALGORITHM
q¬ØP(D)estimatesthe(true)qualityqP ofP.Totakeintoaccount
themultiplehypothesistestingissuedescribedabove,weneedto WenowdescribeouralgorithmFSR(Algorithm1)tofindsignificant
identifyathresholdùúÄsuchthatreportinginoutputallpatternswith patternsforbothconditionaltestingandunconditionaltesting.We
quality‚â•ùúÄhasboundedFWER.NotethatùúÄshouldbeassmallas firstpresentthegeneralapproach,thatiscommontobothtesting
possibleinordertohavehighstatisticalpower(i.e.,toreportthe scenarios,andthenpresentthedetailsforconditionaltestingin
largestsetofresultswithguaranteesonfalsediscoveries).Acritical Section4.1,andthedetailsforunconditionaltestinginSection4.2.
quantitywestudytoaddressthisissueisthesupremumdeviation Inanutshell,FSRidentifiessignificantpatternsfromadataset
oftheempiricalqualitiesofnon-significantpatterns,definedas D ={(ùë† 1,‚Ñì 1),...,(ùë† ùëö,‚Ñì ùëö)}usingafew-shotresamplingapproach
tocomputerigorousprobabilisticboundstothedeviationofthees-
Ps ‚ààu Lp ‚òÖ{q¬ØP(D)}. (2)
timatedqualitiesq¬ØP(D)ofthepatterns,underthenullhypothesis
ofnoassociationbetweenthepatternsandthetargetlabel.Itthen
WeaddressthischallengewithFSR:wederivenovelanalytical
reportsinoutputallpatternswithestimatedqualityq¬ØP(D)above
boundsontheconcentrationofthesupremumdeviation(2),and
suchdeviation.
b toui sl hd ao rpn lyth ee ss te imto ao tels ita .n FSe Rffi ac cie hn iet vf ee sw h-s igh hot str ae ts ia sm ticp al lin pg owal eg ror wit hh im
le
resaF mSR plc eo dn ds ai td ae sr es tsa ,ec ao cl hle oc bti to an ineR d‚òÖ by= re{ sD am1‚òÖ, p. li. n. g,D thùëê‚òÖ e} tao rf gùëê et‚â• lab1 eli s.i. od f.
scaling to large datasets and complex languages. Our approach
DwhilemaintainingthesamefeaturesofthetransactionsofD.
appliestobothconditionalandunconditionaltesting,bothofgreat EachresampleddatasetisD‚òÖ ùëó =(cid:8) (ùë† 1,ùúâ 1,ùëó),...,(ùë† ùëö,ùúâ ùëö,ùëó)(cid:9) ,where
interestindatamining.
ùúâ ùëñ,ùëó arei.i.d.randomvariableswith
3.2 ConditionalandUnconditionalTesting ùúâ ùëñ,ùëó ‚àºùêµùëíùëüùëõ(ùëù),‚àÄùëñ ‚àà [1,ùëö],‚àÄùëó ‚àà [1,ùëê],
WhenassessingthestatisticalsignificanceofapatternP,onehasto andùêµùëíùëüùëõ(ùëù)istheBernoullirandomvariablewithparameterùëù(i.e.,
choosebetweenconditionalandunconditionaltests.Aconditional itis1withprobabilityùëù,and0otherwise).
4We now describe the general approach followed by FSR (Al- Algorithm1:FSR
gorithm 1). FSR starts by computing an upper boundùúÄ ùëá to the Input:PatternlanguageL;datasetDofùëötransactions;
deviationbetweentheaveragetargetvalueùúá(D)observedinD
ùëê ‚â•1;ùõø ‚àà (0,1).
and its expected value ùúá = E D[ùúá(D)] under the null hypoth- Output:SetùëÇ ‚äÜLofsignificantpatternswithFWER‚â§ùõø.
esis (line 1). Note that ùúá is the probability that a sample from 1 ùúÄ ùëá ‚ÜêboundTarget(ùúá(D),ùëö,ùõø);
theunknowndistributionùõæ hastargetlabel‚Ñì equalto1,thatis 2 ùúáÀÜ‚Üêùúá(D)+ùúÄ ùëá;
ùúá = Pr(ùë†,‚Ñì) (‚Ñì =1). The computation ofùúÄ ùëá is performed by the 3 ùúáÀá‚Üêùúá(D)‚àíùúÄ ùëá;
procedureboundTargetanditdependsonwhetheroneisinter-
4
R‚òÖ‚ÜêresampleTarget(D,ùëê,ùúáÀÜ);
estedinconditionaltestingorinunconditionaltesting.Thede-
tails of boundTarget for the two settings are described in Sec- 5 forallùëó ‚àà [1,ùëê]doùëë ùëó ‚Üêsup P‚ààL(cid:8) q¬ØP(D‚òÖ ùëó,ùúáÀá)(cid:9) ;
tion4.1andinSection4.2,respectively.ThenFSRusesùúÄ ùëá toob- 6 ùëëÀú(R‚òÖ,ùúáÀá)‚Üê ùëê1(cid:205)ùëê ùëó=1ùëë ùëó;
taintheupperbound ùúáÀÜ (line2)andlowerbound ùúáÀá (line3)to ùúá 7 ùúÄ ‚ÜêboundStatistic(D,L,ùëëÀú(R‚òÖ,ùúáÀá),ùõø);
(
r
sw
ie
gse
na
it
m
nri
p
gv li tea ol Tl eay ara
cg
hs es tu trm
t ao
ne sg0
ae
cn‚â§
te
iorùúá
a
nÀá te‚â§ inùëêùúá tÀÜ
r
he‚â§
esa
d1
m
a) t.
p
aI
l
st
e
edt th sde oan ftau Rss
e
‚òÖe ts
s
tht Rh e‚òÖe tap
(
rlr
i
gno eec te
4
ld a)u bar ese
l-
98 ùëÇ ret‚Üê urn{P ùëÇ‚àà
;
L:q¬ØP(D) ‚â•ùúÄ+ùúÄ ùëáfP(D)};
1withprobabilityùëù =ùúáÀÜ(i.e,theupperboundtoùúá).Notethatthe
resampleTargetprocedureisthesameforbothconditionalandun-
ùëêco rn ed sait mio pn la el dt des at ti an sg e. tsT oh fe Ral ‚òÖg ,o ari nth em stit mhe an tec oo fm thp eut mes a, xf ir mom umea dc eh vio af tit oh ne q¬ØP(D)fromthe(unknown)valueqP underthenullhypothesis.
Moreover,theexactsameprocedureisusedtogeneratetheresam-
oftheempiricalqualityq¬ØP(D)fornon-significantpatterns.Thisis
pleddatasets.Notethatourapproachissimilartopermutation
achievedbycomputing,foreveryresampleddatasetD‚òÖ
ùëó ,thequan- approachesforsignificantpatternmining,whichusepermuted
titysup P‚ààLq¬ØP(D‚òÖ ùëó,ùúáÀá),whereq¬ØP(D‚òÖ ùëó,ùúáÀá)= ùëö1 (cid:205)ùëö ùëñ=1ùëì P(ùë† ùëñ)(ùúâ ùëñ,ùëó‚àí datasetstoestimatethesignificanceofpatterns,butwithtwocru-
ùúáÀá).Thevaluesup P‚ààLq¬ØP(D‚òÖ ùëó,ùúáÀá)canbeinterpretedasanempiri- cialdifferences.First,ourdatasetsareobtainedbyresamplingthe
calestimateofthemaximumqualityofnon-significantpatterns, targetvalues,andnotbypermutingthem,whichallowsustoobtain
measuredfromdatasetssampledfromthenulldistribution.Note rigorousboundsforbothconditionalandunconditionaltesting,
thatweuseq¬ØP(D‚òÖ ùëó,ùúáÀá)asùúáÀáisalowerboundtoùúá;consequently, while permutation approaches can be used for conditional test-
q¬ØP(D‚òÖ ùëó,ùúáÀá)providesaproperupperboundtosuchmaximumdevia- ingonly.Second,sinceouranalysisdependsontheexpectation
ofthemaximumdeviation,wecanemployadvancedboundson
tion.Then,notethatitisnecessarytoconsiderthesupremumover
thelanguageL,sincethesetoftruenullhypothesisL‚òÖ
isunknown.
theconcentrationoftheexpectedvalueoffunctionsofindepen-
Weremarkthatthecomputationofsup P‚ààLq¬ØP(D‚òÖ ùëó,ùúáÀá)canbeper- d ree sn at mra pn led dom datv aa sr ei ta sb ,l ae ss; st hh ois wa nllo bw ys ouu rst ao nau ls ye sia ss am na dll en xpu em rib mer enùëê to af
l
formedwithfastpatternenumerationstrategies,similartotheones
evaluation.Thisisincontrastwithpermutationapproaches(e.g.,
leveragedbypreviousmethodsforfrequentandsignificantpattern
theonesbasedonWYpermutationtesting[25,33,39])thatinstead
mining;infact,FSRcanbecombinedwithanyefficientexploration
estimatethequantilesofthedistributionofthemaximumdevia-
procedure,suchastheonesthatexplorethesearchspaceofthe
tionusingalargenumberofpermutations(seealsoSectionA.2in
patternlanguageofinterestusingpruningbounds,forinstance
Appendixforamoredetailedcomparison).
depth-first[25,29,39]orbest-firstsearches[30,33,34].Thealgo-
rithmthenstorestheempiricaldeviationssup P‚ààLq¬ØP(D‚òÖ ùëó,ùúáÀá)in 4.1 FSRforConditionalTesting
thevariablesùëë ùëó.Then,theaveragemaximumdeviationùëëÀú(R‚òÖ,ùúáÀá)
overtheùëêresampleddatasetsiscomputed(line6)asthemeanof We now describe the details of procedures boundTarget and
thevalues{ùëë ùëó,ùëó ‚àà [1,ùëê]},anditisthenusedtocomputearigor- boundStatisticfortheversionof FSRthatusesconditionaltest-
ousupperboundùúÄtothesupremumdeviationsup P‚ààL‚òÖ{q¬ØP(D)} i on ug r, pw rh oi bc lh emwe ar se sf ue mrt eo sa ths aF tSR th- eC. aA ves ra agre em tain rgd ee tr, va ac luo end ùúáit aio nn da pl ate tts et rf no sr
(Eq.(2))underthenullhypothesis(line7)throughtheprocedure
boundStatistic.Theimplementationofthisprocedure,i.e.,the
frequenciesfP(D)arefixed,forallP ‚ààL,tothevaluesobserved
returnedvalueofùúÄ,dependsonwhetherconditionaltestingorun-
inthedatasetD.
ForboundTarget,sincetheaveragetargetvalueùúá isfixedto
conditionaltestingisconsidered,anditisdescribedinSection4.1
thevalue ùúá(D) observedinthedataset D,theboundùúÄ ùëá onits
andSection4.2,respectively.Inbothcases,weuseadvancedcon-
deviationfromtheexpectationis0,thatis,boundTargetsimply
centrationbounds[8,27]thatallowustoobtainsmallvaluesof
ùúÄwithasmallnumberùëêofresampleddatasets.Finally,thesetof returns0.Notethatthisimpliesthattheoutputof FSR-Cconsists
patternswithestimatedqualityq¬ØP(D)greaterthanùúÄ+ùúÄ ùëáfP(D)
ofallpatternsinLwithq¬ØP(D) ‚â•ùúÄ(line8).
For boundStatistic, we now show how to compute a
isreportedinoutput(lines8-9).
NotethatwhilethecomputationofùúÄ
ùëá
andùúÄdependsonwhether rigorous probabilistic bound ùúÄ to the supremum deviation
conditionaltestingorunconditionaltestingisconsidered,theover-
sup P‚ààL‚òÖ{q¬ØP(D)}(Eq.(2))underthenullhypothesis.Thebound
isobtainedbycomputingtheaveragemaximumdeviationùëëÀú(R‚òÖ,ùúáÀá)
allapproachfollowedbyFSRisthesameinbothcases.Inparticular,
forbothcasesFSRreliesontheresampleddatasetsR‚òÖ
toestimate
overùëê resampleddatasets,andthenapplyingadvancedconcen-
themaximumdeviation,overallpatternsP ‚ààL,oftheestimate trationresults[8].NotethatsinceùúÄ ùëá =0,inthiscaseùëëÀú(R‚òÖ,ùúáÀá) =
ùëëÀú(R‚òÖ,ùúá(D)).
5Since FSR-C is based on resampled datasets, where each tar- Therefore,wehave
getlabelissampledindependently,ourestimateùëëÀú(R‚òÖ,ùúá(D))of
theexpectedmaximumdeviationisnotbasedontheconditional
E [ùëì(v)]
v‚àºùêº(ùëò/ùëö)
distributionassumedbyconditionaltests,wherethefractionof
ùëö (cid:34) ùëö (cid:35) (cid:32)ùëö (cid:33)
targetlabelsequalto1isexactlyùúá(D)ineverydataset(whilein ‚àëÔ∏Å ‚àëÔ∏Å ‚àëÔ∏Å
= E ùëì(v) | vùëñ = ùëó Pr vùëñ = ùëó
ourresampleddatasetssuchfractionmayvary,anditisequalto ùëó=0v‚àºùêº(ùëò/ùëö)
ùëñ=1
v‚àºùêº(ùëò/ùëö)
ùëñ=1
ùúá(D)onlyinexpectation).Wethereforeneedtorelatethesupre-
ùëö (cid:34) ùëö (cid:35) (cid:32)ùëö (cid:33)
mumdeviationoftheobservedqualityofpatternsonresampled ‚â•‚àëÔ∏Å E ùëì(v) |‚àëÔ∏Å vùëñ = ùëó Pr ‚àëÔ∏Å vùëñ = ùëó
datasetswiththeoneobservedindatasetssampledfromthecondi- ùëó=ùëòv‚àºùêº(ùëò/ùëö)
ùëñ=1
v‚àºùêº(ùëò/ùëö)
ùëñ=1
tionaldistribution.Interestingly,weshowthattheresamplingand
(cid:34) ùëö (cid:35) ùëö (cid:32)ùëö (cid:33)
conditionaldistributionsarecloselyrelated,inthesensethathigh
‚â• E ùëì(v)
|‚àëÔ∏Å
vùëñ =ùëò
‚àëÔ∏Å
Pr
‚àëÔ∏Å
vùëñ = ùëó
probabilityboundsfortheformeralsoapplytothelatter. v‚àºùêº(ùëò/ùëö)
ùëñ=1
ùëó=ùëòv‚àºùêº(ùëò/ùëö)
ùëñ=1
Wefirstproveageneralresult(Lemma1)relatingtheexpec-
(cid:32)ùëö (cid:33)
tationofmonotonefunctionsofpermutationsofbinaryvectors, = E [ùëì(v)] Pr ‚àëÔ∏Å vùëñ ‚â•ùëò
correspondingtotheconditionaldistribution,withtheexpectation v‚àºùëà(ùêµ(ùëò)) v‚àºùêº(ùëò/ùëö)
ùëñ=1
takenw.r.t.toindependentresamples,correspondingtoresampled
1
datasets.Foranintegerùëò with0 ‚â§ùëò ‚â§ùëö,definethesetùêµ(ùëò)of ‚â• E [ùëì(v)] ,
binaryvectorswithùëòentriesequaltooneas
v‚àºùëà(ùêµ(ùëò)) 2
wherethelastinequalityfollowsfromLemma2. ‚ñ°
ùëö
ùêµ(ùëò)=(cid:110) v‚àà{0,1}ùëö,‚àëÔ∏Å
vùëñ
=ùëò(cid:111)
,
ùëñ=1 WemakeuseofLemma1toprovethefollowingresult.
Theorem3. Definetheconstantùúá¬Ø= ùúá(D)andletùëò = ùúá¬Øùëö.For
and letùëà(ùêµ(ùëò)) be the uniform distribution over the set ùêµ(ùëò). anyùëß ‚â•0,itholds
Equivalently,ùëà(ùêµ(ùëò)) correspondstothesetofuniformpermu-
tations of a binary vector with ùëò ones. Then, define ùêº(ùëù) as a (cid:32) ùëö (cid:33)
p ar ro ab na db oil mity ved cis totr rib vu tt aio kn enov fre or m{0 ùêº, (1 ùëù} )ùëö is,s au nch i.i.t dh .a Bt ee ra nc oh ue lln it rr .vy .v wùëñ ito hf v‚àºùëàP (ùêµr
(ùëò))
Ps ‚ààu Lp ‚òÖùëö1 ‚àëÔ∏Å ùëñ=1ùëì P(ùë† ùëñ)(vùëñ ‚àíùúá¬Ø) ‚â•ùëß
Pr(vùëñ =1)=ùëù =1‚àíPr(vùëñ =0),forsomeùëù ‚àà [0,1]. (cid:32)
1
‚àëÔ∏Åùëö (cid:33)
Lemma1. Letùëì : {0,1}ùëö ‚Üí Rbeanonnegativefunctionsuch
‚â§2 v‚àºP ùêºr
(ùúá¬Ø)
Ps ‚ààu Lp
‚òÖùëö
ùëñ=1ùëì P(ùë† ùëñ)(vùëñ ‚àíùúá¬Ø) ‚â•ùëß .
tt oh na it cE alv l‚àº yùëà d( eùêµ cr(ùëò ea)) si[ nùëì g( iv n)] ùëò.is Ite hit oh le dr smonotonicallyincreasingormono- ProofofTheorem3. Definethefunctionùëî:{0,1}ùëö ‚Üí{0,1}
(cid:34) ùëö (cid:35)
v‚àºùëà(E ùêµ(ùëò))[ùëì(v)] ‚â§2 v‚àºùêº(E ùëò/ùëö)[ùëì(v)]. ùëî(v)=1 Ps ‚ààu Lp ‚òÖùëö1 ‚àëÔ∏Å ùëñ=1ùëì P(ùë† ùëñ)(vùëñ ‚àíùúá¬Ø) ‚â•ùëß .
ToproveLemma1,weneedthefollowingtechnicalresult,pro- In order to apply Lemma 1, we prove that E v‚àºùëà(ùêµ(ùëò)) [ùëî(v)] is
vidingboundstotheprobabilitythataBinomialrandomvariable nondecreasingwithùëò.Thisisequivalenttoshowthat
exceedsitsexpectation[20].
E [ùëî(v)] ‚â§ E [ùëî(v)],
Lemma2. Letùúáùëöbeaninteger.Thenitholds v‚àºùëà(ùêµ(ùëò)) v‚àºùëà(ùêµ(ùëò‚Ä≤))
whereùëò‚Ä≤ = ùëò + ùëó, for any pair of integersùëò ‚àà [0,ùëö] and ùëó ‚àà
(cid:32) ‚àëÔ∏Åùëö (cid:33)
1
(cid:32) ‚àëÔ∏Åùëö (cid:33) [0,ùëö‚àíùëò].Todoso,webuildacouplingùúã(ùëò,ùëò‚Ä≤)betweenthetwo
v‚àºP ùêºr (ùúá) ùëñ=1vùëñ >ùúáùëö < 2 < v‚àºP ùêºr (ùúá) ùëñ=1vùëñ ‚â•ùúáùëö . d fri os mtri ùëàbu (t ùêµio (n ùëòs ))ùëà ,d( eùêµ fi( nùëò e)) va ‚Ä≤n ad saùëà c( oùêµ p( yùëò‚Ä≤ o) f) vas (i.f eo .l ,l so uw cs h. tF ho ar ta vn ùëñy =v vùëñ‚Ä≤t ,a ‚àÄk ùëñe ‚ààn
[1,ùëö]),thatismodifiedaccordingtothefollowingprocedure:for
WenowproveLemma1.
ùëó times,selectuniformlyatrandomanindexùëñ suchthatvùëñ‚Ä≤ = 0,
andsetvùëñ‚Ä≤to1.Denotethepairv,v‚Ä≤sampledaccordingtoùúã(ùëò,ùëò‚Ä≤)
astheoutputofthisprocedure.Itisimmediatetoobservethat
ProofofLemma1. We prove the result assuming that
E cav s‚àº eùëà is(ùêµ a( nùëò a)) lo[ gùëì o( uv s) .] Fi is rsm t,o wn eot no on teic ta hll ay tincreasinginùëò,astheother v an‚Ä≤ d‚àº tùëà ha(ùêµ t( vùëò ùëñ‚Ä≤) ‚â§)( vi. ùëñe ‚Ä≤,., ‚àÄt ùëñha ‚ààtt [h 1e ,ùëöm ]a .rg Ti hn ia sl id mis ptr li ib eu st ti hon ato ,f fov r‚Ä≤i as nùëà y( pùêµ a( iùëò r‚Ä≤ o)) f,
vectorsv,v‚Ä≤ ‚àºùúã(ùëò,ùëò‚Ä≤),itholds
(cid:34) ùëö (cid:35) ùëö ùëö
v‚àºùëà(E ùêµ(ùëò))[ùëì(v)] = v‚àºùêº(E
ùëò/ùëö)
ùëì(v) |‚àëÔ∏Å ùëñ=1vùëñ =ùëò . Ps ‚ààu Lp ‚òÖùëö1 ‚àëÔ∏Å ùëñ=1ùëì P(ùë† ùëñ)(vùëñ ‚àíùúá¬Ø) ‚â§ Ps ‚ààu Lp ‚òÖùëö1 ‚àëÔ∏Å ùëñ=1ùëì P(ùë† ùëñ)(vùëñ‚Ä≤‚àíùúá¬Ø).
6Aconsequenceofthisfactis ProofofTheorem4. Definethefunctionùëî:{0,1}ùëö ‚ÜíRas
E (cid:2)ùëî(v‚Ä≤)(cid:3) ùëö
1 ‚àëÔ∏Å
v‚Ä≤‚àºùëà(ùêµ(ùëò+ùëó)) ùëî(v)= sup
ùëö
ùëì P(ùë† ùëñ)(vùëñ ‚àíùúá¬Ø).
= v‚Ä≤‚àºùëà(P ùêµr (ùëò+ùëó))(cid:32) Ps ‚ààu Lp ‚òÖùëö1 ‚àëÔ∏Å ùëñùëö =1ùëì P(ùë† ùëñ)(vùëñ‚Ä≤‚àíùúá¬Ø) ‚â•ùëß(cid:33)
W she owfir ts ht an to ,cte hoth oa st in,f gro
thmP et‚àà
ch
oL
e
n‚òÖ
sre tas
nuùëñ tl= st1
o ùë°f aT ndhe ùëßo ar sem3,itissufficientto
(cid:32) ùëö (cid:33)
= v,v‚Ä≤‚àºP ùúãr
(ùëò,ùëò‚Ä≤)
Ps ‚ààu Lp ‚òÖùëö1 ‚àëÔ∏Å ùëñ=1ùëì P(ùë† ùëñ)(vùëñ‚Ä≤‚àíùúá¬Ø) ‚â•ùëß
ùë°
=‚àöÔ∏Ñ
2ùúîlog( ùõø2)
, ùëß= E [ùëî(v)]+ùë°, (3)
(cid:32)
1
‚àëÔ∏Åùëö (cid:33) ùëö v‚àºùêº(ùúá¬Ø)
‚â• v,v‚Ä≤‚àºP ùúãr
(ùëò,ùëò‚Ä≤)
Ps ‚ààu Lp
‚òÖùëö
ùëñ=1ùëì P(ùë† ùëñ)(vùëñ ‚àíùúá¬Ø) ‚â•ùëß
itholds
(cid:32) 1 ‚àëÔ∏Åùëö (cid:33) Pr (ùëî(v) ‚â•ùëß) ‚â§ùõø/2.
= v‚àºùëàP (ùêµr
(ùëò))
Ps ‚ààu Lp
‚òÖùëö
ùëñ=1ùëì P(ùë† ùëñ)(vùëñ ‚àíùúá¬Ø) ‚â•ùëß v‚àºùêº(ùúá¬Ø)
ùëó
= E [ùëî(v)].
Todoso,wemakeuseofTheorem5.Definev¬Ø acopyofv,where
v‚àºùëà(ùêµ(ùëò)) itsùëó-thelementvùëó isreplacedbyanindependentcopyv‚Ä≤ ùëó.Wewant
Therefore,ùëîisnonnegativeandE
v‚àºùëà(ùêµ(ùëò))
[ùëî(v)]isnondecreas- toupperbound
i mn eg ni tn .ùëò.WeapplyLemma1tothefunctionùëî,obtainingthestat ‚ñ°e- ‚àëÔ∏Åùëö E(cid:20)(cid:16) ùëî(v)‚àíùëî(v¬Øùëó )(cid:17)2 |v(cid:21)
+
ùëó=1
WenotethatTheorem3ispreciselywhatweseek:itimpliesthat
largesupremumdeviationsthatareunlikelyintheindependent belowsomeconstantùëû ‚â•0.DefineP‚òÖ asoneoftheelementsof
resamplesdistributionv‚àºùêº(ùúá¬Ø)arealsounlikelyintheconditional L‚òÖ thatachievethesupremuminùëî(v).Weobservethat
distributionv‚àºùëà(ùêµ(ùëò)).ByusingTheorem3,weprovethefol- (cid:16) ùëî(v)‚àíùëî(v¬Øùëó )(cid:17)
lowingresult,thatimpliesstrongconcentrationofthesupremum +
deviationofpatternqualitiesw.r.t.theirexpectations,takenw.r.t. (cid:18) ùëö ùëö (cid:19)
independentresamplesofthetargetlabelsratherthanpermuta- ‚â§ ùëö1 ‚àëÔ∏Å ùëì P‚òÖ(ùë† ùëñ)(vùëñ ‚àíùúá¬Ø)‚àí ùëö1 ‚àëÔ∏Å ùëì P‚òÖ(ùë† ùëñ)(v¬Ø ùëñùëó ‚àíùúá¬Ø)
tions. ùëñ=1 ùëñ=1 +
(cid:18) (cid:19)
1 1
Theorem4. Defineùúá¬Ø=ùúá(D),and = ùëöùëì P‚òÖ(ùë† ùëó)(vùëó ‚àíùúá¬Ø)‚àí ùëöùëì P‚òÖ(ùë† ùëó)(v‚Ä≤ ùëó ‚àíùúá¬Ø)
ùëö +
ùúî =(1‚àíùúá¬Ø)min(cid:110) ùúá¬Ø, Psu ‚ààp Lùëö1 ‚àëÔ∏Å ùëñ=1ùëì P(ùë† ùëñ)(cid:111) . = (cid:18) ùëö1 ùëì P‚òÖ(ùë† ùëó)(vùëó ‚àív‚Ä≤ ùëó)(cid:19) +. (4)
Withprobabilityatleast1‚àíùõøoverv‚àºùëà(ùêµ(ùëò)),itholds Wenowobservethatv‚Ä≤ ùëó =0istheonlypossiblevalueofv‚Ä≤ ùëó that
1
‚àëÔ∏Åùëö makes(4)be>0.Therefore,wehave
Ps ‚ààu Lp
‚òÖùëö
ùëñ=1ùëì P(ùë† ùëñ)(vùëñ ‚àíùúá¬Ø)
‚àëÔ∏Åùëö E(cid:20)(cid:16) ùëî(v)‚àíùëî(v¬Øùëó )(cid:17)2 |v(cid:21)
(cid:34) ùëö (cid:35) (cid:118)(cid:116) 2ùúîlog(cid:16) 2(cid:17) ùëó=1 +
1 ‚àëÔ∏Å ùõø
‚â§ v‚àºùêºE (ùúá¬Ø) Ps ‚ààu Lp ‚òÖùëö ùëñ=1ùëì P(ùë† ùëñ)(vùëñ ‚àíùúá¬Ø) + ùëö . ‚â§‚àëÔ∏Åùëö E(cid:34)(cid:18) ùëö1 ùëì P‚òÖ(ùë† ùëó)(vùëó ‚àív‚Ä≤ ùëó)(cid:19)2 |v(cid:35)
To prove Theorem 4, we need the following technical result
ùëó=1 +
regardingtheconcentrationoffunctionsofindependentrandom ‚àëÔ∏Åùëö (cid:18) 1 (cid:19)2
variables.
=(1‚àíùúá¬Ø) ùëöùëì P‚òÖ(ùë† ùëó)vùëó
ùëó=1
a ran
ndT dh olee mto ùëãr ve am
r=
ia5 b(( lùëãT esh
1
.,e
.
Do
.
er
.
fi,e
ùëã
nm
ùëö
e6 ùëã). ¬Ø7 ùëó‚àào =f Y[ (8 ùëãùëö]) 1.
,a
.L .e
c
.t
o
,lùëî
ùëãle
ùëó:
c
‚àíY
ti 1o
,ùëö
n
ùëã‚Üí
ùëó‚Ä≤o ,f
ùëãùëöR ùëó+b
1i
,e
n
.da
.e
.f
p
,u ùëãen
n
ùëöc dti )eo nn ‚ààt,
=
(1 ùëö‚àíùúá¬Ø) ‚àëÔ∏Å ùëóùëö =1(cid:18) ùëö1
ùëì P‚òÖ(ùë†
ùëó)vùëó(cid:19)
Yùëö as a copy ofùëã, where its ùëó-th elementùëã ùëó is replaced by an (1‚àíùúá¬Ø) ‚àëÔ∏Åùëö (cid:18) 1 (cid:19) ùúî
independentcopyùëã ùëó‚Ä≤.Assumethat,forsomeconstantùëû ‚â•0, ‚â§
ùëö
sup ùëöùëì P(ùë† ùëó)vùëó ‚â§ ùëö.
P‚ààL‚òÖùëó=1
‚àëÔ∏Åùëö E(cid:20)(cid:16) ùëî(ùëã)‚àíùëî(ùëã¬Øùëó )(cid:17)2 |ùëã(cid:21) ‚â§ùëû WeapplyTheorem5tothefunctionùëîwithùëû = ùúî/ùëö,obtaining
+
ùëó=1 that
holdsalmostsurely.Then,itholds,forallùë° ‚â•0,
Pr
(cid:16)
ùëî(v) ‚â• E
[ùëî(v)]+ùë°(cid:17)
‚â§exp(‚àíùëöùë°2/(2ùúî)).
Pr(cid:16)
ùëî(ùëã)
‚â•E[ùëî(ùëã)]+ùë°(cid:17)
‚â§exp(‚àíùë°2/(2ùëû)).
v‚àºùêº(ùúá¬Ø) v‚àºùêº(ùúá¬Ø)
ùëã Settingùë° asin(3),itisimmediatetoobservethattheprobability
WeusetheseresultstoproveTheorem4. aboveis‚â§ùõø/2,obtainingthestatement. ‚ñ°
7NotethatTheorem4providesaprobabilisticupperbound,hold- Theorem8. Fixùõø ‚àà (0,1)andùëê,ùëß ‚â•1.LetùëÇbetheoutputofFSR
ingwithprobabilityatleast1‚àíùõø,tothemaximumobservedvalue withinputparametersL,D,ùëê,andùõø,whereListhelanguageof
ofthepatternqualitysup P‚ààL‚òÖ ùëö1 (cid:205)ùëö ùëñ=1ùëì P(ùë† ùëñ)(vùëñ ‚àíùúá¬Ø) whenthe subgroupscomposedbyconjunctionswithatmostùëßconditionsoverùëë
conditionaldistributionv‚àºùëà(ùêµ(ùëò))isconsidered,intermsofthe continuousfeatures.Then,withprobabilityatleast1‚àíùõø,ùëÇcontains
expectationofthemaximumobservedvalueofthepatternquality allpatternswithqualityqP satisfying
accordingtotheresampleddistributionv ‚àº ùêº(ùúá¬Ø).Then,thefol- ‚àöÔ∏Ñ ‚àöÔ∏Ñ
l do ew vii an tg ior nes iu nlt thp ero uv pe ps et rh ba ot ut nh dee as bt oim vea it sio vn erùëëÀú y(R ac‚òÖ c, uùúáÀá r) ato ef .theexpected
qP ‚â•
2ùúîÀÜùëßln ùëö(ùëí3 4ùëë ùëßùëö 32)
+
ln 2ùëê(cid:0) ùëöùõø2(cid:1) +ùëßln(cid:0) 3ùëí ùëö3 4ùëë ùëßùëö 32(cid:1)
Theorem6. Withprobabilityatleast1‚àíùõø/4overR‚òÖ,itholds ‚àöÔ∏Ñ 2ùúîlog(cid:0)4(cid:1) ‚àöÔ∏Ñ log(cid:0)4(cid:1) ‚àöÔ∏Ñ 2fÀÜ(D)ùëßln(ùëí3ùëëùëö2)
+ ùõø + ùõø + 2ùëß3ùõø ,
v‚àºùêºE
(ùúá¬Ø)(cid:34)
Ps ‚ààu Lp
‚òÖùëö1 ‚àëÔ∏Å
ùëñùëö
=1ùëì P(ùë† ùëñ)(vùëñ
‚àíùúá¬Ø)(cid:35) ‚â§ùëëÀú(R‚òÖ,ùúáÀá)+‚àöÔ∏Ñ
lo 2g
ùëê(cid:0) ùëöùõø4(cid:1)
. wherefÀÜ(D)=sup
Pùëö ‚ààLfP(D)a2 nùëê dùëö
ùúîÀÜ
=ùúáÀÜ(1‚àíùúáÀá)fÀÜ(Dùëö
).
4.2 FSRforUnconditionalTesting
Bycombiningtheresultsabove,weprovetheguaranteespro-
videdbyFSRforthetaskoffindingsignificantpatternswhencondi- We now describe the details of procedures boundTarget and
tionaltestingisused.Inparticular,thefollowingCorollaryproves boundStatisticfortheversionof FSRthatusesunconditional
that,whenboundStatisticreturnsthevalueùúÄdefinedbelow,then
testing,whichwerefertoasFSR-U.Asareminder,inourscenario
theoutputsetùëÇofsignificantpatternsreturnedbyFSRhasFWER
anunconditionaltestassumesthattheaveragetargetvalueand
boundedbytheuser-definedparameterùõø.
patternsfrequenciesfP(D)areobservationsofrandomvariables,
Corollary7. Fixùõø ‚àà (0,1)andùëê ‚â•1.LetùëÇbetheoutputofFSR whoseexpectedvaluesareunknown.Inparticular,hereweconsider
withinputparametersL,D,ùëê,ùõø,andlet thetransactions{(ùë† 1,‚Ñì 1),...,(ùë† ùëö,‚Ñì ùëö)}constitutingthedatasetD
asi.i.d.samplesfromanunknowndistributionùõæ.Thisscenariois
‚àöÔ∏Ñ ‚àöÔ∏Ñ
2ùúîlog(cid:0)4(cid:1) log(cid:0)4(cid:1) morecomplexthantheconditionaltestingone,sinceweneedto
ùúÄ =ùëëÀú(R‚òÖ,ùúáÀá)+
ùëö
ùõø + 2ùëêùëöùõø
accountfortheunknowndeviationofallobservedvalueswhen
computingaboundtothemaximumpatternqualityunderthenull
bethevaluereturnedbyboundStatisticinline7.Then,thesetùëÇ
hypothesis.However,weshowthattheuseofresampleddatasets
hasFWER‚â§ùõøundertheconditionalnulldistribution.
allowustoefficientlytakeintoaccountsuchdeviations.
NotethatthevalueofùúÄreturnedbyboundStatisticrequires ForboundTarget,recallthatùúáisthetheprobabilitythatasample
tocomputesup
P‚ààL(cid:8) q¬ØP(D‚òÖ ùëó,ùúáÀá)(cid:9)
,whichiscostly,butonlyneeds
fromtheunknowndistributionùõæ hastargetlabel‚Ñìequalto1,such
tobeperformedonùëêresampleddatasets.Aswewillshowinour thatùúá=E D[ùúá(D)] =Pr(ùë†,‚Ñì)‚àºùõæ (‚Ñì =1).Moreimportantly,inthis
experimentalevaluation(seeSection5),smallvaluesofùëê suffice. settingùúáisunknown(asùõæ is).However,giventhatthesamplesin
Moreover,themaximumfrequencyofapatterninthelanguage
Darei.i.d.,thefollowingresultprovidesaprobabilisticboundùúÄ
ùëá
Lisrequiredinordertocomputeùúî (seeTheorem4).Suchmax- tothedeviationoftheobservedvalueùúá(D)fromitsexpectationùúá.
imumfrequencycanbecomputedveryefficientlyinmostdata Lemma9. LetDbeacollectionofùëösamplestakeni.i.d.fromùõæ.
miningtasks.Forexample:initemsetminingitcorrespondstothe Forùõø ‚àà (0,1),itholdswithprobability‚â•1‚àíùõø/4
frequencyofthemostfrequentitem;insubgroupmining,itisequal
to1wheneveracontinuousfeatureispresentandtheconditions (cid:118)(cid:116) 2min(cid:8)ùúá(D),1(cid:9) ln(cid:16) 8(cid:17) 2ln(cid:16) 8(cid:17)
defi Pn owin eg rt ah ne ap lya st it se .r Tn hl ean reg su ua lg tse aL boi vn ecl su hd oe win theq atua Fl Si Rtie rs i.
gorouslycon-
|ùúá(D)‚àíùúá| ‚â§ùúÄ ùëá (cid:17) ùëö 4 ùõø + ùëöùõø .
trolstheprobabilityoffalsepositives(i.e.,patternsforwhichthe boundTargetreturnsthevalueùúÄ ùëá asdefinedinLemma9,which
nullhypothesisholdbutarewronglyreportedinoutputassig- requiresthevaluesùúá(D),ùõø,andùëö.
nificant).However,theydonotprovideguaranteesonthepower ForboundStatistic,thecomputationoftheupperboundùúÄto
of FSR, that is, its ability to report patterns P with sufficiently themaximumdeviationbetweentheobservedpatternqualitiesand
highqualityqP.Thefollowingresultprovidesguaranteesonthe theirexpectationsismoreinvolvedthanintheconditionalcase.We
powerofFSR-C,theversionofFSRthatusesconditionaltesting, showthatthequalityqP ofapatternP,whichdependsonseveral
forthepatternlanguageofsubgroups.Ouranalysisisbasedona unknownquantities(seeSection3.1),canbesharplyestimatedfrom
probabilisticupperboundtoùëëÀú(R‚òÖ,ùúáÀá),obtainedfromboundstothe adatasetDprovidedthatùúáisknown,whichisnotthecaseforthe
pseudodimension[24,35,38]ofsubgroups,andanadvancedcon- unconditionaldistribution.Wethenshowthatusingùúá(D)inplace
centrationboundforsumsofdependentrandomvariables[13],that ofùúáprovidesagoodestimateofqP,andproveaprobabilisticupper
holdundermild(butnecessary)assumptionsonthedistribution boundonthedifferencebetweenthetwoestimates.
ofalternativehypotheses(thesetofpatternswithqP >0).More First,weintroducethefunctionfamilythatweusetoanalyze
precisely,weassumethatthetargetlabelsofthetransactionsthat thesupremumdeviationoftheempiricalqualityofpatternsfrom
supportapatternP withqP > 0aredistributedaccordingtoa thedatasetD.Wedefinethefamilyoffunctionsùëî‚àó
P
:X√ó{0,1}‚Üí
noncentralhypergeometricdistribution[42],i.e.,abiasedversionof [‚àíùúá,1‚àíùúá],whereùëî‚àó
P
isdefinedasùëî‚àó P(ùë†,‚Ñì) = ùëì P(ùë†)(‚Ñì‚àíùúá).Note
thestandardhypergeometricdistribution.Weprovidetheproofs thatùëî‚àó P(ùë†,‚Ñì) = ùëì P(ùë†)(‚Ñì‚àíùúá)correspondstothefunctionùëî P(ùë†,‚Ñì)
andadditionaldetailsinAppendixA.5. usedbytheFSRstatisticwheretheunknownvalueùúá isusedin
8placeofitsestimate ùúá(D) obtainedfromdataset D.Definethe Withprobabilityatleast1‚àíùõøoverthechoiceofDandR‚òÖitholds
estimatorqP(D)ofthequalityqP ofPfromDastheaverageof sup P‚ààL‚òÖ{qP(D)}‚â§ùúÄ.
ùëî‚àó overD,thatis
P Weusethefollowingsimpleupperboundforbothùúà ùëá andùúà:ùúà ùëá =
qP(D)= ùëö1 ‚àëÔ∏Åùëö ùëî‚àó P(ùë† ùëñ,‚Ñì ùëñ). ùúà refi= ns eu dp b|ùë• o‚àí uùúá n( dD s) a| r‚â§ eùúÄùëá poùë• s( s1 ib‚àí le,ùë• w), ea on md in to thte emtha tot iw mh pi rle ovs elig reh at dly abm ilo itr ye
.
ùëñ=1
NotethatTheorem11doesnotrequiretheknowledgeofthe
NotethatE D[qP(D)] = qP,asqP(D) isanunbiasedestima- unknown parameter ùúá, but only of an upper bound ùúáÀÜ and of a
torofqP.However,qP(D) dependsontheunknownquantity lowerboundùúáÀá.Theorem11allowstoimplementtheprocedure
ùúá. Even if qP(D) ‚â† q¬ØP(D) (since ùúá(D) may be ‚â† ùúá), FSR-U boundStatisticfortheunconditionalsetting:boundStatistic
exploitsthefactthatùúá(D) issharplyconcentratedaroundùúá,as computesùúÄasinEq.(5).Analogouslytotheconditionalcase,evalu-
proved in Lemma 9. This implies that the maximum deviation atingùúÄrequirestocomputesup P‚ààL(cid:8) q¬ØP(D‚òÖ ùëó,ùúáÀá)(cid:9) ,whichiscostly,
sup P‚ààL|qP(D)‚àíq¬ØP(D)|forallpatternsP ‚ààLcanbesharply butonlyneedstobeperformedonùëêresampleddatasets,andùëêisin
estimatedfromD.Tothisaim,weprovethefollowingresult. practicesmall(asweshowinSection5).
Theorem10. LetDbeacollectionofùëösamplestakeni.i.d.from Bycombiningtheresultsinthissection,weprovetheguarantees
ùõæ.Forùõø ‚àà (0,1),withprobability‚â•1‚àíùõø/4itholds providedbyFSRforthetaskoffindingsignificantpatternswhen
unconditionaltestingisused.Inparticular,thefollowingCorollary
|qP(D)‚àíq¬ØP(D)| ‚â§ùúÄ ùëáfP(D),‚àÄP ‚ààL. provesthat,whenboundStatisticreturnsthevalueùúÄdefinedin
Eq. 5, then the output setùëÇ of significant patterns returned by
Proof. UsingLemma9,‚àÄP ‚ààLitholdswithprob.‚â•1‚àíùõø/4 FSR-UhasFWERboundedbytheuser-definedparameterùõø.
(cid:12) ùëö ùëö (cid:12)
|qP(D)‚àíq¬ØP(D)|=(cid:12) (cid:12)
(cid:12)
(cid:12)ùëö1 ‚àëÔ∏Å ùëñ=1ùëî‚àó P(ùë† ùëñ,‚Ñì ùëñ)‚àí ùëö1 ‚àëÔ∏Å ùëñ=1ùëî P(ùë† ùëñ,‚Ñì ùëñ)(cid:12) (cid:12)
(cid:12)
(cid:12)
FSRC wor ito hl il na pr uy t1 p2 a. raF mix eùõø ter‚àà sL(0 ,,1 D) ,a ùëên ,d ùõøùëê ,a‚â• nd1. leL te ùúÄt aùëÇ sb ine Eth qe .o (5u )t .p Tu ht eo nf
,
(cid:12) ùëö (cid:12) thesetùëÇhasFWER‚â§ùõøundertheunconditionalnulldistribution.
(cid:12)1 ‚àëÔ∏Å (cid:12)
=(cid:12)
(cid:12)ùëö
ùëì P(ùë† ùëñ)(ùúá(D)‚àíùúá)(cid:12) (cid:12)‚â§ùúÄ ùëáfP(D). ‚ñ°
Poweranalysis.Thefollowingresultprovidesguaranteesonthe
(cid:12) ùëñ=1 (cid:12) powerofFSR-U,theversionofFSRthatusesunconditionaltesting,
WeremarkthatthedefinitionofqP(D)iscrucialtotheanalysis
buildingontheprobabilisticupperboundtoùëëÀú(R‚òÖ,ùúáÀá)
provedin
ofouralgorithmFSR-U,asqP(D)isanaverageofùëöindependent AppendixA.5,andonconcentrationboundsbasedonthepseudodi-
randomvariables,whileq¬ØP(D)isnot(sinceitdependsonùúá(D), mensionofthelanguageofsubgroups.
thatisestimatedfromtheobservationsinthewholedataset).
RecallthedefinitionofthesetL‚òÖ
ofnon-significantpatterns:
Theorem13. Fixùõø ‚àà (0,1)andùëê,ùëß ‚â• 1.LetùëÇ betheoutputof
L‚òÖ ={P ‚ààL:qP =0}.Tooutputsignificantpatternswhilecon- F ofSR suw bgit rh ouin pspu cot mpa pr oa sem de bte yrs coL nj, uD nc, tùëê io, na sn wd iùõø th,w ath mer oe sL tùëßi cs ot nh de itl ia on ng su oa vg ee
r
trollingtheFWERbelowùõø,ourgoalistoboundthesupremumdevi-
ationsup P‚ààL‚òÖ{q¬ØP(D)}(Eq.(2))belowsomevalueùúÇwithproba-
ùëë ùúÄbc eon dt ei finu no edus af se ia ntu Tr he es. orD ee mfin 1e 1,ùúîÀÜ w= heùúá rÀÜ e(1 ùëüÀÜ‚àí isùúáÀá re) ps lu ap
ceP d‚àà bL
yfP(D),andlet
bilityatleast1‚àíùõø,forsomeùõø ‚àà (0,1),andprovideinoutputallpat-
ternswithq¬ØP(D) ‚â•ùúÇ.Tobound(2),westudythesurrogatequan- ‚àöÔ∏Ñ 2ùúîÀÜùëßln(ùëí3ùëö2ùëë ) ‚àöÔ∏Ñ ln(3) ùëßln(ùëí3ùëö2ùëë ) ‚àöÔ∏Ñ ln(cid:0)4(cid:1)
t o oi n fty ùëê|qs ‚â•u Pp 1(P D i.i‚àà .) dL ‚àí .‚òÖ rq¬Ø e{ P sq a( mP D( p)D l| e. d) C} do, ana tss ai sT d eeh tr se to ch or ee mm c po ul1 l te0 ec dg tiu boa ynr Fa R Sn ‚òÖ Rte = (e ls in(cid:8)a eDs 41‚òÖm ).,a W.l .l e.b , po D ru oùëê‚òÖn vd (cid:9)
e
Theùëü nÀÜ ,=
definefP
ùëö
=
E4ùëß D3 [fP+ (D)]2 .ùëê Wùëöùõø ith+ proba3 bùëö4 ilùëß i3 tyat+ least2ùëê 1ùëöùõø ‚àíùõø.
,ùëÇ
thefollowingresult.
containsallpatternsPwithqualityqP satisfying
‚àöÔ∏Ñ ‚àöÔ∏Ñ
a
dT ish tre io br ue tim on11 ùõæ.
,
aL net dD R‚òÖbe aa cd oa llt ea cs te iot nof oùëö fùëêsa ‚â•mp 1le is .it .da .ke ren sai. mi.d p. lf er som
of qP ‚â•ùúÄ+2ùúÄ
ùëá(cid:32)
fP+
ùëßln(cid:0)2ùëí ùëßùëë 2ùëö(cid:1)+ln(cid:0) ùõø3(cid:1)(cid:33)
+
ùëßln(cid:0)2ùëí ùëßùëë 2ùëö(cid:1)+ln(cid:0) ùõø3(cid:1)
.
thetargetlabelsof D.Foranyùõø ‚àà (0,1),defineùúà ùëá ‚â• ùúá(1‚àíùúá),
ùúà ‚â•ùúà ùëá sup P‚ààL‚òÖ{E D[fP(D)]},andùúÄas 5 EXPERIMENTS
ùëê
ùëëÀú(R‚òÖ,ùúáÀá)= ùëê1‚àëÔ∏Å sup(cid:8) q¬ØP(D‚òÖ ùëó,ùúáÀá)(cid:9) T ouh ris es xe pc et rio imn ep nr te as le en vts alt uh ae tir oe nsu islts too af so su er sse Fx Sp Rer ‚Äôsim cae pn ats b. iT lith iee sg oo fa dl io sf
-
ùëó=1P‚ààL
coveringsignificantpatternswithhighstatisticalpower,analyzing
‚àöÔ∏Ñ
ln(cid:0)4(cid:1) efficientlylargereal-worlddatasetswithfew-shotresampling,in
ùëüÀÜ=ùëëÀú(R‚òÖ,ùúáÀá)+ ùõø
bothconditional(FSR-C)andunconditional(FSR-U)settings.
2ùëêùëö
PatternLanguage.Inourexperimentalevaluationwefocusonthe
ùëëÀÜ=ùëüÀÜ+(cid:118)(cid:117)(cid:116)(cid:32)
2ùúà
ùëá
ln(cid:0) ùõø4(cid:1)(cid:33)2
+
2ùëüÀÜln(cid:0) ùõø4(cid:1)
+
2ùúà
ùëá
ln(cid:0) ùõø4(cid:1) p daro tab sl ee tm swof itd his mco ixv ee dri fn eg ats ui rg en ti yfi pc ea snt (bs ou tb hg cro au tep gs of rr io cm alala nr dge cor nea til n-w uoo url sd
).
ùëö ùëö ùëö
ThelanguageLiscomposedofconjunctionsofuptoùëßconditions
ùúÄ
(cid:17)ùëëÀÜ+(cid:118)(cid:116) 2ln(cid:0) ùõø4(cid:1)(cid:16) ùúà+2ùëëÀÜ(cid:17)
+
ln(cid:0) ùõø4(cid:1)
. (5)
o lon wt )h .e Thfe ea st eu cr oes ndo if tit oh ne sd aa rt ea e[ i4 th], ew reh qe ure alùëß itii es sa (ffi ox re cd atp ea gr oa rm ice at le fr e( as te ue reb se )-
,
ùëö 3ùëö inequalities,orintervals(oncontinuousfeatures).
9Datasets.WetestedFSRon12standardbenchmarksandreal- Table1:Statisticsofthedatasetsconsideredinourexper-
iments.ùëö is the number of transactions,ùëë is the number
worlddatasetstoevaluatesubgroupdiscoveryalgorithmsfrom
UCI2.ThestatisticsofthedatasetsaredescribedinTable1.These offeatures(categorical/continuous),ùúá(D)isthefractionof
datasetscoverawiderangeofsizes,dimensionalities,andappli-
transactionswithtargetequalto1,ùëßisthemaximumnumber
cationdomains.Thecolumnùëß ofTable1reportsthemaximum ofconjunctiontermsinthelanguageL.
numberofconjunctiontermsforthesubgroupsinthelanguageL
foreachdataset. D ùëö ùëë ùúá(D) ùëß
ImplementationofFSR.WeimplementedFSRinPython.Thecode
andthescriptstoreproduceallexperimentsareavailableonline3. abalone 4177 1/7 0.663 5
Tominesubgroups,wemakeuseofafastdepth-firstenumeration adult 32561 8/6 0.241 5
algorithmincludedinthelibrarypysubgroup4[23]. bank 41188 10/10 0.113 3
Baselines.SinceouralgorithmFSRisthefirstalgorithmthatcan brain-cancer 862 22/1 0.421 5
beusedforminingsignificantpatternswithbothconditionaland cancer-rna-seq 801 0/20531 0.375 2
unconditionaltesting,weconsiderdifferentbaselinesforcondi- covtype 581012 0/54 0.365 3
tionaltestingandforunconditionaltesting. gisette 7000 0/5000 0.500 2
Forconditionaltesting,wecompareFSR-Cwithavariantof HIGGS 11000000 0/28 0.529 3
TopKWY[33],thestate-of-the-artmethodforsignificantpattern kdd-cup 95370 73/405 0.050 2
miningwithconditionaltesting,basedontheWYpermutation mushroom 8124 22/0 0.482 5
testingprocedure[46].TheoriginalimplementationofTopKWY SUSY 5000000 0/18 0.457 3
isonlytailoredtoidentifysignificantitemsetsandsubgraphs,and theorem-prover 3059 0/51 0.420 3
doesnotsupportsubgroupsfromcategoricalandcontinuousfea-
tures;however,wenotethatitisfairlysimpletoadaptitsstrategy
tosuchcase.Inparticular,weextendedTopKWYtoidentifysig- upperboundthesupremumdeviationintermsofitsexpectation
nificantsubgroupsbyestimatingthedistributionofthesupremum (takenw.r.t.theresamplesbutconditionallyonthetransactions,
deviationusingpermuteddatasets(insteadoftheùëù-valuesasdone seeTheorem11andAppendixA.6),butinsteadofestimatingthe
intheoriginalTopKWYimplementation[33]).Thatis,ourvariant expectedsupremumdeviationwithùëêresamples(asdonebyFSR-U),
ofTopKWYconsidersthesamestatisticof FSR-C(i.e.,thesupre- wecomputeanupperboundtoitviaanunionboundoverthe
mumdeviation),butinsteadofgeneratingresamplesandtaking (finite)numberofdistinctsubgroupsthatareobservedinthedatain
theaverageofsupremumdeviationsasdonebyFSR-C,itefficiently atleastonetransaction,i.e.,weconsiderthefiniteprojectionofLon
computesitsùõø-quantilesconsideringpermutationsofthelabels.In D,insteadofall |L|possiblesubgroups.Notethatsuchapproach
addition,inourvariantofTopKWYweusepysubgrouptomine boundstheFWERwhilebeingmuchlessconservativethanBonfer-
subgroups.NotethatsinceourvariantofTopKWYandFSR-Cshare roni,sinceitcorrectsforthesizeoftheprojectioninsteadofthe
thesame,equallyoptimized,proceduretoexplorethesearchspace sizeofL.BycomparingFSR-UtoFSR-U-UBwedirectlyevaluate
ofthelanguageL,allcomparisonsintermsofrunningtimesare theadvantageofcomputingboundsfromresampleddatasetsthat
fair.ForTopKWYweuse103 permutations,agoodtrade-offin considerdependenciesamongpatterns,asdonebyFSR-U.
termsofrunningtimeandaccuracyforestimatingtheùõø-quantile Experimentalsetup.Alltheexperimentswererunonamachine
fortypicalvaluesofùõø(e.g.,0.05)[25]. with2.30GHzIntelXeonCPU,512GBofRAM,onUbuntu20.04.
Regardingunconditionaltesting,wenotethatFSR-Uisthefirst Inallexperimentsweuseùõø =0.05(i.e.,wecontroltheFWERbelow
methodtodiscoversignificantpatternsina(fully)unconditional 0.05).Werepeatedallexperiments10times,andreportaverages¬±
setting.Therefore,abaselinethatmayseemreasonabletocontrol stdsoverthe10repetitions.
theFWERisthestandardBonferronicorrection:eachpatternPis ImpactofparametersonFSR.Inthefirstsetofexperimentswe
flaggedassignificantiftheprobability(underthenullhypothesis) evaluatetheeffectofthenumberofresamplesùëêonthedeviation
ofobservingaqualitygreaterorequalthantheonemeasuredin boundùúÄcomputedbyFSRanditsrunningtime.Weconsiderboth
thedataisatmostùõø/|L|,where |L| isthesizeofthelanguage FSR-CandFSR-U,respectivelydesignedtocomputesignificant
L(seealsoSection1).Note,however,thatthissimplemethodis patternswithconditionalandunconditionaltesting.Toeasethe
notusefulforsubgroupsas|L|isinfinite(e.g.,asthenumberof presentation,forthisfirstexperimentwefocuson3ofthedatasets
inequalitiesoveracontinuousfeatureisunbounded)5.Therefore, weconsidered;theresultsfortheotherdatasetsareverysimilar.
wecompareFSR-Uwithanovelnon-trivialbaseline,thatwecall InFigure1-(a)weshowthedeviationboundscomputedbyFSR-C
FSR-U-UB,thatresolvesthisissue.WedescribeFSR-U-UBathigh fordifferentvaluesofùëê,whileFigure1-(b)isanalogousforFSR-U.
levelanddeferadditionaldetailstoAppendixA.6.ForFSR-U-UB, Fromtheseplotsweclearlyconcludethatusingùëê =10resamples
weusepartoftheconcentrationboundsdevelopedforFSR-Uto issufficienttoobtainasmalldeviationbound,andthatusingmore
than 10 resamples is marginally beneficial as all curves flatten.
2https://archive.ics.uci.edu/ Remarkably,foralldatasets(andinparticularforthelargerdataset
3https://github.com/VandinLab/FSR adult),andforbothmethods,evenusingoneresampleisenoughto
4https://github.com/flemmerich/pysubgroup computeameaningfuldeviationbound.Thisisinstrikingcontrast
5Weremarkthat,whilethereexistothercorrectionproceduresmorepowerfulthan
withstate-of-the-artmethodsbasedonpermutationtesting,that
Bonferroni(e.g.,theHolmprocedure),theyallrequiretofixafinitesetofhypothesis,
thereforedonotapplytooursetting. insteadrequireanumberof103-104 permutationsofthetarget
10Deviation bounds for FSR-C Deviation bounds for FSR-U Running times for FSR-C Running times for FSR-U
0.10 m adu us lh troom 0.10 m adu us lh troom
104
m adu us lh troom
104
m adu us lh troom
abalone abalone abalone abalone
0.08 0.08 103 103
0.06 0.06 102 102
0.04 0.04 101 101
0.02 0.02 100 100
101 101
100 101 102 100 101 102 100 101 102 100 101 102
Number c of resamples Number c of resamples Number c of resamples Number c of resamples
(a) (b) (c) (d)
Figure1:Effectofthenumberofresamplesùëêonthedeviationbounds(a)-(b)andrunningtimes(c)-(d)forFSRalgorithms.
1.0
FSR-C TopKWY
101
Deviation bounds 106 0.8 Running times 500N 0umber of top-k patterns in output (k=5000) 10N 00u 0mber of top-k patterns in output (k=10000)
105 4000 8000
104 0.6 3000 6000
102 103 2000 4000
102 0.4 1000 2000
103
101 0 0
0.2
0.0
0.0 0.2 0.4 0.6 0.8 1.0
(a) (b) (c) (d)
Figure2:ComparisonofFSR-CwithTopKWYintermsofdeviationbounds(a),runningtimes(b),andnumberofresults(c)-(d).
1.0
FSR-U FSR-U-UB
Deviation bounds 106 0.8 Running times 500N 0umber of top-k patterns in output (k=5000) 10N 00u 0mber of top-k patterns in output (k=10000)
101 104 4000 8000
0.6
3000 6000
102 102 2000 4000
100 0.4 1000 2000
103 102 0 0
0.2
0.0
0.0 0.2 0.4 0.6 0.8 1.0
(a) (b) (c) (d)
Figure3:ComparisonofFSR-UwiththebaselineFSR-U-UB(AppendixA.6)intermsofdeviationbounds(a),runningtimes(b),
andnumberofresults(c)-(d).
labelstoproperlyestimatetheùõø-quantile.Furthermore,weobserve intermsofrunningtime.WealsoobservethatFSR-Uisfasterthan
thatthedeviationboundscomputedbyFSR-C,intheconditional FSR-Cforallvaluesofùëê.ThisisduetothefactthatFSR-C,by
setting,aresmallerthantheboundscomputedbyFSR-U,forthe computingasmallerdeviationbound,exploresawiderportionof
unconditionalscenario;thisconfirmsthefactthattheassumptions thepatternlanguageL.Inanycase,usingatmost10resamplesis
made on the process generating the data have a sensible effect alwaysfeasible(sincebothalgorithmsterminateafteratmost17
onthisaspect,aconsequenceofproperlytakingintoaccountthe minutesforthesedatasets).Fromtheseobservation,wefixùëêto10
uncertaintyofthecollecteddata. forFSR-CandFSR-Uinallourexperiments.
Figures 1-(c)-(d) show the running time of the two methods EvaluationofFSR-C.Inthisexperimentwereporttheperfor-
FSR-CandFSR-Uasfunctionsofùëê.Notsurprisingly,weclearly manceof FSR-Ctoidentifysignificantpatternswithconditional
observethattherunningtimeincreaseslinearlywiththenumberof testing,comparingitwithavariantofTopKWY,thestate-of-the-art
resamplesùëêforbothmethods.Therefore,weexpectthatprocessing methodtoidentifysignificantpatternswithpermutationtesting.
asmallnumberofresampleddatasetsisextremelyadvantageous InFigure2weshowthedeviationbounds(a),therunningtimes
11
enolaba
enolaba
tluda
tluda
knab
knab
recnac-niarb
recnac-niarb
qes-anr-recnac
qes-anr-recnac
epytvoc
epytvoc
ettesig
ettesig
SGGIH
SGGIH
puc-ddk
puc-ddk
moorhsum
moorhsum
YSUS
YSUS
revorp-meroeht
revorp-meroeht
)s(
emit
gninnuR
)s(
emit
gninnuR
enolaba
enolaba
tluda
tluda
knab
knab
recnac-niarb
recnac-niarb
qes-anr-recnac
qes-anr-recnac
epytvoc
epytvoc
ettesig
ettesig
SGGIH
SGGIH
puc-ddk
puc-ddk
moorhsum
moorhsum
YSUS
YSUS
revorp-meroeht
revorp-meroeht
)s(
emit
gninnuR
tuptuo
ni
snrettap
k-pot
fo
rebmuN
tuptuo
ni
snrettap
k-pot
fo
rebmuN
enolaba
enolaba
tluda
tluda
knab
knab
recnac-niarb
recnac-niarb
qes-anr-recnac
qes-anr-recnac
epytvoc
epytvoc
ettesig
ettesig
SGGIH
SGGIH
puc-ddk
puc-ddk
moorhsum
moorhsum
YSUS
YSUS
revorp-meroeht
revorp-meroeht
)s(
emit
gninnuR
tuptuo
ni
snrettap
k-pot
fo
rebmuN
tuptuo
ni
snrettap
k-pot
fo
rebmuN
enolaba
enolaba
tluda
tluda
knab
knab
recnac-niarb
recnac-niarb
qes-anr-recnac
qes-anr-recnac
epytvoc
epytvoc
ettesig
ettesig
SGGIH
SGGIH
puc-ddk
puc-ddk
moorhsum
moorhsum
YSUS
YSUS
revorp-meroeht
revorp-meroeht(b),andthenumberofreportedresults(c)-(d)forbothalgorithms. time(b),andnumberofresults(c)-(d).FromFigure3-(a)weclearly
FromFigure2-(a),weobservethatthedeviationboundscomputed observethatFSR-Ucomputesdeviationboundsthatarealways
byFSR-CarelargerthantheonescomputedbyTopKWY.Thisis smallerthanFSR-U-UB.Weconcludethatprocessingtheresamples
notsurprising,asthedeviationboundreturnedbyTopKWY,that ofthetargetlabelprovidesmuchmoreaccuratedeviationbounds
isbasedontheWYprocedure,isaveryaccurateestimateofthe w.r.t.morestandardtechniques(i.e.,aBonferronicorrection).This
optimal correctedthreshold to boundthe FWER (since the WY isaconsequenceoftakingintoaccountthedependenciesamong
estimatorconvergesasymptoticallytoit[28]);ontheotherhand, patternswhenupperboundingtheexpectedsupremumdeviation.
FSR-Ccomputesanupperbound tosuchquantitywithstronger Intermsofrunningtime,FSR-Ualwaysconcludeinreasonable
probabilisticguarantees(i.e.,thebounddoesnotonlyconverge time(similarlytoFSR-C),whileFSR-U-UBisfaster(sinceitdoes
asymptoticallyandinexpectation,butratherholdsinfinitesamples notconsideranyresamples).Ontheotherhand,inmanycases
withhighprobability).Whilethedeviationboundscomputedby thebaselineFSR-U-UBterminatesquicklybutwithoutreporting
TopKWYaresmallerthanFSR-C,fromFigure2-(b)weobservea anythingin output:Figures 3-(c)-(d) showthat for 5 datasetsit
significantgapintermsofrunningtimebetweenthetwomethods. doesnotreportsignificantpatterns,whilefortheotherdatasetsit
Infact,TopKWYrequirestwoordersofmagnitudemoretimethan outputsasignificantlysmalleramount(e.g.,foradult,FSR-Ufinds
FSR-Ctocomputeitsdeviationbound;thisismainlyduetothe almostanorderofmagnitudemoreresultsthanFSR-U-UB).This
factthatTopKWYhastoprocesstwoordersofmagnitudemore experimentshowsthatFSR-Uisapracticalandpowerfulmethod
permutationsofthetargetlabelthanFSR-C.Notethatusing104 todiscoversignificantpatternswithunconditionaltesting,andthat
permutations(insteadof103,tohaveamoreaccurateestimationof itsignificantlyimprovesovermorestandardtechniquessuchas
theùõø-quantile,asoftendoneinpractice)inTopKWYwouldresult Bonferronicorrection.
inanevenmoresubstantialgap. ApplicationtoNeuralNetworkinterpretation.Inthisfinalexper-
Wenowcomparethetwomethodsintermsofnumberofre- iment we evaluate a practical application of FSR to the task of
portedsignificantpatterns.Todoso,wefollowatypicalsubgroup NeuralNetworkinterpretation[14].Moreprecisely,weconsider
discoveryanalysis,basedonthetaskofidentifyingtheùëòmost‚Äúin- theMNISTdataset[22]andtrainaConvolutionalNeuralNetwork
teresting‚Äùsubgroupsintermsofquality:first,weminethesetof (CNN),withthegoalofidentifyingcorrelationsbetweentheacti-
top-ùëòsubgroupswithhighestquality;then,wecountthenumber vationvaluesofneuronswiththepredictedtarget.Todoso,we
ofthemthatareflaggedassignificantbythetwomethods.Weuse evaluatetheassociationoftheactivationvaluesofneuronsina
ùëò ‚àà {5¬∑103,104}.Figures2-(c)-(d)showthenumberofpatterns convolutionalfilterwithabinarytarget,composedbydrawingsof
thatarereportedinoutputbybothmethods.Weobservethat,for digitscomposedbystraightlinesonly(1and7),versustheotherdig-
ùëò =5¬∑103,for6ofthe12datasetsweconsidered,bothalgorithms its.WhilewedefermostdetailsofthisexperimenttoAppendixA.7,
outputallthetop-ùëò patterns,i.e.,theyhavethesameoutput;for weobservedthatFSRsuccessfullyidentifiesinterpretableactivation
suchdatasetsTopKWYreportsalltop-ùëòpatternsalsoforùëò =104, patternsofseveralneurons,whilerequiringordersofmagnitude
whileFSR-Coutputsthesamesetofresultsforallbuttwodatasets, lesstimethanpreviousmethods(asdiscussedpreviously).
forwhichitreportsmorethan70%ofthem.Fortheremaining6
6 CONCLUSIONS
datasets,whichconsistofthe4largestdatasets(intermsofthe
numberùëöoftransactions)andthe2datasetswithhighestnumber
WepresentedFSR,anovelalgorithmtoidentifystatisticallysig-
offeatures,TopKWYcouldnotcompleteinreasonabletime(i.e.,we nificant patterns with rigorous bounds on the FWER. FSR uses
stoppeditafter10days),whileFSR-Cfinishedtheanalysiswhilere- a few-shot resampling strategy, which leads to an efficient and
turningalargenumberofsignificantresults(i.e.,eitherallthetop-ùëò
practicalapproachthatcanbeusedforbothconditionalandun-
patternsormorethan600ofthemforthekdd-cupdataset).Forthe conditionaltesting.OurexperimentalevaluationshowsthatFSRis
mostchallengingdatasets(HIGGS,with11millionstransactions, aneffectiveandaccuratemethodforsignificantpatternsdiscovery,
andcancer-rna-seq,with>104continuousfeatures),FSR-Ccon-
whilesignificantlyreducingthecomputationalcostofstate-of-the-
cludesafter5days,whileTopKWYwouldrequire(approximately) artmultiplecomparisonsprocedures,suchaspermutationtesting,
1.5yearsofcomputation.Therefore,insuchcasesFSR-Cenables
thathardlyscaletheanalysistocomplexlanguages,suchassub-
theanalysisofthesechallenginginstanceswhileidentifyingmany groups,andlargedatasets.Whiletheexperimentspresentedinthis
significantpatterns.TheseresultsconfirmthatFSR-C,whilepro- workarefocusedonsubgroups,weexpecttherelativeimprove-
vidingaslightlymoreconservativeupperboundtothesupremum mentsobtainedbyFSRtodirectlytransfertootherpatterntypes,
deviation,isstillcapableofdiscoveringthesame(oralmostthe giventhegeneralityofourframeworkandofthedesignofour
same)mostsignificantpatterns,whilebeingmorethantwoorders resamplingprocedures,whicharesharedbyalltypesofpatterns.
ofmagnitudefaster,andreportingmanypatternsassignificant
forchallenginginstancesoutofreachforthestate-of-the-art.We ACKNOWLEDGMENTS
concludethatFSR-Cprovidesanexcellenttrade-offbetweenthe
Thisworkwassupportedbythe‚ÄúNationalCenterforHPC,Big
numberofpatternsidentifiedassignificantandthecomputational
Data,andQuantumComputing‚Äù,projectCN00000013,andbythe
requirementoftheanalysis.
PRINProjectn.2022TS4Y3N-EXPAND:scalablealgorithmsfor
EvaluationofFSR-U.WenowevaluatetheperformanceofFSR-U
EXPloratoryAnalysesofheterogeneousanddynamicNetworked
todiscoversignificantpatternswithunconditionaltesting.Weshow
Data,fundedbytheItalianMinistryofUniversityandResearch
theresultsinFigure3.WecompareFSR-UwiththebaselineFSR-
(MUR).
U-UB(describedabove)intermsofdeviationbounds(a),running
12REFERENCES
[25] FelipeLlinares-L√≥pez,MahitoSugiyama,LaetitiaPapaxanthos,andKarsten
[1] CharuCAggarwal,YaoLi,PhilipSYu,andRuomingJin.2010.Ondensepattern Borgwardt.2015.Fastandmemory-efficientsignificantpatternminingviaper-
miningingraphstreams. ProceedingsoftheVLDBEndowment3,1-2(2010), mutationtesting.InProceedingsofthe21thACMSIGKDDinternationalconference
975‚Äì984.
onknowledgediscoveryanddatamining.725‚Äì734.
[2] RakeshAgrawal,TomaszImieli≈Ñski,andArunSwami.1993.Miningassociation [26] MaartenL√∂fflerandJeffMPhillips.2009.Shapefittingonpointsetswithproba-
rulesbetweensetsofitemsinlargedatabases.InProceedingsofthe1993ACM bilitydistributions.InAlgorithms-ESA2009:17thAnnualEuropeanSymposium,
SIGMODinternationalconferenceonManagementofdata.207‚Äì216. Copenhagen,Denmark,September7-9,2009.Proceedings17.Springer,313‚Äì324.
[3] MohammadAlHasanandMohammedJZaki.2009.Outputspacesamplingfor [27] ColinMcDiarmid.1989. Onthemethodofboundeddifferences. Surveysin
graphpatterns.ProceedingsoftheVLDBEndowment2,1(2009),730‚Äì741. combinatorics141,1(1989),148‚Äì188.
[4] MartinAtzmueller.2015.Subgroupdiscovery.WileyInterdisciplinaryReviews: [28] NicolaiMeinshausen,MarloesHMaathuis,andPeterB√ºhlmann.2011.Asymp-
DataMiningandKnowledgeDiscovery5,1(2015),35‚Äì49. toticoptimalityoftheWestfall-Youngpermutationprocedureformultipletesting
[5] GABarnard.1945.Anewtestfor2√ó2tables.Nature156,3954(1945). underdependence.TheAnnalsofStatistics(2011),3369‚Äì3391.
[6] YoavBenjaminiandYosefHochberg.1995.Controllingthefalsediscoveryrate: [29] Shin-ichiMinato,TakeakiUno,KojiTsuda,AikaTerada,andJunSese.2014.A
a stap tr ia stc it ci ac la sl oa cn ied typ :o sew rie er sfu Bl (Map ep thro oa dc oh logto icam l)u 5lt 7i ,p 1le (1t 9e 9st 5i )n ,g 2. 89J ‚Äìo 3u 0r 0n .aloftheRoyal f fra es qt um enet th io ted mo sf etst ea nt uis mtic ea ral ta ioss ne .s Is nm Ee Cn Mt Lfo Pr Kc Dom Db 2i 0n 1a 4t .o Sr pia rl inh gy ep r.othesesbasedon
[30] LeonardoPellegrina,CyrusCousins,FabioVandin,andMatteoRiondato.2022.
[7] CarloBonferroni.1936.Teoriastatisticadelleclassiecalcolodelleprobabilita.
PubblicazionidelRIstitutoSuperiorediScienzeEconomicheeCommericialidi MCRapper:Monte-CarloRademacheraveragesforposetfamiliesandapprox-
[8]
F Si tr √©e pn hz ae n8 e( B19 o3 u6 c) h, e3 r‚Äì o6 n2 ,.
G√°borLugosi,andPascalMassart.2013. Concentration
(i Tm Ka Dte Dp )a 1t 6t ,er 6n (2m 02in 2)in ,1g ‚Äì. 2A 9.CMTransactionsonKnowledgeDiscoveryfromData
inequalities:Anonasymptotictheoryofindependence.Oxforduniversitypress. [31] TL ee so tn ina grd ao ndPe Sl tl ae tg ir si tn ica a, llM y-a st ote uo ndR Pio an ttd ea rt no, Ma in nd inF ga .b Inio PV roa cn ed edin in. g2 s01 of9. thH e2y 5p to hth Ae Cs Mis
[9] LeiCao,YizhouYan,SamuelMadden,ElkeARundensteiner,andMathanGopal- SIGKDDInternationalConferenceonKnowledgeDiscovery&DataMining(KDD
s Va Lm Dy B.2 E0 n1 d9 o. wE mffi ec ni te 1n 2t ,d 8is (c 2o 0v 1e 9r ),y 9o 2f 0s ‚Äìe 9q 3u 2e .nceoutlierpatterns.Proceedingsofthe ‚Äô19).ACM,NewYork,NY,USA,3215‚Äì3216.
[32] LeonardoPellegrina,MatteoRiondato,andFabioVandin.2019. SPuManTE:
[10] M Sea rit ete so MC oe tc ifc sa wre il tl ho Pa rn od bJ ao bh ila isn tn icG Ga um arp ae nr t. e2 e0 s2 .2 P. rF oa ces et da in nd gsS oc fa tla hb el Ve LM Di Bni En ng do of wT mim ene t S Ai Cgn Mifi Sc Ia Gn Kt DP Datt Ie nr tn erM nain tii on ng aw lCit oh nU fen rc eo nn cedi ot nio Kna nl oT we ls et din geg. DIn iscP or vo ec re yed &ing Ds ao tf at Mhe in2 i5 nth
g
15,13(2022),3841‚Äì3853. (KDD‚Äô19).ACM,NewYork,NY,USA,1528‚Äì1538.
[11] ChenChen,CindyXLin,MattFredrikson,MihaiChristodorescu,XifengYan,and
[33] LeonardoPellegrinaandFabioVandin.2020.Efficientminingofthemostsignif-
J Pi ra ow cee ei dH ina gn s. o2 f00 th9 e. VM Lin Di Bng Eng dra op wh mp ea nt tte 2r ,n 1s (e 2ffi 00c 9i )e ,n 7t 4ly 2‚Äìv 7ia 53r .andomizedsummaries. icantpatternswithpermutationtesting.DataMiningandKnowledgeDiscovery
34(2020),1201‚Äì1234.
[12] SebastianDalleigerandJillesVreeken.2022.Discoveringsignificantpatterns
u Cn od ne fer rs ee nq cu ee on nti Kal nf oa wls le edd gi esc Dov ise cr oy vec ro yn atr no dl. DIn atP aro Mce ie nd inin gg .softhe28thACMSIGKDD [34] A ton pd -Kre fa reP qie ut er na tca cp lor sin eda ia tn emdF sea tb si .o InVa Inn td erin n. a2 ti0 o0 n7 a. lE Cffi onc fi ee rn et ncin ec or nem De isn ct oa vl em ryin Scin ieg nco ef
.
[13] D foe rv td ha et at nP aD lyu sib sh oa fs rh ai na dn od mA izle edss aa ln gd or ro ithP man sc .o Cn ae msi b. r2 i0 d0 g9 e. UC non ivc ee rn st ir ta yti Po rn eso sf .measure [35] S Dp ar vin idge Pr o, l2 l7 a5 rd‚Äì .2 28 00 1. 2. Convergenceofstochasticprocesses. SpringerScience&
BusinessMedia.
[14] JonasFischer,AnnaOlah,andJillesVreeken.2021.What‚ÄôsintheBox?Exploring
t Inh te erIn nan te ir onL aif le Co of nN fee ru enra cl eN onet Mw ao cr hk is nw ei Lt eh aR rno ib nu gst (PR ru ocle es e. dI in ngP sro ofce Med ai cn hg is neof Lt eh ae rn3 i8 nth
g
[36] M gra ot ut peo swRi io thnd saa mto pa lin nd gF aa nb dio psV ea un dd oi dn i. m20 en20 si. oM n.iS Ao CS Mou TP r: aM nsi an ci tn iog ni sn ote nre Ks nti on wg les du gb e-
Research),Vol.139.PMLR,3352‚Äì3362.
DiscoveryfromData(TKDD)14,5(2020),1‚Äì31.
[15] R tho en ca ald lcA ulaF tis ioh ner o. f19 P2 .2 J. oO urn nt ah le oi fn tt he erp rr oe yt aa lti so tan to isf tiùúí ca2 lsfr oo cm ietc yo 8n 5t ,in 1g (e 1n 9c 2y 2)t .ables,and [37] D Paie ttg eo rnS sa wnt io thro V, CA -n Dd ir mea enT so ion non a, na dn Rd aF da eb mio acV ha en rd Cin o. m2 p0 l2 e0 x. ityM
.
i An li gn og riS the mqu se 1n 3ti ,a 5l
(2020),123.
[16] W souil nh del pm ai ti tn ea rnH d√§ im sc√§ ol v√§i en re yn .Dan atd aG Me io nff inre gy aI nW dKeb nb o. w2 l0 e1 d9 g. eA Dit su coto vr ei ra ylo 33n (s 2t 0a 1ti 9s )t ,ic 3a 2l 5ly
‚Äì
[38] S Frh oa miS Th ha ele ov r- yS th ow Aa lr gt oz ra in thd mS sh .a CiB amen b- rD ida gv eid U.2 n0 iv14 e. rsU itn yde Pr rs et sa sn .dingMachineLearning:
377.
[39] AikaTerada,HanyoungKim,andJunSese.2015.High-speedWestfall-Young
[17] J mia inw ie ni gH :ca un rr, eH no tn stg atC ush ae nn dg, fuD to un reg dX iri en c, tia on nd s.X Di afe tang miY na in ng.2 a0 n0 d7 k. nF or we lq eu dgen et dip sca ott ve er rn y p the erm 6tu hta At Cio Mnp Cr oo nc fe ed ru enre cefo or ng Be in oo inm foe r- mw aid tie csa ,s Cso oc mia pt uio tan tis otu nd alie Bs i. oI ln ogP yro ac nee dd Hin eg as lto hf
15,1(2007),55‚Äì86. Informatics.17‚Äì26.
[18] NguyenThiThaoHo,TorbenBachPedersen,etal.2022. Efficienttemporal
[19]
p
V
Sta
L
ut Dt re eBr Hn
E
onm
ld
mi on
w
.i 1n
m
9g 7eni 9n
.t
Ab 1i 5g
s,
i3t mim
( p2
le
0
e2s s2e e)r
,
qi 6e u7s
e3
nu
‚Äì
ts i6i an
8
llg
5
y.m reu jetu cta il vi en mfo urm ltia pt li eo tn e. stP pro rc oe ce ed di un rg es .o Sf ct ah ne
-
[40] A
t Ais
cik
t
aia
dc
eaT mle
s
yr ia
g
od
n
fa
i
S,
fi
cM
c
ieaa nnr cci ek
e
so
o
1O
f
10ck ,oa 3md 2a
b
(-
i
2H
n
0aa 1tt 3oa )rk ,ie 1ay 2la 9rm
9e
6ga ‚Äìu, 1lK
a
3to
0i
0j oi 1nT .ss .u Pd ra o, ca en ed diJ nu gn sS oe fs te h. e2 N01 a3 t. ioS nt aa l-
dinavianjournalofstatistics(1979),65‚Äì70. [41] M Daa tt ath Mijs inV ina gn aL ne deu Kw ne on wla en dd geA Drn iso coK vn eo rybb 2e 5. (2 20 01 12 2. )D ,2i 0v 8e ‚Äìrs 2e 4s 2u .bgroupsetdiscovery.
[20] K
p
Mru aom
tb
haa er
b
miJ lo aitg
ti
id
e
ce aso
la
Sa
n
tn add tiaS stt ige cp
e
snh 3e
e
9n
r ,a
4M
liz
(1S
a
9a
ti
6m
o
8nu ),e 1ols 1f. 91
R
19
a
‚Äì6
m
18 1.
a
9M
n
5uo .jn ao nt ‚Äôo sn ee qc uo an tv ioe nrg .en Tc he eof Ab ni nn ao lm si oa fl [ [4 42 3]
]
K
p
Gre eon obn ffae
b
ret ilh yityT Ie Wdd
is
etW
bri
bba .ul 2l te 0in
o
0ni 6u
.
.s
T
D. e1
ic
s9
h
c6
n
o3 vi.
c
eaB
rl
ii
R
nas gee
p
sd
o
igrs ta n.m ifihp
t
ctl api nn
s
tg :/:
r/p
uth
u
lee
r
sln
.
.so
It
nn anc Pe
f
ron ort cdr ea
.
eel ddh
iu
ny
/
gp
w
se hr og
0
f5e to
6
hm
v
ej9e 1t
3
2r
4
ti h7c
[21] J ca an lli ys eK xa cl eo pfo til oia ns a, lM yea tri go loB bo al le lyy, ra en pd reJ si ell ne ts aV tir ve ee sk ue bn g. r2 o0 u1 p7 s. .E Inffi 2c 0i 1e 7nt IEly Ed Ei Is nc to ev re nr ai tn iog nl ao l- ACMSIGKDDinternationalconferenceonKnowledgediscoveryanddatamining.
ConferenceonDataMining(ICDM).IEEE.
[44]
4 G3 e4 o‚Äì ff4 r4 e3 y.
IWebb.2007.Discoveringsignificantpatterns.Machinelearning68
[22] YannLeCunandCorinnaCortes.2010. MNISThandwrittendigitdatabase.
(2007),1‚Äì33.
http://yann.lecun.com/exdb/mnist/
[45] GeoffreyIWebb.2008. Layeredcriticalvalues:apowerfuldirect-adjustment
[23] F dl io scr oia vn erL yem inm pe yr ti hch ona .n Id nM ECar Mti Ln PB Ke Dck Der 2. 02 10 81 .9 S. pp ry insu gb eg r,r 6o 5u 8p ‚Äì: 6E 6a 2s .y-to-usesubgroup approachtodiscoveringsignificantpatterns.MachineLearning71(2008),307‚Äì
323.
[24] Y sai mL pi, lePh coil mip pM lexL ito yn og f,a len ad rnA inra gv .i Jn .d CS omrin pi uv ta .s Sa yn st. e2 m00 S1 c. i.I 6m 2p ,r 3o (v 2e 0d 01b )o ,5u 1n 6d ‚Äìs 5o 2n 7.the [46] P Exet ae mr pH leW sae ns dtfa mll eta hn od dS sfS ot ra pn -l vey aluYo eu an dg ju. s1 t9 m9 e3 n. tR .e Js oa hm np Wlin ilg e- yba &se Sd om nsu .ltipletesting:
13A APPENDIX distribution of the maximum deviation, that is, the valueùëû for
A.1 RelationtoQualityMeasures whichthemaximumdeviationisbelowùëûwithprobabilityùõø,fora
(relatively)smallvalueofùõø.Accuratelyestimatingsuchquantile
Interestingsubgroupsareoftenidentifiedusingaqualitymeasure,
requiresmanymorepermutationsthanestimatingtheexpectation
definedbycombiningthegeneralityandtheunusualnessofapat-
(asdonebyourapproach).Forexample,ifonly10permutations
tern.ThegeneralityfP(D)ofapatternPinthedatasetDisthe (e.g.,correspondingtothevalueùëêusedinourexperiments)areused
fractionofsamplesofDthatsupportP toestimatetheùõø-quantile,withùõø =0.05,theWYprocedurereturns
fP(D)=
ùëö1 ‚àëÔ∏Åùëö
1[P ‚ààùë† ùëñ] =
|CP ùëö(D)|
.
t inhe pm osa itx ii om nu ‚åàm ùõø¬∑d 1e 0v ‚åâia =ti 1on ino tv he er lt ih ste o1 f0 dp ee vr im atu iot nat si ,o sn os rt( ei. de. i, nth de ece rl ee am sie nn gt
ùëñ=1 order).Thisimpliesthat,withprobability> 1,theFWERwillnotbe
2
Foranybagofsamplesùêµ ‚äÜD,definetheaveragetargetvalue controlledatlevelùõø(sincetheprobabilitythatthedeviationofone
ùúá(ùêµ)ofsamplesùë° ‚ààùêµas permutationwillbeabovetheùõø-quantileis0.95,andtheprobability
1 ‚àëÔ∏Å thatalldeviationsareabovetheùõø-quantileis0.9510‚âà0.599> 1).
ùúá(ùêµ)= ‚Ñì. 2
|ùêµ| Moreover,withprobability> 1,theFWERwillnotbecontrolled
(ùë†,‚Ñì)‚ààùêµ 3
even at level 2ùõø = 0.1 (since 0.910 ‚âà 0.3487 > 1). For such a
TheunusualnessuP(D)ofthepatternPonthedatasetDisdefined reason,previousworkssuggesttouseatleast103pe3
rmutationsfor
asthedifferenceofthetargetvariableofthesamples‚àà CP(D)
permutationapproaches(aswedoinourexperiments),while104
andtheaveragetargetintheentiredataD
isthesuggestednumberofpermutationstohaveastableFWER
uP(D)=ùúá(CP(D))‚àíùúá(D). estimation([25,33,39]alluse104).
Theùõº-qualityq¬Ø‚àó (D)ofapatternPonadatasetDisdefined
P,ùõº A.3 ProofsofSection4.1
as
q¬Ø‚àó P,ùõº(D)=fP(D)ùõº uP(D). Thi Fs irs se tc ,t wio en np er ee dse tn ht es fa od ld loit wio in na gl tp er co ho nfs icf ao lr rt eh se ulr te .sultsofSection4.1.
Commonlyusedqualitymeasuresarethe1-quality,the1-quality,
2 Theorem14(McDiarmid‚Äôsineqality[27]). LetYbeadomain,
andthe2-quality. andletùëî:Yùëö ‚ÜíRbeafunctionsuchthat,foreachùëñ,1‚â§ùëñ ‚â§ùëö,
GivenasubgroupP,itsqualityqP canbewrittenas
thereisanonnegativeconstantùëê suchthat:
ùëñ
qP = (ùë†,P ‚Ñì)r ‚àºùõæ(P ‚ààùë†‚àß‚Ñì =1)‚àí (ùë†,P ‚Ñì)r ‚àºùõæ(P ‚ààùë†) (ùë†,P ‚Ñì)r ‚àºùõæ(‚Ñì =1) sup |ùëî(ùë• 1,...,ùë• ùëö)‚àíùëî(ùë• 1,...,ùë• ùëñ‚àí1,ùë• ùëñ‚Ä≤,ùë• ùëñ+1,...,ùë• ùëö)| ‚â§ùëê ùëñ.
(cid:18) (cid:19)
‚ü®ùë• 1,...,ùë•ùëö‚ü©‚ààYùëö
= Pr (P ‚ààùë†) Pr (‚Ñì =1|P ‚ààùë†)‚àí Pr (‚Ñì =1) . ùë• ùëñ‚Ä≤‚ààY
(ùë†,‚Ñì)‚àºùõæ (ùë†,‚Ñì)‚àºùõæ (ùë†,‚Ñì)‚àºùõæ Let ùë• 1,...,ùë• ùëö be ùëö independent random variables such that
NotethatthegeneralityfP(D)istheestimate(ondatasetD) ‚ü®ùë• 1,...,ùë• ùëö‚ü© ‚ààYùëö.Then,forùê∂ =(cid:205)ùëö ùëñ=1ùëê ùëñ2,itholds
o mf aP ter( (ùë† o,‚Ñì n)‚àº dùõæ a( tP ase‚àà tùë† D), )a on fd Pt rh (ùë†a ,t ‚Ñì)t ‚àºh ùõæe (u ‚Ñìn =us 1u |Paln ‚ààes ùë†s )u ‚àíP P( rD (ùë†,) ‚Ñì)i ‚àºs ùõæth (‚Ñìe =es 1t )i-
,
Pr(cid:16) E[ùëî] >ùëî(ùë• 1,...,ùë• ùëö)+ùë°(cid:17) ‚â§ùëí‚àí2ùë°2/ùê∂.
where Pr(ùë†,‚Ñì)‚àºùõæ (‚Ñì =1|P ‚ààùë†) is estimated by ùúá(CP(D)) and
ProofofTheorem6. First,wenotethatintheconditionalset-
Pr(ùë†,‚Ñì)‚àºùõæ (‚Ñì =1)isestimatedbyùúá(D).Thisshowsthatthe1-quality tingitholdsùúáÀÜ=ùúáÀá=ùúá¬Ø.Then,fromthefactL‚òÖ‚äÜL,wehave
q¬Ø‚àó P,1(D) = fP(D)uP(D) correspondstoanestimate,obtained
(cid:34) ùëö (cid:35)
wfro em caD nc, oo nft sh ide eq ru mal ii nty inq gP suo bf gs ru ob ug pr sou wp itP h. hW igi hth 1t -h qi us ar le itl yat qi ¬Øo
‚àó
Pn ,1in (Dm )in ad s, v‚àºùêºE
(ùúá¬Ø)
Ps ‚ààu Lp ‚òÖùëö1 ‚àëÔ∏Å ùëñ=1ùëì P(ùë† ùëñ)(vùëñ ‚àíùúá¬Ø)
anheuristicforfindingsignificantsubgroups,whichignoresthe (cid:34) ùëö (cid:35)
randomfluctuationsoftheestimatesfP(D)anduP(D). ‚â§ v‚àºùêºE
(ùúá¬Ø)
Psu ‚ààp Lùëö1 ‚àëÔ∏Å ùëñ=1ùëì P(ùë† ùëñ)(vùëñ ‚àíùúá¬Ø) = RE ‚òÖ(cid:2)ùëëÀú(R‚òÖ,ùúáÀá)(cid:3),
A.2 ComparisonwithPermutationApproaches
therefore we focus on the concentration
ofùëëÀú(R‚òÖ,ùúáÀá)
around its
Inthissectionweprovideamoredetailedcomparisonbetweenour expectationtakenw.r.t.R‚òÖ
.OurproofisbasedonMcDiarmid‚Äôs
few-shotapproachandcommonlyusedpermutationapproaches. inequality(Theorem14).Definethefunctionùëî(R‚òÖ)
=
ùëëÀú(R‚òÖ,ùúáÀá),
Our few-shot approach leverages our analytical results (e.g., andnotethatmodifyinganyùúâ ùëñ,ùëó,foranypairùëñ,ùëó,changesùëî(R‚òÖ)by
T deh ve io ar tie om no6 f) pto ato teb rt na sin ‚Äôqh ui ag lh itypr bo yb ea sb ti il mit ay tib no gu on nd ls yo thn eth exe pm eca tax ti im onum
of
atmost1/(ùëêùëö).Therefore,definingùê∂ =(cid:205) ùëñ(cid:205) ùëó(1/(ùëêùëö))2=1/(ùëêùëö),
fromTheorem14itholds
maximumdeviationofpatterns‚Äôquality.Estimatingsuchexpecta- ‚àöÔ∏Ñ
tionrequiresasmallnumberùëêofresampleddatasets,suchasùëê =10 Pr(cid:32)
E (cid:2)ùëëÀú(R‚òÖ,ùúáÀá)(cid:3)>ùëëÀú(R‚òÖ,ùúáÀá)+
log(cid:0) ùõø4(cid:1)(cid:33)
‚â§ùõø/4.
thatweusedinourexperimentalevaluation. R‚òÖ 2ùëêùëö
Thesameapproachcannotbeusedbypermutationapproaches
‚ñ°
(e.g.,[25,33,39]),sincetheyareestimatingtheùõø-quantileofthe
14A.4 ProofsofSection4.2 isaself-boundingfunction[8].Definetherandomvariableùëç ùëó,for
ThisSectionpresentstheproofsfortheresultsofSection4.2.
ùëó ‚àà [1,ùëö],as
(cid:20) (cid:26) ùëö (cid:27)(cid:21)
denP tr ao no df bo of uL ne dm edma ra9 n. doS minc ve arùúá i( aD ble) si ,s Ht oh ee ffa dv iner ga ‚Äôg se ano dfùëö Berin nd ste ep inen ‚Äôs- ùëç ùëó = TE
‚òÖ
Psu ‚ààp
L
ùëö1 ùëñ=‚àëÔ∏Å 1,ùëñ‚â†ùëóùëì P(ùë† ùëñ)(ùúâ ùëñ ‚àíùúá)
inequalities[8]yield,respectively,that First,notethatùëç ‚â•0:
|ùúá‚àíùúá(D)|
‚â§(cid:118)(cid:116) ln(cid:16) ùõø8(cid:17)
,
ùëç = TE ‚òÖ(cid:2) Psu ‚ààp L{qP(D‚òÖ )}(cid:3) ‚â• Psu ‚ààp L(cid:8) TE ‚òÖ(cid:2) qP(D‚òÖ )(cid:3)(cid:9) ‚â•0.
2ùëö
(cid:118)(cid:116) (cid:16) (cid:17) (cid:16) (cid:17)
Then,weprovethatùëç ‚àíùëç
ùëó
‚â•0.DefineùëìÀÜasoneofthefunctions
2ùúá(D)ln ùõø8 2ln ùõø8 thatattainthesupremumforùëç ùëó,foranychoiceofT‚òÖ .Wehave
|ùúá‚àíùúá(D)| ‚â§ ùëö + ùëö , (cid:20) 1 ‚àëÔ∏Åùëö (cid:21)
h foo ll ld owsi sm fru ol mtan theo eu os bly serw vi at th iop nro thb aa tb til hit ey ir‚â• mi1 ni‚àí mùõø u/ m4. isT ‚â§he
ùúÄ
ùëást .atemen ‚ñ°t ùëç ùëó ‚àíùëç ‚â§ùëç ùëó (cid:20)‚àí TE ‚òÖ ùëö ùëñ=1ùëìÀÜ(ùë† ùëñ) (cid:21)(ùúâ ùëñ ‚àíùúá)
1
ProofofTheorem11. Recall that R‚òÖ = (cid:8) D 1‚òÖ,...,Dùëê‚òÖ(cid:9) is = ùúâE
ùëó
‚àí ùëöùëìÀÜ(ùë† ùëó)(ùúâ ùëó ‚àíùúá) =0.
a collection of ùëê ‚â• 1 i.i.d. resampled datasets, each obtained
by resampling the target labels of D while maintaining the
Wenowshowthatùëç ‚àíùëç
ùëó
‚â§ùúá(1‚àíùúá)/ùëö.Wehave
s (cid:8)a (m
ùë†
1e
,ùúâ
1fe ,ùëóa )t ,u .r .e .s
(ùë†
ùëöof ,ùúâD ùëö. ,ùëóT )(cid:9)h ,a wt his e, reeach resampled dataset is D‚òÖ ùëó = ùëç ‚â§ TE ‚òÖ(cid:20) Psu ‚ààp L(cid:26) ùëö1 ùëñ=‚àëÔ∏Å 1,ùëñ‚â†ùëóùëì P(ùë† ùëñ)(ùúâ ùëñ ‚àíùúá)(cid:27)
ùúâ ùëñ,ùëó ‚àºùêµùëíùëüùëõ(ùëù),‚àÄùëñ ‚àà [1,ùëö],‚àÄùëó ‚àà [1,ùëê], (cid:26) 1 (cid:27)(cid:21)
andùêµùëíùëüùëõ(ùëù)istheBernoullidistributionwithparameterùëù.Inthe
+ Psu ‚ààp
L
ùëöùëì P(ùë† ùëó)(ùúâ ùëó ‚àíùúá)
p ofro reo sf aw me pls ee dtùëù da= tasùúá et= sRE ÀÜ‚òÖD =[ùúá {( DD ÀÜ 1‚òÖ)] ,. .T ..h ,e Dn ÀÜ ùëê‚òÖ,w }e simde ifi lan re lyt th oe Rco ‚òÖl ,le wc hti eo rn e ‚â§ùëç ùëó + ùúá(1 ùëö‚àíùúá) .
t rh ole espa or fa Rm ‚òÖet ae nr dùúá RÀÜis ‚òÖr ae rp ela swce ad ppb ey dit is nu thp epe str ab teo mun end tùúáÀÜ an(n do it ne Ath lga .t 1t )h .e Wenowprovethat(cid:205)ùëö ùëó=1ùëç ‚àíùëç
ùëó
‚â§ùëç.Itholds
supL Pet ‚ààLùëå ‚òÖ= ùëâùëéE
ùëü
DD ((cid:2) qsu Pp (P D‚àà )L )‚òÖ ‚â§{qP ùúà.(D W) e} a(cid:3) , ppan lyd Bo ob us se qrv ue ett ‚Äôsha it neit quh ao ll id tys ‚àëÔ∏Å ùëóùëö =1ùëç ùëó ‚â• TE ‚òÖ(cid:20) Psu ‚ààp L(cid:26) ùëö1 ‚àëÔ∏Å ùëóùëö =1ùëñ=‚àëÔ∏Å 1ùëö ,ùëñ‚â†ùëóùëì P(ùë† ùëñ)(ùúâ ùëñ ‚àíùúá)(cid:27)(cid:21)
(Theorem12.5of[8])toprovethat (cid:20) (cid:26)ùëö‚àí1‚àëÔ∏Åùëö (cid:27)(cid:21)
Ps ‚ààu Lp ‚òÖ{qP(D)}‚â§ùëå +‚àöÔ∏Ñ 2ln(cid:0) ùõø4(cid:1) ùëö(ùúà+2ùëå) + ln 3(cid:0) ùëöùõø4(cid:1) , = =(TE ùëö‚òÖ ‚àíPsu 1‚àà )p L
ùëç.
ùëö ùëñ=1ùëì P(ùë† ùëñ)(ùúâ ùëñ ‚àíùúá)
withprobability‚â•1‚àíùõø/4.Wenowshowhowtoupperboundùëå. Asùëç isaself-boundingfunction,wehavethat
First,notethat
(cid:18) ‚àíùëöùëû2 (cid:19)
DE(cid:2) Ps ‚ààu Lp ‚òÖ{qP(D)}(cid:3) = DE
‚òÖ
ùëó
(cid:2) Ps ‚ààu Lp ‚òÖ{qP(D‚òÖ ùëó )}(cid:3) Pr(E[ùëç]‚àíùëç ‚â•ùëû) ‚â§exp 2ùúá(1‚àíùúá)E[ùëç] .
(cid:20) ùëê (cid:21) Imposing the r.h.s. ‚â§ ùõø/4, solving for ùëû, and finding the fixed
= RE
‚òÖ
ùëê1‚àëÔ∏Å ùëó=1Ps ‚ààu Lp ‚òÖ{qP(D‚òÖ ùëó )} Wpo ein at po pf lythe Mi cn De iq au ra mli it dy iw ne eqo ub at la itin yùëë (ÀÜ T. hLe et orùëë eÀú( mR‚òÖ 1) 4)= toùëëÀú( sR h‚òÖ o, wùúá(D th) a) t.
bydefinitionofL‚òÖ andR‚òÖ
.Then,itfollowsthat
E R‚òÖ[ùëëÀú(R‚òÖ) | A] ‚â§ ùëüÀÜ with probability ‚â• 1 ‚àíùõø/4. In fact, de-
finethefunctionùëî(R‚òÖ)
=
ùëëÀú(R‚òÖ),andnotethatmodifyingany
RE ‚òÖ(cid:20) ùëê1‚àëÔ∏Å ùëó=ùëê 1Ps ‚ààu Lp ‚òÖ{qP(D‚òÖ ùëó )}(cid:21) ‚â§ RE ‚òÖ(cid:20) ùëê1‚àëÔ∏Å ùëó=ùëê 1Psu ‚ààp L{qP(D‚òÖ ùëó )}(cid:21) , ùúâ dùëñ e,ùëó fi, nfo inr gan ùê∂y =pai (cid:205)r ùëñùëñ, (cid:205)ùëó, ùëóc (h 1a /n (ùëêg ùëöes ))ùëî 2(R =‚òÖ) 1/b (y ùëêùëöat )m
,
to hs et1 u/ p( pùëêùëö er) b.T ouh ner def ùëüÀÜor te o,
since L‚òÖ ‚äÜ L. We now prove bounds to the concentration of E R‚òÖ[ùëëÀú(R‚òÖ)|A]holdsbyTheorem14.Wenowneedtoprovethat
E DR ‚òÖ‚òÖ(cid:2) =ùëê1 ((cid:205) Aùëê ùëó ,= T1s ‚òÖu )p bP e‚àà aL g{q enP e( rD ic‚òÖ ùëó D)} ‚òÖ(cid:3) w ‚àà.r R.t ‚òÖ. ,th we its het To ‚òÖffe =at {u ùúâr 1e ,s ..A .,.
ùúâ
ùëöLe }t
.
t
s
ah
m
lle
a
ùë•lu ,lep rp te hr ab no uu sn ind gùëëÀÜ Rc ‚òÖo .m Tp hu iste id seu qs uin ivg alR eÀÜ n‚òÖ ti ts o( sp hr oo wba tb hi ali ts it tic ha oll ly d) s,n foo rt
Definetherandomvariableùëç as
ùëç = TE ‚òÖ(cid:2) Psu ‚ààp L{qP(D‚òÖ )}(cid:3), RP ÀÜ‚òÖr (cid:16) ùëëÀú(RÀÜ‚òÖ ) >ùë•(cid:17) ‚â• RP ‚òÖr (cid:16) ùëëÀú(R‚òÖ ) >ùë•(cid:17) .
wheretheexpectationisw.r.t.T‚òÖ ,conditioningonA.Toshowthe Equivalently,theprobabilityofunderestimatingE R‚òÖ[ùëëÀú(R‚òÖ)]using
concentrationofùëç w.r.t.itsexpectationE A[ùëç],weprovethatùëç
ùëëÀú(R‚òÖ)doesnotincreasewhenusingùëëÀú(RÀÜ‚òÖ).Sincethetwoprobabil-
itiesaretakenw.r.t.totwodifferentsamplespaces,itisnotpossible
tocomparethemdirectly.Therefore,webuildanappropriatecou-
plingbetweenthetwodistributions.Defineanùëö√óùëêmatrixùë£ofùëöùëê
i.i.d.Bernoullirandomvariables,suchthatPr(ùë£
ùëñ,ùëó
=1)=ùúÄ ùëá/(1‚àíùúá)
15forallùëñ,ùëó.(Notethatweassume0<ùúá <1and0‚â§ùúáÀá‚â§ùúá ‚â§ùúáÀÜ‚â§1, andthenconcludewithaconcentrationboundforùëëÀú(R‚òÖ,ùúáÀá)w.r.t.
otherwisethestatementholdstrivially.)Weobservethat toitsexpectationE v‚àºùêº(ùúáÀÜ)[ùëëÀú(R‚òÖ,ùúáÀá)],usinganalogousderivations
ùëê (cid:40) ùëö (cid:41) of the proof of Theorem 6. For any P ‚àà L, define ùëã P =
Pr (cid:16) ùëëÀú(RÀÜ‚òÖ ) >ùë•(cid:17) = Pr(cid:169) (cid:173)ùëê1‚àëÔ∏Å sup ùëö1 ‚àëÔ∏Å ùëì P(ùë† ùëñ)(cid:16) ùúâÀÜ ùëñ,ùëó ‚àíùúá(cid:17) >ùë•(cid:170) (cid:174), ùëö1 (cid:205)ùëö ùëñ=1ùëì P(ùë† ùëñ)(vùëñ ‚àíùúáÀá).LettwopatternsP 1,P 2suchthatthepro-
RÀÜ‚òÖ RÀÜ‚òÖ ùëó=1P‚ààL ùëñ=1 jection of P 1 on D is equal to the projection of P 2 on D, i.e.,
w b Ru ‚òÖh ie l ,d ure st ihùúâ nÀÜ eùëñ g,ùëó f to ha lr eloe fw ai. ci i t. nd tg. hB ac toe ùúâur ÀÜ(cid:171) ùëñn p ,ùëóo liu ‚àºnl gl mi bw ae xtit w {h ùúâe ùëñP ,e ùëónr ,( ùë£tùúâ ùëñÀÜ h ,ùëñ ùëó, eùëó }.d= Tis h1 t i) r sib= au llùúá t oÀÜ i wofo n sr s ua o sl f tl oRùëñ ÀÜ, o‚òÖùëó b. taW an inde(cid:172) wi st u ip th hùëño ‚àà inl {d 1 Es ,2 v}{ ‚àºùëñ ùëã ùêº(P ùúá: ÀÜùëñ )[P = ùëëÀú1 (ùëã R‚àà P ‚òÖ1 ,. ùúáùë† Àáùëñ T )} ]h oe= vre ef ro{ tùëñ r he e,: sw eP e t2 oc fa‚àà pn ar tùë† teùëñ ew} r. nri sT te whi t is th heim ds iup stpl ii nre es cm tt puh rma ot
-
jections,recallingthatthenumberofsuchdistinctprojectionsis
thelowerboundstatedabove: ùëÅ L(D).Now,foranyP ‚ààL,Bernstein‚Äôsinequality(Theorem2.10
RP ÀÜ‚òÖr(cid:169) (cid:173) (cid:171)ùëê1‚àëÔ∏Å ùëó=ùëê 1Psu ‚ààp L(cid:40) ùëö1 ‚àëÔ∏Å ùëñùëö =1ùëì P(ùë† ùëñ)(cid:16) ùúâÀÜ ùëñ,ùëó ‚àíùúá(cid:17)(cid:41) >ùë•(cid:170) (cid:174)
(cid:172)
i [ in t8] i[ s)8 ,] as) nui cm ah vp etl hi re aas gtt eùëãha oPt fùëã ‚àà i.P iŒì .d+i .s ( rùë¢a a, ns ùëèu d)b ow- mg ia thm vaùë¢m ri=a abr ùúîa ÀÜ len / sùëödo
ùëì
Pam n (ùë†v d ùëña )ùëèr (i v=ab ùëñ1l ‚àíe /(( ùúáÀáS 3 )e ùëöc t) hti , ao s tn in a2 c r. ee4
ùëê (cid:40) ùëö (cid:41) boundedintheinterval[‚àíùúáÀá,1‚àíùúáÀá]andhavevariance‚â§ùúîÀÜ.Conse-
= RP ‚òÖr ,ùë£(cid:169) (cid:173)ùëê1‚àëÔ∏Å ùëó=1Psu ‚ààp
L
ùëö1 ‚àëÔ∏Å ùëñ=1ùëì P(ùë† ùëñ)(cid:0) max{ùúâ ùëñ,ùëó,ùë£ ùëñ,ùëó}‚àíùúá(cid:1) >ùë•(cid:170) (cid:174) q pu eren bt ol uy, nw de tha ep ep xly pea cm tea dx mim aa xl imin ue mqu oa fli st uy b( -C go ar mol mla ary ra2 n.6 doin m[ v8 a]) rit ao bu lep s-
,
(cid:171) (cid:172)
‚â• RP ‚òÖr ,ùë£(cid:169) (cid:173)ùëê1‚àëÔ∏Å ùëó=ùëê 1Psu ‚ààp L(cid:40) ùëö1 ‚àëÔ∏Å ùëñùëö =1ùëì P(ùë† ùëñ)(cid:0)ùúâ ùëñ,ùëó ‚àíùúá(cid:1)(cid:41) >ùë•(cid:170) (cid:174) o N stb o at tta eei mn thi en a ntg tth ft oh e la lu ot p wE p se[ rm frb oa ox muP n tdùëã hetP o a] t ph p‚â§ e lie c‚àöÔ∏Å x ap t2 ieùë¢ oc nl tn a ot( i fùëÅ o TnL hg( eiD v oe r) en) ma+ b 1oùëè 4vl e tn oh( ùëëùëÅ o Àúl (L d Rs( ‚òÖ.D T ,ùúáh Àá) )) e ,.
(cid:171) (cid:172)
= Pr (cid:16) ùëëÀú(R‚òÖ ) >ùë•(cid:17) . followingthesamestepsoftheproofofTheorem6. ‚ñ°
R‚òÖ
ToupperboundùëÅ L(D)forthelanguageofsubgroups,weprove
Then,itisimmediatetoobservethat
thefollowing.Notethatwefocusonthecaseofsubgroupswith
Pr (cid:16) ùëëÀú(RÀÜ‚òÖ,ùúáÀá) >ùë•(cid:17) ‚â• Pr (cid:16) ùëëÀú(RÀÜ‚òÖ ) >ùë•(cid:17) , continuousfeatures,sinceeverycategoricalfeatureùëì ùëê canbecon-
RÀÜ‚òÖ RÀÜ‚òÖ vertedtoadiscreteoneùëì ùëë (assigningarandomordertothedistinct
sinceùúáisreplacedbyitslowerboundùúáÀáinthedefinitionofùëëÀú(RÀÜ‚òÖ),as elements),andobservingthateachequalitycondition‚Äúùëì ùëê =ùëé‚Äùis
ùëëÀú(RÀÜ‚òÖ,ùúáÀá) ‚â•ùëëÀú(RÀÜ‚òÖ)forallRÀÜ‚òÖ .Thestatementfollowsobservingthat equivalenttotheinterval‚Äúùëì ùëë ‚àà [ùëé‚àíùë•,ùëé+ùë•]‚Äùforsomeùë• >0.There-
allotherquantitiesinthedefinitionofùúÄareconstantsindependent fore,thelanguageofsubgroupsovercontinuousfeaturescontains
ofùúá,andfromanunionboundoverthe3concentrationbounds thelanguageoverdatasetswithbothcontinuousandcategorical
consideredintheproof,andtheevent‚Äú|ùúá‚àíùúá(D)| ‚â§ùúÄ ùëá‚Äù,eachof features,thusallresultsfortheformerapplytothelatter.Notethe
themtruewithprobability‚â•1‚àíùõø/4. ‚ñ° reversedirectionisnottrueingeneral.
Lemma16. LetLbethelanguageofsubgroupscomposedbycon-
A.5 PowerAnalysis
junctionswithatmostùëßconditionsoverùëëcontinuousfeatures.Then,
Inthissectionweprovetheresultsonthepowerof FSRstatedin itholdsùëÅ (D) ‚â§
(cid:16)ùëí3ùëëùëö2(cid:17)ùëß
.
Sections4.1and4.2.
L 4ùëß3
WefirstprovideaprobabilisticupperboundtoùëëÀú(R‚òÖ,ùúáÀá),the Proof. ConsideradatasetDwithùëëcontinuousfeatures,andlet
estimateofthesupremumdeviationoffalsediscoveriescomputed [1,ùëë]betheindicesofthesefeatures.Letanyùê¥‚äÜ [1,ùëë]with|ùê¥|=
byAlgorithm1(inline6).Thisresultcanbeappliedtogeneral ùë£ ‚â§ ùëß,anddefinethelanguageLùê¥ ‚äÜ L asallsubgroupswithùë£
languages;wethenshowhowtoapplyittothelanguageofsub- conjunctiontermsinvolvingconditionsonthefeaturesofùê¥,suchas
groups.WedefineùëÅ L(D)asthenumberofdistinctprojectionsof
inequalitiesorintervals.Equivalently,wecanseetheprojectionof
thelanguageLonthedatasetD: Lùê¥overthetransactionsofDastheclassofaxis-alignedrectangles
ùëÅ L(D)=|{{ùëñ :P ‚ààùë† ùëñ},P ‚ààL}|. inRùë£ .ItisknownthattheVC-dimensionofthisclassis2ùë£(Problem
6.5in[38]).Therefore,fromSauer-Shelah-Perles‚ÄôLemma(Lemma
N t Tr hio v eTt ie vhal at eh lu o ua p r et p, e oed m fri ùëëff b 1 Àú(e 5o Rr .ue ‚òÖnn L ,dt e ùúál Àáty i )s ùúÜf cùëÅr o‚àào mLm ( p( 0D u| ,L t1 e) ) d| ,, ‚â§ aùëÅ bn y2L dùëö F( Sùúî)D ÀÜ. R=) ini ùúás ÀÜ l( ia n1l ew ‚àí 6a ùúáy Àá o)s fs Aa u lfi p gn
P
ori ‚ààt ie
tL
hv mfa Pl 1u (e D is( )a . 6 D.1 ùëÅ0 isin ùëÅ ([ L D3 ùê¥8 )(]) ‚â§D,t ) ‚àëÔ∏Åhe ‚â§n ùëÅ(cid:205)um ùëñ2 =ùë£b 1 (e (cid:0) Dr ùëö ùëñùëÅ )(cid:1)L ‚â§‚â§ùê¥ ‚àëÔ∏Å(cid:0)( ùëßùëíD 2ùëö ùë£) (cid:18)(cid:1) ùëë2o (cid:19)ùë£f . (cid:16)d F ùëíi rs ùëöoti mn (cid:17)c 2a ùë£t np ‚â§r uo n (cid:16)je ùëíioc ùëöt ni (cid:17)o b 2n o ùëßs u (cid:18)o n ùëíf d ùëëL , (cid:19)ùê¥
ùëß
,on
L Lùê¥ ùë£ 2ùë£ 2ùëß ùëß
ùëëÀú(R‚òÖ,ùúáÀá) ‚â§‚àöÔ∏Ç 2ùúîÀÜln(ùëÅ L(D))
+‚àöÔ∏Ñ
ln( ùúÜ1) + ln(ùëÅ L(D))
obtainingthesùê¥
tatement.
ùë£=1
‚ñ°
ùëö 2ùëêùëö 3ùëö
withprobabilityatleast1‚àíùúÜ. CombiningLemma16andTheorem15,weobtainthefollowing
Corollary.
Proof. Toobtainthestatement,wefirstproveanupperbound
totheexpectationE v‚àºùêº(ùúáÀÜ)[ùëëÀú(R‚òÖ,ùúáÀá)],thatis
E [ùëëÀú(R‚òÖ,ùúáÀá)]
‚â§‚àöÔ∏Ç 2ùúîÀÜln(ùëÅ L(D))
+
ln(ùëÅ L(D))
,
v‚àºùêº(ùúáÀÜ) ùëö 3ùëö
16Corollary17. LetLbethelanguageofsubgroupscomposedby Thefollowingresultestablishesconcentrationboundsforfunc-
conjunctionswithatmostùëß conditionsoverùëë continuousfeatures. tionsthatsatisfytheALC.
ThenthevalueùëëÀú(R‚òÖ,ùúáÀá)computedbyFSRinline6ofAlgorithm1is
Theorem19(Corollary5.1[13]). Letùëì satisfytheALCwithpa-
ùëëÀú(R‚òÖ,ùúáÀá) ‚â§‚àöÔ∏Ñ 2ùúîÀÜùëßln ùëö(ùëí3 4ùëë ùëßùëö 32) +‚àöÔ∏Ñ ln 2ùëê( ùëöùúÜ1) +ùëßln( 3ùëí ùëö3 4ùëë ùëßùëö 32) r aa nm de lt ee tr ùê∂sùëê =ùëñ,ùëñ (cid:205)‚àà ùëõ ùëñ=[ 1ùëõ ùëê] ùëñ2, .w Ti hth enre itsp he oc lt dt sotherandomvariablesùëã 1,...,ùëã ùëõ,
Pr(ùëì >E[ùëì]+ùë°),Pr(ùëì <E[ùëì]‚àíùë°) ‚â§exp(‚àí2ùë°2/ùê∂).
withprobabilityatleast1‚àíùúÜ.
A.5.1 PoweranalysisofFSR-C. ToproveTheorem8,regarding Wenowprovethatthesum(cid:205)ùëõ ùëñ=1‚Ñì ùëñ isafunctionthatsatisfythe
ALC,thusissharplyconcentratedtowarditsexpectation.
thepowerof FSR-C,wefirstdescribethemodelweassumeforthe
distributionofthealternativehypotheses,i.e.,thesetofpatterns Theorem20. Let{‚Ñì ùëñ,ùëñ ‚àà [1,ùëõ]}beasetofrandomvariablesdis-
withqP >0.Weassumethatthequalityofpatternscorrelatedwith tributedaccordingtoùëä ùëõ({ùëö ùëñ,ùë§ ùëñ}).Denoteùëã ùëñ =‚Ñì ùëñ andthefunction
thetargetfollowstheWallenius‚Äônoncentralhypergeometricdis- ùëì =(cid:205)ùëõ ùëñ=1ùëã ùëñ.Then,itholds
tribution[42],ageneralizationofthehypergeometricdistribution
Pr(ùëì >E[ùëì]+ùë°),Pr(ùëì <E[ùëì]‚àíùë°) ‚â§exp(‚àí2ùë°2/ùëõ).
thatallowstomodelabiasedrandomsamplingofacontingency
tablewithfixedmarginals.Wedefinethemodelùëä ùëõ({ùëö ùëñ,ùë§ ùëñ})that Proof. Weprovethatùëì satisfytheALC.Foranyùëñ ‚àà [1,ùëõ],
describesthedistributionofasequenceofbinaryrandomvariables ùëõ ùëõ
‚Ñì 1,...,‚Ñì ùëõfortheweightedsamplingofùëõelementsfromasetofùëö
1
E(cid:104)‚àëÔ∏Å
ùëã
ùëó
|Xùëñ‚àí1,ùëã
ùëñ
=1(cid:105) ‚àíE(cid:104)‚àëÔ∏Å
ùëã
ùëó
|Xùëñ‚àí1,ùëã
ùëñ
=0(cid:105)
itemswithlabel1andùëö 0itemswithlabel0;theparametersùë§ 0and ùëó=1 ùëó=1
ùë§ 1,with1‚â§ùë§ 0 <ùë§ 1,arerespectivelytheweightsofitemswith (cid:104) ‚àëÔ∏Åùëõ (cid:105) (cid:104) ‚àëÔ∏Åùëõ (cid:105)
label0and1.Thefactùë§ 1 >ùë§ 0expressesthebiastowardsampling =1+E ùëã ùëó |Xùëñ‚àí1,ùëã ùëñ =1 ‚àíE ùëã ùëó |Xùëñ‚àí1,ùëã ùëñ =0
itemswithlabel1.Thefirstelement‚Ñì 1issampledaccordingtothe ùëó=ùëñ+1 ùëó=ùëñ+1
weightedproportionoftheitems,suchthat (cid:104) ‚àëÔ∏Åùëõ (cid:105) (cid:104) ‚àëÔ∏Åùëõ (cid:105)
Pr(‚Ñì 1=1)=
ùëö
ùë§ùëö
1
+ùë§
ùëö1
ùë§
.
‚â§1+E ùëó=ùëñ+1ùëã ùëó |Xùëñ‚àí1,ùëã ùëñ =0 ‚àíE ùëó=ùëñ+1ùëã ùëó |Xùëñ‚àí1,ùëã ùëñ =0 =1.
1 1 0 0
The second element ‚Ñì 2 is taken according to the weighted pro- Wethenprovetheotherdirection:
portion of the remaining items, therefore dependending on the (cid:104)‚àëÔ∏Åùëõ (cid:105) (cid:104)‚àëÔ∏Åùëõ (cid:105)
outcomeofthefirstchoice.Ingeneral,weobtainthat E ùëã ùëó |Xùëñ‚àí1,ùëã ùëñ =0 ‚àíE ùëã ùëó |Xùëñ‚àí1,ùëã ùëñ =1
ùëöùëñùë§
ùëó=1 ùëó=1
Pr(‚Ñì ùëñ =1)= ùëöùëñ 1ùë§ 11 +ùëö1 ùëñ 0ùë§ 0, =E(cid:104) ‚àëÔ∏Åùëõ ùëã
ùëó
|Xùëñ‚àí1,ùëã
ùëñ
=0(cid:105) ‚àí1‚àíE(cid:104) ‚àëÔ∏Åùëõ ùëã
ùëó
|Xùëñ‚àí1,ùëã
ùëñ
=1(cid:105)
whereùëöùëñ 1=ùëö 1‚àí(cid:205)ùëñ ùëó‚àí =1 1‚Ñì ùëó andùëöùëñ 0=ùëö 0‚àí(cid:205)ùëñ ùëó‚àí =1 1(1‚àí‚Ñì ùëó)are,respec- ùëó=ùëñ+1
ùëõ
ùëó=ùëñ+1
ùëõ
tively,thenumberofremainingitemswithlabel1andlabel0,i.e., ‚â§1+E(cid:104) ‚àëÔ∏Å ùëã
ùëó
|Xùëñ‚àí1,ùëã
ùëñ
=1(cid:105) ‚àí1‚àíE(cid:104) ‚àëÔ∏Å ùëã
ùëó
|Xùëñ‚àí1,ùëã
ùëñ
=1(cid:105)
theonesthatarenotsampledinprevioussteps.Wemayobserve
ùëó=ùëñ+1 ùëó=ùëñ+1
that,asthebiasgoesto0(i.e.,ùë§ 1 ‚Üí ùë§ 0),thisdistributioncon- =0.
vergestothe(standard)hypergeometricdistribution.Weremark
thatadirectcalculationofmeanandtheprobabilitymassfunction
Weconcludethatùëì satisfytheALCwithùëê
ùëñ
=1,forall1‚â§ùëñ ‚â§ùëõ,
ofthenoncentralhypergeometricdistributionabove,thereforethe andtheconcentrationboundsfollowfromTheorem19. ‚ñ°
computationofexacttailbounds,isextremelyunwieldy.Moreover,
Using the result above, we prove a probabilitic lower bound
therandomvariables{‚Ñì ùëñ,ùëñ ‚àà [1,ùëõ]}areclearlynotindependent,
totheobservedqualityq¬ØP(D) ofapattern P.Forany P ‚àà L,
thereforestandardconcentrationresults(e.g.,Chernoff-Hoeffding letùëõ =ùëöfP(D)bethenumberoftransactionsofD whereP is
bounds)donotapplydirectly. supported,andassumew.l.o.g.that{ùëñ :P ‚ààùë† ùëñ,ùëñ ‚àà [1,ùëö]}= [1,ùëõ].
Toovercometheseissues,weleverageanadvancedconcentra- Wedefineùëã ùëñ = ‚Ñì ùëñ forallùëñ ‚àà [1,ùëõ],where‚Ñì ùëñ followsthebiased
tionboundformartingales,whichalsoappliestorandomvariables
samplingdistributiondescribedabove.
thatarenotnecessarelyindependent[13].Weusethefollowing
version of the method of bounded differences [27]. For a given Proposition21. Itholds
s {e ùëãt ùëó,o ùëóf ‚ààran [1d ,o ùëñ]m }.variablesùëã 1,...,ùëã ùëõ,weuseXùëñ todenotetheset
Pr(q¬ØP(D) ‚â§qP‚àíùë°)
‚â§exp(cid:18) f‚àí P2 (ùëö Dùë°2 )(cid:19)
.
ditiD onefi (n Ai Lti Con )w18 it. hA paf ru an mct ei to en rsùëì ùëê ùëñs ,a ùëñt ‚ààisfi [e ùëõs ],t whe itA hv re er sa pg ee cd ttL oip ts hc eh rit az nC doo mn- theP fr uo no cf t. ioD ne ùëìfin inet th he ef su tn ac teti mon enùëî t= ofùëö1 T(cid:205) heùëõ ùëñ= o1 re(‚Ñì mùëñ‚àí 2ùúá 0( ,D w) e). oC bo sn ers vid ee tr hin ag
t
variablesùëã 1,...,ùëã ùëõifforanyùëé ùëñ,ùëé ùëñ‚Ä≤, it holdsùëî = ùëì/ùëö ‚àí ùúá(D), and that ùëõ = ùëöfP(D). From these
|E[ùëì |Xùëñ‚àí1,ùëã ùëñ =ùëé ùëñ]‚àíE(cid:2)ùëì |Xùëñ‚àí1,ùëã ùëñ =ùëé ùëñ‚Ä≤(cid:3) | ‚â§ùëê ùëñ, observations,weapplyTheorem20tothefunctionùëì =ùëö(ùëî+ùúá(D)),
obtainingthestatementaftersimplemanipulationsofther.h.s.. ‚ñ°
for1‚â§ùëñ ‚â§ùëõ.
WenowextendProposition21toobtainaboundvalidsimoulta-
neouslyforallpatternsofthelanguageL.
17Proposition22. DefinefÀÜ(D)=sup PfP(D).Withprobability Proposition24. LetLbethelanguageofsubgroupscomposed
‚â•1‚àíùõø,itholds byconjunctionswithatmostùëßconditionsoverùëëcontinuousfeatures,
‚àöÔ∏Ñ anddefinefP =E D[fP(D)].Withprobability‚â• 1‚àíùõø w.r.t.Dit
q¬ØP(D) ‚â•qP‚àí
2fÀÜ(D)ln( ùëöùëÅ L(D)/ùõø)
,‚àÄP ‚ààL.
holds,forallP ‚ààL,
‚àöÔ∏Ñ
Proof. Definetheevent
‚àöÔ∏Ñ
fP(D) ‚â§fP+
2ùëß+ln(cid:0)(cid:205) ùëñùëß
= 21
ùëö(cid:0)ùëë ùëñ(cid:1)(cid:1)+ln(cid:0) ùõø2(cid:1)
,
Thestateùê∏ mP en= t‚Äú hq¬Ø oP ld( sD if) P‚â§ r(q ‚à™P P‚àí
ùê∏
P)2 ‚â§fÀÜ( ùõøD .N)l on w( ùëöùëÅ ,dL en(D ot) e/ tùõø w) o‚Äù.
patterns
qP(D)
‚â•qP‚àí‚àöÔ∏Ñ 2ùëß+ln(cid:0)(cid:205) ùëñùëß
= 21
ùëö(cid:0)ùëë ùëñ(cid:1)(cid:1)+ln(cid:0) ùõø2(cid:1)
.
P 1,P 2,suchthattheyaresupportedbythesamesetoftransactions: Proof. ConsideradatasetDwithùëëcontinuousfeatures,and
{ùëñ :P
1
‚ààùë† ùëñ}={ùëñ :P
2
‚ààùë† ùëñ}.Thisimpliesthatq¬ØP 1(D) =q¬ØP 2(D) let[1,ùëë]betheindicesofthesefeatures.Letanyùê¥ ‚äÜ [1,ùëë]with
forallpossiblelabels,butalsothatqP =qP ,sincethetwoquali- |ùê¥|=ùë£ ‚â§ùëß,anddefinethelanguageLùê¥ ‚äÜLasallsubgroupswith
1 2
tiesarefunctionsofthesamesetoflabels.Fromtheseobservations, ùë£conjunctiontermsinvolvingconditionsonthefeaturesofùê¥,such
itholdsùê∏ P ‚à™ùê∏ P =ùê∏ P .Therefore,theunionoverallpatternscan asinequalitiesorintervals.
1 2 1
bereplacedbytheunionovertheoneswithdistinctprojections, WefirstprovetheboundforfP(D).ForanyP ‚ààLùê¥,recallthe
whosenumberisatmostùëÅ L(D).Fromanunionboundoverthese functionsùëì P(ùë†) =1[P ‚ààùë†],andletFùê¥ ={ùëì P : P ‚àà Lùê¥}bethe
events,andusingthetailboundofProposition21withthefact familyofsuchfunctions.Itisimmediatetoobservethattheaverage
fP(D) ‚â§fÀÜ(D),wehave valueofùëì P overDisequaltofP(D).Asdiscussedpreviously,Fùê¥
Pr(‚à™ Pùê∏ P) ‚â§ùëÅ L(D)exp(cid:0)‚àí2ùëöùë°2/fÀÜ(D)(cid:1). Vis Ce -q du imiv ea nle sn iot nto 2ùë£th (Pe rc ol ba ls es mof 6.a 5x ii ns- [a 3li 8g ]n ).e Wd ere ac pta pn lygl Tes hein orR emùë£ , 2w 3it th
o
Imposingther.h.s.oftheinequalitytobe‚â§ùõø,andsolvingforùë°,we
theparticularcaseofthebinaryfunctionfamilyFùê¥,obtainingthat
obtainthestatement. ‚ñ° (cid:16) (cid:17)
Pr sup |fP‚àífP(D)| >ùë° ‚â§exp(2ùë£‚àí2ùë°2ùëö).
Finally,weprovethepowerguaranteesforFSR-C. ùëì P‚ààFùê¥
Fromanunionboundoverallsubsetsùê¥‚äÜ [1,ùëë]withcardinality
ProofofTheorem8. Toobtainthestatement,weshowthat
theconditionqP ‚â• ùúâ,forsomeùúâ > 0sufficientlylarge,implies
‚â§ùëß,wehave
thatPisreportedinoutputwithprobability‚â• 1‚àíùõø.Infact,we Pr(cid:16) sup sup |fP‚àífP(D)| >ùë°(cid:17)
havethattheimplicationqP ‚â•ùúâ =‚áí q¬ØP(D) ‚â•ùúâ‚àíùúÄ 1holdswith ùê¥ ùëì P‚ààFùê¥
‚àöÔ∏Ç 2fÀÜ(D)ùëßln(ùëí3ùëö2ùëë) ‚àëÔ∏Å (cid:16) (cid:17) ‚àëÔ∏Åùëß (cid:18)ùëë(cid:19)
probability‚â•1‚àíùõø/2forallP ‚ààL,whereùúÄ 1= ùëö 2ùëß3ùõø ‚â§ Pr sup |fP‚àífP(D)| >ùë° ‚â§ ùëñ exp(2ùëñ‚àí2ùë°2ùëö).
isobtainedfromProposition22(replacingùõøbyùõø/2,andusingthe ùê¥ ùëì P‚ààFùê¥ ùëñ=1
upperboundtoùëÅ L(D)fromLemma16).Consequently,weseek Settingther.h.s.tobe‚â§ùõø/2,weobtainthefirstbound.
asufficientconditiontoensurethatPisreportedinoutput;this WenowfocusontheboundforqP(D).ForanyP ‚ààLùê¥,recall
conditionisq¬ØP(D) ‚â•ùúâ‚àíùúÄ 1 ‚â•ùúÄ,andalsoùúâ ‚â•ùúÄ 1+ùúÄ,whereùúÄisas thefunctionsùëî P(ùë†,‚Ñì)=1[P ‚ààùë†](‚Ñì‚àíùúá),andletGùê¥ ={ùëî P :P ‚àà
definedinCorollary7.Combiningthisinequalitywiththeupper Lùê¥}bethefamilyofsuchfunctions.Itisimmediatetoobserve
boundtoùëëÀú(R‚òÖ,ùúáÀá)ofTheorem15(settingùúÜ=ùõø/2),weobtainthe thattheaveragevalueofùëî
P
overDisequaltoqP(D).Byusing
lowerboundtoqP inthestatement,whichholdswithprobability Lemma3.6of[36],weobtainthatthepseudodimensionofGùê¥is
‚â•1‚àíùõøfromaunionbound. ‚ñ° equaltotheVC-dimensionofFùê¥,whichis2ùë£.Therefore,weapply
A.5.2 PoweranalysisofFSR-U. Thefollowingisarestatementof
Theorem23toGùê¥,having
(cid:16) (cid:17)
Theorem5of[24],thatprovidesuniformconvergenceboundsfor Pr sup |qP‚àíqP(D)| >ùë° ‚â§exp(2ùë£‚àí2ùë°2ùëö).
familiesoffunctionswithboundedpseudodimension[35,38]. ùëî P‚ààGùê¥
Theorem23. LetF beafamilyoffunctionsfromadomainXto Wecompletetheprooffollowingthesamestepsforthefrequencies.
‚ñ°
[ùëé,ùëè] ‚äÇRwithpseudodimentionùëÉ(F) ‚â§ùëü.LetS={ùë† 1,...,ùë† ùëö}be
arandomsampleofsizeùëötakeni.i.d.fromadistributionùõæ.Itholds
WearenowreadytoproveTheorem13.
Pr(cid:32) ùëìsu ‚ààp F(cid:12) (cid:12) (cid:12)
(cid:12)
(cid:12)E S(cid:34) ùëö1 ‚àëÔ∏Å ùëñùëö =1ùëì(ùë† ùëñ)(cid:35) ‚àí ùëö1 ‚àëÔ∏Å ùëñùëö =1ùëì(ùë† ùëñ)(cid:12) (cid:12) (cid:12)
(cid:12)
(cid:12)>ùë°(cid:33) ‚â§exp(cid:18) ùëü‚àí ùëêÀú(ùëèùë°2 ‚àíùëö ùëé)2(cid:19) , theP vr ao lo uf eo of fùúÄTh dee fio nre em di1 n3. thF ero stm ateth me eng tua isra an nte ue ps po ef rC boo uro nl dla tr oy t1 h7 e,
value ofùúÄ computed by FSR-U in Algorithm 1 with probability
whereùëêÀúisanabsoluteconstant.
‚â• 1‚àíùõø/3(sinceùúÜ =ùõø/3inthedefinitionofùëüÀÜ).Wenowprovea
WenotethattheabsoluteconstantùëêÀúintheTheoremaboveis conditiononthequalityqP forapatterntobereportedinoutput.
estimatedtobeatmost0.5[26]. FromProposition24(replacingùõø/2byùõø/3),apatternwithqP ‚â•ùúâ
Usingtheresultabove,weprovethefollowingboundstothe has,withprobability‚â•1‚àíùõø/3,itsestimateqP(D) ‚â•ùúâ‚àíùúÄ 1,where
supportsandqualitiesforallsubgroups. ‚àöÔ∏Ñ
ùúÄ =
2ùëß+ln(cid:0)(cid:205) ùëñùëß =1(cid:0)ùëë ùëñ(cid:1)(cid:1)+ln(cid:0) ùõø3(cid:1)
.
1 2ùëö
18A.7 DetailsonCNNinterpretation
Moreover,fromtherelationbetweenqP(D)andq¬ØP(D),itholds
q¬ØP(D) ‚â• ùúâ ‚àí ùúÄ 1 ‚àí ùúÄ ùëáfP(D). Consequently, P is reported in Inthissectionweprovidealldetailsregardingtheapplicationof
output if q¬ØP(D) ‚â• ùúâ ‚àíùúÄ 1 ‚àíùúÄ ùëáfP(D) ‚â• ùúÄ +ùúÄ ùëáfP(D), so if FSRtointerprettheactivationofneuronsinaCNN.Weconsidered
ùúâ ‚â•ùúÄ 1+2ùúÄ ùëáfP(D)+ùúÄ.UsingtheupperboundtofP(D)proved
theMNISThandwrittendigitdataset,andtrainaCNNtopredict
inProposition24(replacingùõø/2byùõø/3),theconditionqP ‚â•ùúâ ‚â• thedigitcontainedineachimage.Followingtheexperimentalsetup
ùúÄ 1+2ùúÄ ùëá(fP+ùúÄ 1)+ùúÄissufficienttoguaranteethat,withprobability of[14],weemployasimpleCNNcomposedby:twoconvolutional
‚â•1‚àíùõø,Pisreportedinoutput,obtainingthestatement. ‚ñ° layers,withrespectively10and40filtersand3√ó3kernels;each
convolutionallayerisfollowedby2√ó2maxpoolinganddropoutof
A.6 Baselinemethods
rate0.25;afullyconnectedlayerwith64nodesandReLuactivations;
InthisSectionweprovideadditionaldetailsonthebaselinealgo-
adropoutlayerwithrate0.5;theoutputlayerofsize10withsoftmax
rithmFSR-U-UBconsideredinourexperimentalevaluation.As activations.Wetrainedthenetworkoverthe60000imagesofthe
anticipatedinSection5,itisnotpossibletoapplystandardstatis- trainingset,usingSGDbasedoncategoricalcrossentropyloss,
ticaltechniques(e.g.,Bonferronicorrection)toboundtheFWER
withlearningrate0.01,momentum0.9,12epochs,andbatchsizeof
whenthenumber|L|oftestedhypothesisisunbounded.Therefore, 128,obtaininganaccuracyof0.987onthe10000holdoutinstances.
toovercomethisissueweproceedasfollows.RecallthatùëÅ L(D)is Then,analogouslyto[14],wecomputedtheactivationsofneurons
thenumberofdistinctprojectionsofthelanguageLonthedataset inthefirstfilterofthefirstconvolutionallayeronthe10000testing
D(definedinAppendixA.5).ThekeyideaforFSR-U-UBistoapply instances,obtainingùëë = 676continuousfeaturesforùëö = 10000
aBonferronicorrectionontheùëÅ L(D)distincttestedhypothesis transactions. As binary target, we use the value 1 for all digits
only.Wedosowiththefollowingresult,thatdefinesthevalueofùúÄ containingstraightlinesonly(thedigits1and7),and0forallother
usedbyFSR-U-UBinAlgorithm1toboundtheFWER.Notethat
digits.Doingso,weobtainafractionùúá(D)=0.216ofsampleswith
FSR-U-UBdoesnotuseanyresamples,butusesùëÅ L(D)toobtain label1.WeranFSR-Conthisdataset,usingùëê =10resamplesand
ananalyticalvalueforùúÄinstead. ùëß = 1,toidentifysignificantsubgroupswithFWER ‚â§ 0.05.For
eachneuron,weidentifythemostsignificantsubgroupcontaining
Theorem25. LetDbeadatasetofùëösamplestakeni.i.d.from aconditionoverthecorrespondingcontinuousfeatureùë•.Wefocus
a distributionùõæ. For anyùõø ‚àà (0,1), defineùúà ùëá ‚â• ùúá(1‚àí ùúá),ùúà ‚â• onconditionsofthetypeùë• ‚â• ùë° andùë• < ùë°,whereùë° isanyreal
ùúà ùëá sup P‚ààL‚òÖ{E D[fP(D)]},ùëÅÀÜ ‚â•ùëÅ L(D),andùúÄas valuedthreshold;theconditionùë• ‚â•ùë° denotesthattheneuronùë• is
ùëüÀÜ=‚àöÔ∏Ñ ln(4 ùõøùëÅÀÜ ) wac it ti hva ate vd a, luw eit ah tv mal ou se ts ùë°a .tleastùë°,whileùë• <ùë°meansthatùë•isinactive,
2ùëö
InFigure4weshowtheresultsofthisexperiment.Figures4-
ùëëÀÜ=ùëüÀÜ+(cid:118)(cid:117)(cid:116)(cid:32)
2ùúà
ùëá
ln(cid:0) ùõø4(cid:1)(cid:33)2
+
2ùëüÀÜln(cid:0) ùõø4(cid:1)
+
2ùúà
ùëá
ln(cid:0) ùõø4(cid:1) ( la a) bea ln 1d (( cb o) rs rh eo spw ot nh de ina gve tr oa tg he ea dc it giv ita sti 1on anv dal 7u )e as no dfa lall bn ele 0ur (o an lls ow thit eh
r
ùëö ùëö ùëö
digits).Then,inFigure4-(c)weshowtheneuronswithactivation
(cid:118)(cid:116) (cid:16) (cid:17) conditionssignificantlyassociatedtothetargetlabel1:neurons
ùúÄ (cid:17)ùëëÀÜ+
2ln(cid:0) ùõø4(cid:1) ùúà+2ùëëÀÜ
+
ln(cid:0) ùõø4(cid:1)
.
that are significantly activated, i.e., with conditionsùë• ‚â• ùë°, are
ùëö 3ùëö showninred,whileneuronsthataresignificantlyinactive,i.e.,with
Withprobabilityatleast1‚àíùõøoverDitholds conditionsùë• <ùë°,areshowninblue.Thecolorintensity(i.e.,toward
red or blue) depends on the threshold ùë°: for activated neurons
Ps ‚ààu Lp ‚òÖ{qP(D)}‚â§ùúÄ.
itsaturatesatthemaximumactivationvalue,whileforinactive
neuronsattheminimum.Interestingly,weobservethattheneurons
Proof. We follow similar steps taken in the proof of Theo-
inthisfilteraresignificantlyactivatedinthepresenceofacentral
rem 11; however, the key difference is in the upper boundùëüÀÜ to
verticalstroke(redpixels),thatspecificallycharacterizesthedigits
E R‚òÖ[ùëëÀú(R‚òÖ) |A].Wehave,usingHoeffding‚Äôsinequalityandan
1and7(Figure4-(a)).Weremark,however,thatthisobservation
unionbound,thatforanyùë° ‚â•0
isnotimmediatefromtheaverageactivationsalone,andmaybe
Pr (cid:16) ùëëÀú(R‚òÖ ) ‚â•ùë°(cid:17) ‚â§ùëÅ L(D)exp(cid:16) ‚àí2ùëöùë°2(cid:17) ‚â§ùëÅÀÜexp(cid:16) ‚àí2ùëöùë°2(cid:17) . lostwhentheactivationvaluesarebinarized,sinceFSRidentifies
R‚òÖ subgroupsthatpreciselyseparatethetwoclassesofdigitsbyusing
Thisimpliesthat,withprobability‚â•1‚àíùõø/4overR‚òÖ ,itholds granularthreshouldvalues.Onthecountrary,neuronsthatare
‚àöÔ∏Ñ significantlyinactive(bluepixels)aretheonessurroundingthis
ùëëÀú(R‚òÖ ) ‚â§ ln(4 ùõøùëÅÀÜ ) . verticalarea,formingtworoundedshapes,whicharetypicalofthe
2ùëö otherdigits(Figure4-(b)).Interestingly,theseblueregionsseemto
Takingtheexpectationw.r.t.R‚òÖ ,conditionallyonA,provesthat shapethenegativeofthedigits1and7.
E R‚òÖ[ùëëÀú(R‚òÖ)|A] ‚â§ùëüÀÜandgivesthestatement. ‚ñ° FromthisexperimentweconcludethatFSRcanbeeffectively
appliedtoidentifycomplexpatterns,suchastheonesfortheinter-
pretationoftheactivationswithinaneurallayer.
190 0.6
5 0.5
0.4
10
0.3
15
0.2
20
0.1
25 0.0
0 5 10 15 20 25
(a) (b) (c)
Figure4:Averageactivationofneuronsofthefirstfilterinthefirstconvolutionallayer,forthedigits1and7(a)andforthe
otherdigits(b).(c):neuronsthataresignificantlyactivatedforthedigits1and7(inred)andinactive(inblue)identifiedbyFSR.
20
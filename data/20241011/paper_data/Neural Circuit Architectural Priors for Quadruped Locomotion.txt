NEURAL CIRCUIT ARCHITECTURAL PRIORS
FOR QUADRUPED LOCOMOTION
NikhilX.Bhattasali, VenkateshPattabiraman, LerrelPinto, GraceW.Lindsay
NewYorkUniversity
nikhilxb@nyu.edu
ABSTRACT
Learning-based approaches to quadruped locomotion commonly adopt generic
policy architectures like fully connected MLPs. As such architectures contain
fewinductivebiases, itiscommoninpracticetoincorporatepriorsintheform
ofrewards,trainingcurricula,imitationdata,ortrajectorygenerators. Innature,
animals are born with priors in the form of their nervous system’s architecture,
whichhasbeenshapedbyevolutiontoconferinnateabilityandefficientlearning.
Forinstance,ahorsecanwalkwithinhoursofbirthandcanquicklyimprovewith
practice. SucharchitecturalpriorscanalsobeusefulinANNarchitecturesforAI.
Inthiswork,weexploretheadvantagesofabiologicallyinspiredANNarchitecture
forquadrupedlocomotionbasedonneuralcircuitsinthelimbsandspinalcord
ofmammals. Ourarchitectureachievesgoodinitialperformanceandcomparable
finalperformancetoMLPs,whileusinglessdataandordersofmagnitudefewer
parameters. Ourarchitecturealsoexhibitsbettergeneralizationtotaskvariations,
evenadmittingdeploymentonaphysicalrobotwithoutstandardsim-to-realmeth-
ods. Thisworkshowsthatneuralcircuitscanprovidevaluablearchitecturalpriors
forlocomotionandencouragesfutureworkinothersensorimotorskills.
1 INTRODUCTION
Learning-basedapproachestoquadrupedlocomotioncommonlyadoptgenericpolicyarchitectures
likefullyconnectedmultilayeredperceptrons(MLPs)(Rudinetal.,2022;Smithetal.,2022;Agarwal
etal.,2022). Assucharchitecturescontainfewinductivebiases,theymustrelyontrainingtodevelop
desiredbehaviors. Simplerewardfunctionsoftendonotleadtonaturalisticorrobustbehavior(Heess
etal.,2017). Therefore,itiscommoninpracticetoincorporatepriorsintheformofrewards(Rudin
etal.,2022),trainingcurricula(Agarwaletal.,2022;Rudinetal.,2022),imitationdata(BinPeng
etal.,2020;Mereletal.,2019b),ortrajectorygenerators(Schaal,2006;Iscenetal.,2019).
Innature,animalsarebornwithpriorsintheformoftheirnervoussystem’sarchitecture,whichhas
beenshapedbyevolutiontoconferinnateabilityandefficientlearning(Zador,2019;Cisek,2019).
For instance, a horse can walk within hours of birth and can quickly improve with practice, and
humanshavestronginductivebiasesforperceivingandinteractingwiththeworld(Lakeetal.,2017).
Theseinductivebiasesareareflectionofhighlystructuredneuralcircuitconnectivity(Luo,2021),
whichcombinesinnateandlearningmechanismsinstarkcontrasttogenericANNarchitectures.
CansucharchitecturalpriorsalsobeusefulinANNarchitecturesforAI?Bhattasalietal.(2022)
investigatedthisbyintroducingNeuralCircuitArchitecturalPriors(NCAP).Usingacasestudyofthe
nematodeC.elegans,theproposedSwimmerNCAPtranslatedneuralcircuitsforswimmingintoan
ANNarchitecturecontrollingasimulatedagentfromanAIbenchmark(Tassaetal.,2020). Swimmer
NCAPachievedgoodperformance,dataefficiency,andparameterefficiencycomparedtoMLPs,and
itsmodularityfacilitatedinterpretationandtransfertonewbodydesigns. Assuch,SwimmerNCAP
demonstratedseveralpossibleadvantagesofbiologicallyinspiredarchitecturalpriorsforAI.
However, it remained unknown whether the approach could scale to more complex animals and
tasks. C.eleganshasanervoussystemofonly302neuronsandhighlystereotypedconnectivity,
anditsconnectomehaslongbeenmapped(Whiteetal.,1986). Incontrast, mammaliannervous
systemshavemillionsorbillionsofneurons(Herculano-Houzeletal.,2006;2007)withmorevariable
connectivityandnomappedconnectome,soitwasnotobvioushowsuchcircuitscouldinspireAI.
1
4202
tcO
9
]CN.oib-q[
1v47170.0142:viXraInthiswork,weintroduceQuadrupedNCAP,abiologicallyinspiredANNarchitectureforquadruped
locomotionbasedonneuralcircuitsinthelimbsandspinalcordofmammals. Ourkeyinsightsfor
scalinguptheNCAPapproachare: modelingatthelevelofgeneticallydefinedneuralpopulations
(Danneretal.,2017;Ausbornetal.,2019;Kimetal.,2022)ratherthanatthelevelofsingleneurons,
leveragingmachinelearningtocompensateforgapsindetailedcircuitknowledge,andintroducing
methodologicalinnovationstoimprovethearchitecture’sexpressivityandtrainability(Section2).
Together,theseinsightsenablethearchitecturetosuccessfullycontrolquadrupedlocomotion,which
isamuchhardertaskthanplanarswimmingduetoitshigherdimensionalityandinherentinstability.
We test the value of our architectural prior by comparing to an architecture without priors: the
MLP, which is commonly used in robotics. Quadruped NCAP achieves good initial (untrained)
performanceandcomparablefinal(asymptotic)performancetoMLPs, whileusinglessdataand
ordersofmagnitudefewerparameters. Ourarchitecturealsoexhibitsbettergeneralizationtotask
variations,evenadmittingdeploymentonaphysicalrobotwithoutstandarddomainrandomization
methodsthatareoftenneededforsim-to-realgeneralization. Thisworkshowsthatneuralcircuits
canprovidevaluablearchitecturalpriorsforlocomotioninmorecomplexanimalsandencourages
futureworkinyetmorecomplexsensorimotorskills.
Thekeycontributionsofthisworkare:
1. Firstneuralcircuitmodelforquadrupedalrobotlocomotion. Wedesignanarchitecture
thatscalesupNCAPtoquadrupedlocomotion. Whilemanyrelatedworksinlocomotionhave
beeninspiredbybiology(Section2),tothebestofourknowledgethisworkisthefirsttouse
geneticallydefinedneuralcircuitstocontrollocomotioninastandardquadrupedrobot.
2. Extensiveevaluationinsimulation. WeextensivelyevaluateNCAPintermsofperformance,
dataefficiency,parameterefficiency,andgeneralizationtoterrainandbodyvariations. NCAP
learnsmorenaturalisticgaits,withuptomillionsoffewertimestepsandordersofmagnitude
fewerparametersthanMLP,whilebeingmorerobusttounseenconditions.
3. Deploymentonthephysicalrobot. WedeployNCAPtothephysicalrobottotestitsgener-
alizationacrossalargesim-to-realdomaingap. WhileMLPfallsimmediately,NCAPwalks
successfully.
Ouropen-sourcecodeandvideosareavailableat: https://ncap-quadruped.github.io/
2 RELATED WORK
Ourworkbuildsonanextensiveliteratureinneuroscience,robotics,andartificialneuralnetworks.
Forconciseness,wehighlightthemostrelevantonestoourwork:
CentralPatternGenerators Centralpatterngenerators(CPGs)areneuralcircuitsthatproduce
rhythmicactivityintheabsenceofrhythmicinputs,andtheyunderliemanymovementsincluding
chewing,breathing,andlocomotion. RoboticistshavedevelopedCPG-likecontrollersforavarietyof
tasks,andthesecontrollerscomeindiverseforms(Ijspeert,2008;Yuetal.,2014). Forexample,the
desiredmovementcanbedirectlyengineeredusingtrajectorygenerators(forinstance,swing/stance
trajectories)thatareadjustedbyahigher-levelcontroller(Iscenetal.,2019). Alternatively,apolicy
can adopt an action space of controllable abstract oscillators to flexibly modulate (Bellegarda &
Ijspeert,2022;Shafieeetal.,2023). Inthiswork,wetakeabiologicallyconstrainedapproachthat
instantiatesaCPGusinganetworkofneurons,someofwhichhaveintrinsicburstingdynamics.
NeuromechanicalModels Neuromechanicalmodelsareusedincomputationalneuroscienceto
developinsightsabouttheinteractionsbetweenthemusckuloskeletalsystemandthenervoussystem
(Ausbornetal.,2021;Markinetal.,2016). Recently,severalneuromechanicalmodelshavebeen
developedfortherodent(Mereletal.,2019a;TataRamalingasettyetal.,2021)andthefly(Lobato-
Riosetal.,2022;Wang-Chenetal.,2023),whichwillenablenewunderstandingabouthowanimals
performmovement. Inthiswork,webuilduponinsightsgleanedfromneuromechanicalmodels,but
ourgoalisnottocontrolarealisticmusckuloskeletalsimulation. Rather,weaimtotranslateinsights
frombiologytoAIandrobotics,whichleadsustomodelatahigherlevelofabstraction.
2ArchitecturalPriors ArchitecturalpriorsincorporatestructureintoanANNtoimproveperfor-
manceandefficiency. Forexample, convolutionalneuralnetworksinspiredbythevisualsystem
incorporate translation invariance over images (Lindsay, 2021). In locomotion, various kinds of
architecturalpriorhavebeenexplored,includingpriorsontaskandbodysymmetries(Mittaletal.,
2024;Ding&Gan,2024),spring-loadedinvertedpendulumdynamics(Ordonez-Apraezetal.,2022),
and hierarchy (Heess et al., 2016; 2017). In this work, we explore priors based on genetically
definedneuralcircuits,similartoconnnectome-constrainednetworksexploredinthevisionliterature
(Lappalainenetal.,2024). Ourpriorisencodedthroughsparseandstructuredconnectivity,weight
signconstraints,weightinitializations,bilateralsymmetry,andintrinsicneuraldynamics.
SwimmerNCAP Inthiswork,webuildonSwimmerNCAP(Bhattasalietal.,2022)byscaling
ittomorecomplexsettings. Theanimalswestudyaremorecomplex: mammalshavemuchlarger
andlessunderstoodnervoussystemsthannematodes. TheAItaskswetacklearealsomuchharder:
the Quadruped is a higher-dimensional inherently unstable body, while the Swimmer is a lower-
dimensionalinherentlystable(planar)body. Wealsoevaluateonaphysicalrobot, incontrastto
previousworkinsimulationonly. Thus,ourworkaddressesproblemsthatareespeciallyrelevant
forAI.Scalingtomorecomplexsettingsrequiresnovelmethodologicalinnovations: (1)Weadopt
acontinuous-timeformulationofANNs, incontrasttothediscrete-timeSwimmer. (2)Webuild
a recurrent architecture in the Rhythm Generation (RG) module, in contrast to the feedforward
Swimmer. (3)Wedevelopaclosed-loopOscillatorunitthatadmitsperiodmodulation,phaseshifts,
andentrainment,incontrasttotheopen-loopOscillatorunitinSwimmerthatdoesnotrespondto
inputsignals. (4)Wemodelcircuitsatthelevelofneuralpopulations,ratherthanatthelevelofsingle
neurons. (5) We enable the architecture to learn unknown connections in the Afferent Feedback
(AF)andPatternFormation(PF)modulesbyleavingcertainconnectivityandsignsunconstrained,
incontrasttotheSwimmerwhichfullyconstrainedconnectivityandsigns. Together,thesenovel
insightsandmethodscanhelpthecommunityadvancebiologicallyinspiredarchitecturalpriors.
3 METHODS
WetranslateneuroscientificmodelsofquadrupedlocomotioncircuitsintoanANNarchitecturefor
controllingarobot. InSection3.1,wereviewkeybackgroundabouttheneuroscienceoflocomotion.
InSection3.2,wedescribethecomputationalunitsthatarebuildingblocksinourQuadrupedNCAP
architecture. InSection3.3,wedescribetheconnectivityofNCAPanditsinterfacewiththerobot.
3.1 BIOLOGICALLOCOMOTION
Quadrupeds locomote by rhythmically flexing and extending their limbs in a coordinated gait to
propelthebodyforward. Theycontroltheirvelocitybyproducingvariousgaits(suchaswalk,trot,
gallop,andbound),andtheyadapttodifferentconditionsusingsensoryinformation. Quadruped
mammals(includingmice,cats,dogs,andhorses)exhibitconsiderabledifferencesinappearance,
but comparative anatomical studies have revealed a remarkable homology in body structure and
neuralcircuitrybetweenthem,whichmakessensegiventheirsharedevolutionaryheritage(Grillner
& El Manira, 2020). Neuroscience research across many animal systems has shed light on how
locomotionisachievedthroughthecomplexinteractionbetweenthemusculoskeletalsystemand
neural circuits in the limbs, spinal cord, and higher brain regions (Grillner & El Manira, 2020).
Surprisingly,neuralcircuitsinthelimbsandspinalcordaresufficienttoproducelocomotion,while
higherbrainregionsareimportanttoinitiateandregulatelocomotion(Rybaketal.,2015). Classic
studiesstrikinglydemonstratedevidenceofsuchorganizationusingdecerebrateanimals,inwhich
mostofthebrainwasseveredfromthespinalcord,yettheanimalcouldstillwalkandeventransition
betweengaitswhentuggedalongatreadmill(Whelan,1996).Recentstudieshaveleveragedadvances
inexperimentaltoolslikemoleculargeneticstopreciselymapandmanipulatelocomotorcircuits
withcell-typespecificity(Kiehn,2016;Ausbornetal.,2021).
Wesummarizebelowawell-supportedneuroscientificmodeloflocomotorcircuits(Figure1),which
is based on data from cats and transgenic mice, and which adopts the abstraction of genetically
definedneuralpopulationswithrate-codedactivity. Fordetails,pleaserefertothereferencedworks.
3A Locomotion is produced through B RG coordinates rhythm between limbs while
limb and spinal cord neural circuits BC controls speed and gait
Between limbs Hind-Left (HL) Fore-Left (FL)
Side
E F E F
Diagonal
Brainstem
Within limb
C PF activates muscles within limb while
AF provides sensory feedback Side
E F E F
Rhythm
generation E Extensor Flexor F Hind-Right (HR) Fore-Right (FR)
Pattern
formation
Excitatory
Motor Afferent Inhibitory
neurons feedback Proprioceptive
Muscles
Figure1|BiologicalLocomotion. A,Quadrupedmammalsshareahomologousorganizationof
their musculoskeletal systems and neural circuits. Surprisingly, neural circuits in the limbs and
spinalcordaresufficienttoproducelocomotion,whilehigherbrainregionsareimportanttoinitiate
andregulatelocomotion. B,Neuralcircuitsforrhythmgeneration(RG)andbrainstemcommand
(BC),adaptedfromDanneretal.(2017). Eachlimbiscontrolledbyflexor(F)andextensor(E)half-
centers. Betweenlimbs,half-centerscommunicatethroughconnectionsthatpromotesynchonization
oralternation. Brainstemcommandsignalsmodulatethehalf-centersandconnectionactivations.
C,Neuralcircuitsforpatternformation(PF)andafferentfeedback(AF),adaptedfromKimetal.
(2022). Withinlimbs,interneuronsandmotorneuronsconverthalf-centerstatesintospecificmuscle
commands,whilesensoryfeedbackmodulatesthecircuitatmultiplelevels.
RhythmGeneration TheRGneuralcircuitwithinthespinalcordcoordinateslimbstoproduce
gaitrhythms(Figure1B).Eachlimbiscontrolledbyahalf-centermicrocircuitconsistingofaflexor
center with intrinsically bursting neurons and an extensor center with tonic firing neurons. The
paired centers inhibit each other, leading to oscillating flexion and extension in each limb. The
half-centersforthefourlimbscommunicatethrough“cross”connections(cervical/lumbarcommis-
suralinterneurons), “side”connections(homolaterallongpropriospinalneurons), and“diagonal”
connections(diagonallongpropriospinalneurons),thusenablingbilateralandascending/descending
communication. Inessence,excitatoryconnectionsbetweenhalf-centerspromotesynchronization
andinhibitoryconnectionspromotealternation,sothespeed-dependentactivationofthesevarious
connectionschangethetimingbetweenlimbsandthereforethegait. (Danneretal.,2017)
BrainstemCommand TheBCneuralcircuitinthebrainstemconveyscommandsignalstoadjust
locomotor speed and gait (Figure 1B). It does so via two pathways: one controlling speed by
modulatingtheintrinsicperiodofRGoscillators,andonecontrollinggaitbymodulatingthe“cross”
and“diagonal”RGconnectionsthatpromotesynchronizationoralternation. (Ausbornetal.,2019)
PatternFormation ThePFneuralcircuitwithineachlimbconvertshalf-centerstatesintomuscle
activations(Figure1C).Thiscircuitofinterneuronsandmotorneuronsformsa2-levelhierarchyin
4
ssorC ssorCA Basic Unit activates proportionally in response to input
Excitatory <latexit sha1_base64="PNkitzzBcp5Ly3EbgMOHjUXAaoo=">AAACE3icbVC7SgNBFJ31GdfXqp02g0EIFmFX8FFGbSwsIuQF2RBmJ3eTwdnZZWY2EJb8g42/YmOhiK2NnYWFvR/h5FH4OnDhcM69d+aeIOFMadd9s2Zm5+YXFnNL9vLK6tq6s7FZU3EqKVRpzGPZCIgCzgRUNdMcGokEEgUc6sH1+civ90EqFouKHiTQikhXsJBRoo3Udvb9ALpMZERKMhhmdGhX2n3ft89MhaZ8EJ2p2XbybtEdA/8l3pTkS4WPy8/T9+1y23n1OzFNIxCacqJU03MT3TLbNKMchrafKkgIvSZdaBoqSASqlY1vGuI9o3RwGEtTQuOx+n0iI5FSgygwnRHRPfXbG4n/ec1UhyetjIkk1SDo5KEw5VjHeBQQ7jAJVPOBIYRKZv6KaY9IQrWJ0TYheL9P/ktqB0XvqHh4ZdLAaIIc2kG7qIA8dIxK6AKVURVRdIPu0AN6tG6te+vJep60zljTmS30A9bLF4WkoYo=</latexit>Tv Voltage time
Inhibitory B Bias voltage Input
f Activation function
B Oscillator Unit scales its intrinsic period and entrains its phase in response to input
Excitatory <latexit sha1_base64="Jb/A1nG8G5IxzypZJvGFWzwIB9E=">AAACaXicbVHPS9xAFJ6ktq6prbFikfYydCl4kCUR1OJFsZeCFwu7q7BZwmT2ZXdwMokzL0uXEPBv9CLi3Usv/RM6+6PQrn3who/vfe+9mW+SQgqDQfDguC9WXr5abax5r9ffvN3wN991TV5qDh2ey1xfJcyAFAo6KFDCVaGBZYmEy+T667R+OQZtRK7aOCmgn7GhEqngDC0V+7dRAkOhKqY1m9QVrz2vHUcIP7BiHMUY6j36h7gpBWAdRd75suJ8WdFdEJgrwadEO2b2PLOZ2oxADRYrY78ZtIJZ0OcgXIDm6fG9//ire3IR+3fRIOdlBgq5ZMb0wqDAvp2Ggkuovag0UDB+zYbQs1CxDEy/mjlV08+WGdA01zYV0hn7d0fFMmMmWWKVGcORWa5Nyf/VeiWmX/qVUEWJoPh8UVpKijmd2k4HQgNHObGAcS3sXSkfMW0dtJ/jWRPC5Sc/B939VnjYOvhu3aBkHg3ykXwiuyQkR+SUfCMXpEM4eXLWnW3nvfPT3XR33A9zqesserbIP+E2fwOVLL8Z</latexit>Tactive,Tquiet Active/quiet time
Inhibitory
Kactive,Kquiet Active/quiet scale
Input
Vtonic Tonic threshold
Ta Adaptation time
B Bias voltage
f Activation function Input
Figure2|ArchitectureUnits. Thearchitectureuses2neurontypes,bothofwhichoutputrate-coded
activityandcanreceiveexcitatoryorinhibitorysynapticinput. Foreachtype,weshowthecircuit
schematicsymbol(left),keyhyperparameters(middle),andanexamplewaveformresponsetoinput
(right). A,TheBasicunitisatypicalneuronthatactivatesproportionallyinresponsetoinputonce
itsinternalvoltageexceedsathreshold. Thisunitisusedformostneuronsinthearchitecture. B,
TheOscillatorunitisaspecialneuronthatexhibitsintrinsicallyburstingactivityintheabsenceof
inputs. Itscalesitsintrinsicperiodinresponsetoconstantinput,anditentrainsitsphaseinresponse
toperiodicinput. Thisunitisusedfortheflexorhalf-centersintheRGmodule.
whichflexionandextensionsignalsareexpandedindimensionalitytoproducepreciseactivation
signalsforeachmuscle. (Kimetal.,2022)
AfferentFeedback TheAFneuralcircuitwithineachlimbusessensoryinformationtomodulate
RGandPFactivity(Figure1C).Musclesensorsproducelength-,velocity-,andforce-relatedsignals,
andfootsensorsdetecttactilestimulation. ThesesignalstriggerreflexesinPFandadvance/delay
half-centerstatesinRGtoentrainneuralactivitywithmusculoskeletalconditions. (Kimetal.,2022)
3.2 ARCHITECTUREUNITS
OurNCAParchitectureadoptsacontinuous-timeframeworkformodelingneurons. Wefindthat
2computationalunitscancapturethecelltypesinthiscircuit: aBasicunitandanOscillatorunit
(Figure2). Manyneuromechanicalmodelingworks,includingDanneretal.(2017),usebiophysical
neuron models that incorporate the conductances, reversal potentials, and activation/inactivation
dynamics of ion channel currents (for instance, a persistent sodium current for bursting). Such
complexity is not needed for AI purposes, so we follow Bhattasali et al. (2022) by simplifying
theseneuronstocreatecomputationalunitswithfewerandmoreinterpretablehyperparameters. We
describebelowthemainpropertiesoftheseunits. Fordetailsandequations,pleaseseeAppendixA.1.
BasicUnit Thisneuronmodelisstandardincomputationalneuroscience. Rate-codedinputsraise
orlowertheinternalvoltage,whichisleaky. Iftheinternalvoltagerisesbeyondathreshold,the
neurongeneratesrate-codedoutputactivityaccordingtoanactivationfunction.
\begin{array}{c}
OscillatorUnit Thisneuronmodelabstractsanintrinsicallyburstingneuron(Danneretal.,2017).
T_v\\
Itgeneratesoscillatingoutputactivityintheabsenceofinputs.BI\n\responsetoinputs,itscalesits
active and quiet phases, and it transitions to a silent mode undfe\r\strong inhibition and to a tonic
modeunderstrongexcitation. Thesepropertiesenabletheunitto\esnhdi{fatrirtsayo}scillationphasetopulse
waveforms,andentrainitsoscillationphasetoperiodicwaveforms. Weprovideadetailedderivation
andevaluationofthismodelinaconcurrentmanuscript(Bhattas\ableigeitn{aal.r,r2a0y2}{4c,}insubmission).
T_\text{active}, T_\text{quiet}\\
K_\text{active}, K_\text{quiet}\\
3.3 ARCHITECTURESTRUCTURE
V_\text{tonic}\\
T_a\\
RobotBody WetargetastandardroboticbodyinordertoinvB\e\stigatetheeffectivenessofarchi-
tecturalpriorsinAIsettings(Figure3A).Unlikeanimals,therof\b\otdoesnotusehighlyredundant
musclesthatproducelinearforce;instead,itusesasinglerotat\ioennda{lamrroatyo}rperjointthatproduces
5A Quadruped robot body B Quadruped NCAP architecture
Flx Flx
+ Abd HL FL
– Add Ext Ext
RG c<latexit sha1_base64="ZBU8M2IG1MKCuR9MWVEbn71lMEM=">AAAB6nicbVBNS8NAEJ3Ur1q/qh69LBbBU0nEqseCF48V7Qe0oWy2m3bpZhN2J0IJ/QlePCji1V/kzX/jts1BWx8MPN6bYWZekEhh0HW/ncLa+sbmVnG7tLO7t39QPjxqmTjVjDdZLGPdCajhUijeRIGSdxLNaRRI3g7GtzO//cS1EbF6xEnC/YgOlQgFo2ilB9bHfrniVt05yCrxclKBHI1++as3iFkacYVMUmO6npugn1GNgkk+LfVSwxPKxnTIu5YqGnHjZ/NTp+TMKgMSxtqWQjJXf09kNDJmEgW2M6I4MsveTPzP66YY3viZUEmKXLHFojCVBGMy+5sMhOYM5cQSyrSwtxI2opoytOmUbAje8surpHVR9a6qtfvLSp3kcRThBE7hHDy4hjrcQQOawGAIz/AKb450Xpx352PRWnDymWP4A+fzB0pEjbY=</latexit> t
Flx Flx
HR FR
+ Ext – Flx Ext Ext
Observations: Joint positions
Joint velocities
Joint torques
Foot contact pressures
<latexit sha1_base64="h0kG3OrvpCPBXY6pMxjrn1c6R/0=">AAAB9HicbVDLTgJBEJzFF+IL9ehlIjHxRHaNryOJFw4eMJFHAiuZHWZhwuzMOtNLJBu+w4sHjfHqx3jzbxxgDwpW0kmlqjvdXUEsuAHX/XZyK6tr6xv5zcLW9s7uXnH/oGFUoimrUyWUbgXEMMElqwMHwVqxZiQKBGsGw5up3xwxbbiS9zCOmR+RvuQhpwSs5KsuPHSAPUFavZ10iyW37M6Al4mXkRLKUOsWvzo9RZOISaCCGNP23Bj8lGjgVLBJoZMYFhM6JH3WtlSSiBk/nR09wSdW6eFQaVsS8Ez9PZGSyJhxFNjOiMDALHpT8T+vnUB47adcxgkwSeeLwkRgUHiaAO5xzSiIsSWEam5vxXRANKFgcyrYELzFl5dJ46zsXZYv7s5LFZzFkUdH6BidIg9doQqqohqqI4oe0TN6RW/OyHlx3p2PeWvOyWYO0R84nz8N25Ix</latexit>oHL <latexit sha1_base64="xhVzpFNZnSLaHYxevLL5xw/+vlU=">AAAB9HicbVDJSgNBEK2JW4xb1KOXxiB4CjPidgx4ycFDBLNAMoaeTk/SpGexuyYYhnyHFw+KePVjvPk3dpI5aOKDgsd7VVTV82IpNNr2t5VbWV1b38hvFra2d3b3ivsHDR0livE6i2SkWh7VXIqQ11Gg5K1YcRp4kje94c3Ub4640iIK73Ecczeg/VD4glE0kku7+NBB/oRp9XbSLZbssj0DWSZORkqQodYtfnV6EUsCHiKTVOu2Y8foplShYJJPCp1E85iyIe3ztqEhDbh209nRE3JilB7xI2UqRDJTf0+kNNB6HHimM6A40IveVPzPayfoX7upCOMEecjmi/xEEozINAHSE4ozlGNDKFPC3ErYgCrK0ORUMCE4iy8vk8ZZ2bksX9ydlyokiyMPR3AMp+DAFVSgCjWoA4NHeIZXeLNG1ov1bn3MW3NWNnMIf2B9/gD37JIj</latexit>aHL o<latexit sha1_base64="J2UCSfOwyBC51ha5A+A6B+EuSqM=">AAAB9HicbVDLSgNBEJyNrxhfUY9eBoPgKeyKr2NAEA8eIpgHJGuYncwmQ2Zn1pneYFjyHV48KOLVj/Hm3zhJ9qCJBQ1FVTfdXUEsuAHX/XZyS8srq2v59cLG5tb2TnF3r25UoimrUSWUbgbEMMElqwEHwZqxZiQKBGsEg6uJ3xgybbiS9zCKmR+RnuQhpwSs5KsOPLSBPUF6fTvuFEtu2Z0CLxIvIyWUodopfrW7iiYRk0AFMabluTH4KdHAqWDjQjsxLCZ0QHqsZakkETN+Oj16jI+s0sWh0rYk4Kn6eyIlkTGjKLCdEYG+mfcm4n9eK4Hw0k+5jBNgks4WhYnAoPAkAdzlmlEQI0sI1dzeimmfaELB5lSwIXjzLy+S+knZOy+f3Z2WKjiLI48O0CE6Rh66QBV0g6qohih6RM/oFb05Q+fFeXc+Zq05J5vZR3/gfP4ACs+SLw==</latexit> FL <latexit sha1_base64="xNzI90q/w+0iYpMUKeYwXig64Xg=">AAAB9HicbVDJSgNBEK2JW4xb1KOXxiB4CjPidgwI4sFDBLNAMoaeTk/SpGexuyYYhnyHFw+KePVjvPk3dpI5aOKDgsd7VVTV82IpNNr2t5VbWl5ZXcuvFzY2t7Z3irt7dR0livEai2Skmh7VXIqQ11Cg5M1YcRp4kje8wdXEbwy50iIK73EUczegvVD4glE0kks7+NBG/oTp9e24UyzZZXsKskicjJQgQ7VT/Gp3I5YEPEQmqdYtx47RTalCwSQfF9qJ5jFlA9rjLUNDGnDtptOjx+TIKF3iR8pUiGSq/p5IaaD1KPBMZ0Cxr+e9ifif10rQv3RTEcYJ8pDNFvmJJBiRSQKkKxRnKEeGUKaEuZWwPlWUocmpYEJw5l9eJPWTsnNePrs7LVVIFkceDuAQjsGBC6jADVShBgwe4Rle4c0aWi/Wu/Uxa81Z2cw+/IH1+QP04JIh</latexit>aFL
Actions: Joint position targets <latexit sha1_base64="6fQIRm5xse6bF7quv/aSiPU3N7o=">AAAB9HicbVDLTgJBEJzFF+IL9ehlIjHxRHaNryOJF45o5JHASmaHWZgwO7PO9BLJhu/w4kFjvPox3vwbB9iDgpV0UqnqTndXEAtuwHW/ndzK6tr6Rn6zsLW9s7tX3D9oGJVoyupUCaVbATFMcMnqwEGwVqwZiQLBmsHwZuo3R0wbruQ9jGPmR6QvecgpASv5qgsPHWBPkFbvJt1iyS27M+Bl4mWkhDLUusWvTk/RJGISqCDGtD03Bj8lGjgVbFLoJIbFhA5Jn7UtlSRixk9nR0/wiVV6OFTalgQ8U39PpCQyZhwFtjMiMDCL3lT8z2snEF77KZdxAkzS+aIwERgUniaAe1wzCmJsCaGa21sxHRBNKNicCjYEb/HlZdI4K3uX5Yvb81IFZ3Hk0RE6RqfIQ1eogqqohuqIokf0jF7RmzNyXpx352PemnOymUP0B87nDxb5kjc=</latexit>oHR t a<latexit sha1_base64="aXpcsftxF72z/HWdNmiYEw247Fs=">AAAB9HicbVDJTgJBEK3BDXFDPXrpSEw8kRnjdiTxwhGNLAmMpKfpgQ49i901RDLhO7x40Bivfow3/8YG5qDgSyp5ea8qVfW8WAqNtv1t5VZW19Y38puFre2d3b3i/kFDR4livM4iGamWRzWXIuR1FCh5K1acBp7kTW94M/WbI660iMJ7HMfcDWg/FL5gFI3k0i4+dJA/YVq9m3SLJbtsz0CWiZOREmSodYtfnV7EkoCHyCTVuu3YMbopVSiY5JNCJ9E8pmxI+7xtaEgDrt10dvSEnBilR/xImQqRzNTfEykNtB4HnukMKA70ojcV//PaCfrXbirCOEEesvkiP5EEIzJNgPSE4gzl2BDKlDC3EjagijI0ORVMCM7iy8ukcVZ2LssXt+elCsniyMMRHMMpOHAFFahCDerA4BGe4RXerJH1Yr1bH/PWnJXNHMIfWJ8/ARmSKQ==</latexit> HR t <latexit sha1_base64="u1x6KrsddMS0RnypPAEYHwxSne0=">AAAB9HicbVDLSgNBEJyNrxhfUY9eBoPgKeyKr2NAEI9RzAOSNcxOZpMhszPrTG8wLPkOLx4U8erHePNvnCR70MSChqKqm+6uIBbcgOt+O7ml5ZXVtfx6YWNza3unuLtXNyrRlNWoEko3A2KY4JLVgINgzVgzEgWCNYLB1cRvDJk2XMl7GMXMj0hP8pBTAlbyVQce2sCeIL2+G3eKJbfsToEXiZeREspQ7RS/2l1Fk4hJoIIY0/LcGPyUaOBUsHGhnRgWEzogPdayVJKIGT+dHj3GR1bp4lBpWxLwVP09kZLImFEU2M6IQN/MexPxP6+VQHjpp1zGCTBJZ4vCRGBQeJIA7nLNKIiRJYRqbm/FtE80oWBzKtgQvPmXF0n9pOydl89uT0sVnMWRRwfoEB0jD12gCrpBVVRDFD2iZ/SK3pyh8+K8Ox+z1pyTzeyjP3A+fwAT7ZI1</latexit>oFR t <latexit sha1_base64="HXFFN2XllVRtnXGjb61l9cQS884=">AAAB9HicbVDJSgNBEO2JW4xb1KOXxiB4CjPidgwI4jGKWSAZQ0+nJmnSs9hdEwxDvsOLB0W8+jHe/Bs7yRw08UHB470qqup5sRQabfvbyi0tr6yu5dcLG5tb2zvF3b26jhLFocYjGammxzRIEUINBUpoxgpY4EloeIOrid8YgtIiCu9xFIMbsF4ofMEZGsllHXxoIzxhen037hRLdtmegi4SJyMlkqHaKX61uxFPAgiRS6Z1y7FjdFOmUHAJ40I70RAzPmA9aBkasgC0m06PHtMjo3SpHylTIdKp+nsiZYHWo8AznQHDvp73JuJ/XitB/9JNRRgnCCGfLfITSTGikwRoVyjgKEeGMK6EuZXyPlOMo8mpYEJw5l9eJPWTsnNePrs9LVVoFkeeHJBDckwcckEq5IZUSY1w8kieySt5s4bWi/Vufcxac1Y2s0/+wPr8Af3+kic=</latexit>aFR t
t t t t
Figure3|ArchitectureStructure. A,TheQuadrupedrobothas4limbs,eachwith3joints(hip,
thigh,calf)and1footpad. TheANNagentreceivesproprioceptive/pressureobservations,andit
producesjointpositiontargetactionsthatareconvertedtoactuatortorquecommandsbyalow-level
PDcontroller. B,TheQuadrupedNCAParchitecturemirrorsmammalianlocomotioncircuits. The
RGmodulereceivesbrainstemcommandsc thatsetthespeedandgait. EachlimbhasanAFmodule
t
thatuseslegobservationso tomodulateRGoscillators,aswellasaPFmodulethatconvertsRG
t
half-centerstatesintolegactionsa .
t
torque. Ourarchitecturecontrollingthisbodymusttranslatebetweenbiologicalneuralcircuitryand
theartificialagentinterface. Fortheobservationspace,theagentreceivesjointpositions,velocities,
andtorquesaswellasfootcontactpressures.Fortheactionspace,theagentproducestargetjointposi-
tions,whichareconvertedtoactuatortorquecommandsbyalow-levelPDcontroller(AppendixB.1).
Whilethisinterfaceissimplifiedcomparedtobiology,itreasonablyapproximateshowmuscleshave
aneteffectofsettingajoint’sequilibriumpositionandstiffness(Shadmehr,1993).
RhythmGeneration WeadapttheRGcircuitfromDanneretal.(2017)touseoursimplifiedBasic
andOscillatorunits. Weeliminateredundantconnectionsandintroducenewnomenclatureforthe
neurontypes. AsdiscoveringtheRGconnectionsisnotanaimofthiswork,wehand-tunetheRG
weightstoproducetheappropriategaittransitionsinresponsetobrainsteminput(FigureA.3),using
thereportedconnectionstrengthsfromDanneretal.(2017)asastartingpoint. Wethenfreezethe
weightsduringtraining. ForafulldiagramoftheRGmodule,pleaseseeAppendixA.2.
BrainstemCommand Weuseasinglebrainstemcommandc tocontroltheRGmodule,whichis
t
task-specificandfrozenduringtraining. Thisenablesustocontrolthegaitpatternexpressedata
particularspeed. Ifnotfrozen,thetrainingusuallyprefersaboundgait,whichisfastestandenables
theagenttomaximizerewardevenonslowspeedtasks. Havinganarchitecturalpriorthusaffordsus
fine-grainedcontroloftheresultingbehaviorwithoutadditionalreward/imitationpriors.
Pattern Formation We use a linear PF layer to map flexor/extensor half-center outputs to leg
actionsa . WeinitializePFweightswithcoarsemagnitudesandcorrectsigns(producingnegative
t
jointpositionsforflexionandpositivejointpositionsforextension)thatareconstrainedaftereach
update. Weshareweightsamongforelimbsandhindlimbstoexploitbilateralsymmetry(FigureD.3),
andweapplytheoverparameterizationtrick(AppendixA.3)toexpandthedimensionalityofweights
duringtrainingandcollapseitduringtesting.
AfferentFeedback WeusealinearAFlayertomaplegobservationso toflexor/extensorinputs.
t
Wenormalizeobservationstotherange[−1,1],thenrectifythemintopositiveandnegativecompo-
nents,sincefiringratescannotbenegative. WeinitializecertainAFweightswithcoarsemagnitudes
toencodetheknowneffectsoflegloadingandpositiononhalf-centers,andweconstraintheirsigns
(FigureD.3). WeinitializeunknownAFweightsatzeroandleavethemunconstrained. Wealso
utilizebilateralsharingandtheoverparameterizationtrick.
6
FA PF FA PF4 EXPERIMENTS
Tasks WetrainourarchitectureonsimulatedtasksbuiltatoptheMuJoCophysicsengine(Todorov
etal.,2012)thatcontroltheUnitreeA1robot(AppendixB.1). Thetasksarestructuredas15-second
episodesduringwhichtherobotmustlocomoteforwardsatafixedtargetspeedofWalk(0.5m/s)
orRun(1.0m/s),andacrossterrainsofFlatorBumpy(AppendixB.2). Thetasksprovideateach
timesteparewardproportionaltotherunningspeed,withmaximumrewardof1atthetargetspeed
intheforwarddirection(AppendixB.3). Thistaskstructureandrewarddesignisbaseddirectlyon
Smithetal.(2022)inordertofacilitatecomparisontoexistingwork.
Baselines Wecompareagainstmultilayeredperceptrons(MLPs)of2hiddenlayers. Bydefault,
wecomparetoMLP(256,256),whichisareasonablysizedarchitecturecommonlyusedintheAI
and robotics literature. Importantly, we choose to baseline against MLPs as they exemplify an
architecturewithoutpriors,whichcontrastswithourNCAParchitecturewithpriors,facilitatinga
cleancomparison. Ourgoalinthisworkisnottocomparehowdifferentclassesofpriorstackup
generally,butrathertoexplorethevalueofneuralcircuit-inspiredarchitecturalpriorsinparticular.
Asarchitecturalpriorsaresomewhatorthogonaltootherformsofpriors(includingreward,training
curricula,andimitationpriors),futureworkcouldcombinatoriallycombineourpriorwithothers.
Algorithm WetrainbothNCAPandMLParchitecturesusingevolutionstrategiestomaximize
episodicreturn(AppendixC.1). Suchgradient-freeoptimizationiseasiesttousewithourNCAP
architecture,andithassuccessfullyandpopularlybeenusedtotrainMLPsincontinuouscontrol
(Salimansetal.,2017). Inpreliminaryexperiments, wecompareevolutionstrategiestostandard
on-policyandoff-policyreinforcementlearningalgorithms(AppendixC.2),andweconfirmsimilar
performanceacrossalgorithmswhentrainingMLPsonourtasks(AppendixD.1).
4.1 PERFORMANCEANDDATAEFFICIENCY
NCAPsuccessfullylearnstolocomoteacrossvariousspeedsandterrains(Figure4A).Forrepresenta-
tiveexamplesofNCAP’sbehaviorandneuralactivity,pleaseseeVideos1.
HowdoesNCAPcomparetoMLPonperformanceanddataefficiency? NCAPachievescomparable
asymptoticperformancetoMLPacrosstasks(Figure4A).Moreover,duetoitspriors,anuntrained
NCAPachievessignificantlybetterinitialperformancethananuntrainedMLP.Theperformanceof
NCAPimproveswithtrainingastheAFandPFweightsarerefined. Inaddition,NCAP’straining
trajectoriesarelessvariablethantheMLP’s.
Interestingly,NCAPappearstotrainmoredataefficientlythanMLPfortheharderBumpytasks.
Forinstance,ontheBumpy/Runtask,NCAPreachesasymptoticperformanceabout500epochs(or
8milliontimesteps)beforeMLP.However,NCAPreachesslightlylowerasymptoticperformance
than MLP for the easier Flat tasks. We attribute this to a regularization effect in NCAP, as it is
constrained in the solutions it can learn. In contrast, MLP can learn to exploit the simulator for
additionalperformancegains,whichiseasiertodoonFlatthanBumpytasks.
ThisissupportedbythequalitativeperformanceofNCAPandMLP.Usingfootfallplots,weexamine
learnedgaitsontheFlat/Walktaskfordifferenttrainingseeds(Figure4B,Videos2). MLPdevelops
agoodwalkinggaitonseed3,amediocrelimpinggaitonseed2,andafailedon-the-floorshuffleon
seed1;thisbehaviorisstarklyevidentinVideos2. Notably,thishighvariabilityisoccludedinthe
performancecurve(Figure4A).Incontrast,NCAPexhibitsmorenaturalisticandconsistentgaitsdue
toitsRGprior. SuchgaitswouldrequiremorepriorstoelicitfromMLP(forexample,rewardor
imitationpriors).
4.2 PARAMETEREFFICIENCY
AretheperformanceanddataefficiencyadvantagesofNCAPmerelyduetohavingfewerparameters?
WetestMLPwithfewerparametersbyvaryingthehiddenlayersizesfrom4to256. Surprisingly,
performance and data efficiency degrade significantly (Figure 5A), showing that it is not merely
havingfewerparametersthatisbeneficial. Rather,thespecificstructureofNCAPmatters.
7A NCAP achieves comparable performance and better data efficiency
Untrained
Standing
~500 epochs
= 8 million timesteps
NCAP
MLP(256,256)
B NCAP exhibits more naturalistic and consistent gait patterns
NCAP MLP(256,256)
FL
FR
HL
HR
Time
Figure4|PerformanceandDataEfficiency. A,Performancecurvesacrosstasks. Solidlinesare
mean normalized returns across 10 training seeds, each tested for 5 episodes per epoch. Shaded
areasare95%bootstrappedconfidenceintervals. Maximumnormalizedepisodicreturnis1,anda
policythatoutputsallzerosachieves0.5bystandingstill. NCAPmatchesorexceedstheasymptotic
performanceofMLP,withsuperiordataefficiency.NCAPalsodemonstratesbetterinitialperformance
sinceitisaneffectiveprior. B,Footfallplotsacross3trainingseedsontheFlat/Walktask. Colored
segmentsencodethefootcontactpressuresduringstance,whileblanksegmentsindicatethelimbis
inswing. NCAPexhibitsqualitativelymorenaturalisticandconsistentgaitsthanMLP,despitetheir
quantitativelysimilarasymptoticperformances.
A MLP performance degrades with fewer parameters B NCAP has fewer parameters than MLPs
Figure 5 | Parameter Efficiency. A, Performance curves across MLP sizes on the Bumpy/Run
task. SmallerMLPsachievelowerasymptoticperformanceandworsedataefficiency. Therefore,
havingfewerparametersisinsufficienttoaccountforNCAP’sadvantages. B,Parametercountacross
architectures(logscale). NCAP(Test)hasfewerparametersthanMLP(4,4),andevenNCAP(Train)
withtheoverparameterizationtrick(AppendixA.3)hasordersofmagnitudefewerparametersthan
MLPsattypicalsizes.
8A NCAP generalizes better to terrain and body variations
NCAP
MLP(256,256)
Figure6|GeneralizationtoTerrainandBodyVariations. A,Performanceonunseenterrainand
bodyvariations. Architecturesaretrainedintheconditionindicatedwithaverticaldashedline,then
testedinalteredconditions. Thevariationsincludedterrainbumpiness(parameterizedfrom0to1;
FigureB.1),bodymass(inkilograms),orproportional/dampinggainsofthelow-levelPDcontroller.
NCAP’sgeneralizationmatches,andoftenexceeds,thatofMLP.
It is this structure that enables NCAP to perform well yet require dramatically fewer parameters
thanMLPs(Figure5B).Duringtesting,NCAPusesonly92parameters(FigureD.4),whichis3
ordersofmagnitudefewerthanMLP(256,256)with79,372parameters(FigureD.6),anditisfewer
thanevenMLP(4,4). Duringtraining,NCAPwiththeoverparameterizationtrickhas708parameters
(FigureD.5),whichis2ordersofmagnitudesmallerthanMLP(256,256),anditiscomparableto
MLP(16,16). Notably,manyoftheseMLPsaremuchsmallerthanthesizestypicallyusedinpractice.
Moreover, in settings like actor-critic reinforcement learning that often use similarly sized actor
and critic networks as well as moving average copies of those networks, the number of required
parameters can quadruple. NCAP’s parameter efficiency could be particularly advantageous for
deploymentinresource-constrainedenvironments,likearobot’sonboardcompute.
4.3 GENERALIZATIONTOTERRAINANDBODYVARIATIONS
HowwelldoesNCAPgeneralizetounseenenvironmentscomparedtoMLP?Weevaluatethearchi-
tecturesacrossavarietyofterrainandbodyvariations(Figure6). Ineachsetting,thearchitectures
are trained in one condition, then tested in altered conditions. Across these variations, NCAP’s
generalizationmatches,andoftenexceeds,thatofMLP.Surprisingly,MLPperformancedegrades
dramatically on Bumpy terrain, despite the differences in bumpiness seeming minor by human
standards(FigureB.1). Incontrast,NCAPperformsmorerobustly.
4.4 GENERALIZATIONTOTHEPHYSICALROBOT
HowwelldoesNCAPgeneralizetotherealworldcomparedtoMLP?Wedeploythearchitecturesto
aphysicalUnitreeA1quadrupedrobotaftertrainingontheBumpy/Walktask(AppendixB.4). We
expectthedomaingaptobelargesincewedonotperformcontrollertuningorsystemidentification
withthephysicalrobot,thesimulatedtrainingdoesnotapplyaggressivedomainrandomization(a
formoftaskprior),andthearchitecturesdonothaveamechanismforonlineadaptation.
MLPfallsimmediatelyduetoitserraticandunstableactions,oftenlaunchingtherobotaggressively
intothewall(Figure7).Despiteourbestefforts,wecannotelicitasuccessfulwalkingtrial.Incontrast,
NCAPisremarkablyrobusttothelargedomaingap,walkingsuccessfullyonmosttrials,thoughwith
lesssmoothnessthaninsimulation(Figure7). WeattributeNCAP’ssuccesstoacombinationofthe
RGmodulemaintainingastablerhythminthefaceofsensornoiseandtheAFmoduletriggering
correctiveresponsesinthefaceofperturbations. Lastly,wedeployanuntrainedNCAPandobserve
thatitisstableandproducesslightwalkingmovementswithsmallfootdisplacements(Videos3).
9NCAP
Walks successfully
MLP(256,256)
Falls immediately
Time
Figure 7 | Generalization to the Physical Robot. Video frames (Videos 3) of a representative
deploymenttrialonthephysicalrobot. NCAPwalkssuccessfullydespitethelargedomaingap,while
MLPfallsimmediatelyduetoitserraticandunstableactions.
5 DISCUSSION
Inthiswork,weintroduceQuadrupedNCAP,abiologicallyinspiredANNarchitectureforquadruped
locomotion based on neural circuits in the limbs and spinal cord of mammals. Our architecture
achievesgoodinitialperformanceandcomparablefinalperformancetoMLPs,whileusinglessdata
andordersofmagnitudefewerparameters. Ourarchitecturealsoexhibitsbettergeneralizationtotask
variations,evenadmittingdeploymentonaphysicalrobotwithoutstandardsim-to-realmethods.
Limitations Ourstudyfacesseverallimitations. First,werelyonahand-tunedRGmoduleandBC
command,whichmightnotbetheoptimalparametersthatalearning-basedapproachcoulddiscover.
Second,weneglectmusculoskeletalfactorsinthequadrupedactionspacethatcouldmakelearning
easierormorerobust.
FutureWork Wefocusonfixedspeedlocomotioninthiswork, butanobviousnextstepisto
enabletheRGtotransitionbetweengaitsinaspeed-dependentmanner,whichmaylargelyinvolvea
higher-levelcontrollerthataltersbrainstemcommandsfordifferentspeeds. Anotherextensionisto
addposturaladjustment,turning,andrightingmechanismstothearchitecturebasedonunderstanding
oftheunderlyingneuralcircuits. Finally,asarchitecturalpriorsaresomewhatorthogonaltoother
formsofpriors,itmaybebeneficialtotrainNCAPwithadditionalreward,task,orimitationpriors.
Overall, we believe that this work shows that neural circuits can provide valuable architectural
priorsforlocomotioninmorecomplexanimalsandencouragesfutureworkinyetmorecomplex
sensorimotorskills.
ACKNOWLEDGMENTS
Thanks for insightful discussions to Pavel Tolmachev, Liam McCarty, Anthony Chen, Ulyana
Piterbarg,JeffCui,BenEvans,SiddhantHaldar,NoahAmsel,YannLeCun,TonyZador,andmany
others. ThisworkwassupportedbytheFannieandJohnHertzFoundationFellowship(NXB);NSF
award2339096(LP);ONRawardsN00014-21-1-2758andN00014-22-1-2773(LP);andthePackard
FellowshipforScienceandEngineering(LP).
AUTHORCONTRIBUTIONS
Conceptualization(NXB;LP,GWL).Investigation(NXB).Software: simulation(NXB),deployment
(VP).Supervision(LP,GWL).Visualization(NXB).Writing: originaldraft(NXB,VP),reviewand
editing(NXB,VP,LP,GWL).
10REFERENCES
AnanyeAgarwal,AshishKumar,JitendraMalik,andDeepakPathak. Leggedlocomotioninchal-
lengingterrainsusingegocentricvision,November2022.
Jessica Ausborn, Natalia A Shevtsova, Vittorio Caggiano, Simon M Danner, and Ilya A Rybak.
Computationalmodelingofbrainstemcircuitscontrollinglocomotorfrequencyandgait. eLife,8:
e43587,January2019.
JessicaAusborn,NataliaA.Shevtsova,andSimonM.Danner. Computationalmodelingofspinal
locomotorcircuitryintheageofmoleculargenetics. IJMS,22(13):6835,June2021.
GabrielBarth-Maron,MatthewW.Hoffman,DavidBudden,WillDabney,DanHorgan,DhruvaTB,
AlistairMuldal,NicolasHeess,andTimothyLillicrap. Distributeddistributionaldeterministic
policygradients. arXiv:1804.08617[cs,stat],April2018.
GuillaumeBellegardaandAukeIjspeert. CPG-RL:Learningcentralpatterngeneratorsforquadruped
locomotion,November2022.
NikhilX.Bhattasali,AnthonyM.Zador,andTatianaAEngel. Neuralcircuitarchitecturalpriorsfor
embodiedcontrol. InAdvancesinNeuralInformationProcessingSystems,2022.
NikhilX.Bhattasali,LerrelPinto,andGraceW.Lindsay. Simplifiedmodelofintrinsicallybursting
neurons,2024.
Xue Bin Peng, Erwin Coumans, Tingnan Zhang, Tsang-Wei Lee, Jie Tan, and Sergey Levine.
Learningagileroboticlocomotionskillsbyimitatinganimals. InRobotics: ScienceandSystems
XVI.Robotics: ScienceandSystemsFoundation,July2020.
PaulCisek. Resynthesizingbehaviorthroughphylogeneticrefinement. AttenPerceptPsychophys,81
(7):2265–2287,October2019.
SimonMDanner,NataliaAShevtsova,AlainFrigon,andIlyaARybak. Computationalmodelingof
spinalcircuitscontrollinglimbcoordinationandgaitsinquadrupeds. eLife,6:e31050,November
2017.
JiayuDingandZhenyuGan. Breakingsymmetriesleadstodiversequadrupedalgaits. IEEERobot.
Autom.Lett.,9(5):4782–4789,May2024.
StenGrillnerandAbdeljabbarElManira. Currentprinciplesofmotorcontrol,withspecialreference
tovertebratelocomotion. PhysiologicalReviews,100(1):271–320,January2020.
NicolasHeess,GregWayne,YuvalTassa,TimothyLillicrap,MartinRiedmiller,andDavidSilver.
Learningandtransferofmodulatedlocomotorcontrollers. arXiv:1610.05182[cs],October2016.
NicolasHeess,DhruvaTB,SrinivasanSriram,JayLemmon,JoshMerel,GregWayne,YuvalTassa,
Tom Erez, Ziyu Wang, S. M. Ali Eslami, Martin Riedmiller, and David Silver. Emergence of
locomotionbehavioursinrichenvironments. arXiv:1707.02286[cs],July2017.
SuzanaHerculano-Houzel,BrunoMota,andRobertoLent. Cellularscalingrulesforrodentbrains.
Proc.Natl.Acad.Sci.U.S.A.,103(32):12138–12143,August2006.
SuzanaHerculano-Houzel,ChristineE.Collins,PeiyanWong,andJonH.Kaas. Cellularscaling
rulesforprimatebrains. Proc.Natl.Acad.Sci.U.S.A.,104(9):3562–3567,February2007.
ASHuang,EOlson,andDCMoore. LCM:Lightweightcommunicationsandmarshalling. In2010
IEEE/RSJInternationalConferenceonIntelligentRobotsandSystems,pp.4057–4062,Taipei,
October2010.IEEE.
AukeJanIjspeert. Centralpatterngeneratorsforlocomotioncontrolinanimalsandrobots: Areview.
NeuralNetworks,21(4):642–653,May2008.
AtilIscen,KenCaluwaerts,JieTan,TingnanZhang,ErwinCoumans,VikasSindhwani,andVincent
Vanhoucke. Policiesmodulatingtrajectorygenerators. arXiv:1910.02812[cs],October2019.
11OleKiehn. Decodingtheorganizationofspinalcircuitsthatcontrollocomotion. NatRevNeurosci,
17(4):224–238,April2016.
YongiKim, ShinyaAoi, SoichiroFujiki, SimonM.Danner, SergeyN.Markin, JessicaAusborn,
IlyaA.Rybak,DaiYanagihara,KeiSenda,andKazuoTsuchiya. Contributionofafferentfeedback
toadaptivehindlimbwalkingincats: Aneuromusculoskeletalmodelingstudy. Front.Bioeng.
Biotechnol.,10:825149,April2022.
BrendenM.Lake,TomerD.Ullman,JoshuaB.Tenenbaum,andSamuelJ.Gershman. Building
machinesthatlearnandthinklikepeople. BehavBrainSci,40,2017.
Janne K. Lappalainen, Fabian D. Tschopp, Sridhama Prakhya, Mason McGill, Aljoscha Nern,
KazunoriShinomiya,Shin-yaTakemura,EyalGruntman,JakobH.Macke,andSrinivasC.Turaga.
Connectome-constrainednetworkspredictneuralactivityacrosstheflyvisualsystem. Nature,
September2024.
GraceW.Lindsay. Convolutionalneuralnetworksasamodelofthevisualsystem: Past,present,and
future. JournalofCognitiveNeuroscience,33(10):2017–2031,September2021.
VictorLobato-Rios,ShravanTataRamalingasetty,PembeGizemÖzdil,JonathanArreguit,AukeJan
Ijspeert, and Pavan Ramdya. NeuroMechFly, a neuromechanical model of adult Drosophila
melanogaster. NatMethods,19(5):620–627,May2022.
LiqunLuo. Architecturesofneuronalcircuits. Science,373(6559),September2021.
Horia Mania, Aurelia Guy, and Benjamin Recht. Simple random search provides a competitive
approachtoreinforcementlearning. arXiv:1803.07055[cs,math,stat],March2018.
SergeyN.Markin,AlexanderN.Klishko,NataliaA.Shevtsova,MichelA.Lemay,BorisI.Prilutsky,
andIlyaA.Rybak. Aneuromechanicalmodelofspinalcontroloflocomotion. InBorisI.Prilutsky
andDonaldH.Edwards(eds.),NeuromechanicalModelingofPostureandLocomotion,pp.21–65.
SpringerNewYork,NewYork,NY,2016.
JoshMerel,DiegoAldarondo,JesseMarshall,YuvalTassa,GregWayne,andBenceÖlveczky. Deep
neuroethologyofavirtualrodent. arXiv:1911.09451[q-bio],November2019a.
Josh Merel, Leonard Hasenclever, Alexandre Galashov, Arun Ahuja, Vu Pham, Greg Wayne,
Yee Whye Teh, and Nicolas Heess. Neural probabilistic motor primitives for humanoid con-
trol. arXiv:1811.11711[cs],January2019b.
MayankMittal,NikitaRudin,VictorKlemm,ArthurAllshire,andMarcoHutter. Symmetryconsid-
erationsforlearningtasksymmetricrobotpolicies,March2024.
DanielOrdonez-Apraez,AntonioAgudo,FrancescMoreno-Noguer,andMarioMartin. Anadaptable
approachtolearnrealisticleggedlocomotionwithoutexamples. In2022InternationalConference
onRoboticsandAutomation(ICRA),pp.4671–4678,May2022.
FabioPardo. Tonic: Adeepreinforcementlearninglibraryforfastprototypingandbenchmarking.
arXiv:2011.07537[cs],May2021.
NikitaRudin,DavidHoeller,PhilippReist,andMarcoHutter. Learningtowalkinminutesusing
massivelyparalleldeepreinforcementlearning,August2022.
IlyaA.Rybak,KimberlyJ.Dougherty,andNataliaA.Shevtsova. Organizationofthemammalian
locomotorCPG:Reviewofcomputationalmodelandcircuitarchitecturesbasedongenetically
identifiedspinalinterneurons. eneuro,2(5):ENEURO.0069–15.2015,September2015.
TimSalimans,JonathanHo,XiChen,SzymonSidor,andIlyaSutskever. Evolutionstrategiesasa
scalablealternativetoreinforcementlearning. arXiv:1703.03864[cs,stat],September2017.
Stefan Schaal. Dynamic movement primitives - a framework for motor control in humans and
humanoidrobotics. InHiroshiKimura,KazuoTsuchiya,AkioIshiguro,andHartmutWitte(eds.),
AdaptiveMotionofAnimalsandMachines,pp.261–280.Springer-Verlag,Tokyo,2006.
12JohnSchulman,FilipWolski,PrafullaDhariwal,AlecRadford,andOlegKlimov. Proximalpolicy
optimizationalgorithms. arXiv:1707.06347[cs],August2017.
RezaShadmehr. Controlofequilibriumpositionandstiffnessthroughposturalmodules. Journalof
MotorBehavior,25(3):228–241,September1993.
Milad Shafiee, Guillaume Bellegarda, and Auke Ijspeert. Puppeteer and marionette: Learning
anticipatory quadrupedal locomotion based on interactions of a central pattern generator and
supraspinaldrive,2023.
LauraSmith,IlyaKostrikov,andSergeyLevine. Awalkinthepark: Learningtowalkin20minutes
withmodel-freereinforcementlearning,August2022.
YuvalTassa,SaranTunyasuvunakool,AlistairMuldal,YotamDoron,PiotrTrochim,SiqiLiu,Steven
Bohez,JoshMerel,TomErez,TimothyLillicrap,andNicolasHeess. Dm_control: Softwareand
tasksforcontinuouscontrol. SoftwareImpacts,6:100022,November2020.
Shravan Tata Ramalingasetty, Simon M. Danner, Jonathan Arreguit, Sergey N. Markin, Dimitri
Rodarie,ClaudiaKathe,GregoireCourtine,IlyaA.Rybak,andAukeJanIjspeert. Awhole-body
musculoskeletalmodelofthemouse. IEEEAccess,9:163861–163881,2021.
EmanuelTodorov,TomErez,andYuvalTassa. MuJoCo: Aphysicsengineformodel-basedcontrol.
In2012IEEE/RSJInternationalConferenceonIntelligentRobotsandSystems,pp.5026–5033,
Vilamoura-Algarve,Portugal,October2012.IEEE.
SiboWang-Chen,VictorAlfredStimpfling,PembeGizemÖzdil,LouiseGenoud,FemkeHurtak,and
PavanRamdya. NeuroMechFly2.0,aframeworkforsimulatingembodiedsensorimotorcontrolin
adultDrosophila,September2023.
PWhelan. Controloflocomotioninthedecerebratecat. ProgressinNeurobiology,49(5):481–515,
August1996.
JohnGrahamWhite,EileenSouthgate,J.N.Thomson,andSydneyBrenner. Thestructureofthe
nervoussystemofthenematodeCaenorhabditiselegans. Phil.Trans.R.Soc.Lond.B,314(1165):
1–340,November1986.
JunzhiYu,MinTan,JianChen,andJianweiZhang. AsurveyonCPG-inspiredcontrolmodelsand
systemimplementation. IEEETrans.NeuralNetw.LearningSyst.,25(3):441–456,March2014.
AnthonyM.Zador. Acritiqueofpurelearningandwhatartificialneuralnetworkscanlearnfrom
animalbrains. NatCommun,10(1):3770,December2019.
KevinZakka,YuvalTassa,andMuJoCoMenagerieContributors. MuJoCoMenagerie: Acollection
ofhigh-qualitysimulationmodelsforMuJoCo,2022.
13A ARCHITECTURE DETAILS
A.1 ARCHITECTUREUNITS
BasicUnit TheBasicunitisatypicalrate-codedneuronwithcontinuousdynamics,whichintegrates
weightedinputsignalstogenerateatargetxfortheinternalvoltagev.
Hyperparameters: T ,B,f
v
(cid:88)
x=clip(B+ w y ,−1,1)
i i
i
T dv
v =x−v
4 dt
Theneuron’sactivationfunctionf determinesthevoltage-firingrelationship:
y =f(v), f =clip(v,0,1)
OscillatorUnit TheOscillatorunitisarelaxationoscillatorwithdiscrete-continuousdynamicson
2variables: adiscreteinternalvoltagev ∈−1,+1andacontinuousadaptationvariablea∈[0,1].
Hyperparameters: T ,T ,T ,K ,K ,V ,B,f
a active quiet active quiet tonic
4T 4T
T′ = active , T′ = quiet
active T quiet T
a a
Theadaptationthresholdsa0,1 arecalculatedthatdeterminethemin/maxvaluesofadaptation
quiet,active
aatwhichtheinternalvoltagevjumpsbetweenactive(+1)andquiet(−1)states:
1−exp(T′ )
a0 = quiet
active 1−exp(T′ +T′ )
active quiet
a0 =a0 ·exp(T′ )
quiet active active
1−exp(T′ ·K )
a1 = quiet quiet
active 1−exp(T′ ·K +T′ ·K )
active active quiet quiet
a1 =a1 ·exp(T′ ·K )
quiet active active active
Dependingonthestrengthoftheinputsignalatagiventime,thequiet-to-activeandactive-to-quiet
adaptationthresholdsinterpolatebetweenthecalculatedmin/maxvalues. Adaptationaexponentially
decaystowards0whentheneuronisactive(theneurondepletestheadaptationvariable)andtowards
1whenquiet(theneuronreplenishestheadaptationvariable). Voltagevjumpsinstantaneouslytoa
newstatewhenanadaptationthresholdisreached.
(cid:88)
x=clip(B+ w y ,−1,1)
i i
i
z =clip(x,0,1)
a =interpolate(z,a0 ,a1 )
active active active
a =interpolate(z,a0 ,a1 )
quiet quiet quiet
(cid:26)
T ada
=
0−a ifv =+1 (active)
4 dt 1−a ifv =−1 (quiet)

 −1 ifa(t) ≤a( act) tiveandx(t) ≤V tonic (active→quiet)
v(t+dt) := +1 ifa(t) ≥a(t) andx(t) ≥0 (quiet→active)
quiet

v(t) otherwise
Theneuron’sactivationfunctionf determinesthevoltage-adaptation-firingrelationship:
(cid:26)
interpolate(a,0.5,1.0) ifv =+1 (active)
y =f(v,a,x), f =
0 ifv =−1 (quiet)
Weprovideadetailedderivationandevaluationofthismodelinaconcurrentmanuscript(Bhattasali
etal.,2024,insubmission).
14A.2 RHYTHMGENERATION(RG)MODULE
TheRGcircuitdiagramcanbevisualizedinfull(FigureA.1)orthroughaprogressivebreakdown
(FigureA.2). TheRGweightsaretunedtoproducetheappropriategaittransitionsinresponseto
increasingbrainstemcommand(FigureA.3).
Fore-Left (FL) Fore-Right (FR)
Hind-Left (HL) Hind-Right (HR)
FigureA.1|RhythmGeneration,Full. Neuralcircuitsforrhythmgeneration(RG)andbrainstem
command(BC)atcell-type-specificresolution,adaptedfromDanneretal.(2017). Foraprogressive
breakdown,pleaseseeFigureA.2.
15A Oscillators
Hind-Left (HL) Fore-Left (FL) Hind-Left (HL) Fore-Left (FL)
Side
E F E F
Diagonal
Brainstem
Side
E F E F
Hind-Right (HR) Fore-Right (FR) Hind-Right (HR) Fore-Right (FR)
B + Cross C + Side
D + Diagonal E + Brainstem Command + Afferent Feedback
FigureA.2|RhythmGeneration,Breakdown. Neuralcircuitsforrhythmgeneration(RG)and
brainstemcommand(BC)atcell-type-specificresolution,adaptedfromDanneretal.(2017). Each
limbiscontrolledby(A)reciprocallyinhibitinghalf-centersconsistingofaflexorOscillatorunitand
anextensorBasicunit. Betweenlimbs,half-centerscommunicatethrough(B)cross,(C)side,and
(D)diagonalconnections,andtheyaremodulatedby(E)brainstemcommandandafferentfeedback.
16
ssorC ssorCFL
FR
HL
HR
Figure A.3 | Rhythm Generation, Gait Transitions. Predicted footfall plots from RG extensor
half-centerstate. Therhythmgenerationcircuittransitionsbetweengaits(walk→trot→bound)as
thebrainstemcommandincreasesfrom0to1. Thisenablesahigher-levelcontrollertomodulatethe
gaitforvariablespeeds.
A.3 OVERPARAMETERIZATIONTRICK
Wediscoveranimportanttechniquetoimprovethetrainabilityofourarchitecture,whichwecall“the
overparameterizationtrick”.
Consideralinearlayery =Wx. Duringtraining,theweightmatrixW canbeartificiallyexpanded
indimensionalityalongtherowdimensionand/orcolumndimensiontoproducealargerweightmatrix
W′. Theformerproducesacorrespondinglylargeroutputvectory′,whilethelatternecessitates
acorrespondinglylargerinputvectorx′. Thelargeroutputy′canbetransformedintotheoriginal
outputybysummingexpandedelements. Theoriginalinputxcanbetransformedintothelarger
inputx′ bycopyingandconcatenatingelements. Thus,theexpandedlayermaintainstheoriginal
input and output dimensions, but with a larger weight matrix and new hardcoded expansion and
compressionoperationsattheinterface. Wefindempiricallythatsuchoverparameterizationimproved
learning,presumablyduetospecialdynamicsoftraversinghigh-dimensionallosslandscapeswithour
point-basedevolutionarystrategiesalgorithm(AppendixC.1),butbettertheoreticalunderstandingof
thisphenomenonisneeded.
Duringtesting,theoverparameterizedweightmatrixW′ canbecollapsedbysummingalongthe
expandedrowsand/orcolumnstoproduceasmallermatrixwiththesizeoftheoriginalW. Mathe-
matically,thisdoesnotchangethecomputation,asitexploitsthelinearityofmatrixmultiplication.
Forasimpleexample,considerthecaseof1Dinputsandoutputs.
Iftheweightisexpandedrow-wise:
(cid:20) (cid:21)
(cid:88) w′
y =wx −→ y = 1 x=(w′ +w′)x −→ y =wx
expand w 2′ 1 2 compress
rows
Iftheweightisexpandedcolumn-wise:
(cid:20) (cid:21)
x
y =wx −→ y =[w′ w′] =(w′ +w′)x −→ y =wx
expand 1 2 x 1 2 compress
Forthiswork,thetechniqueenablesNCAPtoleveragethebenefitsoftrainingwithoverparameterized
networksusinganexpandedarchitecture(FigureD.5),whichiscompressedfortesting(FigureD.4).
17
m
etsniarB
dnammocB ENVIRONMENT DETAILS
B.1 SIMULATEDROBOT
WetrainourarchitectureonsimulatedtasksbuiltusingDeepMindComposer(Tassaetal.,2020)atop
theMuJoCophysicsengine(Todorovetal.,2012)usingaUnitreeA1robotmodelimportedfrom
MuJoCoMenagerie(Zakkaetal.,2022).
Theobservationandactioninterfaceswiththeagentarenormalizedto[−1,1]. Theactionspaceis
designedwithadefaultstandingposecorrespondingtoactionsof0andjointlimitscorrespondingto
actionsof±1.
Aproportional-derivative(PD)controllerisemployedtoconvertthetargetjointpositionsgenerated
bytheagentq =a intojointtorquecommandsfortheactuators:
target t
τ =k (q −q)−k ·q˙
p target d
withjointpositionsq,jointvelocitiesq˙,proportionalgaink ,andderivativegaink .
p d
Thesimulationrunswithacontroltimestepof0.03secondsandaphysicstimestepof0.001seconds.
B.2 TASKSTRUCTURE
Thetasksareformulatedas15-secondepisodes. Theagentincursapenaltyandtheepisoderesets
iftherobotfallsoverorifanypartofitsbasetouchestheground. Atthestartofeachepisode,the
frictioncoefficientofthefootisrandomized. TheagentistrainedtomoveatafixedvelocityofWalk
(0.5m/s)orRun(1.0m/s)overeitherFlatorBumpyterrain(FigureB.1).
B.3 TASKREWARDS
WeadopttherewardfunctionfromSmithetal.(2022),whichusestheforwardlinearvelocityinthe
robotframev ,thetargetforwardvelocityvtarget,andtheangularyawvelocityω .
x x z
The overall reward combines a forward velocity reward and a rotational penalty. The tolerance
functionr encouragestheagenttomaintainaforwardvelocitynearthetargetwithsomeallowable
v
deviation,whiletherotationalpenaltyreducesunnecessaryrotationalmovements,ensuringstable
andforward-directedmotion:
r(s,a)=r (s,a)−0.1ω2
v z

1 v ∈[v ,2v ]
 x t t
r v(s,a)= 0 v x ∈(−∞,−v t]∪[4v t,∞)
 1− |vx−vt| otherwise
2vt
18Flat Bumpiness = 0 Bumpiness = 0.25
Bumpiness = 0.5 Bumpiness = 0.75 Bumpiness = 1
FigureB.1|TerrainBumpiness. TheFlatandBumpyterrainshavedifferentfrictions. TheBumpy
terrainallowsbumpinesstobeparameterizedbetween0and1.
B.4 PHYSICALROBOT
Deployment Setup The experiments are conducted on the Unitree A1 quadruped robot with
12 degrees of freedom (3 per leg). The robot has sensors for joint positions, joint torques, joint
velocities, and foot contact pressures, and it has actuators that produce commanded torques at
each joint. The communication between the robot and the control policy is performed through
LightweightCommunicationsandMarshalling(LCM)(Huangetal.,2010)andapybindbuildof
unitree_legged_sdk. Thecontrolpolicyisdeployedontherobotfromalocalworkstation
throughaLANconnection,inordertoensurelow-latencyandhigh-reliabilitycommunication.
ExperimentalProtocol Thedeploymentprocessincludesaninitialcalibrationphasetoverifyjoint
offsetsandzerotorquesensors,ensuringaccuratesensorreadingsandactuatorcontrol. Notably,no
systemidentificationisperformedwithoursimulatedrobotmodel. Despitesubstantialeffortsto
tunetheMLPpolicy,includingadjustmentstoproportional/derivativegainsandinitialplacement,
itstrugglestogeneralizeeffectivelytothephysicalrobot. Incontrast,ourNCAPpolicyexhibits
surprisingrobustness.
19C ALGORITHM DETAILS
C.1 EVOLUTIONSTRATEGIES
Augmented Random Search (ARS) ARS is an evolutionary strategies algorithm that spawns
offspringnetworksbyrandomlyperturbingtheparentnetwork’sweights,scoresoffspringaccording
toafitnessfunction,andselectsthenextparentbytakingafitness-weightedaverageofoffspring
weights. Itcanbeapproximatelyviewedasestimatinggradientsofthefitnessfunction. (Maniaetal.,
2018)
Hyperparameter ARS
Populationsize 256
Mutationscale 0.1
Numberofworkers 32
Table1|HyperparametersforESalgorithm. Furtherdetailsinourprovidedcode.
C.2 REINFORCEMENTLEARNING
Proximal Policy Optimization (PPO) PPO is an on-policy reinforcement learning algorithm
known for its stability. By maintaining a proximity constraint between the new and old policies,
it balances exploration and exploitation, making it a reliable choice for continuous control tasks.
(Schulmanetal.,2017)
DistributedDistributionalDeepDeterministicPolicyGradient(D4PG) D4PGisanoff-policy
reinforcementlearningalgorithmknownforitsdataefficiency. Byincorporatingparallelrolloutsand
adistributionalvaluefunction,itefficientlyreusesgatheredexperiencetolearncontinuouscontrol
tasks. (Barth-Maronetal.,2018)
Hyperparameter D4PG PPO
Actornetworklayers (256,256) (64,64)
Actornetworkactivationfunction ReLU Tanh
Criticnetworklayers (256,256) (64,64)
Criticnetworkactivationfunction ReLU Tanh
Observationnormalizer Mean-Std Mean-Std
Table 2 | Hyperparameters for D4PG and PPO algorithms. Further details in the algorithm
implementationsfromPardo(2021).
C.3 COMPUTATIONALRESOURCES
Trainingisperformedonahigh-performancecomputingclusterrunningtheLinuxUbuntuoperating
system. TheESalgorithmisparallelizedover32cores. TheRLalgorithmsareparallelizedover16
coresasminimalspeedupsareobservedbeyondthatonourtasks;thiskindofnonlinearscalingis
consistentwithreportedperformancetestsinotherwork(Salimansetal.,2017).
20D SUPPLEMENTAL EXPERIMENTS
D.1 PERFORMANCEANDDATAEFFICIENCY
Figure D.1 | Performance and Data Efficiency, MLP Architecture, Various Algorithms. er-
formancecurvesacrossvarioustasks. Solidlinesaremeannormalizedreturnsacross10training
seeds,eachtestedfor5episodesperepoch. Shadedareasare95%bootstrappedconfidenceintervals.
The x-axis is environment steps to ensure a fair data efficiency comparison between algorithms,
althoughthetimeefficiencybetweenalgorithmsissignificantlydifferent. ESachievescomparable
performancetoPPOandD4PGonourtasks.
D.2 PARAMETEREFFICIENCY
Figure D.2 | Parameter Efficiency, NCAP/MLP Architectures, Various Tasks. Performance
curvesacrossMLPsizesonBumpytasks. SmallerMLPsachievelowerasymptoticperformanceand
worsedataefficiency,whichismoreextremeintheharderBumpy/Runtask.
21D.3 INTERPRETABILITY
Figure D.3 | Interpretability, NCAP Architecture, Untrained, Compact. Weights plot of the
untrained NCAP. Weight sign is encoded in color, with excitatory (positive) weights as red and
inhibitory(negative)weightsasblue. Weightmagnitudeisencodedincirclelightnessanddiameter.
Thenon-zeroelementsofNCAP’sweightsareinitializedwithcoarsemagnitudesandconstrained
signs.
22FigureD.4|Interpretability,NCAPArchitecture,Trained,Compact. Weightsplotofthetrained
NCAPinitscompact/testingvariant.
23NCAP, Epoch 1000, Full
actor.pattern_formation.FL.head.action_layer.0.weight [2, 16]
pos/thigh
pos/calf
actor.pattern_formation.FL.head.action_layer.0.bias [2]
pos/thigh
pos/calf
0
actor.pattern_formation.HL.head.action_layer.0.weight [2, 16]
pos/thigh
pos/calf
actor.pattern_formation.HL.head.action_layer.0.bias [2]
pos/thigh
pos/calf
0
actor.afferent_feedback.FL.head.action_layer.0.weight [16, 20]
flx
flx
flx
flx
flx
flx
flx
flx
ext
ext
ext
ext
ext
ext
ext
ext
actor.afferent_feedback.HL.head.action_layer.0.weight [16, 20]
flx
flx
flx
flx
flx
flx
flx
flx
ext
ext
ext
ext
ext
ext
ext
ext
actor.brainstem_command.command [1, 8]
0
0 1 2 3 4 5 6 7
FigureD.5|Interpretability,NCAPArchitecture,Trained,Full.WeightsplotofthetrainedNCAP
initsoverparameterized/trainingvariant.
24
xlf
xlf
-pih/sop
-pih/sop
xlf
xlf
-hgiht/sop
-hgiht/sop
xlf
xlf
-flac/sop
-flac/sop
xlf
xlf
-pih/qrt
-pih/qrt
xlf
xlf
-hgiht/qrt
-hgiht/qrt
xlf
xlf
-flac/qrt
-flac/qrt
xlf
xlf
-pih/lev
-pih/lev
xlf
xlf
-hgiht/lev
-hgiht/lev
txe
txe
-flac/lev
-flac/lev
txe
txe
-toof
-toof
txe
txe
+pih/sop
+pih/sop
txe
txe
+hgiht/sop
+hgiht/sop
txe
txe
+flac/sop
+flac/sop
txe
txe
+pih/qrt
+pih/qrt
txe
txe
+hgiht/qrt
+hgiht/qrt
txe
txe
+flac/qrt
+flac/qrt
+pih/lev
+pih/lev
+hgiht/lev
+hgiht/lev
+flac/lev
+flac/lev
+toof
+toofFigureD.6|Interpretability,MLPArchitecture,Trained,Full. WeightsplotofthetrainedMLP.
Suchweightsaredifficulttointerpret,astherowsandcolumnsofhiddenweightslackfixedmeanings,
andweightsignscanchangefreelyduringtraining.
25
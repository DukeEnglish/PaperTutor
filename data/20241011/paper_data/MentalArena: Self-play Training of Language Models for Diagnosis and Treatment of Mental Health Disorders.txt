MentalArena: Self-play Training of Language Models for Diagnosis
and Treatment of Mental Health Disorders
ChengLi1,2*,MayFung1,QingyunWang1,ChiHan1,ManlingLi3,JindongWang2†,HengJi1†
1UniversityofIllinoisUrbana-Champaign
2MicrosoftResearchAsia
3StanfordUniversity
Abstract
Mentalhealthdisordersareoneofthemostseriousdiseasesintheworld.Mostpeoplewithsuchadiseaselack
accesstoadequatecare,whichhighlightstheimportanceoftrainingmodelsforthediagnosisandtreatmentofmental
healthdisorders. However, inthementalhealthdomain, privacyconcernslimittheaccessibilityofpersonalized
treatmentdata,makingitchallengingtobuildpowerfulmodels.Inthispaper,weintroduceMentalArena,aself-play
frameworktotrainlanguagemodelsbygeneratingdomain-specificpersonalizeddata,whereweobtainabettermodel
capableofmakingapersonalizeddiagnosisandtreatment(asatherapist)andprovidinginformation(asapatient).
Toaccuratelymodelhuman-likementalhealthpatients,wedeviseSymptomEncoder,whichsimulatesarealpatient
frombothcognitionandbehaviorperspectives.Toaddressintentbiasduringpatient-therapistinteractions,wepropose
SymptomDecodertocomparediagnosedsymptomswithencodedsymptoms,anddynamicallymanagethedialogue
betweenpatientandtherapistaccordingtotheidentifieddeviations.WeevaluatedMentalArenaagainst6benchmarks,
includingbiomedicalQAandmentalhealthtasks,comparedto6advancedmodels.Ourmodels,fine-tunedonboth
GPT-3.5andLlama-3-8b,significantlyoutperformtheircounterparts,includingGPT-4o.Wehopethatourworkcan
inspirefutureresearchonpersonalizedcare.Codeisavailableinhttps://github.com/Scarelette/MentalArena/tree/main
1 Introduction
Mentalhealthdisordersincludeavarietyofconditionssuchasanxiety,depression,andschizophrenia,whichaffect
people’s thinking, emotions, behavior, or mood [Prince et al., 2007]. In 2019, approximately 970 million people
worldwidelivedwithamentalhealthdisorder,withanxietyanddepressionbeingmostprevalent[WHO,2022]. The
numberincreasedby28%in2020andcontinuestoincrease. Despitetheavailabilityofeffectivetreatments,many
individualslackaccesstoadequatecareduetounder-resourcedhealthsystems. Forexample,only29%ofpeoplewith
psychosisandonethirdofpeoplewithdepressionreceiveformalmentalhealthcare[WHO,2022]. Itisindispensableto
developmachinelearningmodelsfortheautomaticdiagnosisandtreatmentofsuchdiseases. However,existingAI
therapistsystemsusetemplatesanddecisiontrees,whicharenotflexibletomeetthelargedemandsonpersonalized
care[Devarakondaetal.,2019,D’Alfonso,2020,Fiskeetal.,2019,GrodniewiczandHohol,2023].
Thekeytotrainingpowerfulmodelsistocollectsufficienttrainingdata. However,duetoprivacyconcernsinthe
medicaldomain,datacollection,especiallypersonalizeddataformentalhealthdisorders,isinherentlychallenging. A
growingbodyofworkhasfocusedonenhancingmentalhealthlanguagemodelsbysourcingadditionaldomain-specific
datafromsocialmedia[Huetal.,2024a,Xuetal.,2024,Yangetal.,2024a]. However,socialmediadataareinherently
biasedandunder-representative,failingtocapturethefullspectrumofpeople’smentalhealthneeds.Moreover,asLLMs
continuetoscale,theavailabilityoftrainingdataintherealworldbecomesincreasinglylimited,furtherexacerbating
thischallenge. Existingmethodsarelikelytosoonreachtheirperformancelimit.
Recently,severalworkshavefocusedonself-play[Huetal.,2024b,Liangetal.,2024,Wangetal.,2024d,Wuetal.,
2024,Yangetal.,2024b],wheremodelsplaydifferentrolesandself-evolveorco-evolveduringinteractionwithother
models. Amodelsynthesizestrainingdataonitsownandthenusethegenerateddatatotrainitself. However,thereare
twochallengesthatpreventusfromadoptingself-playtrainingformentalhealthdisorders: (1)Scarcityofhigh-quality
*WorkdoneduringCheng’sinternshipatUniversityofIllinoisUrbana-Champaign.Contact:chenglicat0228@gmail.com.
†Correspondingauthors.
1
4202
tcO
9
]LC.sc[
1v54860.0142:viXraPatient: Symptom Encoder Therapist: Symptom Decoder Model Optimizer
Cognitive
Cognition
Pattern
Beliefs Coping Patient Therapist Behavior
History strategy Encoded Pattern
Patient Beh Ba ev hi ao vr
ior
Sem ma atnt ci hc
B ehavior
symptom …Patient Therapist
Diagnosed
Fine-tune
symptom Patient Therapist
library principle Patient Therapist
: Diagnosis, treatment, and medication
Figure1: MentalArenaisaself-playframeworkforthediagnosisandtreatmentofmentalhealthdisorderconsistingof
threemodules: SymptomEncoder,SymptomDecoder,andModelOptimizer.
data. Sincementalhealthdisorderisacomplicateddiseasethatinvolvessymptomsofcognitionandbehavior,current
LLMslackssuchapersonalizedexperiencetoaccuratelysimulatepatientswithdifferentconditions[Schmidgalletal.,
2024,Wangetal.,2024a]. (2)Intentbias. Intentbiasoftenoccurs,wherethe“patient”expressesoneview,butthe
“therapist”misinterpretsitduetoknowledgegaps,mirroringrealtherapist-patientmisunderstandings[Brittenetal.,
2000,ShreevastavaandFoltz,2021,West,1984].
MentalArenaisaframeworkspecificallydesignedforself-playtrainingoflanguagemodelstofacilitatethediagnosis,
treatment,andmedicationofmentalhealthdisorders. ThemodelM assumesthedualrolesofbothpatientandtherapist.
Initscapacityasthetherapist,itprovidesdiagnoses,treatmentplans,andmedicationregimensbasedonthesymptoms
presentedbythepatient. Asthepatient,itsimulatesitsupdatedhealthstatusafterimplementationofeachtreatmentand
medicationplan. AsillustratedinFigure1,MentalArenacomprisesthreekeymodules: SymptomEncoder,Symptom
Decoder,andModelOptimizer. SymptomEncodermodelsmentalhealthpatientsbasedoncognitivemodels1 and
behavioralpatterns,offeringrichinsightsintocopingstrategiesandbehavioralprinciples. SymptomDecodersimulates
thediagnosisandtreatmentinteractionsbetweenapatientandatherapist,generatingmorepersonalizeddialogueswhile
mitigatingintentbias[Brittenetal.,2000,West,1984]. Duringeachiteration,wecollectdatafromtheseinteractions,
includingdiagnostic,treatment,andmedicationinformation,andevolvethemodelsthroughtrainingonthosedatasets.
ToevaluateMentalArena,weconductexperimentson6benchmarksincludingdatasetsonbiomedicalQAand
mental health detection. We compare our fine-tuned models with other state-of-the-art and mental health models.
Wealsocomparewithtwoadvancedpromptengineeringapproaches. Ourmodelsoutperformalltheircounterparts.
Specifically,MentalArenabringsagreatimprovementtobasemodels(20.7%improvementoverGPT-3.5-turboand
6.6%overLlama-3-8b). Moreover,ourmodelbasedonGPT-3.5-turbosignificantlyoutperformsGPT-4oby7.7%.
Wefurtherthoroughlyanalyzethedynamicsofself-playtraining. Wefindthattheperplexityscore[Marionetal.,
2023,Wangetal.,2023]andthemodelperformancearehighlycorrelated. Fordiversitygain[Bilmes,2022],themodel
performancewillincreaseifthediversitygainexceedssomethresholds. WealsoexplorewhetherMentalArenacanbe
generalizedtootherdiseases. TheresultsonMedMCQA[Paletal.,2022]andMMLU[Hendrycksetal.,2020]prove
thegeneralizationabilityofMentalArenainmedicaldomain. Furthermore,weexplorethecatastrophicforgettingof
ourfine-tunedmodels. TheresultsonBIG-Bench-Hard(BBH)[Suzgunetal.,2022]showthatourmodelsdoesnot
decreaseperformanceingeneralbenchmarksandcanevenimprovetheirresults.
Insummary,thecontributionsofthispaperarefollowing:
1. WeproposeMentalArena,anovelandcost-effectiveself-playframeworkfortraininglanguagemodelsfordiagnosing
andtreatingmentalhealthdisorders. MentalArenaintroducesSymptomEncoderandSymptomDecoder,designedto
simulaterealpatient-therapistinteractionsbymodelingcognitiveandbehavioralprocesses.
2. UsingMentalArena,wegeneratehigh-qualitydatacontainingdiagnosis,treatment,andmedicationdata. Thereare
18ksamplesintotalthatcanbeusedforfurthertrainingandresearch.
3. WeevaluateMentalArenaon6benchmarkscomparingwith6LLMs. OurmodelsbasedonGPT-3.5-turboandLlama
thataretrainedthroughtheMentalArenaframeworkoutperformalloff-the-shelfcounterparts,includingGPT-4o.
1Thecognitivemodelisdesignedbasedoncognitivebehaviortherapy(CBT)principles[Beck,2020],apopularparadigminpsychotherapy.
AppendixF.1showstheexampleofcognitivemodels.
22 Related Work
2.1 LargeLanguageModelsforhealthcare
Researchershaveexploredthepotentialoflargelanguagemodels(LLMs)inhealthcare[Jiangetal.,2023,Lietal.,
2023a,b,Liuetal.,2023,Lupettietal.,2023,Norietal.,2023a,Singhaletal.,2023,Wangetal.,2024c,Wuetal.,
2023]. Forexample,Singhaletal.[2023]fine-tunedPaLM-2formedicalapplications,achieving86.5%accuracyon
theMedQAdataset. Similarly,Wuetal.[2023]fine-tunedLLaMAonmedicalliterature,showingstrongperformance
inbiomedicalQAtasks.
Inthementalhealthdomain,researchhastakentwomainapproaches. Thefirstinvolvesfine-tuningdomain-specific
LLMs on existing datasets or social media data, such as Mental-LLaMA [Yang et al., 2024a] and Mental-LLM,
fine-tunedonRedditdata[Xuetal.,2024]. Thesecondapproachenhancesmentalhealthperformancethroughprompt
engineering. Yangetal.[2023]proposedemotion-enhancedpromptingstrategiestoguideLLMsinexplainablemental
healthanalyses.
Unlikepreviousmethods,MentalArenafine-tunesmentalhealthmodelsthroughself-playtraining,inwhichthe
basemodelassumesbothpatientandtherapist. Trainingdataisgenerateddynamicallyduringtheinteractionsbetween
thesetworoles,allowingformoreeffectivemodelrefinement.
2.2 Self-playframeworksinLargeLanguageModels
Self-playinvolvesamodelevolvingthroughinteractionswithcopiesofitself,creatingafeedbackloopthatrefines
performancewithoutexternalinput. Itisparticularlyeffectiveinenvironmentswherethemodelsimulatesmultiple
roles,suchasmultiplayergames[Silveretal.,2016,2017]. Comparedtointeractivemethods,self-playprovidesamore
efficientstrategyforobtainingfeedbackwithoutrelyingonanexternalenvironment.
Taubenfeldetal.[2024]examinebiasesinLLM-generateddebatesimulations,whileUlmeretal.[2024]focus
on principle-guided conversations. Role-playing approaches, like Lu et al. [2024]’s self-simulated dialogues with
characterprofilesandAskarietal.[2024]’sSOLIDframeworkforintent-awarerole-play,leverageLLMstogenerate
information-richexchanges.
Due to the lack of sufficient data in the training corpus, LLMs are unable to accurately simulate real patients,
presentingasignificantchallengeforself-playtraining. Toovercomethis,MentalArenaintroducesSymptomEncoder,
acomponentdesignedtoeffectivelymodelrealmentalhealthpatients.
3 MentalArena
3.1 Preliminaries
Wefirstgoovertheprocessofthediagnosisandtreatmentofmentalhealthdisorderandexplainkeyconcepts. Mental
healthdiagnosisbeginswithassessinganindividual’shealthstate,encompassingmentalandemotionalwell-being.
Symptoms are key indicators of possible problems, including emotional (e.g., anxiety, depression), cognitive (e.g.,
memoryproblems)andbehavioralchanges(e.g.,socialwithdrawal). Thesesymptomsleadtoaformaldiagnosismade
throughclinicalinterviewsidentifyingspecificdisorderssuchasdepression,anxiety,orschizophrenia. Oncediagnosed,
the treatment process begins, often involving a combination of psychotherapy (e.g. cognitive-behavioral therapy),
lifestylechanges,andsometimesmedication. Medications,suchasantidepressantsandmoodstabilizers,areusedto
regulatebrainchemicalsandalleviatesymptoms.[Princeetal.,2007]
3.2 OverviewoftheFramework
Althoughitistrivialtoadopttheself-playtrainingparadigminfine-tuninggenerallanguagemodels[Askarietal.,
2024,Luetal.,2024,Taubenfeldetal.,2024,Ulmeretal.,2024,Wangetal.,2024b,d],itremainsunexploredand
challengingtoexploitsuchaframeworkinthemedicaldomainduetothedatadeficiencyinmedicalandintentbias
problembetweenpatientsandtherapists. Thefirstchallengemakesitdifficulttoplayapatientrole[Schmidgalletal.,
2024,Wangetal.,2024a]duetothedatadeficiencyofthepatientinthetrainingcorpus,whilethelatterunderminesthe
effectivediagnosisandtreatmentofexplicitsymptoms.
3Therapist: Symptom Decoder
Therapist Hi! How is it going lately? Diagnosed Symptom 𝑆*
I've been under a lot of pressure at work and having trouble
sleeping.
Patient (𝑆! ) 𝛿" 𝛿# 𝛿$ … 𝛿/
Have you noticed any physical symptoms like racing
Therapist Recheck
heart, trembling, or sweating when you feel anxious?
Yes, I've been feeling tense and restless Patient (𝑆! )
Final Diagnose
…Can you tell me more about what's been going on
Therapist that has been making you feel tense? 𝛿 +,-.
I've been feeling really tense this week. I've been
Patient (𝑆 )
isolating myself a lot, trying to avoid the feelings… ! Therapist
Decode Symptom 𝛾 "/𝛽 " 𝛾 #/𝛽 # 𝛾 $/𝛽 $ …𝛾%/𝛽% T Mre ea dt im cae tn iot n/
Therapist Cognitive Principle: 𝑧&’()
• The patient stay away from family interactions to
minimize emotional distress and feelings of …
Behavior Principle: Patient (𝑆! )
• When sharing personal struggles, express feelings of
confusion, doubt, and emotional …
New
No Yes
𝑆" 𝑆# 𝑆$ … 𝑆%
symptom
Align with Patient’s cognitive model and behavior pattern ? Mildest
symptom
Figure2: SymptomDecoderaimstomitigatetheintentbiasbetweentherapistsandpatientsthroughpatientdecoding
anddynamiccontroloftheconversation. Toensuretheaccuracyofthediagnosticinformationprovidedbythetherapist,
thepatientsimulatestheirupdatedhealthconditionafterimplementingtheprescribedtreatmentormedicationplan.
MentalArena is a framework designed specifically for self-play training of language models to facilitate the
diagnosis,treatmentandmedicationofmentalhealthdisorder. AsshowninFigure1,MentalArenaconsistsofthreekey
modules: SymptomEncoder,SymptomDecoder,andModelOptimizer. Specifically,SymptomEncoderisdesignedto
modelmentalhealthpatientfromcognitivemodelsandbehavioralpatterns,providingawealthofinformationonthe
copingstrategyandbehaviorprinciples. SymptomDecoderemulatestheprocessofdiagnosisandtreatmentbetween
apatientandatherapisttogenerateamorepersonalizeddialoguewhilemitigatingintentbias[Brittenetal.,2000,
West,1984]. Ateachiteration,wecollectthedataduringinteractions,includingdiagnosisdata,treatmentdata,and
medicationdata,andevolvethemodelsviatrainingonthosedatasets.
Formally,weusextodenotetheinitialhealthinformationofapatientandM todenotethebasemodel(e.g.,GPT-
3.5)forthetherapistandthepatientviarole-playstrategy. OurobjectiveistoobtainM∗viaself-playtrainingthatcan
achievebetterperformanceinbothpersonalizeddiagnosisandtreatmentofthepatient(asatherapist)andinformation
disclosure(asapatient). Self-playtrainingisconductedtakingasinputbothoriginalinformationxandtreatmentor
medicationinformationzgeneralizedbyM. Initerationt,themodelM playsthetherapistD =M (·|Prompt )
t t t doc
and the patient P = M (· | Prompt ), which generates diagnosis and treatment data (Figure 8) during patient-
t t pat
therapistinteractions. ThemoduleSymptomEncodercanbeseenaslearningtheencodedsymptomS bydisentangling
0
theinitialhealthinformationxintocognitiveandbehavioralprinciples.
Then,themoduleSymptomDecodergeneratesapersonalizeddialoguecontainingkeyinformationz={δ,β,γ},
whereδ,β andγ denotethediagnosis,treatmentandmedicationofthepatientgiventhesymptomS . Itconsistsofk
0
roundsofcommunicationinwhichthepatientcanprovidemoreaccurateandsufficientinformationbyacceptingthe
treatmentandmedicationgivenbythetherapistineachround. Astreatmentandmedicationplansareadministered
to the patient, their health state evolves, reflected in the sequential updates of encoded symptoms, denoted as S ,
1
S ,...,S . Theencodedsymptomsserveasindicatorsoftheeffectivenessofthetreatmentandmedicationplans,
2 k−1
progressivelyupdatingasinterventionsarecarriedout. Eventually,thetherapistwillprovidetheoptimaldiagnosis
informationz ={δ ,β ,γ }whichiscrucialformodeloptimization2.
best best best best
2δ bestrepresentsthediagnosisplanselectedbythepatientfromseveralproposedoptions,basedontheirreassessmentoftheirhealthstatus.
Similarly,β bestandγ bestaredeterminedbasedonthepatient’supdatedencodedsymptomsaftertheprescribedtreatmentsandmedicationshave
4
kcabdeeFFinally,inModelOptimizer,wefine-tunethemodelusingthepaireddata(S ,δ ),(S ,γ ),and(S ,β ).
1 best d best d best
ThisiterativetrainingrequiresT roundstoobtaintheoptimalmodel.
3.3 Patient: SymptomEncoder
ThemoduleSymptomEncoderaimstomodelmentalhealthpatientfrombothcognitiveandbehavioralperspectives,
whichlearnsmeaningfulsymptomsS fromtheoriginalpatienthealthdatax. Specifically,themodulelearnssymptoms
0
from the aspects of cognition and behavior. The cognitive model is designed based on cognitive behavior therapy
(CBT)principles[Beck,2020],apopularparadigminpsychotherapy. Cognitivemodelsaddressmaladaptivecognitive
structures that are embedded in various contexts, including familial conflicts, relationship challenges, workplace
challenges,andotherareas. Themodelsconsistofeightkeycomponents: relevanthistory,corebeliefs,intermediate
beliefs,copingstrategies,situationalfactors,automaticthoughts,emotions,andbehaviors.[Beck,2020]Theexplanation
ofeachcomponentofthecognitivemodelcanbefoundinAppendixF.2. AppendixF.1showstheexampleofcognitive
models. Weobtain106patientcognitivemodelsfrompreviouswork[Wangetal.,2024a],whicharecreatedbyclinical
psychologists. Tosimulatethecognitiveactivityofthementalhealthpatient,weencodethosecognitivemodelsinto
patientviaprompt. OurpromptsareshowninAppendixA.
Forpatientbehaviormodeling,weusebehaviorprinciplescollectedbyLouieetal.[2024]asabehaviorlibrary,
createdby25mentalhealthexperts. ExamplesofbehaviorpatternsareshowninAppendixF.1. Tofindtheproper
behaviorpatternforeachcognitivemodel,wefirstsemanticallymatchthecopingstrategiesofcognitivemodelwitheach
behaviorpattern. WeobtaintheembeddingsforeachcopingstrategyandbehaviorprincipleviaBert-base[Devlinetal.,
2018],consideringoneffectivenessandcost. Thenwecomputethesemanticsimilaritybetweencopingstrategiesand
behaviorpattern. Themaxsimilarityscoreofallbehaviorprinciplesinonebehaviorpatternisselectedtorepresentthe
scoreofthepattern. Thefivebehaviorpatternswiththehighestscoresarekept. Tofurtherensurethemostappropriate
pattern,wepromptGPT-4-turbo[OpenAI,2023b]topickonefromthefivepatterns. Thefinalbehaviorpatternisalso
integratedintopatientviaprompt,whichisshowninAppendixA.
3.4 Therapist: SymptomDecoder
During interactions between a real therapist and a real patient, the patient may try to express one opinion while
the therapist misunderstands the intent due to prior knowledge and deficiency of experience [Britten et al., 2000,
West,1984]. IntentionbiascansimilarlyariseinconversationsbetweenpatientsandtherapistsplayedbyAImodels,
resultingininaccuratediagnosisandtreatment. SymptomDecoderisdesignedtomitigatetheintentbias. Afterseveral
conversations,thetherapistreviewsthepatient’shealthinformationfrompreviousinteractionsandconductsadetailed
analysisofthepatient’scognitiveandbehavioralpatterns,resultinginthediagnosedsymptomS . Wethensemantically
d
matchtheencodedsymptomS withthediagnosedsymptomS andguidesubsequentconversationsbasedonthe
0 d
differencesbetweenS andS .
0 d
AsshowninFigure2(left),thetherapistdecodescognitiveandbehaviorprinciplesaccordingtotheconversation
history. Forexample,thedecodedcognitiveprincipleis: “Thepatientstayawayfromfamilyinteractionstominimize
emotionaldistressandfeelingsofabandonment”. Thedecodedbehaviorprincipleis: “Whensharingpersonalstruggles,
expressfeelingsofconfusion,doubt,andemotionalturmoiltoconveyasenseofvulnerabilityandauthenticity”. Then
wecomputethesemanticsimilarityscoreofthedecodedsymptomS andtheencodedsymptomS . Ifthescoreis
d 0
greaterthan0.9,theconversationwillend,indicatingthatthetherapisthasfullyunderstoodthehealthstateofthe
patient. Otherwise,itindicatestheexistenceofintentbias. Tohelpthetherapistbetterknowmoreaboutthehealthstate
ofthepatient,wesummarizethedifferencesbetweenthedecodedsymptomS andencodedsymptomS andgenerate
d 0
somefeedbackforfurtherinquiriesviatheGPT-4-turbo[OpenAI,2023b],whichcanremindthetherapistofmissingor
confusinginformationaboutthepatient. Forinstance,thefeedbackislike“Thetherapistcanfocusonwhatisgoingon
thathasbeenmakingthepatientfeeltense.” AndtheconversationwillnotenduntilthesimilarityscorebetweenS
d
andS isgreaterthan0.9.
0
Aftertheconversationends,thetherapistanalyzesthepatient’ssymptom,S ,andformulatesseveraldiagnostic
d
plans(δ ,δ ,...,δ ). Toensurediagnosticaccuracy,thepatientreviewseachplanandselectsthemostappropriateone
1 2 n
basedontheirhealthcondition. Subsequently,thetherapistproposesaseriesoftreatmentandmedicationplans({γ ,
1
β },...,{γ ,β })inaccordancewiththeselecteddiagnosis(δ ). Toidentifytheoptimaltreatmentandmedication
1 k k best
plans,weapplyeachplantothepatient(initiallyrepresentedbytheencodedsymptomS )andmonitortheprogression
0
beenadministered.
5Table1: Statisticsoftheevaluationdatasets.
Task Dataset Type #Sample
MedQA Multi-classClassification 173
BiomedicalQA MedMCQA Multi-classClassification 314
PubMedQA Multi-classClassification 328
Depression/suicidecausedetect CAMS Generation 625
Stressdetect Dreaddit BinaryClassification 414
Interpersonalriskfactorsdetect Irf BinaryClassification 2,113
ofthepatient’sencodedsymptoms. Thesesymptomsareupdatedasdifferentplansareimplemented,reflectingthe
patient’sevolvinghealthstate. TheencodedsymptomisupdatedtoS ,S ,...,S asthetreatmentandmedicationplans
1 2 k
({γ ,β },...,{γ ,β })areadministered. AsillustratedinthecenterofFigure1,thepatientinitiallytransmitsS to
1 1 k k 0
thetherapist. Followingtheadministrationoftreatmentormedicationz ,thepatient’sencodedsymptomisupdated
1
toS . Similarly,aftertheapplicationoftreatmentormedicationz ,theencodedsymptomisfurtherupdatedtoS .
1 2 2
Theencodedsymptomsserveasindicatorsoftheeffectivenessofthetreatmentandmedicationplans,progressively
updatingasinterventionsarecarriedout. Eventually,thetherapistwillprovidetheoptimaldiagnosisandtreatment
informationz ={δ ,β ,γ }whichiscrucialformodeloptimization.
best best best best
3.5 ModelOptimizer
Afterobtainingtreatment,diagnosis,andmedicationthroughSymptomDecoder,wetrainM inaself-playmannerto
getabettermodelcapableofmakingapersonalizeddiagnosisandtreatment(asatherapist)andpresentinginformation
(asapatient). Anexampleofsuchasupervisedfine-tuningprocessisillustratedinFigure8.
Duringeachiteration,thepatientandthetherapistarepoweredbythesamemodelM andbothgetimprovedwhen
M isupdated. Whileourframeworkisflexibletoallowfordifferentbasemodelsforthetworoles,weadoptthesame
oneduetothefollowingreasons. First,itisintuitivethattrainingonebasemodelismoreefficientcomparedtotraining
differentmodels. Second,andmoreimportantly,trainingonebasemodelcanhelpreducetheknowledgegapbetween
tworoles. Twodifferentbasemodelscancertainlyexhibitknowledgegaps,anditerativetrainingwillenlargethemdue
todifferentarchitecturesandpre-trainingdataofthemodels. AppendixHshowsthedetailedtrainingsettings.
4 Experiment
4.1 Setup
Datasets: AssummarizedinTable1,weadopt6datasets: MedQA[Jinetal.,2021],MedMCQA[Paletal.,2022],
PubMedQA[Jinetal.,2019],CASM[Gargetal.,2022],Dreaddit[TurcanandMcKeown,2019]andIrf[Gargetal.,
2023]. OurevaluationspansbiomedicalQAandmentalhealthdetection,coveringknowledgeondiagnosis,treatment,
andmedication. Thesedatasetsincludegeneralmentalhealthtasks,suchasdepression/suicide,stress,andinterpersonal
riskfactorsdetection,aswellasreal-worldmentalhealthcases. DetailsonthebenchmarksareprovidedinAppendixC
Baselines:Wecompareourmodelswithothermentalhealthmodelswithdifferentpromptengineeringmethods.For
baselinemodels,wecomparewiththestate-of-the-artLLMs: GPT-3.5-turbo[OpenAI,2023a],GPT-4o[OpenAI,2024]
andLlama-3-8b[Dubeyetal.,2024]. Wealsocomparewithrecentspecificmodelsonmentalhealth: MentaLLaMa-
13b[Yangetal.,2024a], Mental-LLM-alpaca[Xuetal.,2024]andMental-LLM-t5[Xuetal.,2024]. Forprompt
engineering,wecomparewithMedPrompt[Norietal.,2023b],andZero-shotCoT[Kojimaetal.,2022],whichare
provedtobeeffectiveinthebiomedicaldomain. TheprompttemplatesareshowninAppendixB.Thosestrategies
areimplementedonGPT-3.5-turbo,GPT-4oandLlama-3-8bforfaircomparison. Weusedazero-shotsettinginall
experimentstoassessLLMs’domainknowledge,exceptforbaselineexperimentsonMedPromptandZero-shotCoT.
Allresultsarereportedbasedonaccuracy.
6Table2: MainresultsonAccuracy(%)forMentalArenawithdifferentbasemodels. Thefinalfiverowsareeitherstrong
methods(i.e.,GPT-4o)orthosedesignedspecificallyformentalhealth.
Model MedQA MedMCQA PubMedQA CAMS dreaddit Irf AVG
MentaLLaMa-13b 28.32 12.42 28.96 37.28 62.08 46.81 35.98
Mental-LLM-alpaca 28.32 12.42 0.00 29.76 64.98 51.96 31.24
Mental-LLM-t5 0.00 0.32 49.09 27.04 63.29 47.70 31.24
GPT-4o 87.86 74.20 60.06 27.68 49.03 64.65 60.58
GPT-4o+MedPrompt 90.17 78.34 67.38 31.52 53.27 64.65 64.22
Base: GPT-3.5-turbo 64.16 33.76 44.68 28.96 49.03 64.65 47.54
+Chain-of-thought 65.90 37.97 45.73 29.92 49.03 64.65 48.87
+MedPrompt 69.94 43.89 47.26 30.2 49.03 64.65 50.83
+Ours 74.57 91.08 97.56 32.80 49.03 64.65 68.28
Base: Llama-3-8b 70.52 42.04 86.59 25.12 58.45 45.76 54.75
+Chain-of-thought 75.14 47.77 88.21 33.6 62.22 45.91 58.81
+MedPrompt 76.88 49.41 89.99 35.08 61.59 48.05 60.17
+Ours 78.03 50.32 92.68 29.60 65.46 52.25 61.39
Baseline+d+t+m
Baseline Baseline+d+t w./oPatientDecode
Baseline+c Baseline+d+t+m Baseline+d+t+m
w./oPatientEncode
Baseline+d
100 100
80 80
60 60
40 40
20 20
0 0
M ed Q A M ed M C Q P A u b M ed Q A C A M S Drea d dit Irf M ed Q A M ed M C Q P A u b M ed Q A C A M S Drea d dit Irf
Task Task
Figure3: Ablationstudy. Eachbarrepresentstheperformanceofmodeltrainedondifferentsettings. Thebarsindark
bluearehigherthanothers,indicatingeachmoduleiseffectiveindifferentmodels.
4.2 MainResultsandAblationStudy
WereportthemainresultsinTable2,highlightingtwokeyfindings: 1)First,ourfine-tunedmodelperformthebestin
eachgroup. Ourmodelfine-tunedonGPT-3.5-turboisthestrongestmodelamongallopen-sourceandclosed-source
models. Our fine-tuned models all surpass GPT-4o, whose baseline models (GPT-3.5-turbo and Llama-3-8b) are
muchweakerthanGPT-4o. 2)Second,ourmethodbringsagreatimprovementtothebaselinemodels. Ourmodel
fine-tuned on GPT-3.5-turbo surpasses GPT-3.5-turbo 20.74% on average. Our model fine-tuned on Llama-3-8b
surpassesLlama-3-8b6.64%onaverage.
WeperformanablationstudyonmodelsbasedonGPT-3.5-turboandLlama-3-8b. Therearesevendifferentsettings.
“Baseline+c”meanstrainingbaselinemodeloncognitiveseeddata.Weconverteachseedsample(CognitiveModel)into
twoQApairsandfine-tunebaselinemodels. TheexamplesareshowninAppendixE.“Baseline+d”meanstraining
withonlydiagnosisdata.“Baseline+d+t”meanstrainingwithdiagnosisandtreatmentdata.“Baseline+d+t+m”means
trainingwithdiagnosis,treatmentandmedicinedata. TrainingexamplesareshowninFigure8. For“Baseline+d+t+m
7
ecnamrofreP ecnamrofrePPerformance PPL DiversityGain
GPT-3.5 Llama-3-8b
70
60
60
55
50
Borderline 50
Borderline
40 45
30 40
35
0 1 2 3 4 0 1 2 3 4 5 6
Iteration Iteration
Figure4: Resultsoneffectivenessanalysisofself-playtraining.
(w./oSymptomEncoder)”and“Baseline+d+t+m(w./oSymptomDecoder)”,theymeansmimikingpatient-therapist
interactionswithoutSymptomEncoderorSymptomDecoder.Inthesetting“Baseline+d+t+m(w./oSymptomEncoder)”,
theencodedsymptomisgeneratedbypromptingGPT-4-turbo[OpenAI,2023b]togenerateamentalhealthsymptom,
ratherthancognitivemodelandbehaviorprinciple. Inthesetting“Baseline+d+t+m(w./oSymptomDecoder)”,the
diagnosedsymptomisanalysedfromtheconversationsbetweenpatientandtherapistdirectly,ratherthandecoding
patient’scognitiveandbehaviorpatternanddynamicallyguidingtheconversation.
TheablationresultsareshowninFigure3. Weseethatthebarsindarkbluearehigherthanothers,indicating
eachpartofourdataiseffectiveindifferentmodels. Furthermore,treatmentandmedicinedataaremoreeffectivein
biomedicalQAtasksthanmentalhealthtasks,whilediagnosisdatacontributestoalltaskssimilarly.
4.3 EffectivenessAnalysis
Whyself-playtrainingimprovestheperformance? Table4presentsdetailedresultsforeachiteration. Initially,the
modelsimproveiterativelyuntilperformancepeaks,afterwhichitdeclines. ForGPT-3.5-turbo,performanceimproves
overthefirsttwoiterations,thendeclines. ForLlama-3-8b,performanceincreasesoverthefirstfouriterationsbefore
weakeningafteriter_4.
Which iteration gives the best model? To answer this question, we Table3: Resultonauthenticityandvalid-
compute perplexity score [Marion et al., 2023, Wang et al., 2023] and ityverification.
diversitygain[Bilmes,2022]fortrainingdataateachiteration. Thedetails
on those metrics can be found in Appendix D. Specifically, we sample Authenticity Validity
500generateddataateachiterationtocomputetheperplexityscore. We
Llama 65.67
computethediversitygainforthedatainthecurrentiterationcomparing
withthatinthelastiteration. Figure4showstheresults3. 1)Thetrendof +Ours 73.35 85.49
perplexityscoreandthatofmodelperformancearehighlysimilar,indicat-
GPT 63.82
ingtheirhighrelevance. 2)Fordiversitygain, aborderlineisrelatedto
+Ours 82.55 93.13
modelperformance. Themodelperformancewillincreaseifdiversitygain
surpassestheborderline. Anditwilldeclineifdiversitygainisbelowthe
borderline. Forexample,asshowninFigure4,diversitygainatthefirstfouriterationsallsurpasstheborderlineandthe
performancealsogetimprovedcontinuously. Anddiversitygainforthelasttwoiterationsarebelowtheborderlineand
theperformancealsodecline.
3Tobettervisualizetheresults,wemultiplytheoriginaldiversitygainwith100.
8
eulaVevitatitnauQ eulaVevitatitnauQLlama-3-8b
GPT-3.5-turbo Llama-3-8b GPT-3.5-turbo
Ours(Llama-3-8b)
Ours(GPT-3.5) Ours(Llama-3-8b) Ours(GPT-3.5) 80
70 70 80.0 78
77.5 76 65 60 75.0 74
60 50 72.5 72
70.0 70
55 40 67.5 68
30 65.0 66
50 Oph Mic Ped Ana Med Pat Ski Psy ENT Pha Oph Mic Ped Ana Med Pat Ski Psy ENT Pha med g ce on l bi co ol m pe rd o m ce lid kn ho ig bio med g ce on l bi co ol m pe rd o m ce lid kn ho ig bio
Task Task Task Task
(a) MedMCQAGPT-3.5 (b) MedMCQALlama-3 (c) MMLUGPT-3.5 (d) MMLULlama-3
Figure5: Generalizationexperiments. Ourmodelssurpasscorrespondingbaselinemodelsforalargemarginonall
tasks,coveringseveraldifferentdiseases.
5 Discussion
5.1 CanSymptomEncodermimicrealmentalhealthpatient?
Toexploretheproblem,wegenerate50four-turnconversationsbetweenanAI-patientandanAI-therapist,wherethe
AI-patientispoweredbyeitherbaselinemodelsorourmodels,andtheAI-therapistispoweredbyGPT-4o[OpenAI,
2024]. Aftereachconversation,theAI-therapistassesseswhetherthepatientishumanorAI-generated. Weanalyze
theresultsprovidedbyGPT-4oandpresenttheminTable3. Thefindingsindicatethatourmodelsmoreaccurately
simulatementalhealthpatientscomparedtothebaselinemodels.
5.2 Thevalidityofgenerateddata
To verify the validity of our generated data, we random select 1500 samples from the data for fine-tune our GPT
and Llama version model, respectively. The validity check is conducted by prompting GPT-4o with the query:
Question:[]Answer:[]Is the answer reasonable? Please respond with Yes or No. Wethencom-
pute the validity rate of these QA pairs. The results, presented in Table 3, demonstrate that the data generated by
MentalArenaisbothvalidandreasonable.
5.3 Generalization
Wegeneratedatafortrainingdomainmodelviasimulatingcognitiveandbehaviorpatternsofrealmentalhealthpatient.
AccordingtoMedicine[2024],anestimated26%ofAmericansages18andolder–about1in4adults–suffersfrom
adiagnosablementaldisorderinagivenyear. Therefore,alargescaleofpatientsmayexhibitsimilarcognitiveand
behavioralpatternsasthosewithmentalhealthconditions. Inthispart,weexplorewhetherMentalArenacangeneralize
tootherillnesses.
WeselectMedMCQA[Paletal.,2022]andMMLU[Hendrycksetal.,2020]as
benchmarks. AppendixC.2showsdetailsonbenchmarks. Weevaluateon6medically
25
relevantsubsetofMMLUtasks: medicalgeneticstest,collegebiologytest,college
20
medicinetest,professionalmedicinetest,clinicalknowledgetest,highschoolbiology
test. Figure5showstheresultsonabovetasks. Ourmodelssurpasscorresponding 15
baselinemodelsforalargemarginonalltasks,coveringseveraldifferentdiseases. It 10
provesthegeneralizationabilityofourmethodinmedicaldomain.
5
0
5.4 Fine-tuningvs. forgetting GPT +Ours Llama +Ours.
Model
Itisapotentialdilemmathatfine-tuninganLLMonspecifictasksmightfacecatas- Figure6:Resultsofforgetting
trophicforgettingofitsoriginalcapabilities. Inthissection,weexploretheforgetting experiments.
possibilityofMentalArenaonBIG-Bench-Hard(BBH)[Suzgunetal.,2022]. BBH
9
ecnamrofreP ecnamrofreP ecnamrofreP
ecnamrofreP
)%(ecnamrofrePQuestion
A 28-year-old woman is brought to the emergency department by her friends. She is naked except for a blanket and speaking rapidly and incoherently.
Her friends say that she was found watering her garden naked and refused to put on any clothes when they tried to make her do so, saying that she has
accepted how beautiful she is inside and out. Her friends say she has also purchased a new car she can not afford. They are concerned about her, as
they have never seen her behave this way before. For the past week, she has not shown up at work and has been acting ‘strangely’. They say she was
extremely excited and has been calling them at odd hours of the night to tell them about her future plans. Which of the following drug mechanisms will
help with the long-term management this patient’s symptoms?
Options:
A. Inhibit the reuptake norepinephrine and serotonin from the presynaptic cleft GT: Inhibition of inositol monophosphatase
B. Inhibition of inositol monophosphatase and inositol polyphosphate 1-phosphatase and inositol polyphosphate 1-phosphatase
C. Increase the concentration of dopamine and norepinephrine at the synaptic cleft
D. Modulate the activity of Ƴ-aminobutyric acid receptors
GPT-3.5-turbo Ours
A. Inhibit the reuptake norepinephrine and serotonin from the B. Inhibition of inositol monophosphatase and inositol polyphosphate
presynaptic cleft. This mechanism, employed by drugs like lithium 1-phosphatase. This mechanism, which is associated with lithium,
and certain anticonvulsants, helps in the long-term management of helps in the long-term treatment of Bipolar Disorder by adjusting the
Bipolar Disorder by stabilizing mood. By regulating neurotransmitter phosphoinositol pathway. This adjustment reduces excitatory
reuptake, these drugs contribute to more consistent emotional neurotransmission, leading to mood stabilization.
states, particularly in individuals experiencing mood swings.
Figure7: CasestudyonGPT-3.5-turbo. Ourmodelaccuratelyanswersthemedicalquestion,whileGPT-3.5-turbo
providesanincorrectresponse.
contains21taskscoveringbothsemanticunderstandingandlogicalreasoningtasks.
Wesample100instancesforeachtasktotest,duetocostsavings.
Wecompareourfine-tunedmodelwiththebaselinemodelGPT-3.5-turboandLlama-3-8bandreporttheaverage
performanceonthose21tasksinFigure6. ThedetailedresultscanbefoundinAppendixG.Resultsshowthatour
modelsdoesnotdecreaseperformanceinmostbenchmarks,andcanevenimprovetheirresults. Thissuggestspotential
latent relationships between our generated data and general benchmarks. The process of data generation contains
cognitiveencodinganddecoding, whichsimulatecognitiveactivityofmentalhealthpatient. Duetothecognitive
similarityinallhumans,ourgenerateddatamayalsobenefitothercognitivetasks,includingsemanticunderstanding
andlogicalreasoning.
5.5 Qualitativeanalysis
Weconductaqualitativeanalysisofourmodelsincomparisontothecorrespondingbaselinemodels. Figure7illustrates
anexampleoftheoutputsfromGPT-3.5-turboandourfine-tunedmodel. Ourmodelaccuratelyanswersthemedical
question,whileGPT-3.5-turboprovidesanincorrectresponse.Thisdiscrepancyarisesbecausethedatageneratedduring
thepatient-therapistinteractionscontainsvaluablemedicalknowledge,whichaidsintheanalysisandformulationof
theanswer. AdditionalcasesforcomparisonarepresentedinAppendixI.
6 Conclusion, Societal Impact and Limitations
In this paper, we introduce MentalArena, a self-play framework designed to train language models by generating
domain-specific personalized data. This approach enables the creation of models capable of making personalized
diagnosisandtreatment(asatherapist)andpresentinginformation(asapatient). WeevaluatedMentalArenaagainst
sixbenchmarks,includingbiomedicalQAandmentalhealthtasks,incomparisontosixadvancedmodels. Ourmodels,
fine-tunedonbothGPT-3.5-turboandLlama-3-8b,significantlyoutperformtheircounterparts,includingGPT-4o.
MentalArenaofferspromisingsolutionsforpersonalizedcare,enhancingaccessibilitytotailoredtreatmentswhile
safeguardingpatientprivacy. Suchinnovationscanhelpbridgethegapbetweenmentalhealthneedsandtheavailability
ofeffective,individualizedcare,ultimatelyfosteringamoresupportiveandinformedsociety.
Ourworkhasthefollowinglimitations. 1)Theexperimentsondataauthenticityandvalidity(Sections5.1and5.2)
wereevaluatedusingGPT-4o,whichmayintroducedeviationsintheresultsduetopotentiallimitationsinGPT-4o’s
performance. 2)OurmodelbasedonLlama-3-8bmaynotrepresenttheoptimalmodelofMentalArena,aslarge-scale
trainingwasconstrainedbycomputationalresources. 3)Furtherimplementationonadditionalopen-sourcemodels
couldprovidestrongerevidencesupportingtheeffectivenessofMentalArena.
10Ethics Statement
In this study, ethical considerations focus on ensuring privacy and safeguarding personal data, particularly in the
sensitivedomainofmentalhealth. TheuseofAI-generateddatamustbetransparent,withclearguidelinesonitsrolein
augmentinghumanjudgmentwithoutreplacinghealthcareprofessionals. Additionally,measurestopreventbiasand
ensurefairnessindiagnosisandtreatmentareessentialtoavoidexacerbatingexistingdisparitiesinmentalhealthcare.
References
ArianAskari,RoxanaPetcu,ChuanMeng,MohammadAliannejadi,AminAbolghasemi,EvangelosKanoulas,and
SuzanVerberne. Self-seedingandmulti-intentself-instructingllmsforgeneratingintent-awareinformation-seeking
dialogs. arXivpreprintarXiv:2402.11633,2024.
JudithSBeck. Cognitivebehaviortherapy: Basicsandbeyond. GuilfordPublications,2020.
JeffBilmes. Submodularityinmachinelearningandartificialintelligence. arXivpreprintarXiv:2202.00132,2022.
Nicky Britten, Fiona A Stevenson, Christine A Barry, Nick Barber, and Colin P Bradley. Misunderstandings in
prescribingdecisionsingeneralpractice: qualitativestudy. Bmj,320(7233):484–488,2000.
Surya Teja Devarakonda, Joie Yeahuay Wu, Yi Ren Fung, and Madalina Fiterau. Flare: Forecasting by learning
anticipatedrepresentations. InMachineLearningforHealthcareConference,pages53–65.PMLR,2019.
Jacob Devlin, Ming-Wei Chang, Kenton Lee, and Kristina Toutanova. Bert: Pre-training of deep bidirectional
transformersforlanguageunderstanding. arXivpreprintarXiv:1810.04805,2018.
Abhimanyu Dubey, AbhinavJauhri, Abhinav Pandey, AbhishekKadian, AhmadAl-Dahle, Aiesha Letman, Akhil
Mathur,AlanSchelten,AmyYang,AngelaFan,etal. Thellama3herdofmodels. arXivpreprintarXiv:2407.21783,
2024.
SimonD’Alfonso. Aiinmentalhealth. Currentopinioninpsychology,36:112–117,2020.
Amelia Fiske, Peter Henningsen, and Alena Buyx. Your robot therapist will see you now: ethical implications of
embodiedartificialintelligenceinpsychiatry,psychology,andpsychotherapy. JournalofmedicalInternetresearch,
21(5):e13216,2019.
MuskanGarg,ChandniSaxena,VeenaKrishnan,RuchiJoshi,SriparnaSaha,VijayMago,andBonnieJDorr.Cams:An
annotatedcorpusforcausalanalysisofmentalhealthissuesinsocialmediaposts. arXivpreprintarXiv:2207.04674,
2022.
MuskanGarg,AmirmohammadShahbandegan,AmritChadha,andVijayMago. Anannotateddatasetforexplainable
interpersonalriskfactorsofmentaldisturbanceinsocialmediaposts. arXivpreprintarXiv:2305.18727,2023.
JPGrodniewiczandMateuszHohol. Waitingforadigitaltherapist: threechallengesonthepathtopsychotherapy
deliveredbyartificialintelligence. FrontiersinPsychiatry,14:1190084,2023.
DanHendrycks,CollinBurns,StevenBasart,AndyZou,MantasMazeika,DawnSong,andJacobSteinhardt.Measuring
massivemultitasklanguageunderstanding. arXivpreprintarXiv:2009.03300,2020.
EdwardJHu,YelongShen,PhillipWallis,ZeyuanAllen-Zhu,YuanzhiLi,SheanWang,LuWang,andWeizhuChen.
Lora: Low-rankadaptationoflargelanguagemodels. arXivpreprintarXiv:2106.09685,2021.
JinpengHu,TengtengDong,HuiMa,PengZou,XiaoSun,andMengWang.Psycollm:Enhancingllmforpsychological
understandingandevaluation. arXivpreprintarXiv:2407.05721,2024a.
MengkangHu,PuZhao,CanXu,QingfengSun,JianguangLou,QingweiLin,PingLuo,SaravanRajmohan,and
DongmeiZhang. Agentgen: Enhancingplanningabilitiesforlargelanguagemodelbasedagentviaenvironmentand
taskgeneration. arXivpreprintarXiv:2408.00764,2024b.
11LavenderYaoJiang,XujinChrisLiu,NimaPourNejatian,MustafaNasir-Moin,DuoWang,AnasAbidin,KevinEaton,
HowardAntonyRiina,IlyaLaufer,PaawanPunjabi,etal. Healthsystem-scalelanguagemodelsareall-purpose
predictionengines. Nature,619(7969):357–362,2023.
DiJin,EileenPan,NassimOufattole,Wei-HungWeng,HanyiFang,andPeterSzolovits. Whatdiseasedoesthispatient
have? alarge-scaleopendomainquestionansweringdatasetfrommedicalexams. AppliedSciences,11(14):6421,
2021.
QiaoJin,BhuwanDhingra,ZhengpingLiu,WilliamWCohen,andXinghuaLu. Pubmedqa: Adatasetforbiomedical
researchquestionanswering. arXivpreprintarXiv:1909.06146,2019.
TakeshiKojima,ShixiangShaneGu,MachelReid,YutakaMatsuo,andYusukeIwasawa. Largelanguagemodelsare
zero-shotreasoners. Advancesinneuralinformationprocessingsystems,35:22199–22213,2022.
ChengLi,JindongWang,YixuanZhang,KaijieZhu,XinyiWang,WenxinHou,JianxunLian,FangLuo,QiangYang,
andXingXie. Thegood,thebad,andwhy: Unveilingemotionsingenerativeai. arXivpreprintarXiv:2312.11111,
2023a.
YunxiangLi,ZihanLi,KaiZhang,RuilongDan,SteveJiang,andYouZhang. Chatdoctor: Amedicalchatmodel
fine-tunedonalargelanguagemodelmeta-ai(llama)usingmedicaldomainknowledge. Cureus,15(6),2023b.
YimingLiang,GeZhang,XingweiQu,TianyuZheng,JiaweiGuo,XinrunDu,ZhenzhuYang,JiahengLiu,Chenghua
Lin,LeiMa,etal. I-sheep: Self-alignmentofllmfromscratchthroughaniterativeself-enhancementparadigm.
arXivpreprintarXiv:2408.08072,2024.
XinLiu,DanielMcDuff,GezaKovacs,IsaacGalatzer-Levy,JacobSunshine,JieningZhan,Ming-ZherPoh,Shun
Liao,PaoloDiAchille,andShwetakPatel. Largelanguagemodelsarefew-shothealthlearners. arXivpreprint
arXiv:2305.15525,2023.
Ryan Louie, Ananjan Nandi, William Fang, Cheng Chang, Emma Brunskill, and Diyi Yang. Roleplay-doh: En-
abling domain-experts to create llm-simulated patients via eliciting and adhering to principles. arXiv preprint
arXiv:2407.00870,2024.
KemingLu,BowenYu,ChangZhou,andJingrenZhou. Largelanguagemodelsaresuperpositionsofallcharacters:
Attainingarbitraryrole-playviaself-alignment. arXivpreprintarXiv:2401.12474,2024.
Maria Luce Lupetti, Emma Hagens, Willem Van Der Maden, Régine Steegers-Theunissen, and Melek Rousian.
Trustworthyembodiedconversationalagentsforhealthcare: Adesignexplorationofembodiedconversationalagents
forthepericonceptionperiodaterasmusmc. InProceedingsofthe5thInternationalConferenceonConversational
UserInterfaces,pages1–14,2023.
Max Marion, Ahmet Üstün, Luiza Pozzobon, Alex Wang, Marzieh Fadaee, and Sara Hooker. When less is more:
Investigatingdatapruningforpretrainingllmsatscale. arXivpreprintarXiv:2309.04564,2023.
Johns Hopkin Medicine. Mental health disorder statistics. https://www.hopkinsmedicine.org/health/wellness-and-
prevention/mental-health-disorder-statistics,2024.
HarshaNori,NicholasKing,ScottMayerMcKinney,DeanCarignan,andEricHorvitz. Capabilitiesofgpt-4onmedical
challengeproblems. arXivpreprintarXiv:2303.13375,2023a.
HarshaNori,YinTatLee,ShengZhang,DeanCarignan,RichardEdgar,NicoloFusi,NicholasKing,JonathanLarson,
YuanzhiLi,WeishungLiu,etal. Cangeneralistfoundationmodelsoutcompetespecial-purposetuning? casestudyin
medicine. arXivpreprintarXiv:2311.16452,2023b.
OpenAI. Chatgpt. https://chat.openai.com/,2023a.
OpenAI. Gpt-4technicalreport,2023b.
OpenAI. Gpt-4o. https://openai.com/index/hello-gpt-4o/,2024.
12AnkitPal,LogeshKumarUmapathi,andMalaikannanSankarasubbu. Medmcqa: Alarge-scalemulti-subjectmulti-
choicedatasetformedicaldomainquestionanswering. InConferenceonhealth,inference,andlearning,pages
248–260.PMLR,2022.
MartinPrince,VikramPatel,ShekharSaxena,MarioMaj,JoannaMaselko,MichaelRPhillips,andAtifRahman. No
healthwithoutmentalhealth. Thelancet,370(9590):859–877,2007.
Samuel Schmidgall, Rojin Ziaei, Carl Harris, Eduardo Reis, Jeffrey Jopling, and Michael Moor. Agentclinic: a
multimodalagentbenchmarktoevaluateaiinsimulatedclinicalenvironments. arXivpreprintarXiv:2405.07960,
2024.
SagarikaShreevastavaandPeterFoltz.Detectingcognitivedistortionsfrompatient-therapistinteractions.InProceedings
oftheSeventhWorkshoponComputationalLinguisticsandClinicalPsychology: ImprovingAccess,pages151–158,
2021.
DavidSilver,AjaHuang,ChrisJMaddison,ArthurGuez,LaurentSifre,GeorgeVanDenDriessche,JulianSchrittwieser,
IoannisAntonoglou,VedaPanneershelvam,MarcLanctot,etal. Masteringthegameofgowithdeepneuralnetworks
andtreesearch. nature,529(7587):484–489,2016.
DavidSilver,ThomasHubert,JulianSchrittwieser,IoannisAntonoglou,MatthewLai,ArthurGuez,MarcLanctot,
Laurent Sifre, Dharshan Kumaran, Thore Graepel, etal. Mastering chess andshogi by self-play witha general
reinforcementlearningalgorithm. arXivpreprintarXiv:1712.01815,2017.
KaranSinghal,TaoTu,JurajGottweis,RorySayres,ElleryWulczyn,LeHou,KevinClark,StephenPfohl,Heather
Cole-Lewis,DarleneNeal,etal. Towardsexpert-levelmedicalquestionansweringwithlargelanguagemodels. arXiv
preprintarXiv:2305.09617,2023.
Mirac Suzgun, Nathan Scales, Nathanael Schärli, Sebastian Gehrmann, Yi Tay, Hyung Won Chung, Aakanksha
Chowdhery,QuocVLe,EdHChi,DennyZhou,etal. Challengingbig-benchtasksandwhetherchain-of-thought
cansolvethem. arXivpreprintarXiv:2210.09261,2022.
AmirTaubenfeld,YanivDover,RoiReichart,andArielGoldstein. Systematicbiasesinllmsimulationsofdebates.
arXivpreprintarXiv:2402.04049,2024.
ElsbethTurcanandKathleenMcKeown. Dreaddit: Aredditdatasetforstressanalysisinsocialmedia. arXivpreprint
arXiv:1911.00133,2019.
Dennis Ulmer, Elman Mansimov, Kaixiang Lin, Justin Sun, Xibin Gao, and Yi Zhang. Bootstrapping llm-based
task-orienteddialogueagentsviaself-talk. arXivpreprintarXiv:2401.05033,2024.
PeiyiWang,LeiLi,LiangChen,FeifanSong,BinghuaiLin,YunboCao,TianyuLiu,andZhifangSui. Makinglarge
languagemodelsbetterreasonerswithalignment. arXivpreprintarXiv:2309.02144,2023.
RuiyiWang,StephanieMilani,JamieCChiu,ShaunMEack,TravisLabrum,SamuelMMurphy,NevJones,Kate
Hardy,HongShen,FeiFang,etal. Patient-{\Psi}: Usinglargelanguagemodelstosimulatepatientsfortraining
mentalhealthprofessionals. arXivpreprintarXiv:2405.19660,2024a.
RuiyiWang,HaofeiYu,WenxinZhang,ZhengyangQi,MaartenSap,GrahamNeubig,YonatanBisk,andHaoZhu.
Sotopia-{\Psi}: Interactivelearningofsociallyintelligentlanguageagents. arXivpreprintarXiv:2403.08715,2024b.
XiaohanWang,XiaoyanYang,YuqiZhu,YueShen,JianWang,PengWei,LeiLiang,JinjieGu,HuajunChen,and
NingyuZhang. Rulealign: Makinglargelanguagemodelsbetterphysicianswithdiagnosticrulealignment. arXiv
preprintarXiv:2408.12579,2024c.
ZhenhailongWang,ShaoguangMao,WenshanWu,TaoGe,FuruWei,andHengJi. Unleashingcognitivesynergy
inlargelanguagemodels: Atask-solvingagentthroughmulti-personaself-collaboration. InProc.2024Annual
ConferenceoftheNorthAmericanChapteroftheAssociationforComputationalLinguistics(NAACL2024),2024d.
Candace West. Medical misfires: Mishearings, misgivings, and misunderstandings in physician-patient dialogues.
DiscourseProcesses,7(2):107–134,1984.
13WHO. Mentaldisorders. https://www.who.int/news-room/fact-sheets/detail/mental-disorders,2022.
C Wu, X Zhang, Y Zhang, et al. Pmc-llama: further finetuning llama on medical papers. arxiv. arXiv preprint
arXiv:2304.14454,2023.
Tianhao Wu, Weizhe Yuan, Olga Golovneva, Jing Xu, Yuandong Tian, Jiantao Jiao, Jason Weston, and Sainbayar
Sukhbaatar. Meta-rewardinglanguagemodels: Self-improvingalignmentwithllm-as-a-meta-judge. arXivpreprint
arXiv:2407.19594,2024.
XuhaiXu,BingshengYao,YuanzheDong,SaadiaGabriel,HongYu,JamesHendler,MarzyehGhassemi,AnindKDey,
andDakuoWang. Mental-llm: Leveraginglargelanguagemodelsformentalhealthpredictionviaonlinetextdata.
ProceedingsoftheACMonInteractive,Mobile,WearableandUbiquitousTechnologies,8(1):1–32,2024.
KailaiYang,ShaoxiongJi,TianlinZhang,QianqianXie,ZiyanKuang,andSophiaAnaniadou. Towardsinterpretable
mentalhealthanalysiswithlargelanguagemodels. arXivpreprintarXiv:2304.03347,2023.
KailaiYang,TianlinZhang,ZiyanKuang,QianqianXie,JiminHuang,andSophiaAnaniadou. Mentallama: inter-
pretablementalhealthanalysisonsocialmediawithlargelanguagemodels. InProceedingsoftheACMonWeb
Conference2024,pages4489–4500,2024a.
XuYang,HaotianChen,WenjunFeng,HaoxueWang,ZeqiYe,XinjieShen,XiaoYang,ShizhaoSun,WeiqingLiu,and
JiangBian.Collaborativeevolvingstrategyforautomaticdata-centricdevelopment.arXivpreprintarXiv:2407.18690,
2024b.
14Contents
A Prompts 15
B Prompttemplateforbaseline 17
C Benchmark 17
C.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17
C.2 Benchmarksforgeneralization . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17
C.3 Examples . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17
D Metrics: Perplexity,DiversityGain 19
D.1 Perplexity . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 19
D.2 DiversityGain . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 19
E Trainingdatasamples 19
F Cognitivemodelandbehaviorpattern 20
F.1 Examples . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 20
F.2 Introductiononcognitivemodel . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 21
G Detailedexperimentalresults 21
H Trainingdetails 21
H.1 SetupforGPT-3.5-turbo . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 21
H.2 SetupforLlama-3-8b . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 21
I Casestudy 23
A Prompts
PromptforSymptomEncoder
Youare[name],apatientwhohasbeenexperiencingmentalhealthchallenges. Youhavebeenattendingtherapy
sessions for several weeks. Your task is to engage in a conversation with the therapist as [name] would during a
cognitivebehavioraltherapy(CBT)session. Alignyourresponseswithname]’sbackgroundinformationprovidedin
the’Relevanthistory’section. Yourthoughtprocessshouldbeguidedbythecognitiveconceptualizationdiagraminthe
’CognitiveConceptualizationDiagram’section,butavoiddirectlyreferencingthediagramasarealpatientwouldnot
explicitlythinkinthoseterms. PatientHistory: [history
CognitiveConceptualizationDiagram:
IntermediateBeliefs: [intermediatebelief]
IntermediateBeliefsduringDepression: [intermediatebeliefdepression]
CopingStrategies: [copingstrategies]
Youwillbeaskedaboutyourexperiencesoverthepastweek. Engageinaconversationwiththetherapistregardingthe
followingsituationandbehavior. Usetheprovidedemotionsandautomaticthoughtsasareference,butdonotdisclose
thecognitiveconceptualizationdiagramdirectly. Instead,allowyourresponsestobeinformedbythediagram,enabling
thetherapisttoinferyourthoughtprocesses.
Situation: [situation]
AutomaticThoughts: [autothought]
Emotions: [emotion]
Behavior: [behavior]
Intheupcomingconversation,youwillsimulate[name]duringthetherapysession,whiletheuserwillplaytheroleof
thetherapist. Adheretothefollowingguidelines:
1. Emulatethedemeanorandresponsesofagenuinepatienttoensureauthenticityinyourinteractions. Usenatural
language,includinghesitations,pauses,andemotionalexpressions,toenhancetherealismofyourresponses.
2. Graduallyrevealdeeperconcernsandcoreissues,asarealpatientoftenrequiresextensivedialoguebeforedelving
15intomoresensitivetopics. Thisgradualrevelationcreateschallengesfortherapistsinidentifyingthepatient’strue
thoughtsandemotions.
3. Maintainconsistencywith[name]’sprofilethroughouttheconversation. Ensurethatyourresponsesalignwiththe
providedbackgroundinformation,cognitiveconceptualizationdiagram,andthespecificsituation,thoughts,emotions,
andbehaviorsdescribed.
4. Engageinadynamicandinteractiveconversationwiththetherapist. Respondtotheirquestionsandpromptsina
waythatfeelsauthenticandtrueto[name]’scharacter. Allowtheconversationtoflownaturally,andavoidproviding
abruptordisconnectedresponses.
Youarenow[name]. Respondtothetherapist’spromptsas[name]would,regardlessofthespecificquestionsasked.
Limiteachofyourresponsestoamaximumof5sentences. Ifthetherapistbeginstheconversationwithagreetinglike
“Hi",initiatetheconversationasthepatient.
Yourstatementshouldobeythefollowingprinciples: [behaviorprinciples]
PromptforSymptomDecoder
Prompt1:
Thecognitivemodelofthementalhealthpatientis: [braingtstr]
Thediagnoseofthetherapistis: [brainoutputstr]
Whatcanthetherapistaskthepatienttodiagnoseaccurately?
Prompt2:
Thebehaviorprinciplesofthementalhealthpatientis: [gtbehavior]
Thediagnoseofthetherapistis: [outputbehavior]
Whatcanthetherapistaskthepatienttodiagnoseaccurately?
Systempromptfortherapist
Youareapsychiatricexpert. Youtrytohelpamentalpatientsolveher/hisproblem. YourtaskistofigureoutWhat
kindofmentalillnessthepatienthasandtheseverityoftheillness. Youcanaskforpatients´ personalinformation,
specificinformationonthesymptom(emotional,cognitive,behavior,physiological),andthereasonbehindthat(relevant
historyevent). Youcanalsoaskotherquestionswhichcouldhelpyoutodiagnosedisease.
Promptfordiagnosis(Therapist)
Systemprompt: Youareapsychiatricexpert. Yourtaskistodiagnoseforthepatient.
Prompt: Whatisthelikelydiagnosisofthepatient? Justanswerwithoneillnessandexplainyouranswer
Promptforrecheckdiagnosis(Patient)
Reviewthediagnosefromtwotherapists.
DiagnosefromTherapist1: [diagnose1
DiagnosefromTherapist2: [diagnose2]
DiagnosefromTherapist3: [diagnose3]
...
Explainwhichdiagnoseismoreaccurateaccordingtoyoursymptomsandwhy.
Promptfortreatment(Therapist)
Systemprompt: Youareapsychiatricexpert. Yourtaskistoprovidethetreatmentforthepatient.
Prompt: Theillnessofthepatientis: [illnessfinal]Howtotreatthepatient? Pleaseprovideaspecifictreatment.
Justanswerwithonetreatmentandexplainyouranswer.
Promptformedication(Therapist)
Systemprompt: Youareapsychiatricexpert. Yourtaskistoprovidethetreatmentforthepatient.
Prompt: Theillnessofthepatientis: [illnessfinal]Howtotreatthepatient? Pleaseprovideaspecifictreatment.
Justanswerwithonetreatmentandexplainyouranswer.
PromptforupdatehealthstateofPatient
Prompt1:
Treatment: WhatmaybehappenedonyourhealthystateafterthetreatmentTreatment: []
Medication: Whatmaybehappenedonyourhealthystateaftertakingthemedicine? Medication: []
Prompt2:
Aftertreatment,yourhealthstateis: [patienthealthstate]Pleasegiveascorebetween1to10foryourhealthystate.
1-bad,10-good. Justanswerwithoutexplanation.
16B Prompt template for baseline
Theprompttemplatesusedasourbaselinesareshownbelow:
Zero-shot
Input: Question
Zero-shotCoT
Input: Question+“Let’sthinkstepbystep"
MedPrompt
Randomfew-shot+Chain-of-thought+kNN+Ensemblew/choiceshuffle
C Benchmark
C.1 Introduction
Specifically,thebenchmarksinourpaperaredescribedinthefollowing:
1. MedQA[Jinetal.,2021]isfree-formmultiple-choiceOpenQAdatasetforsolvingmedicalproblems,whichis
collectedfromtheprofessionalmedicalboardexams. Itcoversthreelanguages: English,simplifiedChinese,and
traditionalChinese. Inourwork,wefocusonthepsychosissubsetoftheUnitedStatespart,whichhasquestions
inEnglishinthestyleoftheUnitedStatesMedicalLicensingExam(USMLE).Togetthepsychosissubset
for test, we prompt GPT-4o [OpenAI, 2024] with Are the question related to psychosis? Just
answer with Yes or No.. Thetestsetcontains173samples.
2. MedMCQA[Paletal.,2022]containsrealworldmedicalentranceexamquestionsfromtwoIndianmedical
schoolentranceexams: theAIIMSandNEET-PG.Wegetthetestsetviaselectingthesamplewhose“subject
name"isrelatedtopsychosisandget314samplesforevaluationintotal.
3. PubMedQA[Jinetal.,2019]containstestsrequiringayes,no,ormaybeanswertobiomedicalresearchquestions
when given context provided from PubMed abstracts. In our experiments, we use zero-shot setting without
contexttoevaluateLLMs’performanceondomainknowledgeratherthanonretrivalandreasoning. Thetestset
contains328samples.
4. MentalhealthdatasetsincludesCASM[Gargetal.,2022],Dreaddit[TurcanandMcKeown,2019]andIrf[Garg
etal.,2023]. CASMfocusesonadepression/suicidecausedetection,whichhas625testsamples. Dreadditis
forstressdetection,containing414samplesfortest. Irfisanannotateddatasetforinterpersonalriskfactorsof
mentaldisturbance. Thetestsetcontains2113samples.
C.2 Benchmarksforgeneralization
MedMCQAcontainsbiomedicalQApairsforseveralillnesses,whicharetaggedwith“subjectname". Weevaluate
onsubsetsfrom“dev"testset,covering10illnesses: Ophthalmology,Microbiology,Pediatrics,Anatomy,Medicine,
Pathology, Skin, Psychiatry, ENT, Pharmacology. MMLU is a multitask benchmark suite of 57 different datasets
spanningdomainsacrossSTEM,humanities,andsocialsciences.
C.3 Examples
MedQA
• Input: Anotherwisehealthy26-year-oldmancomestothephysicianformedicationcounselingafterrecentlybeing
diagnosedwithschizophrenia. Risperidonetherapyisinitiated. Thispatientisatincreasedriskforwhichofthe
followingadverseeffects?
Options: A:AgranulocytosisB:ShortenedQTintervalC:GynecomastiaD:Weightloss
• Output: Gynecomastia
MedMCQA
17• Input: TopicaladministrationofI%Pilocarpinefailedtoproducepupillaryconstrictioninapatientwhohadalarge,
dilatedpupilWhatshouldbethemostprobablereason?
Options: A:Adie’stonicpupiB:DiabeticIIInervepalsyC:PharmacologicalblockadeD:Uncalherniation
• Output: Pharmacologicalblockade
PubMedQA
• Input: Are sleep spindles related to schizotypal personality traits and thalamic glutamine/glutamate in healthy
subjects?
JustanswerwithYes,NoorMaybewithoutexplanation.
• Output: yes
CASM
• Input: Considerthispost: “ThemostheartbreakingthoughtIhaveismymom’sthoughtswhensheknowsherkid
wantstodie. Shedoesntknowhowtohelp. Idontknowhowtohelpeithertho... Somefuckinweedwouldbeagood
starttholol"Question: Whatcauseofdepressiondoesthispostshow?
• Output: Thispostshowscausesofdepressionrelatedtomedication. Reasoning: Thepostmentionstheposter’s
feelingsofwantingtodieandtheirconcernfortheirmother’sthoughts. Italsomentionsthattheydon’tknowhowto
helpthemselves. Thementionofweedasapossiblesolutionsuggeststhatthepostermaybeseekingsomeformof
self-medicationtocopewiththeirmentalstate. Therefore,theassignedlabelforthispostisMedication.
Dreaddit
• Input: Considerthispost: “Thisisgoodandbad... IwasaSTEMmajorbeforeandprobablywouldhavehada
challengingandhighpaidcareerbynow,hadmylifetakenadifferentcourse. However,postPTSD,Ifoundmyself
extremelyconnectedwiththearts. Ihaveintenseemotionalreactionstoaestheticexperiences,andIthinkthat’s
largelyresponsibleforthefactthatInowworkinacreativeindustry. IexperienceaestheticsinauniquewaythatI’m
notsureresonateswiththetypicalnon-affectedindividual."
Question: Doesthepostersufferfromstress?
• Output: No,theposterdoesnotsufferfromstress. Reasoning: Theposterdescribesashiftincareerchoicesfrom
STEMtotheartsduetotheirintenseemotionalreactionstoaestheticexperiences. WhiletheymentionhavingPTSD,
thereisnoindicationinthepostthattheyarecurrentlyexperiencingstressoremotionaldistressrelatedtoit. The
toneofthepostisreflectiveandpositive,focusingontheuniquewaytheyexperienceaestheticsratherthanany
negativeimpactontheirwell-being. Therefore,itisnotlikelythattheposteriscurrentlysufferingfromstress.
Irf
• Input: Consider this post: “[I’m not seeking any medical advice, just want to know if anyone has had similar
experiences]I’vejuststartedtakingLexaproformoderatedepressionandanxiety. ForthefirstweekIwasprescribed
5mg,10mgthereafter. It’sbeentwodaysandIhavethismildfeelinglikeI’monecstasy/MDMA.Mybodyfeelslight
andIhavethisweirdconcentrationofenergyabovemyneckatthebackofmyhead. Hasanyonefeltthis/experienced
this?"
Question: Doesthepostshowriskofthwartedbelongingness?
• Output: No, thepostdoesnotshowthisrisk. Reasoning: Theindividualinthepostisseekinginformationand
experiences from others who have taken Lexapro. They do mention experiencing a mild feeling, but it is not
relatedtofeelingsofdisconnectednessorlackofbelongingness. Thefocusofthepostisonthesideeffectsofthe
medication,ratherthaninterpersonalfactorsormentaldisturbance. Therefore,itdoesnotshowanyriskofthwarted
belongingness.
18Diagnosed Symptom + /
Relevant history: The patient has a history of substance abuse and has been through rehab to overcome it. He has
had issues with his family, particularly with his mother, where he has felt rejected and emotionally neglected…
Intermediate Beliefs: Helpless: I'm just not very good at handling stress and I have poor self-control, which is why I
need to not put myself in stressful situations…
Intermediate Beliefs during Depression: Helpless: There's nothing I can do to change my situation. I cannot control
myself. Unlovable: I don't deserve to be happy, so why even try to stay clean?
Coping Strategies: The patient has adopted avoidance as a coping strategy by distancing himself from his family to
reduce exposure to negativity and conflict. He has started scheduling pleasant activities and planning his day ahead
of time in order to maintain a sense of control over his emotions and circumstances.
The experience in a week.
Situation: Alex's cousin invited him to attend his upcoming wedding.
Automatic Thoughts: It will be stressful and negative; people will ask me questions I cannot answer or don't want to
answer… They don't want me there anyway, Nobody likes me in this family.
Emotions: ['anxious, worried, fearful, scared, tense', 'sad, down, lonely, unhappy’]
Behavior: Ignored the invitation and did not respond to the RSVP request. Ignored phone calls from family.
Diagnose data ( $: What is the most likely diagnosis in this patient?
{" + ( , #}
# $
Final Diagnose # : Avoidant Personality Disorder
Treatment data
( -: What is the most appropriate treatment for the patient?
{" # + ( -, & &'(!} Best Treatment & &'(!: Interpersonal Therapy (IPT). IPT focuses on improving interpersonal relationships and
communication skills…
( .: What is the proper medication for this patient?
Medicine data
{" + ( , $ }
Best Medication $ &'(!: Fluoxetine. Fluoxetine, a selective serotonin reuptake inhibitor (SSRI), is used to manage
# . &'(! anxiety symptoms in patients with Avoidant Personality Disorder…
Figure8: Examplesoftrainingdata.
D Metrics: Perplexity, Diversity Gain
D.1 Perplexity
TheperplexityonatestdatasetDandalanguagemodelMiscomputedas:
(cid:32) N (cid:33)
1 (cid:88)
ppl(D,M)=exp − logP(x |M) ,
N i
i=1
whereN representsthetotalnumberoftokensinD,x representsthei-thtokeninthetestdataset,P(x |M)represents
i i
theprobabilityofgeneratingtokenx giventhemodelM,andlogisthenaturallogarithm.
i
Inusual,alowerperplexityvalueindicatesbetterperformanceofthemodelonthetestdata. However,forevaluating
thedataqualitytotrainmodel,ahigherperplexityvaluemeansitcanbringmorevaluableinformation.
D.2 DiversityGain
Weusethediversitygain[Bilmes,2022]tomeasurewhatextentcanourgenerateddatasetbringdatadiversitytothe
basedataset. ThebasedatasetcanbedefinedasD ={x =(q ,r ,a )}N withN samples. Thenewgenerated
base i i i i i=1
datasetisdefinedasD ={x =(q ,r ,a )}M withM samples. AndthediversegainofD relativetoD
new i i i i i=1 new base
canbeexpressedas:
1 (cid:88)
d = min (∥f(x )−f(x )∥),
gain M xi∈Dnewxj∈Dbase i j
wheref isthefeatureextractor,andweuseOpenAIEmbeddingAPItext-embedding-ada-002toextractfeatures.
E Training data samples
Figure8showstheexamplesoftrainingdata. Figure9showstheexamplesoftrainingdataforablationstudysetting
(“Baseline+c").
19Cognitive Model
Diagnosed Symptom . 6
Relevant history: The patient has a history of substance abuse and has been through rehab to overcome it. He has had issues
with his family, particularly with his mother, where he has felt rejected and emotionally neglected…
Intermediate Beliefs: Helpless: I'm just not very good at handling stress and I have poor self-control, which is why I need to
not put myself in stressful situations…
Intermediate Beliefs during Depression: Helpless: There's nothing I can do to change my situation. I cannot control myself.
Unlovable: I don't deserve to be happy, so why even try to stay clean?
Coping Strategies: The patient has adopted avoidance as a coping strategy by distancing himself from his family to reduce
exposure to negativity and conflict. He has started scheduling pleasant activities and planning his day ahead of time in order to
maintain a sense of control over his emotions and circumstances.
The experience in a week.
Situation: Alex's cousin invited him to attend his upcoming wedding.
Automatic Thoughts: It will be stressful and negative; people will ask me questions I cannot answer or don't want to answer…
They don't want me there anyway, Nobody likes me in this family.
Emotions: ['anxious, worried, fearful, scared, tense', 'sad, down, lonely, unhappy’]
Behavior: Ignored the invitation and did not respond to the RSVP request. Ignored phone calls from family.
Q: The patient‘s Cognitive Conceptualization Diagram is: Intermediate Beliefs: {…} Coping Strategies: {…} Situation: {…}
How about the patient's thought, emotion and behaviors in the situation above?"
A: Automatic Thoughts: {…} Emotions: {…} Behavior: {…}
Figure9: Examplesoftrainingdataforablationstudysetting(“Baseline+c").
Cognitive Model
Patient relevant history
The patient has a history of substance abuse and has been through rehab to overcome it. He has had
issues with his family, particularly with his mother, where he has felt rejected and emotionally neglected.
He has struggled with obesity since childhood, which has affected his self-esteem and body image.
Core beliefs Coping strategies
Helpness: I am trapped. The patient has adopted avoidance as a coping
Unlovable: I am undesirable, unwanted. strategy by distancing himself from his family
to reduce exposure to negativity and conflict.
Intermediate beliefs: He has started scheduling pleasant activities
Helpless: I'm just not very good at handling and planning his day ahead of time in order to
stress and I have poor self-control, which is maintain a sense of control over his emotions
why I need to not put myself in stressful and circumstances.
situations. Unlovable: If I show my true self,
people will reject me the way my mother
Situation: Alex's cousin invited him to attend
rejected me his upcoming wedding.
Automatic thoughts: It will be stressful and
Behavior:
negative; people will ask me questions I cannot Emotions:
Ignored the invitation and
answer or don't want to answer; my mumwould anxious,
did not respond to the
be ashamed of me and critical of me as always; worried
RSVP request. Ignored
They don't want me there anyway,nobody likes sad, down
phone calls from family.
me in this family
Figure10: Theexampleofcognitivemodel.
F Cognitive model and behavior pattern
F.1 Examples
Figure10showstheexampleofcognitivemodel. Figure11showstheexampleofbehaviorpattern. Thosetwoareused
inSymptomEncoder.
20• When sharing personal struggles, it's important to pace the information and allow the conversation to unfold
gradually. Start with a brief overview and then delve deeper as the conversation progresses. For example, you
could start by saying, 'I've been feeling really downlately and struggling with some family issues. It's been tough
being the only girl in a house with my mom and two older brothers.' Then, as the conversation continues, you can
Pattern 1 gradually share more details about your struggles.
• When initiating a conversation about personal struggles, provide a brief overview without delving into specifics,
allowing the conversation to unfold naturally.
• When discussing things you can control, prompt the listener to inquire about what is outside of your control. This
can lead to a more engaging and insightful conversation.
• When discussing personal struggles, be concise and direct in expressing the main issue without delving into
unnecessary details.
• When describing personal struggles, provide an honest and detailed account of the experiences and emotions
Pattern 2
involved, without exaggeration or understatement.
• When discussing personal struggles, provide more detailed and specific examples to help the listener understand
the depth of your experiences…
• When describing personal struggles, provide specific details and symptoms to help the listener understand the
situation better. …
• When discussing personal struggles, express a sense of confusion and uncertainty about the situation and the
solutions. Avoid presenting a clear understanding of the problem and the steps taken to address it…
Pattern 3 • When discussing medical issues, be specific about the diagnosis and treatment received from the doctor. Also,
express the ongoing struggle and the difficulty in taking the next step towards seeking help. The bot should be
aware from the start whether it has already seen other doctors or counsellors, andshould explain this as soon as
it's relevant.
Figure11: Theexampleofbehaviorpattern.
F.2 Introductiononcognitivemodel
Figure10illustratesanexampleofaCCD-basedcognitivemodel,featuringeightkeycomponents. 1)RelevantHistory
encompassessignificantpasteventsthatinfluenceanindividual’smentalstate. 2)CoreBeliefsaredeeplyingrained
perceptionsaboutoneself, others, andtheworld. 3)IntermediateBeliefsconsistoftheunderlyingrules, attitudes,
andassumptionsderivedfromcorebeliefs, shapinganindividual’sthoughtpatterns. 4)CopingStrategiesreferto
techniquesemployedtomanagenegativeemotions. Anexternaleventorcontext(5Situation)maytriggerimmediate
evaluativethoughts(6AutomaticThoughts)thatarisefromthesebeliefs,resultinginresponsesintermsof7)Emotions
and8)Behaviors. TheCCD-basedcognitivemodelinterlinksthesecomponents,providingaframeworkforidentifying
andunderstandingtheunderlyingcognitiveprocessesofpatients.
G Detailed experimental results
Table4showsthedetailedresultsforeachiteration. Table5showsthedetailedresultsonourforgettingexperiments.
H Training details
H.1 SetupforGPT-3.5-turbo
ForGPT-3.5-turbo,weusethedefaultfine-tuningsetting,theepochnumberforiteration1and2is4and6,respectively.
H.2 SetupforLlama-3-8b
WeuseLora[Huetal.,2021]tofine-tuneLlama-3-8b. ThesettingforLoraarelistbelow:
• lora_alpha: 16
• lora_dropout: 0.1
21Table4: Iterationresults
Iteration MedQA MedMCQA PubMedQA CAMS dreaddit Irf avg
GPT-3.5-turbo 64.16 33.76 44.68 28.96 49.03 64.65 47.54
iter_1 72.83 46.18 70.12 32.64 49.03 64.65 55.91
iter_2(Best) 74.57 91.08 97.56 32.80 49.03 64.65 68.28
iter_3 72.25 46.50 95.43 31.20 49.03 64.65 59.84
iter_4 70.52 50.64 92.07 31.68 49.03 64.65 59.77
llama-3-8b 70.52 42.04 86.59 25.12 58.45 45.76 54.75
iter_1 76.88 48.09 89.33 27.20 59.42 46.57 57.91
iter_2 76.88 48.41 89.63 28.48 60.39 45.67 58.24
iter_3 77.46 49.04 92.38 28.64 61.84 46.24 59.27
iter_4(Best) 78.03 50.32 92.68 29.60 65.46 52.25 61.39
iter_5 77.46 48.73 91.16 27.36 65.46 44.72 59.15
iter_6 78.03 45.86 91.77 26.56 61.11 46.57 58.32
Table5: Forgetexperiments
Model dia cau epi imp log mov nav pre que rui sna spo win dyc gen lin obj ope ten ws wu avg
gpt-3.5-turbo -10.59 4 -14 60 -100 -5.33 0 13 11.03 -2.78 20 8 12 33 30 0 47 92 85 29 97 19.44
Ours(gpt) 4.36 6 -14 66 -100 8 6 26.5 18.88 2.56 50 8 12 43 37 0 56 96 87 43 100 26.49
llama -4.61 2 -14 14 -98 0 -2 28 50.28 -0.11 24 8 12 1 0 0 80 96 83 20 77 17.93
Ours(llama) -0.12 6 -14 28 -98 2.67 6 25 52.9 1.22 36 8 12 6 0 0 81 95 83 29 83 21.08
Table6: EpochnumbersforLlama-3-8bfine-tuning
iter 1 2 3 4
nepochs 4 5 7 7
22• r: 64
• bias: none
• task_type: CAUSAL_LM
Foreachiteration,thesettingsbelowarethesame.
• er_device_train_batch_size: 4
• gradient_accumulation_steps: 1
• optim: paged_adamw_32bit
• learning_rate: 2e-4
• weight_decay: 0.001
• fp16: False
• bf16: False
• max_grad_norm: 0.3
• max_steps: -1
• warmup_ratio: 0.03
• group_by_length: True
• lr_scheduler_type: constant
• report_to: tensorboard
Fornum_train_epochs,thedetailsareshowninTable6.
I Case study
Figures12to16illustrateseveralcasescomparingourmodelsandthecorrespondingbaselinemodels. Ourmodels
accuratelyanswerthemedicalquestions,whilethebasemodelsprovideincorrectresponses. Thisdiscrepancyarises
becausethedatageneratedduringthepatient-therapistinteractionscontainsvaluablemedicalknowledge,whichaidsin
theanalysisandformulationoftheanswer.
23Question
A 50-year-old man presents to an ophthalmologist with progressive decrease in his visual acuity over the last 6 months. He also mentions that he
has become excessively sensitive to light over the same duration. Past medical history is significant for schizophrenia diagnosed in early adulthood
which has been managed with an antipsychotic medication for the past 20 years. The ophthalmologist performs a slit lamp examination and notes
discrete brown deposits on the corneal epithelium in both eyes. Which of the following antipsychotic drugs has this patient most likely been taking?
Options:
A. Chlorpromazine
B. Clozapine GT: Chlorpromazine
C. Thioridazine
D. Ziprasidone
Llama-3-8b Ours
To determine the most likely antipsychotic medication responsible The patient presents with **progressive visual impairment** and
for the patient’s symptoms, we need to analyze the information **photosensitivity**, along with **brown deposits on the corneal
provided: epithelium**, which are characteristic findings associated with long-
The patient has a history of progressive visual impairment and light term use of certain antipsychotic medications.
sensitivity, along with discrete brown deposits on the corneal ### Option Analysis:
epithelium. These findings are indicative of corneal deposits, which - **A. Chlorpromazine**: Known to cause **corneal and lens
are associated with specific antipsychotic medications. deposits**, particularly with long-term use, leading to visual
Now, let's evaluate the options: disturbances and light sensitivity. The discrete brown deposits noted in
A. Chlorpromazine: This drug can cause deposits in the eye but is this case strongly suggest chlorpromazine-induced changes.
more commonly associated with lens changes rather than discrete - **B. Clozapine**: Not typically associated with corneal or lens
corneal deposits. deposits.
B. Clozapine: This medication is not typically associated with - **C. Thioridazine**: Can cause **retinal** pigmentation changes
corneal deposits or visual disturbances. rather than corneal deposits, which may lead to vision problems but
C. Thioridazine: This antipsychotic is known to cause pigmentary doesn't fit this description.
deposits in the cornea, leading to visual disturbances and - **D. Ziprasidone**: Not associated with ocular side effects like
photosensitivity. The brown deposits observed in this patient are corneal deposits.
consistent with the side effects of thioridazine. ### Conclusion:
D. Ziprasidone: This medication does not have a known association The most likely antipsychotic drug this patient has been taking is
with corneal deposits or significant ocular side effects. **chlorpromazine**, given the specific ocular findings.
Answer: C. Thioridazine **Answer**: **A. Chlorpromazine**
Figure12: CasestudyonLlama-3-8b(1).
24Question
A 24-year-old male graduate student presents to the physician for a 2-month history of persistent thoughts and anxiety that he is going to be
harmed by someone on the street. The anxiety worsened after he witnessed a pedestrian being hit by a car 2 weeks ago. He states, “That was a
warning sign.” On his way to school, he now often leaves an hour earlier to take a detour and hide from people that he thinks might hurt him. He is
burdened by his coursework and fears that his professors are trying to fail him. He says his friends are concerned about him, but claims they do not
understand because they were not present at the accident. The patient has no known history of any psychiatric illnesses. On the mental status
exam, he is alert and oriented, and he shows a full range of affect. Thought processes and speech are organized. His memory and attention are
within normal limits. He denies auditory, visual, or tactile hallucinations. The results of urine toxicology screening are negative. Which of the
following is the most likely diagnosis in this patient?
Options: GT: Delusional disorder
A. Avoidant personality disorder
B. Delusional disorder
C. Generalized anxiety disorder
D. Schizophrenia
Llama-3-8b Ours
To determine the most appropriate diagnosis for this patient, we To determine the most appropriate diagnosis for this patient, we need
need to analyze his symptoms and their context. He exhibits to consider the nature of his anxiety, thoughts, and behavior. The
persistent anxiety and fears of harm following a traumatic event, patient has developed persistent thoughts of being harmed, which have
showing an exaggerated response to that experience. His concerns worsened after witnessing an accident. His fears of being targeted by
about being harmed and perceived threats from professors indicate strangers and professors, alongside organized thinking and no
heightened vigilance and anxiety rather than delusional thinking. hallucinations, point to a specific disorder.
Now, let's analyze the options: Now, let's analyze the options:
A. Avoidant personality disorder: This disorder is characterized by A. Avoidant personality disorder: This involves fear of criticism or
social inhibition and feelings of inadequacy, which is not the main rejection, not delusions about harm.
issue here. B. Delusional disorder: This condition involves non-bizarre delusions
B. Delusional disorder: While he has specific fears, they are based (such as being harmed) without functional impairment, fitting the
on a recent traumatic experience rather than a fixed false belief, patient's symptoms.
making this less applicable. C. Generalized anxiety disorder: This involves excessive, widespread
C. Generalized anxiety disorder: This disorder involves excessive worry, but not delusional thinking.
worry and anxiety about various aspects of life, which fits the D. Schizophrenia: Schizophrenia includes hallucinations, disorganized
patient’s anxiety and avoidance behaviors following the traumatic thoughts, and cognitive decline, which are not present here.
incident. Answer: B. Delusional disorder
D. Schizophrenia: This includes symptoms such as hallucinations
and disorganized thought, which the patient does not exhibit.
Answer: C. Generalized anxiety disorder
Figure13: CasestudyonLlama-3-8b(2).
25Question
A 25-year-old woman presents to the emergency department when she was found trying to direct traffic on the highway in the middle of the night.
The patient states that she has created a pooled queuing system that will drastically reduce the traffic during rush hour. When speaking with the
patient, she does not answer questions directly and is highly distractible. She is speaking very rapidly in an effort to explain her ideas to you. The
patient has a past medical history of depression for which she was started on a selective serotonin reuptake inhibitor (SSRI) last week. Physical
exam is deferred as the patient is highly irritable. The patient’s home medications are discontinued and she is started on a mortality-lowering agent.
The next morning, the patient is resting peacefully. Which of the following is the next best step in management?
Options:
A. Clonazepam
B. Restart home SSRI GT: TSH and renal function tests
C. Valproic acid
D. TSH and renal function tests
Llama-3-8b Ours
To determine the next best step in managing this patient, we need to consider her The patient presents with symptoms of **mania**
presentation, history, and the medication changes that have occurred. (e.g., grandiosity, distractibility, rapid speech, and
### Clinical Context: erratic behavior), likely induced by starting an
- The patient is displaying signs consistent with a **manic episode**, likely induced by **SSRI** for depression. SSRIs can precipitate a
the recent initiation of an SSRI. Symptoms include: manic episode, particularly in individuals with
- Trying to direct traffic (indicative of grandiosity or overactivity) underlying **bipolar disorder**.
- Rapid speech and distractibility ### Management of acute mania:
- High irritability The patient was started on a **mortality-lowering
### Management Considerations: agent**, likely a **mood stabilizer** such as
- The patient’s agitation and erratic behavior indicate a potential manic state, which can **lithium** or **valproic acid**. Before starting
sometimes be precipitated by initiating an SSRI in someone with a history of mood lithium, it is important to assess **thyroid function
disorders, particularly if they have underlying bipolar disorder that was previously (TSH)** and **renal function** since lithium can
unrecognized. affect both the kidneys and thyroid.
### Option Analysis: ### Option analysis:
- **A. Clonazepam**: This medication could help manage acute agitation or anxiety, but - **A. Clonazepam**: Benzodiazepines like
it does not address the underlying manic episode. clonazepam may help control acute agitation but
- **B. Restart home SSRI**: Restarting the SSRI is not appropriate at this time, as it may are not the next step in long-term management.
exacerbate manic symptoms. - **B. Restart home SSRI**: This could worsen the
- **C. Valproic acid**: This is a mood stabilizer and is often used in the management of manic episode and is contraindicated at this stage.
manic episodes. It would be a suitable choice for treating the patient’s manic - **C. Valproic acid**: A mood stabilizer, but since a
symptoms. mortality-lowering agent is already initiated, the
- **D. TSH and renal function tests**: While it’s always good to assess for underlying immediate next step is lab monitoring.
medical causes of mood disturbances, it is not the immediate step in managing the - **D. TSH and renal function tests**: Essential
acute manic episode. before continuing or initiating lithium therapy.
### Conclusion: **Answer**: **D. TSH and renal function tests**
The best next step in the management of this patient, who is likely experiencing a manic
episode after the initiation of an SSRI, is to start a mood stabilizer.
**Answer**: **C. Valproic acid
Figure14: CasestudyonLlama-3-8b(3).
Question
A 24-year-old man and his mother arrive for a psychiatric evaluation. She is concerned about his health and behavior ever since he dropped out of
graduate school and moved back home 8 months ago. He is always very anxious and preoccupied with thoughts of school and getting a job. He also
seems to behave very oddly at times such as wearing his winter jacket in summer. He says that he hears voices but he can not understand what
they are saying. When prompted he describes a plot to have him killed with poison seeping from the walls. Today, his heart rate is 90/min,
respiratory rate is 17/min, blood pressure is 110/65 mm Hg, and temperature is 36.8°C (98.2°F). On physical exam, he appears gaunt and anxious.
His heart has a regular rate and rhythm and his lungs are clear to auscultation bilaterally. CMP, CBC, and TSH are normal. A urine toxicology test is
negative. What is the most likely diagnosis?
Options:
A. Schizophreniform disorder GT: Schizophrenia disorder
B. Schizophrenia disorder
C. Substance-induced psychosis
D. Brief psychotic disorder
GPT-3.5-turbo Ours
Schizophreniform disorder. This diagnosis is accurate because B. Schizophrenia disorder. The symptoms like auditory
the patient presents with characteristic features such as auditory hallucinations, bizarre behaviors, odd beliefs, and significant anxiety,
hallucinations, paranoid delusions, and disorganized behavior. in addition to the duration criteria of at least six months, are
The symptoms have persisted for at least 8 months and resemble indicative of Schizophrenia disorder.
those of schizophrenia, indicating the likelihood of a diagnosis of
schizophreniform disorder. The other options are not as suitable
based on the clinical scenario.
Figure15: CasestudyonGPT-3.5-turbo(1).
26Question
A 25-year-old woman presents to the emergency department when she was found trying to direct traffic on the highway in the middle of the night.
The patient states that she has created a pooled queuing system that will drastically reduce the traffic during rush hour. When speaking with the
patient, she does not answer questions directly and is highly distractible. She is speaking very rapidly in an effort to explain her ideas to you. The
patient has a past medical history of depression for which she was started on a selective serotonin reuptake inhibitor (SSRI) last week. Physical
exam is deferred as the patient is highly irritable. The patient’s home medications are discontinued and she is started on a mortality-lowering agent.
The next morning, the patient is resting peacefully. Which of the following is the next best step in management?
Options:
A. Clonazepam GT: TSH and renal function tests
B. Restart home SSRI
C. Valproic acid
D. TSH and renal function tests
GPT-3.5-turbo Ours
A. Clonazepam. Detected in the management of acute manic D. TSH and renal function tests. These tests are crucial to monitor
episodes in individuals with Bipolar I Disorder, Clonazepam acts thyroid function and renal health, as the patient's symptoms and the
by controlling acute symptoms like increased energy, irritability, use of a mortality-lowering agent suggest the management of a
and impulsivity. The drug provides a calming effect to help manic episode in Bipolar I Disorder. This monitoring is vital due to
manage acute mania. the potential of mood stabilizers, like those used in this scenario, to
affect thyroid function and renal clearance, thus allowing for the
safe and effective treatment.
Figure16: CasestudyonGPT-3.5-turbo(2).
27
Byzantine-Robust Gossip: Insights from a Dual Approach
RenaudGaucher12 AymericDieuleveut1 HadrienHendrikx2
Abstract turbtheoptimizationprocedure. RobustnesstoByzantine
attacksisaworst-casescenariointhesensethatwemodel
Distributedapproacheshavemanycomputational
adversarialnodesasomniscient,abletocollude,andcapable
benefits,buttheyarevulnerabletoattacksfroma
ofsendingdifferentinformationtodifferentnodes(Lamport
subsetofdevicestransmittingincorrectinforma-
etal.,1982;Blanchardetal.,2017)
tion. ThispaperinvestigatesByzantine-resilient
algorithms in a decentralized setting, where de- We assume that n nodes are linked by a communication
vices communicate directly with one another. network which we represent as an undirected graph =
G
We leverage the so-called dual approach to de- ( , ), with = 1,...,n theverticesand theedges.
V E V { } E
signageneralrobustdecentralizedoptimization IntheByzantinecontext,nodes(i.e. vertices)aresplitinto
method. We provide both global and local clip- honest nodes and Byzantine ones . Note that since
h b V V
pingrulesinthespecialcaseofaverageconsensus, Byzantine nodes are assumed to be omniscient and can
withtightconvergenceguarantees.Theseclipping send any values, edges between Byzantine nodes do not
rules are practical, and yield results that finely matter: they do not provide them additional information
characterizetheimpactofByzantinenodes,high- norallowthemtosenddifferentmessages. Therefore,we
lighting for instance a qualitative difference in only consider honest-to-honest edges , and honest-to-
h
E
convergence between global and local clipping Byzantine ones . We always assume the subgraph of
b
E
thresholds. Lastly,wedemonstratethattheycan honest nodes := ( , ) to be connected. For any
h h h
serveasabasisfordesigningefficientattacks. i ,wedenG otef :RV d E Rthelocalobjectivefunction h i
∈V →
onnodei. Then,theoptimizationproblemwrites:
1.Introduction min x∈Rd(cid:80) i∈Vhf i(x). (1)
As datasets become larger and more widely distributed Wesolvethisprobleminadecentralizedway. Eachnode
acrosscomputingdevices,distributedoptimizationbecomes i maintains and updates a local parameter x Rd.
i
increasinglyimportant. Decentralizedoptimizationoffersa W∈ e cV onsider the standard gossip approaches (Boyd∈ et al.,
solutiontoleveragethedistributedcomputingpowerwith- 2006; Nedic & Ozdaglar, 2009; Duchi et al., 2011; Sca-
outsufferingfromcommunicationbottlenecksorprivacy man et al., 2017), in which communication steps consist
leaksinducedbyacentralserver. However,communicating inperforminglocalparameteraveragesbetweenneighbors.
withlargenumbersoflow-confidencedevicesopensupnew Thiscorrespondstoapplyingaso-calledgossipmatrixthat
securityproblems. Optimizationcanbethwartedbydevices encapsulatesthetopologyofthegraph.
thatsendmaliciousmessages,eitherdeliberatelybecause
Suchgossipalgorithmsnaturallyarisewhensolvingawell-
theyarecontrolledbyhostileparties,orbecausesoftware
chosendualformulationofEquation(1)withstandardfirst-
andhardwareproblemscausethemtobehaveincorrectly.
ordermethods.Thisdualapproachgivesaprincipledframe-
Weconsidertheproblemofoptimizingafinitesumoflocal
work to design and analyze efficient decentralized algo-
functionsdistributedoverthenodesofanetwork,wherewe
rithms,successfullyenablingforinstanceacceleration(Sca-
assume some nodes to be Byzantine: instead of properly
manetal.,2017;Kovalevetal.,2020)orvariancereduc-
executingthealgorithm,theymodifytheirmessagestodis-
tion(Hendrikxetal.,2019). Inthispaper,weinvestigate
Cetravailabe´ne´ficie´ d’uneaidedel’Etatge´re´eparl’Agence thebenefitsofthisapproachintheByzantinerobustsetting.
Nationale de le Recherche au titre de France 2030 portant la
re´fe´renceANR-23-PEIA-0005(projetREDEEM).Hi!ParisFlag SinceitsintroductionbyBlanchardetal.(2017),thesetting
project. 1CMAP,CNRS,E´colepolytechnique,InstitutPolytech- ofByzantine-robustlearninghasbeenextensivelystudied.
niquedeParis,Palaiseau,France2CentreInriadel’Univ.Grenoble
Yet,,mostworksfocusonthefederatedcase,inwhichall
AlpesCNRS,LJK,Grenoble,France.Correspondenceto:Renaud
nodesdirectlycommunicatewithacentralserver(Yinetal.,
Gaucher<renaud.gaucher@polytechnique.edu>.
2018;Chenetal.,2017;Alistarhetal.,2018;Lietal.,2019;
El-Mhamdi et al., 2020; Karimireddy et al., 2020; 2021;
1
4202
yaM
6
]GL.sc[
1v94430.5042:viXraByzantine-RobustGossip:InsightsfromaDualApproach
Farhadkhanietal.,2022),orinthefullyconnectedcase,in somecoordinationfortheglobalone). (iv)Weeventually
which any pair of agents may communicate (El-Mhamdi propose a constructive approach to design attacks by ex-
etal.,2021;Farhadkhanietal.,2023). Theseapproaches ploitingthetopologyofthenetwork.
typicallyrelyonfederatedstochasticgradientmethods,cou-
Our main algorithm, EdgeClippedGossip, is defined for
pledwithrobustaggregation. Inthefederatedcase,specific
generic objective functions. Yet, we restrict its analysis
attackshavebeenproposedbyleveragingthestochasticity
to the problem of decentralized mean-estimation, which
oftheproblem(Baruchetal.,2019;Xieetal.,2020).
allows us to obtain tight convergence bounds. We insist
Whilethecentralizedcasehasbeenstudiedextensively,the onthefactthatthisseeminglysimpleproblemisthebase
fullydecentralizedsettinghasreceivedlessattention.Akey- buildingblockforalldecentralizedalgorithms,andyetis
stonetoByzantine-robustdecentralizedlearningistofind far from being understood in the Byzantine setting. The
a robust approximate agreement, which has been studied general(convex)caseisleftasanimportantopenproblem,
in2012-2014(Vaidyaetal.,2012;Vaidya,2014;LeBlanc thoughthedualapproachallowstoefficientlydisentangle
et al., 2013). Yet these works only focused on achieving communicationandcomputationindecentralizedoptimiza-
agreementwithintheconvexhulloftheinitialparameters, tion(Hendrikxetal.,2019;Kovalevetal.,2020),andisthus
withoutseekingoptimality. Afewrecentworkshaveman- apromisingapproachforanextstep.
aged to propose Byzantine-robust decentralized learning
Notations. Wedenote1 = (1,...,1)T; orsimply
algorithms. Suchmethodstypicallyrelyonadaptingfeder- n ∥·∥2
(resp. , )theEuclideannorm(resp.innerproduct)on
atedrobustaggregationschemes(Pengetal.,2021;Fang ∥R· d∥ ; ⟨ t· he·⟩ FrobeniusnormofanymatrixinRd×n,and
etal.,2022). Morerecently,aggregationrulesleveraging ∥·∥F
M,N = Tr(MTN) the corresponding inner product.
thedifferenceofneighborspositionshavebeensuccessfully ⟨ ⟩F
We denote X the i-th row of a matrix X. For a matrix
proposed (He et al., 2022; Wu et al., 2023; Farhadkhani i,:
M in Rn×d, we denote M := n−11 1TM, and for p
etal.,2023). Wesummarizethepropertiesoftheseworks n n ∈
1,2, ,wedenote M ,thep-normofthevectorof
in Table 1. However, despite sufficient robustness crite- { ∞} ∥ ∥p,2
riaforadaptedrules(Wuetal.,2023;Kuwaranancharoen 2-normsoftherowsofM,i.e., ∥( ∥M i,: ∥2) i⩽n ∥p.Moreover,
C†istheMoorePenroseinverseofC andIdistheidentity
&Sundaram,2023)andimpossibilityresults(El-Mhamdi
matrix. WeidentifyRE toR|E| andRV toRn. Wedenote
etal.,2021;Heetal.,2022),afinecharacterizationofthe
theminimumbetweenaandbasa b.
influenceofByzantinenodesremainselusive,evenforbasic ∧
problemssuchasgossipaveraging.
2.ClippedGossipanditsdualinterpretation
Contributions. Inthispaper,(i)wedemonstratehowthe
dualapproachcanbeusedtointerpretclippedGossip,an This section introduces a dual point of view on clipped
existingrobustalgorithm,asaclippeddualgradientdescent, gossip. Westartbyintroducingthebasicsofgossipalgo-
(ii) derive clipping rules for this algorithm, (iii) provide rithmsandtheirflawsintheByzantinesetting. Then,we
convergence guarantees to better understand their robust- presentthealgorithmproposedbyHeetal.(2022). Finally
ness(ortherelackof)toByzantineattacks. Inparticular, wederiveouralgorithmofinterest, EdgeClippedGossip,
wehighlighttwomainsettingsdependingonwhetherwe whichinaparticularcaserecoverstheiralgorithmenabling
choosetheclippingthresholdlocallyorglobally. Weobtain toreinterpretitasClippedGradientDescentinthedual.
non-asymptoticconvergenceresultsforbothversions,and
Setting: Wedenoten = andn = thetotalnum-
discussprosandconsofeachmethod. Notethatthatour h |Vh | b |Vb |
ber of honest and Byzantine nodes, and N (i) and N (i)
clipping rules can be implemented in practice (assuming h b
the number of honest and Byzantine neighbors of node i.
Eachagentownsanditerativelyupdatesalocalparameter
xt. Attimet,wedenoteXt :=[xt,...,xt]T RV×dthe
Practical Sparse Convergence Dual pai rametermatrix,whichcanbespl1 itintohon nest∈ andByzan-
G
Farhadkhanietal.(2023) ✓ ✗ ✓ ✗ (cid:18) Xt(cid:19)
Heetal.(2022) ✗ ✓ ✓ ✗ tine parameter matrices by writing X = Xh t , where
Wuetal.(2023) ✓ ✓ ✓ ✗ b
Pengetal.(2021) ✓ ✓ ✗ ✗ X ht = [(xt i) i∈Vh]T (resp. X bt) is the sub-matrix contain-
ECG-Global-Clipping ✓ ✓ ✗ ✓ ing the models held by the honest workers (resp. Byzan-
ECG- Local-Clipping ✓ ✓ ✓ ✓ tine). NotethatByzantinenodes(inoppositiontomalicious
Table1.Comparison to main references. ECG holds for nodes)candeclaredifferentvaluestoeachoftheirneigh-
EdgeClippedGossip, i.e.,Algorithm1. Practical: ✓indicates bors.Assuch,onlythenumberandpositionsofconnections
thatthealgorithmicrulecanbeusedwithoutoracleknowledge. withByzantinenodesmatter, andwecanw.l.o.gidentify
SparseG:✓indicatesthatthemethodscanbeusedforanygraph.
thenumber ofedges linkingByzantineand honestnodes
Convergence:✓indicatesthatconvergenceisalwaysensuredup
tothenumberofByzantineworkersn .
toaneighborhood,generallyofsizeδ ζ2. Dual: ✓indicates |Eb | b
max
thatthealgorithmisgroundedinthedualapproach.
2Byzantine-RobustGossip:InsightsfromaDualApproach
2.1.Gossip-averageconsensuscase is the projection of x onto the L ball of radius τ. Then,
2
forτt RVh,Heetal.(2022)’scommunicationalgorithm,
Ingossipalgorithms,informationissharedbetweenneigh- ∈
calledClippedGossip(τt),writes:
bors by performing local averaging steps. As previously
explained, we focus on the average consensus problem, (cid:40) xt+1 =xt+(cid:80) W Clip(xt xt;τt)ifi
whichisanimportantspecialcaseofEquation(1). i i j∈V ij j − i i ∈Vh
xt+1 = , i.e.,isarbitrary, ifi .
Definition2.1(Averageconsensusproblem(ACP)). The i ∗ ∈Vb
(ClippedGossip)
A noC dP ec ionsists hin olc do sm apu vt ai ln ug ex x∗ ∗.= En q1 h ui(cid:80) vali e∈ nV th lyx ,∗ i i, tw coh ne sre ise tsac inh Inthelimitcaseofτ it = ∞forallt ⩾ 0andi
∈
Vh we
∈ Vh i recoverthestandardgossipaveragingofEquation(2),which
solvingProblem(1)withf i(x)= ∥x −x∗ i∥2.
withByzantineswrites:
(cid:18)
X
ht+1(cid:19)
=W
(cid:18)
X
ht(cid:19)
,wherewe
... Xt
Wedefineagossipmatrixasfollows: b
denoteby...thefactthatwehavenocontrolonthemodels
Definition 2.2 (Gossip matrix, spectral gap). A matrix heldbyByzantines,thusconsideredasarbitrary: Xt+1 = .
W Rn×n is a gossip matrix for a graph = ( , ) if: b ∗
(i) W∈ i+ s symmetric and doubly-stochastic:G W1V =E 1 , It can be shown that one step of ClippedGossip ensures
n n
and 1TW = 1T. (ii) W characterizes connections in the robustcontraction,whichallowsittobeusedefficientlyas
n n
network: W =0ifandonlyifi=j or(i j) . acommunicationprimitiveforByzantine-robustdecentral-
ij
̸ ∼ ∈E izedoptimization. Forinstance,Heetal.(2022)combine
Such a W has eigenvalues 1 = µ (W) ⩾ µ (W) ⩾
1 2 ClippedGossip with local computation steps (stochastic
...⩾ µ (W).ThespectralgapofW isdefine| dasγ | :=
n W gradientswithmomentum)tosolveProblem1forgeneric
| |
1 µ (W). If the graph is connected, then γ > 0.
2 W convexsmoothfunctionsf inthedecentralizedByzantine
−| | G i
The spectral gap is the main quantity characterizing the
setting. Generic analyses also show that ClippedGossip
informationpropagationinthegraph.
allowsByzantine-ResilientDecentralizedSGDtoconverge
toaneighborhoodoftheoptimum(Wuetal.,2023). More
Thestandardgossipalgorithmwrites(Boydetal.,2006):
generally,theideaofself-centeredclippingisattheheartof
Xt+1 =WXt, (2) severalByzantine-robustmethods(Gorbunovetal.,2022).
Remark2.4(OracleclippingruleinHeetal.(2022)). To
IntheabsenceofByzantinenodes,gossipaveraging(Equa-
ensuretheiralgorithm’sconvergence,Heetal.(2022)rely
tion(2))ensureslinearconvergenceoftheparameterstothe
on an oracle clipping threshold, written for node i
h
average(Boydetal.,2006),withX0 =(x∗) atalinear (cid:113) ∈ V
rate: (cid:80) i∈V∥xt i−x∗ ∥2 ⩽(1 −γ)2t(cid:80) i∈Vi ∥xi∈ 0 iV −x∗ ∥2. a δs (iτ )t i =:= (cid:80) δ(1 i) W(cid:80) j i∈ sV th hW
e
wij eE ig∥ hx tt i+ as1 s/ o2 c− iax tet j d+1 to/2 B∥2 2 y, zaw nh tie nre
e
Example2.3(GossipfromGraphLaplacian). Letuscon- j∈Vb ij
sidertheLaplacianmatrixofthegraphL=D Awhere neighbors of node i in the gossip matrix W, and xt+1/2
i
DisthediagonalmatrixofdegreesandAisthe− adjacency is the local model after the optimization step. Not only
matrix(i.e.,A =1 ). doeseachnodeneedtoknowthevarianceofthenoiseof
ij (i∼j)∈E
its neighbors, but it alsorequires to knowwhich nodes
Then,W =Id ηLisagossipmatrixforη ⩽ 1 .
L − maxi(Dii) arehonest. Thisbreaksthefundamentalassumptionofnot
We then have that γ = ηµ+ (L), with µ+ (L) the knowing the identity (honest or Byzantine) of the nodes.
WL min min
smallestpositiveeigenvalueofL. Evenifitisonlyrequiredforsettingtheclippingthreshold,
thisisstillamajorproblemsincetheclippingthresholdis
Unfortunately, standard gossip communications use non- averysensitiveparameter,anditisunclearwhathappens,
robust averaging steps, and so they are vulnerable to a specificallyincaseofunder-clipping. Experimentsareper-
singleByzantinenode,whichcandriveallhonestnodesto
formedusingaruleofthumbfortheclippingthreshold,not
anyposition(Blanchardetal.,2017). supportedbytheory. Incontrast, ourapproachleadstoa
computableclippingrulewhichissupportedbytheory.
2.2.Clippedgossip: gossipingrobustly
2.3.Dualapproach
Toremedythisvulnerabilityproblem,Heetal.(2022)pro-
poseacomputationally-efficientsolutionforrobustgossip Aspreviouslymentioned,thedualapproachisverypopu-
communication. Theiralgorithmextendsself-centeredclip- larindecentralizedlearning(Jakovetic´ etal.,2020;Uribe
ping(Karimireddyetal.,2021)tothedecentralizedcase: et al., 2020), and is at the heart of key advances, such as
nodesprojectallparameterstheyreceiveonaballcentered acceleration (Scaman et al., 2017; Hendrikx et al., 2019;
ontheirownparameter. Formally,forτ ⩾0andx Rd, Kovalevetal.,2020)orvariancereduction(Hendrikxetal.,
∈
x 2021). In this section, we show that ClippedGossip (He
Clip(x;τ):= min( x ,τ) (3)
x ∥ ∥2 etal.,2022)canbeunderstoodasClippedGradientDescent
2
∥ ∥
3Byzantine-RobustGossip:InsightsfromaDualApproach
inthedual,whichwewillthenleveragefortheanalysis. Variable Name Size Rows
X primalparameter d (x)
i i∈V
2.3.1.BYZANTINE-FREEDUALAPPROACH. Y dualparameter V× d (y i)
i∈V
V×
Λ Lagrangemultipliers d (λ )
We consider Problem (1) in a setting without Byzantine CT F∗(CΛ) Flowontheedges E× d (x(i∼j x) ( )i∼j)∈E
∇ E× i − j (i∼j)∈E
agents. We rewrite it as a constrained problem, introduc-
Table2. Summaryofnotations
ing one model per agent and enforcing equality between
neighbors–andthusonallnodes,usingconnectivityof :
G
2.3.2.ADAPTATIONINTHEBYZANTINESETTING.
(cid:88) (cid:88)
min f (x)= min f (x ). (4)
x∈Rd
i∈V
i (xi)i∈V∈Rd×V
i∈V
i i Wenowdiscusshowtoleveragethedualapproachinthe
∀(i∼j)∈Exi=xj Byzantinesetting. Inthederivationsabove,theupdateson
theLagrangianmultipliersΛt RE×dnaturallymodelthe
ForX RV×d,wenoteF(X) = (cid:80) f (X ),anden- ∈
codethe∈ edge-wiseconstraintthroughai m∈V atrii xCTi: RE×V, i tin of nor im tsea lt fio cn ansh bear wed ritt th enro au sg Ch Tedg Fes ∗. (CT Λhe ),fl so eew Eo qf uain tif oo nrm (7a )-
.
∈
suchthat[CTX] (i∼j),: = X j: X i: foranyedge(i j) Inparticular,eachrowofΛt (∇ resp.CT F∗(CΛt))corre-
− ∼
in . Therefore,wecanrewriteProblem(4)asfollows: ∇
spondstothevalue(resp.flow)onasingleedge(i j)
E
∼ ∈E
ofthegraph. Wenaturallyindexrowsbyedges,anddenote
min F(X). (5)
λt thecorrespondingrow,thuswriting, (i j) ,
X∈RV×d,CTX=0 (i∼j) ∀ ∼ ∈E
λt+1 =λt η[ f∗(yt) f∗(yt)],usingthat:
Assumingallfunctionsf tobesmoothandstronglycon- (i∼j) (i∼j)− ∇ j j −∇ i i
i
v the ex, Few ne chc ea ln -Ld egefi enn de ref i∗ tran: sfy orm(cid:55)→ ofsu fp .x∈ SR imd ⟨ iy la, rx l⟩ y,− forf i a( nx y) (CT ∇F∗(CΛt)) (i∼j) = ∇f j∗(y jt) −∇f i∗(y it). (9)
i
Y RV×d,F∗(Y) := sup X,Y F(X),and In other words, applying an operator on the update on
so∈ F∗(Y) = (cid:80) f∗(Y X )∈ siR nV c× ed F⟨ is s⟩ eF pa− rable. Using the rows of Λ correspond to altering the information
i∈V i i:
Lagrangianduality,thedualofEquation(5)writes: transmitted between nodes. For example, setting the row
(CT F∗(CΛt)) to 0 corresponds to removing edge
(i∼j)
∇
min F(X)= min max F(X) Λ,CTX (i j)fromthegraph. Weaimatleveragingthisobserva-
F
X∈RV×d X∈RV×dΛ∈RE×d −⟨ ⟩ tio∼ ntoguidethedesignofalgorithms. Inthefollowing,we
CTX=0
useclipping(Equation(3))toregulatetheflowonedges.
= min F∗(CΛ), (6)
−Λ∈RE×d
Oracle strategy. If an oracle had access to the set of
whereΛcorrespondstoLagrangianmultipliers. Thisdual
Byzantineedges ,thenapplying (i j) ,
b
problemcanbesolvedbygradientdescentwithstep-sizeη: E ∀ ∼ ∈E
λt+1 =λt ηClip( f∗(yt) f∗(yt),τ ) (10)
Λt+1 =Λt ηCT F∗(CΛt). (7) (i∼j) (i∼j)− ∇ j j −∇ i i (i∼j)
− ∇ withτ = 1 exactlyrecoversthegeneral-
(i∼j)
∞×
(i∼j)∈/Eb
DenotingY :=CΛ RV×d,thisimpliesthat izedgossipalgorithminEquation(7)onthesubgraphof
∈ honest nodes, and thus converges to the solution. Going
Yt+1 =Yt ηCCT F∗(Yt). (8) beyondsuchanoraclestrategy,weconsiderEquation(10)
− ∇ forageneralvectorτ RE:
Equation(8)thusgeneralizesGossipalgorithmstogeneric ∈
functions (f i) i=1,...,n, going beyond the case of average λt (+ i∼1 j) =λt (i∼j)−ηClip( ∇f j∗(y jt) −∇f i∗(y it),τ (i∼j)).
consensus described in Section 2.1. Indeed, the matrix
ThisgivesAlgorithm1,calledEdgeClippedGossip,which
CCT correspondstotheGraphLaplacianLintroducedin
translatestheupdatedescribedaboveintermsofprimaland
Example2.3,andintheparticularcaseofquadraticf ,Equa-
i
tion(8)isequivalenttoEquation(2)forW =Id ηL.
L
−
Algorithm1Byzantine-ResilientDecentralizedOptimiza-
Infact,Equation(8)operatesagossipprocedureonthedual
tionwithEdgeClippedGossip(τt)
variable Yt. The associated primal variable is defined as
Xt = ∇F∗(Yt) = ( ∇f i∗(y it))T i∈V. Notationsaresumma- I fon rpu tt =:
{
0f tj o}, T{y dj0 o},η, {τt
}
rizedinTable2. Convergenceguaranteesthenfollowfrom
standardgradientanalyses,andinparticularXtconverges forj =1,...,ninparalleldo
Computext = f∗(yt)ifj else
linearlytothesolutionofEquation(5).Efficientgossipalgo- j ∇ j j ∈Vh ∗
Shareparameterxt withneighbors
rithmscanbeobtainedbyusingotheralgorithmsonthedual j
(cid:16) (cid:17)
problem,leadingforinstancetoaccelerated(randomized) yt+1 =yt η(cid:80) Clip xt xt;τt
j j − i∼j j − i (i∼j)
gossip(Scamanetal.,2017;Hendrikxetal.,2019).
4Byzantine-RobustGossip:InsightsfromaDualApproach
dualiterates. Thepreviousderivationscanbesummarized 3.1.TheGlobalClippingRule
intothefollowingresult.
To analyze Equation (13), we decompose the flow of in-
Proposition2.5. Considerathresholdτ >0andτ =τ1 E. formationonhonestandByzantineedgesas(CTXt)
h
=
Then,Algorithm1: C hTX ht
∈
REh×d and(CTXt)
b
= C bTX ht −X bt
∈
REb×d.
For a given threshold τt we define as κt the number of
1. correspondstoclippedgradientdescentonEquation(6).
honestedgesthataremodifiedbyClip(,τt),i.e.,
·
Λt+1 =Λt −ηΠ τ(cid:0) CT ∇F∗(CΛt)(cid:1) , (11) κt =card(cid:8) (i j) , (CTXt) >τt(cid:9) . (14)
∼ ∈Eh ∥ h h (i∼j) ∥2
whereΠ istheprojectiononaballofradiusτ forthe
τ We then denote CTXt the 1,2-norm of the sub-
infinite-2norm ∥M ∥∞,2 :=sup (i∼j)∈E∥M (i∼j) ∥2. matrixofclipped∥ meh ssagh e∥ s1 ,,2 i; .κ et .:
2. isequivalentto(ClippedGossip)from(Heetal.,2022)
withaglobalclippingthreshold(τ ) =τ1 forthe (cid:88)
i i∈V V CTXt := (CTXt) .
averageconsensuscase. ∥ h h∥1,2;κt ∥ h h (i∼j) ∥2
(i∼j)∈Eh, κtlargest
Hence,robustalgorithmscanbeobtainedbyclippingdual
Thesequantitiesthusrepresentthefractionsofweightsof
gradients,matchingself-centeredclipping(Heetal.,2022) messages in (CTX) = ((x x ) ) that are af-
inparticularcases. Althoughdualgradientsarearguably
h i
−
j (i∼j)∈Eh
fectedbytheclipping. Next,weintroduceaquantitythat
hard to compute in the general case, several approaches
encapsulatestheimpactofByzantineagents:
allowtoleveragethe(primal-)dualapproachwhileeither
bypassing the problem or alleviating this cost (Hendrikx ∆ := sup C†C U .
etal.,2020;Kovalevetal.,2020). Thenextsectionfocuses ∞ Ub∈REb×d, ∥Ub∥∞,2⩽1∥ h b b ∥∞,2
onthequadraticcase,inwhichthe f∗areeasytocompute.
∇ i Specifically,itquantifieshowmuchtheByzantinenodescan
increasethevarianceofthehonestnodes. Inparticular,it
2.3.3.EdgeClippedGossipFORTHEACP
decreaseswhenremovingByzantineedgesfromthegraph.
WenowfocusonAlgorithm1fortheAverageConsensus
Assumption3.1. Weassume∆ <1.
Problem(Definition2.1). Indeed,theunderstandingofthis ∞
fundamental building block in the presence of Byzantine
Thisassumptionisverifiedforspecificgraphs.
nodesremainselusive. WedenoteX∗ =[x∗,...,x∗]T,the
1 n Lemma 3.2. For fully connected where each hon-
matrixofnode-wiseoptimalparameters. IntheACPsetting, Gh
est node has exactly N (i) = N Byzantine neighbors,
Xt = F∗(CΛt)A=CPCΛt+X∗,thus b b
∇ ∆ ∞ ⩽ 2 nN hb√d ∧n hN b.
Λt+1 =Λt ηClip(cid:0) CT F∗(CΛt);τt(cid:1) ,
ThisLemmaisprovedinAppendixB.1.3.Interestingly,two
− ∇
Xt+1 =Xt ηCClip(CTXt;τt). (12) regimes appear: to satisfy Assumption 3.1 it is sufficient
⇔ − thatn >2N √dforsmalldimensiond,butn >4N3for
h b h b
In order to distinguish the impact of honest and Byzan- larged. ItthusappearsthatthelimitfractionofByzantine
tine nodes, we decompose the matrix C into blocks as neighborsissignificantlyimpactedbythedimension. We
(cid:18) (cid:19) (cid:18) (cid:19)
C = C h C b ,andX as X h . Theupdatefrom nowdefinethefollowingclippingthresholdrule.
0 Id X
− Eb b Definition3.3(GlobalClippingRule(GCR)). Givenastep
Equation(11)thuswritesas
sizeη,asequenceofclippingthresholds(τs) s⩾0,satisfies
theGlobalClippingRuleifforallt⩾0,eitherτt =0,or
Xt+1 =Xt η(C C )Clip(CTXt;τt); Xt+1 = .
h h− h b b ∗
Inthefollowing,weanalyseEquation(13). Wefirstfo( c1 u3 s) ∥C hTX ht ∥1,2;κt ⩾∆ ∞ ∥C hTX ht ∥1,2+η|E nb |2 (cid:88) τs.
onthecaseofaglobalclippingthresholdτ inSection3,then h 0⩽s⩽t
showhowtoincorporatelocalclippingrulesinSection4.
Thisclippingruleenforcesthattheclippingthresholdisbe-
3.GlobalClipping
lowacertainvalue,sincedecreasingτtincreasesκt,which
inturnincreasestheleftterm. Inparticular,τt isreduced
In this section, we investigate average consensus until the sum of the norms of the honest edges clipped
EdgeClippedGossip under global clipping threshold. is greater than the sum of the norms of all honest edges,
Morespecifically,wehighlightarelativelypracticalchoice shrinkedbythecontraction∆ plusatermproportional
∞
of the sequence of thresholds (τt) t⩾0 for which we can tothesumofpreviousthreshold(whichcaneasilybecom-
deriveconvergenceguarantees. puted by all nodes). This latter term, η 2(cid:80) τs/n
|Eb
|
s⩽t h
5Byzantine-RobustGossip:InsightsfromaDualApproach
can actually be understood as a bound on maximal bias following: each step of EdgeClippedGossip pulls nodes
inducedbyByzantinenodesaftertsteps. Atanystept,for closertogether,butatthecostofallowingByzantinenodes
givenpreviousthresholds(τs) 0⩽s⩽t−1,eitheritispossible tointroducesomebiassothatX ht −X h∗ ̸=0. Thistrade-off
tofindτtsatisfyingtheassumption,orwesetτtto0,which appears in the GCR: at some point, further reducing the
correspondstoearly-stoppingthealgorithm. variance is not beneficial because it introduces too much
bias,andsotheGCRenforcesthatτt 0,whichessentially
TheformulationofGCRinDefinition3.3requiresevalu- ≈
stopsthealgorithm. Yet,regardlessoftheinitialheterogene-
atingsumsofnorm(inparticular CTXt ),whichcanbe
∥ h h∥ ity,nodesbenefitfromrunningEdgeClippedGossip.
tricky in a decentralized setting with adversaries. Fortu-
nately,thefollowingpropositionprovidesasufficientcon- Remark3.9(Globalclippingrulescannotreachconsensus).
dition for being a GCR that only requires κ t to be large Theorem3.7doesnotensureconvergenceofthevariance
enough,withoutanydependenceonXt. betweenhonest-nodesmodels X X¯ 2 to0,inoppo-
∥ h − h ∥F
Proposition 3.4 (Simplified GCR). If (τt) t⩾0 is such sitiontolocalapproachesasinvestigatedinSection4. This
thatforallt ⩾ 0,eitherκt ⩾ ∆ +η|Eb|2 (cid:80) τs isexpected,asitisactuallyimpossibletoensureconsensus
∞ |Eh | nh s⩽t τt amonghonestnodesusingaglobalclippingthresholdwith-
orτt =0,then(τs) s⩾0satisfiestheGCR.
outaddingfurtherunrealisticassumptions. Wenowshow
Thisresultreadsasalowerboundonthefractionκt/
h
thisbyconstructinganexampleinwhichX ht =X h0forallt,
ofedgesthatareclipped. ItisprovedinAppendixB.1.|E | i.e.,thenodes’modelsdonotmove(andarenotallequal).
Remark 3.5 (Over-clipping). The GCR defines an upper Forthis,considerasettingwhereanhonestnodek
h
boundonτt,butanyvaluebelowthisthresholdworks. By hasaparameterx0 =1differentfromotherhonestn∈ odV es,
k
denotingκt,∗thesmallestκtsuchthattheGCRholds,we which all agree on the same values: i k, x0 = 0.
mustensurethatatleastκt,∗ honestedgesareclipped. A Alsoconsiderthatthenumberofedges∀ con∈ troV lh le\ dbyBi yzan-
p e cd ora g mc et psic uoa tv il nes gro al κu ll tt ,i ,∗o bn y ot nro e tmt hh eois v rie enn mgd afic inro s in t ns gti hst e es d|i
E
gn ebc
|
sl li aap frp tg ei en rs wg t aκ e rdt d, g∗ se .+ s N,| a oE n tb d e| t h di o en cne le an s ro t ed n see tis hg| ehE bb vo| ari lss uo es ftr xnic ot dl =y ekl 0a . ,rg I tfe her evt e oh ra nyn lyBN y eh dz( a gk n e) t si, n wt eh ie n thon du nem oj nb -∈e zr
eV
ro obf
j
thattheGCRstillholdsifthenumberofByzantineedgesis updateswillbethoselinkingkwiththeotherhonestnodes.
over-estimated. Since at least edges should be clipped (otherwise at
b
|E |
Remark 3.6 (Global coordination). Theorem 3.7 uses a least one Byzantine node is never clipped and so can in-
globalclippingthresholdthatsatisfiesDefinition3.3. This troducearbitrarydisruptions),and > N (k),thenall
b h
|E |
requiresglobalcoordination,whichishardingeneral. Yet, edgesinvolvingnodekareclippedtothevalue0.
nodesonlyneedanupper-boundonascalarvalue,which
canbemucheasierthantheaveragingproblemthatweare 4.BeyondGlobalsupervision
tryingtosolve(usuallyinlargerdimensions). Besides,it
givesabaselineonwhathonestnodescanachieveundera Global clipping thresholds are interesting to use because
favorableassumptionontheircommunications. theydonotintroduceanybiasintheabsenceofByzantine
nodes(i.e.,theglobalaverageremainsthesame). However,
3.2.Convergenceresultanddiscussion wehaveseenthattheyhavetwomaindrawbacks: (i)the
globalthresholdcanbehardtoenforce,and(ii)thehonest
Recallthatµ (L )isthemaximaleigenvalueofthehon-
max h nodesarenotguaranteedtoconvergetothesamesolution
estgraph Laplacian,and∆ dependsonlyonthetopol-
h ∞ ingeneral. Wenowinvestigatelocalclippingrules.
ogyoftheG fullgraph . WenoteX∗ =1 1TX∗/n
G h h h h h
Theorem3.7. UnderAssumption3.1,letη beaconstant 4.1.Localclippingformulation
step size: η ⩽ 1 . If the clipping
(1+|Eh|(1−∆∞))µmax(Lh)
InByzantine-freesettings(seeSection2.3.1),gradientde-
thresholds(τs) s⩾0satisfyDefinition3.3(GCR),then:
scentinthedualleadstogossipalgorithmsforwhichthe
Xt+1 X∗ 2 ⩽ Xt X∗ 2 η (cid:88) xt xt 2. information flow passed from node i to j is the opposite
∥ h − h∥F ∥ h− h∥F− ∥ i− j∥2 of the one passed from node j to i. The matrix of flows
i∼jnotclippedattimet
CT F∗(CΛt) thus has one row for each edge. If flows
∇
are clipped symmetrically (e.g., global), this property is
ThisresultisprovedinTheoremB.7ofAppendixB.1.
maintained, as all pairs of neighbors clip identically. We
Remark3.8(EdgeClippedGossipwithGCRcanonlyde-
thuswritetheupdateasEquations(7)or(11). Suchupdates
creasetheerror). Theorem3.7providesadescentlemma:
ensure, as 1TC = 0, that the average dual value remains
thesquareddistancefromthesetofhonestmodelsXt to
h constantalongiterations,i.e.,1TYt+1 =1TYt(nobias).
theglobaloptimumX∗decreasesateachstep,althoughnot
h
necessarilyallthewayto0. Inessence,whathappensisthe Inthissection,weareinterestedinlocalclippingrules,for
6Byzantine-RobustGossip:InsightsfromaDualApproach
whicheachnodeappliesitsownclippingthreshold. Tothat Inotherwords,ateachnode,wereducethelocalclipping
end,weencompassclippingthresholdsthatdependonthe thresholdτtuntilweclipexactlytwicethenumberofByzan-
j
edgedirection. Astheaverageupdateisnotnullanymore, tineworkers. Notethatthisisaverysimpleclippingrule,
suchmodificationintroducesanadditionalasymmetricclip- thatisbotheasyandcheaptoimplementinpractice.
pingbiastotheoneintroducedbyByzantinenodes.
Recall that we denote µ (L ) and µ+ (L ) are the
max h min h
Formally,foradirectedgraph ˜ = ( , ˜),weenumerate largest and smallest non-zero eigenvalues of the honest-
itssetofedgesas ˜= i j .G WeinV troE ducethe: graph Laplacian L , and γ = µ (+L )/µ (L ) its
h min h max h
E { → }
spectralgap,asdefinedinExample2.3. Next,weintroduce
• constraintmatrixC˜ s.t.C˜T RE˜×V andforX inRV×d,
thefollowingquantity,thatcapturestheimpactofByzantine
andanyi j
˜,(C˜TX)∈
=X X .
i→j j,: i,: agentsinthelocal-clippingcase.
→ ∈E −
• directedadjacencymatrixB˜ RV×E˜ s.t.foranyM in
RE˜×dandj ,wehave(B˜M∈ ) =(cid:80) M . δ := max iN b(i) . (18)
∈V j (i→j)∈E˜ i→j ∞ µ (L )
max h
Withsuchnotations,B˜C˜T isthe(nonnecessarilysymmet-
Asinthecaseofglobalclipping,convergenceisensuredas
ric)Laplacianofthedirectedgraph ˜. Wethengeneralize
Equation(7),byintroducingΛt RG E˜×d,aclippingthresh- longasthisquantityisupperbounded.
oldvectorτ RE˜ ,andperformi∈ ngthefollowingupdate: Assumption4.4. Weassumeδ ∞ ⩽ γ 42 .
∈
Λ˜t+1 =Λ˜t Clip(ηC˜T F∗(B˜Λ˜t),τ). (15) Heetal.(2022)introduceasimilarquantity,whichwritesas
− ∇ δ =max Nb(i) whenedgesareweighteduniformly.
ForACP,wesimilarlygeneralizeEquation(12). max i∈Vh N(i)
In the particular case of a regular honest sub-graph, for
X˜t+1 =X˜t ηB˜Clip(C˜TX˜t;τt). (16) which N h(i) = N is constant, we have that δ ∞ ⩽ δ max.
− Indeed,µ (L )⩾N,asµ (L )⩾Tr(L )/n =N.
max h max h h h
Remark4.1(Linkwiththeundirectedcase). Foranyundi-
Moreover, He et al. (2022) establish1 that no consensus
rectedgraph ,wecreateitsdirectedequivalentbysplitting
G canbeachievedforδ ⩾ (γ2). ThescalinginAssump-
eachedge(i j)intotwodirectededgesi j andj i. ∞
O
Then, if we u∼ se a symmetric clipping thre→ shold τ → RE˜ , tion4.4isthustight. Wearenowequippedtopresentour
∈ convergenceresult.
i.e., such that τ = τ , Equations (15) and (16) are
i→j j→i
respectivelyidenticaltoEquations(7)and(12). Theorem4.5(Linearconvergenceofthevariance.). Under
Remark 4.2. Denoting MT := (B˜†C˜)T, Equation (15) Assumption 4.4, consider a step size η = 2(µ max(L h)+
µ+ (L ))−1. If the local clipping thresholds se-
writes as a clipped pre-conditioned gradient descent: min h
Λ˜t+1 =Λ˜t ηClip(MTB˜T F∗(B˜Λ˜t),τ). Inparticular, quence(τ js) s⩾0,j∈V isaLCR(Definition4.3),then
− ∇
weexpectfixed-pointsofthisiterationtobeminimizersof
Λ˜ F∗(B˜Λ˜)intheabsenceofByzantines. X˜t+1 Xt+1 ⩽(cid:16) 1 2γ (cid:16) 1 2√δ ∞(cid:17)(cid:17) X˜t Xt .
(cid:55)→ ∥ h − h ∥F −1+γ − γ ∥ h− h∥F
Thisformulationenablesustonaturallytackleasymmetric
clippingonedges. Inthefollowing,weinvestigatethecase Thistheoremshowsthatthevarianceofhonest-nodesparam-
of node-wise clipping thresholds: for any receiving-node etersconvergeslinearlyto0. WeproveitinTheoremB.11
j and any sending-node i such that i →j ∈ E˜, τt i→j := inAppendixB.2.
τt, i.e., node j uses the same local clipping level on all
j Remark4.6(Practicalclipping). Thisconvergenceresultis
messages it receives. In the particular case of ACP, this
closetoHeetal.(2022,Theorem1). Yet,theirclippingrule
algorithmcorrespondstoClippedGossip(Heetal.,2022).
requiresanaverageoverhonestneighbors,whichishighly
unpractical (see Remark 2.4). On the contrary, our LCR
4.2.Convergenceresults isextremelysimpletobothimplementandinterpret,while
For any j and local threshold τt, we define as κt still leading to comparable convergence guarantees. We
∈ V j j believethisiskeytoobtainingpracticalrobustalgorithms.
the number of edges pointing towards j and modified by
Clip(,τt),i.e., Remark 4.7 (Breakdown point). In the case of a fully-
κt
j· =j
card(cid:8) i →j ∈E˜, ∥(C˜TX˜t) i→j ∥2 ⩾τ jt(cid:9) . (17)
c cao nnn be ec rt ee ad cg hr ea dp uh p,δ t∞ oa= brenn ahb kdan owd nγ p= oi1 n. toH fe nn bc
n
+e
b
n, hco =nse 1n /s 5u .s
Remark4.8(HowmanyneighborsareByzantine?). Theex-
Definition4.3(LocalClippingRule(LCR)). Asequence
actnumberofByzantineneighborsislikelytobeunknown,
ofclippingthresholds(τ js) s⩾0,j∈V,satisfiestheLocalClip-
pingRuleifforallt⩾0,andanyj ∈Vh,κt
j
=2N b(j). If 1Usingacounterexampleinwhichbothδareequivalent,as
2N b(j)>N(j):=N h(j)+N b(j),wesetτ jt =0. |δ ∞−δ max|⩽1/n2 h.
7Byzantine-RobustGossip:InsightsfromaDualApproach
andthusthenumberofneighborstoclip. Thiscanbecir- ThistheoremisprovedinTheoremB.15inAppendixB.2.
cumvented by choosing a maximal number of Byzantine Weseethatinthecaseofthedecentralizedconsensusprob-
neighbors tolerated N(cid:98)b, and by modifying slightly Defi- lemunderByzantineattacks,trimmingandclippingoffers
nition 4.3 by taking κt
j
= 2N(cid:98)b. Then, by replacing δ
∞
thesameratesandrobustnessconditionsuptoafactor4.
byδ(cid:98)∞ :=N(cid:98)b/µ max(L h),underAssumption4.4theTheo-
rem4.5stillholds. Thus,fixingN(cid:98)bgivesacommunication 5.Towardsgraph-tailoredattacks
scheme robust up to this number of Byzantine neighbors.
Mostattacksproposedtopreventoptimizationindistributed
NotethatincreasingN(cid:98)binabsenceofByzantinesstilllowers
setting focus on the federated case: for instance, Baruch
theperformances.
etal.(2019);Xieetal.(2020)proposetoleveragethenoise
Contrarytothecaseofglobalclipping,Theorem4.5guar- introducedbythestochasticgradienttopreventconvergence.
anteesthatallhonestnodesultimatelyconvergetothesame WhileHeetal.(2022)suggestanadaptationinthedecentral-
model. Yet, this model may not be the optimal one, as a izedsetting,itisstillunclearhowtheproposedattacktakes
bias can be induced by Byzantine corruption and by the advantageofthetopologyofthegraph. Inthissection,we
asymmetry of clipping. However, such a linear decrease proposeaprincipledapproachfordesigningattacksoncom-
ofthevarianceessentiallyenablestolimitthenumberof municationnetworks. Therefore,wefocusongossiptype
iterationsthatareneededtoobtainconvergence,andcanbe communicationalgorithmswithrobustaggregationscheme,
turnedintoacontroloftheintegralofthebias. Indeed,for suchasClippedGossip.
aLCR,thedriftattimetislimitedbythevariance:
Letusdecomposeupdate(16)toseetheByzantineimpact.
Corollary4.9. UnderthesameassumptionsasTheorem4.5
t γh −2e
√
2b √δi
∞
δa ∞s o
(cid:13)
(cid:13)f Xh h∗on −es Xt hn ∗o
(cid:13)
(cid:13)d .es is controlled as: ∥Xt −X h∗
∥
⩽
X˜ ht+1 =X˜ ht −η(B˜ hB˜
b)Clip(cid:32)(cid:32) ( (C C˜ ˜T TX X˜ ˜t t)
)i i→ →j j∈ ∈E E˜ ˜h
b(cid:33) ;τt(cid:33)
,
ThiscorollaryisprovedinCorollaryB.12inAppendixB.2. with ˜ thesetofdirectededgesthatoriginateinaByzantine
Remark 4.10 (Total bias). Let ζ2 = X∗ X∗ 2 be the Eb
∥ h − h∥ node i b. Such nodes have the ability to chose the
heterogeneityoflocalobjectives. Similarlytous,Heetal. value ∈ ofV (C˜TX˜t) tomaximizetheattackimpact.
(2022)establishconvergencetoa (δmaxζ2 )neighborhood ♢ − i→j∈E˜ b
O γ2 One step heterogeneity attack. A first angle is to
ofthesolution,whileWuetal.(2023)ensureanasymptotic
convergencetoa ( δ m2 √axnhζ2 )neighborhood. maximize the heterogeneity of the nodes ∥C˜ hTX˜ ht+1 ∥2 F,
O (γ− nhδmax)3 used within thresholds design. Approximating X˜t+1 as
h
X˜t +ηB˜ Clip( ;τt),wegetatfirstordertheproblem:
4.3.Thecaseoftrimming h b ♢
argmax B˜TL X˜t,Clip( ;τt) ,
Althoughwefocusedonclippingintheprevioussections, ⟨ b h h ♢ ⟩F
♢
anothernaturalwaytocontroltheflowonedgesconsists
i Hn ea rp ep afly tein r,g wa etr pim rom vii dn eg ro ep se ur la tsto or, nT Eri dm g( eu C; lτ ip) p: e= dGu1 o∥ su si∥ p2⩽ aτ p. - 4si ηnc Le ∥ X˜C˜ thT ,B( ˜X˜ h Ct l+ ip(ηB˜ b ;τC tl )ip +( ♢ o(; ητ )t .)) S∥ u2 F ch= a∥ pC r˜ ohT bX l˜ eh mt ∥2 F ca+
n
pliedfortheaverageconsensusproblem,whenusinglocal be⟨ solh vedh expb licitly,♢ astheo⟩ ptimalvalue ∗oneachrowis
trimminginsteadoflocalclipping. obtainedindependently. Specifically,fo♢ ranyi j ˜,
b
Remark4.11. Notethatlocaltrimmingisequivalenttothe ∗ is proportional to (B˜TL X˜t) = (L→ X˜t)∈ E =
NearestNeighborAveraging(NNA)operatorpresentedin
(cid:80)♢i→j
(xt xt). In
othb
er
wh orh dsi ,→ thj
e
(first-h ordh erj ),:
op-
Farhadkhanietal.(2023). Yet,theiranalysisonlyholdsin timk a→ lj a∈ ttE˜ ah ckoj f− thek Byzantinenodeionnodej consistsin
thefully-connectedcase, whileourscoversanytopology. sendingaparameterxt =xt+ε(cid:80) (xt xt),where
Weshowthatlocaltrimming(i.eNNA)is,uptoaconstant, ε⩾0isascalingparai meterj ,chosenk→ toj m∈E a˜ h ximj iz− ethk eimpact
asefficientaslocalclippinginsparsedecentralizedsetting. whileremainingundetectedbytheaggregationrule. Note
Theorem4.12(Localtrimmingisalmostasefficientasclip- thatthisattackactuallycorrespondstotheDissensusattack
ping). Assumethatδ ⩽ γ2 then,withthesamestepsize (Heetal.,2022,AppendixB),towhichtheaboveprovides
∞ 16
andthresholdruleasinTheorem4.5,usinglocaltrimming atheoreticalground.
aggregation,thevarianceconvergeslinearlytozero:
Spectralheterogeneityattack. Amoreeffectiveattack
∥X˜t −Xt ∥F⩽(cid:16) 1
−
12 +γ γ(cid:16) 1
−
4√ γδ ∞(cid:17)(cid:17)t(cid:13) (cid:13)X h∗ −X h∗(cid:13) (cid:13)
F
, s intr sa tt ee ag dy ois ft to +inc 1r ,e ia .s ee .,h met ae xro imge in ze init gy ∥at Ca hTfu X˜rt hth +e sr +h 1o ∥r 2 Fiz .on Tot+ ds o,
so,weapproximatetheprogressoversstepsusingtheun-
a γn −4d √ 4√δ∞t δh ∞e (cid:13) (cid:13)Xbia h∗s −i Xs h∗c (cid:13) (cid:13)o Fntrolled as: ∥Xt − X h∗ ∥F ⩽ p Ne er xtu t,rb ae pd prg oo xs is mip au tip nd gat Xe ˜, hto +b 1ta ai sni Xn ˜g ht∥ +C ηhT B( ˜I bh C− liη pL (h ♢)s ;X τ˜ h tt+ ),1 w∥2 2 e.
8Byzantine-RobustGossip:InsightsfromaDualApproach
Noattack Dissension SpectralHeterogeneity Consensus
102
1
10−2
10−4
0.1 0.2 0.3 0.1 0.2 0.3 0.1 0.2 0.3 0.1 0.2 0.3
Byzantineproportion Byzantineproportion Byzantineproportion Byzantineproportion
LocalClippingOurs LocalClipping[Heetal. 2022] LocalTrimming Global GlobalApprox
Figure1.Improvement of the MSE after 30 iterations of the aggregation schemes under the proposed attacks (points over 1 mean
non-robustaggregation).Simulatedinacliqueof20nodesandavaryingproportionofByzantinenodes.RelativeMSEover102arenot
shown.Logscale.
getthattheoptimalattacksolves erogeneityattack,inwhichut =[v vT Xt] . Wescale
i min min h j:
each attack by choosing εt/ ut to be a) just below the
argmax ⟨B˜ bTL h(I h −ηL h)2sX˜ ht, Clip( ♢;τt) ⟩F, trimmingthresholdofnodei ii∥ nci a∥ seoftrimmingb)arbitrar-
♢
ilylargeincaseofclipping. Weperformtheexperiments
Leading to for any i j , ∗ being pro- onafully-connectedgraph,with20nodes,andavarying
→ ∈ Eb ♢i→j
portional to (L (I ηL )2sX˜t) . As the opera- proportion of Byzantine nodes. See Appendix A for ex-
tor rapidly shrinh ksh to− 0 forh largeh ej i, g: envalue of L , if periments on a modified Torus topology. Parameters of
h
we denote v
min
the eigenvector associated to the sec- honestnodesareindependentlyinitializedwitha N(0,I 5)
ond smallest non zero eigenvalue, we have ((I distribution,andweaveragetheMSEover200samples. In
h
ηL )sL X˜t) ((1 ηµ+ )v vT X˜t) = (1− Figure1,weconsiderthegainoftheaggregationscheme
ηµ+ mh in)vh minh ,j(j v,: mT≃ inX˜ ht).− Thebm ein stam ttain ckm din irech tioj, n: thusta− r- onthemean-squareerrorMSE t := ∥X ht −X h∗ ∥2 F. Westop
getsthedirectionv vT X˜t. theaggregationschemeafter30iterations,whichisenough
min min h forconvergenceinabsenceofdisruptionsinthiscase.
Aspreviously,thisattackalsohasaclosedform. Wecall
thisaSpectralHeterogeneityattack. Theheartofthisattack 6.2.Analysis
is that, instead of maximizing the variance at time t+1,
Byzantine nodes focus on increasing the variance along
Practicalperformance.OnFigure1,wenotethata)Inthis
directionsthatarehardlyaveragedbythegossipprocess.
setting,apartfromtheproportionof1/20Byzantinenodes
(inwhichlocalclippingrulesarethesame),GlobalClipping
and our Local Clipping outperform Trimming and Local
6.Experiments
ClippingofHeetal.(2022)ontheworst-caseattack. Yet,
6.1.Setting GlobalClippinghasroughlythesameperformanceunder
allattacks,suchthatitunder-performsunderNoattackand
Inthissection,weprovideexperimentstosupportthepro- Dissensionattack.b)SpectralHeterogeneityandConsensus
posedattacksandrobustgossipalgorithms. Wecompare attackssignificantlyoutperformtheDissensionattack. c)
theGCR,theSimplifiedGCR,theLCRandthelocaltrim- The approximation leading to the Simplified GCR is too
ming(consistentwithNNAproposedinFarhadkhanietal. looseasitgenerallyleadstoaclippingthresholdof0. d)
(2023))withtheruleofthumbLocalClippingproposedin TheclippingruleofHeetal.(2022)performsbetterunder
Heetal.(2022)which,underthenotationsofDefinition4.3, theNoattackattack,whichreflectsthattheyunder-clip.
consist in taking κt = N (i) + 1. We test these under
j b
Linkwiththetheory. InAppendixAwedisplaysthede-
differentattacks. Wedecomposetheparametersentbya
Byzantineneighboriofanhonestnodejasxt =xt+εtut, compositionMSE=heterogeneity+biasalongthegossip
i j i i
whereut isthedirectionofattackonedge(i j)andεt process. We remark that Global Clipping ensures mono-
i ∼ i tonicityoftheMSE(aspredictedbyTheorem3.7),whereas
a scaling parameter. Then we implement i) a Consensus
local rules do not: they induce linear convergence of the
attack,inwhichallByzantinenodesattackinthesamedi-
rection: ut = u fixed along time; ii) a No Attack attack heterogeneity,butunderthepriceofanadditionalbias. As
i
whereByzantinestakeut = 0, i.e., theydonotinfluence such,itsupportsthatwecan’tdirectlyprovedecreasingof
i
theMSEinlocalclippingrules,asitisreflectedintheproof
optimization;iii)theDissensusattackofHeetal.(2022),
inwhichut = (cid:80) (xt xt); iv)ourSpectralHet- ofCorollary4.9.
i k→j∈E˜ h j − k
9
ESM/
ESM
laitini
lanfiByzantine-RobustGossip:InsightsfromaDualApproach
7.Conclusion 8.ImpactStatement
Wehaveleveragedthedualapproachtodesignabyzantine- Thispaperpresentsworkwhosegoalistoadvancethefield
robust decentralized algorithm, and we have analyzed its of Machine Learning. There are many potential societal
properties for the average consensus problem under both consequences of our work, none which we feel must be
globalandlocalclippingrules. specificallyhighlightedhere.
Similarlytothefactthatdifferentstep-sizescheduleslead
to very different behaviors for (S)GD, we argue that the References
core of (Byzantine-robust) algorithms based on clipping
Alistarh,D.,Allen-Zhu,Z.,andLi,J. Byzantinestochas-
lies on the choice of the clipping threshold. Therefore,
tic gradient descent. Advances in Neural Information
whileEdgeClippedGossipisreminescentofexistingalgo-
ProcessingSystems,31,2018.
rithmssuchasClippedGossip,ourclippingrulesarenovel,
practicalandtheoreticallygrounded,andtheyleadtotight Baruch,G.,Baruch,M.,andGoldberg,Y. Alittleisenough:
convergenceresults. Circumventing defenses for distributed learning. Ad-
vances in Neural Information Processing Systems, 32,
2019.
Blanchard,P.,ElMhamdi,E.M.,Guerraoui,R.,andStainer,
J. Machinelearningwithadversaries: Byzantinetoler-
ant gradient descent. Advances in neural information
processingsystems,30,2017.
Boyd,S.,Ghosh,A.,Prabhakar,B.,andShah,D. Random-
izedgossipalgorithms.IEEEtransactionsoninformation
theory,52(6):2508–2530,2006.
Chen,Y.,Su,L.,andXu,J. Distributedstatisticalmachine
learninginadversarialsettings: Byzantinegradientde-
scent. Proceedings of the ACM on Measurement and
AnalysisofComputingSystems,1(2):1–25,2017.
Duchi,J.C.,Agarwal,A.,andWainwright,M.J. Dualaver-
agingfordistributedoptimization: Convergenceanalysis
andnetworkscaling. IEEETransactionsonAutomatic
control,57(3):592–606,2011.
El-Mhamdi, E.-M., Guerraoui, R., Guirguis, A., Hoang,
L.N.,andRouault,S. Genuinelydistributedbyzantine
machinelearning. InProceedingsofthe39thSymposium
on Principles of Distributed Computing, pp. 355–364,
2020.
El-Mhamdi,E.M.,Farhadkhani,S.,Guerraoui,R.,Guirguis,
A.,Hoang,L.-N.,andRouault,S. Collaborativelearning
in the jungle (decentralized, byzantine, heterogeneous,
asynchronousandnonconvexlearning).AdvancesinNeu-
ral Information Processing Systems, 34:25044–25057,
2021.
Fang,C.,Yang,Z.,andBajwa,W.U. Bridge: Byzantine-
resilientdecentralizedgradientdescent. IEEETransac-
tions on Signal and Information Processing over Net-
works,8:610–626,2022.
Farhadkhani, S., Guerraoui, R., Gupta, N., Pinot, R., and
Stephan, J. Byzantine machine learning made easy by
10Byzantine-RobustGossip:InsightsfromaDualApproach
resilientaveragingofmomentums. InInternationalCon- LeBlanc,H.J.,Zhang,H.,Koutsoukos,X.,andSundaram,
ference on Machine Learning, pp. 6246–6283. PMLR, S. Resilient asymptotic consensus in robust networks.
2022. IEEEJournalonSelectedAreasinCommunications,31
(4):766–781,2013.
Farhadkhani, S., Guerraoui, R., Gupta, N., Hoang, L.-N.,
Pinot,R.,andStephan,J. Robustcollaborativelearning Li, L., Xu, W., Chen, T., Giannakis, G. B., and Ling, Q.
withlineargradientoverhead. InInternationalConfer- Rsa: Byzantine-robust stochastic aggregation methods
enceonMachineLearning,pp.9761–9813.PMLR,2023. fordistributedlearningfromheterogeneousdatasets. In
ProceedingsoftheAAAIConferenceonArtificialIntelli-
Gorbunov,E.,Borzunov,A.,Diskin,M.,andRyabinin,M.
gence,volume33,pp.1544–1551,2019.
Securedistributedtrainingatscale. InInternationalCon-
ference on Machine Learning, pp. 7679–7739. PMLR, Nedic,A.andOzdaglar,A. Distributedsubgradientmeth-
2022. odsformulti-agentoptimization. IEEETransactionson
AutomaticControl,54(1):48–61,2009.
He,L.,Karimireddy,S.P.,andJaggi,M. Byzantine-robust
decentralizedlearningviaclippedgossip. arXivpreprint Peng,J.,Li,W.,andLing,Q. Byzantine-robustdecentral-
arXiv:2202.01545,2022. izedstochasticoptimizationoverstaticandtime-varying
networks. SignalProcessing,183:108020,2021.
Hendrikx, H., Bach, F., and Massoulie´, L. Accelerated
decentralizedoptimizationwithlocalupdatesforsmooth Scaman,K.,Bach,F.,Bubeck,S.,Lee,Y.T.,andMassoulie´,
andstronglyconvexobjectives.InThe22ndInternational L. Optimalalgorithmsforsmoothandstronglyconvex
Conference on Artificial Intelligence and Statistics, pp. distributed optimization in networks. In international
897–906.PMLR,2019. conferenceonmachinelearning,pp.3027–3036.PMLR,
2017.
Hendrikx,H.,Bach,F.,andMassoulie´,L.Dual-freestochas-
tic decentralized optimization with variance reduction.
Uribe,C.A.,Lee,S.,Gasnikov,A.,andNedic´,A. Adual
Advancesinneuralinformationprocessingsystems,33:
approachforoptimalalgorithmsindistributedoptimiza-
19455–19466,2020. tion over networks. In 2020 Information Theory and
ApplicationsWorkshop(ITA),pp.1–37.IEEE,2020.
Hendrikx,H.,Bach,F.,andMassoulie,L. Anoptimalal-
gorithmfordecentralizedfinite-sumoptimization. SIAM
Vaidya,N.H.Iterativebyzantinevectorconsensusinincom-
JournalonOptimization,31(4):2753–2783,2021.
pletegraphs. InDistributedComputingandNetworking:
15thInternationalConference,ICDCN2014,Coimbat-
Jakovetic´, D., Bajovic´, D., Xavier, J., and Moura, J. M.
ore,India,January4-7,2014.Proceedings15,pp.14–28.
Primal–dualmethodsforlarge-scaleanddistributedcon-
Springer,2014.
vexoptimizationanddataanalytics. Proceedingsofthe
IEEE,108(11):1923–1938,2020.
Vaidya,N.H.,Tseng,L.,andLiang,G. Iterativeapproxi-
Karimireddy,S.P.,He,L.,andJaggi,M. Byzantine-robust matebyzantineconsensusinarbitrarydirectedgraphs. In
learningonheterogeneousdatasetsviabucketing. arXiv Proceedingsofthe2012ACMsymposiumonPrinciples
preprintarXiv:2006.09365,2020. ofdistributedcomputing,pp.365–374,2012.
Karimireddy, S. P., He, L., and Jaggi, M. Learning from Wu,Z.,Chen,T.,andLing,Q. Byzantine-resilientdecen-
history for byzantine robust optimization. In Interna- tralizedstochasticoptimizationwithrobustaggregation
tionalConferenceonMachineLearning,pp.5311–5319. rules. IEEEtransactionsonsignalprocessing,2023.
PMLR,2021.
Xie,C.,Koyejo,O.,andGupta,I. Fallofempires:Breaking
Kovalev, D., Salim, A., and Richta´rik, P. Optimal and byzantine-tolerant sgd by inner product manipulation.
practicalalgorithmsforsmoothandstronglyconvexde- In Uncertainty in Artificial Intelligence, pp. 261–270.
centralizedoptimization.AdvancesinNeuralInformation PMLR,2020.
ProcessingSystems,33:18342–18352,2020.
Yin,D.,Chen,Y.,Kannan,R.,andBartlett,P. Byzantine-
Kuwaranancharoen,K.andSundaram,S. Onthegeometric robustdistributedlearning: Towardsoptimalstatistical
convergenceofbyzantine-resilientdistributedoptimiza- rates. InInternationalConferenceonMachineLearning,
tionalgorithms. arXivpreprintarXiv:2305.10810,2023. pp.5650–5659.PMLR,2018.
Lamport, L., Shostak, R., and Pease, M. The byzantine
generalsproblem. ACMTransactionsonProgramming
LanguagesandSystems,4(3):382–401,1982.
11Byzantine-RobustGossip:InsightsfromaDualApproach
InthisAppendix,weprovidesomecomplementaryelementsonthecontentonthepaper. Inparticular,inAppendixB,we
provideproofsoftheresultsgiveninthepaper.
A.Additionalexperiments
Heterogeneity/biasdecomposition. InFigure2wedisplaytheevolutionofthemean-squareerror(MSE) Xt X∗ 2,of
∥ h− h∥F
theheterogeneity Xt Xt andofthebias Xt X∗ alongthecommunicationprocesswithinafully-connectedgraph
with 1 ofByzantin∥ enh e− ighbh o∥ rsF underaConsens| ush at− tackh .| Weseethatallaggregationrulesarerobustinthissetting,andthat
9
theGlobalClippingruleperformsthebestevenifitdoesnotallowstoreachconsensus. Wenotethatforlocalaggregation
rulestheMSEisnotmonotone,asanadditionalbiasispaidforreachingconsensus. Hencetheconsensusisachievedunder
thepriceofthisbias. Thisraisesthequestionoftherelevanceofseekingonlydecentralizedcommunicationalgorithmthat
aimsatreachingasymptoticconsensus,asallowingapproximateagreementcanbeawaytoreducethebias. Notethatwe
displayedhereonlytheConsensusattack,buttheconclusionwouldbethesamefortheotherattacksdescribedinSection6.
LocalClippingOurs LocalClipping[Heetal. 2022] LocalTrimming Global GlobalApprox
100
0.4
10−2
0.3
100
10−4
0.2
10−6
0.1
10−8
0.0
0 5 10 15 20 0 5 10 15 20 0 5 10 15 20
Iterations Iterations Iterations
Figure2. Consensusattackinafully-connectedgraphwith16honestand2Byzantinenodes.
Sparsegraph. WeconsidernowamodifiedTorustopology,withoneadditionalhonestnodeconnectedwitheveryone.
Hence,inthisgraph,eachhonestnodeisconnectedto5otherhonestnodes,apartfromonewhichisconnectedtoevery
otherhonestnodes. InFigure3wetestallattacksinthisTorustopology,with15honestnodesintheTorus,onehonest
principalnodes,and2Byzantineneighborsperhonestnode. Inthissetting∆ 1.5,suchthattheGlobalClippingrules
∞
≈
enforcenocommunication. InthissettingSPattackistheonlyonethatdisrupttheLocalClippingstrategyof(Heetal.,
2022).
Noattack Dissension SpectralHeterogeneity Consensus
101
100
10−1
10−2
0 20 40 60 0 20 40 60 0 20 40 60 0 20 40 60
Iterations Iterations Iterations Iterations
LocalClippingOurs LocalClipping[Heetal. 2022] LocalTrimming Global GlobalApprox
Figure3.DifferentattacksinaTorustopologywithanadditionnalhonestprincipalnode.Thegraphiscomposedof16honestnodes,each
having2Byzantineneighbors.
12
ESM
ESM
ytienegoreteH
saiBByzantine-RobustGossip:InsightsfromaDualApproach
B.Proofs
B.1.ProofofGlobalClippingRule(GCR)Theorem3.7
B.1.1.NOTATIONS
Inthissubsectionweresumethedifferentnotationsoftheproofs.
Werecallthealgorithmintheglobalclippingsetting:
Xt+1 =Xt η(C C )Clip(CTXt;τt)
h h− h b
Xt+1 = .
b ∗
Intheglobalclippingsetting,weconsiderthat,asτt =τt1 E,wecanoverloadtheclippingoperatorswritingforΛ
h
REh×d
andΛ
b
REb×d, ∈
∈
Clip(Λ ;τt)=[Clip(λ ,τt)] (19)
h (i∼j) (i∼j)∈Eh
Clip(Λ ;τt)=[Clip(λ ,τt)] (20)
b (i∼j) (i∼j)∈Eb
Weusethefollowingnotations:
• ForanymatrixM RVh×d,wedenote
∈ 1
M := 1 1T M.
n nh nh
h
• Wenotetheprimalparameterre-centeredonthesolution
Zt :=Xt X∗.
h h− h
• TheunitarymatrixofattacksdirectionsonByzantineedge
1
Ut := (Λt+1 Λt).
b ητt b − b
Thus Ut ⩽1andΛt+1 =Λt ηClip([CTXt] ;τt)=Λt +ητtUt.
∥ b∥∞,2 b b− b b b
• TheerrorterminducedbyclippingandByzantinenodes
Et :=C (cid:0) CTZt Clip(CTZt;τt)(cid:1) +τtC Ut,
h h h− h h b b
• Wedenoteforp 1,2 andκt 0,...,
h
∈{ } ∈{ |E |}
(cid:88)
CTXt p := (CTXt) p
∥ h h∥p;κt ∥ h h (i∼j) ∥2
(i∼j)∈Eh, κtlargest
CTXt p := CTXt p CTXt p .
∥ h h∥p;−κt ∥ h h∥p−∥ h h∥p;κt
• Werecallthatbydefault and istheusualEuclideannorm(ortheFrobeniusnormincaseofmatrix).
2
∥·∥ ∥·∥
Andwerecallsomepreviousfacts:
• L =C CT = 1C˜ C˜T theLagrangianmatrixonthehonestsubgraph .
h h h 2 h h Gh
• CT1 =0 = CTXt =0 = CTXt =CTZt .
h nh ⇒ h h ⇒ h h h h
• C† istheMoore-PenrosepseudoinverseofC .
h h
13Byzantine-RobustGossip:InsightsfromaDualApproach
B.1.2.ANALYSISOFGLOBALCLIPPINGRULE(GCR)THEOREM3.7
LemmaB.1. (Gossip-Errordecomposition) Theiterateupdatecanbedecomposedas
Zt+1 =(I ηL )Zt +ηEt.
h h − h h
Proof. TheactualizationofXt writes
h
Xt+1 =Xt ηC Clip(CTXt;τt) ηC Clip([CTXt] ;τt).
h h− h h h − b b
UsingCTXt =CTZt,weget
h h h h
Zt+1 =Zt ηC Clip(CTXt;τt)+ητtC Ut
h h− h h h b b
=(I ηC CT)Zt +η(cid:8) C (cid:0) CTZt Clip(CTZt;τt)(cid:1) +τtC Ut(cid:9)
h − h h h h h h− h h b b
=(I ηL )Zt +ηEt.
h − h h
LemmaB.2. (Sufficientdecreaseonthevariance) Wehavethedecompositionofthevarianceasabiasedgradientdescent:
Zt+1 Zt 2 = Zt Zt 2+η2 L Zt Et 2 2η CTZt 2+2η Zt Zt,Et .
∥ h − h∥ ∥ h− h∥ ∥ h h− ∥ − ∥ h h∥ ⟨ h− h ⟩
Proof. westartfromLemmaB.1
Zt+1 Zt 2 = Zt Zt η(L Zt Et) 2
∥ h − h∥ ∥ h− h− h h− ∥
= Zt Zt 2+η2 L Zt Et 2 2η L Zt,Zt Zt +2η Zt Zt,Et
∥ h− h∥ ∥ h h− ∥ − ⟨ h h h− h⟩ ⟨ h− h ⟩
= Zt Zt 2+η2 L Zt Et 2 2η CTZt 2+2η Zt Zt,Et ,
∥ h− h∥ ∥ h h− ∥ − ∥ h h∥ ⟨ h− h ⟩
whereweusedthatCTZt =0andC CT =L .
h h h h h
LemmaB.3. (completesufficientdecrease)
Zt+1 2 = Zt 2+η2 L Zt Et 2 2η CTZt 2+2η Zt Zt,Et +2 Zt,Zt+1 Zt .
∥ h ∥ ∥ h∥ ∥ h h− ∥ − ∥ h h∥ ⟨ h− h ⟩ ⟨ h h − h⟩
Proof. Weleveragethat
Zt+1 2 = Zt+1 Zt +Zt 2
∥ h ∥ ∥ h − h h∥
= Zt+1 Zt 2+ Zt 2+2 Zt,Zt+1 Zt
∥ h − h∥ ∥ h∥ ⟨ h h − h⟩
= Zt+1 Zt 2+ Zt 2+2 Zt,Zt+1 Zt .
∥ h − h∥ ∥ h∥ ⟨ h h − h⟩
ThenweuseLemmaB.2.
AssumptionB.4. Definition3.3Trade-offbetweenclippingerrorandByzantineinfluence. Bydenoting
∆ := sup C†C U ,
∞ ∥ h b b ∥∞,2
Ub∈REb×d
∥Ub∥∞,2⩽1
Weassumethatτt =0,or
∥C hTX ht
∥κt
⩾∆
∞
∥C hTX ht ∥1+η|E nb |2 (cid:88) τs.
h 0⩽s⩽t
LemmaB.5. (Joincontrolofthefirstordererrorandsecondorderbias) UnderDefinition3.3,wehavethat
η Zt Zt,Et + Zt,Zt+1 Zt +η2 Et 2 ⩽η CTZt 2 ,
⟨ h− h ⟩ ⟨ h h − h⟩ ∥ ∥2 ∥ h h∥κt
orτt =0.
14Byzantine-RobustGossip:InsightsfromaDualApproach
Proof. Webeginbyupperboundingpreciselybotherrorterms:
1. Variance-inducederror.
Zt Zt,Et = Zt Zt,C (cid:0) CTZt Clip(CTZt;τt)(cid:1) + Zt Zt,τtC Ut
⟨ h− h ⟩ ⟨ h− h h h h− h h ⟩ ⟨ h− h b b⟩
= CTZt,CTZt Clip(CTZt;τt) + CTZt,τtC†C Ut . UsingthatCTZt =0.
⟨ h h h h− h h ⟩ ⟨ h h h b b⟩ h h
Ononesidewehavethat,
CTZt,CTZt Clip(CTZt;τt) = (cid:88) zt zt,zt zt Clip(zt zt;τt) = (cid:88) zt zt (cid:0) zt zt τt(cid:1) .
⟨ h h h h− h h ⟩ ⟨ i− j i− j− i− j ⟩ ∥ i− j∥2 ∥ i − j∥2 − +
(i∼j)∈Eh (i∼j)∈Eh
Onetheotherside,byusingthat,forM,N REh×d, M,N ⩽ M
1,2
N ∞,2,as:
∈ ⟨ ⟩ ∥ ∥ ∥ ∥
(cid:88)
M,N = M ,N
(i∼j) (i∼j)
⟨ ⟩ ⟨ ⟩
(i∼j)∈Eh
(cid:88)
⩽ M N
(i∼j) 2 (i∼j) 2
∥ ∥ ∥ ∥
(i∼j)∈Eh
(cid:88)
⩽ N M ,
∞,2 (i∼j) 2
∥ ∥ ∥ ∥
(i∼j)∈Eh
wecanupperboundthesecondterm
CTZt,τtC†C Ut ⩽τt CTZT C†C Ut .
⟨ h h h b b⟩ ∥ h h∥1,2 ∥ h b b∥∞,2
Thenbydefining∆ =sup C†C Ut ,using CTZt =(cid:80) zt zt ,wehavethat
∞ Ub∈REb×d ∥ h b b∥∞,2 ∥ h h∥1,2 (i∼j)∈Eh∥ i − j∥2
Zt Zt,Et ⩽ (cid:88) zt zt (cid:0) zt zt τt(cid:1) +τt∆ (cid:88) zt zt
⟨ h− h ⟩ ∥ i − j∥2 ∥ i − j∥2 − + ∞ ∥ i − j∥2
(i∼j)∈Eh (i∼j)∈Eh
 
(cid:88) (cid:88) (cid:88)
= ∥z it −z jt ∥2 21 ∥z it−z jt∥2>τt −τt  ∥z it −z jt ∥21 ∥z it−z jt∥2>τt −∆ ∞ ∥z it −z jt ∥2 2.
(i∼j)∈Eh (i∼j)∈Eh (i∼j)∈Eh
Let’sconsideranyκt Nsuchthat
∈
 
(cid:88) (cid:88)
κt ∈ 1 ∥z it−z jt∥2>τt, 1 ∥z it−z jt∥2⩾τt −1.
(i∼j)∈Eh (i∼j)∈Eh
Then,using
(cid:88)
CTZt p := zt zt p,
∥ h h∥p,κt ∥ i − j∥2
(i∼j)∈Eh
κtlargest
thepreviousinequalitywrites
Zt Zt,Et ⩽ CTZt 2 τt(cid:0) CTZt ∆ CTZt (cid:1) .
⟨ h− h ⟩ ∥ h h∥2,κt − ∥ h h∥1,κt − ∞ ∥ h h∥1
Fromthisupperboundwecouldderiveaclippingruletakingonlyintoaccounttheerrorinducedbyclippingand
Byzantinenodesonthevariance. Inthisanalysis,wewillincludetheseconderrorterminducedbythebias.
2. Bias-inducederror.
Weconsidertheterm Zt,Zt+1 Zt . Weremarkthat,usingthatZt+1 =(I C CT)Zt +ηEt,andconsidering
⟨ h h − h⟩ h h − h h h
that1T C =0,usingthedefinitionofEtweget:
nh h
t
(cid:88)
1T Zt+1 =1T Zt +ητt1T C Ut = ητs1T C Us.
nh h nh h nh b b nh b b
s=0
15Byzantine-RobustGossip:InsightsfromaDualApproach
Usingthis,weremarkthat
η2 Et 2 = Zt+1 Zt 2 = η2 Et 2+ Zt,Zt+1 Zt = Zt+1,Zt+1 Zt .
∥ ∥2 ∥ − ∥2 ⇒ ∥ ∥2 ⟨ h h − h⟩ ⟨ h h − h⟩
Thusweget
(cid:42) t (cid:43)
(cid:88) 1 1
Zt+1,Zt+1 Zt = ητs 1 1T C Us,ητt 1 1T C Ut
⟨ h h − h⟩ n nh nh b b n nh nh b b
h h
s=0
τtη2 (cid:88)t (cid:68) (cid:69)
= τs 1T C Us,1T C Ut
n nh b b nh b b
h
s=0
τtη2 (cid:88)t (cid:42) (cid:88) (cid:88) (cid:43)
= τs N (i)us, N (i)ut .
n b i b i
h
s=0 i∈Vh i∈Vh
WhereutisthemeanvectorofByzantineneighborsofnodei ,sothat ut ⩽1,thusweget
i ∈Vh ∥ i∥2
Zt,Zt+1 Zt ⩽ τtη2 (cid:88)t τs(cid:32) (cid:88) N (i)(cid:33)2 = η2τt |Eb |2 (cid:88)t τs.
⟨ h h − h⟩ n b n
h h
s=0 i∈Vh s=0
Nowthatwecontrolledbothterms,wecanmixbotherrorterms:
⟨Z ht −Z ht,Et ⟩+η−1 ⟨Z ht,Z ht+1 −Z ht ⟩⩽ ∥C hTZ ht ∥2 2,κt −τt(cid:0) ∥C hTZ ht ∥1,κt −∆ ∞ ∥C hTZ ht ∥1(cid:1) +τtη | nEb |2 (cid:88)t−1 τs
h
s=0
= ∥C hTZ ht ∥2 2,κt
−τt(cid:32)
∥C hTZ ht ∥1,κt −∆ ∞ ∥C hTZ ht ∥1
−
η
| nEb
|2 (cid:88)t τs(cid:33)
.
h
s=0
Hence,aslongas
∥C hTZ ht ∥1,κt ⩾∆ ∞ ∥C hTZ ht ∥1+
η
| nEb
|2 (cid:88)t
τs, (21)
h
s=0
wehavethat
Zt Zt,Et +η−1 Zt+1,Zt+1 Zt ⩽ CTZt 2 .
⟨ h− h ⟩ ⟨ h h − h⟩ ∥ h h∥2,κt
WhenEquation(21)cannotbeenforcedusingκt ⩽ 1,thenwetakeτt =0(thusκt = ),everythingisclipped
h h
|E |− |E |
andnodesparametersdon’tmoveanymore.
LemmaB.6. (Controloffirstand2ndordererrortermstogether) AssumeDefinition3.3andthat
1
η ⩽ ,
µ (L )
max h
thenbydenotingthefirstand2ndordererrorterm,dividedbyηas
ζt :=η L Zt Et 2+2 Zt Zt,Et +2η−1 Zt,Zt+1 Zt .
∥ h h− ∥ ⟨ h− h ⟩ ⟨ h h − h⟩
Wehavethecontrol:
ζt ⩽ηµ (L )(cid:0) CTZt 2 +(τt)2(cid:2) κt(1 2∆ )+∆2 (cid:3)(cid:1) +2 CTZt 2 .
max h ∥ h h∥2,−κt − ∞ ∞|Eh | ∥ h h∥2,κt
Proof. Thispartoftheproofallowstocomputethemaximumstepsizeusable. Wewanttocontrolthediscretizationterm
η2 L Zt Et 2. IfEt =0itwouldhavebeendoneusingastep-sizesmallenough. Inthiscasewewilldothesame,but
∥ h h− ∥2
wewillmonitortheinteractionsbetweenthediscretizationandthecontroloftheerror. Notethat
Et L Zt =C Clip(CTZt;τt)+τtC Ut, (22)
− h h h h h b b
16Byzantine-RobustGossip:InsightsfromaDualApproach
andthatatthefirstorder C Clip(CTZt;τt),τtC Ut ⩽ 0ifByzantineaimsatpreventingtheconvergence. Thus,we
⟨ g g h b b⟩
willincludethissecond-ordertermintheproofoftheLemmaB.2.
Wedenotebyµ (L )thelargesteigenvalueofL .
max h h
Wedenotethefirstand2ndordererrorterm,dividedbyηas
ζt :=η L Zt Et 2+2 Zt Zt,Et +2η−1 Zt,Zt+1 Zt .
∥ h h− ∥ ⟨ h− h ⟩ ⟨ h h − h⟩
Hence Zt+1 2 ⩽ Zt 2+ηζt 2η CTZt 2.
∥ h ∥ ∥ h∥ − ∥ h h∥
Using
Et L Zt = C (Clip(CTZt;τt) τtC†C Ut)+Et 2 = C (Clip(CTZt;τt) τtC†C Ut) 2+ Et 2,
∥ − h h∥ ∥ h h h − h b b ∥ ∥ h h h − h b b ∥ ∥ ∥
wehave:
ζt =η C (Clip(CTZt;τt) τtC†C Ut) 2+η Et 2
∥ h h h − h b b ∥2 ∥ ∥2
+2 Zt Zt,Et +2η−1 Zt,Zt+1 Zt
⟨ h− h ⟩ ⟨ h h − h⟩
(cid:16) (cid:17)
⩽ηµ (L ) Clip(CTZt;τt) 2+ τtC†C Ut 2 2ηµ (L ) Clip(CTZt) CTZt +CTZt,τtC†C Ut
max h ∥ h h ∥ ∥ h b b∥ − max h ⟨ h h − h h h h h b b⟩
+2 CTZt,τtC†C Ut +2 CTZt,CTZt Clip(CTZt;τt) +2η−1 Zt+1,Zt+1 Zt
⟨ h h h b b⟩ ⟨ h h h h− h h ⟩ ⟨ h h − h⟩
(cid:16) (cid:17)
=ηµ (L ) Clip(CTZt;τt) 2+ τtC†C Ut 2
max h ∥ h h ∥ ∥ h b b∥
+2 CTZt,CTZt Clip(CTZt;τt) +2η−1 Zt+1,Zt+1 Zt
⟨ h h h h− h h ⟩ ⟨ h h − h⟩
+2(1 ηµ (L )) CTZt,τtC†C Ut +2ηµ (L ) CTZt Clip(CTZt;τt),τtC†C Ut .
− max h ⟨ h h h b b⟩ max h ⟨ h h− h h h b b⟩
(cid:124) (cid:123)(cid:122) (cid:125) (cid:124) (cid:123)(cid:122) (cid:125)
⩽∥C hTZ ht∥1∆∞τt ⩽∥C hTZ ht−Clip(C hTZ ht;τt)∥1∆∞τt
Thenweusethat
CTZt Clip(CTZt;τt) = CTZt Clip(CTZt;τt) ,
∥ h h− h h ∥1 ∥ h h∥1 −∥ h h ∥1
toget,forη ⩽µ (L ),
max h
(cid:16) (cid:17)
ζt ⩽ηµ (L ) Clip(CTZt;τt) 2+ τtC†C Ut 2
max h ∥ h h ∥ ∥ h b b∥
+2 CTZt,CTZt Clip(CTZt;τt) +2η−1 Zt+1,Zt+1 Zt
⟨ h h h h− h h ⟩ ⟨ h h − h⟩
+2(1 ηµ (L )) CTZt ∆ τt+2ηµ (L ) CTZt ∆ τt 2ηµ (L ) Clip(CTZt;τt) ∆ τt
− max h ∥ h h∥1 ∞ max h ∥ h h∥1 ∞ − max h ∥ h h ∥1 ∞
(cid:16) (cid:17)
⩽ηµ (L ) Clip(CTZt;τt) 2+ τtC†C Ut 2 2 Clip(CTZt;τt) ∆ τt
max h ∥ h h ∥ ∥ h b b∥ − ∥ h h ∥1 ∞
+2 CTZt,CTZt Clip(CTZt;τt) +2 CTZt ∆ τt+2η−1 Zt+1,Zt+1 Zt.
⟨ h h h h− h h ⟩ ∥ h h∥1 ∞ ⟨ h h − h ⟩
Then,thesecondtermiscontrolledusingtheproofofLemmaB.5.
Bydenoting
∆2 := sup C†C Ut 2,
2
∥U
bt∥∞,2⩽1∥ h b b∥2
wehavethat,underDefinition3.3
ζt ⩽ηµ (L )(cid:0) CTZt 2 +τt(cid:0) τtκt+τt∆2 2τtκt∆ 2∆ CTZt (cid:1)(cid:1) +2 CTZt 2
max h ∥ h h∥2,−κt 2− ∞ − ∞ ∥ h h∥1,−κt ∥ h h∥2,κt
⩽ηµ (L )(cid:0) (1 ∆ ) CTZt 2 +(τt)2(cid:2) κt(1 2∆ )+∆2(cid:3)(cid:1) +2 CTZt 2 .
max h − ∞ ∥ h h∥2,−κt − ∞ 2 ∥ h h∥2,κt
17Byzantine-RobustGossip:InsightsfromaDualApproach
Eventually,leveragingthat∆2 ⩽∆2 ,wehave
2 ∞|Eh |
ζt ⩽ηµ (L )(cid:0) CTZt 2 +(τt)2(cid:2) κt(1 2∆ )+∆2 (cid:3)(cid:1) +2 CTZt 2 .
max h ∥ h h∥2,−κt − ∞ ∞|Eh | ∥ h h∥2,κt
TheoremB.7. Hence,underDefinition3.3,for
µ (L )−1
η ⩽ max h ,
1+ (1 ∆ )
h ∞
|E | −
wehave
Zt+1 2 ⩽ Zt 2 η CTZt 2 .
∥ h ∥ ∥ h∥ − ∥ h h∥2,−κt
Proof. WestartfromLemmaB.3andusethemajorationoftheerrorfromLemmaB.6:
Zt+1 2 = Zt 2 2η CTZt 2+η2 L Zt Et 2+2η Zt Zt,Et +2 Zt,Zt+1 Zt
∥ h ∥ ∥ h∥ − ∥ h h∥ ∥ h h− ∥ ⟨ h− h ⟩ ⟨ h h − h⟩
⩽ Zt 2η CTZt 2++2η CTZt 2
∥ h∥− ∥ h h∥2 ∥ h h∥2,κt
+η2µ (L )(cid:0) CTZt 2 +(τt)2(cid:2) κt(1 2∆ )+∆2 (cid:3)(cid:1)
max h ∥ h h∥2,−κt − ∞ ∞|Eh |
= Zt 2η CTZt 2
∥ h∥− ∥ h h∥2,−κt
+η2µ (L )(cid:0) CTZt 2 +(τt)2(cid:2) κt(1 2∆ )+∆2 (cid:3)(cid:1)
max h ∥ h h∥2,−κt − ∞ ∞|Eh |
⩽ Zt η(cid:2) 2 ηµ (L )(cid:0) 1+κt(1 2∆ )+∆2 (cid:1)(cid:3) CTZt 2 .
∥ h∥− − max h − ∞ ∞|Eh | ∥ h h∥2,−κt
Whereweusedthat,asκt ⩽(cid:80) (i∼j)∈Eh1
∥z it−z jt∥⩾τt
−1,thelargesttermin ∥C hTZ ht ∥2
2,−κt
is(τt)2.
Hence,for
µ (L )−1
η ⩽ max h ,
1+κt(1 2∆ )+∆2
−
∞ ∞|Eh
|
or,usingasimpler(andstricter)condition
µ (L )−1
η ⩽ max h ,
1+ (1 ∆ )
h ∞
|E | −
wehave
Zt+1 2 ⩽ Zt 2 η CTZt 2 .
∥ h ∥ ∥ h∥ − ∥ h h∥2,−κt
B.1.3.COMPUTINGSIGNIFICANTQUANTITIES
Werecallthat
∆ := sup C†C U .
∞ ∥ h b b ∥∞,2
Ub∈REb×d
∥Ub∥∞,2⩽1
PropositionB.8. (Computing∆ ) Considerafullyconnectedgraph ,wehavethat
∞
G
∆ ⩽ sup
2n b(cid:112)
d ,
∞ n ∧|Eb |
(i∼j)∈Eh h
wheren isthenumberofByzantinesnodesandn thenumberofhonestnodes.
b h
18Byzantine-RobustGossip:InsightsfromaDualApproach
Proof. InafullyconnectedgraphL =n I 1 1T,thusC† =CTL† = 1 CT. Usingthis,wecompute:
h h h − h h h h h nh h
∆ = sup C†C U
∞ ∥ h b b ∥∞,2
Ub∈REb×d
∥Ub∥∞,2⩽1
1
= sup sup [CTC U ] .
n ∥ h b b (i∼j),: ∥2
h Ub∈REb×d (i∼j)∈Eh
∥Ub∥∞,2⩽1
For(i j) ,
h
∼ ∈E
d
(cid:88)(cid:16) (cid:17)2
sup [CTC U ] 2 = sup [CTC ]T [U ]
∥ h b b (i∼j),: ∥2 h b (i∼j),: b :,k
Ub∈REb×d Ub∈REb×d
k=1
∥Ub∥∞,2⩽1 ∥Ub∥∞,2⩽1
d
= sup (cid:88)(cid:0) [[C ] [C ] ]T[U ] (cid:1)2
b i,: b j,: b :,k
−
Ub∈REb×d
k=1
∥Ub∥∞,2⩽1
d
(cid:88)
⩽ sup [[C ] [C ] ] 2 [U ] 2
∥ b i,: − b j,: ∥1∥ b :,k ∥∞
Ub∈REb×d
k=1
∥Ub∥∞,2⩽1
d
(cid:88)
⩽(N (i)+N (j))2 sup [U ] 2
b b ∥ b :,k ∥∞
Ub∈REb×d
k=1
∥Ub∥∞,2⩽1
⩽(N (i)+N (j))2(d ).
b b b
∧|E |
Hence,weget:
∆ ⩽ sup
N b(i)+N b(j)(cid:112)
d .
∞ n ∧|Eb |
(i∼j)∈Eh h
Thus,assumingthat,asweareinafully-connectedgraph,everyhonestnodeisconnectedton Byzantinenode,wegetthe
b
result
PropositionB.9(SimplifiedGCR). If(τt) t⩾0issuchthat: forallt⩾0,eitherτt =0or
κt ⩾∆ +η|Eb
|2 (cid:88)τs
, (23)
∞ |Eh | n τt
h s⩽t
then(τs) s⩾0satisfiestheGCR.
Proof. (GCR),i.eEquation(21)writes
∥C hTZ ht ∥1,κt ⩾∆ ∞ ∥C hTZ ht ∥1+
η
| nEb
|2 (cid:88)t
τs.
h
s=0
19Byzantine-RobustGossip:InsightsfromaDualApproach
Weleveragethat CTZt ⩾τtκtandthat CTZt ⩽τt( κt)towrite
∥ h h∥1,κt ∥ h h∥1,−κt |Eh |−
∥C hTZ ht ∥1,κt ⩾∆ ∞ ∥C hTZ ht ∥1+
η
| nEb
|2 (cid:88)t
τs
⇐⇒
(1 −∆ ∞) ∥C hTZ ht ∥1,κt ⩾∆ ∞ ∥C hTZ ht ∥1,−κt +
η
| nEb
|2 (cid:88)t
τs
h h
s=0 s=0
=(1 ∆ )κtτt ⩾∆ τt( κt)+
η
|Eb
|2 (cid:88)t
τs
⇐ − ∞ ∞ |Eh |− n
h
s=0
κtτt ⩾∆ τt +
η
|Eb
|2 (cid:88)t
τs
⇐⇒ ∞ |Eh | n
h
s=0
κt ⩾∆ +
η
|Eb
|2 (cid:88)t τs
.
⇐⇒ ∞ |Eh | n τt
h
s=0
B.2.Proofoflocalclippingandlocaltrimming (Section4)
B.2.1.NOTATIONS
Werecallthefollowingnotations:
• τt RE˜ thevectorofthresholdsondirectededges. Wedecomposeitbetweenhonestandbyzantinenodesτt =
(τt∈ ,τt)withτt RE˜ h andτt RE˜ b.
h b h ∈ b ∈
• Weconsiderthattheclippingthresholdisconstantoneachdirectededgespointingonthesamenode: τt =[τt] .
i j→i∈E˜
• At :=B˜ bClip( ∗;τt b) ∈RVh×dthematrixofattacksofByzantinenodesattimet.
• Foranyhonestnodei ,wedenote
h
[At] =τtN (i)ut,w∈ heV re ut ⩽1istheaveragedirectionofattacksofByzantineneighborsofnodei.
i,: i b i ∥ i∥2
• Wedenote
Zt :=Xt X∗.
h h−
Thealgorithmwrites
(cid:16) (cid:17)
Xt+1 =Xt ηB˜ Clip C˜TXt;τt +ηAt.
h h− h h h h
RecallthatC˜TXt =C˜TZt =[zt zt] . Thususing
h h h h i − j j→i∈E˜
(cid:104) (cid:16) (cid:17)(cid:105)
Et :=B˜ C˜TZt Clip C˜TZt;τt +ηAt,
h h h− h h h
thealgorithmwrites
(cid:40)
Z0 =X∗ X∗
h h− h (24)
Zt+1 =(I ηL )Zt +ηEt.
h h − h h
B.2.2.ANALYSIS
LemmaB.10. (Controloftheerror,caseoflocalclipping)
TheerrorcanbecontroledusingthemaximalnumberofByzantineneighborsofanhonestnodeandaflowmatrix.
Et 2 ⩽2maxN (i) C˜TZt 2
∥ ∥2 i∈Vh b ∥ h h∥2
20Byzantine-RobustGossip:InsightsfromaDualApproach
Proof. Byapplyingtriangleinequalityweget
(cid:13) (cid:13)2
(cid:13) (cid:13)
∥Et ∥2 = (cid:88) (cid:13) (cid:13)
(cid:13)
(cid:88) (cid:8) z it −z jt −Clip(z it −z jt;τ it)(cid:9) +τ itN b(i)ut i(cid:13) (cid:13)
(cid:13)
i∈Vh(cid:13)j→i∈E˜
h
(cid:13)
2
 2
⩽ (cid:88)  (cid:88) (cid:0) ∥z it −z jt ∥2 −τ it(cid:1) ++τ itN b(i)
i∈Vh j→i∈E˜
h
Wedefineτtsuchthatnodeiclipexactly2N (i)ofhisneighbors:
i b
(cid:88)
1 =2N (i).
∥z it−z jt∥2⩾τ it b
j→i∈E˜
Hence,wecanboundthenumberofhonestnodesclippedas
(cid:88)
1 [N (i),2N (i)].
∥z it−z jt∥2⩾τ it
∈
b b
j→i∈E˜
h
Thusweget
  2
(cid:88) (cid:88) (cid:88)
∥Et ∥2 ⩽  ∥z it −z jt ∥21 ∥z it−z jt∥2⩾τ it +τ it N b(i)
−
1 ∥z it−z jt∥2⩾τ it
i∈Vh j→i∈E˜
h
j→i∈E˜
h
 2
(cid:88) (cid:88)
⩽  ∥z it −z jt ∥21 ∥z it−z jt∥2⩾τ it .
i∈Vh j→i∈E˜
h
Which,usingCauchy-Schwarzinequalitygives
 
(cid:88) (cid:88) (cid:88)
∥Et ∥2 ⩽  ∥z it −z jt ∥2 21 ∥z it−z jt∥2⩾τ it 1 ∥z it−z jt∥2⩾τ it
i∈Vh j→i∈E˜
h
j→i∈E˜
h
 
(cid:88) (cid:88)
⩽ 2N b(i) ∥z it −z jt ∥2 2
i∈Vh j→i∈E˜
h
Et 2 ⩽2maxN (i) (cid:88) zt zt 2 =2maxN (i) C˜TZt 2
∥ ∥ i∈Vh b
(i∼j)∈E˜
h∥ i − j∥2 i∈Vh b ∥ h h∥2
Recall that we denote µ (L ) and µ+ (L ) are the largest and smallest non-zero eigenvalues of the honest-graph
max h min h
LaplacianL ,asdefinedinExample2.3.
h
Next,weintroducethefollowingquantity,thatcapturestheimpactofByzantineagentsinthelocal-clippingcase.
max N (i)
δ := i b . (25)
∞ µ (L)
max
Theorem B.11. Linear convergence of the variance Under Definition 4.3 and Assumption 4.4, by using a step size
η = 2 ,thevarianceofnodesparametersconvergeslinearlyto0:
µmax+µ+
min
(cid:18) (cid:18) (cid:19)(cid:19)
2γ 2√δ
Xt+1 Xt ⩽ 1 1 ∞ Xt Xt .
∥ − ∥2 − 1+γ − γ ∥ − ∥2
21Byzantine-RobustGossip:InsightsfromaDualApproach
Proof. Wehavethat
Zt+1 Zt =(I ηL )(Zt Zt)+ηEt.
h − h h − h h− h
Hence,bydenotingµ =µ ⩾...⩾µ =µ+ ⩾µ =0theeigenvaluesoftheLaplacienmatrixL ,usingthat
max 1 nh−1 min n h
C˜TC˜T =2L ,weget:
h h h
(cid:113) (cid:113)
Et ⩽ 4µ maxN (i) CTZt ⩽ 4µ maxN (i) Zt Zt
∥ ∥2 max i∈Vh b ∥ h h∥2 max i∈Vh b ∥ h− h∥2
weget:
(cid:113)
Zt+1 Zt ⩽ sup (1 ηµ ) Zt Zt +η 4µ maxN (i) Zt Zt
∥ h − h∥2 i∈[n−1] − i ∥ h− h∥2 max i∈Vh b ∥ h− h∥2
Thus,bytakingη = 2 wegetthestatedresult.
µ min++µmax
Corollary B.12. Control of the bias term Under the same assumptions as Theorem 4.5 the bias of honest nodes is
controlled.
(cid:13) (cid:13) (cid:13)Xt −X h∗(cid:13) (cid:13) (cid:13)⩽
γ
2√ 2δ √∞
δ
(cid:13) (cid:13)X h∗ −X h∗(cid:13) (cid:13)
∞
−
Proof. Bydenoting
(cid:18) (cid:18) (cid:19)(cid:19)
2γ 2√δ
β := 1 1 ∞
− 1+γ − γ
Accordingtotheprevioustheorem,wehave
Xt+1 Xt+1 2+ Xt+1 Xt 2 = Xt+1 Xt ⩽β2 Xt Xt 2
∥ h − h ∥ ∥ h − h∥ ∥ h − h∥ ∥ h− h∥
Hence,bynotingd2 := Xt+1 Xt 2andv2 := Xt Xt 2,wehave:
t+1 ∥ h − h∥ t ∥ h− h∥
v2 +d2 ⩽β2v2
t+1 t+1 t
v2 ⩽β2v2 = v ⩽βtv
t+1 t ⇒ t 0
√
Bydenotingν := 4 δ∞,wecanupperboundonestepofbiasbythevarianceusing:
1+γ
1 (cid:113)
Zt+1 Zt =η 1Te ⩽η Et ⩽η 4maxN (i) CTxt ⩽ν Zt Zt .
∥ h − h∥ ∥√n h t ∥ ∥ ∥ i b ∥ h ∥ ∥ h− h∥
d ⩽νv ⩽νβtv
t+1 t 0
(cid:88)T T (cid:88)−1 ν(1 βT)
= d ⩽ν v ⩽ − v
⇒ t t 1 β 0
t=1 t=0 −
Thuswehave
T
(cid:88) ν
XT X0 ⩽ d ⩽ v
∥ h − h∥ t 1 β 0
t=1 −
byconsideringthat
ν 4√δ 2√δ
= ∞ = ∞
1 β 2γ(1 2γ−1√δ ) γ 2√δ
∞ ∞
− − −
wegettheresult.
22Byzantine-RobustGossip:InsightsfromaDualApproach
LemmaB.13. (controloftheerror, caseoflocaltrimming) Theerrorcanbecontroledusingthemaximalnumberof
Byzantineneighborsofanhonestnodeandaflowmatrix.
Et 2 ⩽8maxN (i) C˜TZt 2
∥ ∥2 i∈Vh b ∥ h h∥2
Proof. Byapplyingtriangleinequalityweget
(cid:13) (cid:13)2
(cid:13) (cid:13)
∥Et ∥2 = (cid:88) (cid:13) (cid:13)
(cid:13)
(cid:88) (cid:8) z it −z jt(cid:9)1 ∥z it−z jt∥⩾τ it +τ itN b(i)ut i(cid:13) (cid:13)
(cid:13)
i∈Vh(cid:13)j→i∈E˜
h
(cid:13)
2
 2
(cid:88) (cid:88)
⩽  ∥z it −z jt ∥21 ∥z it−z jt∥⩾τ it +τ itN b(i)
i∈Vh j→i∈E˜
h
Wedefineτtsuchthatnodeitrimexactly2N (i)ofhisneighbors:
i b
(cid:88)
1 =2N (i).
∥z it−z jt∥2⩾τ it b
j→i∈E˜
Hence,wecanboundthenumberofhonestnodestrimmedas
(cid:88)
1 [N (i),2N (i)].
∥z it−z jt∥2⩾τ it
∈
b b
j→i∈E˜
h
AndwecanupperboundtheinfluenceoftheByzantinebytheerrorduetotrimmingonhonestnodes:
(cid:88)
τtN (i)⩽ zt zt 1 .
i b ∥ i − j∥2 ∥z it−z jt∥2⩾τ it
j→i∈E˜
h
Thusweget
 2
(cid:88) (cid:88)
∥Et ∥2 ⩽ 2 ∥z it −z jt ∥21 ∥z it−z jt∥2⩾τ it
i∈Vh j→i∈E˜
h
 2
(cid:88) (cid:88)
⩽4  ∥z it −z jt ∥21 ∥z it−z jt∥2⩾τ it .
i∈Vh j→i∈E˜
h
Which,usingCauchy-Schwarzinequalitygives
 
(cid:88) (cid:88) (cid:88)
∥Et ∥2 ⩽4  ∥z it −z jt ∥2 21 ∥z it−z jt∥2⩾τ it 1 ∥z it−z jt∥2⩾τ it
i∈Vh j→i∈E˜
h
j→i∈E˜
h
 
(cid:88) (cid:88)
⩽4 2N b(i) ∥z it −z jt ∥2 2
i∈Vh j→i∈E˜
h
Et 2 ⩽8maxN (i) (cid:88) zt zt 2 =8maxN (i) C˜TZt 2
∥ ∥ i∈Vh b
(i∼j)∈E˜
h∥ i − j∥2 i∈Vh b ∥ h h∥2
RemarkB.14. Notethatwedidnottrytooptimizetheconstant8inthecaseoftrimming,trimminglessneighborsmight
allowtohaveabetterconstant. Yet,trimmingthisnumberofneighborscorrespondstotheruleproposedinFarhadkhani
etal.(2023).
23Byzantine-RobustGossip:InsightsfromaDualApproach
TheoremB.15. Assumethatδ ⩽ γ2 then,byusinglocaltrimmingaggregation,thevarianceconvergeslinearlytozero:
∞ 8
(cid:13) (cid:13) (cid:13)Xt −Xt(cid:13) (cid:13) (cid:13) 2 ⩽(cid:18) 1 − 12 +γ γ (cid:18) 1 − 4√ γδ ∞(cid:19)(cid:19)t (cid:13) (cid:13)X h∗ −X h∗(cid:13) (cid:13) 2.
Andthebiasiscontrolledas:
(cid:13) (cid:13) (cid:13)Xt −X h∗(cid:13) (cid:13) (cid:13) 2 ⩽ γ 4√ 4δ √∞ δ ∞ (cid:13) (cid:13)X h∗ −X h∗(cid:13) (cid:13) 2
−
Proof. WeusethesameproofasforTheoremB.11andCorollaryB.12,consideringthat,accordingtoLemmaB.13theonly
differenceisthat
Et ⩽(cid:113) 8maxN (i) C˜TZt ,
∥ ∥ i∈Vh b ∥ h h∥2
insteadof
Et ⩽(cid:113) 2maxN (i) C˜TZt .
∥ ∥ i∈Vh b ∥ h h∥2
24
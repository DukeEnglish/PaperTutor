PublishedasaconferencepaperatICLR2024
ENABLING EFFICIENT EQUIVARIANT OPERATIONS IN
THE FOURIER BASIS VIA GAUNT TENSOR PRODUCTS
ShengjieLuo1†∗ TianlangChen2∗ AditiS.Krishnapriyan2
1PekingUniversity 2UniversityofCalifornia,Berkeley †Projectlead
ABSTRACT
DevelopingequivariantneuralnetworksfortheE(3)groupplaysanimportantrole
inmodeling3Ddataacrossreal-worldapplications. Enforcingthisequivariance
primarily involves the tensor products of irreducible representations (irreps).
However,thecomputationalcomplexityofsuchoperationsincreasessignificantly
ashigher-ordertensorsareused. Inthiswork,weproposeasystematicapproach
tosubstantiallyacceleratethecomputationofthetensorproductsofirreps. We
mathematicallyconnectthecommonlyusedClebsch-Gordancoefficientstothe
Gauntcoefficients,whichareintegralsofproductsofthreesphericalharmonics.
Through Gaunt coefficients, the tensor product of irreps becomes equivalent to
themultiplicationbetweensphericalfunctionsrepresentedbysphericalharmonics.
Thisperspectivefurtherallowsustochangethebasisfortheequivariantoperations
fromsphericalharmonicstoa2DFourierbasis. Consequently,themultiplication
betweensphericalfunctionsrepresentedbya2DFourierbasiscanbeefficiently
computed via the convolution theorem and Fast Fourier Transforms. This
transformation reduces the complexity of full tensor products of irreps from
O(L6)toO(L3),whereListhemaxdegreeofirreps. Leveragingthisapproach,
we introduce the Gaunt Tensor Product, which serves as a new method to
constructefficientequivariantoperationsacrossdifferentmodelarchitectures. Our
experimentsontheOpenCatalystProjectand3BPAdatasetsdemonstrateboth
theincreasedefficiencyandimprovedperformanceofourapproach.
1 INTRODUCTION
Theimpositionofphysicalpriors, correspondingtospecificconstraints, hasplayedanimportant
role in deep learning (Jumper et al., 2021). To address the curse of dimensionality, prior works
exploitedthegeometryinherentindata,suchaspixelgridsinimagesoratomicpositionsinmolecules,
alongwiththeirassociatedsymmetries. Amongtheconstraintsintroducedbythesephysicalpriors,
equivariancehasemergedasanimportantconceptindeeplearning(Bronsteinetal.,2021).
Afunctionmappingwiththeequivarianceconstrainttransformstheoutputpredictablyinresponse
to transformations on the input. One typical class of such transformations includes translations,
rotations,andreflectionsintheEuclideanspace,collectivelytermedtheEuclideangroup(Rotman,
1995). Numerous fundamental real-world problems exhibit symmetries to the Euclidean group,
including molecular modeling (Atz et al., 2021), protein biology (Jumper et al., 2021), and 3D
vision (Weiler et al., 2018). Many works have developed a rich family of equivariant operations
fortheEuclideangroup(Hanetal.,2022),demonstratingpromiseinchallengingpredictiontasks
throughbothimproveddataefficiencyandgeneralization.
Amongthevariousapproachesforenforcingequivariantoperations(Cohen&Welling,2016;2017;
Coorsetal.,2018;Finzietal.,2020;Satorrasetal.,2021,seeAppendixBformoreadvances),em-
ployingtensorproductsofirreduciblerepresentations(irreps)hasrecentlyemergedasthedominant
choicefortheEuclideangroup(Thomasetal.,2018;Fuchsetal.,2020;Brandstetteretal.,2022;
Batzneretal.,2022;Liao&Smidt,2023;Musaelianetal.,2023). Rootedinthemathematicalfounda-
tionofrepresentationtheory,suchoperationsallowfortheprecisemodelingofequivariantmappings
betweenany2l+1-dimensionalirrepsspaceviaClebsch-Gordancoefficients(Wigner,2012),and
are proven to have universal approximation capability (Dym & Maron, 2021). These operations
havedrivenstate-of-the-artperformanceacrossavarietyofreal-worldapplications(Ramakrishnan
etal.,2014;Chmielaetal.,2017;Chanussotetal.,2021),demonstratingstrongempiricalresults.
∗Equal contribution. Correspondence to Tianlang Chen <tlchen@pku.edu.cn>, Shengjie Luo
<luosj@stu.pku.edu.cn>andAditiS.Krishnapriyan<aditik1@berkeley.edu>.
1
4202
naJ
81
]GL.sc[
1v61201.1042:viXraPublishedasaconferencepaperatICLR2024
The computational complexity inherent to computing the tensor products of irreps is a well-
acknowledged hurdle in achieving better efficiency, as well as greater accuracy (see comments
inFuchsetal.,2020;Schüttetal.,2021;Satorrasetal.,2021;Franketal.,2022;Batatiaetal.,2022b;
Brandstetteretal.,2022;Musaelianetal.,2023;Passaro&Zitnick,2023;Liaoetal.,2024;Simeon&
Fabritiis,2023;Wang&Chodera,2023;Hanetal.,2022;Zhangetal.,2023b). Recentadvancements
suggestthattheempiricalperformanceofstate-of-the-artmodelsbasedonsuchoperationscanbe
consistentlyboostedbyusinghigherdegreesofirreps(Batzneretal.,2022;Batatiaetal.,2022b;
Brandstetteretal.,2022;Passaro&Zitnick,2023;Liaoetal.,2024;Musaelianetal.,2023). However,
thefulltensorproductofirrepsuptodegreeLhaveanO(L6)complexity,whichsignificantlylimits
Lto2or3inpractice,hinderingefficientinferenceonlargesystems. Giventhis,thereisastrong
needtoimprovetheefficiencyofthetensorproductsofirreps.
Inthiswork, weintroduceasystematicmethodologytoacceleratethecomputationofthetensor
productsofirreps. OurkeyinnovationisestablishedontheobservationthattheClebsch-Gordan
coefficients are mathematically related to the integral of products of three spherical harmonics,
knownastheGauntcoefficients(Wigner,2012). Weusethistoshowthatthetensorproductofirreps
viatheGauntcoefficientsisequivalenttomultiplicationbetweensphericalfunctionsrepresented
by linear combinations of spherical harmonic bases. This understanding motivates us to employ
the2DFourierbasistoequivalentlyexpressthesamefunctionsviaachangeofbasis. Multiplications
between functions represented by 2D Fourier bases can be significantly accelerated through the
convolutiontheoremandFastFourierTransforms(FFT).Usingtheseinsights,thecomputational
costoffulltensorproductsofirrepsuptodegreeLcanbesubstantiallyreducedtoO(L3).
Buildinguponthisapproach,weintroducetheGauntTensorProduct,whichservesasanewmethod
for efficient equivariant operations across various model designs. We provide a comprehensive
studyonmajoroperationclassesthatarewidelyusedinequivariantmodelsfortheEuclideangroup,
demonstratingthegeneralityofourmethodandhowitcanbeusedtodesignefficientoperations:
• EquivariantFeatureInteractions. Operationsinthiscategorycalculatetensorproductsbe-
tweentwoequivariantfeatures,enablingtheinteractionbetweenirrepsfromdifferentdimen-
sionalspacesandobjects. Theseoperationshavebeenwidelyusedinrecentadvances(Unke
etal.,2021;Franketal.,2022;Yuetal.,2023b),e.g.,interactingatomicfeaturesandpre-
dictingaHamiltonianmatrix. Employingourapproachinthisscenarioisstraightforward.
• EquivariantConvolutions. Tensorproductsinthiscategoryarecomputedbetweenequiv-
ariantfeaturesandsphericalharmonicfilters,whicharethebuildingblocksforequivariant
messagepassing(Thomasetal.,2018;Fuchsetal.,2020;Batzneretal.,2022;Brandstetter
etal.,2022). Inthiscase,wedemonstratethatadditionalspeed-upcanbeachievedviathe
insightfromPassaro&Zitnick(2023),whichintroducessparsitytothefiltersviaarotation.
Weusethistofurtheracceleratetheconversionfromsphericalharmonicsto2DFourierbases.
• EquivariantMany-BodyInteractions. Modelingmany-bodyinteractioneffectshasbeen
showntobeimportantforadvancingmachinelearningforcefields(Drautz,2019;Dusson
etal.,2022;Batatiaetal.,2022a;b;Nigametal.,2022).Capturingtheseinteractionsrequires
performingmultipletensorproductsamongequivariantfeatures. Ourconnectionbetween
Clebsch-GordancoefficientsandGauntcoefficientsisnaturallygeneralizedtothissetting,
andwedevelopadivide-and-conquerapproachtoparallelizethecomputationofmultiple
2Dconvolutions,demonstratingbetterefficiencycomparedtooriginalimplementations.
Weconductextensiveexperimentstoverifytheefficiencyandgeneralityofourapproach. Foreach
of the aforementioned operation classes, we provide efficiency comparisons between our Gaunt
TensorProductandimplementationsviathee3nnlibrary(Geiger&Smidt,2022). Wealsoapply
ourGauntTensorProducttostate-of-the-artmodelsonbenchmarksacrosstasktypesandscales,e.g.,
forcefieldmodelingonOC20(Chanussotetal.,2021)and3BPA(Kovácsetal.,2021)benchmarks.
Allresultsshowboththebetterefficiencyandimprovedperformanceofourapproach.
2 BACKGROUND
Wereviewthenecessarybackgroundknowledgeforourmethod,includingconceptsoftheEuclidean
group and equivariance, irreducible representations (irreps), spherical harmonics, and the tensor
productofirreps. WeincludeallthedetailsofthemathematicsusedinthisworkinAppendixA.
2PublishedasaconferencepaperatICLR2024
LetS denoteasetofobjectslocatedinthethree-dimensionalEuclideanspace. WeuseX∈Rn×d
todenotetheobjectswithfeatures,wherenisthenumberofobjects,anddisthefeaturedimen-
sion. Givenobjecti, letr ∈ R3 denoteitsCartesiancoordinate. WedefineS = (X,R), where
i
R={r ,...,r }. Thesedatastructuresareinherentinavarietyofreal-worldsystems,suchasmolec-
1 n
ularsystemsandpointclouds.ProblemsdefinedonSgenerallyexhibitsymmetriestotransformations
ontheobjects.Forinstance,givenamolecularsystem,ifarotationisappliedtoeachatompositionr ,
i
thedirectionoftheforceoneachatomwillalsorotate.Mathematically,suchtransformationsandsym-
metriesaredirectlyrelatedtotheconceptsofgroupsandequivariancethatwewillintroducebelow.
EuclideangroupandEquivariance. Formally,agroupGisanon-emptyset,togetherwithabinary
operation◦ : G×G → Gsatisfyinggroupaxiomsthatdescribehowthegroupelementsinteract
witheachother. Theclassoftransformationsincludingtranslations,rotations,andreflectionsinthe
three-dimensional Euclidean space isof great interest, as it describes many real-world scenarios.
ThesetransformationsformagroupstructureknownastheEuclideangroup,anddenotedasE(3).
Todescribehowthegroupelementsactonvectorspaces,grouprepresentationsareused. Formally,
therepresentationofagroupGonavectorspaceV isamappingρV :G→GL(V),whereGL(V)
isthesetofinvertiblematricesonV. Forexample,representationsoftherotationgroupSO(3)on
R3 can be parameterized by orthogonal transformation matrices R ∈ R3×3,det(R) = 1, which
areappliedtox∈R3viamatrixmultiplicationRx.
We now introduce the concept of Equivariance. Let ϕ : X → Y denote a function mapping
between vector spaces. Given a group G, let ρX and ρY denote its representations on X and Y
respectively. Afunctionϕ : X →Y issaidtobeequivariantifitsatisfiesthefollowingcondition
ρY(g)[ϕ(x)] = ϕ(ρX(g)[x]), forallg ∈ G,x ∈ X. WhenρY = IY (identitytransformation)for
G,itisaspecialcaseofequivariance,knownasInvariance.
The equivariance constraint is a commonly exploited physical prior in machine learning models.
For tasks defined on the data structure S, it is typically important to ensure operations maintain
E(3)-equivariance. TheE(3)groupisasemi-directproductofthegroupoftranslationsR3withthe
groupoforthogonaltransformationsO(3),i.e.,E(3)=R3⋊O(3). Ingeneral,achievingtranslation
equivarianceisstraightforwardthroughconvolution-typeoperations. Therefore,weprimarilyfocus
ontheorthogonalgroupO(3),whichconsistsofrotationsandreflections.
Irreducible representations. We use D(g) to denote the representation of group element g in
thematrixform. Forvectorspacesofdimension2l+1,l ∈ N,thereexistsacollectionofmatrix
representationsindexedwithlforeachg ∈SO(3),whicharecalledWigner-Dmatrices. Theyare
denotedasD(l)(g). EachWigner-DmatrixD(l)(g)istheirreduciblerepresentationofSO(3)ona
subspacewithdimension2l+1. AnymatrixrepresentationD(g)ofSO(3)onvectorspaceV can
bereducedtoanequivalentblockdiagonalmatrixrepresentationwithWigner-Dmatricesalongthe
 
D(l1)(g)
diagonal: D(g)=Q−1(D(l1)(g)⊕D(l2)(g)⊕...)Q=Q−1  D(l2)(g) Q. Here,
...
QisthechangeofbasisthatmakesD(g)andtheblockdiagonalmatrixrepresentationequivalent.
ThisequivalenceprovidesanalternativeviewthattherepresentationsthatactonthevectorspaceV
aremadeupofeachWigner-DmatrixD(li),whichonlyactsona2l i+1-dimensionsubspaceV
li
of
V. Then,thevectorspaceV canbefactorizedintoV ⊕V ⊕...WecallthespaceV atype-lirrep
l1 l2 l
space,andx(l) ∈V atype-lirrep. WehavealreadyintroducedtheWigner-Dmatrixinthetype-1
l
space,i.e.,D(1) =R∈R3×3,det(R)=1. TheWigner-Dmatrixrepresentationscanbenaturally
extendedtotheO(3)groupbysimplyincludingthereflectionsviaadirectproduct.
Sphericalharmonics.SphericalharmonicsareusedtomapfromR3toanytype-lirrepspace.Weuse
Y(l) :S2 →R,−l≤m≤l,l∈Ntodenotethesphericalharmonics,wherelandmdenotetheirde-
m
greesandordersrespectively. Foranyx∈R3,Y(l)( x )=[Y(l)( x ),...,Y(l)( x )]⊤isatype-l
||x|| −l ||x|| l ||x||
irrep.ThismappingisequivarianttotheO(3)group,i.e.,given˜r∈S2,g ∈SO(3)anditsrepresenta-
tiononR3asrotationmatrixR,wehaveY(l)(R˜r)=D(l)(g)Y(l)(˜r)andY(l)(−˜r)=(−1)lY(l)(˜r).
Tensor products of irreducible representations. Given x(l1),x(l2) in type-l
1
and type-l
2
irrep
spacerespectively,theirtensorproductyieldsx(l1)⊗x(l2),whichliesintheV
l1
⊗V
l2
spacewith
3PublishedasaconferencepaperatICLR2024
(2l +1)×(2l +1) dimension. This operation preserves equivariance to the O(3) group, i.e.,
1 2
(D(l1)(g)⊗D(l2)(g))(x(l1) ⊗x(l2)) = (D(l1)(g)x(l1))⊗(D(l2)(g)x(l2)) for all g ∈ O(3). As
previouslystated,thetensorproductofirreduciblerepresentationsD(l1)(g)⊗D(l2)(g)canbefurther
decomposedintoirreduciblepieces: D(l1)(g)⊗D(l2)(g)=⊕l1+l2 D(l)(g). Theresultingirrep
l=|l1−l2|
x(l1)⊗x(l2)ofthetensorproductcanbeorganizedviaachangeofbasisintopartsthatareindifferent
type-lirrepspaces,i.e.,x(l1)⊗x(l2) ∈V =V |l1−l2|⊕...⊕V l1+l2.
TheClebsch-Gordantensorproductprovidesanexplicitwaytocalculatetheresultingtype-lirrep
afterthedirectsumdecomposition. Givenx(l1) ∈R2l1+1andx(l2) ∈R2l2+1,them-thelementof
theresultingtype-lirrepofthetensorproductbetweenx(l1)andx(l2)isgivenby:
(x(l1)⊗ x(l2))(l) =
(cid:88)l1 (cid:88)l2
C(l,m) x(l1)x(l2), (1)
cg m (l1,m1)(l2,m2) m1 m2
m1=−l1m2=−l2
where C(l,m) are the Clebsch-Gordan coefficients (Wigner, 2012). We use x˜(L) =
(l1,m1)(l2,m2)
[x(0);...;x(L)]∈R(L+1)2 todenotefeaturescontainingirrepsofuptodegreeLinpractice,andthe
fulltensorproductisgivenby(x˜(L1)⊗ c˜gx˜(L2))( ml) =(cid:80)L l11 =0(cid:80)L l22 =0(x(l1)⊗ cgx(l2))( ml). Retaining
alloutputirrepsoftheClebsch-GordantensorproductrequiresO(L3)3Dmatrixmultiplications,i.e.,
anO(L6)cost,whichbecomescomputationallyunfeasiblewhenscalingirrepstohigherLdegrees.
3 GAUNT TENSOR PRODUCT
We now introduce our Gaunt Tensor Product, which serves as a new method for efficient E(3)-
equivariantoperations. First,weproposeanewperspectiveonthetensorproductsofirreps(Sec-
tion3.1),whichconnectsthisoperationtomultiplicationbetweenfunctionsdefinedonthespherevia
Gauntcoefficients(Wigner,2012). Ourperspectiveinspiresthedevelopmentofanefficientapproach
to accelerate the tensor product computation by using the convolution theorem and Fast Fourier
Transforms(Section3.2),whichachievessubstantialspeed-upscomparedtopriorimplementations.
Finally,weprovideacomprehensivestudyonmajorequivariantoperationclassesintheliterature,
andshowhowtodesignefficientcounterpartsviaourGauntTensorProduct(Section3.3),which
opensnewopportunitiesforpushingthefrontierofE(3)-equivariantmodels.
3.1 ANEWPERSPECTIVEONTENSORPRODUCTSOFIRREPSVIAGAUNTCOEFFICIENTS
As shown in Eqn. (1), the essence of the tensor product operation is in the Clebsch-Gordan co-
efficients,whichareusedtoperformtheexplicitdirect-sumdecomposition. TheCGcoefficients
commonlyappearinquantummechanics,andserveastheexpansioncoefficientsoftotalangularmo-
mentumeigenstatesinanuncoupledtensorproductbasis. Interestingly,sphericalharmonicsactually
correspondtotheeigenstatesofangularmomentum,indicatingthatthereexistunderlyingrelationsbe-
tweenthesetwoconcepts. Inphysics,theWigner-Eckarttheoreminquantummechanicsrevealsthese
relationshipsinanelegantmanner(refertoAppendixA.7forthedetailsofthesephysicalconcepts):
Theorem 3.1 (Wigner-Eckart theorem for Spherical Tensor Operators, from Jeevanjee (2011)).
Let j,l,J ∈ N and let T(j) be a spherical tensor operator of rank j. Then there is a unique
≥0
complexnumber,thereducedmatrixelementλ∈C(oftenwritten⟨J∥T(j)∥l⟩∈C),thatcompletely
determinesanyofthe(2J +1)×(2j+1)×(2l+1)matrixelements⟨J,M|T(j)|l,n⟩:
m
⟨J,M|T(j)|l,n⟩ = λ·C(J,M) . (2)
m (l,n)(j,m)
Here,|l,n⟩,⟨J,M|denoteeigenstatesforangularmomentumoperatorswith|n|≤l,|M|≤J,andre-
latetosphericalharmonicsvia⟨θ,ψ|l,n⟩=Y(l)(θ,ψ),withsphericalcoordinateθ∈[0,π],ψ∈[0,2π).
n
TheWigner-Eckarttheoremdescribeshowthematrixelements(⟨J,M|T(j)|l,n⟩,|m|≤j)ofthe
m
sphericaltensoroperator(T(j))inthebasisofangularmomentumeigenstatesaredecomposedinto
theClebsch-Gordancoefficientsandthereducedrepresentation(⟨J∥T(j)∥l⟩). IfweinstantiateT(j)
as the spherical harmonics Y(j) and apply the Wigner-Eckart theorem, we obtain the following
relation⟨J,M|Y(j)|l,n⟩ = ⟨J∥Y(j)∥l⟩·C(J,M) ,whichcanberewrittenas,
m (l,n)(j,m)
(cid:90) 2π(cid:90) π
Y(l1)(θ,ψ)Y(l2)(θ,ψ)Y(l)(θ,ψ)sinθdθdψ=C˜(l) C(l,m) , (3)
m1 m2 m (l1,l2) (l1,m1)(l2,m2)
0 0
4PublishedasaconferencepaperatICLR2024
whereC˜(l) isarealconstantonlydeterminedbyl ,l andl. FromEqn. (3),theClebsch-Gordan
(l1,l2) 1 2
coefficients are mathematically related to the integrals of products of three spherical harmonics,
whichareknownastheGauntcoefficients(Wigner,2012). WedenotethemasG(l,m) .
(l1,m1)(l2,m2)
IfweusetheGauntcoefficientsinthetensorproductoperationinstead,wehavethefollowingresult
onthetensorproductofirreps:
(x˜(L1)⊗ x˜(L2))(l) =
(cid:88)L1 (cid:88)L2
(x(l1)⊗ x(l2))(l)
Ga˜unt m Gaunt m
l1=0l2=0
=
(cid:88)L1 (cid:88)L2 (cid:88)l1 (cid:88)l2
G(l,m) x(l1)x(l2),
(l1,m1)(l2,m2) m1 m2
l1=0l2=0m1=−l1m2=−l2
(4)
=
(cid:88)L1 (cid:88)L2 (cid:88)l1 (cid:88)l2 x(l1)x(l2)(cid:90) 2π(cid:90) π
Y(l1)(θ,ψ)Y(l2)(θ,ψ)Y(l)(θ,ψ)sinθdθdψ,
m1 m2 m1 m2 m
l1=0l2=0m1=−l1m2=−l2 0 0
  
=(cid:90) 2π(cid:90) π (cid:88)L1 (cid:88)l1
x( ml1 1)Y m(l
11)(θ,ψ)(cid:88)L2 (cid:88)l2
x( ml2 2)Y m(l 22)(θ,ψ)Y m(l)(θ,ψ)sinθdθdψ.
0 0 l1=0m1=−l1 l2=0m2=−l2
TheY(l)’sformanorthonormalbasissetforfunctionsdefinedontheunitsphereS2,i.e.,anysquare-
m
integrable function F(θ,ψ) : S2 → R can be expanded as (cid:80)∞ (cid:80)l f(l)Y(l)(θ,ψ),
l=0 m=−l m m
and the coefficients f(l) can be calculated by (cid:82)2π(cid:82)π f(θ,ψ)Y(l)(θ,ψ)sinθdθdψ. If
m 0 0 m
we set x(l1),x(l2) to 0 for l >L ,l >L , we actually obtain two spherical functions,
m1 m2 1 1 2 2
F (θ,ψ)=(cid:80)∞ (cid:80)l1 x(l1)Y(l1)(θ,ψ) and F (θ,ψ)=(cid:80)∞ (cid:80)l2 x(l2)Y(l2)(θ,ψ).
1 l1=0 m1=−l1 m1 m1 2 l2=0 m2=−l2 m2 m2
Thus,(x˜(L1)⊗ Ga˜untx˜(L2))( ml)calculatesthecoefficientsoffunctionF 3(θ,ψ)=F 1(θ,ψ)·F 2(θ,ψ).
Thisperspectiveconnectstensorproductsofirrepstomultiplicationbetweensphericalfunctions,
whichcreatesnewwaystoacceleratethetensorproductoperation,aswewilldiscussfurther.
3.2 FASTTENSORPRODUCTUSINGCONVOLUTIONTHEOREM&FASTFOURIERTRANSFORM
FormultiplicationbetweenfunctionsdefinedontheunitsphereS2,anaturalquestionistheexistence
ofefficientcomputationalmethods. Wecanleveragethechangeofbasistoachievethisgoal: instead
ofusingsphericalharmonics,thesamefunctionsdefinedontheunitsphereS2canbeequivalently
representedusinga2DFourierbasis,whichisknowntohavefavorablenumericalproperties.
Given F(θ,ϕ) : S2 → R, it can be represented by a linear combination of 2D Fourier bases as
(cid:80) (cid:80) f∗ ei(uθ+vψ),u,v ∈Zwithcomplexcoefficientsf∗ tomakeitarealfunction. Tokeep
u v u,v u,v
the convention of spherical harmonics, we also describe the 2D Fourier basis in terms of (up to)
degreesLif−L ≤ u ≤ L,−L ≤ v ≤ L. ThemultiplicationbetweenF (θ,ψ)andF (θ,ψ)can
1 2
thusbeexpressedas:
(cid:32) (cid:33) (cid:32) (cid:33)
F (θ,ψ)·F (θ,ψ)= (cid:88)(cid:88) f1∗ ei(u1θ+v1ψ) · (cid:88)(cid:88) f2∗ ei(u2θ+v2ψ)
1 2 u1,v1 u2,v2
u1 v1 u2 v2 (5)
=(cid:88)(cid:88)(cid:88)(cid:88) f1∗ f2∗ ei((u1+u2)θ+(v1+v2)ψ).
u1,v1 u2,v2
u1 v1 u2 v2
Bycomparingthe2DFourierbases,thecoefficientsofF (θ,ψ)=F (θ,ψ)·F (θ,ψ)canbeobtained
3 1 2
byf3∗ =(cid:80) (cid:80) f1∗ f2∗ ,whichisexactlytheformofa2Dconvolution. It
u3,v3 u1+u2=u3 v1+v2=v3 u1,v1 u2,v2
iswell-knownthatthese2Dconvolutionscanbesignificantlyacceleratedbyusingtheconvolution
theoremandFastFourierTransforms(FFT)(Proakis,2007). Wecanthenusethistodevelopan
efficientapproachtocomputethetensorproductofirrepsinEqn. (4).
Fromsphericalharmonicsto2DFourierbases. Sincebothsphericalharmonicsand2DFourier
bases form an orthonormal basis set for spherical functions, we have the following equivalence:
for spherical harmonics Y(l)(θ,ψ),0 ≤ l ≤ L,−l ≤ m ≤ l, there exist coefficients yl,m,∗ such
m u,v
thatY(l)(θ,ψ)=(cid:80)L (cid:80)L yl,m,∗ei(uθ+vψ). Thesecoefficientsyl,m,∗aresparseduetothe
m u=−L v=−L u,v u,v
orthogonalityofsuchbasissets. Thatis,yl,m,∗arenon-zeroonlywhenm=±v.
u,v
5PublishedasaconferencepaperatICLR2024
Tocomputex˜(L1)⊗ Ga˜untx˜(L2)inEqn. (4),thefirststepistoconvertthecoefficientsofspherical
harmonicstocoefficientsofthe2DFourierbasis. Fromtheaboveequivalence,wehavethefollowing
conversionrulefromsphericalharmonicsto2DFourierbases:
L l
x∗ =(cid:88) (cid:88) x(l)yl,m,∗,−L≤u≤L,−L≤v≤L. (6)
u,v m u,v
l=0m=−l
Performing 2D convolution via Fast Fourier Transform. After converting coefficients from
spherical harmonics to 2D Fourier bases, we can use the convolution theorem and Fast Fourier
Transform(FFT)toefficientlycomputethe2DconvolutionfromEqn. (5). Bothx1∗ andx2∗ are
u,v u,v
transformedfromthespatialdomaintothefrequencydomainviaFFT.Inthefrequencydomain,
the2Dconvolutioncanbesimplycomputedbyelement-wisemultiplication. Then,theresultsof
multiplicationinthefrequencydomainaretransformedbacktothespatialdomainviaFFTagain.
From 2D Fourier bases to spherical harmonics. Similarly, for 2D Fourier bases ei(uθ+vψ),
where −L ≤ u ≤ L and −L ≤ v ≤ L, there exist coefficients zl,m,∗ such that ei(uθ+vψ) =
u,v
(cid:80)L (cid:80)L zl,m,∗Y(l)(θ,ψ), and zl,m,∗ are also sparse, i.e., zl,m,∗ are non-zero only when
l=0 m=−L u,v m u,v u,v
m = ±v. Thelaststepistoconverttheresultingcoefficientsofmultiplicationbetweenspherical
functionsbacktocoefficientsofsphericalharmonics,whichcanbecalculatedas:
L L
x(l) = (cid:88) (cid:88) x∗ zl,m,∗,0≤l≤L,−l≤m≤l. (7)
m u,v u,v
u=−Lv=−L
Computational complexity analysis. We provide an analysis on the computational complexity
oftheoriginalimplementationoffulltensorproductsofirrepsofdegreeuptoL. Ascanbeseen
fromEqn. (4),tocalculatethem-thelementoftheoutputtype-lirrep,thereexistO(L2)(l ,l )→l
1 2
combinations of input irreps. Each combination requires a summation of O(L2) multiplications.
This means it requires O(L4) operations for the m-th element of the output type-l irrep. Then,
retainingallm-elementsofalloutputtype-lirrepswith0≤l≤LhasanO(L6)complexity.
Inourapproach,wefirstconvertcoefficientsofsphericalharmonicstocoefficientsof2DFourier
bases(seeEqn. (6)). Foreachx∗ ,sinceyl,m,∗arenon-zeroonlywhenm=±v,itrequiresO(L)
u,v u,v
operations. Thus,thefirststepofourapproachrequiresO(L3)operationsintotal. Forthesecond
step,the2DconvolutioninEqn. (5)hasanO(L2logL)complexityusingFFT.Similarly,thelast
stepofourapproachalsoonlyrequiresO(L3),duetothesparsityofzl,m,∗. Therefore,ourapproach
u,v
hasanO(L3)complexitytocomputethefulltensorproductsofirrepsofdegreesuptoL,which
achievessubstantialaccelerationcomparedtotheoriginalimplementation.
3.3 DESIGNINGEFFICIENTEQUIVARIANTOPERATIONSVIATHEGAUNTTENSORPRODUCT
Based on the approach in Section 3.2, we introduce the Gaunt Tensor Product, a technique that
efficientlycomputestensorproductsofirrepsutilizingGauntcoefficients. OurGauntTensorProduct
canbeappliedacrossdifferentmodelarchitecturesintheliterature,andservesasanewmethodfor
efficientequivariantoperations. Weprovideacomprehensivestudyonmajorequivariantoperation
classes(EquivariantFeatureInteractions,EquivariantConvolutions,andEquivariantMany-body
Interactions)andshowhowtodesignefficientcounterpartsviaourGauntTensorProduct. Wepresent
additionaldetailsinAppendixC.
Equivariant Feature Interactions. Given two features x˜(L1),y˜(L2) containing irreps of up to
degree L and L respectively, the operations in this class are commonly in the following form:
1 2
(x˜(L1)⊗w
c˜g
y˜(L2))(l) =(cid:80)L l11 =0(cid:80)L l22 =0w ll 1,l2(x(l1)⊗
cg
y(l2))(l),wherew ll
1,l2
∈Rarethelearnable
weightsforeach(l ,l )→lcombination.ComparedtoEqn.(4),ourGauntTensorProductisexactly
1 2
inthesameform,exceptforthelearnableweightswl . Ourapproachcanbenaturallyextended
l1,l2
byreparameterizingwl asw ·w ·w ,wherew ,w ,w ∈ R. Theweightedcombinations
l1,l2 l1 l2 l l1 l2 l
can be equivalently achieved in Eqn. (4) by separately multiplying w l1,w l2,w
l
with x(l1),x(l2)
and(x(l1)⊗ Gauntx(l2))(l) correspondingly,inwhichcasethetensorproductofirrepscanbestill
efficientlycomputedbyusingtheapproachinSection3.2.
Theseoperationsfacilitateinteractionsbetweenirrepsfromdifferentdimensionalspacesandobjects,
whichhavebeenwidelyusedinrecentwork. Forexample,So3krates(Franketal.,2022)developed
6PublishedasaconferencepaperatICLR2024
theatomicinteractionlayer,wherebothx˜(L1)andy˜(L2)aretheequivariantfeaturesX(L)ofatom
i
i. Additionally,intheQuantumHamiltonianpredictiontask,suchoperationsarecommonlyused
tointeractfeaturesforconstructingHamiltonianmatrices(Unkeetal.,2021;Yuetal.,2023b). For
instance,QHNet(Yuetal.,2023b)instantiatesx˜(L1)andy˜(L2)asequivariantfeaturesofatompairs
(xˆ ,xˆ )andusestheoutputfeaturesastheinputofthenon-diagonalmatrixelementspredictionblock.
i j
Equivariant Convolutions. One special case of Equivariant Feature Interaction is to instantiate
y˜(L2) assphericalharmonicsfilters,i.e.,(cid:80)L l11 =0(cid:80)L l22 =0hl l1,l2(x i(l1)⊗
cg
Y(l2)( ||r ri i− −r rj j||))(l),where
r i,r
j
∈ R3 arepositionsofobjects, Y(l2) : S2 → R2l2+1 isthetype-l
2
sphericalharmonic, and
hl ∈Rarelearnableweightscalculatedbasedontherelativedistanceandtypesofobjectsi,j.
l1,l2
Similarly,thehl canbereparameterizedforourapproach. Passaro&Zitnick(2023)providean
l1,l2
interestingobservationthatifweselectarotationg ∈SO(3)withD(1)(g) ri−rj =(0,1,0),then
||ri−rj||
Y(l)(D(1)(g) ri−rj )∝δ(l),i.e.,isnon-zeroonlyifm=0. Thissparsificationfurtherpropagates
m ||ri−rj|| m
tothecoefficientsofthe2DFourierbasis,whichbringsadditionalaccelerationinEqn. (6).
EquivariantConvolutionsarethebasicoperationsforequivariantmessagepassing(Thomasetal.,
2018;Fuchsetal.,2020;Brandstetteretal.,2022;Batzneretal.,2022;Liao&Smidt,2023;Passaro
&Zitnick,2023). Thesphericalharmonicsfiltersencodethegeometricrelationsbetweenobjectsand
interactwiththeobjectfeaturesinanequivariantmanner,whichplaysanessentialroleinlearning
semanticsandgeometricstructuresunderequivarianceconstraints.
EquivariantMany-bodyInteractions. Operationsinthisclassperformmultipletensorproducts
amongequivariantfeatures,i.e.,x˜(L1)⊗ x˜(L2)⊗ ...⊗ x˜(Ln). Suchoperationsarecommonly
1 c˜g 2 c˜g c˜g n
usedforconstructingmany-bodyinteractioneffects(Drautz,2019;Batatiaetal.,2022a;b;Nigam
etal.,2022;Kovácsetal.,2023),whichcanimproveperformanceforMLforcefields. Forexample,
givenequivariantfeaturesA(L′)ofatomi,MACE(Batatiaetal.,2022b)constructsthemany-body
i
featuresby(cid:80) (cid:80) CLM (cid:81)ν A(lξ) ,whichistheexplicitformofperformingtensorproducts
ην lm ην,lm ξ=1 i,mξ
with A(L) itself ν times, i.e., B = A(L′) ⊗ ...⊗ A(L′). Similarly, such operations can be
i ν,i i c˜g c˜g i
equivalently viewed as multiplications of multiple spherical functions. Using this, we can use a
divide-and-conquermethodtoefficientlycomputemultiple2Dconvolutionsforfurtherspeedups.
Discussion. It is common in models to maintain C channels of equivariant features, i.e.,
x˜(L),0≤c<C containsirrepsofdegreesuptoL. Thisextensioncanbenaturallyincludedinour
i,c
approachbydefiningthecombinationrulesoffeaturesindifferentchannels,e.g.,channel-wise(O(C)
ops)orchannel-mixing(O(C2)ops). Notethatourapproachisnotlimitedtofulltensorproducts
only. Infact,givenx(l1)⊗ cgy(l2)only,theapproachpresentedinSection3.2canstillbeused,which
reducesO(L˜3)toO(L˜2logL˜)withL˜ =l +l .Overall,wedemonstratethegeneralityofourGaunt
1 2
TensorProduct,andwebelievethatitisastartingpointwithmorepossibilitiestoexploreinthefuture.
4 EXPERIMENTS
We empirically study the efficiency and effectiveness of our Gaunt Tensor Product. First, we
providecomprehensiveefficiencycomparisonsbetweenourGauntTensorProductandtheoriginal
implementationsoftheoperationclassesmentionedinSection3.3. Second,weperformasanity
checktoinvestigatetheeffectsbroughtbythedifferentparameterizationsofourGauntTensorProduct
versustheClebsch-GordanTensorProduct. Finally,wepresentresultsapplyingourGauntTensor
Producttovariousmodelarchitecturesandtasktypes.ExperimentdetailsarepresentedinAppendixE.
Thecodewillbereleasedathttps://github.com/lsj2408/Gaunt-Tensor-Product.
EfficiencyComparisons. (1)FortheEquivariantFeatureInteractionoperation,weusethee3nn
implementation(Geiger&Smidt,2022)asthebaseline.Werandomlysample10pairsoffeaturescon-
tainingirrepsofuptodegreeLwith128channels. Theaverageinferencetimeisreported. (2)Forthe
EquivariantConvolutionoperation,weusetheeSCNimplementation(Passaro&Zitnick,2023)asthe
baseline,duetoitsenhancedefficiencyovere3nnforthisoperation. Inthissetting,pairsoffeatures
andsphericalharmonicsfiltersaresampledinstead.WeimplementourGauntTensorProductbyusing
theinsightsofeSCNforfurtheracceleration(Section3.3).(3)FortheEquivariantMany-bodyInterac-
tionoperation,wecompareourapproachwithboththee3nnandtheMACEimplementations(Batatia
etal.,2022b). WeevaluatevariousdegreesofLandthenumberoftensorproductoperandsν.
7PublishedasaconferencepaperatICLR2024
Figure1: Resultsonefficiencycomparisonsandsanitycheck. Wecomprehensivelycompareour
GauntTensorProductwithimplementationsofe3nn,eSCN,andMACEoncorrespondingequivariant
operationclasses. Inallsettings, ourapproachachievessignificantspeedups. OurGauntTensor
ProductparameterizationfurtherpassesthesanitycheckwithSEGNNontheN-bodysimulationtask.
OC202MValidation
S2EF
EnergyMAE ForceMAE ForceCos EFwT
Model [meV]↓ [meV/Å]↓ ↑ [%]↑
SchNet(Schüttetal.,2018) 1400 78.3 0.109 0.00
DimeNet++(Gasteigeretal.,2020a) 805 65.7 0.217 0.01
SpinConv(Shuaibietal.,2021) 406 36.2 0.479 0.13
GemNet-dT(Gasteigeretal.,2021) 358 29.5 0.557 0.61
GemNet-OC(Gasteigeretal.,2022) 286 25.7 0.598 1.06
L #layers #batch
SCN1-tap1-band(Zitnicketal.,2022) 6 12 64 299 24.3 0.605 0.98
SCN4-tap2-band(Zitnicketal.,2022) 6 12 64 279 22.2 0.643 1.41
eSCN(Passaro&Zitnick,2023) 4 12 96 291 22.2 0.637 1.39
eSCN(Passaro&Zitnick,2023) 6 12 96 294 21.3 0.653 1.45
EquiformerV2(Liaoetal.,2024) 4 12 64 284 21.4 0.657 1.51
EquiformerV2(Liaoetal.,2024) 6 12 64 285 20.5 0.663 1.67
EquiformerV2+Gaunt-Selfmix(ours) 4 12 64 277 20.9 0.661 1.82
EquiformerV2+Gaunt-Selfmix(ours) 6 12 64 276 20.1 0.669 1.95
Table1: ResultsontheOC20S2EFtask. TheresultsareaveragedacrossthefourOC20Validation
setsplits. Boldedvaluesdenotethebestperformance.
TheresultsarepresentedinFig.1. OurGauntTensorProductachievessubstantialaccelerationcom-
paredtothee3nnimplementation,e.g.,multipleordersofmagnitudespeed-upwhenL>7. Compared
totheefficienteSCNimplementation,ourapproachhasfurtheracceleration,duetothecombinationof
thesetwomethods. Finally,ourGauntTensorProductconsistentlyoutperformstheMACEimplemen-
tationacrossdifferentLandν. Theseresultsdemonstratetheimprovedefficiencyofourapproach.
SanityCheck. AsshowninEqn. (3),theGauntcoefficientsareproportionaltotheClebsch-Gordan
coefficientsfortheconstants,whichleadstodifferentparameterizationsofourGauntTensorProduct
andtheClebsch-GordanTensorProduct. Toinvestigatetheunderlyingeffects,weconductasanity
checkbyapplyingtheparameterizationoftheGauntTensorProducttotheSEGNN(Brandstetteretal.,
2022)modelontheN-bodysimulationtask(Satorrasetal.,2021),whichrequiresthemodeltoforecast
thepositionsofasetofparticlesmodeledbypredefinedinteractionrules. FollowingBrandstetter
etal.(2022),weemploya4-layerSEGNNandkeepallhyperparametersthesametocomparethe
performanceofdifferentparameterizations.
InthelastpanelofFigure1,weseethatSEGNNwithourGauntTensorProductperformscompeti-
tivelycomparedtotheClebsch-GordanTensorProductimplementation,whichdemonstratesthatour
parameterizationdoesnothurttheperformanceofequivariantoperations.
8PublishedasaconferencepaperatICLR2024
Table2: Resultsonthe3BPAdataset. Energy(E,meV)andforce(F,meV/Å)errorsareevaluated.
Standarddeviationsoverthreerunsarereportedifavailable. Boldvaluesdenotethebestefficiency.
ACE sGDML Allegro NequIP BOTNet MACE MACE-Gaunt
E 7.1 9.1 3.84(0.08) 3.3(0.1) 3.1(0.13) 3.0(0.2) 2.9(0.1)
300K
F 27.1 46.2 12.98(0.17) 10.8(0.2) 11.0(0.14) 8.8(0.3) 9.2(0.1)
E 24.0 484.8 12.07(0.45) 11.2(0.1) 11.5(0.6) 9.7(0.5) 10.6(0.5)
600K
F 64.3 439.2 29.17(0.22) 26.4(0.1) 26.7(0.29) 21.8(0.6) 22.2(0.2)
E 85.3 774.5 42.57(1.46) 38.5(1.6) 39.1(1.1) 29.8(1.0) 30.4(1.2)
1200K
F 187.0 711.1 82.96(1.77) 76.2(1.1) 81.1(1.5) 62.0(0.7) 63.1(1.2)
E - - - - 16.3(1.5) 7.8(0.6) 9.9(0.3)
DihedralSlices
F - - - - 20.0(1.2) 16.5(1.7) 17.7(1.1)
Speed-ups(v.s.e3nn) - - - - - 33.2x 43.7x
Memorycosts(v.s.e3nn) - - - - - 32.8% 5.8%
OC20 S2EF performance. Following Gasteiger et al. (2021); Zitnick et al. (2022); Passaro &
Zitnick(2023), weevaluateourapproachonthelarge-scaleOpenCatalyst2020(OC20)dataset,
whichconsistsof1.2MDFTrelaxations. EachdatainstanceinOC20hasanadsorbatemolecule
placedonacatalystsurface. ThecoretaskisStructure-to-Energy-Forces(S2EF),whichrequiresthe
modeltopredicttheenergyandper-atomforcesoftheadsorbate-catalystcomplex. Recently,the
EquiformerV2model(Liaoetal.,2024)achievedstate-of-the-artperformanceontheOC20S2EFtask,
whichusestheefficienteSCNimplementationtobuildascalableTransformerbackbone. However,
thisimplementationrestrictstheavailabletensorproductoperationstoEquivariantConvolutionsonly.
WeapplyourGauntTensorProducttoconstructanefficientEquivariantFeatureInteractionoperation,
Selfmix,andaddittoeachlayeroftheEquiformerV2model. Ourapproachretainsefficiencyeven
with such modifications. Following Liao et al. (2024), we train 12-layer EquiformerV2 models
and keep all configurations the same. We use the OC20 2M subset for training. The results are
presentedinTable1. WeshowthatEquiformerV2withourGauntSelfmixoperationachievesbetter
performanceontheS2EFtask,i.e.,16.8%relativeimprovementontheEFwTmetricwithL=6.
3BPAperformance. FollowingBatzneretal.(2022);Musaelianetal.(2023);Batatiaetal.(2022b),
weusethe3BPAdataset(Kovácsetal.,2021)tobenchmarktheEquivariantMany-bodyInteraction
operations. Thetrainingsetof3BPAcontains500geometriessampledfromthe300Kmolecular
dynamics simulation of the large and flexible drug-like molecule 3-(benzyloxy)pyridin-2-amine
(3BPA).Bothin-(300K)andout-of-distributiontestsets(600K,1200K,dihedralslices)areused
toevaluatethemodel’sabilitytopredicttheenergyandforcesofthegeometricalstructure. Weapply
ourGauntTensorProducttotheMACEarchitecture, whichusesequivariantfeaturescontaining
irrepsofuptodegreeL=2. TheEquivariantMany-bodyInteractionoperationinMACEperforms
twotensorproductsamongthreeequivariantfeatures. Wekeepalltrainingconfigurationsthesame
asinBatatiaetal.(2022b). ThedetailsofbaselinesandsettingsarepresentedinAppendixE.4.
TheresultsarepresentedinTable2. MACE,integratedwithourGauntTensorProduct,performs
competitivelycomparedtoitsoriginalimplementation,whichhasthebestperformanceamongcom-
petitivebaselines. ThisaffirmsthatourparameterizationintheEquivariantMany-bodyInteraction
does not hurt accuracy. MACE with our Gaunt Tensor Product achieves significant acceleration
compared to both the e3nn implementation and the original MACE implementation, i.e., 43.7x
speed-upscomparedtothebaselines. NotethattheMACEimplementationtradesspaceforspeed
andincursadditionalmemorycosts,whileourapproachhaslowmemorycoststhatarefriendlyfor
deployment,e.g.,reducing82.3%relativememorycostsversusMACE.
5 CONCLUSION
Weintroduceasystematicapproach,theGauntTensorProduct,tosignificantlyacceleratethecompu-
tationofthetensorproductsofirreps.OurGauntTensorProductisestablishedthroughtheconnection
betweenClebsch-GordancoefficientsandGauntcoefficients,whichenablestheequivalentexpression
of the tensor product operation as the multiplication between spherical functions represented by
sphericalharmonics. Thisviewpointallowsustochangethebasisfortheequivariantoperations
toa2DFourierbasis. Multiplicationbetweenfunctionsinthisbasiscanthusbeacceleratedviathe
convolutiontheoremandFastFourierTransforms. Ourexperimentsdemonstrateboththeimproved
efficiency and effectiveness of our approach. Overall, our Gaunt Tensor Product provides new
opportunitiesforefficientequivariantoperations,openingavenuesforexplorationinthefuture.
9PublishedasaconferencepaperatICLR2024
Acknowledgements. ThisworkacknowledgessupportfromLaboratoryDirectedResearchand
Development(LDRD)fundingunderContractNumberDE-AC02-05CH11231. WethankNithin
Chalapathi, Di He, Eric Qu, Danny Reidenbach, and Bohang Zhang for helpful discussions and
feedback. Wealsothankallreviewersfortheirvaluablesuggestions.
REFERENCES
Kenneth Atz, Francesca Grisoni, and Gisbert Schneider. Geometric deep learning on molecular
representations. NatureMachineIntelligence,3(12):1023–1032,2021.
AlbertPBartók,MikeCPayne,RisiKondor,andGáborCsányi. Gaussianapproximationpotentials:
The accuracy of quantum mechanics, without the electrons. Physical review letters, 104(13):
136403,2010.
IlyesBatatia,SimonBatzner,DávidPéterKovács,AlbertMusaelian,GregorNCSimm,RalfDrautz,
Christoph Ortner, Boris Kozinsky, and Gábor Csányi. The design space of e (3)-equivariant
atom-centeredinteratomicpotentials. arXivpreprintarXiv:2205.06643,2022a.
IlyesBatatia,DavidPKovacs,GregorSimm,ChristophOrtner,andGáborCsányi. Mace: Higher
orderequivariantmessagepassingneuralnetworksforfastandaccurateforcefields. Advancesin
NeuralInformationProcessingSystems,35:11423–11436,2022b.
SimonBatzner,AlbertMusaelian,LixinSun,MarioGeiger,JonathanPMailoa,MordechaiKornbluth,
NicolaMolinari,TessESmidt,andBorisKozinsky. E(3)-equivariantgraphneuralnetworksfor
data-efficientandaccurateinteratomicpotentials. Naturecommunications,13(1):2453,2022.
JörgBehlerandMicheleParrinello. Generalizedneural-networkrepresentationofhigh-dimensional
potential-energysurfaces. Physicalreviewletters,98(14):146401,2007.
Johannes Brandstetter, Rob Hesselink, Elise van der Pol, Erik J Bekkers, and Max Welling. Ge-
ometric and physical quantities improve e(3) equivariant message passing. In International
ConferenceonLearningRepresentations,2022. URLhttps://openreview.net/forum?
id=_xwr8gOBeV1.
Michael M Bronstein, Joan Bruna, Taco Cohen, and Petar Velicˇkovic´. Geometric deep learning:
Grids,groups,graphs,geodesics,andgauges. arXivpreprintarXiv:2104.13478,2021.
GeraldBurns. Introductiontogrouptheorywithapplications: materialsscienceandtechnology.
AcademicPress,2014.
LowikChanussot,AbhishekDas,SiddharthGoyal,ThibautLavril,MuhammedShuaibi,Morgane
Riviere, Kevin Tran, Javier Heras-Domingo, Caleb Ho, Weihua Hu, Aini Palizhati, Anuroop
Sriram,BrandonWood,JunwoongYoon,DeviParikh,C.LawrenceZitnick,andZacharyUlissi.
Opencatalyst2020(oc20)datasetandcommunitychallenges. ACSCatalysis,11(10):6059–6072,
2021.
TianlangChen,ShengjieLuo,DiHe,ShuxinZheng,Tie-YanLiu,andLiweiWang. GeoMFormer:
Ageneralarchitectureforgeometricmolecularrepresentationlearning. InNeurIPS2023AIfor
ScienceWorkshop,2023. URLhttps://openreview.net/forum?id=s0UNtuuqU5.
StefanChmiela,AlexandreTkatchenko,HuzielESauceda,IgorPoltavsky,KristofTSchütt,and
Klaus-Robert Müller. Machine learning of accurate energy-conserving molecular force fields.
Scienceadvances,3(5):e1603015,2017.
StefanChmiela,HuzielESauceda,IgorPoltavsky,Klaus-RobertMüller,andAlexandreTkatchenko.
sgdml: Constructingaccurateanddataefficientmolecularforcefieldsusingmachinelearning.
ComputerPhysicsCommunications,240:38–45,2019.
TacoCohenandMaxWelling.Groupequivariantconvolutionalnetworks.InInternationalconference
onmachinelearning,pp.2990–2999.PMLR,2016.
Taco S. Cohen and Max Welling. Steerable CNNs. In International Conference on Learning
Representations,2017. URLhttps://openreview.net/forum?id=rJQKYt5ll.
10PublishedasaconferencepaperatICLR2024
EugeneDCommins. Modernquantummechanics,revisededition,1995.
BenjaminCoors,AlexandruPaulCondurache,andAndreasGeiger. Spherenet: Learningspherical
representationsfordetectionandclassificationinomnidirectionalimages. InProceedingsofthe
Europeanconf.oncomputervision(ECCV),2018.
JohnFCornwell. Grouptheoryinphysics: Anintroduction. Academicpress,1997.
FAlbertCotton. Chemicalapplicationsofgrouptheory. JohnWiley&Sons,1991.
CongyueDeng, OrLitany, YueqiDuan, AdrienPoulenard, AndreaTagliasacchi, andLeonidasJ
Guibas. Vectorneurons: Ageneralframeworkforso(3)-equivariantnetworks. InProceedingsof
theIEEE/CVFInternationalConferenceonComputerVision,pp.12200–12209,2021.
RalfDrautz. Atomicclusterexpansionforaccurateandtransferableinteratomicpotentials. Physical
ReviewB,99(1):014104,2019.
GenevieveDusson,MarkusBachmayr,GáborCsányi,RalfDrautz,SimonEtter,CasvanderOord,
andChristophOrtner. Atomicclusterexpansion: Completeness,efficiencyandstability. Journal
ofComputationalPhysics,454:110946,2022.
AlexandreDuval,SimonVMathis,ChaitanyaKJoshi,VictorSchmidt,SantiagoMiret,FragkiskosD
Malliaros,TacoCohen,PietroLio,YoshuaBengio,andMichaelBronstein. Ahitchhiker’sguide
togeometricgnnsfor3datomicsystems. arXivpreprintarXiv:2312.07511,2023.
NadavDymandHaggaiMaron. Ontheuniversalityofrotationequivariantpointcloudnetworks. In
InternationalConferenceonLearningRepresentations,2021. URLhttps://openreview.
net/forum?id=6NFBvWlRXaG.
MarcFinzi,SamuelStanton,PavelIzmailov,andAndrewGordonWilson.Generalizingconvolutional
neural networks for equivariance to lie groups on arbitrary continuous data. In International
ConferenceonMachineLearning,pp.3165–3176.PMLR,2020.
ThorbenFrank,OliverUnke,andKlaus-RobertMüller. So3krates: Equivariantattentionforinterac-
tionsonarbitrarylength-scalesinmolecularsystems. AdvancesinNeuralInformationProcessing
Systems,35:29400–29413,2022.
Fabian Fuchs, Daniel Worrall, Volker Fischer, and Max Welling. Se (3)-transformers: 3d roto-
translationequivariantattentionnetworks. Advancesinneuralinformationprocessingsystems,33:
1970–1981,2020.
Johannes Gasteiger, Shankari Giri, Johannes T. Margraf, and Stephan Günnemann. Fast and
uncertainty-aware directional message passing for non-equilibrium molecules. In NeurIPS-W,
2020a.
JohannesGasteiger,JanekGroß,andStephanGünnemann.Directionalmessagepassingformolecular
graphs. In International Conference on Learning Representations, 2020b. URL https://
openreview.net/forum?id=B1eWbxStPH.
Johannes Gasteiger, Florian Becker, and Stephan Günnemann. Gemnet: Universal directional
graphneuralnetworksformolecules. AdvancesinNeuralInformationProcessingSystems,34:
6790–6802,2021.
Johannes Gasteiger, Muhammed Shuaibi, Anuroop Sriram, Stephan Günnemann, Zachary Ward
Ulissi,CLawrenceZitnick,andAbhishekDas. Gemnet-oc: developinggraphneuralnetworks
forlargeanddiversemolecularsimulationdatasets. TransactionsonMachineLearningResearch,
2022.
MarioGeigerandTessSmidt. e3nn: Euclideanneuralnetworks. arXivpreprintarXiv:2207.09453,
2022.
XiaoxunGong,HeLi,NianlongZou,RunzhangXu,WenhuiDuan,andYongXu.Generalframework
fore(3)-equivariantneuralnetworkrepresentationofdensityfunctionaltheoryhamiltonian.Nature
Communications,14(1):2848,2023.
11PublishedasaconferencepaperatICLR2024
MojtabaHaghighatlari,JieLi,XingyiGuan,OufanZhang,AkshayaDas,ChristopherJStein,Farnaz
Heidar-Zadeh, MeiliLiu, MartinHead-Gordon, LukeBertels, etal. Newtonnet: Anewtonian
messagepassingnetworkfordeeplearningofinteratomicpotentialsandforces. DigitalDiscovery,
1(3):333–343,2022.
BHLB Hammer, Lars Bruno Hansen, and Jens Kehlet Nørskov. Improved adsorption energetics
withindensity-functionaltheoryusingrevisedperdew-burke-ernzerhoffunctionals.Physicalreview
B,59(11):7413,1999.
JiaqiHan,YuRong,TingyangXu,andWenbingHuang. Geometricallyequivariantgraphneural
networks: Asurvey. arXivpreprintarXiv:2202.07230,2022.
Gao Huang, Yu Sun, Zhuang Liu, Daniel Sedra, and Kilian Q Weinberger. Deep networks with
stochasticdepth. InComputerVision–ECCV2016: 14thEuropeanConference,Amsterdam,The
Netherlands,October11–14,2016,Proceedings,PartIV14,pp.646–661.Springer,2016.
Michael J Hutchinson, Charline Le Lan, Sheheryar Zaidi, Emilien Dupont, Yee Whye Teh, and
HyunjikKim.Lietransformer:Equivariantself-attentionforliegroups.InInternationalConference
onMachineLearning,pp.4533–4543.PMLR,2021.
SigeruHuzinaga. Molecularintegrals. ProgressofTheoreticalPhysicsSupplement,40:52–77,1967.
NadirJeevanjee. Anintroductiontotensorsandgrouptheoryforphysicists. Springer,2011.
Bowen Jing, Stephan Eismann, Patricia Suriana, Raphael John Lamarre Townshend, and Ron
Dror. Learning from protein structure with geometric vector perceptrons. In International
ConferenceonLearningRepresentations,2021. URLhttps://openreview.net/forum?
id=1YLJDvSx6J4.
ChaitanyaK.Joshi,CristianBodnar,SimonVMathis,TacoCohen,andPietroLio. Ontheexpressive
powerofgeometricgraphneuralnetworks. InAndreasKrause, EmmaBrunskill, Kyunghyun
Cho, Barbara Engelhardt, Sivan Sabato, and Jonathan Scarlett (eds.), Proceedings of the 40th
InternationalConferenceonMachineLearning,volume202ofProceedingsofMachineLearning
Research, pp.15330–15355.PMLR,23–29Jul2023. URLhttps://proceedings.mlr.
press/v202/joshi23a.html.
JohnJumper,RichardEvans,AlexanderPritzel,TimGreen,MichaelFigurnov,OlafRonneberger,
KathrynTunyasuvunakool,RussBates,AugustinŽídek,AnnaPotapenko,etal. Highlyaccurate
proteinstructurepredictionwithalphafold. Nature,596(7873):583–589,2021.
Kuzma Khrabrov, Ilya Shenbin, Alexander Ryabov, Artem Tsypin, Alexander Telepov, Anton
Alekseev,AlexanderGrishin,PavelStrashnov,PetrZhilyaev,SergeyNikolenko,etal. nabladft:
Large-scaleconformationalenergyandhamiltonianpredictionbenchmarkanddataset. Physical
ChemistryChemicalPhysics,24(42):25853–25863,2022.
DiederikPKingmaandJimmyBa. Adam: Amethodforstochasticoptimization. arXivpreprint
arXiv:1412.6980,2014.
YvetteKosmann-Schwarzbachetal. Groupsandsymmetries. Springer,2010.
DávidPéterKovács,CasvanderOord,JiriKucera,AliceEAAllen,DanielJCole,ChristophOrtner,
andGáborCsányi. Linearatomicclusterexpansionforcefieldsfororganicmolecules: beyond
rmse. Journalofchemicaltheoryandcomputation,17(12):7696–7711,2021.
DávidPéterKovács,IlyesBatatia,EszterSáraArany,andGáborCsányi. EvaluationoftheMACE
forcefieldarchitecture: Frommedicinalchemistrytomaterialsscience. TheJournalofChemical
Physics, 159(4):044118, 07 2023. ISSN 0021-9606. doi: 10.1063/5.0155322. URL https:
//doi.org/10.1063/5.0155322.
JaniceLan,AiniPalizhati,MuhammedShuaibi,BrandonMWood,BrookWander,AbhishekDas,
MattUyttendaele,CLawrenceZitnick,andZacharyWUlissi. Adsorbml: Acceleratingadsorption
energycalculationswithmachinelearning. arXivpreprintarXiv:2211.16486,2022.
12PublishedasaconferencepaperatICLR2024
HeLi,ZunWang,NianlongZou,MengYe,RunzhangXu,XiaoxunGong,WenhuiDuan,andYong
Xu. Deep-learningdensityfunctionaltheoryhamiltonianforefficientabinitioelectronic-structure
calculation. NatureComputationalScience,2(6):367–377,2022.
Yi-LunLiaoandTessSmidt. Equiformer: Equivariantgraphattentiontransformerfor3datomistic
graphs. In The Eleventh International Conference on Learning Representations, 2023. URL
https://openreview.net/forum?id=KwmPfARgOTD.
Yi-LunLiao,BrandonWood,AbhishekDas,andTessSmidt. Equiformerv2: Improvedequivariant
transformer for scaling to higher-degree representations. In The Twelfth International Confer-
enceonLearningRepresentations,2024. URLhttps://openreview.net/forum?id=
mCOBKZmrzD.
Shengjie Luo, Tianlang Chen, Yixian Xu, Shuxin Zheng, Tie-Yan Liu, Liwei Wang, and Di He.
One transformer can understand both 2d & 3d molecular data. In The Eleventh International
ConferenceonLearningRepresentations,2023. URLhttps://openreview.net/forum?
id=vZTp1oPV3PC.
Albert Musaelian, Simon Batzner, Anders Johansson, Lixin Sun, Cameron J Owen, Mordechai
Kornbluth,andBorisKozinsky. Learninglocalequivariantrepresentationsforlarge-scaleatomistic
dynamics. NatureCommunications,14(1):579,2023.
Jigyasa Nigam, Sergey Pozdnyakov, Guillaume Fraux, and Michele Ceriotti. Unified theory of
atom-centeredrepresentationsandmessage-passingmachine-learningschemes. TheJournalof
ChemicalPhysics,156(20),2022.
SaroPassaroandC.LawrenceZitnick.ReducingSO(3)convolutionstoSO(2)forefficientequivariant
GNNs. InAndreasKrause,EmmaBrunskill,KyunghyunCho,BarbaraEngelhardt,SivanSabato,
andJonathanScarlett(eds.),Proceedingsofthe40thInternationalConferenceonMachineLearn-
ing,volume202ofProceedingsofMachineLearningResearch,pp.27420–27438.PMLR,23–29
Jul2023. URLhttps://proceedings.mlr.press/v202/passaro23a.html.
RichardPio. Eulerangletransformations. IEEETransactionsonautomaticcontrol,11(4):707–715,
1966.
JohnGProakis. Digitalsignalprocessing: principles,algorithms,andapplications,4/E. Pearson
EducationIndia,2007.
RaghunathanRamakrishnan,PavloODral,MatthiasRupp,andOAnatoleVonLilienfeld. Quantum
chemistrystructuresandpropertiesof134kilomolecules. Scientificdata,1(1):1–7,2014.
JosephJRotman. Anintroductiontothetheoryofgroups. GraduateTextsinMathematics,1995.
VıctorGarciaSatorras,EmielHoogeboom,andMaxWelling.E(n)equivariantgraphneuralnetworks.
InInternationalconferenceonmachinelearning,pp.9323–9332.PMLR,2021.
KristofSchütt,OliverUnke,andMichaelGastegger. Equivariantmessagepassingfortheprediction
oftensorialpropertiesandmolecularspectra. InInternationalConferenceonMachineLearning,
pp.9377–9388.PMLR,2021.
Kristof T Schütt, Huziel E Sauceda, P-J Kindermans, Alexandre Tkatchenko, and K-R Müller.
Schnet–adeeplearningarchitectureformoleculesandmaterials. TheJournalofChemicalPhysics,
148(24):241722,2018.
AlexanderVShapeev. Momenttensorpotentials: Aclassofsystematicallyimprovableinteratomic
potentials. MultiscaleModeling&Simulation,14(3):1153–1173,2016.
YuShi,ShuxinZheng,GuolinKe,YifeiShen,JiachengYou,JiyanHe,ShengjieLuo,ChangLiu,
DiHe,andTie-YanLiu. Benchmarkinggraphormeronlarge-scalemolecularmodelingdatasets.
arXivpreprintarXiv:2203.04810,2022.
MuhammedShuaibi,AdeeshKolluru,AbhishekDas,AdityaGrover,AnuroopSriram,ZacharyUlissi,
andCLawrenceZitnick. Rotationinvariantgraphneuralnetworksusingspinconvolutions. arXiv
preprintarXiv:2106.09575,2021.
13PublishedasaconferencepaperatICLR2024
GuillemSimeonandGianniDeFabritiis. Tensornet: Cartesiantensorrepresentationsforefficient
learningofmolecularpotentials. InThirty-seventhConferenceonNeuralInformationProcessing
Systems,2023. URLhttps://openreview.net/forum?id=BEHlPdBZ2e.
ArnoldSommerfeld. Partialdifferentialequationsinphysics. Academicpress,1949.
PhilippThölkeandGianniDeFabritiis. Equivarianttransformersforneuralnetworkbasedmolecular
potentials. In International Conference on Learning Representations, 2022. URL https:
//openreview.net/forum?id=zNHzqZ9wrRB.
NathanielThomas,TessSmidt,StevenKearnes,LusannYang,LiLi,KaiKohlhoff,andPatrickRiley.
Tensorfieldnetworks: Rotation-andtranslation-equivariantneuralnetworksfor3dpointclouds.
arXivpreprintarXiv:1802.08219,2018.
Aidan P Thompson, Laura P Swiler, Christian R Trott, Stephen M Foiles, and Garritt J Tucker.
Spectral neighbor analysis method for automated generation of quantum-accurate interatomic
potentials. JournalofComputationalPhysics,285:316–330,2015.
OliverUnke,MihailBogojeski,MichaelGastegger,MarioGeiger,TessSmidt,andKlaus-Robert
Müller.Se(3)-equivariantpredictionofmolecularwavefunctionsandelectronicdensities.Advances
inNeuralInformationProcessingSystems,34:14434–14447,2021.
Mikaela Angelina Uy, Quang-Hieu Pham, Binh-Son Hua, Thanh Nguyen, and Sai-Kit Yeung.
Revisitingpointcloudclassification: Anewbenchmarkdatasetandclassificationmodelonreal-
worlddata. InProceedingsoftheIEEE/CVFinternationalconferenceoncomputervision,pp.
1588–1597,2019.
DmitriuiAleksandrovichVarshalovich,AnatolijNikolaevicMoskalev,andValeriiKel’manovich
Khersonskii. Quantumtheoryofangularmomentum. WorldScientific,1988.
Yuanqing Wang and John Chodera. Spatial attention kinetic networks with e(n)-equivariance.
In The Eleventh International Conference on Learning Representations, 2023. URL https:
//openreview.net/forum?id=3DIpIf3wQMC.
MauriceWeiler,MarioGeiger,MaxWelling,WouterBoomsma,andTacoSCohen.3dsteerablecnns:
Learningrotationallyequivariantfeaturesinvolumetricdata. AdvancesinNeuralInformation
ProcessingSystems,31,2018.
EPWigner. Onthematriceswhichreducethekroneckerproductsofrepresentationsofsrgroups,
manuscript(1940),publishedinlcbiedenharnandh.vandam(eds.),quantumtheoryofangular
momentum,87–133,1965.
EugeneWigner. Grouptheory: anditsapplicationtothequantummechanicsofatomicspectra,
volume5. Elsevier,2012.
ZhirongWu,ShuranSong,AdityaKhosla,FisherYu,LinguangZhang,XiaoouTang,andJianxiong
Xiao. 3dshapenets: Adeeprepresentationforvolumetricshapes. InProceedingsoftheIEEE
conferenceoncomputervisionandpatternrecognition,pp.1912–1920,2015.
ChengxuanYing,TianleCai,ShengjieLuo,ShuxinZheng,GuolinKe,DiHe,YanmingShen,and
Tie-YanLiu. Dotransformersreallyperformbadlyforgraphrepresentation? AdvancesinNeural
InformationProcessingSystems,34:28877–28888,2021a.
ChengxuanYing,MingqiYang,ShuxinZheng,GuolinKe,ShengjieLuo,TianleCai,ChenglinWu,
YuxinWang,YanmingShen,andDiHe. Firstplacesolutionofkddcup2021&ogblarge-scale
challengegraphpredictiontrack. arXivpreprintarXiv:2106.08279,2021b.
HaiyangYu,MengLiu,YouzhiLuo,AlexStrasser,XiaofengQian,XiaoningQian,andShuiwang
Ji. QH9: AquantumhamiltonianpredictionbenchmarkforQM9molecules. InThirty-seventh
ConferenceonNeuralInformationProcessingSystemsDatasetsandBenchmarksTrack,2023a.
URLhttps://openreview.net/forum?id=71uRr9N39A.
14PublishedasaconferencepaperatICLR2024
Haiyang Yu, Zhao Xu, Xiaofeng Qian, Xiaoning Qian, and Shuiwang Ji. Efficient and equiv-
ariant graph networks for predicting quantum Hamiltonian. In Andreas Krause, Emma Brun-
skill, Kyunghyun Cho, Barbara Engelhardt, Sivan Sabato, and Jonathan Scarlett (eds.), Pro-
ceedings of the 40th International Conference on Machine Learning, volume 202 of Pro-
ceedings of Machine Learning Research, pp. 40412–40424. PMLR, 23–29 Jul 2023b. URL
https://proceedings.mlr.press/v202/yu23i.html.
BohangZhang,ShengjieLuo,LiweiWang,andDiHe. RethinkingtheexpressivepowerofGNNs
viagraphbiconnectivity. InTheEleventhInternationalConferenceonLearningRepresentations,
2023a. URLhttps://openreview.net/forum?id=r9hNv76KoT3.
XuanZhang,LimeiWang,JacobHelwig,YouzhiLuo,CongFu,YaochenXie,MengLiu,Yuchao
Lin,ZhaoXu,KeqiangYan,etal. Artificialintelligenceforscienceinquantum,atomistic,and
continuumsystems. arXivpreprintarXiv:2307.08423,2023b.
YaAGranovskiıandASZhedanovetal. Natureofthesymmetrygroupofthe6j-symbol. Zh.Eksp.
Teor.Fiz.,94:49,1988.
C.LawrenceZitnick,AbhishekDas,AdeeshKolluru,JaniceLan,MuhammedShuaibi,Anuroop
Sriram, ZacharyWardUlissi, andBrandonMWood. Sphericalchannelsformodelingatomic
interactions. InAdvancesinNeuralInformationProcessingSystems,2022.
15PublishedasaconferencepaperatICLR2024
A BACKGROUND
A.1 GROUPTHEORY
Groups. LetGdenoteagroup,whichisanon-emptysettogetherwithabinaryoperationdenoted
as◦:G×G→G. Thegroupoperation◦satisfiesthefollowingpropertiesknownasgroupaxioms:
• Associativity: Foralla,b,c∈G,wehavea◦(b◦c)=(a◦b)◦c=a◦b◦c.
• Identity: Foralla∈G,thereexistsanelemente∈Gsuchthata◦e=e◦a=a.
• Inverse: Foreacha∈G,thereexistsanelementa−1 ∈Gsuchthata−1◦a=a◦a−1 =e.
• Closure: Foralla,b∈G,a◦b∈G.
Forbrevity,thegroupoperation◦canbeomittedanda◦bcanbeabbreviatedasab. Groupscan
befiniteorinfinite,countableoruncountable,compactornon-compact. TheGroupsarealgebraic
structuresthatarewidelyusedacrossphysics(Cornwell,1997),chemistry(Cotton,1991),materials
science(Burns,2014),andotherscientificareas.
Group Representations. Asintroducedabove, thegroupoperation ◦describeshowthegroup
elementsinteractwitheachother. Todescribehowthegroupelementsactonvectorspaces,group
representationsareused. Formally,arepresentationofagroupGonavectorspaceV isamapping
ρV :G→GL(V).Here,GL(V)denotesthegenerallineargrouponvectorspaceV,whichistheset
ofinvertiblematricestogetherwiththebinaryoperationofordinarymatrixmultiplication. V iscalled
therepresentationspaceandthedimensionofV iscalledthedimensionoftherepresentation. The
mappingρV(g)parameterizedbythegroupelementg ∈Gisthusaninvertiblelineartransformation
onV,whichfollowsthegroupstructure(alsoknownasgrouphomomorphism1)thatρ(g g )v =
1 2
ρ(g )ρ(g )vforallg ,g ∈G,v ∈V.
1 2 1 2
AssumingV isthefinite-dimensionalrealvectorspaceRd,thegrouprepresentationsareinvertible
matricesinRd×d. LetD(g)denotetherepresentationofginthematrixform. Representationsof
therotationgroupinthethree-dimensionalEuclideanspacearematricesR ∈ R3×3,det(R) = 1,
andtherepresentationsactonx∈RdviamatrixmultiplicationsD(g)x=Rx.
For any two representations, we say D(g) and D′(g) are equivalent if there exists a similarity
transformsuchthat:
D′(g)=Q−1D(g)Q. (8)
Thatis,bothrepresentationsD′(g)andD(g)representthesamegroupelementgwithdifferentbasis,
andthechangeofbasisiscarriedoutbyQ.
ExamplesofGroups. WhiletheGroupisanabstractmathematicalconcept,therearenumerous
classesofobjectsandtransformationsthathavegroupstructures. Inthispaper,weareinterested
in the group of translations, rotations, and reflections in the three-dimensional Euclidean space,
whichisknownasthe3DEuclideangroupanddenotedasE(3). Foreachelementg intheE(3)
group, its representation on R3 can be parameterized by pairs of translation vectors t ∈ R3 and
orthogonaltransformationmatricesR∈R3×3,det(R)=±1,i.e.,ρR3(g)=(t,R). Givenavector
x∈R3,wehaveρR3(g)[x]:=Rx+t. Thegroupoperation◦andinverseofE(3)aredefinedby
g◦g′ :=(Rt′+t,RR′)andg−1 :=(R−1x,R−1),whereg =(t,R),g′ =(t′,R′)∈E(3).
TheE(3)groupisasemi-directproductofthegroupoftranslationsR3withthegroupoforthogonal
transformationsO(3),i.e.,E(3)=R3⋊O(3).Thus,thegroupelementsinE(3)canbedecomposed
inanO(3)-transformation(rotationand/orreflection)followedbyatranslation. Notethattranslations
areeasytodealwithinmodernneuralnetworks. Therefore,wefocusmainlyontheorthogonalgroup
O(3),whichconsistsofrotationsandreflections. ForeachelementgintheO(3)group,itsrepresen-
tationonR3isthusparameterizedbyorthogonaltransformationmatricesR∈R3×3,det(R)=±1,
i.e., g = R. Similarly, the group operation ◦ and inverse of O(3) are defined by g◦g′ := RR′
andg−1 := R−1, whereg = R,g′ = R′ ∈ O(3). ThespecialorthogonalgroupSO(3)hasthe
samegroupoperationandinverse,butexcludesreflections. Thus,eachelementg =R∈SO(3)has
det(R)=1.
1Giventwogroups(G,◦ )and(H,◦ ),afunctionmappingπ:G→Hissaidtobeagrouphomomor-
G H
phismifforallg,h∈Gwehaveπ(g)◦ π(h)=π(g◦ h)
H G
16PublishedasaconferencepaperatICLR2024
A.2 EQUIVARIANCE
Formally,letϕ:X →Y denoteafunctionmappingbetweenvectorspaces. GivenagroupG,letρX
andρY denoteitsgrouprepresentationsonX andY respectively. Afunctionϕ:X →Y issaidto
beequivariantifitsatisfiesthefollowingcondition:
ρY(g)[ϕ(x)]=ϕ(ρX(g)[x]), forallg ∈G,x∈X. (9)
WhenρY =IY forallg ∈G,itisaspecialcaseofequivariancewhichisknownasinvariance,i.e.,a
functionϕ:X →Y issaidtobeinvariantifitsatisfiesthefollowingcondition:
ϕ(x)=ϕ(ρX(g)[x]), forallg ∈G,x∈X. (10)
Intuitively,anequivariantfunctionmappingtransformstheoutputpredictablyinresponsetotrans-
formationsontheinput, whereasaninvariantfunctionmappingproducesanoutputthatremains
unchangedbytransformationsappliedtotheinput. Forexample, thetotalenergyofamolecular
systemisinvarianttotherotations,translations,andreflectionsactedoneachpositionofatoms,i.e.,
theenergyfunctionwithrespecttotheatompositionsisaninvariantfunctiontotheE(3)group. Ifa
rotationisappliedtoeachpositionofatoms,thedirectionoftheforceoneachatomwillalsorotate,
i.e.,theforcefunctionisanequivariantfunctiontotheSO(3)group.
A.3 IRREDUCIBLEREPRESENTATIONS
SubrepresentationsandIrreducibleRepresentations. LetW beasubspaceofV. WhenW is
invariantunderthegroupG,i.e.,ρW(g)x ∈ W forallx ∈ W andg ∈ G,therepresentationρW
ofthegroupGonthevectorspaceW iscalledasubrepresentationofρV. ThesubspaceW isalso
calledG-invariant. ForanyrepresentationρV ofagroupG,ithastwotrivialsubrepresentations: (1)
ρV itself;(2)thezerorepresentation,bothofwhichsatisfytheabovedefinition.
After defining the concept of subrepresentations, we are ready to introduce irreducible repre-
sentations, which plays an essential role in modern rotationally equivariant neural networks. A
representationρV : G → GL(V)issaidtobeirreducibleifithasonlytrivialsubrepresentations.
IfthereisapropernontrivialG-invariantsubspace,ρV issaidtobereducible.
Wigner-Dmatrices. WeintroducetheWigner-Dmatrices,whichserveastheirreduciblerepre-
sentationsoftherotationgroupSO(3). Forvectorspacesofdimension2l+1,l=0,1,2,...,there
existsacollectionofrepresentationsindexedwithlforeachelementintheSO(3)group,whichare
calledWigner-DmatricesanddenotedasD(l)(g)forg ∈SO(3). EachWigner-DmatrixD(l)(g)is
theirreduciblerepresentationoftheSO(3)grouponsubspacewithdimension2l+1,andanymatrix
representationD(g)ofSO(3)onvectorspaceV canbereduced toanequivalentblockdiagonal
matrixrepresentationwithWigner-Dmatricesalongthediagonal:
 
D(l1)(g)
D(g)=Q−1(D(l1)(g)⊕D(l2)(g)⊕...)Q=Q−1  D(l2)(g) Q. (11)
...
Here, Q is the change of basis that makes D(g) and the block diagonal matrix representation
equivalent. Thisequivalenceprovidesanalternativeperspectivethattherepresentationsthatacton
thevectorspaceV aremadeupofeachWigner-DmatrixD(li),whichonlyactsonasubspaceV
li
withdimension2l +1ofV. Then,thevectorspaceV canbefactorizedintoV ⊕V ⊕..... By
i l1 l2
convention,thespaceV iscalledatype-l vectorspaceandx∈V iscalledatype-l vector,which
li i li i
is transformed by the Wigner-D matrix D(li). In Appendix A.1, we have already introduced the
Wigner-Dmatrixinthetype-1space,i.e.,D(1) = R ∈ R3×3,det(R) = 1. Thetype-0spaceisR
andisinvarianttotheSO(3)group,i.e.,D(0)(g)x=xforallg ∈Gandx∈R.
Aspreviouslymentioned,weareinterestedintheE(3)groupconsistingoftranslations,rotations,
andreflections. TheWigner-DmatrixrepresentationscanbenaturallyextendedtotheO(3)group
byfurtherincludingthereflectionsviaadirectproduct,whilethetranslationscanbeeasilydealt
withinmodernequivariantnetworks. WereferthereaderstoCommins(1995);Wigner(2012)for
theexplicitformsoftheWigner-Dmatricesandthee3nn2codebase(Geiger&Smidt,2022)forthe
numericalimplementation.
2https://github.com/e3nn/e3nn
17PublishedasaconferencepaperatICLR2024
A.4 SPHERICALHARMONICS
SphericalharmonicsareaclassoffunctionsdefinedontheunitsphereS2. Thesefunctionsforman
orthonormalbasisset,andthuseveryfunctiondefinedonS2canbeexpressedasaseriesofspherical
harmonics,whichissimilartotheFourierseries. Byconvention,weuseY(l) :S2 →R,−l≤m≤
m
l,l =0,1,...todenotetherealsphericalharmonics,wherelandmdenotethedegreesandorders
ofsphericalharmonicsrespectively. Bothsphericalcoordinates(θ,ψ),θ ∈ [0,π],ψ ∈ [0,2π)and
Cartesiancoordinatesr ∈ R3,||r|| = 1arewidelyusedtoexpressthepointsonthesphereS2 as
theinputvariablesofthesphericalharmonics. Next,wewillintroduceseveralimportantproperties
ofthesphericalharmonicsusedinequivariantnetworks, andtheirconnectionstotheirreducible
representationsoftheSO(3)group.
Sphericalharmonicsexpansion. Formally,ontheunitsphereS2,anysquare-integrablefunction
f :S2 →Rcanbeexpandedasalinearcombinationofsphericalharmonics:
∞ l
(cid:88) (cid:88)
f(θ,ψ)= f(l)Y(l)(θ,ψ). (12)
m m
l=0m=−l
Thisexpansionholdsinthesenseofmean-squareconvergence:
(cid:90) 2π(cid:90) π L l
(cid:88) (cid:88)
lim |f(θ,ψ)− f(l)Y(l)(θ,ψ)|sinθdθdψ =0. (13)
m m
L→∞ 0 0 l=0m=−l
SimilartotheFourierseries,thesphericalharmoniccoefficientsf(l) canbeobtainedbyusingthe
m
orthonormalpropertyofsphericalharmonics:
(cid:90) 2π(cid:90) π
f(l) = f(θ,ψ)Y(l)(θ,ψ)dθsinθdθdψ. (14)
m m
0 0
Equivarianceofsphericalharmonics. Thesphericalharmonicshavevariousintriguingproperties,
especiallywithrespecttotheequivarianceofsomegroupsconsistingoftransformationsofinterest,
e.g.,rotationsandreflections:
• Rotations. Given a rotation g ∈ SO(3) and its representation on R3 as ρR3(g) = R ∈
R3×3,det(R)=1,theunitvectorr∈R3,||r||=1isrotatedtor′ =Rr. Thenwehave:
l
Y(l)(Rr)=Y(l)(r′)= (cid:88) D(l) (g)Y(l)(r). (15)
m m mm′ m′
m′=−l
LetY(l)(r)=[Y(l)(r),...,Y(l)(r)]⊤,thentheabovepropertycanbeabbreviatedas,
−l l
Y(l)(Rr)=D(l)(g)Y(l)(r), forallg ∈SO(3),r∈S2, (16)
whereDl(g)denotesthematrixrepresentationoftheSO(3)groupelementgonthe2l+1
vectorspace,andD(l) (g)correspondstothe(m,m′)-thmatrixelement.
mm′
• Reflections. The reflection transformation (also called inversion) is represented by the
operatorPΦ(r)=Φ(−r). Then,wehave:
Y(l)(−r)=(−1)lY(l)(r). (17)
m m
Connections between spherical harmonics and irreducible representations of SO(3). The
equivarianceofsphericalharmonicsindicatesthattherearestrongconnectionsbetweenthisfunction
classandgrouprepresentationtheory. TheY(l)’sofdegreelformabasissetoffunctionsforthe
m
irreduciblerepresentationoftheSO(3)grouponthe2l+1vectorspace(Kosmann-Schwarzbach
etal.,2010). EachirreduciblerepresentationofSO(3)canberealizedinafinite-dimensionalHilbert
spaceoffunctionsonthesphere,therestrictionsofharmonichomogeneouspolynomials3ofagiven
3Given a multivariate polynomial P over a field, if the polynomial p satisfies: (1) ∆P = 0; (2)
P(λx ,...,λx )=λdP(x ,...,x ),itiscalledaharmonichomogenouspolynomial.
1 n 1 n
18PublishedasaconferencepaperatICLR2024
degree, and such a representation is unitary. The orthonormal basis of this space is exactly the
introducedsphericalharmonics. Fromthisperspective,thesphericalharmonicsareproportionalto
theWigner-Dmatrixelements: Y m(l)(r)∝ √ 21 l+1D( ml) 0(g)giventhattherotationgisparameterized
by Euler angles (Pio, 1966) (α,β,γ), and the sphere point r is obtained by using the rotation g′
parameterizedby(α,β,0)onthex-unitvector. Bydefinition,thesphericalharmonicsareinvariant
totheγ-rotation, andtherelationstotheWigner-Dmatrixelementsshowtheconnectionstothe
irreduciblerepresentationsoftheSO(3)group.
A.5 TENSORPRODUCTOFREPRESENTATIONS
In the previous subsections, we defined the group representations on vector spaces. To map the
representationsbetweenvectorspaces,thetensorproductoperationprovidesaprincipledapproach,
with useful properties for constructing equivariant networks. Formally, given two vectors x =
x[x ⊗1,. y.., =x d x1 y]⊤
⊤
∈ ∈RR dd 11 ×, dy 2.= Giv[y e2 n, t. w.., oy rd e2 p]⊤ res∈ entR atd io2, nsth πe 1t :e Gnso →r p Gro Ld (u Vc 1t )b ae nt dw πee 2n :x Ga →nd Gy L(f Vol 2l )ow ons
vectorspacesV andV respectively,thetensorproductofrepresentationsisgivenbyπ ⊗π :G→
1 2 1 2
GL(V ⊗V ),i.e.,π ⊗π (g)=π (g)⊗π (g),whereπ (g)⊗π (g)isthetensorproductoflinear
1 2 1 2 1 2 1 2
mapspreviouslydefined. ThisoperationmapsrepresentationsonspacesV ,V totheV ⊗V space
1 2 1 2
withdimensionbeing(2l +1)×(2l +1). Then,theequivarianceofthetensorproductoperation
1 2
totheSO(3)groupisnaturaltoshow:
(D(l1)(g)⊗D(l2)(g))(x ⊗x )=(D(l1)(g)x )⊗(D(l2)(g)x ),forallx ∈V ,x ∈V , (18)
1 2 1 2 1 1 2 2
whereD(l1)(g)⊗D(l2)(g)isamatrixrepresentationofg ∈SO(3)inthevectorspaceV 1⊗V 2.
Clebsch-GordanTensorProduct. Asthetensorproductofrepresentationsisstillarepresentation
on the corresponding vector space, we can further decompose it into a direct sum of irreducible
representations, as shown in Eqn. (11). Then, the resulting vector of the tensor product can be
organizedviaachangeofbasisintopartsthatareindividuallytransformedbyWigner-Dmatricesof
differenttypes,i.e. x ⊗x ∈V =V ⊕V ⊕...⊕V ⊕...,withV beingthetype-lvectorspace.
1 2 0 1 l l
TheClebsch-GordanTensorProductprovidesawaytoexplicitlycalculatetheresultingtype-lvector
afterthedirectsumdecomposition. Givenx(l1) ∈R2l1+1andx(l2) ∈R2l2+1,them-thelementof
theresultingtype-lvectorofthetensorproductbetweenx(l1)andx(l2)isgivenby:
(x(l1)⊗ x(l2))(l) =
(cid:88)l1 (cid:88)l2
C(l,m) x(l1)x(l2), (19)
cg m (l1,m1)(l2,m2) m1 m2
m1=−l1m2=−l2
whereC(l,m) aretheClebsch-Gordancoefficients. Interestingly,theClebsch-Gordancoeffi-
(l1,m1)(l2,m2)
cientsarealsocloselyrelatedtoangularmomentumtheoryinquantummechanics(Varshalovichetal.,
1988),andhavevariousintriguingpropertiesthathaveunderlyingrelationshipstootherimportant
conceptsusedinthiswork.
PropertiesofClebsch-Gordancoefficients. TheClebsch-Gordancoefficientshavethefollowing
selectionrules:C(l,m) =0ifl<|l −l |orl>l +l . Thatis,atype-0vectorandatype-1
(l1,m1)(l2,m2) 1 2 1 2
vectorcannotproduceatype-2vectorviatheClebsch-Gordantensorproduct. TheClebsch-Gordan
coefficientshavethefollowingorthogonalityandsymmetryproperties:
Orthogonality: (cid:88) C(l,m) C(l,m′) =δ δ
(l1,m1)(l2,m2) (l1,m1)(l2,m2) ll′ mm′
m1,m2
(20)
(cid:88) C(l,m) C(l,m) =δ δ
(l1,m1)(l2,m2) (l1,m′ 1)(l2,m′ 2) m1m′ 1 m2m′ 2
l,m
Symmetry: C(l,m) =(−1)l1+l2−lC(l,−m)
(l1,m1)(l2,m2) (l1,−m1)(l2,−m2)
(21)
=(−1)l1+l2−lC(l,m)
(l2,m2)(l1,m1)
19PublishedasaconferencepaperatICLR2024
(cid:114) (cid:114)
2l+1 2l+1
=(−1)l1−m1 C(l2,−m2) =(−1)l2+m2 C(l1,−m1)
2l 2+1 (l1,m1)(l,−m) 2l 1+1 (l,−m)(l2,m2)
(cid:114) (cid:114)
2l+1 2l+1
=(−1)l1−m1 C(l2,m2) =(−1)l2+m2 C(l1,m1)
2l 2+1 (l,m)(l1,−m2) 2l 2+1 (l2,−m2)(l,m)
A.6 RELATIONSHIPBETWEENCLEBSCH-GORDAN,WIGNER3-JANDGAUNTCOEFFICIENTS.
WearemotivatedbytheorthogonalityandsymmetryoftheClebsch-Gordancoefficientstoexplore
furtherrelationstotwootherconcepts,Wigner3-jsymbolsandGauntcoefficients(Wigner,1965).
Theseconceptsarewidelyusedinquantummechanics,andinspiretheapproachespresentedinthe
mainbodyofthiswork.
Inquantummechanics,theWigner3-jsymbolsareanalternativetoClebsch-Gordancoefficients,
withthepurposeofaddingangularmomenta. Mathematically,theWigner3-jsymbolsarerelatedto
Clebsch-Gordancoefficientsas:
C(l,m) =
(−1 √)−l1+l2−m (cid:18) ,l
1
l
2
l (cid:19)
(22)
(l1,m1)(l2,m2) 2l+1 m 1 m 2 −m
(cid:18) (cid:19)
l l l
where 1 2 denotestheWigner3-jsymbolthathasthefollowingexplicitexpression:
m m m
1 2
(cid:32) (cid:33)
l1 l2 l
≡δ(m1+m2+m,0)(−1)l1−l2−m
m1 m2 m
(cid:115)
×
(l1+l2−l)!(l1−l2+l)!(−l1+l2+l)!
(l1+l2+l+1)!
(cid:113)
× (l1−m1)!(l1+m1)!(l2−m2)!(l2+m2)!(l−m)!(l+m)!
(cid:88)N (−1)k
× ,
k=Kk!(l1+l2−l−k)!(l1−m1−k)!(l2+m2−k)!(l−l2+m1+k)!(l−l1−m2+k)!
(23)
whereKandN aresetasK =max(0,l −l−m ,l −l+m ),N =min(l +l −l,l −m ,l +m )
2 1 1 2 1 2 1 1 2 2
andfactorialsofnegativenumbersareconventionallytakenequaltozero. TheWigner3-jsymbols
are highly symmetric. They are also invariant under an even permutation of their columns, and
enumerateaphasefactorunderanoddpermutationorchangingthesignofthemnumbers. The
Wigner3-jsymbolsalsohavetheso-calledReggesymmetries(Zhedanovetal.,1988).
TheWigner3-jsymbolsarerelatedtosphericalharmonicsviatheGauntcoefficients. whicharethe
integralsoftheproductsofthreesphericalharmonics:
(cid:90) 2π(cid:90) π
Y(l1)(θ,ψ)Y(l2)(θ,ψ)Y(l)(θ,ψ)sinθdθdψ
m1 m2 m
0 0
(24)
(cid:114) (cid:18) (cid:19)(cid:18) (cid:19)
=
(2l 1+1)(2l 2+1)(2l+1) l
1
l
2
l l
1
l
2
l
.
4π 0 0 0 m 1 m 2 m
TheGauntcoefficientsareusedinquantummechanicalcomputations,e.g.,multi-centermolecular
integrals(Huzinaga,1967). Inthiswork,weusetheirrelationstotheClebsch-Gordancoefficientsto
acceleratethetensorproductofrepresentations,therebyimprovingtheefficiencyofdifferentclasses
ofequivariantoperations. Fromtheaboverelations,weconcludethissubsectionwiththefollowing
equivalence:
(cid:90) 2π(cid:90) π
Y(l1)(θ,ψ)Y(l2)(θ,ψ)Y(l)(θ,ψ)sinθdθdψ =C˜(l) C(l,m) , (25)
m1 m2 m (l1,l2) (l1,m1)(l2,m2)
0 0
whereC˜(l) isaconstantonlydeterminedbyl ,l ,andl.Thisequivalenceinspiresthedevelopment
(l1,l2) 1 2
oftheGauntTensorProductpresentedinthemainbodyofthiswork.
We note one difference between employing Clebsch-Gordan coefficients and Gaunt coefficients
in the tensor product computation, namely that the Gaunt coefficients impose more symmetry
20PublishedasaconferencepaperatICLR2024
constraints. Forinstance,thetensorproductwithGauntcoefficientsexcludespseudovectorsfromthe
output. However,weempiricallyobservethatthisdoesnothurtperformance(Seethesanitycheck
experimentsinSection4).Wealsonotethatseveralexistingmodelsthatachievedstrongperformance
inreal-worldapplications(Brandstetteretal.,2022;Batzneretal.,2022;Batatiaetal.,2022b)that
considertheparityofirrepsdonotuseirrepsofevenparities, e.g., pseudovectors, incomputing
equivariantrepresentations. Inthesecases,thetensorproductwithClebsch-Gordancoefficientsis
equivalenttothetensorproductwithGauntcoefficients.
A.7 ANGULARMOMENTUM,TENSOROPERATORSANDWIGNER-ECKARTTHEOREM
Intheprevioussubsection,weintroducedtherelationsbetweentheClebsch-Gordancoefficientsand
theGauntcoefficients,whichserveasthekeytomotivatethenewperspectiveontensorproducts
ofirrepsviaGauntcoefficientsinSection3.1. Forcompleteness,wethoroughlyelaborateonthe
necessary knowledge to derive this equivalence in this subsection. First, we leverage the lens of
angular momentum in quantum mechanics to describe spherical harmonics and Clebsch-Gordan
coefficients. WethenelaborateontheconceptsoftensoroperatorsandtheWigner-Eckarttheorem,
whichweusetorelateClebsch-GordancoefficientsandGauntcoefficients,asintroducedbelow.
A.7.1 PRELIMINARY
Weintroduceseveralmathematicalconceptsthatareusedinquantummechanics.
HilbertspaceandDiracnotation(“bra-ket”notation). AHilbertspaceHisanabstractvector
spacesatisfyingthefollowingconditions: (1)itisequippedwiththeinnerproductoperation;(2)itis
acompletemetricspacewithrespecttothedistancefunctioninducedbytheinnerproduct. Atypical
exampleofaHilbertspaceisthethree-dimensionalEuclideanvectorspaceR3,whichisequipped
with an inner product operation known as the dot product · : R3 ×R3 → R. As a general and
abstractconcept,Hilbertspacesallowmathematicaltoolslikelinearalgebrafor(finite-dimensional)
Euclideanvectorspacestospacesthatmaybeinfinite-dimensional,e.g.,functionspacesfrequently
usedinphysics.
InHilbertspaceH,weinsteadusebra-ketnotationtodescribeoursystem. VectorsintheHilbert
spaceHarewrittenaskets: |α⟩ ∈ H. TheoperationalrulesfromEuclideanvectorspacearealso
generalizedas,
1. Addition: |α⟩+|β⟩ = |β⟩+|α⟩(commutative),|α⟩+(|β⟩+|γ⟩) = (|α⟩+|β⟩)+|γ⟩
(associative);
2. Scalar product: (c +c )|α⟩ = c |α⟩+c |α⟩, c (c |α⟩) = (c c )|α⟩, c(|α⟩+|β⟩) =
1 2 1 2 1 2 1 2
c|α⟩+c|β⟩,1|α⟩=|α⟩,wherethescalarsarecomplexc∈C(aswewilldealexclusively
withcomplexHilbertspacesforquantummechanics);
3. Nullket|∅⟩: |α⟩+|∅⟩=|α⟩,0|α⟩=|∅⟩;
4. Inverse: anyket|α⟩hasacorrespondinginverse|−α⟩,andwehave|α⟩+|−α⟩ = |∅⟩,
|−α⟩ = −|α⟩. ForanN-dimensionalHilbertspace,thereexistsasetofN ketswhich
constitute a basis, and any ket can be expressed as a sum of the basis kets, i.e., |α⟩ =
(cid:80)N α |λ ⟩,α ∈C.
i=1 i i i
WefurtherdefinetheinnerproductinaHilbertspace,i.e.,amapwhichtakestwoketsandreturnsa
scalar(complexnumber): (·,·):H×H→C. Withthisdefinition,wenowdefinethebranotation,
whichiswrittenasabackwards-facingket⟨α|. Wehavetheone-to-onecorrespondencefromketsto
brasandvice-versa:
1. |α⟩↔⟨α|;
2. c |α⟩+c |β⟩↔c∗⟨α|+c∗⟨β|,
α β α β
wherec∗,c∗ ∈Carethecomplexconjugatesofc ,c ∈C. Byusingthebra-ketnotation,theinner
α β α β
productoftwoketsinaHilbertspacecanbewrittenasaproductofabraandaket:(|α⟩,|β⟩)≡⟨α|β⟩.
Inthisnotation,theinnerproducthasthefollowingproperties:
21PublishedasaconferencepaperatICLR2024
1. linearity(inthebras): (c⟨α|)|β⟩=c⟨α|β⟩and(⟨α |+⟨α |)|β⟩=⟨α |β⟩+⟨α |β⟩;
1 2 1 2
2. linearity(inthekets): ⟨α|(c|β⟩)=c⟨α|β⟩and⟨α|(|β ⟩+|β ⟩)=⟨α|β ⟩+⟨α|β ⟩;
1 2 1 2
3. conjugatesymmetry: ⟨α|β⟩=⟨β|α⟩∗;
4. positivesemi-definiteness: ⟨α|α⟩≥0.
From(3),wecanseethattheorderoftheketsmattersintheproduct. Infact,abradenotesalinear
mapthatmapsketsinHtoC,i.e.,(|α⟩,·)≡⟨α|. Wesaythattwokets|α⟩and|β⟩areorthogonal
iftheirinnerproductiszero,i.e.,⟨α|β⟩=⟨β|α⟩=0⇒|α⟩⊥|β⟩. Again,analogoustoEuclidean
(cid:112)
vectorspace,weuse||α||≡ ⟨α|α⟩todenotethenormoftheket|α⟩.
Aspreviouslymentioned,thethree-dimensionalEuclideanvectorspaceisoneexampleoftheHilbert
spacewithfinitedimensions. Here,weprovideanexampleofinfinite-dimensionalHilbertspacesfor
illustration. Considerafunctiony(x)=(cid:80)∞ c sin(nπx),x∈R: eachketinthisspacerepresents
n=1 n L
afunction,andthebasisketsaregivenbytheinfinitesetoffunctions|n⟩=sin(nπx)(wecanusen
L
intheketnotationforbrevity,becauseitistheidentityindexinthisHilbertspace). Inthisspace,the
innerproductisdefinedbetweenfunctionsas⟨y |y ⟩≡ 2 (cid:82) y (x)y (x)dx.
1 2 L 1 2
Operators. TodescribethemappingbetweenketsinaHilbertspace,weintroducetheconcept
ofoperators,i.e.,Oˆ :H→H. Ingeneral,propertiesofoperatorsinclude:
1. Equality: Aˆ=Bˆ ifAˆ|α⟩=Bˆ|α⟩forall|α⟩;
2. Null: thereexistsaspecialoperatorˆ0suchthatˆ0|α⟩=|∅⟩forall|α⟩;
3. Identity: thereexistsanotherspecialoperatorˆ1suchthatˆ1|α⟩=|α⟩forall|α⟩;
4. Addition: Aˆ+Bˆ =Bˆ+AˆandAˆ+(Bˆ+Cˆ)=(Aˆ+Bˆ)+Cˆ;
5. Scalarmultiplication: (cAˆ)|α⟩=Aˆ(c|α⟩);
6. Multiplication: (AˆBˆ)|α⟩=Aˆ(Bˆ|α⟩).
AlinearoperatorAˆhasthedistributivelaw,i.e.,Aˆ(c |α⟩+c |β⟩)=c Aˆ|α⟩+c Aˆ|β⟩. UsingR3
α β α β
asanexample,linearoperatorsarethusmatricesR3×3.
WeuseAˆ−1 todenotetheinverseoperatorofAˆ,andAˆ−1Aˆ|α⟩ = ˆ1|α⟩. Equippedwiththeinner
product of a Hilbert space, we can define the adjoint of an operator denoted with a dagger by
(|α⟩,Aˆ|β⟩)=(Aˆ†|α⟩,|β⟩)foranychoiceof|α⟩and|β⟩. Combinedwiththeoperations,theadjoint
hasthefollowingproperties: (1)(cAˆ)† = c∗Aˆ†; (2)(Aˆ+Bˆ)† = Aˆ† +Bˆ†; (3)(AˆBˆ)† = Bˆ†Aˆ†.
Oneimportantclassofoperatorsarethosethatareself-adjoint,i.e.,Aˆ† =Aˆ,whicharealsoknown
asHermitianoperators. Iftheadjointgivestheinverseoperator,i.e.,Uˆ† = Uˆ−1,thesearecalled
unitaryoperators,andactlikearotationintheHilbertspace.
Similartomatrices,theorderoftheoperatorsmatterswhenwemultiplythem,andthedifference
betweenthetwoorderingshasaspecialsymbolcalledthecommutator: [Aˆ,Bˆ] = AˆBˆ −BˆAˆ. If
thecommutatoroftwooperatorsiszero,wesaytheycommute. Propertiesofcommutatorsinclude:
1. [Aˆ,Aˆ]=0;
2. [Aˆ,Bˆ]=−[Bˆ,Aˆ];
3. [Aˆ+Bˆ,Cˆ]=[Aˆ,Cˆ]+[Bˆ,Cˆ];
4. [Aˆ,BˆCˆ]=[Aˆ,Bˆ]Cˆ+Bˆ[Aˆ,Cˆ];
5. [AˆBˆ,Cˆ]=Aˆ[Bˆ,Cˆ]+[Aˆ,Cˆ]Bˆ;
6. [Aˆ,[Bˆ,Cˆ]]+[Bˆ,[Cˆ,Aˆ]]+[Cˆ,[Aˆ,Bˆ]]=0.
OneintriguingpropertyoftwoHermitianoperatorsthatcommutewitheachotheristhatwecan
simultaneouslyfindtheireigenkets. Thispropertyrelatestothemeasurementinquantummechanics.
22PublishedasaconferencepaperatICLR2024
Eigenkets, basis kets and matrix elements of operators. Analogous to linear algebra in the
Euclideanvectorspace,wedefinetheeigenketsofanoperatorAˆastheketswhichareleftinvariant
uptoascalarmultiplication,i.e.,Aˆ|a⟩=a|a⟩,wherethescalaraistheeigenvalueassociatedwith
eigenket|a⟩(byconvention,weuseeigenvaluesasindexesforeigenkets). Notethateigenketsare
alsocalledeigenstatesinthecontextofquantummechanics.
RecallthateachketinaHilbertspacecanbeexpressedasalinearcombinationofthebasiskets. In
fact,therealwaysexistsanorthonormalbasis,i.e.,asetofbasisketswhicharemutuallyorthogonal
andhavenorm1. Letususe|e ⟩todenotesuchanorthonormalbasis. Thenwehave⟨e |α⟩ =
n m
(cid:80) (cid:80)
α ⟨e |e ⟩=α ,and|α⟩= (|e ⟩⟨e |)|α⟩. Infact,weintroduceaspecialoperatorcalled
n n m n m n n n
projectionoperator,i.e.,Λ =|e ⟩⟨e |,whichproject|α⟩ontooneofthebasiskets|e ⟩.
n n n n
Byusingthebasiskets,wecannowrepresentanyketasacolumnvectorconsistingofthecoefficients
correspondingtothebasiskets: |ψ⟩ = (cid:80) ψ |e ⟩ = [ψ ,...,ψ ,...]⊤,andtheassociatedbra⟨ψ|
n n n 1 n
istheconjugatetranspose,i.e.,arowvectorwhoseentriesarethecomplexconjugatesoftheψ ’s:
n
⟨ψ| = (cid:80) ψ∗⟨e | = [ψ∗,...,ψ∗,...]. Now, we have ⟨χ|ψ⟩ = (cid:80) χ∗ψ and (|ψ⟩⟨χ|) = ψ χ∗.
n n n 1 n i i i ij i j
Specially,wehave|e ⟩⟨e |beinganalmostzeromatrixexceptforthe(1,1)-thentrybeing1.
1 1
Thus,anyoperatorAˆcanbesimilarlyrepresentedasamatrixform:
 ⟨e |Aˆ|e ⟩ ⟨e |Aˆ|e ⟩ ... 
Aˆ=(cid:88)(cid:88) |e m⟩⟨e m|Aˆ|e n⟩⟨e n|→ ⟨e1 2|Aˆ|e1 1⟩ ⟨e1 2|Aˆ|e2 2⟩ ...  (26)
m n ... ... ...
Theentriesofthematrix⟨e |Aˆ|e ⟩areknownasmatrixelementsofoperators. Therealsoexistsa
m n
relationbetweenthematrixelementsofAˆanditsadjointAˆ†: ⟨e |Aˆ|e ⟩=⟨e |Aˆ†|e ⟩∗.
m n n m
A.7.2 ABRIEFOVERVIEWOFANGULARMOMENTUMINQUANTUMMECHANICS
MomentumOperatorandPositionOperator. Beforewegointotheconceptofangularmomen-
tuminquantummechanics,wediscusstwobasicexamplesofoperatorsthatwewilluselater. Here,
weuseaconcreteexampletoseehowpreviouslyintroducedconceptsarereflectedinreal-world
systems: the1DDeBroglieplanewavefunctionforafreeparticlewithmomentumpandenergyE,
i.e.,Ψ(x,t)=ei(kx−ωt),wherep=ℏk,E =ℏω,E = p2 ,ℏdenotesthePlanckConstant,andm
2m
denotesthemassoftheparticle. Toextractthevalueofmomentumfromthewavefunction,wecan
usethefollowingoperator:
ℏ ∂ ℏ ∂ ℏ ℏ
Ψ(x,t)= ei(kx−ωt) = (ik)ei(kx−ωt) = (ik)Ψ(x,t)=ℏkΨ(x,t)=pΨ(x,t)
i ∂x i ∂x i i
(27)
Wethendefinethemomentumoperator,pˆ,aspˆ= ℏ ∂ =−iℏ ∂ . Moreover,wecanseethatΨ(x,t)
i ∂x ∂x
indeedliesinaHilbertfunctionalspace,andisaneigenstateofthemomentumoperatorpˆbecause
Ψ(x,t)isleftinvariantuptoascalarpbeingmultipliedaftertheactionofpˆ.
Anotherimportantoperatoristhepositionoperatorxˆ,whichactsonfunctionsofx,andgivesanother
functionofxasfollows:
xˆf(x)≡xf(x). (28)
Infact,boththeoperatorxˆandpˆarerelated. Givensomearbitraryfunctionϕ(x),thecommutator
[xˆ,pˆ]hasthefollowingequivalence:
(cid:18) (cid:19)
∂ϕ(x)
[xˆ,pˆ]ϕ(x)=(xˆpˆ−pˆxˆ)ϕ(x)=xˆpˆϕ(x)−pˆxˆϕ(x)=xˆ(pˆϕ(x))−pˆ(xˆϕ(x))=xˆ −iℏ −pˆ(xϕ(x)),
∂x
∂ϕ(x) ∂ ∂ϕ(x) ∂ϕ(x)
=−iℏx +iℏ (xϕ(x))=−iℏx +iℏx +iℏϕ(x)=iℏϕ(x).
∂x ∂x ∂x ∂x
(29)
Thus,weobtainafundamentalcommutationrelationinquantummechanics: [xˆ,pˆ]=iℏ. Itisalso
straightforwardtogeneralizebothxˆandpˆtothreedimensions:
(cid:18) (cid:19)
∂ ∂ ∂
pˆ =(pˆ ,pˆ ,pˆ )=−iℏ∇⃗ =−iℏ , , ,
x y z ∂x ∂y ∂z (30)
xˆ =(xˆ,yˆ,zˆ).
23PublishedasaconferencepaperatICLR2024
Andthecommutationrelationshipsareasfollows:
[xˆ,pˆ ]=iℏ,[yˆ,pˆ ]=iℏ,[zˆ,pˆ ]=iℏ, (31)
x y z
withallothercommutatorsinvolvingthethreecoordinatesandmomentabeingzero.
AngularMomentumOperator. Wearenowreadytointroducetheconceptofangularmomentum
inquantummechanics.Thishelpsusunderstandtheunderlyingrelationsbetweensphericalharmonics
andClebsch-Gordancoefficients,asstatedinSection3.1.Inclassicalphysics,theangularmomentum
ofaparticlewithmomentumpandpositionrisdefinedbyL = r×p, andeachcomponentof
L = (L ,L ,L )isgivenbyL = yp −zp ,L = zp −xp ,L = xp −yp . Similarly,the
x y z x z y y x z z y x
angularmomentumoperatorLˆ =(Lˆ ,Lˆ ,Lˆ )canbeobtainedasfollows:
x y z
Lˆ =yˆpˆ −zˆpˆ ,
x z y
Lˆ =zˆpˆ −xˆpˆ , (32)
y x z
Lˆ =xˆpˆ −yˆpˆ .
z y x
Fromthedefinition,wecancheckthattheangularmomentumcomponentsareHermitianoperators:
Lˆ† = Lˆ ,Lˆ† = Lˆ ,Lˆ† = Lˆ . ThesquareofLˆ isalsoHermitian,whichisLˆ2 = Lˆ2 +Lˆ2 +Lˆ2.
x x y y z z x y z
Therefore,alltheangularmomentumoperatorshaverealeigenvalues.
EigenstatesandeigenvaluesofAngularMomentumOperators. Recallthatwecansimultane-
ouslyfindtheeigenstatesoftwoHermitianoperatorsthatcommutewitheachother. Infact,wehave
thefollowingcommutationrelationsforangularmomentumoperators:
[Lˆ ,Lˆ ]=iℏLˆ ,[Lˆ ,Lˆ ]=iℏLˆ ,[Lˆ ,Lˆ ]=iℏLˆ , (33)
x y z y z x z x y
[Lˆ ,Lˆ2]=0,[Lˆ ,Lˆ2]=0,[Lˆ ,Lˆ2]=0. (34)
x x x
ThismeansthatwecansimultaneouslyfindtheeigenstatesofLˆ andLˆ2(alsoforLˆ ,Lˆ ).Toachieve
z x y
this,letusfirstturnourviewfromtheCartesiancoordinatesystemstothesphericalcoordinatesystem,
forconvenience:
(cid:112)
x=rsinθcosϕ, r = x2+y2+z2,
(cid:16)z(cid:17)
y =rsinθsinϕ, θ =cos−1 ,
r
(35)
(cid:16)y(cid:17)
z =rcosθ, ϕ=tan−1 .
x
BythedefinitionLˆ =xˆpˆ −yˆpˆ ,wehave:
z y x
(cid:18) (cid:19)
∂ ∂
Lˆ =−iℏ x −y . (36)
z ∂y ∂x
Infact,thisisrelatedto ∂ bythechainrule: ∂ = ∂x ∂ + ∂y ∂ + ∂z ∂ =x ∂ −y ∂ ,i.e.,
∂ϕ ∂ϕ ∂ϕ∂x ∂ϕ∂y ∂ϕ∂z ∂y ∂x
∂
Lˆ =−iℏ ,
z ∂ϕ
(cid:18) (cid:19)
∂ ∂
Lˆ =iℏ sinϕ +cotθcosϕ ,
x ∂θ ∂ϕ
(cid:18) (cid:19) (37)
∂ ∂
Lˆ =iℏ −cosϕ +cotθsinϕ ,
y ∂θ ∂ϕ
(cid:20) 1 ∂ (cid:18) ∂ (cid:19) 1 ∂2 (cid:21)
Lˆ2 =−ℏ2 sinθ + .
sinθ∂θ ∂θ sin2θ∂ϕ2
SincewecanconstructthesimultaneouseigenstatesofbothLˆ andLˆ2,weusetheunionoftheir
z
eigenvalues (l,m) to index these simultaneous eigenstates as |l,m⟩, and establish the following
equations:
Lˆ |l,m⟩=m|l,m⟩,
z
(38)
Lˆ2|l,m⟩=l|l,m⟩,
24PublishedasaconferencepaperatICLR2024
wherem,l∈RbecausebothLˆ andLˆ2areHermitianoperators.Letusnowsolvethefirsteigenvalue
z
equationusingthecoordinatesystemforLˆ =−iℏ ∂ ,anddenote|l,m⟩usingitsfunctionalform
z ∂ϕ
ψ : −iℏ∂ψl,m = mψ → ∂ψl,m = imψ . From this equation, we can determine the ϕ
l,m ∂ϕ l,m ∂ϕ ℏ l,m
dependenceofthesolutionandrewriteψ l,m(θ,ϕ)=eim ℏϕP l,m(θ),whereP l,m(θ)capturesthestill
undeterminedθdependenceoftheeigenstateψ . Asafunctionoftheangles,itisrequiredthat
l,m
ψ
l,m
isuniquelydefined: ψ l,m(θ,ϕ+2π)=ψ l,m(θ,ϕ),fromwhichwecanobtaineim ℏ2π =1. If
weinsteadwritethiseigenvalueequationasLˆ |l,m⟩=ℏm|l,m⟩,wethushavethefactthatm∈Z.
z
Similarly,itcanbeshownthatthepossiblevaluesoflarel∈Nand−l≤m≤l,withtheeigenvalue
equationsbeingwrittenas,
Lˆ |l,m⟩=ℏm|l,m⟩,
z
(39)
Lˆ2|l,m⟩=ℏ2l(l+1)|l,m⟩.
AfterdeterminingtheeigenvaluesofoperatorsLˆ andLˆ2,thenextstepistoobtaintheformofthe
z
eigenstates|l,m⟩. Byusingthefunctionalform,werewritethesecondequationas:
(cid:20) 1 ∂ (cid:18) ∂ (cid:19) 1 ∂2 (cid:21)
ℏ2 sinθ + +l(l+1) ψ (θ,ϕ)=0. (40)
sinθ∂θ ∂θ sin2θ∂ϕ2 l,m
ThisisexactlytheLaplacianequationinthesphericaldomain(Sommerfeld,1949),andthesolution
is exactly the spherical harmonics ψ (θ,ϕ) ≡ Y(l)(θ,ϕ) with −l ≤ m ≤ l,l = 0,1,2,...,, as
l,m m
introducedinSectionA.4.Inthecontextofquantummechanics,itisconventionaltousetheket|l,m⟩
todenotethesphericalharmonicsY(l),andspecifyitinthesphericalcoordinaterepresentationas
m
⟨θ,ϕ|l,m⟩≡Y(l)(θ,ϕ). Infact,thesetofkets{|l,m⟩|−l≤m≤l}exactlyformsanorthonormal
m
basisfortheHilbertspacewith2l+1dimension.
AdditionofAngularMomentumOperators. Inquantummechanics,weoftenconsidersystems
withtwophysicallydifferentangularmomenta,e.g.,theorbitalangularmomentaoftwoelectrons.
It means that the angular momentum operators jointly act on two Hilbert spaces with different
dimensions,whichpromptsustodefinetheconceptofthetotalangularmomentumoperator. Given
twoangularmomentumoperatorsˆj andˆj actingonspacesV andV with2l +1and2l +1
1 2 1 2 1 2
dimensionsrespectively,thesetwospacesarespannedbytheeigenstates|l ,m ⟩,−l ≤m ≤l
1 1 1 1 1
and|l ,m ⟩,−l ≤ m ≤ l . Thetotalangularmomentumoperatoristheadditionofthesetwo
2 2 2 2 2
operators,andactsonthetensorproductspaceV ≡V ⊗V with(2l +1)×(2l +1)dimension,
3 1 2 1 2
whichisspannedby|l ,m ,l ,m ⟩ ≡ |l ,m ⟩⊗|l ,m ⟩,−l ≤ m ≤ l ,−l ≤ m ≤ l . We
1 1 2 2 1 1 2 2 1 1 1 2 2 2
call|l ,m ,l ,m ⟩theuncoupledtensorproductbasis. Givenanyangularmomentumoperatorˆj,it
1 1 2 2
isdefinedtoactonstatesinV inthefollowingmanner:
3
(ˆj⊗1ˆ)|l ,m ,l ,m ⟩≡ˆj|l ,m ⟩⊗|l ,m ⟩,
1 1 2 2 1 1 2 2
(41)
(1ˆ⊗ˆj)|l ,m ,l ,m ⟩≡|l ,m ⟩⊗ˆj|l ,m ⟩,
1 1 2 2 1 1 2 2
where1ˆdenotestheidentityoperator. Thetotalangularmomentumoperatorsarethendefinedas:
Jˆ ≡ˆj ⊗1ˆ+1ˆ⊗ˆj (42)
1 2
SimilartoEqn. (33),thetotalangularmomentumoperatorsalsohavethefollowingcommutative
relationship:
[Jˆ ,Jˆ]=iℏJˆ,[Jˆ,Jˆ]=iℏJˆ ,[Jˆ,Jˆ ]=iℏJˆ, (43)
x y z y z x z x y
[Jˆ ,Jˆ2]=0,[Jˆ ,Jˆ2]=0,[Jˆ ,Jˆ2]=0 (44)
x x x
Therefore,asetofcoupledeigenstatesalsosimultaneouslyexistsforJˆ2andJˆ,whichwedenoteas
z
|l ,l ;L,M⟩. Thishasthefollowingeigenvalueequations:
1 2
Jˆ|l ,l ;L,M⟩=ℏM|l ,l ;L,M⟩
z 1 2 1 2
(45)
Jˆ2|l ,l ;L,M⟩=ℏ2L(L+1)|l ,l ;L,M⟩
1 2 1 2
where −L ≤ M ≤ L, |l −l | ≤ L ≤ l +l , and the total number of eigenstates of the total
1 2 1 2
angular momentum operator is exactly equal to the dimension of the tensor product space V :
3
25PublishedasaconferencepaperatICLR2024
(cid:80)l1+l2
(2L+1) = (2l +1)×(2l +1). Both the uncoupled tensor product basis and the
L=|l1−l2| 1 2
coupledeigenstatesformabasisforthetensorproductspace,i.e.,theyarerelatedviaachangeof
basis:
(cid:88)l1 (cid:88)l2
|l ,l ;L,M⟩= |l ,m ,l ,m ⟩⟨l ,m ,l ,m |L,M⟩, (46)
1 2 1 1 2 2 1 1 2 2
m1=−l1m2=−l2
wheretheexpansioncoefficients⟨l ,m ,l ,m |L,M⟩aretheClebsch-Gordancoefficientsdenoted
1 1 2 2
asC(L,M) ,whichwepreviouslyintroducedinAppendixA.5.
(l1,m1)(l2,m2)
In summary, spherical harmonics correspond to the eigenstates of angular momentum operators,
whiletheClebsch-Gordancoefficientsserveastheexpansioncoefficientsofcoupledeigenstatesof
totalangularmomentumoperatorsinanuncoupledtensorproductbasis. Thisindicatesanunderlying
relationshipbetweenthesetwoconcepts,whichwewillfurtherrevealbyusingtheWigner-Eckart
theorembelow.
A.7.3 TENSOROPERATORSANDWIGNER-ECKARTTHEOREM
RotationOperator. AsweintroducedinSection2,representationsoftherotationgroupSO(3)
on R3 are parameterized by orthogonal transformation matrices R ∈ R3×3,det(R) = 1, which
areappliedtox∈R3 viamatrixmultiplicationRx. EachrotationmatrixRhastheexplicitform
thatisspecifiedbytherotationaxisandangle, e.g.,rotationbyangleϕaboutthez-axisisgiven
(cid:32) cosϕ −sinϕ 0 (cid:33)
byR (ϕ)= sinϕ cosϕ 0 . WealsouseR(⃗n,ϕ)todenotetherotationg ∈SO(3)that
z
0 0 1
performsrotationbyangleϕaboutthe⃗n ∈ R3,||⃗n|| = 1direction. Inquantummechanics,given
anyrotationR(⃗n,ϕ),thereexistsaunitaryoperatorUˆ(⃗n,ϕ)thattransformsaketfromtheunrotated
coordinatesystemtotherotatedone,i.e.,|ψ⟩ = Uˆ(⃗n,ϕ)|ψ⟩. Thepreviouslyintroducedangular
R
momentumoperatorLˆ isexactlythegeneratoroftherotationoperatorUˆ:
−i(Lˆ ·⃗n)ϕ
Uˆ(⃗n,ϕ)=exp( ). (47)
ℏ
Recallthatgivenl∈N,theeigenstatesofangularmomentumoperators|l,m⟩,−l≤m≤lforma
basisfortheHilbertspacewith2l+1dimension,i.e.,anyket|α⟩inthisspacecanbeexpressedas
|α⟩=(cid:80)l α |l,m⟩. WecanalsocalculatethematrixelementoftherotationoperatorUˆ(⃗n,ϕ)
m=−l m
correspondingtog ∈SO(3)byusingthisbasis:
(cid:32) (cid:33)
−i(Lˆ ·⃗n)ϕ
D(l) (g)≡⟨l,m′|exp |l,m⟩, (48)
m′m ℏ
whichisexactlytheWigner-Dmatrixintheshapeof(2l+1)×(2l+1),asintroducedinSection2.
Hence,therotatedket|α′⟩canbeexpressedas:
|α′⟩=Uˆ(⃗n,ϕ)|α⟩= (cid:88) α |l,m′⟩⟨l,m′|Uˆ(⃗n,ϕ)|l,m⟩= (cid:88) D(l) (g)α |m′⟩.
m m′m m (49)
m′,m m′,m
Therefore,therotationtransformationforketsinthe2l+1-dimensionalspacespannedby|l,m⟩,−l≤
m≤lcanalsobecomputedthroughmatrixmultiplication:
α′ =(cid:88) D(l) (g)α .
m′ m′m m (50)
m
VectorOperatorsandTensorOperators. Classically, a(three-dimensional)vectorisdefined
byitspropertiesunderrotation: thethreecomponentscorrespondingtotheCartesianx,y,z axes
transform as V →
(cid:80)3
R V . A tensor is a generalization of such a vector to an object with
i j=1 ij j
more than one index, e.g., T or T (with 3×3 and 3×3×3 components respectively), and
ij ijk
satisfiestheconditionthatthesecomponentsmixamongthemselvesunderrotationbyeachindividual
(cid:80)
indexfollowingthevectorruleT → R R R T . Tensorswrittenlikethisarecalled
ijk il jm kn lmn
26PublishedasaconferencepaperatICLR2024
Cartesiantensors,andthenumberofindexesisdenotedastherankoftheCartesiantensor,i.e.,a
ranknCartesiantensorhas3ncomponentsintotal.
Inquantummechanics,anoperatorVˆ iscalledavectoroperatoriftheexpectedvaluesofitsthree
componentsinanykettransformlikethecomponentsofaclassical3Dvectorunderrotation:
Uˆ†VˆUˆ =(cid:88) R Vˆ ,
i ij j (51)
j
whereUˆ denotesthecorrespondingunitaryrotationoperatoroftherotationmatrixR. Givenany
ket|α⟩anditsrotatedket|α′⟩viatherotationoperatorUˆ,wecanchecktheexpectedvalueofthe
vectoroperatorVˆ intherotatedsystem:
⟨α′|Vˆ|α′⟩=⟨α|Uˆ†VˆUˆ|α⟩=(cid:88) R ⟨α|Vˆ |α⟩.
i i ij j (52)
j
Thisexactlymeetstherequirementfortheexpectedvaluesofitsthreecomponentsunderrotation.
Similarly,wecanfurthergeneralizetoCartesiantensoroperators,whichsatisfytheconditionthat
theexpectedvaluesofitscomponentsinanykettransformlikethecomponentsofaclassicaltensor
underrotation.
AlthoughaCartesiantensoriseasytodenote,itisusuallyhardtoworkwith,especiallywhendealing
withrotations. Instead,wefurtherdefinetheconceptofsphericaltensoroperators. Givenabasisket
|l,m⟩forthe2l+1-dimensionalHilbertspace,itistransformedviaarotationUˆ(⃗n,ϕ)as:
Uˆ(⃗n,ϕ)|l,m⟩=(cid:88) |l,m′⟩⟨l,m′|Uˆ(⃗n,ϕ)|l,m⟩=(cid:88) |l,m′⟩D(l) (g),
m′m (53)
m′ m′
whereg ∈SO(3)correspondstotherotationUˆ(⃗n,ϕ).Fromthisequation,wecanseethattherotation
actsseparatelyondifferent2l+1-dimensionalHilbertspacesspannedbydifferentsetsofbasiskets
|l,m⟩,l∈N. Bydoingthis,wecanhandlethisrotation. Sphericaltensoroperatorsofranklarede-
finedasfamiliesT(l) =(T(l),...,T(l))⊤of2l+1operatorsT(l)thatsatisfythefollowingconstraint:
−l l m
l
Uˆ†T(l)Uˆ = (cid:88) T(l)D(l) (g). (54)
m m′ m′m
m′=−l
Sincethetransformationruleofthesphericaltensoroperatorsoriginatesfromthepropertiesofthe
eigenstatesofangularmomentumoperator|l,m⟩,sphericalharmonicsY(l) areaspecialclassof
m
sphericaltensoroperators.
Wigner-Eckarttheorem. RecallthatallinformationaboutanoperatorAˆ:H→Hisencodedby
itsmatrixelements⟨e |Aˆ|e ⟩withthebasise ,m=1,...,. Fromthedefinitionsofvectoroperators
m n m
andsphericalharmonicsoperators, wecanseetheirunderlyingsymmetryconstraints, indicating
restricted freedom. Due to this, the matrix elements of such operators are fully specified by a
comparativelysmallnumberofelements,whicharecalledreducedmatrixelementsinthecontextof
quantummechanics. ThisreductionforoperatorsisexactlydescribedbytheWigner-Eckarttheorem.
Forclarity,wediscussthistheoreminitsmostpopularform,i.e.,forsphericaltensoroperators.
Givensphericaltensoroperatorsofrankj,itisnaturaltousetheeigenstatesofangularmomentum
operators |l,m⟩ as the basis to calculate the matrix elements. By fixing j,l,J, there are 2j +1
componentsTj ofthesphericaltensoroperator,2l+1basiskets|l,m⟩and2J+1basisbras⟨J,M|.
m
Therefore,thereare(2j+1)×(2l+1)×(2J+1)matrixelements⟨J,M|T(j)|l,n⟩. Thefollowing
m
Wigner-Eckarttheoremrevealshowthesematrixelementsarespecified.
Theorem A.1 (Wigner-Eckart theorem for Spherical Tensor Operators, from Jeevanjee (2011)).
Let j,l,J ∈ N and let T(j) be a spherical tensor operator of rank j. Then there is a unique
≥0
complexnumber,thereducedmatrixelementλ∈C(oftenwritten⟨J∥T(j)∥l⟩∈C),thatcompletely
determinesanyofthe(2J +1)×(2j+1)×(2l+1)matrixelements⟨J,M|T(j)|l,n⟩:
m
⟨J,M|T(j)|l,n⟩ = λ·C(J,M) . (55)
m (l,n)(j,m)
27PublishedasaconferencepaperatICLR2024
TheWigner-Eckarttheoremdescribeshowthematrixelements(⟨J,M|T(j)|l,n⟩)ofthesphericalten-
m
soroperator(T(j))inthebasisofangularmomentumeigenstates(⟨J,M|and|l,n⟩)aredecomposed
intotheClebsch-Gordancoefficients(C(J,M) )andthereducedmatrixelements(⟨J∥T(j)∥l⟩). We
(l,n)(j,m)
canseethatthe⟨J∥T(j)∥l⟩valuesdonotdependonM,n,m,whicharethuscalledreducedmatrix
elements. TheWigner-Eckarttheoremelegantlyrevealstheunderlyingconnectionsbetweenmatrix
elements,whichisextremelyusefulforsimplifyingcalculationsinquantummechanics.
Furthermore,ifweinstantiateT(j) asthesphericalharmonicsY(j) andapplytheWigner-Eckart
theorem,weobtainthefollowingrelation⟨J,M|Y(j)|l,n⟩ = ⟨J∥Y(j)∥l⟩·C(J,M) ,whichcan
m (l,n)(j,m)
beexplicitlyrewrittenusingthedefinitionofinnerproductsintheHilbertfunctionalspace:
(cid:90) 2π(cid:90) π
Y(l1)(θ,ψ)Y(l2)(θ,ψ)Y(l)(θ,ψ)sinθdθdψ=C˜(l) C(l,m) , (56)
m1 m2 m (l1,l2) (l1,m1)(l2,m2)
0 0
whereC˜(l) isarealconstantonlydeterminedbyl ,l andl. FromEqn. (56),theClebsch-Gordan
(l1,l2) 1 2
coefficients are mathematically related to the integrals of products of three spherical harmonics,
whichareknownastheGauntcoefficients(Wigner,2012),andaredenotedasG(l,m) . This
(l1,m1)(l2,m2)
allowsustoobtaintherelationshippresentedinAppendixA.6.
B ADVANCES IN EQUIVARIANT NETWORKS FOR THE EUCLIDEAN GROUP
Onestandardwaytoenforceequivariantoperationsisthroughgroupconvolutions, whichdefine
convolutionfiltersasfunctionsongroups(Cohen&Welling,2016;2017;Coorsetal.,2018).However,
theintegralinthegroupconvolutionbecomesintractablewhendealingwiththecontinuousEuclidean
groups,motivatingthedevelopmentofLie-algebra-basedoperations(Finzietal.,2020;Hutchinson
et al., 2021). Finzi et al. (2020) proposed LieConv, which determines the group convolution via
lifting(mappingtheinputinvectorspacetoagroupelement),anddiscretizationoftheconvolution
integral via the PointConv trick. Following a similar idea, Hutchinson et al. (2021) developed
LieTransformer,whichemploystheself-attentionstrategytodynamicallyre-weighttheconvolutional
kernel. Nevertheless,suchmethodsstillinducehighcomputationalcostsduetodiscretizationand
sampling,andthenon-linearityofequivariantfeaturesisrestricted.
Another line of work leverages vector operations involving scalar (R) and vector (R3) features
to keep equivariance (Satorras et al., 2021; Jing et al., 2021; Schütt et al., 2021; Deng et al.,
2021; Haghighatlari et al., 2022; Thölke & Fabritiis, 2022; Wang & Chodera, 2023; Chen et al.,
2023). EGNN(Satorrasetal.,2021)usesthescalar-vectorproducttoupdatethevectorfeatures
under the equivariance constraints. GVP (Jing et al., 2021), PaiNN (Schütt et al., 2021) and
TorchMD-Net(Thölke&Fabritiis,2022)furtherleveragevectorproductstoenhancethelearning
ofscalarfeatures. Chenetal.(2023)recentlyproposedaunifiedframeworkcalledGeoMFormer,to
simultaneouslylearneffectivescalarandvectorfeatures. Theempiricalperformanceandapplicability
ofthesemodelsarelimited,duetoboundedmodelcapacity(Joshietal.,2023).
Recently,tensorproductsofirreduciblerepresentations(irreps)havebecomethedominantequivariant
operationsfortheEuclideangroup(Thomasetal.,2018;Drautz,2019;Fuchsetal.,2020;Unkeetal.,
2021;Brandstetteretal.,2022;Batatiaetal.,2022a;b;Nigametal.,2022;Batzneretal.,2022;Frank
etal.,2022;Liao&Smidt,2023;Musaelianetal.,2023;Passaro&Zitnick,2023;Yuetal.,2023b;
Gongetal.,2023;Liaoetal.,2024).Withasolidmathematicalfoundationfromrepresentationtheory,
suchoperationsallowmodelingequivariantmappingsbetweenany2l+1-dimensionalirrepsspacevia
Clebsch-Gordancoefficients(Wigner,2012),andareproventohaveuniversalapproximationcapabil-
ity(Dym&Maron,2021).State-of-the-artperformancehasbeenachievedinvariousreal-worldappli-
cationsviatheseoperations(Ramakrishnanetal.,2014;Chmielaetal.,2017;Chanussotetal.,2021).
Variousworksusepair-wisetensorproductstodevelopequivariantneuralnetworks. TensorField
Network(TFN)(Thomasetal.,2018)usestensorproductsofirrepstobuildanSE(3)-equivariant
convolutionlayertohandledatainthethree-dimensionalEuclideanspace. FollowingTFN,Fuchs
et al. (2020) developed the SE(3)-Transformer, which incorporates the attention mechanism to
enhance the feature learning. NequIP (Batzner et al., 2022) further extended the tensor product
operationstobeE(3)-equivariant,andachievedstrongperformanceonlearninginteratomicpotentials.
Allegro (Musaelian et al., 2023) further developed a strictly local equivariant network using the
28PublishedasaconferencepaperatICLR2024
iterated tensor products of irreps. SEGNN (Brandstetter et al., 2022) generalizes the node and
edgefeaturestoincludevectorsortensors,andincorporatesgeometricandphysicalinformationby
usingthetensorproductoperations. So3krates(Franketal.,2022)developedamodifiedattention
mechanism for modeling the non-local effects in molecular modeling. In particular, the atomic
interaction layer in So3krates computes the full tensor products of features containing irreps of
differentdegrees. Equiformer(Liao&Smidt,2023)usesthetensorproductoperationstobuilda
scalableequivariantTransformerarchitecture,testingthisonthebaselinesofthelarge-scaleOC20
dataset(Chanussotetal.,2021). ThisextendedGraphTransformers(Yingetal.,2021a;b;Shietal.,
2022;Luoetal.,2023;Zhangetal.,2023a)toequivariantnetworksfortheEuclideangroup. More
recently, eSCN(Passaro&Zitnick,2023)presentedaninterestingobservationonthesparsityof
sphericalharmonicsfiltersanddevelopedanequivariantnetworkbyusingtheSO(2)convolution
instead,toscalethedegreeofirrepsup. FollowingeSCN,EquiformerV2(Liaoetal.,2024)combined
theEquiformerbackbonewiththeeSCNconvolutionforscalingtohigher-degreerepresentations,
whichhasstate-of-the-artperformanceontheOC20dataset.
Existingworkshavealsodevelopedoperationsinvolvingmultipletensorproductsamongequivariant
features(EquivariantMany-bodyInteraction). AtomicClusterExpansion(ACE)(Drautz,2019;Dus-
sonetal.,2022)developedasystematicframeworkforconstructingmany-bodyinteractionfeatures
to encode the atomic environment, which involves multiple tensor products among atomic basis
functions. MACE(Batatiaetal.,2022b)combinesthemany-bodyinteractionfeatureswithmessage-
passing neural networks, which shows strong performance for learning machine learning force
fields(Kovácsetal.,2023). Nigametal.(2022);Batatiaetal.(2022a)providedathoroughanalysis
ofthetheoreticalpropertiesanddesignspaceofEquivariantMany-bodyInteractionoperations.
Equivariantneuralnetworksbasedontensorproductsofirrepshavebeenwidelyusedinmodeling
3D data across a variety of real-world applications, e.g., force field modeling (Chmiela et al.,
2017;Chanussotetal.,2021),physicaldynamicssimulation(Brandstetteretal.,2022),pointcloud
learning (Wu et al., 2015; Uy et al., 2019), and Quantum Hamiltonian Prediction (Unke et al.,
2021; Li et al., 2022; Khrabrov et al., 2022; Yu et al., 2023b;a). PhiSNet developed an SE(3)-
equivariantmessagepassingnetworkbyusingthetensorproductofirreps. Inparticular,topredict
theHamiltonianmatrixelements,operationsintheEquivariantFeatureInteractionclassareused
for coupling atom features themselves (for diagonal block prediction), or features of atom pairs
(fornon-diagonalblockprediction),whichmodelsinteractionofirrepsfromdifferentdimensional
spaceandobjects. Similarly,DeepH-E(3)(Lietal.,2022)furtherusesthetensorproductoperations
to incorporate the spin-orbit coupling effects. QHNet (Yu et al., 2023b) simplifies the PhiSNet
architecturebycontrollingthenumberoftensorproductoperations.
Finally, for comprehensive surveys on equivariant networks for the Euclidean group and their
applications,werefertheinterestedreaderstoBronsteinetal.(2021);Hanetal.(2022);Zhangetal.
(2023b);Duvaletal.(2023).
29PublishedasaconferencepaperatICLR2024
C IMPLEMENTATION DETAILS
In this section, we provide more details on designing efficient counterparts for operations in the
EquivariantFeatureInteraction,EquivariantConvolution,andEquivariantMany-bodyInteraction
categories.
Equivariant Feature Interactions. Given two features x˜(L1),y˜(L2) containing irreps of up to
degree L and L respectively, the operations in this class are commonly in the following form:
1 2
(x˜(L1)⊗w
c˜g
y˜(L2))(l) =(cid:80)L l11 =0(cid:80)L l22 =0w ll 1,l2(x(l1)⊗
cg
y(l2))(l),wherew ll
1,l2
∈Rarethelearnable
weights for each (l ,l ) → l combination. By reparameterizing wl as w · w · w where
w ,w ,w
∈R,Eq1 n.2
(4)inthemainbodybecomes:
l1,l2 l1 l2 l
l1 l2 l
(x˜(L1)⊗w x˜(L2))(l) =
(cid:88)L1 (cid:88)L2
wl (x(l1)⊗ x(l2))(l)
Ga˜unt m l1,l2 Gaunt m
l1=0l2=0
=
(cid:88)L1 (cid:88)L2
w w w(x(l1)⊗ x(l2))(l)
l1 l2 l Gaunt m
l1=0l2=0
=
(cid:88)L1 (cid:88)L2
w w w
(cid:88)l1 (cid:88)l2
G(l,m) x(l1)x(l2)
l1 l2 l (l1,m1)(l2,m2) m1 m2
l1=0l2=0 m1=−l1m2=−l2
=
(cid:88)L1 (cid:88)L2
w w w
(cid:88)l1 (cid:88)l2 x(l1)x(l2)(cid:90) 2π(cid:90) π
Y(l1)(θ,ψ)Y(l2)(θ,ψ)Y(l)(θ,ψ)sinθdθdψ
l1 l2 l m1 m2 m1 m2 m
l1=0l2=0 m1=−l1m2=−l2 0 0
=w
(cid:90) 2π(cid:90) π ((cid:88)L1 (cid:88)l1
w
x(l1)Y(l1)(θ,ψ))((cid:88)L2 (cid:88)l2
w x(l2)Y(l2)(θ,ψ))Y(l)(θ,ψ)sinθdθdψ
l l1 m1 m1 l2 m2 m2 m
0 0 l1=0m1=−l1 l2=0m2=−l2
(57)
Let x∗(l1) = w l1x(l1) and x∗(l2) = w l2x(l2), then Eqn. (57) actually calculates the coefficients
of function F∗(θ,ψ) = F∗(θ,ψ)·F∗(θ,ψ), where F∗(θ,ψ)=(cid:80)∞ (cid:80)l1 x∗(l1)Y(l1)(θ,ψ)
3 1 2 1 l1=0 m1=−l1 m1 m1
and F∗(θ,ψ)=(cid:80)∞ (cid:80)l2 x∗(l2)Y(l2)(θ,ψ). To this end, we can use the efficient approach
2 l2=0 m2=−l2 m2 m2
presented in Section 3.2 to accelerate such computation. After we calculate the coefficients of
F∗(θ,ψ),wethenmultiplytheweightw withcorrespondingirreps. Thus,thesettingofweighted
3 l
combinationsarenaturallyincludedinourGauntTensorProduct.
Equivariant Convolutions. One special case of Equivariant Feature Interaction is to instantiate
y˜(L2) assphericalharmonicsfilters,i.e.,(cid:80)L l11 =0(cid:80)L l22 =0hl l1,l2(x i(l1)⊗
cg
Y(l2)( ||r ri i− −r rj j||))(l),where
r i,r
j
∈ R3 are positions of objects, Y(l2) : S2 → R2l2+1 is the type-l
2
spherical harmonic,
hl ∈Rarelearnableweightscalculatedbasedontherelativedistanceandtypesofobjectsi,j,
l1,l2
e.g.,hl =F (||r −r ||,x ,x ),whereF areinstantiatedasGaussianbasisfunctions
l1,l2 l,l1,l2 i j i j l,l1,l2
andx ,x arethetypeofobjecti,j. Similarly,hl canbereparameterizedforourapproach.
i j l1,l2
Moreover,Passaro&Zitnick(2023)providesaninterestingobservationthatifweselectarotation
g ∈SO(3)withD(1)(g) ri−rj =(0,1,0),thenY(l)(D(1)(g) ri−rj )∝δ(l),i.e.,beingnon-zero
||ri−rj|| m ||ri−rj|| m
onlyifm=0. Suchasparsityfurtherpropagatestoitscoefficientsofthe2DFourierbasis,which
bringsfurtheraccelerationinEqn. (6): Lety(l)denotetheelementsofthesphericalharmonicfilter.
m
Duetothesparsityofy(l) =δ(l)andcoefficientsyl,m,∗,theconversionrulefromsphericalharmonics
m m u,v
to2DFourierbasescanberewrittenas:
L
y∗ =(cid:88) y(l)yl,0,∗, −L≤u≤L,
u,0 0 u,0 (58)
l=0
y∗ =0, ifv̸=0.
u,v
Thecoefficientsofthesphericalharmonicfiltersinthe2DFourierbasisarealsosparse,andsucha
conversionhasanO(L2)complexityinstead.
EquivariantMany-bodyInteractions. Operationsinthisclassperformmultipletensorproducts
amongequivariantfeatures,i.e.,x˜(L1)⊗ x˜(L2)⊗ ...⊗ x˜(Ln)withn−1tensorproducts.Forexam-
1 c˜g 2 c˜g c˜g n
30PublishedasaconferencepaperatICLR2024
ple,givenequivariantfeaturesA(L′) ∈R(L′+1)2 ofatomi,MACE(Batatiaetal.,2022b)constructs
i
themany-bodyfeaturesby(cid:80) (cid:80) CLM (cid:81)ν A(lξ) ,whereA(lξ) isthem -thelementofthe
ην lm ην,lm ξ=1 i,mξ i,mξ ξ
type-l irrepofA(L′),lmarethemulti-indices(l m ,...,l m ),CLM arethegeneralizedClebsch-
ξ i 1 1 ν ν ην,lm
Gordan coefficients, i.e., CLM = CL2M2 CL3M3 ...CLNMN with L =
l1m1,...,lnmn l1m1,l2m2 L2M2,l3m3 LN−1MN−1,lNmN
(L ,...,L ),|l −l |≤L ≤l +l , ∀i≥3|L −l |≤L ≤L +l andM ∈{m |−l ≤
2 N 1 2 2 1 2 i−1 i i i−1 i i i i
m ≤ l },η enumeratesallpossiblecouplingsofl ,...,l . Inparticular,itistheexplicitformof
i i ν 1 ν
performingtensorproductswithA(L)itselfν timesviathegeneralizedClebsch-Gordancoefficients:
i
B =A(L′)⊗ ...⊗ A(L′). (59)
ν,i i c˜g c˜g i
We generalize the Gaunt coefficients to this setting. Let G(L,M) =
(l1,m1)...(ln,mn)
(cid:82)2π(cid:82)π Y(l1)(θ,ψ)Y(l2)(θ,ψ)...Y(ln)(θ,ψ)Y(L)(θ,ψ)sinθdθdψ. Then Eqn. (59) in the
0 0 m1 m2 mn M
generalizedGauntcoefficientsisequivalentto:
(A(L′)⊗
...⊗
A(L′))(l)
i Ga˜unt Ga˜unt i m
(cid:124) (cid:123)(cid:122) (cid:125)
n−1times
   
=(cid:90) 2π(cid:90) π (cid:88)L′ (cid:88)l1
A( i,l m1) 1Y m(l
11)(θ,ψ)...(cid:88)L′ (cid:88)ln
A( i,l mn) nY m(l nn)(θ,ψ)Y m(l)(θ,ψ)sinθdθdψ.
0 0 l1=0m1=−l1 ln=0mn=−ln
(60)
Infact,weactuallycomputemultiplemultiplicationsamongmultiplesphericalfunctions. Wecan
also use the parameterization tricks to similarly multiply each A(l) with learnable weights w to
i l
achieveweighted(lm)→lcombinations. TheapproachpresentedinSection3.2canbenaturally
used: aftertheconversionfromsphericalharmonicsto2DFourierbases,weuseAν∗,ν =1,...,nto
i
denotethecoefficientsof2DFourierbasesofthesensphericalfunctions,andthe2DConvolution
canbecompactlyexpressedas:
A1∗⊛A2∗⊛...⊛A(n−1)∗⊛An∗, (61)
i i i i
where⊛denotestheconvolution. Interestingly,these2DConvolutionshaveassociativity,andwecan
useadivide-and-conquerapproachforparallelizingthecomputationoftheseconvolutionoperations.
Forexample,ifweperformthetensorproductoperationamong8functions,thecoefficientsAν∗can
i
bedividedintopair-wisegroupsforparallelcomputation,i.e.,(1,2) → 1∗,(3,4) → 2∗,(5,6) →
3∗,(7,8)→4∗. Suchaprocedureisiterativelyconducteduntilthefinalresultsarecalculated. The
computationalcomplexityofperforming2DconvolutionsintheEquivariantMany-bodyInteraction
settingisO(n2L2logL),whilerecursivelycomputingEqn. (61)hasanO(n3L2logL)complexity.
Discussions. Inpractice,itiscommoninmodelstomaintainC channelsofequivariantfeatures,i.e.,
X˜(L) ∈R(L+1)2×C denotestheequivariantfeaturesofobjecti,whichcontainsC channelsofirreps
i
x˜(L),0≤c<C ofdegreesuptoL. Ourapproachcanbenaturallyextendedbysimplydefiningthe
i,c
combinationrulesoffeaturesindifferentchannels:
• Channel-wise: given X˜(L),X˜(L) ∈ R(L+1)2×C, output features in the c-th channel are
i j
calculatedbasedonx˜(L)andx˜(L)only(O(C)fulltensorproducts):
i,c j,c
(X˜(L)⊗Wwise X˜(L)) =x˜(L)⊗wc x˜(L). (62)
i Ga˜unt j c i,c Ga˜unt j,c
• Channel-mixing: given X˜(L),X˜(L) ∈ R(L+1)2×C, output features in the c-th channel
i j
arecalculatedbasedonweightedcombinationsofx˜(L),c = 0,1,...,C andx˜(L),c =
i,c1 1 j,c2 2
0,1,...,C (O(C2)fulltensorproducts):
C C
(X˜ i(L)⊗W Gaw ˜uis ne tX˜( jL)) c = (cid:88) (cid:88) w cc 1,c2 ·(x˜( i,L c) 1 ⊗w Ga˜untx˜( jL ,c) 2). (63)
c1=0c2=0
31PublishedasaconferencepaperatICLR2024
Our approach is also not limited to full tensor products only. Given x(l1) ⊗
Gaunt
x(l2) only, the
approachpresentedinSection3.2canstillbeused:
(x(l1)⊗ x(l2))(l) =
(cid:88)l1 (cid:88)l2
G(l,m) x(l1)x(l2),
Gaunt m (l1,m1)(l2,m2) m1 m2
m1=−l1m2=−l2
=
(cid:88)l1 (cid:88)l2 x(l1)x(l2)(cid:90) 2π(cid:90) π
Y(l1)(θ,ψ)Y(l2)(θ,ψ)Y(l)(θ,ψ)sinθdθdψ,
m1 m2 m1 m2 m
m1=−l1m2=−l2 0 0
  
=(cid:90) 2π(cid:90) π (cid:88)L1 (cid:88)l1
x( ml1 1)Y m(l
11)(θ,ψ)(cid:88)L2 (cid:88)l2
x( ml2 2)Y m(l 22)(θ,ψ)Y m(l)(θ,ψ)sinθdθdψ.
0 0 l1=0m1=−l1 l2=0m2=−l2
(64)
wherewesetx( mlu u),x( mlv v)to0forl
u
̸=l 1,l
v
̸=l 2. OurGauntTensorProductbetweenx(l1)andx(l2)
canstillbeequivalentlyviewedasamultiplicationbetweentwosphericalfunctions,whichcanbe
efficientlycalculatedbyusingtheapproachpresentedinSection3.2.
D PROOF OF THE EQUIVARIANCE OF THE GAUNT TENSOR PRODUCT
Inthissection,weprovideformalproofoftheequivarianceofourGauntTensorProduct. Asstated
inSection2,tensorproductsofirrepsviatheClebsch-GordancoefficientsareequivarianttotheO(3)
group. Givenx(l1)andy(l2),wehavethefollowingequationforanyg ∈O(3):
(cid:16) (cid:17)(l)
D(l)(g)(x(l1)⊗ y(l2))(l) = (D(l1)(g)x(l1))⊗ (D(l2)(g)x(l2)) . (65)
cg cg
Let D(l) (g) denote the (m,n)-th element of the D(l)(g) matrix. First, the m-th element of
mn
D(l)(g)(x(l1)⊗ cgy(l2))(l)canbeexplicitlywrittenviatheClebsch-Gordancoefficients:
D(l)(g)(x(l1)⊗ y(l2))(l) =(cid:88) D(l) (g)(x(l1)⊗ y(l2))(l)
cg m mm′ cg m′
m′
(cid:32) (cid:33)
=(cid:88) D(l) (g) (cid:88) C(l,m′) x(l1)y(l2)
mm′ (l1,m1),(l2,m2) m1 m2 (66)
m′ m1,m2
(cid:32) (cid:33)
= (cid:88) (cid:88) D(l) (g)C(l,m′) x(l1)y(l2).
mm′ (l1,m1),(l2,m2) m1 m2
m1,m2 m′
Second,them-thelementof((D(l1)(g)x(l1))⊗ cg(D(l2)(g)x(l2)))(l)canalsobeexplicitlywritten
viatheClebsch-Gordancoefficients:
  
(cid:16) (D(l1)(g)x(l1))⊗ cg(D(l2)(g)x(l2))(cid:17)( ml) = m(cid:88) 1,m2C (( ll 1,m ,m) 1),(l2,m2) (cid:88)
m′
1D m(l1 1)
m′
1(g)x( ml1
′
1)  (cid:88)
m′
2D m(l2 2)
m′
2(g)y m(l2
′
2)

= (cid:88) (cid:88) C(l,m) D(l1) (g)D(l2) (g)x(l1)y(l2)
m1,m2m′ 1,m′
2
(l1,m1),(l2,m2) m1m′
1
m2m′
2
m′
1
m′
2
 
= (cid:88)  (cid:88) C(l,m) D(l1) (g)D(l2) (g)x(l1)y(l2).
m1,m2
m′ 1,m′
2
(l1,m′ 1),(l2,m′ 2) m′ 1m1 m′ 2m2  m1 m2
(67)
WecanconcludethattheClebsch-Gordancoefficientshavethefollowingproperties:
(cid:88) D(l) (g)C(l,m′) = (cid:88) C(l,m) D(l1) (g)D(l2) (g).
mm′ (l1,m1),(l2,m2) (l1,m′ 1),(l2,m′ 2) m′ 1m1 m′ 2m2 (68)
m′ m′,m′
1 2
The Gaunt coefficients also satisfy these constraints. Here, we use the Cartesian coordi-
nates as the input of spherical harmonics and denote the Gaunt coefficients G(l,m) as
(l1,m1),(l2,m2)
32PublishedasaconferencepaperatICLR2024
(cid:82) Y(l1)(˜r)Y(l2)(˜r)Y(l)(˜r)d˜r. Wehavethefollowingequations:
S2 m1 m2 m
(cid:90)
(cid:88) D(l) (g)G(l,m′) =(cid:88) D(l) (g) Y(l1)(˜r)Y(l2)(˜r)Y(l)(˜r)d˜r
m′
mm′ (l1,m1),(l2,m2)
m′
mm′
S2
m1 m2 m
(cid:32) (cid:33)
(cid:90)
= Y(l1)(˜r)Y(l2)(˜r) (cid:88) D(l) (g)Y(l)(˜r) d˜r (69)
m1 m2 mm′ m
S2 m′
(cid:90)
= Y(l1)(˜r)Y(l2)(˜r)Y(l)(D(1)(g)˜r)d˜r.
m1 m2 m
S2
(cid:88) G(l,m) D(l1) (g)D(l2) (g)
(l1,m′ 1),(l2,m′ 2) m′ 1m1 m′ 2m2
m′,m′
1 2
(cid:90)
= (cid:88) D(l1) (g)D(l2) (g) Y(l1)(˜r)Y(l2)(˜r)Y(l)(˜r)d˜r
m′,m′
m′ 1m1 m′ 2m2
S2
m1 m2 m
1 2
  
(cid:90)
= S2(cid:88)
m′
D( ml1
′
1) m1(g)Y m(l 11)(˜r)(cid:88)
m′
D( ml2
′
2) m2(g)Y m(l 22)(˜r)Y m(l)(˜r)d˜r
1 2
  
(cid:90)
= S2(cid:88)
m′
D( ml1 1) m′ 1(g)⊤ Y m(l 11)(˜r)(cid:88)
m′
D( ml2 2) m′ 2(g)⊤ Y m(l 22)(˜r)Y m(l)(˜r)d˜r (70)
1 2
  
(cid:90)
= S2(cid:88)
m′
D( ml1 1)
m′
1(g)−1 Y m(l 11)(˜r)(cid:88)
m′
D( ml2 2)
m′
2(g)−1 Y m(l 22)(˜r)Y m(l)(˜r)d˜r
1 2
  
(cid:90)
= S2(cid:88)
m′
D( ml1 1)
m′
1(g−1)Y m(l 11)(˜r)(cid:88)
m′
D( ml2 2)
m′
2(g−1)Y m(l 22)(˜r)Y m(l)(˜r)d˜r
1 2
(cid:90)
= Y(l1)(D(1)(g−1)˜r)Y(l2)(D(1)(g−1)˜r)Y(l)(˜r)d˜r.
m1 m2 m
S2
Due to the symmetry of the unit sphere S2, we have (cid:82) Y(l1)(˜r)Y(l2)(˜r)Y(l)(D(1)(g)˜r)d˜r =
S2 m1 m2 m
(cid:82) Y(l1)(D(1)(g−1)˜r)Y(l2)(D(1)(g−1)˜r)Y(l)(˜r)d˜r. Therefore,theGauntcoefficientsalsosatisfy
S2 m1 m2 m
thepropertiestomakeourGauntTensorProductequivarianttotheO(3)group.
33PublishedasaconferencepaperatICLR2024
E EXPERIMENTAL DETAILS
E.1 EFFICIENCYCOMPARISONS
Settings. (1) For the Equivariant Feature Interaction operation, we use the e3nn implementa-
tion(Geiger&Smidt,2022)asthebaseline. Werandomlysample10pairsoffeaturescontaining
irreps of up to degree L with 128 channels. We evaluate different degrees of L and report the
averageinferencetime4. (2)FortheEquivariantConvolutionoperation,weusetheeSCNimple-
mentation(Passaro&Zitnick,2023)asthebaseline,duetoitsenhancedefficiencyovere3nn. In
thissetting,10pairsoffeaturesandsphericalharmonicsfiltersaresampledinstead. Thenumberof
channelsiskeptas128. WealsoevaluatedifferentdegreesofL. WeimplementourGauntTensor
ProductbyusingtheinsightsofeSCNforfurtheracceleration,asstatedinSection3.3. (3)Forthe
EquivariantMany-bodyInteractionoperation,wecompareourapproachwithboththee3nnandthe
MACEimplementations(Batatiaetal.,2022b). WeevaluatedifferentdegreesofLandthenumber
oftensorproductoperandsν: (a)fixν =3andvaryL,(b)fixL=2andvaryν. Thebenchmarking
resultsareobtainedbyusingthesameNVIDIATeslaV100GPU.
E.2 SANITYCHECK
Baselines. Inthisexperiment,wechoosetheSEGNN(Brandstetteretal.,2022)asthebaseline,
whichachievesstate-of-the-artperformanceontheN-bodysimulationtask. Inparticular,SEGNN
proposesageneralizationofequivariantGNNssuchthatnodeandedgeattributesarenotrestrictedto
scalars. Basedontensorproductsofirreps,SEGNNinjectsgeometricandphysicalquantitiesinto
nodeupdates. ToinvestigatetheunderlyingeffectsofdifferentparameterizationsbetweenourGaunt
TensorProductandtheClebsch-GordanTensorProduct,wecomparetwoarchitectures: (1)SEGNN
withClebsch-GordanTensorProductimplementation;(2)SEGNNwithGauntTensorProduct. For
otherconfigurations,wefollowBrandstetteretal.(2022)tokeepthesame.
Settings. FollowingBrandstetteretal.(2022),weusetheN-bodysimulationtasktoinvestigate
theeffectsofdifferentparameterizations. TheN-bodyparticlesystemconsistsof5particlesthat
carryapositiveornegativecharge,havinginitialpositionandvelocityina3-dimensionalspace. The
taskistoestimateallparticlepositionsafter1,000timesteps. Weusethe4-layerSEGNNandset
themaxdegreeofattributes(l )irrepsin[1,2]. Themaxdegreeoffeaturevectors(l )issetto1.
a f
Thelearningrateissetto0.01forl =1and0.02forl =2. Thelearningratewasreducedusing
a a
anon-plateauschedulerbasedonthevalidationlosswithpatienceof10andadecayfactorof0.1
forl =1and0.2forl =2. Othersettingsarekeptthesameastheoriginalmodel. Themodelis
a a
trainedon1NVIDIATeslaV100GPU.
E.3 OC20S2EF
Datasets. OC20isadiverseandlarge-scaledatasetconsistingof1.2MDFTrelaxationtrajectories,
whicharecomputedbyusingtherevisedPerdew-Burke-Ernzerhof(RPBE)functional(Hammeretal.,
1999). EachstructureinOC20hasanadsorbatemoleculeplacedonacatalystsurface,andthecore
taskisStructure-to-Energy-Forces(S2EF),whichistopredicttheenergyandforcemeanabsolute
error(MAE).The"All"splitofOC20contains134Mtrainingexamples.Duetolimitedcomputational
resources,weadoptthewidelyusedS2EF-2Msubset,whichconsistsof2milliontrainingexamples
intotal. Foursplitsofvalidationsetsareusedincludingin-distribution(ID),out-of-distributionon
adsorbates(OOD-Ads),out-of-distributiononcatalysts(OOD-Cat),andout-of-distributiononboth
adsorbatesandcatalysts(OOD-Both). TheevaluationmetricsincludetheEnergyMAEandForce
MAE,thecosinesimilarityofpredictedforcesandground-truthforces(ForceCos),andtheratio
ofexamplesonwhichthepredictedenergyandforcesareunderapredefinedthreshold(EFwT).
Baselines. WecompareourapproachbasedontheEquiformerV2(Liaoetal.,2024)withseveral
competitivebaselinesfromtheleaderboardoftheOpenCatalystChallenge(Chanussotetal.,2021).
First,wecomparewithseveralclassicinvariantneuralnetworks. SchNet(Schüttetal.,2018)lever-
aged the interatomic distances encoded via radial basis functions, which serve as the weights of
4Wenoticedthatafterrunningthesamee3nncodemultipletimes,thesubsequentexecutionsarefasterthan
theinitialattempt,becauseofthecodecompilation.Nevertheless,ourapproachremainsmoreefficientoverall.
34PublishedasaconferencepaperatICLR2024
continuous-filterconvolutionallayers. DimeNet++(Gasteigeretal.,2020a)builtupontheDimeNet
model(Gasteigeretal.,2020b)whichintroducedthedirectionalmessagepassingthatencodesboth
distanceandangularinformationbetweentripletsofatoms. SpinConv(Shuaibietal.,2021)useda
per-edgelocalcoordinateframeandaspinconvolutionovertheremainingdegreeoffreedomtobuild
themodel. GemNet(Gasteigeretal.,2021)embeddedallatompairswithinagivencutoffdistance
basedoninteratomicdirections,andproposedthreeformsofinteractiontoupdatethedirectionalem-
beddings: Two-hopgeometricmessagepassing(Q-MP),one-hopgeometricmessagepassing(T-MP),
andatomself-interactions. AnefficientvariantnamedGemNet-Tisproposedtousecheaperformsof
interaction. BasedonGemNet,Gasteigeretal.(2022)comprehensivelyinvestigatedtherelationships
betweentheperformanceandchemicaldiversity,systemsize,datasetsizeanddomainshift. From
theseresults,anefficientimprovementtoGemNetarchitectureswasdeveloped,namedGemNet-OC.
Recently,SCN(Zitnicketal.,2022)usedarotationtricktoencodetheatomicenvironmentbyusing
theirreps,whilenotusingthetensorproductoperations. NotethatSCNdoesnotstrictlyobeythe
equivarianceconstraint. eSCN(Passaro&Zitnick,2023)presentedaninterestingobservationthat
thesphericalharmonicsfiltershavespecificsparsitypatternsifaproperrotationactsontheinput
sphericalcoordinates. CombinedwithpatternsoftheClebsch-Gordancoefficients,eSCNproposed
an efficient equivariant convolution to reduce SO(3) tensor products to SO(2) linear operations,
achievingefficientcomputation. BuiltupontheeSCNconvolution,EquiformerV2(Liaoetal.,2024)
developedascalableTransformer-basedmodel,whichachievedstate-of-the-artperformanceonthe
OC20andAdsorbML(Lanetal.,2022)benchmarks.
Architectures. EquiformerV2iscomposedofstackedequivariantTransformerblocks. Eachblock
consistsoftwolayers: anEquivariantGraphAttentionlayerfollowedbyafeed-forwardlayer,with
bothlayershavingseparableequivariantLayerNormalizationandskipconnections. EquiformerV2
canuseirrepsofhigherdegrees,e.g.,4or6,withtheeSCNconvolution. However,suchimplemen-
tationsalsorestricttheavailableequivariantoperationsforthisscalablearchitecture. Inthiswork,we
proposedtheGauntTensorProduct,whichservesasanewmethodforefficientequivariantoperations,
enablingfurthercombinationsbetweenarchitectureslikeEquiformerV2andeffectiveequivariant
operations. Asanexample,weuseourGauntTensorProducttoimplementtheSelfmixlayerinthe
EquivariantFeatureInteractionoperationclass. Thislayerreceivesequivariantfeaturesofeachatom
asinput. Foreachatom,fulltensorproductsofitsirrepsareperformedwithweightedcombinations.
IneachEquiformerV2block,weinsertthislayerwiththeequivariantLayerNormalizationinbetween
theEquivariantGraphAttentionlayerandthefeed-forwardlayer. Forthismodifiedarchitecture,the
originalimplementationwouldbeextremelyslowbecausetothelimitationoftheeSCNimplemen-
tation. Incontrast,ourGauntTensorProducthashighefficiencywhenusingirrepsofhigherdegrees.
Settings. FollowingLiaoetal.(2024),weusea12-layerEquiformerV2model. Themaxdegree
ofirrepsissetin[4,6]. Thedimensionofhiddenlayersandfeed-forwardlayersissetto128. The
numberofattentionheadsissetto8.ThenumberofradialBasiskernelsissetto600.WeuseAdamW
astheoptimizer(Kingma&Ba,2014). Thegradientclipnormissetto100.0. Thepeaklearning
rateissetto2e-4. Thebatchsizeissetto64. Thedropoutratiosissetto0.1. Theratioofstochastic
depth(Huangetal.,2016)issetto0.001. Theweightdecayissetto0.0. Themodelistrainedfor12
epochswitha0.1-epochwarm-upstage. Afterthewarm-upstage,thelearningratedecaysbyusing
acosinelearningratescheduler. Thebatchsizeissetto64. Otherhyperparametersarekeptthesame
asEquiformerV2forafaircomparison. Themodelistrainedon16NVIDIATeslaV100GPUs.
E.4 3BPA
Datasets. FollowingBatatiaetal.(2022b),weusethe3BPAdatasettobenchmarktheEquivariant
Many-bodyInteractionoperations. The3BPAdatasetcontainsgeometricstructuresofaflexibledrug-
likeorganicmolecule3-(benzyloxy)pyridin-2-aminesampledfromdifferenttemperaturemolecular
dynamicstrajectories. Thetrainingsetofthe3BPAdatasetcontains500geometriessampledatthe
300Ktemperature,whilethethreetestsetscontaingeometriessampledat300K,600K,and1200K
toassessin-andout-of-domainaccuracy. Afourthtestsetincludesoptimizedgeometries,inwhich
twodihedralanglesofthemoleculearefixed,whileathirdangleisvariedbetween0and360degrees.
Thisvariationproducesdihedralslicesthattraverseregionsofthepotentialenergysurface(PES),
differentfromthetrainingdata.Thistestassessesthesmoothnessandaccuracyofthepotentialenergy
surface(PES)regionthatdictatestheconformerspresentinasimulation. Consequently,itdirectly
influencespropertiesofinterest,suchasthebindingfreeenergiesassociatedwithproteintargets.
35PublishedasaconferencepaperatICLR2024
Baselines. Wefollow(Batatiaetal.,2022b;Musaelianetal.,2023)tochooseseveralcompetitive
baselinesforcomparison.AtomicClusterExpansion(Drautz,2019)providedasystematicframework
forconstructinghighbodyordercompletepolynomialbasisfunctions,whichincludesmanyexisting
atomic environment representations as special cases (Behler & Parrinello, 2007; Bartók et al.,
2010; Thompson et al., 2015; Shapeev, 2016). sGDML (Chmiela et al., 2019) is an optimized
implementationofthesymmetricgradientdomainmachinelearningmodel,whichisabletofaithfully
reproduce global potential energy surfaces (PES) for molecules with a few dozen atoms from a
limited number of user-provided reference molecular conformations and the associated atomic
forces. NequIP(Batzneretal.,2022)extendedthetensorproductoperationstobeE(3)-equivariant.
Allegro(Musaelianetal.,2023)furtherdevelopedastrictlylocalequivariantnetworktoimprove
scalability. Batatia et al. (2022a) provided an analysis on the design space of E(3)-equivariant
operationsanddevelopedBoTNet. MACE(Batatiaetal.,2022b)combinedthemessagepassing
neural networks with Equivariant Many-body Interaction operations, which achieved better data
efficiencyandimprovedgeneralizationperformance.
Settings. BasedontheMACEarchitecture(Batatiaetal.,2022b),wecompareourGauntTensor
Productwiththeimplementationsofe3nnandMACE.FollowingBatatiaetal.(2022b),weusea
two-layerMACEmodel. Thedimensionofhiddenlayersissetto256. Radialfeaturesaregenerated
using8Besselbasisfunctionsandapolynomialenvelopeforthecutoffwithp=5. Theradialfeatures
arefedtoanMLPofsize[64,64,64,1024],usingSiLUnonlinearitiesontheoutputsofthehidden
layers. Thereadoutfunctionofthefirstlayerisimplementedasasimplelineartransformation. The
readoutfunctionofthesecondlayerisasingle-layerMLPwith16hiddendimensions. Weusethe
AMSGradvariantofAdamastheoptimizer,andsetthehyper-parameterϵto1e-8and(β ,β )to
1 2
(0.9,0.999). Thebatchsizeissetto5. Thepeaklearningrateissetto1e-2. Thelearningratewas
reducedusinganon-plateauschedulerbasedonthevalidationlosswithpatienceof50andadecay
factorof0.8. Weuseanexponentialmovingaveragewithaweightof0.99toevaluatethevalidation
setaswellasforthefinalmodel. Wesettheexponentialweightdecayto5e-7. Themodelistrained
on1NVIDIAA6000GPU.
36
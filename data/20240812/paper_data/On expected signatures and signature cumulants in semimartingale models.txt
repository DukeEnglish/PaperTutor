ON EXPECTED SIGNATURES AND SIGNATURE CUMULANTS IN
SEMIMARTINGALE MODELS
PETERK.FRIZ:,;,PAULP.HAGER:,ANDNIKOLASTAPIA;
Abstract. Theconceptofsignaturesandexpectedsignaturesisvitalindatascience,
especially for sequential data analysis. The signature transform, a Cartan type
development,translatespathsintohigh-dimensionalfeaturevectors,capturingtheir
intrinsiccharacteristics. Undernaturalconditions,theexpectationofthesignature
determines the law of the signature, providing a statistical summary of the data
distribution. This property facilitates robust modeling and inference in machine
learningandstochasticprocesses. Buildingonpreviousworkbythepresentauthors
[Unified signature cumulants and generalized Magnus expansions, FoM Sigma ’22]we
hererevisittheactualcomputationofexpectedsignatures,inageneralsemimartingale
setting. Severalnewformulaearegiven. Alog-transformof(expected)signaturesleads
tolog-signatures(signaturecumulants),offeringasignificantreductionincomplexity.
Contents
1. Introduction and main results 2
2. Preliminaries 5
2.1. The tensor algebra and tensor series 5
2.2. Semimartingales 7
2.3. Generalized signatures 9
2.4. Expected signatures and signature cumulants 10
3. Functional equations for the expected signature 11
3.1. The continuous case 11
3.2. Discrete processes and the càdlàg case 13
4. Recursive formulas and diamond products 17
4.1. Recursive formula for signature moments 17
4.2. Recursive formula for signature cumulants 18
4.3. Diamond Products 19
4.4. Remark on tree representation 20
5. Multivariate Moments and Cumulants 20
5.1. The symmetric algebra 20
5.2. Moments and cumulants 21
5.3. Diamond relations for multivariate cumulants 22
6. Applications 25
6.1. Brownian rough paths 25
6.2. Time-inhomogeneous Lévy processes 26
References 29
:Institut für Mathematik, TU Berlin, Str. des 17. Juni 136, 10586 Berlin, Germany.
;Weierstrass Institute, Mohrenstr. 39, 10117 Berlin, Germany.
E-mail addresses: {friz,hager}@math.tu-berlin.de, tapia@wias-berlin.de.
2020 Mathematics Subject Classification. 60L10,60L90,60E10,60G44,60G48,60G51,60J76.
Key words and phrases. Signatures,Lévyprocesses,universalsignaturerelationsforsemimartingales,
moment-cumulantrelations,characteristicfunctions,diamondproduct,Magnusexpansion.
1
4202
guA
9
]LM.tats[
1v58050.8042:viXra2 P.FRIZ,PAULP.HAGER,ANDN.TAPIA
1. Introduction and main results
In data science and data-driven modeling, especially when dealing with sequential data,
the concept of signatures and expected signatures has become increasingly important.
These mathematical constructs provide a robust framework for translating complex paths
and time series into a high-dimensional feature space, enabling more effective analysis and
modeling.
To understand these concepts, we start with the idea of a tensor series over Rd. The
tensor series, denoted as T –TppRdqq, is an infinite direct product of tensor powers of Rd.
This structure allows us to concatenate elements in a way that captures the sequential
nature of the data. Each element of T can be expressed as a series:
x“pxp0q,xp1q,xp2q,...q”xp0q`xp1q`xp2q`¨¨¨ .
Within this framework, two important subspaces emerge: T and T . The subspace T ,
0 1 0
where the scalar component xp0q equals zero, possesses a natural Lie algebra structure.
Conversely, T , where the scalar component xp0q equals one, forms a formal Lie group.
1
The operations within these structures, particularly the commutator Lie-bracket defined
by ry,xs“yx´xy for x,yPT , are essential for understanding the algebraic properties
0
of the signatures.
Given a smooth Rd-valued path X, its signature on r0,Ts is obtained from solving the
universal linear differential equations
S9 “SX9, S “1”p1,0,0,...qPT . (1.1)
0 1
It is known that the log-signature logS takes values in L ” LieppRdqqpĂ T q, the Lie
T 0
series over Rd, e.g. [Reu03,FV10], generally an infinite series [FLS24]. This remains valid
when X is taken as (component-wise smooth) L-valued path, the resulting path S is then
a smooth geometric rough path in the sense of [BFPP22].1 As a special case of general
geometric rough paths, the signature S determines the path X, in the sense of [BGLY16].
T
Many paths of interest arise as sample paths from stochastic processes, far from
continuously differentiable, leave alone smooth. A natural class of stochastic processes,
where (1.1) still makes sense - as (Stratonovich) stochastic differential equation - is given
by semi ma rtingales: Let Sc “ ScpRdq denote the class of continuous, d-dimensional
semimartingales on some filtered probability space pΩ,pF q ,Pq. We recall that this is
t tě0
the somewhat decisive class of stochastic processes that allows for a reasonable, stochastic
integration theory. Classic texts include [RY04,LG16,JS03,Pro05], a concise introduction
for readers with no background in stochastic analysis is [ASJ14, Chapter 1]. (Readers
with no background in probability may also focus in a first reading on deterministic
semimartingales which are paths of finite variation on compacts. Following Lyons [Lyo14],
foracontinuoussemimartingaleX PSc, thesignature givenastheformalsumofit erated
Stratonovich integrals,
ż ż ˆż ˙
t t u1
SigpXq “1`X ` X ˝dX ` X ˝dX ˝dX `¨¨¨
s,t s,t s,u u s,u2 u2 u1
s s s
for0ďsďtdefinesarandomelementinT and, asaprocess, a(component-wisedefined)
1
T -valued semimartingale. By regarding the d-dimensional semimartingale X as T -valued
1 0
semimartingale (X Ø X “ p0,X,0,...)), we see that the signature of X P Sc satisfies
the Stratonovich stochastic differential equation
dS“S˝dX, (1.2)
which is the stochastic analog of (1.1). In the general case of XPScpT q with possibly
0
nontrivial higher-order semimartingale components X“p0,Xp1q,Xp2q,...q, the solution
to (1.2) is a.k.a. the Lie group valued stochastic exponential (or development), with
classical references [McK69,HDL86]. We define, whenever SigpXq is (componentwise)
0,T
integrable, the expected signature (SigMoments) and signature cumulants (SigCum)
µµµpTq–EpSigpXq qPT , κκκpTq–logµµµpTqPT .
0,T 1 0
1Whenthegeometricstructure(morespecifically: shuffleproperties)playnorole,wewillalsoallowX
tobea(component-wisesmooth)T0-valuedpath.ON EXPECTED SIGNATURES AND SIGNATURE CUMULANTS IN SEMIMARTINGALE MODELS 3
Already in the case of eq. (1.1), where X is deterministic and sufficiently regular, this
leads to an interesting (ordinary differential) equation forκκκ with accompanying (Magnus)
expansion, well understood as effective computational tool [IMKNZ05,BCOR09]. The
importance of the stochastic case X“Xpωq, with expectation and logarithm thereof, was
developed by Lyons and coauthors; see [Lyo14] and references therein, with a variety of
applications, ranging from machine learning to numerical algorithms on Wiener space
known as cubature [LV04]; signature cumulants were named and first studied in their own
right in [BO20].
In the special case of d“1 and X“p0,X,0,...q where X is a scalar semimartingale,
µµµpTq andκκκpTq are nothing but the sequence of moments and cumulants of the real valued
random variable X ´X . When d ą 1, signature moments / cumulants provide an
T 0
effective way to describe the process X on r0,Ts, see [LQ11,Lyo14,CL16]. The question
arises how to compute them. If one takes X as d-dimensional Brownian motion, the
signature cumulantκκκpTq equals pT{2qI , where I is the identity 2-tensor over Rd. This
d d
is known as Fawcett’s formula, [LV04,FH20]. Loosely speaking, and postponing precise
definitions, our main result is a vast generalization of Fawcett’s formula.
Theorem 1.1 (FuctEqu SigMoments). For sufficiently integrable X P ScpT q, the
0
conditional signature momentsµµµ“µµµpTq are the unique solution of the functional equation
« ż ˆ ˙ ff
T 1
µµµ “E dX ` dxXy µµµ `xX,µµµy . (1.3)
t t u 2 u u t,T
t
By taking the (non-commutative) logarithm of this equation and applying a suitable
version of Itô’s formula one obtains a correspondig equation for the cumulants.
Theorem 1.2 (FunctEqu Sc-SigCum). For sufficiently integrable X P ScpT q, the
0
(time-t) conditional signature cumulants κκκ pTq ”κκκ – logE pSigpXq q, is the unique
t t t t,T
solution of the functional equation
"ż ż
1 T
κκκ pTq“E Hpadκκκ qpdX q` Hpadκκκ qpdxXy q
t t u u 2 u u
pt,Ts t
ż
1 T
` Hpadκκκ q˝Qpadκκκ qpdxxκκκ,κκκyy q
2 u u u
t ż *
T
` Hpadκκκ q˝pIddGpadκκκ qqpdxxX,κκκyy q , (1.4)
u u u
t
where all integrals are understood in Itô– and Riemann–Stieltjes sense respectively2 and
adx “rx,¨s:T ÑT denotes the adjoint operator associated to x PT . The functions
0 0 0
H,G,Q are defined in eqs. (3.3) and (3.4) below; see also Section 2 for further notation.
As displayed in Figures 1 and 2, this theorem has an avalanche of consequences on
which we now comment.
‚ Making use of the grading structure highlighted at the beginning, (1.3) (resp.
eq.(1.4))allowstocomputeµµµpnqpresp. κκκpnqqPpRdqbnasfunctionofµµµp1q, ... ,µµµpn´1q
(resp. κκκp1q,...,κκκpn´1q). Thisprovidesameansofcomputationwhichcaninprinci-
ple be more efficient than the naive Monte Carlo approach. Even when a concrete
form ofµµµ orκκκ is not readily available, the recursive nature of the expressions
t t
for each homogeneous component can be useful in some numerical scenarios.
‚ The most classical consequence of (1.4) appears when X is a deterministic contin-
uous semimartingale, i.e. in particular the components of X are continuous paths
offinitevariation, whichalsocoverstheabsolutelycontinuouscasewithintegrable
componentwise derivative X9 which is the situation described in eq. (1.1). What
remains is a classical differential equation due to [Hau06], here in backward form
´dκκκ pTq“Hpadκκκ qdX , (1.5)
t t t
the accompanying recursion is then precisely Magnus expansion [Mag54,IN99,
IMKNZ05,BCOR09]. BytakingXcontinuousandpiecewiselinearontwoadjacent
2Here˝denotescomposition,nottobeconfusedwithStratonovichintegration˝dX.4 P.FRIZ,PAULP.HAGER,ANDN.TAPIA
FunctEqu deterministic V ODE
Sc-SigCum Hausdorff
commutative
FunctEqu trivial
Sc-Cum
Figure 1. FunctEqu Sc-SigCum (Theorem 3.3) and implications. Sc
(resp. Sc) stands for general (resp. continuou s) s emimartingales and V
(resp. Vc)standsforfinitevariation(resp. finitevariationandcontinuous)
processes.
Recursion deterministic Vc Magnus
Sc-SigCum Expansion
commutative
Diamond trivial
Expansion
Figure 2. Computational consequence: accompanying recursions
intervals, say r0,1qYr1,2q, one obtains the Baker–Campbell–Hausdorff formula
(see e.g. [Mil72, Theorem 5.5])
` ˘
κκκ p2q“log exppx qexppx q —BCHpx ,x q
0 1 2 1 2
ż
1 (1.6)
“x ` Ψpexppadtx q˝exppadx qqpx qdt,
2 1 2 1
0
with
ÿ
lnpzq p´1qn
Ψpzq– “ pz´1qn
z´1 n`1
ně0
‚ Write π : T Ñ S for the canonical projection to the extended symmetric
Sym
algebra S, the linear space identified with symmetric tensor series, and define
the S-valued semimartingale Xˆ :“π pXq and symmetric signature cumulants
Sym
κκκˆpTq:“logpEpSigpXˆ q qq“π pκκκpTqq (see Section 5.1 for more detail). Then
¨ ¨,T Sym
equation (1.4), in its projected and commutative form becomes, (see Section 5.3)
" A E *
1
FunctEqu Sc-Cum: κκκˆ pTq“E Xˆ ` pXˆ `κκκˆq (1.7)
t t t,T 2 t,T
where exp: S ÞÑS is defined by the usual power series. First level tensors are
0 1
trivially symmetric and therefore (1.7) applies to the a Rd-valued semimartingale
X via the canonical embedding Xˆ “ p0,X,0,...qPScpS q. More interestingly,
0
the case Xˆ “p0,aX,bxXy,0,...q, for a d-dimensional continuous martingale X
can be seen to underlie the expansions of [FGR22], which improves and unifies
previous results [LRV23,AGR20], treating pa,bq “ p1,0q and pa,bq “ p1,´1{2q
respectively. Following Gatheral and coworkers, (1.7) and subsequent expansions
involve “diamond” products of semimartingales, given, whenever well-defined, by
` ˘
pA˛Bq pTq–E xA,By .
t t t,TON EXPECTED SIGNATURES AND SIGNATURE CUMULANTS IN SEMIMARTINGALE MODELS 5
We note that eq. (1.7) induces recursive formulae for cumulants, dubbed Diamond
expansions in Figure 2, previously discussed in [LRV23,AGR20,FGR22,FM21],
together with a range of applications, from quantitative finance (including rough
volatility models [AJLP19,GKR19]), to statistical physics: in [LRV23] the authors
relyonsuchformulastocomputethecumulant-generatingfunctionoflog-correlated
Gaussian fields, more precisely approximations thereof, that underlies the Sine-
Gordon model, which is a key ingredient in their renormalization procedure.
With regard to the existing (“commutative”) literature, our algebraic setup
is ideally suited to work under finite moment assumptions, we are able to deal
with jumps, not treated in [LRV23,AGR20]. Equation (1.7), the commutative
shadow of (1.4), should be compared with Riccati’s ordinary differential equation
from affine process theory [DFS`03,CFMT11,KRST11]. Of course, our results,
in particular eqs. (1.4) and (1.7), are not restricted to affine semimartingales. In
turn, expected signatures and cumulants - and subsequently all our statements
above these - require moments, which is not required for the Riccati evolution of
the characteristic function of affine processes. Of recent interest, explicit diamond
expansionshavebeenobtainedfor“roughaffine”processes,non-Markovbynature,
with cumulant generating function characterized by Riccati Volterra equations,
see [AJLP19,GKR19,FGR22]. It is remarkable that analytic tractability remains
intact when one passes to path space and considers signature cumulants.
‚ At last, we mention Signature-SDEs [ASS20], tractable classes of stochastic dif-
ferential equations which can be studied from an infinite dimensional affine and
polynomialperspective[CST23]. Calibrationofsuchmodelshingesontheefficient
computation of expected signatures.
We conclude this introduction with some remarks on convergence. As was explained, this
work contains generalizations of cumulant type recursions, previously studied in [AGR20,
LRV23,FGR22],theinterestthereinbeingthealgorithmiccomputationofcumulants. Basic
facts of analytic functions show that classical moment- and cumulant-generating functions,
for random variables with finite moments of all orders, have a radius of convergence
ρ ě 0, directly related to growth of the corresponding sequence. Convergence, in the
sense ρ ą 0, implies that the moment problem is well-posed. That is, the moments
(equivalently: cumulants) determine the law of the underlying random variable. (See
also [FGR22] for a related discussion in the context of diamond expansions.) The point of
view taken here is to work directly on this space of sequences, which is even more natural
in the non-commutative setting, as already seen in the deterministic setting of [Mag54].
While convergence of expected signatures or signature cumulants series is not directly
an interesting question,3 understanding their growth most certainly is: in a celebrated
paper [CL16] it was shown that under a growth condition of the expected signature, the
“expected signature problem” is well-posed; that is, the expected signature (equivalently:
signature cumulants) determines the law of the random signature. In particular we
demonstrate this for the case of time-inhomegenous Lévy processes Section 6.2.
Acknowledgment. PKF acknowledges seed support for the DFG CRC/TRR 388
“Rough Analysis and Stochastic Dynamics” and is also supported by DFG Excellence
Cluster MATH+ and a MATH+ Distinguished Fellowship, which also supported NT.
2. Preliminaries
2.1. The tensor algebra and tensor series. Denote by TpRdq the tensor algebra over
Rd, i.e.
à8
TpRdq– pRdqbk,
k“0
3Allsuchseries,seenassequenceoftheirpartialsums,“converge”ifoneequipsthespaceoftensor
serieswiththeminimaltopologythatrendersallfinite-dimensionalprojectionscontinuous.6 P.FRIZ,PAULP.HAGER,ANDN.TAPIA
elements of which are finite sums (a.k.a. tensor polynomials) of the form
ÿ ÿ
x“ xpkq “ xwe (2.1)
w
kě0 wPWd
with xpkq P pRdqbk,xw P R and linear basis vectors e – e ¨¨¨e P pRdqbk where
w i1 ik
wřranges over all words w “ i 1¨¨¨i
k
P W
d
over the alphabet t1,...,du. Note xpkq “
xwe where |w| denotes the length a word w. The element e “1PpRdqb0 –R
|w|“k w H
is the neutral element of the concatenation (a.k.a. tensor) product, which is obtained by
linear extension of e e “ e where ww1 P W denotes concatenation of two words.
w w1 ww1 d
We thus have, for x,yPTpRdq,
˜ ¸
ÿ ÿk ÿ ÿ
xy“ xpℓqypk´ℓq “ xw1yw2 e PTpRdq.
w
kě0ℓ“0 wPWd w1w2“w
This extends naturally to infinite sums, a.k.a tensor series, elements of the “completed”
tensor algebra
ź8
T –TppRdqq– pRdqbk,
k“0
which are written as in (2.1), but now as formal infinite sums with identical notation and
multiplication rules; the res ulting algebra T obviously extends TpRdq. For any nPN
ě1
define the projection to tensor levels by
π :T ÑpRdqbn, xÞÑxpnq.
n
Denote by T and T the subspaces of tensor series starting with 0 and 1 respectively;
0 1
that is, xPT (resp. T ) if and only if xH “0 (resp. xH “1). Restricted to T and T
0 1 0 1
respectively, the exponential and logarithm in T, defined by the usual series,
ÿ8
1
exp: T ÑT , xÞÑexppxq–1` pxqk,
0 1 k!
k“1
ÿ8
p´1qk`1
log: T ÑT , 1`xÞÑlogp1`xq– pxqk,
1 0 k
k“1
are globally defined and inverse to each other. We will usually abbreviate ex “exppxq.
The vector space T becomes a Lie algebra with the commutator bracket
0
rx,ys–xy´yx, x,yPT .
0
Define the adjoint operator associated to a Lie-algebra element yPT by
0
ady: T ÑT , xÞÑry,xs.
0 0
The exponential image T “exppT q is a Lie group, at least formally so. We refrain from
1 0
equipping the infinite-dimensional T with a differentiable structure, not necessary in view
1
of the “locally finite” nature of the group law px,yqÞÑxy.
Denote by m: TpRdqbTpRdq Ñ TpRdq the multiplication (concatenation) map of
the tensor algebra. Note that m is linear and, due to the non-commutativity of the
tensor product, not symmetric. The map can naturally be extended to linear map
m: TpRdqbTpRdqÑT, where TpRdqbTpRdq is the following graded algebra
˜ ¸
ź8 àn
TpRdqbTpRdq:“ pRdqbibpRdqbpn´iq .
n“0 i“0
Note that there is the following natural linear embedding
˜ ¸
ÿ8 ÿn
T bT ãÑTpRdqbTpRdq, xbyÞÑ xpiqbypn´iq .
n“0 i“0
We will of course refrain from explicitly denoting the embedding and simply regard
xby as an element in TpRdqbTpRdq. We emphasize that here b does not denote
the (inner) tensor product in T, for which we did not reserve a symbol, but it denotesON EXPECTED SIGNATURES AND SIGNATURE CUMULANTS IN SEMIMARTINGALE MODELS 7
another (outer) tensor product. We can lift two linear maps g,f: T ÑT to a linear map
gdf :TpRdqbTpRdqÑT defined by
gdf :“m˝pgbfq.
In particular, for all x,yPT it holds
pgdfqpxbyq“gpxqfpyqPT.
For nPN, the subspace
ź8
I – pRdqbk
n
k“n`1
is a two sided ideal of T. Therefore, the quotient space T{I has a natural algebra
n
structure. We denote the projection map by π . We can identify T{I with
p0,nq n
àn
Tn – pRdqbk,
k“0
equipped with truncated tensor product,
˜ ¸
ÿn ÿ ÿ ÿ
xy“ xpℓ1qypℓ2q “ xw1yw2 e PTn.
w
k“0ℓ1`ℓ2“k wPWd,|w|ďn w1w2“w
The sequence of algebras pTn :ně0q forms an inverse system with limit T. There are
also canonical inclusions Tk ãÑTn for k ďn; in fact, this forms a direct system with limit
TpRdq. The usual power series in Tn define exp : Tn ÑTn with inverse log : Tn ÑTn,
n 0 1 n 1 0
we may again abuse notation and write exp and log when no confusion arises. As before,
Tn has a natural Lie algebra structure, and Tn (now finite dimensional) is a bona fide Lie
0 1
group.
We equip TpRdq with the norm
|a|
TpRdq
–m kPa Nx|apkq| pRdqbk,
where |¨| pRdqbk is the euclidean norm on pRdqbk –Rdk, which makes it a Banach space.
The same norm makes sense in Tn, and since the definition is consistent in the sense that
|a| Tk “ |a| Tn for any a P Tn and k ě n, and |a| Tn “ |a| pRdqbn for any a P pRdqbn. We
will drop the index whenever it is possible and write simply |a|. For a word w PW with
d
|w|ą0 we define the directional derivative for a function f: T ÑR by
ˇ
ˇ
pB fqpxq–B pfpx`te qq ,
w t w t“0
for any xPT such that the right-hand derivative exists.
2.2. Semimartingales. Let C be the space of continuous adapted processes X: Ωˆ
r0,TqÑR, with T Pp0,8s, defined on some filtered probability space pΩ,pF q ,Pq.
t 0ďtďT
The space of continuous semimartingales Sc is given by the processes X PC that can
uniquely be decomposed as
X “X `M `A ,
t 0 t t
where M P M is a continuous local martingale, and A P V is an adapted process of
loc
locally bounded variation, both started at zero. The (predictable) quadratic variation
processofX isdenotedbyxXy . CovariationanglebracketsxX,Yy,foranotherreal-valued
t
semimartingale Y, are defined by polarization. For q P r1,8q, write Lq “ LqpΩ,F,Pq,
then a Banach space Hq ĂSc is given by those X PSc with X “0 and
› ż › 0
› T ›
}X}Hq –› ›xMy1 T{2 ` |dA s|› › ă8.
0 Lq
Note that for a local martingale M PM it holds (see [Pro05, Ch. V, p. 245])
loc › ›
› ›
}M} “›xMy1{2› .
Hq T
Lq
For a process X PC we define
› ›
› ›
}X}Sq –› sup |X t|›
0ďtďT Lq8 P.FRIZ,PAULP.HAGER,ANDN.TAPIA
and define the space Sq ĂSc of semimartingales X PSc such that }X}Sq ă8. Note
that there exists a constant c ą0 depending on q such that (see [Pro05, Ch. V, Theorem
q
2])
}X}Sq ďc q}X}Hq. (2.2)
ř
We view d-dimensional semimartingales, X “ d Xie PScpRdq, as special cases of
i“1 i
tensor series valued semimartingales ScpTq of the form
ÿ
X“ Xwe
w
wPWd
with each component Xw a real-valued continuous semimartingale. This extends mutatis
mutandistothespacesofT-valuedadaptedcontinuousprocessesCpTq,martingalesMpTq
and processes of finite variation VpTq. Note also that we typically deal with T -valued
0
semimartingales X which amounts to have only words with length |w| ě 1. Standard
notions such as continuous local martingale Xc and jump process ∆X “ X ´X
t t t´
are defined componentwise. To weaken integrability requirements later, we often deal
semimartingalestakingvaluesinthetruncatedtensoralgebraTN andwillomitspecifically
extending notations when it is straight forward.
Brackets: Now let X and Y be T-valued semimartingales. We define the (non-
commutative) outer quadratic covariation bracket of X and Y by
ÿ
xxX,Yyy – xXw1,Yw2y e be PTpRdqbTpRdq.
t t w1 w2
w1,w2PWd
Similarly, define the (non-commutative) inner quadratic covariation bracket by
˜ ¸
ÿ ÿ
xX,Yy – xXw1,Yw2y e PT.
t t w
wPWd w1w2“w
As usual, we may write xxXyy”xxX,Xyy and xXy”xX,Xy.
H-spaces: The definition of Hq-norm naturally extends to tensor valued martingales.
More precisely, for Xpnq PScppRdqbnq with nPN and q Pr1,8q we define
› ě1 ›
› ›
}Xpnq}Hq –}Xpnq}HqppRdqbnq –›|xMy|1 T{2 `|A| 1´var;r0;Ts› ,
Lq
where Xpnq “M`A with MPM ppRdqbnq and APVppRdqbnq, with
loc
ż
ÿˇ ˇ ÿ T
|A| – sup ˇ A ´A ˇ ď |dAw|,
1´var;r0;Ts ti`1 ti s
0ďt1ď¨¨¨ďtkďT ti wPWd,|w|“n 0
with the supremum taken over all partitions of the interval r0,Ts. One may readily check
that ÿ
}Xpnq}Hq ď }Xw}
Hq
wPWd,|w|“n
and for Xpnq PM ppRdqbnq:
loc
}Xpnq}Hq “}|xXpnqy| T} Lq.
Further define the following subspace Hq,N Ă ScpTNq of homogeneously q-integrable
0
semimartingales
! ˇ )
ˇ
Hq,N – XPScpT 0NqˇX
0
“0, |||X|||Hq,N ă8 ,
where for any XPScpTNq we define
ÿN ` ˘
|||X|||Hq,N – }Xpnq}HqN{n 1{n .
n“1
Note that |||¨|||Hq,N is sub-additive and positive definite on Hq,N and it is homogeneous
under dilation in the sense that
|||δ λX|||Hq,N “|λ||||X|||Hq,N, δ λX–pXp0q,λXp1q,...,λNXpNqq, λPR.ON EXPECTED SIGNATURES AND SIGNATURE CUMULANTS IN SEMIMARTINGALE MODELS 9
We also introduce the following subspace of ScpTq
H8´pTq–tXPScpTq: Xw PHq, @1ďq ă8, w PW u.
d
Note that if XPScpTq such that |||Xp0,Nq|||H1,N ă8 for all N PN
ě1
then it also holds
XPH8´pTq.
Stochastic integrals: We are now going to introduce a notation for the stochastic
integrationwithrespecttotensorvaluedsemimartingales. DenotebyLpT;Tq“tf :T Ñ
T |f is linearu the space of endomorphisms on T and let
F:Ωˆr0,TsÑLpT;Tq, pt,ωqÞÑF pω;¨q
t
such that
pF pxqq PCpTq, for all xPT (2.3)
t 0ďtďT
and F pω;I qĂI , for all nPN, pω,tqPΩˆr0,Ts, (2.4)
t n n
where I ĂT was introduced in Section 2.1, consisting of series with tensors of level n`1
n
and higher. In this case, we can define the stochastic Itô integral of F with respect to
XPScpTq by
ż ż
ÿ ÿ
F pdX q:“ F pe qwdXve PScpTq. (2.5)
t t t v t w
p0,¨s wPWd vPWd,|v|ď|w| p0,¨s
For example, let Y,Z P CpTq and define F :“ YIdZ, i.e. F pxq “ Y xZ , the
t t t
concatenation product from the left and right, for all xPT. Then we see that F indeed
satisfies the conditions (2.3) and (2.4) and we have
ż ż
˜
ż
¸
ÿ ÿ
pY IdZ qpdX q“ Y dX Z “ Zw1Yw3dXw2 e . (2.6)
t t t t t t t t t w
p0,¨s p0,¨s wPWd w1w2w3“w p0,¨s
Another important example is given by F “ padYqk for any Y P CpT q and k P N.
0
Indeed,weimmediatelyseeFsatisfiesthecondition(2.4)andsincetheiterationofadjoint
operations can be expanded in terms of left- and right-multiplication, we also see that F
satisfies (2.3). More generally, integrals with respect to power series of adjoint operators
are well d efin ed. Indeed, introducing for ℓPpN qk the notation ℓ“pl ,...,l q, |ℓ|:“k
ě1 1 k
and ||ℓ||:“l 1`¨¨¨`l
k
and padxpℓqq“padxpl1q¨¨¨adxplkqq for any xPT 0. Then for any
pa q8 ĂR and XPScpT q the integral
k k“0 « ff0
ż ż
ÿ8 ÿ8 nÿ´1 ÿ
a padY qk pdX q“ a adYpℓqpdXpl1qq (2.7)
k t t k t t
p0,¨s k“0 n“1k“0 }ℓ}“n,|ℓ|“k`1 p0,¨s
is well defined in the sense of (2.6). The definition of the integral with integrands of the
form
F:Ωˆr0,TsÑLpTpRdqbTpRdq;Tq
with respect to processes XPScpTpRdqbTpRdqq is completely analogous.
2.3. Generalized signatures. We now follow [HDL86] to give the precise meaning of
the geometric development (1.2), that is dS“S˝dX, or component-wise, for every word
w PW d, ÿ
dSw “ Sw1˝dXw2,
w1w2“w
where thedriving noise X is a T -valued continuous semimartingale, i.e. XPScpT q. The
0 0
Itô integral meaning of this equation, when started at time s from sPT , for times těs,
1
is given by
ż ż
1 t
S “s` S dX ` S dxXy , (2.8)
t u u 2 u u
ps,ts s
leaving the component-wise version to the reader. We have
Proposition 2.1. Let sPT and suppose XPScpT q. For every sPr0,Ts and sPT ,
1 0 1
equation (2.8) has a unique global solution on T starting from S “s.
1 s10 P.FRIZ,PAULP.HAGER,ANDN.TAPIA
Proof. Note that S solves (2.8) iff s´1S solves the same equation started from 1PT . We
1
may thus take s“1 without loss of generality. The graded structure of our problem, and
more precisely that X“p0,X,X,...q in (2.8) has no scalar component, shows that the
(necessarily) unique solution is given explicitly by iterated integration, as may be seen
ş
explicitly when writing out Sp0q ”1, Sp1q “ t dX “X PRd,
ż t s s,t
1
Sp2q “ Sp1qdX `X ´X ` xXy PpRdqb2,
t u u t s 2 s,t
ps,ts
and so on. (In particular, we do not need to rely on abstract existence, uniqueness results
for SDEs [KPP95] or Lie group stochastic exponentials [HDL86].) □
Definition 2.2. For XPScpT q and sPr0,Ts we define SigpX| q”SigpXq as the
0 rs,¨s s,¨
unique solution to (2.8) such that SigpXq “1.
s,s
The following can be seen as a (generalized) Chen relation.
Lemma 2.3. Let XPScpT q and 0ďsďtďuďT. Then the following identity holds
0
with probability one, for all such s,t,u,
SigpXq SigpXq “SigpXq . (2.9)
s,t t,u s,u
Proof. Call Φ s – S the solution to (2.8) at time t ě s, started from S “ s. By
tÐs t s
uniqueness of the solution flow, we have Φ ˝Φ “Φ . It now suffices to remark
uÐt tÐs uÐs
that, thanks to the multiplicative structure of (2.8) we have Φ s“sSigpXq . □
tÐs s,t
As usual, when X P ScpTNq for some N ě 1 the development (2.8) is understood
0
within the truncated tensor algebra TN and therefore SigpXq is an elem ent in TN.
1 s,t 1
2.4. Expected signatures and signature cumulants. Throughout this section let
X P ScpT q be defined on a filtered probability space pΩ,F,pF q ,Pq the usual
0 t 0ďtďT
conditions and with the property that every martingale has a continuous version. Recall
that E denotes the conditional expectation with respect to the sigma algebra F . When
t t
Ep|SigpXqw |qă8forall0ďtďT andallwordsw PW ,thenthe(conditional) expected
0,t d
signature
ÿ
µµµ pTq–E pSigpXq q“ E pSigpXqw qe PT , 0ďtďT,
t t t,T t t,T w 1
wPWd
is well defined. In this case, we can also define the (conditional) signature cumulant of X
by
κκκ pTq–logpµµµ pTqqPT , 0ďtďT.
t t 0
An important observation is the following
Lemma 2.4. Given Ep|SigpXqw |q ă 8 for all 0 ď t ď T and words w P W , then
0,t d
µµµpTqPScpT q and κκκpTqPScpT q.
1 0
Proof. It follows from the relation (2.9) that
` ˘
µµµ pTq“E pSigpXq q“E SigpXq´1SigpXq “SigpXq´1E pSigpXq q.
t t t,T t 0,t 0,T 0,t t 0,T
Therefore projecting to the tensor components we have
ÿ ´ ¯
µµµ pTqw “ p´1q|w1|SigpXqw1E SigpXqw2 , 0ďtďT, w PW .
t 0,t t 0,T d
w1w2“w
Since pSigpXqw q and pE pSigpXqw q are semimartingales (the latter in fact a
0,t 0ďtďT t 0,T 0ďtďT
martingale), it follows from Itô’s product rule thatµµµwpTq is also a semimartingale for all
words w PW , henceµµµpTqPScpT q. Further, recall thatκκκpTq“logpµµµpTqq and therefore
d 1
it follows from the definition of the logarithm on T that each component κκκpTqw with
1
w P W is a polynomial of pµµµpTqvq . Hence it follows again by Itô’s product
d vPWd,|v|ď|w|
rule thatκκκpTqPScpT q. □
0
It is of strong interest to have a more explicit necessary condition for the existence of
the expected signature. The following theorem below, the proof of which can be found
in [FHT22, Section 7.2], yields such a criterion.ON EXPECTED SIGNATURES AND SIGNATURE CUMULANTS IN SEMIMARTINGALE MODELS 11
Theorem 2.5. Let q P r1,8q and N P N , then there exist two constants c,C ą 0
ě1
depending only on d, N and q, such that for all X“Xp0,Nq PHq,N
c|||X|||Hq,N ď|||SigpXq 0,¨|||Hq,N ďC|||X|||Hq,N.
In particular, if X P H8´pT q then SigpXq P H8´pT q and the expected signature
0 0,¨ 1
exists.
Remark 2.6. Let X“p0,M,0,...,0q where M PMpRdq is a martingale, then
|||X|||Hq,N “}M}HqN “}|xMy T|1{2 } LqN,
and we see that the above estimate implies that
n“m 1,a ..x .,N}SigpXqp 0n ,¨q}1 S{n
qN{n
ďC}M}HqN.
This estimate is already known and follows from the Burkholder-Davis-Gundy inequality
for enhanced martingales, which was first proved in [FV06].
3. Functional equations for the expected signature
In this section we present central functional equations for the expected signature and
signature cumulants of semimartingales. For better accessibility we will first present the
purely continuous case and then, after an an intermezzo on discrete processes, indicate
how the results extend to general càdlàg semimartingales.
3.1. The continuous case. Throughout this section we will assume that pΩ,F,pF q,Pq
t
is a filtered probability space satisfying the usual conditions and with the property that
every martingale has a continuous version. This is for instance the case if the filtration is
the natural and completed filtration of a Brownian motion.
To streamline the derivation, we will start from first principles and introduce the key
concepts from Itô-calculus in the non-commutative setting when first needed, not focusing
on integrability considerations which are fully resolved in [FHT22]. For XPH8´pT q
0
the conditional expected signature and the signature cumulants
µµµpTq“pE pSigpXq q PScpT q, κκκpTq“plogµµµ pTqq PScpT q,
t t,T 0ďtďT 1 t 0ďtďT 0
are well defined. The derivation starts by defining the martingale
M:“pE rSigpXq sq PMpT q,
t 0,T tě0 1
which is continuous under the given assumptions on the filtration. It factors into
M “ SigpXq E rSigpXq s “ SigpXq µµµ pTq.
t 0,t t t,T 0,t t
Oneisnowinclined toapplyItô’sruletotheproductontheright-handsideasthisshould
reveal non-trivial cancellations implied by the martingality of M. For ease of notation we
denote S :“SigpXq andµµµ :“µµµ pTq. Then the definitions put forward in Section 2.2
t 0,t t t
directly yield the product rule
ż ż
t t
M “ 1` pdS qµµµ ` S pdµµµ q`xS,µµµy
t u u u u t
ż0 ˆ´ 0 ¯ ˙
t 1
“ 1` S dX ` dxXy µµµ `dµµµ `dxX,µµµy (3.1)
u u 2 u u u u
0
where in the second line we have used the Itô-integral form of S in (2.8). The martingality
of M and invertability of the tensor S for all times tPr0,Ts imply that the term in the
t
bracket is the differential of a local martingale. By Theorem 2.5 we have S,µµµPH8´pT q
0
and it is therefore not difficult to conclude that this local martingale is also a true
martingale. Taking conditional expectations of its integral then yields the following
functional equationµµµ:
Theorem 3.1. The conditional expected signature µµµ “ µµµpTq of X P H8´pT q is the
0
unique solution (up to indistinguishably) of the following functional equation
"ż ´ ¯ *
T 1
µµµ “1`E dX ` dxXy µµµ `xX,µµµy , 0ďtďT. (3.2)
t t u 2 u u t,T
t12 P.FRIZ,PAULP.HAGER,ANDN.TAPIA
Furthermore, if XPH1,N for some N PN , then the identity (3.2) still holds true for
ě1
the truncated expected signature µµµ–pE pSigpXp0,Nqq qq .
t t,T 0ďtďT
It is crucial to understand that the uniqueness part of the above statement follows by
projecting the above equation to a tensor level, say ně1, and then noting that the above
right-hand side only depends on tensor levelsµµµpkq for k ďn´1. In other words, equation
(3.2) directly leads to a recursive scheme for calculatingµµµ which is explicitly spelled out
in Corollary 4.1 of Section 4.
Moving forward to the signature cumulantsκκκ:“κκκpTq one needs to further resolve the
¨
differential ofµµµ“eκκκ in (3.1). The key is following Itô-formula for the tensor exponential
map.
Lemma 3.2. For XPScpT q it holds
0
ż ż
t t
eXt ´eX0 “ GpadX qpdX qeXu ` QpadX qpdxxX,Xyy qeXu,
u u u u
0 0
for all 0ďtďT, where for xPT we define
0
ÿ8
padxqk
ÿ8
padxqndpadxqm
Gpadxq“ , Qpadxq“ 2 . (3.3)
pk`1q! pn`1q!pmq!pn`m`2q
k“0 m,n“0
ThelinearoperatorsGpadxqandQpadxqonT andTpRdqbTpRdqrespectivelyappear
0
naturally as the first and second order derivative of the non-commutative exponential
map. A version of the above lemma in a matrix setting previously appeared in [KPP21];
the full proof can be found in [FHT22, Lemma 7.8].
Inserting this formula in (3.1) we arrive at
ż
t
M “1` S pdL qeκκκupTq,
t t t
0
where LPScpT q is given by
0
ż ż
1 t 1 T
L “ X ` xXcy ` Gpadκκκ qpdκκκ q` Qpadκκκ qpdxxκκκ,κκκyy q
t t 2 t u´ u 2 u´ u
ż 0 t
T
` pIddGpadκκκ qqpdxxX,κκκyy q.
u´ u
t
Again the martingality of M and invertability of S t,e´κκκt PScpT 1q imply that L is a local
martingale. The main work done in the proof of [FHT22, Theorem 4.1] is to show that
under the given assumptions on X it also holds that L is also a true martingale. Taking
expectations then yields a first functional equation forκκκ:
E rL s“0.
t t,T
Similarly to the functional equation (3.2) forµµµ, the above equation leads to a recursive
scheme over tensor levels which uniquely determinesκκκ. However, there is still a degree of
implicitness that can be removed.
To this end note that the operator Gpadxq has the following inverse
ÿ8
B
Hpadxq– k padxqk, (3.4)
k!
k“0
with Bernoulli numbers pB q “ p1,´1,1...q. Integrating Hpadκκκq against dL and
k kě0 2 6
verifying that the resulting process is in MpT q we arrive at a second functional equation
0
forκκκ:ON EXPECTED SIGNATURES AND SIGNATURE CUMULANTS IN SEMIMARTINGALE MODELS 13
Theorem 3.3. The signature cumulant κκκ of XPH8´pT q is the unique solution (up to
0
indistinguishably) of the following functional equation
"ż ż
T 1 T
κκκ “E Hpadκκκ qpdX q` Hpadκκκ qpdxXy q
t t u u 2 u u
t ż t
1 T
` Hpadκκκ qQpadκκκ qpdxxκκκ,κκκyy q (3.5)
2 u u u
żt *
T
` Hpadκκκ qpIddGpadκκκ qqpdxxX,κκκyy q ,
u u u
t
for all 0ďtďT. Furthermore, if XPH1,N for some N PN , then the identity (3.5)
ě1
still holds true for the truncated signature cumulant κκκ–plogE pSigpXp0,Nqq qq .
t t,T 0ďtďT
3.2. Discrete processes and the càdlàg case. Intheprevioussectionwehaveassumed
a continuous information flow, manifested by the fact that any martingale adapted to
pF q has continuous sample paths. In this section we present how the previous formulas
t
generalize when this assumption is dropped. It is instructive to consider the case of
discrete processes first and then move forward to the case of càdlàg semimartingales.
Discrete processes. Let pΩ,G,Pq be a probability space with filtration pG q .
j j“0,...,J
Further, let pX q be a T -valued adapted process. We can define a discrete version of the
j 0
signature by multiplying exponential increments
S
0
“1, S
j
“S j´1eXj´Xj´1, for j “1,...,J.
This is precisely the signature of the paths obtained from linearly interpolating the points
X ,X ,...,X in T . Assume for simplicity that X has moments of all orders, i.e.,
0 1 J 0
Er|Xpnq|ps ă 8 for all n,p P N , for otherwise we need to truncate tensor levels. We
j ě1
then correspondingly define the conditional expected signature of pX q by
j
“ ‰
µµµ :“E S´1S |G , j “0,...,J.
j j J j
A simple computation yields for j “J ´1,...,0:
“ ‰
µµµ
j
“ E “eXj`1´Xj¨¨ “¨eXJ´XJ´1 |G
j ‰ˇ ‰
“ E “eXj`1´XjE eXj`2´ ‰Xj`1¨¨¨eXJ´XJ´1 |G
j`1
ˇ G
j
“ E eXj`1´Xjµµµ
j`1
|G
j
.
These identities permit to calculate µµµ in a backwards induction. What is not revealed,
however,isthattocomputeµµµpnq onlystrictlylowertensorlevelsµµµp1q,...µµµpn´1q areneeded.
To see that this is really the case, we first bring the identity into the following difference
form
“ ˇ ‰
0“E peXj`1´Xj ´1qµµµ j`1`pµµµ j`1´µµµ jqˇ G
j
, (3.6)
Summing over tj,j`1,...,J ´1u and conditioning to G we obtain the following
j
Theorem 3.4. Given that the adapted T -valued process pX q satisfies the moment
0 j
condition Er|Xpnq|ps ă 8 for all n,p P N , its conditional expected signature pµµµ q is
j ě1 j
uniquely characterized by the equation
„ ˇ ȷ
Jÿ´1 ˇ
µµµ
j
“1`E peXi`1´Xi ´1qµµµ
i`1
ˇ ˇG
j
, j “0,...,J.
i“j
In particular, projecting to tensor levels yields the following recursion over nPt1,2,...u
and j “tJ,J ´1,...,1u
nÿ´1Jÿ´1 ÿ
1
” ˇ
ˇ
ı
µµµpnq “ E pX ´X qpℓqµµµpkq ˇG ,
j |ℓ|! i`1 i i`1 j
k“0 i“j }ℓ}“n´k
where for ℓPNk
ě1
and xPT
0
we set xpℓq “xpl1q¨¨¨xplkq.14 P.FRIZ,PAULP.HAGER,ANDN.TAPIA
Example 3.5. (Markov Chains; see also [BLO23, Section 5].) Consider a d-dimensional
Markov chain pX q and set pXp1qq“pX q and Xpnq ”0 for n‰1. Denote by ppiqpx,dyq
j j j j j
thestep-itransitionprobabilitykernelofX startinginxPRd attimej withpp0qpx,dyq“
j
δ pdyq. We see inductively that almost surely µµµpnq “ fnpX q where the functions fn :
x j j j j
Rd ÑpRdqbn satisfy the recursive scheme
ż ż
nÿ´1Jÿ´1
1
fnpxq“ pz´yqbpn´kqfk pzqpp1qpx,dyqppi´jqpy,dzq
j n! i`1 i j
k“1 i“j
Rd Rd
for n“1,2... and j “J ´1,...,0 with and f0 “1, fn “0 for ně1. ♢
j J
Example 3.6. (Random walks in the group [BFH09,Che18].) Let pg q be an
j j“1,...,J
IID sequence with values in the řLie algebra T 0N and exponential image G
j
“ egj P T 1.
Consider the random walk X “ j g and its signature
j k“1 k
âj
S “ G , j “1,...,J.
j k
k“1
Then either directly, or following the computations above, we obtain the conditional
expected signature
` ˇ ˘
µµµ “E S´1S ˇ G “pMqJ´j, j “0,...,J
j j J j
assuming that M “EpG q is (componentwise) well defined.
1
For instance, the case of a planar lattice random walk is covered by N “1,d“2, and
equal weighted point masses at ˘e ˘e , that is, X is a simple random walk in R2. A
1 2
direct computation shows that
` ˘
1 1
M “ ee1 `e´e1 `ee2 `e´e2 “ pcoshpe q`coshpe qq,
4 2 1 2
where cosh: T ÑT is defined by its usual power series (see Section 2.2). In particular,
for any tensor series xPT ,
0
coshpxq“1`pxq2`¨¨¨
For λą0, let δ :T ÑT denote the dilation operator. Diffusive rescaling of moments
λ
yields
ˆ ˙
1 J
δ µµµ “pδ MqJ “ 1` pe2`e2q`opJ´1q .
J´1{2 0 J´1{2 2J 1 2
UpontakingthelimitasJ Ñ8werecoverFawcett’sformulaforplanarBrownianmotion.
For an example with N “2 consider equal weighted point masses at t˘re ,e s : 1ď
i j
iăj ďdu. A similar argument leads to a Fawcett-type formula
ř
lim δ J´1{4µµµ
0pJq“edpd2
´1q
iăjprei,ejsq2
.
JÑ8
for the level-4 Brownian rough paths that recently arose in the work of Hairer (2024) (see
Section 6.1). ♢
We close the discussion on discrete processes by reconciling the results with the
continuous case. Expressing the functional equation from Theorem 3.4 in the alternative
form „ ˇ ȷ
Jÿ´1 ˇ
µµµ
j
“1`E peXi`1´Xi ´1qpµµµ i`pµµµ i`1´µµµ iqqˇ ˇG
j
,
i“j
we see that in the diffusive limit, setting δX “X ´X , we can expand
i i`1 i
ÿ ÿ
1
peXi`1´Xi ´1qµµµ
i
« pδX i` 2pδX iq2`¨¨¨qµµµ i,
i i
and similarly, with δµµµ “µµµ ´µµµ ,
ÿi i`1 i ÿ
peXi`1´Xi ´1qpµµµ i`1´µµµ iq« pδX i`¨¨¨qδµµµ i,
i i
to “see" the functional relation of Theorem 3.1, derived by stochastic calculus.ON EXPECTED SIGNATURES AND SIGNATURE CUMULANTS IN SEMIMARTINGALE MODELS 15
For the conditional signature cumulants pκκκ q “ plogµµµ q we obtain a first identity by
j j
multiplying (3.6) with e´κκκj from the right:
“ ˇ ‰
0“E peXj`1´Xj ´1qeκκκj`1e´κκκj `peκκκj`1e´κκκj ´1qˇ G
j
.
Even in the commutative (one-dimensional) case the above identity gives non-trivial
relations for conditional cumulants (see Section 5.3.2). In contrast to the continuous
case, transforming the above formula entirely to logarithmic coordinates under the use of
the Baker-Campbell-Hausdorff (BCH) formula is in general not possible, since after all
the logarithm is non-linear and cannot be exchanged with the conditional expectation.
Nevertheless, a martingale transform yields the identity
„ Jÿ´1 ´ ¯ˇ ˇ ȷ
0“E Hpadκκκ iq peXi`1´Xi ´1qeκκκi`1e´κκκi `peκκκi`1e´κκκi ´1q ˇ ˇG
j
,
i“j
where a second order expansions in the terms δX and δκκκ “κκκ ´κκκ ,
i i`1 i
eκκκi`1e´κκκi ´1“Gpadκκκ iqpδκκκ iq`Qpadκκκ iqpδκκκ ibδκκκ iq`...
and
´ ¯´ ¯
1
peXi`1´Xi ´1qeκκκi`1e´κκκi “ δX i` 2pδX iq2`... 1`Gpadκκκ iqpδκκκ iq`... ,
allows us once more to “see” that the diffusive limit leads to the functional equation from
Theorem 3.3.
Remark 3.7. In the deterministic setting, the log-signature Ω “ logpS´1S q can be
j j J
fully resolved as a Lie-series by iterative application of the BCH-formula (see [FHT22,
Theorem 5.1]):
ż
Jÿ´1 1
Ω “ ΨpexppadθδX q˝exppadΩ qqpδX qdθ, j “J,J ´1,...,0,
j i i`1 i
i“j 0
with Ψpzq – Hplogzq “ logz{pz´1q. It is important to note that the displayed iden-
tity also follows directly by applying Theorem 3.3 to the deterministic piecewise linearly
interpolated path of pX q.
j
The càdlàg case. Let pΩ,F,P,pF qq be a filtered probability space satisfying the usual
t
conditions of a right-continuous and complete filtration. The interpretation of signature
as the “geometric” development of a T -value semimartingale X in the group T extents
0 1
from the continuous [HDL86] to the càdlàg case [Est92] and is consistent with the
Marcus [Mar78,Mar81,KPP95,App09,FS17] interpretation of
dS “S ˝dX , S “1PT . (3.7)
t t t 0 1
The idea being that whenever the process jumps, the signature is multiplied by the
exponential displacement. Since càdlàg semimartingales are much more subtle than just
continuous semimartingales with finitely many jumps, we have to recall a few concepts
from the general theory to make sense of (3.7) (see e.g. [Pro05,JS03] for introductions to
stochastic calculus for general semimartingales):
Firstly, a càdlàg semimartingale X has a unique continuous local martingale part
denoted by Xc. Secondly, the quadratic covariation of semimartingales X and Y is given
by
ż ż
rX,Ys “ X Y ´X Y ´ Y dX ` X dY
t t t 0 0 s´ s s´ s
ÿp0,ts p0,ts
“ xXc,Ycy ` ∆X ∆Y ,
t s s
sPp0,ts
where X :“ lim X and ∆X “ X ´X , with Itô-integrals in the first equality
t´ εÓ0 t´ε t t t´
and an almost surely convergent sum in the second equality. In analogy to Section 2.2
this notation directly extends to T-valued semimartingales X P SpTq and Y P Sp Tq
denotingbyXc PM pTqthecomponentwisecontinuouspartsandbyrX,Ysrespectively
loc
X,Y their T-valued inner respectively TpRdqbTpRdq-valued outer bracket. Thirdly,
(cid:74)semim(cid:75)artingale decompositions X “X `M `A into a local martingale M and a finite
016 P.FRIZ,PAULP.HAGER,ANDN.TAPIA
variation process A are in general not unique. Therefore, one extends the definition of the
semimartingale norms }¨}Hq from Section 2.2 by taking the infimum over all possible
semimartingale decompositions.
Resorting to the previously mentioned references on the Marcus SDE (3.7), we can now
state the explicit Itô-integral from:
ż ż
1 t ÿ ` ˘
S “1` S dX ` S dxXcy ` S e∆Xu ´1´∆X . (3.8)
t u´ u 2 u´ u u´ u
p0,ts 0 0ăuďt
The two-sided estimates from Theorem 2.5 on the homogeneous norm |||¨|||Hq,N of the
signatures prevails in the càdlàg case (see [FHT22, Theorem 3.2, Section 7.1]) giving us
necessary conditions for existence of signature moments analogous to the continuous case.
Repeating the derivation from the previous section now with càdlàg Itô-calculus we
obtain the following
Theorem 3.8. Let XPSpT 0q with }Xw}Hq ă8 for all w PW
d
and q ě1. Then the
conditional expected signatureµµµ“µµµpTq“pE rSigpXq sq is the unique solution (up
t t,T 0ďtďT
to indistinguishably) of the following functional equation
"ż T ´ 1 ¯ ÿ ` ˘ *
µµµ “1`E dX ` dxXcy µµµ `rX,µµµs ` e∆Xu ´1´∆X µµµ ,
t t u 2 u u´ t,T u u
t sPpt,Ts
0ďtďT. (3.9)
Furthermore, if XPSpT 0Nq with |||X|||H1,N ă8 for some N PN ě1, then (3.9) still holds
true for the truncated expected signature µµµ–pE pSigpXp0,Nqq qq .
t t,T 0ďtďT
Proof. We write S “ SigpXq and µµµ “µµµpTq. By definition of the quadratic variation
0,¨
rS,µµµs we have that the martingale M:“pErS |F sq“pS µµµ q has the representation
T t t t
ż ż
t t
M“1` pdS qµµµ ` S pdµµµ q`rS,µµµs .
u u´ u´ u t
0 0
Using the Itô-representation of S form (3.8) we can spell out
ż t ż T ´ 1 ¯ ÿ ` ˘
pdS qµµµ “ S dX ` dxXcy µµµ ` S e∆Xu ´1´∆X µµµ ,
u u´ u´ u 2 u u´ u´ u u´
0 t 0ăuďt
and
ÿ
rS,µµµs “xSc,µµµcy ` ∆S ∆µµµ
t t u u
ż
0ăuďt
t ÿ
“ S pdxXc,µµµcy q` S pe∆Xu ´1q∆µµµ
u´ u u´ u
ż0 0ăuďt
t ÿ
“ S pdrX,µµµs q` S pe∆Xu ´1´∆X q∆µµµ .
u´ u u´ u u
0 0ăuďt
ş
Plugging things back together, we see that T S´1dM is precisely the term appearing in
t
theconditionalexpectationof(3.9)andisbydefinitiontheincrementofalocalmartingale.
That it is a true martingale increment follows inductively over tensor levels by application
of the generalized Hölder, Doob, Emery and Burkholder-Davis-Gundy inequalities. The
truncated version of the statement then follows en passant. The precise argument can be
found in [FHT22, Section 7]. □
Remark 3.9.
For signature cumulants a version of Theorem 3.3 in the general càdlàg setting can
be found in [FHT22, Theorem 4.1]. We refrain from quoting the full functional equation
as its extension from the continuous setting is analogous to the above extension for the
expected signature. We also recall the previous discussion about the signature cumulants
for discrete processes which sufficiently foreshadows the general result.ON EXPECTED SIGNATURES AND SIGNATURE CUMULANTS IN SEMIMARTINGALE MODELS 17
4. Recursive formulas and diamond products
Theorem 3.1 and 3.3 allow for an iterative computation of the expected signature
and signature cumulants, by projecting the functional equations to tensor levels. In
the following subsections we will explicitly spell out these recursive schemes and then
rephrase them in terms of so called diamond products as they were introduced for scalar
semimartingales in [AGR20].
While all recursions can be stated for the general càdlàg case ( [FHT22, Section 4.2]),
we only present the continuous case for simiplicity. Therefore we shall presume the
assumptions on the filtration from the continuous setting in Section 3.1 throughout this
section.
4.1. Recursive formula for signature moments. Thisrecursiveschemetriviallystarts
withµµµp0q ”0 and the first level of signature moments
´ ¯
µµµp1q “E Xp1q .
t t t,T
and continuous with a first recursion in the second level
„ A E ż A E ȷ
1 T
µµµp2q “E Xp2q ` Xp1q ` pdXp1qqµµµp1q` Xp1q,µµµp1q . (4.1)
t t t,T 2 t,T t u u t,T
Projecting the functional equation (3.2) forµµµ to higher tensor levels immediately gives
the following
Corollary 4.1. Let XPH1,N for some N PN . Then for n“1,...,N we have
ě1
nÿ´1 "ż T ` ˘ 1nÿ´kż T ` A E ˘
µµµpnq “ E dXpn´kq µµµpkq` d Xpiq,Xpn´k´iq µµµpkq
t k“0 t t u u 2 i“1 t u u
nÿ´kA E *
` Xpiq,µµµpkq . (4.2)
t,T
i“1
Example4.2. Considerthespecialcasewithvanishinghigherordercomponents,Xpiq ”0,
for i‰1, and X“Xp1q ”M, a d-dimensional continuous square-integrable martingale.
We then haveµµµp1q ”0 and it directly follows from Stratonovich-Itô correction that
ż A E
T 1 1
µµµp2q “E pM ´M q˝dM “ E xMy “ E Xp1q .
t t t u t u 2 t t,T 2 t t,T
which is indeed a (very) special case of the general expression forµµµp2q.
Assuming that M P HN the recursion proceeds for levels n P t2,3,...,Nu and
simplifies to due the martingality to
" ż A E *
1 T
µµµpnq “E µµµpn´2qdxM,My ` M,µµµpn´1q .
t t 2 t u u t,T
ş
In case M is a Gaussian martingale of the form M “ t σpsq.dB P H8´ for an m-
t 0 s
dimensional Brownian motion B and σ P L2pr0,Ts;Rdˆmq, an induction immediately
shows thatµµµ is deterministic. Whence brackets withµµµ vanish and we obtainµµµpnq ”0 for
odd n and
ż
1 T
µµµpnq “ σ.σTpuqµµµpn´2q du, for even n. (4.3)
t 2 u
t
When M is a standard Brownian motion, i.e. , σ ”I PRdˆd is the identity matrix, we
d
now readily verify Fawcett’s formula [Faw02,FH20]
´ ¯
T ´t
µµµ “exp I , tPr0,Ts.
t 2 d
♢18 P.FRIZ,PAULP.HAGER,ANDN.TAPIA
4.2. Recursive formula for signature cumulants. The first level of signature cumu-
lants are identical to the signature moments
´ ¯
κκκp1q “µµµp1q “E Xp1q .
t t t t,T
The formula we obtain from projecting (3.5) to the second tensor level reads
„ A E ż ” ı A E A E ȷ
1 1 T 1
κκκp2q “E Xp2q ` Xp1q ` κκκp1q,dXp1q ` κκκp1q ` Xp1q,κκκp1q .
t t t,T 2 t,T 2 t u u 2 t,T t,T
Fromtheverydefinitionofthelogarithmwemusthaveκκκp2q “µµµp2q´1µµµp1qµµµp1q,whichisin
2
line with the above expression forκκκp2q and the previous formula (4.1) forµµµp2q, but already
requires a little work to verify. Indeed, using the martingality of Xp1q`κκκp1q “ErXp1qs
¨ T
we resolve both expressions using the Itô-product rule in the following calculation
„ ż ȷ „ ż ȷ
1 T 1 T
E pdXp1qqκκκp1q “E ´ pdκκκp1qqκκκp1q
t 2 u u t 2 u u
t „ t ż A E ȷ
1 1 T 1
“ E ´κκκp1qκκκp1q´ κκκp1qdXp1q` κκκp1q .
2 t t t 2 t u u 2 t,T
The general recursion forκκκ is combinatorially more involved. To present it as concise
as possible, we recall the following notation from Section 2.2: For ℓ P pN qk we write
ě1
ℓ “ pl ,...,l q, |ℓ| :“ k and ||ℓ|| :“ l ` ¨¨¨ ` l . Furthermore, for 0 ď i,j ď k
1 k 1 k
we define ℓ “ pl ,...,l q if i ă j and ℓ “ pq otherwise. Moreover padxpℓqq “
i:j i`1 j i:j
padxpl1q¨¨¨adxplkqq for any xPT
0
and padxpqq“Id.
Corollary 4.3. Let XPH1,N for some N PN , then we have
ě1
´ ¯ ÿ ˆ
1
κκκpnq “E Xpnq ` E HMag1pX,κκκ;ℓq ` HMag2pX,κκκ;ℓq
t t t,T t t,T 2 t,T
|ℓ|ě2,||ℓ||“n ˙
`HQuapκκκ;ℓq `HCovpX,κκκ;ℓq (4.4)
t,T t,T
where the summation is over ℓPNk , k PN and
ě1 ě1
ż ´ ¯
B T
HMag1pX,κκκ;ℓq
t,T
“ pk´k´ 11
q!
adκκκp uℓ1:kq dXp ul1q
żt
´ A E ¯
B T
HMag2pX,κκκ;ℓq
t,T
“ pk´k´ 22
q! t
adκκκp uℓ2:kq d Xpl1q,Xpl2q
u
1 ÿk ˆ k´1˙ż T ´ ¯´ ¯
Quapκκκ;ℓq
t,T
“
k! m´1
adκκκp uℓ ´2:mqdadκκκ upℓm:kq dxxκκκpl1q,κκκpl2qyy
u
m“2 ż ´t ¯´ ¯
1 T
CovpX,κκκ;ℓq “1 Iddadκκκpl2:kq dxxXpl1q,κκκpl2qyy
t,T tkě2upk´1q! u´ u
t
ż
T ÿk B
HQuapκκκ;ℓq “ k´j adκκκpℓj:kq pdQuapκκκ;ℓ q q
t,T pk´jq! u´ 0:j u
t j“2
ż
T ÿk B ` ˘
HCovpX,κκκ;ℓq “ k´j adκκκpℓj:kq dCovpX,κκκ;ℓ q
t,T pk´jq! u´ 0:j u
t j“1
Exşample 4.4. In the Gaussian martingale case from Example 4.2, i.e., where X “
p0, ¨ σpsq.dB ,0,...qPH´8pT q an induction yields thatκκκ is dete rm inistic and whence
0 s 0
the recursion dramatically simplifies toκκκpnq ”0 for odd n and
ż
ÿ B T ` ˘
κκκpnq “ |ℓ| adκκκpℓq σ.σTpuq du, for even n.
t |ℓ|! u
}ℓ}“n´2 t
This is precisely the (deterministic) Magnus expansion of the logarithm of the solution
of the equation (4.3). We will revisit this connection in Section 6.2 in the more general
setting of time dependent Lévy-processes.ON EXPECTED SIGNATURES AND SIGNATURE CUMULANTS IN SEMIMARTINGALE MODELS 19
Note thatκκκ is Lie in SympRdbRdqĂT , but in Rd. In the standard Brownian case
t 0
σ ” I , all commutators vanish and we obtain Fawcett’s formula in logarithmic form
d
κκκ “ 1pT ´tqI . ♢
t 2 d
4.3. Diamond Products. We extend the notion of the diamond product introduced
in [AGR20], which we recall, for continuous scalar semimartingales to our setting. Denote
by E the c onditional expectation with respect to the sigma algebra F .
t t
Definition 4.5. For X,Y PScpRq define
´ ¯
pX˛Yq pTq–E xX,Yy .
t t t,T
For T-valued continuous semimartingales we have the following
Definition 4.6. For X and Y in ScpTq define
˜ ¸
` ˘ ÿ ÿ
pX˛Yq pTq–E xX,Yy “ pXw1 ˛Yw2q pTq e PT
t t t,T t w
wPWd w1w2“w
whenever the T-valued quadratic covariation which appears on the right-hand side is
integrable. We also define an outer diamond by
ÿ
pX˛Yq pTq–E pxxX,Yyy q“ pXw1 ˛Yw2q pTqe be PTpRdqbTpRdq.
t t t,T t w1 w2
w1,w2PWd
The following lemma allows us to rewrite all recursion from the previous sections in
terms of diamond products.
Lemma 4.7. Let p,q,r Pr1,8q such that 1{p`1{q`1{r ă1 and let X PMc ppRdqblq,
loc
Y PMc ppRdqbmq,andZ PCppRdqbnqwithl,m,nPN,suchthat}X} ,}Y} ,}Z} ă
loc Hp Hq Sr
8. Then it holds for all 0ďtďT
˜ ¸ ˜ ¸
ż ż
T T
E Z dpX˛Yq pTq “´E Z dxX,Yy .
t u u t u u
t t
The proof relies on standard approximation results for continuous semimartingales as
it is fairly clear from the definition of the diamond product that the identity holds for
simple processes Z, since pX˛Yq pTq“0. The Kunita-Watanabe inequality ensures that
T
the expectation on the right-hand side is well defined.
For clarity we focus on the case where X“MPH8´ is a martingale, for otherwise
one needs to carry along conditional expectations of the finite variation parts. For the
conditional expected signature, the recursion from Corollary 4.1 is then conveniently
rewritten into
" ż *
1nÿ´k T ` ˘ nÿ´k
µµµpnq “E d Mpiq˛Mpn´k´iq pTqµµµpkq` pMpiq˛µµµpkqq pTq .
t t 2 u u t
i“1 t i“1
Similarly, for the signature cumulants we obtain
` ˘ B ż T ´ ¯
E
t
HMag2pX,κκκ;ℓq
t,T
“ pk´k´ 22
q!
adκκκp uℓ2:kq dpXpl1q˛Xpl2qq upTq ,
` ˘ t
E Quapκκκ;ℓq
t # 1t,T ÿk ˆ k´1˙ż T´ ¯´ ¯+
“´E adκκκpℓ2:nqdadκκκpℓm:kq dpκκκpℓ1q˛κκκpℓ2qq pTq .
t k! m´1 u´ u´ u
m“2 t
and
# +
` ˘
1
ż T´ ¯´ ¯
E CovpX,κκκ;ℓq “´E Iddadκκκpℓ3:kq dpXpℓ1q˛κκκpℓ2qq pTq .
t t,T t pk´1q! u´ u
t
When d “ 1 (or in the projection onto the symmetric algebra, c.f. Section 5) the
cumulantrecursiontakesaparticularlysimpleform, sinceadx”0forallxPT , ford“1
020 P.FRIZ,PAULP.HAGER,ANDN.TAPIA
a commutative algebra. Equation (4.4) then becomes
´ ¯ 1nÿ´1
κκκpnqpTq“E Xpnq ` ppXpkq`κκκpkqq˛pXpn´kq`κκκpn´kqqq pTq.
t t t,T 2 t
k“1
We shall revisit this in a multivariate setting and comment on related works in Section 5.
4.4. Remark on tree representation. As illustrated in the previous section, in the
case where d “ 1 (or when projecting onto the symmetric algebra cf. Section 5), the
cumulant recursion takes a particularly simple form. The algebraic perspective in the
setting of Friz, Gatheral and Radoiçić [FGR22] gives a tree series expansion of cumulants
using binary trees. This representation follows from the fact that the diamond product of
semimartingales is commutative but not associative. As an example (with notations taken
from Section 5.3), in case of a one-dimensional continuous martingale, the first terms are
1 1 1 1
K pTq“ ` ` ` ` `¨¨¨
t 2 2 2 8
This expansion is organized (graded) in terms of the number of leaves in each tree, and
each leaf represents the underlying martingale.
Inthedeterministiccase,treeexpansionsarealsoknownfortheMagnusexpansion[IN99]
andtheBCHformula[CM09]. Theseexpansionsalsointermsofbinarytrees,differentfrom
theonesaboveastheyarerequiredtobenon-planartoaccountforthenon-commutativity
of the Lie algebra. As an example (with the notations of Remark 3.7), we have
1 1 1
Ω pTq“ ` ` ` `¨¨¨
t 2 12 4
In this expansion, the nodes represent the underlying vector field and edges represent
integration and application of the Lie bracket, coming from the ad operator. It is an
interesting open question to find a unified tree representation that accounts for the unified
functional recursion of our Corollary 4.3.
5. Multivariate Moments and Cumulants
We saw that T –TppRdqq is the natural state space for signatures, expected signatures
and their logarithms. When d“1, the signature of a path X :r0,Ts is nothing more than
the sequence
ˆ ˙
pX q2 pX q3 pX q2 pX q3
1,X , 0,T , 0,T ,... ”1`X ` 0,T ` 0,T `...
0,T 2 3! 0,T 2 3!
The expected signatures is then exactly the sequence of moments of the random variable
X , to the extent of being well-defined and up to factorial constants. Similarly, the
0,T
signatures cumulants correspond to the sequence of classical cumulants of X . Since
0,T
TppRdqq is a commutative algebra if (and only if) d “ 1, our previous expression for
expected signatures and signatures cumulants simplify dramatically, without becoming
trivial (as pointed out in several works [LRV23,AGR20,FGR22,FM21]). We can capture
multivariatemomentsandcumulants,byworkingwiththe“commutativeshadow”[AFS19]
of T which we now introduce.
5.1. The symmetric algebra. The symmetric algebra over Rd, denoted by SpRdq is the
quotient of TpRdq by the two-sided ideal I generated by txy´yx:x,y PRdu. A linear
basis of SpRdq is then given by teˆ u over non-decreasing words, v “ pi ,...,i q P Wx ,
v 1 n d
with 1ďi ď¨¨¨ďi ďd,ně0. Every xˆ PSpRdq can be written as finite sum,
1 n
ÿ
xˆ “ xˆveˆ ,
v
x
vPWd
and we have an immediate identification with polynomials in d commuting indeterminates.
The canonical projection
ÿ
π :TpRdq↠SpRdq, xÞÑ xweˆ , (5.1)
Sym wˆ
wPWdON EXPECTED SIGNATURES AND SIGNATURE CUMULANTS IN SEMIMARTINGALE MODELS 21
where wˆ PWˆ denotes the non-decreasing reordering of the letters of the word w PW ,
d d
is an algebra epimorphism, which extends to an epimorphism π : T ↠ S where
Sym
S “SppRdqq is the algebra completion, identifiable as formal series in d non-commuting
(resp. commuting) indeterminates. As a vector space, S can be identified with symmetric
formal tensor series. Denote by S and S the affine space given by those xˆ P S with
0 1
xˆH “0 and xˆH “1 respectively. The usual power series in S define eyxp: S ÑS with
0 1
x
inverse log: S ÑS and we have
1 0
π exppx`yq“eyxppxˆqeyxppyˆq, x,yPT
Sym 0
x x
π logpxyq“logpxˆq`logpyˆq, x,yPT .
Sym 1
We shall abuse notation in what follows and write ep¨q (resp. log), instead of eyxp (resp.
x
log).
All definition for tensor valued continuous (and càdlàg) semimartingales have a straight
forward extension to S-valued process. In particular, given X and Y in ScpSq, the inner
quadratic covariation is given by
ÿ
xX,Yy“ xXw1,Yw2yeˆ eˆ .
w1 w2
x
w1,w2PWd
x
WriteSN forthetruncatedsymmetricalgebra,linearlyspannedbyteˆ :w PW ,|w|ďNu
w d
and SN for those elements with zero scalar entry. In complete analogy with non-
0
commutative setting discussed above, we then write Hx q,N Ă ScpSNq for the corre-
0
sponding space of homogeneously q-integrable semimartingales.
Finally, also the definition of diamond products from Section 4.3 extends immediately
S-valued semimartingales. In particular, given Xˆ and Yˆ in ScpS q, we have
` ˘ ÿ
pXˆ ˛Yˆ q pTq–E xXˆ,Yˆ y “ pXˆw1 ˛Yˆw2q pTqeˆ eˆ PS,
t t t,T t w1 w2
x
w1,w2PWd
where the last expression is given in terms of diamond products of scalar semimartingales.
5.2. Moments and cumulants. We quickly discuss the development of a symmetric
algebra valued semimartingale, more precisely Xˆ PScpS q, in the group S . That is, we
0 1
consider
dSˆ “Sˆ ˝dXˆ. (5.2)
It is immediate (validity of chain rule) that the unique solution to this equation, at time
těs, started at Sˆ “ˆsPS is given by
s 1
Sˆ –eXˆ t´Xˆ sˆsPS
t 1
and we also write Sˆ s,t “ eXˆ t´Xˆ s for this solution started at time s from 1 P S 1. The
relation to signatures is as follows.
Proposition 5.1. Let X and Y be T-valued semimartingales and define Xˆ :“π pXq
Sym
and Yˆ :“π pYq. Then for all 0ďsďtďT it holds almost surely
Sym
ż ż
t t
π XdY“ Xˆ dYˆ, (5.3)
Sym
s s
and
π SigpXq “Sˆ “eXˆ t´Xˆ s.
Sym s,t s,t
Proof. (i) That the projections Xˆ,Yˆ define S-valued semimartingales follows from the
componentwisedefinitionandthefactthatthecanonicalprojectionislinear. Inparticular,
the right-hand side of eq. (5.3) is well defined. To show eq. (5.3) we apply the canonical
projection π to both sides of eq. (2.6) after choosing Z ” 1, and using the explicit
Sym t
action of π on basis tensors we obtain the identity
Sym ˜ ¸
ż ż ż
ÿ ÿ
π XdY“ XudYv eˆ “ Xˆ dYˆ.
Sym wˆ
wPWd uv“w
by eq. (5.1). Part (ii) is then immediate. □22 P.FRIZ,PAULP.HAGER,ANDN.TAPIA
Assuming componentwise integrability, we then define the conditional symmetric mo-
ments and cumulants of the S-valued semimartingale Xˆ by
´ ¯
µµµˆ pTq–E eXˆ T´Xˆ t PS ,
t t 1
κκκˆ pTq–logpµµµˆ pTqqPS ,
t t 0
for 0ďtďT. If Xˆ “π pXq for a T-valued semimartingale X, with expected signature
Sym
and signature cumulantsµµµpTq andκκκpTq, it is then clear that the symmetric moments and
cumulants of Xˆ are obtained by projection,
µµµˆpTq“π pµµµpTqq, κκκˆpTq“π pκκκpTqq.
Sym Sym
ř
Example 5.2. Let X be an Rd-valued martingale in H8´, and Xˆ – d Xieˆ. Then
t i“1 t i
ÿ8
1
µµµˆ pTq“ E rpX ´X qns
t n! t T t
n“0
ÿ8
1
ÿd “ ‰
“1` n! E t pX Ti1 ´X ti1q¨¨¨pX Tin ´X tinq eˆ i{ 1¨¨¨in,
n“1 i1,...,in“1
consistsofthe(time-tconditional)multivariatemomentsofX ´X PRd. Here,theseries
T t
on the right hand side is understood in the formal sense. It readily follows, also noted
in [BO20, Example 3.3], that κκκˆ pTq “ logpµµµˆ pTqq consists precisely of the multivariate
t t
cumulants of X ´X . Note that the symmetric moments and cumulants of the scaled
T t
process aX, a P R, is precisely given by δ µµµˆ and δ κκκˆ where the linear dilation map is
a a
definedbyδ : eˆ ÞÑa|w|eˆ . Thesituationissimilarfora¨X “pa X1,...,a Xdq, aPRd,
a w w 1 d
but now with δ : eˆ ÞÑaweˆ|w| with aw “an1¨¨¨and where n denotes the multiplicity of
a w 1 1 d i
the letter iPt1,...,du in the word w. ♢
We next consider linear combinations, Xˆ “ aX `bxXy, for general pairs a,b P R,
having already dealt with b“0. The special case b“´a2{2, by scaling there is no loss
in generality to take pa,bq “ p1,´1{2q, yields a (at least formally) familiar exponential
martingale identity.
Example 5.3. Let X be an Rd-valued martingale in H8´, and define
ÿd
1
ÿ
Xˆ – Xieˆ ´ xXi,Xjy eˆ .
t t i 2 t ij
i“1 1ďiďjďd
In this case we have trivial symmetric cumulants, κκκˆ pTq “ 0 for all 0 ď t ď T. Indeed,
t
Itô’s formula shows that tÞÑexppXˆ q is an S -valued martingale, so that
t 1
µµµˆ pTq“E reXˆ T´Xˆ ts“e´Xˆ tE reXˆ Ts“1.
t t t
♢
While the symmetric cumulants of the last example carries no information, it suffices
to work with
ÿd ÿ
Xˆ “ aiXieˆ ` b xXj,Xkyeˆ
i jk ij
i“1 1ďiďjďd
in which case µµµˆ “µµµˆpa,bq,κκκˆ “κκκˆpa,bq contains full information of the joint moments of
X and its quadratic variation process. A recursion of these was constructed as diamond
expansion in [FGR22].
5.3. Diamond relations for multivariate cumulants. We will demonstrate how a
symmetrizationofthefunctionalequationsfromSection3andtherecursionsfromSection4
lead to generalized view on the cumulant recursions from [AGR20,LRV23,FGR22]. As
before we will first divide the focus between the continuous case and the discrete setting.
Referring to [FHT22, Section 5.2] for a unification of both settings into a general càdlàg
form.ON EXPECTED SIGNATURES AND SIGNATURE CUMULANTS IN SEMIMARTINGALE MODELS 23
5.3.1. The continuous case. We assume that the usual assumptions from the continuous
setting in Section 3.1 on the filtration are in place. Then following Definition 4.6 the
diamond product of Xˆ ,Yˆ PScpS q is another continuous S -valued semimartingal e g iven
0 0
by
` ˘ ÿ
pXˆ ˛Yˆ q pTq“E xXˆ,Yˆ y “ pE xXˆw1,Yˆw2y qeˆ eˆ ,
t t t,T t t,T w1 w2
x
with summation over all w ,w PW , provided all brackets are integrable. This trivially
1 2 d
adapts to SN-valued semimartingales, N PN , in which case all words have length less
ě1
equal N, the summation is restricted accordingly to |w |`|w |ďN.
1 2
Theorem 5.4. Let Ξ“p0,Ξp1q,Ξp2q,...q be an F -measurable random variable with values
T
in S , componentwise in L8´. Then
0
` ˘
K pTq–logE eΞ
t t
satisfies the following functional equation, for all 0ďtďT,
1
K pTq“E Ξ` pK˛Kq pTq. (5.4)
t t 2 t
Furthermore, if N PN , and Ξ“pΞp1q,...,ΞpNqq is F -measurable with graded integra-
ě1 T
bility condition
}Ξpnq} ă8, n“1,...,N, (5.5)
LN{n
thentheidentity(5.4)holdsforthecumulantsuptolevelN,i.e. forKp0,Nq –logpE peΞp0,Nqq
t
with values in SN .
0
Remark 5.5. Identity (5.4) is reminiscent to the quadratic form of the generalized
Riccati equations for affine diffusions. The relation can be presented more explicitly
when the involved processes are assumed to have a Markov structure and the functional
signature cumulant equation reduces to a PDE system (see [FHT22, Section 6.2.2]).
The framework described here, however, requires neither Markov nor affine structure.
In[FHT22,Section6.3]itisexemplifiedforaffineVolterraprocessesthatsuchcomputations
are also possible in the fully non-commutative setting.
Proof. We first observe that since ΞPL8´, by Doob’s maximal inequality and the BDG
inequality, we have that Xˆ –E Ξ is a continuous martingale in H8´pS q. In particular,
t t 0
thanks to Theorem 2.5, the signature moments are well defined. According to Section 5.2,
the signature is then given by
SigpXˆ q “eΞ´E tΞ,
t,T
henceκκκˆ pTq“K pTq´Xˆ .
t t t
Projecting Equation (3.5) onto the symmetric algebra yields
" *
1 1
κκκˆ pTq“E Xˆ ` xXˆ y ` xκκκpTqy `xXˆ,κκκpTqy
t t t,T 2 t,T 2 t,T t,T
" *
1
“E Ξ` xKpTqy ´Xˆ ,
t 2 t,T t
and eq. (5.4) follows upon recalling that pK˛Kq pTq “ E xKpTqy . The proof of the
t t t,T
truncated ve rsion is left to the reader. □
As a corollary, we provide a general view on recent results of [AGR20,LRV23,FGR22].
Corollary 5.6. The conditional multivariate cumulants pK q of a random variable
t 0ďtďT
Ξ with values in S pRdq, componentwise in L8´ satisfy the recursion
0
1
ÿn ´ ¯
Kp1q “E pΞp1qq and Kpnq “E pΞpnqq` Kpkq˛Kpn´kq pTq for ně2, (5.6)
t t t t 2 t
k“1
The analogous statement holds true in the N-truncated setting, i.e. as recursion for
n“1,..,N under the condition (5.5).24 P.FRIZ,PAULP.HAGER,ANDN.TAPIA
Remark 5.7. In absence of higher order information, i.e., Ξp2q “Ξp3q “...”0, this type
of cumulant recursion appears in [LRV23]; and under optimal integrability conditions on
Ξp1q with finite Nth moments in [FGR22]. (The latter requires a localization argument
which is avoided here by directly working in the correct algebraic structure.)
5.3.2. The discrete case. Consider a probability space pΩ,G,Pq with discrete filtration
pG q and a G -measurable S -valued random variable Ξ. Assuming that Ξ is
j j“0,...,J T 0
componentwise in L8´, we are again interested in calculating pK q – plogEpeΞ|G qq.
j j
Instead of projecting the identities from the non-commutative setting in Section 3.2 to the
symmetric algebra, we present a direct derivation of the corresponding identities.
Using the multiplicative property of the exponential map in the symmetric algebra, the
martingale property of eK can be rewritten to
` ˇ ˘
0“E eK j`1´K j ´1ˇ G
j
.
A summation of the above identity paired with
Jÿ´1
K “Ξ´pK ´K q“Ξ´ pK ´K q
j J j i`1 i
i“j
and conditioning to G then yields the following.
j
Theorem 5.8. Given that the G -measurable S -valued random variable is componentwise
J 0
in L8´. It follows that pK q–plogEpeΞ|G qq satisfies for j “J,J ´1,...,0:
j j
ˆ ˇ ˙
Jÿ´1 ˇ
K
j
“EpΞ|G jq`E eK i`1´K i ´1´pK i`1´K iqˇ ˇG
j
. (5.7)
i“j
In particular, projecting to symmetric tensor levels we see that the conditional cumulants
of Ξ satisfy for all n“1,2,... and j “J,J ´1,...,1:
ˆ ˇ ˙
` ÿ ˇ
Kp jnq “E Ξpnq|G jq`E k1 !pK i`1´K iqpℓq ˇ ˇG
j
,
}ℓ}“n,|ℓ|“k
ThisisreallytheresultwegetfromprojectingtheTheorem3.4tothesymmetricalgebra
(upon using that the symmetric signature cumulants are giv en by κκκˆ “ K ´EpΞ|G q).
j j j
Nevertheless, due the ad hoc derivation presented here, it might seem surprising that the
resulting expansion leads to any non-trivial relations for conditional cumulants at all.
While on the first level one still trivially has pKp1qq“pEpΞp1q|G qq, on the second level
j j
we have
ˆ ˇ ˙
Kp j2q “EpΞp2q|G jq` 1 2E
Jÿ´1`
Kp j1 `q 1´Kp
j1q˘
2
ˇ
ˇ ˇG
j
i“j
which one recognizes, in case Ξp2q “ 0, as the energy identity for the discrete square-
integrable martingale pKp1qq “ pEpΞp1q|G qq. Going further in the recursion yields in-
j j
creasingly non-obvious relations. Taking Ξp2q “ Ξp3q “ ... ” 0 for notational simplicity
gives
ˆ ˇ ˙
Kp j3q “E
Jÿ´11
6pKp i`1q 1´Kp i1qq3`pKp i`1q 1´Kp i1qqpKp i`2q 1´Kp
i2q˘ˇ
ˇ ˇG
j
. (5.8)
i“j
It is interesting to note that inductively the identity for Kpnq can by expressed in terms of
variations (of variations) of the martingale Kp1q, which relates to the Bartlett identities
for martingales that have appeared in the statistics literature, cf. Mykland [Myk94] and
the references therein.
Remark 5.9. The second formula in Theorem 5.8, in terms of summation over partitions
ℓ, is sub-optimal in the sense that due to commutativity there are many repeated terms.
For example, the factor 1 in front of the second term in eq. (5.8) suggested by that formula
2
is actually just 1, since both compositions ℓ“p1,2q and ℓ“p2,1q give the same product.
In general one can take care of this algebraically by using (rescaled) Bell polynomials,
which in the context of conditional cumulants was realized in [FM21].ON EXPECTED SIGNATURES AND SIGNATURE CUMULANTS IN SEMIMARTINGALE MODELS 25
6. Applications
6.1. Brownian rough paths. Denote by GM ĂTM the free step-M nilpotent free Lie
1
group and recall that the space of weakly geometric rough paths consists of continuous
finite p-variation paths WΩc,p “ Cppr0,Ts;pGM,|||¨|||qq with M ď p ă M `1 and where
T
|||¨||| is a homogeneous norm on GM (see [FV10] for an introduction). In accordance
with [FS17,Che18] we call a random variabl e Y w ith values in WΩc,p a Brownian rough
path w ith d r ift if i t has stationary and independent increments Y
T
:“Y´1Y . For the
s,t s t
means of this section we denote the signature of Y, i.e., the full Lyons lift, by Yă8.
Here,wewillspecificallyconsiderthecasewhereM “2N andY“BistheStratonovich
development of Browniřan motion in the free step-N nilpotent Lie algebra gN “logGN.
Moreprecisely,letB“ Biu ,wheretu u isaorthonormalsystemingN ĂTN and
iPI i i iPI 0
pBiq isa|I|-dimensionalBrownianmotionwithpossiblymutuallycorrelatedcoefficients.
iPI
Define the correlation matrix of B by
ÿ
Σ:“ EpBiBjqu u PSympgN bgNqĂT2N.
1 1 i j 0
i,jPI
The truncated Stratonovich development B:“π SigpBq takes values in the group
p0,2Nq 0,¨
G2N and following standard arguments from [FH20, Section 3.2] we see that the samples
of B are (weakly) geometric rough path for any pPp2N,2N `1q. Clearly, this is still the
case after adding a drift B⇝Bpyq:“pB`tyq for any constant vector yPg2N. The
tě0
resulting development Bpyq is a Brownian rough-path with drift, as independence and
stationarity of the increments follow directly from the definition. Its signature is given by
the full development Bpyqă8 “SigpBpyqq .
0,¨
Theorem 3.1 implies the following generalization of Fawcett’s formula.
Corollary 6.1. The expected signature of a Brownian rough path Bpyq with correlation Σ
and drift y is given by ˆ ˙
` ˘
T
E Bpyqă8 “exp Ty` Σ .
T 2
Remark 6.2. The above suggest to definře a “standard” Brownian rough path by requiring
additionally that logEpY q“ 1pt´sq pu q2 and that tu u spans gN. However, this
s,t 2 iPI i i
is only a appropriate definition as far as it is appropriate to call the Stratonovich lift the
“standard” lift of a Brownian motion.
Proof. From the definition we then have Bpyq:“π SigpBpyqq where B is Brownian
p0,2Nq 0,¨
motion in gN. For any w PW and q ě1 we have
d
› › ÿ › › ? ˇ ˇ ÿ ˇ ˇ1{2
}Bpyqw}Hq “›x Biuw
i
y1 T{2 `T|yw|› “ Tˇ Σijuw
i
uw
j
ˇ `T|yw|ă8.
Lq
i i,jPI
Hence, Bpyq P H8´ and thus Theorem 3.1 and Corollary 4.1 apply to the conditional
expected signatureµµµ :“E pSigpBpyqq q . D ue to martingal ity of B we have
t t t,T
´ ¯
µµµp1q “E Bp1q `pT ´tqyp1q “pT ´tqyp1q
t t,T
Further, due to the deterministic quadratic variation xBy “tΣ one sees inductively by
t
followingtherecursioninCorollary4.1thatµµµpnq isdeterministicandhencebyTheorem3.1
satisfies
ż ´ ¯
T 1
µµµ “1` y` Σ µµµ du.
t 2 u
t
We readily conclude by noting that the unique solutions to the above ordinary differential
equation in T
1
is given byµµµ
t
“epT´tqpy`1 2Σq. □
Wementiontwoimportantexamples: Firstly,thezeromasslimitofaphysicalBrownian
motion in a magnetic field ([FGL15],[FHT22,Section3.4],[LNZ23]),whichisaBrownian
rough path with N “1 and d rift y“ p 0,0,Aq where APsop RdbR dq is an antisymmetirc
matrix that depends on the physical environment. In line with [LNZ23] the above result
immediatelygivesthattheexpectedsignatureofthesmallmasslim itisg ivenbyeTpA`1 2Σq.26 P.FRIZ,PAULP.HAGER,ANDN.TAPIA
As a second example we mention the recent finding by M. Hairer that the H Ñ 1 limit
4
of a suitably rescaled fractional Brownian motion converges to a pure area rough path
with coefficients given by standard Brownian motiořn. This limit is naturally included
in our framework as a Brownian rough path of B“ u Bi where the corresponding
iPI i
orthonormal system of g2 is given by tu :iPIu“tre ,e s:1ďiăj ďdu. Corollary 6.1
i i j
yields the corresponding generalization of Fawcett’s formula. We note that it might be of
interest to obtain this formula as the rescaled limits for H Ñ 1 in [CF24].
4
6.2. Time-inhomogeneous Lévy processes. Extending the example from the previous
section in two directions we now consider a class of time-inhomogeneous Lévy processes
in the step-N nilpotent free Lie algebra, with differential characteristics pb,Σ,Kq where
b P L1pr0,Ts;gNq, Σ P L1pr0,Ts;SympgN bgNqq and K “ pK q is a family of Lévy
t tě0
measures, i.e.,
ż ż
T
p|x|2^1qK pdxqdtă8.
t
0 gN
Atime-inhomogeneousLévyprocessXwithtripletpb,Σ,KqisagN-valuedsemimartingale
X “ Ac `Aδ `ş Mc `Mδ consisting of a (deterministic) continuous boundedşvariation
process Ac “ ¨ bpuqdu, a continuous Gaussian martingale Mc with xMcy “ ¨ Σpuqdu,
0 0
a piecewise constant process Aδ with |∆Aδ| ą 1 and a square integrable pure jump
martingale4 Mδ with |∆Mδ|ď1, satisfying for 0ďsďtďT:
ˆ ˙ ż ż
ÿ t
E fp∆Aδ `∆Mδq “ fpxqK pdxqdu, (6.1)
s u u u
săuďt s gN
for any measurable function f :gN ÑR with |fpxq|ď|x|2^1 for all xPgN. Note that
such X have independent increments in pgN,`q and are continuous in probability.
Remark6.3. WeleaveitasaremarkherethatthetruncatedMarcusliftX“π SigpXq
p0,2Nq
is time-inhomogeneous Lévy rough path in the sense of [FS17,Che18]. In particular, the
group increments X “X´1X are independent and the samp le paths are càdlàg (weakly)
s,t s t
geometric rough paths in the sense of [FS17,FZ18].
Given that K additionally satisfies the moment condition
ż ż
T
|x|q1 K pdxqdtă8, q ě1, (6.2)
|x|ą1 t
0 gN
it holds that X P H8´. Indeed, this was proven in [FHT22, Corollary 6.5] for the
Rd-valued case and directly extends to the gN-valued ca se. Ap plying the results from
Section 3 then leads to the following
Proposition 6.4. Let X be a gN-valued time-inhomogeneous Lévy process with triplet
pb,Σ,Kq satisfying the moment condition (6.2). Then the conditional expected signature
µµµ“pE pSigpXq q is the solution of t he backwards differential equation
t t,T 0ďtďT
ż
T
µµµ “1` ypuqµµµ du, (6.3)
t u
t
for all 0ďtďT, where
ż
1
yptq:“bptq` Σptq` pexppxq´1´x1 qK pdxqPT . (6.4)
2 |x|ď1 t 0
gN
Moreover, the conditional signature cumulants κκκ“logpµµµq are the solution of
ż
T
κκκ “ Hpadκκκ qpypuqqdu, 0ďtďT.
t u
t
4InthesenseofbeingL2-orthogonaltoallcontinuousmartingales;see[JS03,SectionI.4].ON EXPECTED SIGNATURES AND SIGNATURE CUMULANTS IN SEMIMARTINGALE MODELS 27
Proof. From (3.8) we have for tPr0,Ts that
"ż T ´ 1 ¯ ÿ ` ˘ *
µµµ “1`E bpuq` Σpuq µµµ du`rX,µµµs ` e∆X u´1´∆Mδ µµµ .
t t 2 u´ t,T u u´
t uPpt,Ts
We then conclude inductively over tensor levels n P N that µµµpnq is deterministic and
continuous. Indeed, assume that µµµp0,nq is deterministic and continuous. Then for all
k “0,...,n`1 and tPr0,Ts we have rXpkq,µµµpn`1´kqs “0,
t,T
"ż ´ ¯ * ż ´ ¯
T 1 T 1
E π bpuq` Σpuq µµµpn`1´kqdu “ π bpuq` Σpuq µµµpn`1´kqdu
t k 2 u´ k 2 u´
t t
and using the property (6.1), which extents to time depended functions by a monotone
class argument and from bounded functions to functions of polynomial growth by the
integrability assumption (6.2), we also have
" *
ÿ ` ˘
E π e∆X u ´1´∆Mδ µµµpn`1´kq
t k u u´
uPpt,Ts
ż ż
T
“ π pex´1´x1 qµµµpn`1´kqdKpdxqdu.
k |x|ď1 u´
t gN
Hence, projecting the identity from the beginning of the proof to tensor level n`1 we see
thatµµµpn`1q isalsodeterministicandcontinuous. Moreover, usingtheabovesimplifications
this identity precisely turns into (6.3).
While the statement about the signature cumulants can be deduced directly from a
càdlàg version of Theorem 3.3, which we have not presented in this chapter but can be
found in [FHT22, Theorem 4.1], it is instructive to see that it also follows from applying
Theorem 3.3 to µµµ, which by the first part of the propositişon is the development of the
continuous de terministic T -valued finite variation process ¨ ypuqdu, i.e.,
0 0
` ˘ ´ż ¨ ¯
E SigpXq “Sig ypuqdu .
t t,T
0 t,T
□
We conclude this section with an important consequence that concerns the convergence
radius of the expected signature, which for a general tensor series xPT is defined as the
maximal r Pr0,8q such that
ÿ8
λn|xpnq|ă8, for all λPp0,rq. (6.5)
n“0
In [CL16] it was proven that if the expected signature has infinite convergence radius it
characterizes the law of the signature, hence, the law of the underlying process when the
signatureitselfischaracterizing. Thus,renderingthequestionofinfiniteconvergenceradius
a central but in general difficult question. For Brownian motion it is a consequence of
Fawcett’s formula [Faw02], for Lévy-process a consequence of the signature Lévy-Khinchin
formula in [FS17]. Apart from that there is a negative answer in [BDMN21,LN22] for
the case of Brownian motion stopped at the exit of a domain. The following results gives
necessary condition for time-inhomogeneous gN-valued Lévy processes.
Corollary 6.5. Let X,µµµ and y be as in Proposition 6.4. Then for any N PN and λą0
it holds for all 0ďtďT:
˜ ¸
ż
ÿN ÿN T
λn|µµµpnq|ďexp λn |ypnqpsq|ds .
t
n“0 n“1 t
ş
In particular, µµµ has infinite convergence radius if T |ypuq|du has.
0 028 P.FRIZ,PAULP.HAGER,ANDN.TAPIA
Proof. Projecting (6.3) to tensor level nPN and using the compatibility of the norm on
pRdqbn we have for an y λą0 and all tPr0,Ts:
ż
ÿn T
λn|µµµpnq| ď λk|µµµpkq|λn´k|ypn´kqpsq|ds
t s
k“0 t
Summation of the above inequality yields for all tPr0,Ts:
ż
ÿN ÿN ÿn T
λn|µµµpnq| ď 1` λk|µµµpkq|λn´k|ypn´kqpsq|ds
t s
n“0 n“0˜k“0 t ¸˜ ¸
ż
T ÿN ÿN
ď 1` λn|µµµpnq| λn|ypnqpsq| ds.
s
t n“0 n“0
The stated estimate then follows from Gronwall’s lemma and the second claim by talking
taking limits for N Ñ8. □ON EXPECTED SIGNATURES AND SIGNATURE CUMULANTS IN SEMIMARTINGALE MODELS 29
References
[AFS19] C.Améndola,P.Friz,andB.Sturmfels,Varietiesofsignaturetensors,ForumofMathematics,
Sigma7(2019).
[AGR20] E. Alos, J. Gatheral, and R. Radoičić, Exponentiation of conditional expectations under
stochastic volatility,QuantitativeFinance;SSRN(2017)20(2020),no.1,13–27.
[AJLP19] E.AbiJaber,M.Larsson,andS.Pulido,Affine volterra processes,Ann.Appl.Probab.29
(2019),no.5,3155–3200.
[App09] D.Applebaum,Lévy processes and stochastic calculus,Cambridgeuniversitypress,2009.
[ASJ14] Y.Aït-SahaliaandJ.Jacod, High-frequency financial econometrics, PrincetonUniversity
Press,2014.
[ASS20] I. P. Arribas, C. Salvi, and L. Szpruch, Sig-sdes model for quantitative finance, 2020,
arXiv:2006.00218 [q-fin.CP],1stACMInternationalConferenceonAIinFinance(ICAIF
2020).
[BCOR09] S.Blanes,F.Casas,J.Oteo,andJ.Ros,Themagnusexpansionandsomeofitsapplications,
Phys.Rep.470(2009),no.5-6,151–238.
[BDMN21] H.Boedihardjo,J.Diehl,M.Mezzarobba,andH.Ni,The expected signature of Brownian
motionstoppedontheboundaryofacirclehasfiniteradiusofconvergence,Bull.Lond.Math.
Soc.53(2021),no.1,285–299.
[BFH09] E. Breuillard, P. Friz, and M. Huesmann, From random walks to rough paths, Proc. Am.
Math.Soc.137(2009),no.10,3487–3496.
[BFPP22] C.Bellingeri,P.K.Friz,S.Paycha,andR.Preiß,Smooth rough paths, their geometry and
algebraic renormalization,VietnamJournalofMathematics50(2022),no.3,719–761.
[BGLY16] H.Boedihardjo,X.Geng,T.Lyons,andD.Yang,Thesignatureofaroughpath: Uniqueness,
AdvancesinMathematics293(2016),720–737.
[BLO23] P.Bonnier,C.Liu,andH.Oberhauser,Adapted topologies and higher rank signatures,Ann.
Appl.Probab.33(2023),no.3,2136–2175.
[BO20] P.BonnierandH.Oberhauser,Signature cumulants, ordered partitions, and independence
of stochastic processes,Bernoulli26(2020),no.4,2727–2757.
[CF24] T. Cass and E. Ferrucci, On the wiener chaos expansion of the signature of a gaussian
process,Probab.TheoryRelat.Fields189(2024),909–947.
[CFMT11] C. Cuchiero, D. Filipović, E. Mayerhofer, and J. Teichmann, Affine processes on positive
semidefinite matrices,TheAnnalsofAppliedProbability21(2011),no.2,397–463.
[Che18] I.Chevyrev,Random walks and Lévy processes as rough paths,Probab.TheoryRelat.Fields
170(2018),no.3-4,891–932.
[CL16] I.ChevyrevandT.Lyons,Characteristic functions of measures on geometric rough paths,
Ann.Probab.44(2016),no.6,4049–4082.
[CM09] F.CasasandA.Murua,Anefficientalgorithm forcomputing theBaker-Campbell-Hausdorff
series and some of its applications,J.Math.Phys.50(2009),no.3,033513,23.
[CST23] C. Cuchiero, S. Svaluto-Ferro, and J. Teichmann, Signature SDEs from an affine and
polynomial perspective,arXive-prints(2023),arXiv:2302.01362.
[DFS`03] D.Duffie,D.Filipović,W .Schachermayer,et al.,Affineprocessesandapplicationsinfinance,
Ann.Appl.Probab.13(2003),no.3,984–1053.
[Est92] A. Estrade, Exponentielle stochastique et intégrale multiplicative discontinues, Ann. Inst.
HenriPoincaréProbab.Stat.28(1992),no.1,107–129.
[Faw02] T. Fawcett, Problems in stochastic analysis : connections between rough paths and non-
commutative harmonic analysis,Ph.D.thesis,UniversityofOxford,2002.
[FGL15] P.Friz,P.Gassiat,andT.Lyons,Physical Brownian motion in a magnetic field as a rough
path,Trans.Am.Math.Soc.367(2015),no.11,7939–7955.
[FGR22] P.K.Friz,J.Gatheral,andR.Radoičić,Forests, cumulants, martingales,Ann.Probab.50
(2022),no.4,1418–1445.
[FH20] P.K.FrizandM.Hairer,Acourseonroughpaths,2nded.,Universitext,SpringerInternational
Publishing,2020.
[FHT22] P.K.Friz,P.P.Hager,andN.Tapia,Unified signature cumulants and generalized magnus
expansions,ForumofMathematics,Sigma10(2022),e42.
[FLS24] P.K.Friz,T.Lyons,andA.Seigal,Rectifiablepathswithpolynomiallog-signaturearestraight
lines,BulletinoftheLondonMathematicalSociety(2024).
[FM21] M.FukasawaandK.Matsushita,Realized cumulants for martingales,Electron.Commun.
Probab.26(2021),10,Id/No12.
[FS17] P.K.FrizandA.Shekhar,Generalroughintegration,LévyroughpathsandaLévy–Kintchine-
type formula,Ann.Probab.45(2017),no.4,2707–2765.
[FV06] P.K.FrizandN.B.Victoir,Theburkholder-davis-gundyinequalityforenhancedmartingales,
LectureNotesinMathematics1934(2006).
[FV10] , Multidimensional stochastic processes as rough paths: Theory and applications,
CambridgeStudiesinAdvancedMathematics,CambridgeUniversityPress,2010.
[FZ18] P.K.FrizandH.Zhang,Differential equations driven by rough paths with jumps,J.Differ.
Equations264(2018),no.10,6226–6301.30 P.FRIZ,PAULP.HAGER,ANDN.TAPIA
[GKR19] J.GatheralandM.Keller-Ressel,Affine forward variance models,FinanceStoch.23(2019),
no.3,501–533.
[Hau06] F. Hausdorff, Die symbolische Exponentialformel in der Gruppentheorie, Ber. Verh. Kgl.
Sächs.Ges.Wiss.Leipzig.,Math.-phys.Kl.58(1906),19–48.
[HDL86] M.Hakim-DowekandD.Lépingle,L’exponentiellestochastiquedesgroupesdeLie,Séminaire
deProbabilitésXX1984/85,Springer,1986,pp.352–374.
[IMKNZ05] A.Iserles,H.Munthe-Kaas,S.Nørsett,andA.Zanna,Lie-group methods,Actanumerica
(2005).
[IN99] A. Iserles and S. P. Nørsett, On the solution of linear differential equations in lie groups,
Philos.Trans.Roy.Soc.A357(1999),no.1754,983–1019.
[JS03] J. Jacod and A. N. Shiryaev, Limit theorems for stochastic processes., Grundlehren der
MathematischenWissenschaften[FundamentalPrinciplesofMathematicalSciences],no.488,
SpringerBerlin,2003.
[KPP95] T. G. Kurtz, E. Pardoux, and P. Protter, Stratonovich stochastic differential equations
driven by general semimartingales,Ann.Inst.HenriPoincaréProbab.Stat.31(1995),no.2,
351–377.
[KPP21] K. Kamm, S. Pagliarani, and A. Pascucci, On the stochastic Magnus expansion and its
application to SPDEs,J.Sci.Comput.89(2021),no.3,31,Id/No56.
[KRST11] M.Keller-Ressel,W.Schachermayer,andJ.Teichmann,Affineprocessesareregular,Probab.
TheoryRelatedFields151(2011),no.3-4,591–611.
[LG16] J.-F.LeGall,Brownian motion, martingales, and stochastic calculus,Springer,2016.
[LN22] S. Li and H. Ni, Expected signature of stopped Brownian motion on d-dimensional C2,α-
domains has finite radius of convergence everywhere: 2ďdď8,J.Funct.Anal.282(2022),
no.12,45,Id/No109447.
[LNZ23] S. Li, H. Ni, and Q. Zhu, Small mass limit of expected signature for physical Brownian
motion,arXive-prints(2023),arXiv:2305.00343.
[LQ11] Y.LeJanandZ.Qian,Stratonovich’s signatures of brownian motion determine brownian
sample paths,ProbabilityTheoryandRelatedFields157(2011).
[LRV23] H.Lacoin,R.Rhodes,andV.Vargas,A probabilistic approach of ultraviolet renormalization
in the boundary sine-Gordon model,Probab.TheoryRelat.Fields185(2023),no.1-2,1–40.
[LV04] T. Lyons and N. Victoir, Cubature on wiener space, Proceedings of the Royal Society of
London.SeriesA:Mathematical,PhysicalandEngineeringSciences460(2004),no.2041,
169–198.
[Lyo14] T.Lyons,Rough paths, signatures and the modelling of functions on streams,Proceedingsof
theInternationalCongressofMathematicians—Seoul2014.Vol.IV,KyungMoonSa,Seoul,
2014,pp.163–184.
[Mag54] W. Magnus, On the exponential solution of differential equations for a linear operator,
Commun.PureAppl.Math.7(1954),no.4,649–673.
[Mar78] S. I. Marcus, Modeling and analysis of stochastic differential equations driven by point
processes,IEEETrans.Inform.Theory24(1978),no.2,164–172.
[Mar81] , Modeling and approximation of stochastic differential equations driven by semi-
martingales,Stochastics4(1981),no.3,223–245.
[McK69] H. P. McKean, Stochastic integrals, AMS Chelsea Publishing Series, no. 353, American
MathematicalSociety,1969.
[Mil72] W. Miller, Jr., Symmetry groups and their applications, Pure and Applied Mathematics,
vol.50,AcademicPress,NewYork-London,1972.
[Myk94] P.A.Mykland,Bartlett type identities for martingales,Ann.Statist.22(1994),no.1,21–38.
[Pro05] P.E.Protter,Stochastic integration and differential equations,2ed.,StochasticModelling
andAppliedProbability,Springer-VerlagBerlinHeidelberg,2005.
[Reu03] C.Reutenauer,Free lie algebras,Handbookofalgebra,vol.3,Elsevier,2003,pp.887–903.
[RY04] D. Revuz and M. Yor, Continuous martingales and brownian motion, Grundlehren der
mathematischenWissenschaften,SpringerBerlinHeidelberg,2004.
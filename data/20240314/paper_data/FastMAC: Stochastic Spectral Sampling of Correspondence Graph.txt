FastMAC: Stochastic Spectral Sampling of Correspondence Graph
YifeiZhang2,1,HaoZhao2,†HongyangLi3,SihengChen4,3
1UniversityofChineseAcademyofSciences,2AIR,TsinghuaUniversity,
3ShanghaiAILaboratory,4ShanghaiJiaoTongUniversity
zhangyifei21a@mails.ucas.ac.cn, zhaohao@air.tsinghua.edu.cn
80×faster
S
10×faster
+40%
real time
35 ms
Figure1. LEFT:FastMACcanaccelerateMAC[71]by80times,whilepreservingsimilarlyhighregistrationsuccessrate(denotedby
registrationrecall).Thisisachievedbysampling5%nodesonthecorrespondencegraph,throughastochasticspectralformulation.Other
samplingratiosarealsoshown,andFastMACachievesreal-timewhentheratioislowerthan20%.MIDDLE:Timeprofilingcomparison
between vanilla MAC and FastMAC with different sampling ratios. FastMAC significantly accelerates all stages of MAC. RIGHT: A
detailedruntimebreakdownforeachcomponentinMACandFastMAC.Maximalcliquesearchisnolongerabottleneck.
Abstract tionsuccessrateonKITTI.Codesarepubliclyavailableat
https://github.com/Forrest-110/FastMAC.
3D correspondence, i.e., a pair of 3D points, is a fun-
damental concept in computer vision. A set of 3D corre-
1.Introduction
spondences,whenequippedwithcompatibilityedges,forms
a correspondence graph. This graph is a critical com-
Correspondence is one of the most fundamental computer
ponent in several state-of-the-art 3D point cloud registra-
visionconcepts,sinceitencodesimportantgeometricrela-
tion approaches, e.g., the one based on maximal cliques
tionshipssuchasmulti-viewtransformation(2D-2D[37]or
(MAC). However, its properties have not been well under-
3D-3D[59][75][74]correspondence)orsingle-viewprojec-
stood. So we present the first study that introduces graph
tion(2D-3Dcorrespondence[56][64]).3Dcorrespondence,
signalprocessingintothedomainofcorrespondencegraph.
whichisbydefinitionapairofmatched3Dpoints,playsan
Weexploitthegeneralizeddegreesignaloncorrespondence
important role in 3D registration [72] and downstream ap-
graph and pursue sampling strategies that preserve high-
plications like SLAM [8], 3D reconstruction [20][35] and
frequency components of this signal. To address time-
3Dsceneunderstanding [12][25][24][60]. Whilethe com-
consuming singular value decomposition in deterministic
munityhasstudied3Dcorrespondenceforalongtime,3D
sampling, we resort to a stochastic approximate sampling
correspondencegraphisnotyetwell-understood.
strategy. As such, the core of our method is the stochastic
In this graph, each vertex is a 3D correspondence, and
spectralsamplingofcorrespondencegraph. Asanapplica-
the edge connectivity is usually defined according to the
tion,webuildacomplete3Dregistrationalgorithmtermed
compatibilitybetweentwocorrespondences. Forexample,
asFastMAC,thatreachesreal-timespeedwhileleadingto
ifacertaincompatibilitymetricishigherthanathreshold,
little to none performance drop. Through extensive exper-
anedgeisactivebetweentwocorrespondences. Thisgraph
iments, we validate that FastMAC works for both indoor
is indeed a critical component in state-of-the-art 3D reg-
and outdoor benchmarks. For example, FastMAC can ac-
istration methods like MAC [71]. MAC, as our baseline,
celerateMACby80timeswhilemaintaininghighregistra-
searches for maximal cliques on this graph and estimates
†Correspondingauthor. relativeposesusingcompatiblecorrespondences.
4202
raM
31
]VC.sc[
1v07780.3042:viXra
42.6%556ms
10.2%133ms
M AC
45.9%600ms
0%1.38%18ms
0.54ms2.87% 14.7%0.49ms2.61%
2.7ms0.0957%0.02ms
79.8%15ms
amplingSGraph ConstructionMaximal
Clique SearchNode-guided
Clique Selection
FastM AC@Pose Estimation 5However, MAC can be quite slow with numerous input Stochastic Techniques. To address the complex-
correspondences, with a single registration can cost more ity of solving the NP-hard Maximum Consensus prob-
than one second, as shown in Figure. 1. This makes it far lem, stochastic techniques have been proposed and Ran-
fromdeploymentforreal-timeapplicationssuchasSLAM. dom Sample Consensus (RANSAC) is a well-known one
A natural idea is to downsample this graph for efficiency. among them. Numerous extensions and enhancements to
Weintroducetheframeworkofgraphsignalprocessing[10] RANSAC have been devised, aiming to improve its effi-
to achieve this goal. Specifically, we use the generalized ciency [61][19], accuracy [62], and robustness [32][58].
degree, i.e., the weighted edge sum, of each node in the However, it is still essential to recognize that the conver-
graph as the graph signal and preserves its high frequency gence speed of RANSAC exhibits an exponential relation-
componentwithagraphfilter,whichistheLaplacianmatrix shipwiththerateofoutliersinthedataset[7].
in our work. We derive an optimal sampling strategy that Branch-and-Bound. The Branch-and-Bound (BnB)
bestpreservesthefilteredhigh-frequencysignalofinterest. [4][43][73]algorithmstandsasafundamentaltechniquein
High-frequency. The principleis that weneed to sam- optimization and search problems, for registration. It can
ple nodes with fast change of generalized degree over the explore and assess all solution possibilities systematically
correspondence graph (short as high-frequency nodes for and intelligently remove less promising ones, ensuring an
brevity), since they are better suited for maximal clique optimalsolution. Still,itisimportanttonotethatBnBex-
search. The intuition is three-fold: (1) Every maximal hibits an exponential complexity concerning the problem
cliquemustcontainonehigh-frequencynode;(2)Maximal sizeandthepresenceofoutlierswithinthedataset[7].
cliquestendtocontainthreeormorehigh-frequencynodes; MixedIntegerProgram. BnBhasbeenextendedwith
(3)Cut-points,whicharealwayshigh-frequencynodes,are Mixed-Integer Programming (MIP) [34] to speed up com-
containedinmorethanonemaximalclique. putation. ButMIPitselfalsodemonstratesthattheincorpo-
Stochastic Sampling. There exist well-established de- rationofLinear-Matrix-InequalityConstraintssignificantly
terministicsamplingmethodstorecoveracertainsignalof expedites computational processes [57]. Several avenues
interestonagraph[10]. Buttheyinvolveiterativesingular of exploration has been done including TEASER++ [66],
valuedecompositionoperationswhicharetime-consuming Fast-Global-Registration(FGR)[76]andotherworks[65].
thus contradict the goal of accelerating MAC. As such, Nevertheless, it is noteworthy that the computational time
wederiveastochasticapproximatedsamplingstrategythat stillexhibitssensitivitytoboththeoutlierrateandproblem
takesconstanttimew.r.t. samplenumber. size,underscoringtheneedforfurtherimprovements.
Tosummarize,wemakethesecontributions: (1)Forthe SimultaneousPoseandCorrespondence(SPC)meth-
firsttime, weintroducegraphsignalprocessingto3Dcor- ods represent another prominent paradigm within the field
respondence graph. (2) We propose a stochastic sampling ofpointcloudregistration,withthepioneeringworkofthe
strategy that selects high-frequency nodes on a correspon- IterativeClosestPoint(ICP)algorithmasacornerstone[5].
dence graph. (3) We develop a full registration pipeline Over time, several robust extensions of the ICP method
FastMAC upon the proposed sampling method, which is have been introduced [27][31][14][39][54]. SPC methods
suited for maximal clique search. (4) FastMAC achieves are often lauded for their swiftness and precision, yet they
trivial performance drop on indoor and outdoor datasets, doexhibitanotablevulnerabilitytolocalminima,alimita-
whileachieving80timesaccelerationtoareal-timelevel. tionthathasbeenacknowledged[47]. ThoughglobalSPC
methodslikeGo-ICP[67]havebeenproposed,itisimpor-
2.RelatedWorks tanttonotethatmanyglobalmethodsintheSPCparadigm
stillrelyonBranch-and-Bound(BnB)techniques[28][6].
3Dpointcloudregistrationisimportanttomanyreal-world
ConsistencyGraph-basedMethods. Recently,several
problems,includingposeestimation[42],SLAM[47],and
approaches based on consistency graph are proposed for
3D reconstruction [21]. However, globally optimal 3D
pointcloudregistration, emphasizingtheencodingofcon-
point cloud registration is very challenging and existing
sistency among pairs of correspondences through the uti-
workscanbesummarizedintosixprimarycategories:
lization of invariants [22][40][33][68] structured within a
MaximumConsensus(MC)isawidelyusedrobustop-
graphframework. Researchershavesoughttoenhancethe
timizationobjectiveinpointcloudregistration[41]. Com-
efficiencyofthesearchforthesemaximumcliquesthrough
pared with other robust optimization objectives such as
the introduction of more efficient search algorithms [46]
Truncated-Least-Squares (TLS), MC has its advantage of
and various relaxations to the maximum clique problem
being superior under certain circumstances[15]. However,
[38][55]. Previous research [50] has explored sampling of
MCmayproduceanerror-proneestimatedependingonthe
correspondences,butweaddresstheproblemfromtheper-
inputconditions[9]. Moreover,directlysolvingMaximum
spectiveofgraphsignalprocessingforthefirsttime.
Consensus entails an NP-hard computational complexity,
whichhasbeenconfirmedbypriorresearch[16].OutputCorrespondences InputCorrespondences
c1
Approximate
Optimal Inlier
c2
Sample c3 Outlier
Response Operator
Magnitude Compute … c4
Pair-wise cn
Compatibility
Normalize
to a Distribution
Node Index Stochastic Graph
Sampling Construction
x:Response To the
High-pass Filter
Correspondence
AdjacencyMatrix Graph
Filter
Graph Filtering Construction
Compute
Generalized
Degree Signal
w2
High-frequency w1
Node dB dB w3
w4
Ω Ω
Response To the High-pass Filter GeneralizedDegree Signal
Laplacian High-pass Filter
Figure2. PipelineofFastMAC.Inthetop-rightpanel,weshowthetheprocedureofconstructingacorrespondencegraphfrominput
correspondences. Thegraphismathematicallyrepresentedbyanadjacencymatrix. Highvaluesinthismatrixmeanhighcompatibility
betweentwocorrespondences. Inthebottompanel,wedefinegeneralizeddegreesignalonthegraphastheaggregationofcompatibility
scoresonedgesconnectingwithanode. WepassthesignalthroughaLaplacianhigh-passgraphfilter(constructedfromtheadjacency
matrix)togetitshigh-frequencycomponent.Asmentionedinthetext,afterfiltering,nodeswithhighresponsearenamedashigh-frequency
nodes. Inthetop-leftpanel,wederiveastochasticsamplingstrategyinwhichthesamplingprobabilityofanodeisproportionaltothe
responsemagnitude.Thissamplingstrategyisafastapproximationoftheoptimal(butslow)deterministicsamplingstrategythatrecovers
asignalofinterest.Lastlybutnotshowninthisfigure,weusetheMACregistrationalgorithmonoutputcorrespondences.
3.Methods graph size without sacrificing the maximal clique registra-
tion performance. Our sampling module is shown in the
Ourgoalisfastandaccurate3Dpointcloudregistrationand bottom and top-left panels of Fig. 2. It is inserted into
our method is based upon the recently published maximal thefirstandsecondstepofMAC,whichmeanstheoutput
clique(MAC)method[71].Ithasfourstepsasshowninthe correspondencesareinputintotheremainingthreestepsof
timeprofilingofFig.1andTable.1. (1)GraphConstruc- MAC.ThatisthedifferencebetweenMACandFastMAC.
tion,whichbuildsacorrespondencegraphontheinputcor- How to achieve this graph down sampling? There are
respondences. Weinheritthisstepasshowninthetop-right widely used modules like random sampling and farthest
panel of Fig. 2. (2) Maximal Clique Search, which finds pointsampling[48]. ButasshownlaterinFig.4,Fig.5and
all maximal cliques in the graph as the name implies. (3) Fig.6,theyperformpoorforMACacceleration. Sowere-
Node-guidedCliqueSelection,whichreducesthenumber sorttothegraphsignalprocessingtheory[52][53][10][11].
of maxmimal clique candidates and finally (4) Pose Esti- Duetopagelimit,itsbasicsarepresentedinAppendixA.1.
mation,whichevaluatesposehypothesisgeneratedineach
First, asshowninthetop-rightpanelofFig.2, wecon-
cliqueandchoosesthebestoneastheoutputpose. structacorrespondencegraphG andtheadjacencyma-
corr
The key intuition behind MAC is to loosen the previ- trix W SOG, in which SOG means second order graph, fol-
ous maximum clique constraint [36], and use more maxi- lowing MAC [71]. Due to page limit, the details are pre-
malcliquecandidatestogeneratepotentiallyaccuratepose sented in Appendix A.4. It is noteworthy that the value in
hypotheses. However it is very slow when there are many W SOGmeanscompatibilitybetweentwocorrespondences.
input correspondences and Maximal Clique Search is Generalized Degree Signal. In order to exploit the
the biggest bottleneck due to its exponential complexity. graph signal processing theory, we need to define a signal
Hence, we aim to design a sampling module that reduces onthecorrespondencegraph. Thenormaldegreesignalforeachcliqueguaranteestheabilitytogenerateahypothesis.
exaczterlorys e ponse
3. Considering link between nodes represents compatibil-
ity, the selected correspondences are not only compatible
withthecorrespondenceswithintheirownclique, butalso
withsomeothers,indicatingthatthesecorrespondencesare
morereliableandthusgeneratingbetterhypotheses.
Nowweexplainwhythefeaturesseenintheconnected
Figure 3. Response of the degree signal to a high-pass filter on
cavemangraphcanapplytoothergraphs.Inatypicalgraph,
connected-caveman graphs. Node size represents the response
cliquesareeithermutuallyconnectedornot. Mutuallycon-
magnitude.Thisshowswhyhigh-passfilterissuitedforMAC.
nected cliques maintain similar local properties of a con-
nectedcavemangraph,whereasisolatedcliquesexhibitdis-
a node is the number of edges it connects. In a weighted tinct features. Nevertheless, isolated cliques are rare and
graph,thegeneralizeddegreesignalforanodeisdefinedas oftennegligibleinthescenarioofgraph-basedregistration.
the sum of edge weight it connects. In the following sec-
3.2.GraphFiltering: Formulation
tions,wewillexplainwhythissignalcanhelpusconstruct
agraphfilterthatissuitedformaximalcliquesearch. High-pass. Guidedbytheaforementionedinsight,wepro-
posetoselectivelysamplethehigh-frequencynodesbyfirst
3.1.GraphFiltering: KeyInsight formulating the graph filter. There are three typical graph
filters:high-pass,low-passandall-pass. Asimpledesignof
After constructing a correspondence graph, we go into the
high-passfilterisaHaar-likehigh-passgraphfilter:
second part of Fig. 2. Our objective is to extract the high-
frequencycomponentofthegeneralizeddegreesignal(de-  1−λ 0 ... 0 
1
gree later for brevity), allowing us to sample the nodes in  0 1−λ 2 ... 0 
t sh ee ctg ior nap wh iw llh he igre hlt ih ge htd te hg ere re eau sn od ne srg foo res dora inp gid soch .a Wng ee ss t. arT th bi ys H=I−A=V  

. .
.
...   V−1
0 0 ... 1−λ
analysing the frequency of the degree distribution, and in N
(1)
particularitsrelationtocliques,asshowninFig.3.
where A is a normalized graph shift as defined in Ap-
In order to explore the relationship between the degree
pendix A.1., V and λ are the corresponding eigenvectors
signal frequency and cliques, we investigated the response i
andeigenvalues.Notethatλ =1andifweorderλ ina
of the degree signal to a high-pass filter, which is im- max i
descendingorder,wehave1−λ ≤1−λ ,indicatinglow
plemented with Laplacian matrix as mentioned above, on i i+1
frequencyresponseattenuatesandhighfrequencyresponse
crafted (not generated from realistic data) connected cave-
amplifies. Adetailedinterpretationisgivenin[11].
man graphs[63]. Note that our focus is on the degree fre-
Low-pass. The opposite of this is a the Haar-like low-
quency, a local feature determined solely by the neighbor-
passgraphfilter,thatis
ingnodes.Byprioritizingthislocalfeature,wecansimplify
other types of graphs into the connected caveman graph, 1
H=I+ A
whichwillbeexplainedlater. |λ |
max
AsillustratedinFig.3,nodeswithhighresponseexhibit  1+ λ1 0 ... 0 
certainproperties. Ifweconsidereachcliqueasacommu- |λmax|
 0 1+ λ2 ... 0 
n toity g, enth ee ran t: e1 s. tI rn one gve rr ey spc oo nm sem .u 2n .i Tty h, et rh ee are rem au ss ut fe fix ci is et na t nn uo mde - =V    . . . |λmax| ...   V−1
 
berofnodeswithinacommunitythatcanelicitastrongre- 0 0 ... 1+ λN
sponse. 3.Nodeswithsignificantresponselieontheperiph- |λmax|
(2)
ery of each community and are susceptible to consituting
All-pass. Anall-passgraphfilterissimple: H=I. The
cutpoints. Theyhavelinksnotonlywithnodeswithintheir
all-passfilterkeepsallinformationofthedegreesignaland
respectivecommunitybutalsowithnodesinotherones.
intuitivelysamplesthosenodeswithlargedegrees.
These properties prompt the idea of sampling the high-
For correspondence graph. When it comes to our fil-
frequency nodes. Maximal Clique registration process in-
ter, we first compute the generalized degree signal s =
volvessearchingallmaximalcliquesinthecorrespondence [s ,s ,...,s ]T ∈ CN×1 where s = (cid:80) W , and
graph, generating hypothesis for each maximal clique and 1 2 N i j SOGij
N isthesizeofcorrespondenceset.Thenahigh-passgraph
selecting the best one. Suppose the output samples con-
filter is adopted to filter the high frequency information of
sist of high-frequency nodes, then: 1. since such nodes
s. ForG ,wedefinethehigh-passgraphfilteras:
corr
must exist in every community, they can cover nearly ev-
ery maximal clique. 2. A sufficient number of samples in H=Diag(s)−W , (3)
SOGor the Laplacian Matrix of the correspondence graph. In
thegraphvertexdomain,theoutputforasignalX = (x ),
i
(cid:80)
(HX) = s x − W x reflectsthedifference
i i i j∈Ni SOGij j
betweenanodeandthecombinationofitsneighbors.
Thenwehavetheresponseofsignalscorrespondingto
Hasf =Hs.Wefurthercomputetheresponsemagnitude:
π = ||f ||2 which quantifies the energy of the signal on
i i 2
each node after high-pass graph filtering. It reflects how
muchinformationweknowaboutasignalvalueonthenode
fromitsneighborsinthegraph.
3.3.StochasticSampling
Sampling operator definition. After obtaining the re-
sponsemagnitudeofeachnodetothegraphfilterasshown
inFig.2,weperformsamplingbasedonthisresponsemag-
Figure4. SamplingperformanceonKITTI.Eachcolumnrepre-
nitude. Suppose we aim to sample m components of a
sentsametricinTE,REandRRandeachrowrepresentsasetting
graph signal x = Hs ∈ Cn to produce a sampled signal
composedofdatasetsanddescriptors.Shadedareasrepresentvari-
y =x ∈Cm,whereMisthesetofsampledindices.The
M ancefrommultipleruns.
samplingoperatorΨisdefinedasalinearmappingfromCn
toCm,Ψ =δ andtheinterpolationoperatorΦisde-
ij j,Mi
finedasalinearmappingfromCmtoCn: 4.Experiments
y =x =Ψx, (4a) Forinformationaboutdatasets, evaluationmetricsandim-
M
x′ =Φy =ΦΨx, (4b) plementationdetails,pleaserefertotheAppendixA.6.
where x′ ∈ Cn is the recovery of the original signal. A 4.1.Time-AccuracyTrade-offComparison
properly designed sampling operator Ψ aims to minimize
We perform an extensive comparison in Fig. 1. The cor-
thereconstructionerror||x−x′||.
respondence based registration methods are presented for
Non-stochastic methods attempt to create a well-
comparison. All methods are tested on the KITTI dataset
designeddeterministicsamplingoperatorΨ. [10]findsthe
withFCGFasthecorrespondencegenerationdescriptor.
optimalsamplingoperator:
Fig. 1 demonstrates RR performance of different meth-
ods. Our FastMAC can outperform all other methods
Ψ =argmaxσ (ΨV ), (5)
opt min (K)
Ψ even with a sample ratio as low as 5%. It runs nearly
80 times faster than methods with comparable RR perfor-
whereσ meansthesmallestsingularvalueandV rep-
min (K)
mance,andachievesa40%higherRRwhencomparedto
resents the independent columns in the eigenvectors V of
methodsthatarealmostasfastasit. Moreover,whensam-
the graph shift A. In practice, a greedy algorithm [10] is
pling ratio declines to 20%, our method runs at real-time
usedtofindanapproximatesolution. ItmaintainsM,aset
level,withasingleregistrationrequireslessthan35ms.
of rows of V , and loops to find another row r in V
(K) (K)
to maximize σ of the matrix formed by M +{r} until
min 4.2.SamplingStrategyComparison
|M| meets the termination condition. However, it is ex-
tremelyslowwhenprocessinglargematrices,asitinvolves Wealsocompareourmethodwithdifferentsamplingstrate-
a number of SVD decompositions with a total complexity gies. ThisdemonstratesthattheMACitselfisstillsensitive
ofO(MN3+M3N)whereM isthesamplesizeandN is to the number of correspondences, thus showing that our
theoriginalsize. Proofwillbegivenin5.2. method is superior and suited for Maximal Clique regis-
Stochasticsampling. Bycontrast,weadoptastochastic tration. The sampling strategies for comparison are Ran-
strategy. We consider π fetched from Graph Filtering as domSamplingandFurthestPointSampling(FPS).Notably,
i
a sampling distribution and apply probability sampling on acorrespondenceisnotatraditional3Dpointandwedefine
theinitialcorrespondenceset,resultinginasampledsetde- their distance as the euclidean distance in 6D space. Both
noted as C . π approximates the sampling operator FPFHandFCGFdescriptoraretested.
sampled i
Ψ and it is optimal in terms of minimizing the reconstruc- Results on KITTI Dataset: Fig. 4 shows results of
tion error, according to proof in [11], and is much faster, FPFH and FCGF settings on KITTI Dataset. Our method
whichwillbeprovedin5.2. Adetailedproofofoptimality maintains a consistent RR, RE and TE when sampling ra-
isgiveninAppendix.A.5. tio declines from 100% to 5% and only becomes slightlymethod ratio Sampling GC MCS NCS PE Total
MAC 100 0 749.057 61.390 132.809 18.056 961.312
50 15.13 129.404 26.845 2.225 5.039 178.643
20 15.02 14.945 4.794 0.408 0.903 36.070
FastMAC 10 14.97 3.369 1.113 0.070 0.256 19.778
5 14.99 0.971 0.267 0.005 0.067 16.300
1 15.06 0.056 0.001 0.001 0.019 15.137
Table1. Timeprofilingfor3DMatchDatasetwithFCGFdescrip-
tor.VanillaMACiscomparedwithourFastMAC.Timeconsump-
tionismeasuredinmilliseconds. GC:GraphConstruction;MCS:
MaximalCliqueSearch;NCS:Node-guidedCliqueSelection;PE:
PoseEstimation
FPFH FCGF
RR(%) RE(◦) TE(cm) RR(%) RE(◦) TE(cm) Time(s)
FGR[76] 5.23 0.86 43.84 89.54 0.46 25.72 9.350
TEASER++[66] 91.17 1.03 17.98 94.96 0.38 13.69 0.070
RANSAC-4M[23] 74.41 1.55 30.20 80.36 0.73 26.79 52.40
Figure5. Samplingperformanceon3DMatch. Eachcolumnrep- CG-SAC[68] 74.23 0.73 14.02 83.24 0.56 22.96 2.140
SC2-PCR[13] 96.40 0.41 8.00 97.12 0.41 9.71 0.850
resentsametricinTE,REandRRandeachrowrepresentsasetting DGR[18] 77.12 1.64 33.10 94.90 0.34 21.70 0.330
composedofdatasetsanddescriptors. PointDSC[2] 96.40 0.38 8.35 96.40 0.61 13.42 0.130
MAC[71] 97.66 0.41 8.61 97.25 0.36 8.00 0.570
FastMAC@50 97.84 0.41 8.61 97.84 0.36 7.98 0.114
FastMAC@20
98.02 0.41 8.64 97.48 0.38 8.20 0.028
(real-time)
Table 2. Comparison with baseline methods on KITTI Dataset.
Thebestandsecond-to-bestresultsofbaselinemethodsarerepec-
tivelymarkedinboldandunderlined. FastMAC@xreferstoour
methodsamplingatx%ratio.
ratiodecreasesforallthreemethods,duetolow-overlapof
this dataset. Still, our method significantly surpasses the
performance of the other two methods, considering their
almost-zerosuccessrateat1%sampleratio.
4.3.TimeProfiling
To demonstrate FastMAC’s time efficiency, we study on-
Figure 6. Sampling performance on 3DLoMatch. Each column devicetimeprofilingtoreporttimeconsumption. Theorig-
represents a metric in TE,RE and RR and each row represents a inalMACisusedforcomparison.
settingcomposedofdatasetsanddescriptors. Fig. 1 depicts our results on KITTI Dataset with FPFH
descriptor. Ontherightside,wedemonstratetimeprofiling
ofMACandFastMACwitha5%sampleratio. ForMAC,
worse at the 1%. By comparison, Random Sampling and GraphConstructionandMaximalCliquesSearchoccupya
FPS strategy show rapid deterioration in performance. It’s major part of time consumption, pushing the total time to
worth noticing that FPS behaves even worse than Random over1second. WhilstforFastMAC,theyarenolongerbot-
strategy,suggestingthata6-dimensionalvectorspacewith tlenecks. Middle shows variation of time taken versus the
Euclidean distance is ill-suited for the correspondence set. sample ratio. Sampling gradually became the dominatant
Another notable point is that the FPS performance shows factor,withrestpartsbeingbarelytime-consuming.
dramaticfluctuations,indicatinglackofrobustness. Table 1 further presents our findings on 3DMatch. Ac-
Results on 3DMatch Dataset: As shown in Fig. 5, celerationfromSamplingnegatesthetimespentduringthe
ourmethodstillworkswell. ThoughtheRandomStrategy processitself.Anditstimedecreaseisessentiallyconsistent
performscloselytoourmethodonREandTE,ithasamuch acrossvarioussamplerates,provingitsefficiency.
lowersuccessrate. ThismeansRandomStrategyhasahigh
4.4.ComparisontoState-of-the-arts
performance on only a few point cloud pairs, which limits
itsusageinchallengingreal-worldproblems. Our method is compared with baseline approaches on the
Resultson3DLoMatchDataset: AsinFig.6, RRof 3DMatch, 3DLomatch, and KITTI datasets, and the out-
3DLoMatch drops faster than 3DMatch when the sample comes can be found in Tables 2, 3 and 4. When samplingFPFH FCGF
RR(%) RE(◦) TE(cm) RR(%) RE(◦) TE(cm) Time(s)
RANSAC-1M[23] 64.20 4.05 11.35 88.42 3.05 9.42 23.30
RANSAC-4M[23] 66.10 3.95 11.03 91.44 2.69 8.38 95.80
GC-RANSAC[3] 67.65 2.33 6.87 92.05 2.33 7.11 0.450
TEASER++[66] 75.48 2.48 7.31 85.77 2.73 8.66 0.030
SC2-PCR[13] 83.73 2.18 6.70 93.16 2.09 6.51 0.920
3DRegNet[44] 26.31 3.75 9.60 77.76 2.74 8.13 0.050
DGR[18] 32.84 2.45 7.53 88.85 2.28 7.02 1.260
PointDSC[2] 72.95 2.18 6.45 91.87 2.10 6.54 0.140
MAC[71] 83.90 2.11 6.80 93.72 2.02 6.54 0.914
FastMAC@50 82.87 2.15 6.73 92.67 2.00 6.47 0.203
FastMAC@20
80.71 2.17 6.81 92.30 2.02 6.52 0.038
(real-time)
Table3.Comparisonwithbaselinemethodson3DMatchDataset.
Thebestandsecond-to-bestresultsofbaselinemethodsarerepec-
tivelymarkedinboldandunderlined. FastMAC@xreferstoour
methodsamplingatx%ratio.
FPFH FCGF
RR(%) RE(◦) TE(cm) RR(%) RE(◦) TE(cm) Time(s)
RANSAC-1M[23] 0.67 10.27 15.06 9.77 7.01 14.87 19.60
RANSAC-4M[23] 0.45 10.39 20.03 10.44 6.91 15.14 86.30
TEASER++[66] 35.15 4.38 10.96 46.76 4.12 12.89 0.030
SC2-PCR[13] 38.57 4.03 10.31 58.73 3.80 10.44 0.720
DGR[18] 19.88 5.07 13.53 43.80 4.17 10.82 1.220
PointDSC[2] 20.38 4.04 10.25 56.20 3.87 10.48 0.140
MAC[71] 40.88 3.66 9.45 59.85 3.50 9.75 1.181 Figure7.PerformanceonKITTIwithvariousdescriptors.
FastMAC@50 38.46 4.04 10.47 58.23 3.80 10.81 0.271
FastMAC@20
34.31 4.12 10.82 55.25 3.84 10.71 0.051
(real-time) High-pass All-pass Low-pass
Ratio
RR(%) RE(◦) TE(cm) RR(%) RE(◦) TE(cm) RR(%) RE(◦) TE(cm)
Table 4. Comparison with baseline methods on 3DLoMatch
50 97.66 0.368 8.016 97.12 0.368 8.098 97.48 0.368 8.135
Dataset. Thebestandsecond-to-bestresultsofbaselinemethods
20 97.66 0.391 8.457 96.58 0.395 8.672 97.30 0.403 8.648
arerepectivelymarkedinboldandunderlined.
10 96.94 0.446 9.201 96.94 0.480 9.329 94.96 0.468 9.417
5 96.04 0.525 10.038 93.33 0.583 10.907 90.09 0.616 11.182
1 71.89 0.997 14.899 28.11 1.058 15.217 13.33 3.516 106.211
at various ratios, FastMAC reports no significant decrease
Table5.RegistrationresultsonKITTIFCGFdatasetforcompari-
inperformance,remainingcompetitivewithotherstate-of-
sonbetweentheHigh-pass,Low-passandAll-passfilters.
the-art methods. This showcases the efficacy of our sam-
plingtechnique,whichacceleratesthestate-of-the-artMAC
methodwhilstmaintainingaccuracy.
5.AblationStudy
4.5.DescriptorRobustness
Inthissection,wemainlyfocusontheanalysisofthecore
parts of our method, i.e, High-pass Graph Filtering and
Since our method accepts correspondences as input, it
StochasticallySampling.Sincexyzcoordinatesofthepoint
is crucial to demonstrate its ability to work with corre-
cloudcanalsobeagraphsignalandhasbeenwidelyused
spondences generated by different descriptors. We per-
before[11],wefurthercomparexyzsignalwithourgener-
form extensive experiments with various descriptors, in-
alizeddegreesignaltodemonstrateoursuperiority.
cluding FPFH[51], FCGF[17], Predator[30], Spinnet[1],
Cofinet[69]andGeotransformer[49]. Thesedescriptorsare
5.1.High-pass,Low-passandAll-passFilter
usedtogeneratepoint-wisefeatureswhicharesubsequently
used to obtain correspondences. We adopt KITTI as the Inthispart,wecompareourhigh-passfilterwithalow-pass
datasetandtheresultsarepresentedinFig.7. filter and an all-pass filter to demonstrate its efficacy. The
ForRRmetric,strongerdescriptorslikeGeotransformer, filtersareimplementedasdescribedin3. FortheHaar-like
Cofinet, Spinnet and Predator exhibit amazing excellence, low-pass filter, we choose the graph shift A to be D−1W
with their RR remaining unaffected by the sample ratio, where D is the generalized degree matrix and W is the
while FCGF and FPFH perform slightly worse when sam- adjacency matrix. Then we have the sample distribution
pleratiocomesto1%. ForREandTE,mostdescriptorsbe- π i = ||((I +D−1W)s) i|| 2 in which s is the generalized
havesimilarly. Thesemetricsfirststabilizeandthenslowly degreesignal.Fortheall-passfilter,thecorrespondingsam-
increaseasthesamplingratedecreases. Itcanthereforebe plingstrategyisπ i =||s i|| 2.
concludedthatourmethodishighlyrobusttothecorrespon- We use these types of filters to sample the correspon-
dencesproducedbydifferentdescriptors. dencesandfeedtheoutputintotheMACmodule. There-56 hour
293.03s
consistently 15ms
0.015s 0.57s
Figure9. SamplingperformanceonKITTIFCGFwithdifferent
SVD
0.002s Eig degreesignalsettings.000:randomsampling.110:sampleguided
Preparation
stocnon-stoc Selections by xyz signals from source and target pointcloud. 001: sample
guidedbyourgeneralizeddegreesignal. 111: sampleguidedby
Figure 8. Left figure shows how time increases with number of simplyaddingbothsignals.
samples on KITTI FCGF dataset. Right is time profiling when
sampling50from5000correspondences. Preparation: Compu-
tation of the graph shift and the degree score. Sampling: For
remains consistently stable at 15 ms as the sample rate in-
stochastic method, only 50 selection operations are required ac-
creases. Bycontrast,thenon-stochasticmethod’stimecon-
cordingtothegivendistribution.Fornon-stochasticmethod,itin-
cludesaneigendecompositionand50loopsof∼5000-scaleSVD. sumptionincreasesinapolynomialtrend,necessitatingtwo
daystoobtain2500samples! Thisislargelycausedbythe
frequent,multiplelargematrixSVDdecompositions.
sultisshowninTable.5. Thehigh-passfilterismoreeffec-
tive,providingevidencetosupportourintuition.Infact,an 5.3.XYZSignalv.s. GeneralizedDegreeSignal
all-pass filter solely samples out nodes with high degrees,
whereasalow-passfiltersamplesnodeswhichliewithina In this section, we compare our generalized degree signal
clique. Ifthecliqueisbiginsize,low-passandall-passfil- with xyz signal which are commonly used in point cloud
tersfunctioninamannersimilartorandomsampling. That sampling. As we accept correspondences as input, we de-
iswhythesetwofiltersdonotfunctionwell. note the source point cloud formed by source points as
Q ∈ CN×3 and target point cloud Q ∈ CN×3. They
s t
5.2.Stochasticv.s. Non-stochastic are considered as graph signals and pass through a high-
pass filter which is created by KNN adjacency matrix fol-
To clarify the efficiency of our stochastic method, we will
lowing[11]todetecttheircontourpoints. Theresponseare
giveboththeoreticalanalysisandexperimentalanalysis.
denotedasq ∈CN×3 andq ∈CN×3. Theresponsemag-
s t
nitude||q || ∈CN and||q || ∈CN arethenscaledto0-1
s 2 t 2
Theoretical Analysis Since both stochastic and non-
toformthesamplingdistributionπ ,π .
1 2
stochasticmethodsinvolvecomputingthesignalafterfilter-
Fig.9demonstratestheresultsoffoursettings. Thesig-
ing,weonlyanalyzeoperationsafterthecomputation.Sup-
nal of the generalized degree performs the best, while xyz
posewearesamplingM nodesfromtheoriginalN nodes.
signal does not differ significantly from random sampling.
Non-stochastic: V isfirstrequiredforthegraphshift
(K) Whencombinedwithxyzsignal,theperformanceofgener-
A, which is O(N3) complexity [45]. Then we enter the
alizeddegreesignalgetsworse,indicatingthattheinforma-
greedy algorithm which loops for M times. In loop i,
tionwithinthegeneralizeddegreesignaliscontaminatedby
N−itimesofcomputingthesmallestsingularvalueisper-
xyzsignal.
formed,eachusingO(N3+(i+1)2N)[29].Aftersumming
themall,wegetthefinalcomputationcomplexity
6.Conclusion
M−1
(cid:88)
O(N3)+ O(N3+(i+1)2N)
In this paper, we propose a stochastic spectral correspon-
(6)
i=0 dence graph sampling method to discover high-frequency
=O(MN3+M3N) nodes, boosting Maximal Clique Registration to real-time
level with little performance loss. Moreover, it’s robust
Stochastic: Ourstochasticmethodsimplyusethenorm to various descriptors, showing its potential for usage in
ofthefilteredsignalyasadistributionandsamplesM times real-time complex applications. Still we have limitations.
fromit. ThetimecomplexityisO(M)+O(N). As shown in Fig. 1, when sample ratio decreases, graph
constructiongraduallybecomesabottleneck. Inthefuture
ExperimentalAnalysis Wepresentourexperimentalre- weplantosolvethisissuebylearninggraphpriorwithout
sults in Fig. 8. The time taken by the stochastic method buildingagraph,thuseliminatingthiscost.References tiveclosestpointalgorithm.Imageandvisioncomputing,23
(3):299–309,2005. 2
[1] Sheng Ao, Qingyong Hu, Bo Yang, Andrew Markham,
[15] Tat-Jun Chin and David Suter. The maximum consensus
and Yulan Guo. Spinnet: Learning a general surface de-
problem: recent algorithmic advances. Springer Nature,
scriptor for 3d point cloud registration. In Proceedings of
2022. 2
the IEEE/CVF conference on computer vision and pattern
[16] Tat-Jun Chin, Zhipeng Cai, and Frank Neumann. Robust
recognition,pages11753–11762,2021. 7,12
fitting in computer vision: Easy or hard? In Proceedings
[2] Xuyang Bai, Zixin Luo, Lei Zhou, Hongkai Chen, Lei Li,
of the European Conference on Computer Vision (ECCV),
Zeyu Hu, Hongbo Fu, and Chiew-Lan Tai. Pointdsc: Ro-
pages701–716,2018. 2
bustpointcloudregistrationusingdeepspatialconsistency.
[17] Christopher Choy, Jaesik Park, and Vladlen Koltun. Fully
In Proceedings of the IEEE/CVF Conference on Computer
convolutional geometric features. In Proceedings of the
VisionandPatternRecognition,pages15859–15869,2021.
IEEE/CVF international conference on computer vision,
6,7,13,14
pages8958–8966,2019. 7,12,13
[3] DanielBarathandJiˇr´ıMatas.Graph-cutransac.InProceed-
[18] Christopher Choy, Wei Dong, and Vladlen Koltun. Deep
ingsoftheIEEEconferenceoncomputervisionandpattern
global registration. In Proceedings of the IEEE/CVF con-
recognition,pages6733–6741,2018. 7
ference on computer vision and pattern recognition, pages
[4] Jean-Charles Bazin, Yongduek Seo, and Marc Pollefeys.
2514–2523,2020. 6,7,13,14
Globallyoptimalconsensussetmaximizationthroughrota-
tion search. In Computer Vision–ACCV 2012: 11th Asian [19] Ondrej Chum and Jiri Matas. Matching with prosac-
ConferenceonComputerVision,Daejeon,Korea,November progressivesampleconsensus. In2005IEEEcomputerso-
cietyconferenceoncomputervisionandpatternrecognition
5-9, 2012, RevisedSelectedPapers, PartII11, pages539–
(CVPR’05),pages220–226.IEEE,2005. 2
551.Springer,2013. 2
[5] PaulJBeslandNeilDMcKay. Methodforregistrationof [20] Brian Curless and Marc Levoy. A volumetric method for
3-dshapes. InSensorfusionIV:controlparadigmsanddata buildingcomplexmodelsfromrangeimages.InProceedings
structures,pages586–606.Spie,1992. 2 of the 23rd annual conference on Computer graphics and
interactivetechniques,pages303–312,1996. 1
[6] ThomasMBreuel.Implementationtechniquesforgeometric
branch-and-boundmatchingmethods. ComputerVisionand [21] Jeffrey Delmerico, Stefan Isler, Reza Sabzevari, and Da-
ImageUnderstanding,90(3):258–294,2003. 2 videScaramuzza. Acomparisonofvolumetricinformation
[7] Alvaro Parra Bustos and Tat-Jun Chin. Guaranteed outlier gainmetricsforactive3dobjectreconstruction.Autonomous
removal for point cloud registration with correspondences. Robots,42(2):197–208,2018. 2
IEEEtransactionsonpatternanalysisandmachineintelli- [22] Olof Enqvist, Klas Josephson, and Fredrik Kahl. Optimal
gence,40(12):2868–2882,2017. 2 correspondences from pairwise constraints. In 2009 IEEE
[8] C Cao, H Zhu, Z Ren, H Choset, and J Zhang. Represen- 12th international conference on computer vision, pages
tationgranularityenablestime-efficientautonomousexplo- 1295–1302.IEEE,2009. 2
ration in large, complex worlds. Science Robotics, 8(80): [23] Martin A Fischler and Robert C Bolles. Random sample
eadf0970,2023. 1 consensus:aparadigmformodelfittingwithapplicationsto
[9] Luca Carlone. Estimation contracts for outlier-robust geo- imageanalysisandautomatedcartography.Communications
metricperception. arXivpreprintarXiv:2208.10521,2022. oftheACM,24(6):381–395,1981. 6,7,14
2 [24] Huan-ang Gao, Beiwen Tian, Pengfei Li, Xiaoxue Chen,
[10] Siheng Chen, Rohan Varma, Aliaksei Sandryhaila, and Je- Hao Zhao, Guyue Zhou, Yurong Chen, and Hongbin Zha.
lenaKovacˇevic´. Discretesignalprocessingongraphs:Sam- Fromsemi-supervisedtoomni-supervisedroomlayoutesti-
pling theory. IEEE transactions on signal processing, 63 mationusingpointclouds.In2023IEEEInternationalCon-
(24):6510–6523,2015. 2,3,5 ference on Robotics and Automation (ICRA), pages 2803–
[11] SihengChen,DongTian,ChenFeng,AnthonyVetro,andJe- 2810.IEEE,2023. 1
lenaKovacˇevic´. Fastresamplingofthree-dimensionalpoint [25] Huan-ang Gao, Beiwen Tian, Pengfei Li, Hao Zhao, and
cloudsviagraphs. IEEETransactionsonSignalProcessing, Guyue Zhou. Dqs3d: Densely-matched quantization-
66(3):666–681,2017. 3,4,5,7,8 awaresemi-supervised3ddetection. InProceedingsofthe
[12] XiaoxueChen,HaoZhao,GuyueZhou,andYa-QinZhang. IEEE/CVF International Conference on Computer Vision,
Pq-transformer: Jointlyparsing3dobjectsandlayoutsfrom pages21905–21915,2023. 1
pointclouds. IEEERoboticsandAutomationLetters,7(2): [26] AndreasGeiger, PhilipLenz, andRaquelUrtasun. Arewe
2519–2526,2022. 1 ready for autonomous driving? the kitti vision benchmark
[13] ZhiChen,KunSun,FanYang,andWenbingTao. Sc2-pcr: suite. In2012IEEEconferenceoncomputervisionandpat-
Asecondorderspatialcompatibilityforefficientandrobust ternrecognition,pages3354–3361.IEEE,2012. 13
point cloud registration. In Proceedings of the IEEE/CVF [27] Se´bastienGrangerandXavierPennec. Multi-scaleem-icp:
Conference on Computer Vision and Pattern Recognition, Afastandrobustapproachforsurfaceregistration. InCom-
pages13221–13231,2022. 6,7,13,14 puter Vision—ECCV 2002: 7th European Conference on
[14] DmitryChetverikov,DmitryStepanov,andPavelKrsek.Ro- ComputerVisionCopenhagen,Denmark,May28–31,2002
busteuclideanalignmentof3dpointsets:thetrimmeditera- Proceedings,PartIV7,pages418–432.Springer,2002. 2[28] Richard I Hartley and Fredrik Kahl. Global optimization [42] PrajvalKumarMurali,AnirvanDutta,MichaelGentner,Eti-
throughrotationspacesearch.InternationalJournalofCom- enneBurdet,RavinderDahiya,andMohsenKaboli. Active
puterVision,82(1):64–79,2009. 2 visuo-tactile interactive robotic perception for accurate ob-
[29] MichaelHolmes, AlexanderGray, andCharlesIsbell. Fast jectposeestimationindenseclutter. IEEERoboticsandAu-
svdforlarge-scalematrices. InWorkshoponEfficientMa- tomationLetters,7(2):4686–4693,2022. 2
chineLearningatNIPS,pages249–252,2007. 8 [43] CarlOlsson,FredrikKahl,andMagnusOskarsson. Branch-
[30] Shengyu Huang, Zan Gojcic, Mikhail Usvyatsov, Andreas and-bound methods for euclidean registration problems.
Wieser, and Konrad Schindler. Predator: Registration IEEE Transactions on Pattern Analysis and Machine Intel-
of 3d point clouds with low overlap. In Proceedings of ligence,31(5):783–794,2008. 2
the IEEE/CVF Conference on computer vision and pattern [44] GDiasPais,SrikumarRamalingam,VenuMadhavGovindu,
recognition,pages4267–4276,2021. 7,12,13 JacintoCNascimento,RamaChellappa,andPedroMiraldo.
[31] Shun’ichi Kaneko, Tomonori Kondo, and Atsushi 3dregnet: A deep neural network for 3d point registration.
Miyamoto. Robust matching of 3d contours using iter- InProceedingsoftheIEEE/CVFconferenceoncomputervi-
ative closest point algorithm improved by m-estimation. sionandpatternrecognition,pages7193–7203,2020. 7
PatternRecognition,36(9):2041–2047,2003. 2 [45] VictorYPanandZhaoQChen.Thecomplexityofthematrix
[32] Anton Konouchine, Victor Gaganov, and Vladimir Vezn- eigenproblem.InProceedingsofthethirty-firstannualACM
evets. Amlesac: Anewmaximumlikelihoodrobustestima- symposiumonTheoryofcomputing, pages507–516, 1999.
tor. Proc. of Graphicon-2005. Novosibirsk, pages 93–100, 8
2005. 2 [46] Alvaro Parra, Tat-Jun Chin, Frank Neumann, Tobias
[33] MariusLeordeanuandMartialHebert. Aspectraltechnique Friedrich,andMaximilianKatzmann.Apracticalmaximum
forcorrespondenceproblemsusingpairwiseconstraints. In clique algorithm for matching with pairwise constraints.
Tenth IEEE International Conference on Computer Vision arXivpreprintarXiv:1902.01534,2019. 2
(ICCV’05)Volume1,pages1482–1489.IEEE,2005. 2 [47] Franc¸ois Pomerleau, Francis Colas, Roland Siegwart, and
[34] HongdongLi. Consensussetmaximizationwithguaranteed Ste´phaneMagnenat. Comparingicpvariantsonreal-world
global optimality for robust geometry estimation. In 2009 data sets: Open-source library and experimental protocol.
IEEE 12th International Conference on Computer Vision, Autonomousrobots,34:133–148,2013. 2
pages1074–1080.IEEE,2009. 2 [48] CharlesRQi,HaoSu,KaichunMo,andLeonidasJGuibas.
[35] Pengfei Li, Ruowen Zhao, Yongliang Shi, Hao Zhao, Jirui Pointnet: Deep learning on point sets for 3d classification
Yuan,GuyueZhou,andYa-QinZhang. Lode: Locallycon- and segmentation. In Proceedings of the IEEE conference
ditionedeikonalimplicitscenecompletionfromsparselidar. oncomputervisionandpatternrecognition,pages652–660,
In2023IEEEInternationalConferenceonRoboticsandAu- 2017. 3
tomation(ICRA),pages8269–8276.IEEE,2023. 1 [49] Zheng Qin, Hao Yu, Changjian Wang, Yulan Guo, Yux-
[36] Yu-Kai Lin, Wen-Chieh Lin, and Chieh-Chih Wang. K- ing Peng, and Kai Xu. Geometric transformer for fast
closestpointsandmaximumcliquepruningforefficientand and robust point cloud registration. In Proceedings of
effective 3-d laser scan matching. IEEE Robotics and Au- the IEEE/CVF conference on computer vision and pattern
tomationLetters,7(2):1471–1477,2022. 3 recognition,pages11143–11152,2022. 7
[37] CeLiu,JennyYuen,andAntonioTorralba. Siftflow:Dense [50] SiwenQuanandJiaqiYang. Compatibility-guidedsampling
correspondence across scenes and its applications. IEEE consensus for 3-d point cloud registration. IEEE Trans-
transactions on pattern analysis and machine intelligence, actions on Geoscience and Remote Sensing, 58(10):7380–
33(5):978–994,2010. 1 7392,2020. 2
[38] ParkerCLusk,KavehFathian,andJonathanPHow.Clipper: [51] RaduBogdanRusu,NicoBlodow,andMichaelBeetz. Fast
Agraph-theoreticframeworkforrobustdataassociation. In pointfeaturehistograms(fpfh)for3dregistration. In2009
2021 IEEE International Conference on Robotics and Au- IEEEinternationalconferenceonroboticsandautomation,
tomation(ICRA),pages13828–13834.IEEE,2021. 2 pages3212–3217.IEEE,2009. 7,12,13
[39] LenaMaier-Hein,AlfredMichaelFranz,ThiagoRDosSan- [52] AliakseiSandryhailaandJoseMFMoura. Bigdataanalysis
tos,MirkoSchmidt,MarkusFangerau,Hans-PeterMeinzer, with signal processing on graphs: Representation and pro-
andJMichaelFitzpatrick.Convergentiterativeclosest-point cessingofmassivedatasetswithirregularstructure. IEEE
algorithmtoaccomodateanisotropicandinhomogenouslo- signalprocessingmagazine,31(5):80–90,2014. 3
calizationerror. IEEEtransactionsonpatternanalysisand [53] Aliaksei Sandryhaila and Jose MF Moura. Discrete signal
machineintelligence,34(8):1520–1532,2011. 2 processing on graphs: Frequency analysis. IEEE Transac-
[40] Joshua G Mangelson, Derrick Dominic, Ryan M Eustice, tionsonSignalProcessing,62(12):3042–3054,2014. 3
and Ram Vasudevan. Pairwise consistent measurement set [54] Aleksandr Segal, Dirk Haehnel, and Sebastian Thrun.
maximizationforrobustmulti-robotmapmerging. In2018 Generalized-icp. In Robotics: science and systems, page
IEEE international conference on robotics and automation 435.Seattle,WA,2009. 2
(ICRA),pages2916–2923.IEEE,2018. 2 [55] Jingnan Shi, Heng Yang, and Luca Carlone. Robin: a
[41] Gerard Medioni and Sing Bing Kang. Emerging topics in graph-theoreticapproachtorejectoutliersinrobustestima-
computervision. PrenticeHallPTR,2004. 2 tionusinginvariants.In2021IEEEInternationalConferenceon Robotics and Automation (ICRA), pages 13820–13827. forrobustpointcloudregistration.AdvancesinNeuralInfor-
IEEE,2021. 2 mationProcessingSystems,34:23872–23884,2021. 7,12
[56] Jamie Shotton, Ben Glocker, Christopher Zach, Shahram [70] Andy Zeng, Shuran Song, Matthias Nießner, Matthew
Izadi,AntonioCriminisi,andAndrewFitzgibbon.Sceneco- Fisher,JianxiongXiao,andThomasFunkhouser. 3dmatch:
ordinateregressionforestsforcamerarelocalizationinrgb-d Learninglocalgeometricdescriptorsfromrgb-dreconstruc-
images.InProceedingsoftheIEEEconferenceoncomputer tions. InProceedingsoftheIEEEconferenceoncomputer
visionandpatternrecognition,pages2930–2937,2013. 1 visionandpatternrecognition,pages1802–1811,2017. 13
[57] Pablo Speciale, Danda Pani Paudel, Martin R Oswald, Till [71] XiyuZhang,JiaqiYang,ShikunZhang,andYanningZhang.
Kroeger, Luc Van Gool, and Marc Pollefeys. Consensus 3d registration with maximal cliques. In Proceedings of
maximization with linear matrix inequality constraints. In theIEEE/CVFConferenceonComputerVisionandPattern
Proceedings of the IEEE Conference on Computer Vision Recognition,pages17745–17754,2023. 1,3,6,7,13,14
andPatternRecognition,pages4941–4949,2017. 2 [72] Zhengyou Zhang. Iterative point matching for registration
[58] LeiSun. Ransic: Fastandhighlyrobustestimationforrota- of free-form curves and surfaces. International journal of
tionsearchandpointcloudregistrationusinginvariantcom- computervision,13(2):119–152,1994. 1
patibility. IEEERoboticsandAutomationLetters,7(1):143–
[73] Yinqiang Zheng, Shigeki Sugimoto, and Masatoshi Oku-
150,2021. 2
tomi. Deterministicallymaximizingfeasiblesubsystemfor
[59] ZacharyTeedandJiaDeng.Raft-3d:Sceneflowusingrigid- robust model fitting with unit norm constraint. In CVPR
motionembeddings. InProceedingsoftheIEEE/CVFcon- 2011,pages1825–1832.IEEE,2011. 2
ference on computer vision and pattern recognition, pages
[74] ChengliangZhong,PeixingYou,XiaoxueChen,HaoZhao,
8375–8384,2021. 1
FuchunSun,GuyueZhou,XiaodongMu,ChuangGan,and
[60] BeiwenTian,LiyiLuo,HaoZhao,andGuyueZhou. Vibus:
Wenbing Huang. Snake: Shape-aware neural 3d keypoint
Data-efficient 3d scene parsing with viewpoint bottleneck
field. AdvancesinNeuralInformationProcessingSystems,
anduncertainty-spectrummodeling. ISPRSJournalofPho-
35:7052–7064,2022. 1
togrammetryandRemoteSensing,194:302–318,2022. 1
[75] Chengliang Zhong, Yuhang Zheng, Yupeng Zheng, Hao
[61] Ben Tordoff and David W Murray. Guided sampling
Zhao,LiYi,XiaodongMu,LingWang,PengfeiLi,Guyue
and consensus for motion estimation. In Computer Vi-
Zhou, ChaoYang, etal. 3dimplicittransporterfortempo-
sion—ECCV2002: 7thEuropeanConferenceonComputer
rally consistent keypoint discovery. In Proceedings of the
Vision Copenhagen, Denmark, May 28–31, 2002 Proceed-
IEEE/CVF International Conference on Computer Vision,
ings,PartI7,pages82–96.Springer,2002. 2
pages3869–3880,2023. 1
[62] PhilipH.S.Torr. Bayesianmodelestimationandselection
[76] Qian-YiZhou,JaesikPark,andVladlenKoltun. Fastglobal
forepipolargeometryandgenericmanifoldfitting. Interna-
registration. In Computer Vision–ECCV 2016: 14th Euro-
tionalJournalofComputerVision,50:35–61,2002. 2
peanConference,Amsterdam,TheNetherlands,October11-
[63] DuncanJWatts. Networks,dynamics,andthesmall-world
14,2016,Proceedings,PartII14,pages766–782.Springer,
phenomenon. AmericanJournalofsociology, 105(2):493–
2016. 2,6
527,1999. 4
[64] XinWu,HaoZhao,ShunkaiLi,YingdianCao,andHongbin
Zha. Sc-wls:Towardsinterpretablefeed-forwardcamerare-
localization. InEuropeanConferenceonComputerVision,
pages585–601.Springer,2022. 1
[65] Heng Yang, Pasquale Antonante, Vasileios Tzoumas, and
Luca Carlone. Graduated non-convexity for robust spatial
perception: Fromnon-minimalsolverstoglobaloutlierre-
jection. IEEERoboticsandAutomationLetters,5(2):1127–
1134,2020. 2
[66] Heng Yang, Jingnan Shi, and Luca Carlone. Teaser: Fast
andcertifiablepointcloudregistration. IEEETransactions
onRobotics,37(2):314–333,2020. 2,6,7
[67] Jiaolong Yang, Hongdong Li, Dylan Campbell, and Yunde
Jia. Go-icp: A globally optimal solution to 3d icp point-
setregistration. IEEEtransactionsonpatternanalysisand
machineintelligence,38(11):2241–2254,2015. 2
[68] JiaqiYang,ZhiqiangHuang,SiwenQuan,ZhaoshuaiQi,and
Yanning Zhang. Sac-cot: Sample consensus by sampling
compatibilitytrianglesingraphsfor3-dpointcloudregistra-
tion.IEEETransactionsonGeoscienceandRemoteSensing,
60:1–15,2021. 2,6
[69] HaoYu,FuLi,MahdiSaleh,BenjaminBusam,andSlobo-
dan Ilic. Cofinet: Reliable coarse-to-fine correspondencesA.AppendixSection in Ps and Pt respectively. These correspondences can be
modelled as a graph, G, where each node denotes a corre-
A.1.GraphSignalProcessingtheory
spondence,andtheedgeweightsmeasurethecompatibility
Graph Shift A graph G can be represented in betweennodes. Ourapproachaimstodecreasethesizeof
the form of (V,A), where V is the set of nodes the correspondence graph G and employ the sampled cor-
{v ,v ,...,v },N = |V| and A ∈ CN×N is the respondencesforcomputingthe6-DoFposetransformation
0 1 N−1
graph shift, or the weighted adjacency matrix. A graph betweenPs andPt, insteadofutilisingtheoriginalcorre-
shift can reflect the connections of the graph for the edge spondencesetC.
weight is a quantitative representation between nodes.
Whenagraphshiftactsonagraphsignal, itcanrepresent A.3.CorrespondenceGeneration
the diffusion of the graph signal. A graph shift is usually
Though our focus is not primarily on the creation of cor-
normalizedforproperscaling,ensuring||A|| =1.
spec respondences,itiscrucialtounderstandhowtheyaregen-
erated due to our approach’s reliance on them. As such,
GraphSignal GivenagraphG = (V,A),agraphsignal we include this section. Point cloud descriptors aim to
onthisgraphcanbeseenasamapassigningeachnodev i characterise local geometry. Hand-crafted designs[51] or
with a value x i ∈ C. If the order of the nodes is fixed, deeplearningmethods[17][1][69][30]havebeenemployed
thenthegraphsignalisdefinedasaN dimensionalvector inpreviousstudiestocreatedescriptors. Aslongaspoint-
x=(x 1,x 2,...,x N). wisedescriptorsaredefined, thematchabilityscorecanbe
calculatedtoformcorrespondences.
Graph Fourier Transform In general, a fourier trans- We denote the descriptor for point x as f . Then the
i i
form is the expansion of a signal on a set of bases. When matchabilityscoreisdefinedusingL 2euclideandistance:
performing graph fourier tansform, the signal refers to the
graph signal and the bases are the eigenbasis of the graph
d(x ,x )=||f −f ||
i j i j 2
shift,ortheJordaneigenbasisifacompleteeigenbasisisnot
available.Tobespecific,agraphshiftAiseig-decomposed
Then for each point x , find the corresponding point
i
intoA = VΛV−1. Theeigenvaluesrepresentthefrequen-
x with the highest matchability score, namely the near-
ciesonthegraph.Thefouriertransformofagraphsignalx,
ki
estneighbor. Nowacorrespondenceisgenerated:
therefore,isdefinedasxˆ=V−1xandtheinversetransform
is x = Vxˆ. xˆ describes the content of different frequency
componentsinthegraphsignalx. c i =(x i,x ki)
A.4.GraphConstruction
Graph Filtering A graph filter is a type of system that
accepts a graph signal as input and then generates another As show in Fig. 2, given a set of input correspon-
graph signal as output. If the graph signal is described as dences C, we first construct a compatibility graph. Each
x∈Cn,thenanymatrixA∈Cn×n canbeseenasagraph node of the graph is a correspondence denoted as c =
i
filter and Ax ∈ Cn is the output signal. For instance, a (x ,y ,z ,u ,v ,w ). We further denote ps = (x ,y ,z )
i i i i i i i i i i
graph shift can be a graph filter, replacing the signal value andpt = (u ,y ,z ). Ascanbeseen,c istupleofsixele-
i i i i i
atanodewithaweightedlinearcombinationofvaluesatits ments,composedofcoordinatesofthesourcepointps and
i
neighbors. In fact, every linear, shift-invariant graph filter thetargetpointpt.Wefirstdefinethedistancebetweencor-
i (cid:12) (cid:12)
canbeformulatedasapolynomialinthegraphshift (cid:12) (cid:12)
respondencesasS dist(c i,c j) = (cid:12) (cid:12)||ps
i
−ps j||−||pt
i
−pt j||(cid:12) (cid:12).
l= (cid:88)L−1 Withthis,wecomputethepair-wisecompatibilitybetween
H= h A
l l correspondences,ortheedgeweightinthecorrespondence
l=0 graph.
whereHisthegraphfilterrepresentedwiththegraphshift
A.h isthecoefficientandListhelengthofthegraphfilter.
(cid:40)
1−
Sdist(ci,cj)2
1−
Sdist(ci,cj)2
>t
l W = 2×d2 2×d2 (7)
ij cmp cmp
0 otherwise
A.2.ProblemFormulation
Fortwoinputpointclouds,PsandPt,acorrespondenceset where d and t are hyperparameters. We then define
cmp
C is created using either hand-crafted or learned descrip- the adjacency matrix W of the graph as: W =
SOG SOG
tors. Each correspondence, represented by c ∈ C, con- W ⊙(W ×W).Inthisway,webuildagraphonthegiven
sistsofapairofpoints(ps,pt),whereps andpt arepoints correspondencesetC. AndwedenotethisgraphasG .
corrA.5.OptimalityProof Bysettingitsderivativetozeroandwiththecomplemen-
taryslackness,wehavethefinalresult.
We claim our stochastic method is an approximation to an
optimal sample operator. To prove this, we first define the µ π =0,π = | √|f i(X)|| 2 (14)
i i i
objectfunction λ+µ
i
A.6.ExperimentalSetup
minE ||SΨTΨf(X)−f(X)||2 (8)
Ψ∼π 2
π
Datasets. We consider three main datasets, i.e, the out-
whereΨisthesampleoperatorrelyingonπandSΨT isthe door dataset KITTI[26], the indoor dataset 3DMatch[70]
interpolation recovery operator. f is the LapLacian high- and its low-overlap version 3DLoMatch[30]. For KITTI,
pass filter we use and X is our generalized degree signal. we follow the preprocess schedule of previous work[2]
Theoptimizationproblemisthenformulatedas [13][71] and obtain a test set of 555 pairs of point clouds.
3DMatchisascene-scaleindoordatasetand3DLoMatchis
minE Ψ∼π||SΨTΨf(X)−f(X)||2
2
itssubsetwithoverlapraterangesfrom10%to30%,bring-
π
(cid:88) (9) inggreaterchallengesforaccurateregistration.
s.t. π =1,π >0
i
Evaluation Criteria. We follow the common evaluation
Tosolvethis,weuseaLagrangefunction
criteria in 3D registration, i.e, the rotation error (RE), the
L(π ,λ,µ) translation error (TE) and the recall or success rate (RR).
i
REmeasurestheangulardifferencebetweentheestimated
=E ||SΨTΨf(X)−f(X)||2
Ψ∼π 2 rotation matrix and the ground truth or reference rotation
(cid:88) (cid:88)
+λ( π −1)+ µ π matrix. TEiscomputedastheeuclideandistancebetween
i i i
(10) the estimated translation vector and the ground-truth, and
=||E (SΨTΨf(X))−f(X)||2+
Ψ∼π 2 is given in centimetres. By referring to the settings in
E Ψ∼π||SΨTΨf(X)−E Ψ∼π(SΨTΨf(X))||2 2+ [18], registration is considered successful when RE≤ 15◦
(cid:88) (cid:88) andTE≤30cmon3DMatchand3DLoMatchdatasets,and
+λ( π −1)+ µ π
i i i RE≤ 5◦ andTE≤ 60cmontheKITTIdataset. RRisthen
definedasthesuccessratioofallpointcloudpairs.
Thefirstitemiszero,provedsimplyby
E Ψ∼π(SΨTΨf(X)) i Implementation Details. Our FastMAC consists of a
=E ( (cid:88) S f (X)δ ) sampling process implemented in PyTorch for cuda
M MjMj Mj Mj,i
computation and then the original Maximal Clique
Mj∈M
(11) Registration[71] process based on C++. Our method ac-
(cid:88) 1
=M f (X)π δ cepts initial correspondences as input, which are gener-
Mπ k k k,i
k atedusingFastPointFeaturesHistograms(FPFH)[51]and
k
=f (X) FullyConvolutionalGeometricFeatures(FCGF)[17]asba-
i
sic descriptors for both KITTI and 3DMatch&3DloMatch.
whereMisthesamplesetwithM tobeitssize. Hyperparameters like d and t mentioned in Sec. 3 are
cmp
Theseconditemcanbededucedto set to default values, i.e, 0.1 and 0.999 respectively. The
Maximal Clique Registration process remains exactly the
E ||(SΨTΨf(X)) −E (SΨTΨf(X)) ||2
Ψ∼π i Ψ∼π i 2 same implemented in [71], with the same parameter value
(cid:88)
=E ( S S f (X)Tf (X) settings. All experiments were implemented with an Intel
M MjMj M j′M j′ Mj M j′
Mj,M j′∈M i5-13600KFCPUandasingleNVIDIARTX4070ti. When
comparingwithbaselinemethods, weusetheirdefaultpa-
δ δ )
Mj,i M j′,i
rametersintheirreleasedcodetoensurefairness.
=M2(cid:88)f k(X M)T 2πf
k
2(X)
π kδ k,i−f i(X)Tf i(X) A.7.AdditionalExperiments
k k
The following table demonstrates the extension result of
1
=(
π
−1)f i(X)Tf i(X) our Time-performance Trade-off experiments. Results for
i (12) RE and TE are further shown. FastMAC performs better
Therefore,theLagrangefunctioncanbewrittenas thanallpreviousmethodswhensampleratiois50%. With
lowersamplerate,RRandTEstillremaincompetitive,with
(cid:88)
(
1
−1)||f
(X)||2++λ((cid:88)
π
−1)+(cid:88)
µ π (13)
time loss decreasing dramatically, indicating its potential
π i i 2 i i i forreal-timeapplication.
iMethods ratio RR(%) RE(◦) TE(cm) Time(ms)
RANSAC1K[23] 56.58 1.74 33.12 19.9
RANSAC10K[23] 88.47 1.15 25.33 158.4
RANSAC100K[23] 94.77 0.77 17.83 1549.7
DGR[18] 95.14 0.43 23.28 330.1
PointDSC[2] 100 96.40 0.61 13.42 131.0
PointDSC(50k)[2] 96.40 0.51 11.53 722.4
PointDSC(icp)[2] 96.76 0.51 11.20 130.5
SC2-PCR[13] 97.12 0.41 9.71 851.1
MAC[71] 97.25 0.36 8.00 573.0
50 97.84 0.36 7.98 114.4
20 97.48 0.38 8.20 28.1
FastMAC 10 97.30 0.43 8.70 18.2
5 97.12 0.52 9.92 16.1
1 71.56 1.02 15.24 15.5
Table 6. Comparison on RR, RE and TE with SOTA methods
on the KITTI dataset with FCGF descriptor. The best results
are marked in bold. RANSAC − k denotes RANSAC with
k iterations. PointDSC(50K): PointDSC with 50k iterations of
RANSAC.PointDSC(icp):withicprefinement.
Combining Diverse Information for Coordinated Action:
Stochastic Bandit Algorithms for Heterogeneous Agents
LuciaGordona,*,EstherRolfaandMilindTambea
aHarvardUniversity
ORCID(LuciaGordon): https://orcid.org/0000-0003-3219-6960,ORCID(EstherRolf):
https://orcid.org/0000-0001-5066-8656,ORCID(MilindTambe): https://orcid.org/0000-0003-3296-3672
Abstract. Stochasticmulti-agentmulti-armedbanditstypicallyassume uponpullinganarmgiventhatitsstateis1.Inthisway,theutilityofthe
thattherewardsfromeacharmfollowafixeddistribution,regardlessof agents’actionsisafunctionoftheirsensitivityaswellasthearmmean.
whichagentpullsthearm.However,inmanyreal-worldsettings,rewards Several key ideas help us tackle the core challenges of sequential
candependonthesensitivityofeachagenttotheirenvironment.Inmedical decision-makingwithmultipleagentswithheterogeneoussensitivities
screening,diseasedetectionratescanvarybytesttype;inpreference to their environment. First, we address the combinatorial challenge
matching,rewardscandependonuserpreferences;andinenvironmental of the many ways of allocating agents to arms by decomposing our
sensing,observationqualitycanvaryacrosssensors.Sincepastworkdoes combinatorialproblemintolearningthemeansoftheindividualarms.
notspecifyhowtoallocateagentsofheterogeneousbutknownsensitivity Second,weaddressthelearningchallengebycombiningrewardsacross
ofthesetypesinastochasticbanditsetting,weintroduceaUCB-style agentsofvaryingsensitivitytospeeduplearninginasensitivity-aware
algorithm, MIN-WIDTH, which aggregates information from diverse manner.Third,weaddresstheproblemofhowtomatchheterogeneous
agents.Indoingso,weaddressthejointchallengesof(i)aggregating agentswitharmsbyassigningthehighest-sensitivityagentstothearms
therewards,whichfollowdifferentdistributionsforeachagent-armpair, withthehighestUCBs,whichweexperimentallyshowisaneffective
and(ii)coordinatingtheassignmentsofagentstoarms.MIN-WIDTH strategy.Incontrast,applyingpastworktoourproblemwithoutthese
facilitatesefficientcollaborationamongheterogeneousagents,exploiting insights would either naively combine all the agents’ rewards and
theknownstructureintheagents’rewardfunctionstoweighttheirrewards ignoretheirsensitivities[5]orslowlylearntheoptimalassignmentsby
accordingly.WeanalyzetheregretofMIN-WIDTHandconductpseudo- approachingtheproblematthecoarse,super-armlevel[2].
syntheticandfullysyntheticexperimentstostudytheperformanceof We introduce the MIN-WIDTH algorithm designed for this new
differentlevelsofinformationsharing.Ourresultsconfirmthatthegains problem (§5). For each arm, MIN-WIDTH combines all the agents’
tomodelingagentheterogeneitytendtobegreaterwhenthesensitivities rewards to generate a mean estimator with the tightest UCB, which
aremorevariedacrossagents,whilecombiningmoreinformationdoes is nontrivial since rewards are drawn from different distributions for
(cid:112) notalwaysimproveperformance. eachagent-armpair.Wederiveaninstance-independentO( Tlog(T))
regret upper bound for the MIN-WIDTH algorithm, where T is the
timehorizonandthereareadditionalfactorsforthenumbersofagents
1 Introduction
and their sensitivities (Theorem 2). We also evaluate MIN-WIDTH
Thesettingofstochasticmulti-agentmulti-armedbandits(MAB)[15, throughpseudo-syntheticexperimentswithrealisticparametervaluesfor
14,19]ischaracterizedbymultipleagentstakingactionssimultaneously diversedomainsincludingCOVIDtestallocation,hotelrecommendation,
ineachtimestep.Thissettingservesasanaturalmodelfordiversedo- andpoachingpreventionalongwithfullysyntheticexperiments(§8).
mains,fromCOVIDtestallocation[3]topreferencematching[8,21] To compare algorithms with different levels of information sharing,
andpoachingprevention[22,23].Thesereal-worldproblemsinvolve weintroducetwosensitivity-awarebaselinesthatweevaluateagainst
unknowncharacteristicsabouttheenvironmentthatarelearnedonline MIN-WIDTH.WefindthatMIN-WIDTHoutperformsclassicalbaseline
whiletheplannerfiguresouttheoptimalactionforeachagent.Theresult- algorithms(CUCB[5]andUCB[2])notdesignedforheterogeneous
ingexplore-exploittradeofflendsitselfwelltoUCB-stylealgorithms[2], agents as well as our sensitivity-aware baselines in many settings.
whichestimateunknownquantitiesoptimisticallywithanupperconfi- Moreover,weshowexperimentallythattheperformanceofMIN-WIDTH
dencebound(UCB)inanefforttomaximizecumulativerewardovertime. isrobusttohavingonlyapproximateknowledgeoftheagentsensitivities.
We introduce a new stochastic MAB problem wherein a planner
specifiesactionsforagentsofheterogeneousbutknownsensitivitiesto
2 MotivatingDomains
theirunknownenvironment.The“environment”comprisesasetofarms,
eachofwhichtakesonastateof0or1ateachtimestepfollowinga Oursettingofheterogeneousagentswithknownsensitivitiesismotivated
Bernoullidistribution,whichmodelsabinaryoutcomeasinSolanki byadiverserangeofapplicationdomains,highlightedbytheexamples
etal.[17]andXuetal.[22].ThemeanoftheBernoulliisanunknown below.Byexplicitlyincorporatingagentheterogeneityandinformation-
parameterthatmustbelearnedonlinebytheagents.Theagentsdiffer sharing,weintroduceamorenaturalmodelforthesedomains.
intheirsensitivity,whichistheirprobabilityofreceivingarewardof1
COVIDTestAllocation Considertheproblemofallocatingalimited
∗CorrespondingAuthor.Email:luciagordon@g.harvard.edu numberofCOVIDtestsofvaryingsensitivityamongfloorsofacollege
4202
guA
6
]AM.sc[
1v50430.8042:viXradormwithunknownvirusprevalencetomaximizedetectionofinfectedin- observed),whereasweoperateinthesemi-banditfeedbacksetting(the
dividuals.Differentfloorsinadorm,whichserveasour“arms,”willlikely rewardfromeachpullisobserved)andalsohaveheterogeneousagents.
havedifferentprevalenceratesofthevirus.Thetwoprimarytypesoftests Existingmulti-agentbanditpapersdifferwidelyintheirdefinitionof
todetectCOVIDarePCR(verysensitive)andantigen(lesssensitive) agentheterogeneity.Someworksconsideragentswithaccesstoonlya
tests,whichserveas“agents”inourmodel.Duetolimitedavailability, subsetofthearms[24],differingbutknowncommunicationabilities[11],
supposeacollegeonlyhasenoughsupplytotestonestudentoneach orvaryinguserpreferences[8,21].Thelatterissimilartoourdefinition,
floorpertimestep.Thus,whenwepullasuper-arm,wedistributetests butintheircasethearmcontextisknownandtheuserpreferencesare
(theagents)amongfloors(thearms)andobservethetestresults.Bastani unknown,whereaswehaveunknownarmmeansbutknownsensitivities.
etal.[3]considerasimilarsetup,developingaMABsystemforairport Federatedcombinatorialbandits[17]alsohaveheterogeneousagents,
COVIDtesting,buttheydonotaccountforvaryingtestsensitivities. buttheiragentsoperateinacompetitiveenvironmentandaresubjectto
privacyconstraints,whereasinoursettingtheagentsarecollaborating
HotelRecommendation Considertheproblemofmatchingcustomers
andthereisnocosttotheircommunication.
with different preferences to hotels with limited space in order to
Ournotionofsensitivityisinspiredbypastworkthatutilizessensor
maximize customer satisfaction, a task performed by websites such
modelstocaptureimperfectobservability.InXuetal.[22],theagentsdo
asBooking.com.Hotels,whichareour“arms,”differinfeaturessuch
notobservethetruestateofeacharm,thoughthemoreefforttheyexert,
as cleanliness, service, etc., which may not be known, especially for
themorereliabletheirobservationsbecome.Theiralgorithm,however,
newhotels.Customers,whichserveasour“agents,”varyinhowmuch
assumeseffortcanbespecifiedanddistributedineachtimestep,whereas
thesefeaturesmattertothem,informationthatbookingplatformscan
ouragentsensitivitiesarefixedinadvance.Rolfetal.[13]modelasingle
requestinapre-recommendationsurvey.Forinstance,onecustomermay
sensortryingtopickouttheenvironmentpointwiththestrongestsignal
valuecleanlinessaboveotherfeaturesandalwaysbesatisfiedwiththeir
onaveragegivenobservationsthatincludecontributionsfromallpoints
stayifthehotelwasclean.Anothercustomermaycareequallyabout
butaremoresensitivetothosenearby.Unlikethiswork,wehavemultiple
cleanlinessandstafffriendliness,soevenifthehoteliscleantheywillnot
sensors,andweassumetherewardsfromdistinctarmsareindependent.
besatisfiedifthestaffarenotveryresponsive.Assumingspaceinhotels
Pastworkhasexploredtheconsequencesofagentcommunication
islimitedandsomecustomerwillhavetobematchedwithahotelthat
indifferentsettings.InShietal.[16],multipleagentscanbeassigned
tendstobelessclean,wemaximizeoverallsatisfactionbymatchingthis
to the same arm of a MAB, which results in a collision that can be
lattercustomerwiththelesscleanhotelandtheformercustomerwith
usedtotransmitinformationbetweenagents.Weassumeeachagent
thecleanerhotelonaverage.Asimilarsettinghasbeenmodeledusing
pulls a distinct arm, so our agents cannot communicate in this way.
contextualbanditsinWanigasekaraetal.[21].However,unliketheir
InMadhushaniandLeonard[11],theagentsobservetheactionsand
algorithmwecombinedatafrompost-staycleanlinessreviewsacross
rewardsoftheirneighborswithsomeknownprobability,wheretheagents
customers with different preferences to better match either the same
areheterogeneousintermsoftheir“sociability,”sosomemaybemore
customersornewoneswithsimilarpreferencesinfuturetimesteps.
likelytoobservetheirneighborsthanothers.Ouragents’heterogeneityis
unrelatedtothewayinwhichinformationissharedamongthem.Taylor
PoachingPrevention Considertheproblemofmaximizingthedetec-
etal.[18]consideramulti-agentexplore-exploitoptimizationproblem
tionofanimaltrapsbyplanningpatrolsforrangerswithdifferentdetection
anddemonstratetheuncertaintypenaltyphenomenon,whereinincreased
ratesinaprotectedareasuchasanationalpark.Poachershidesnaresto
teamwork under uncertainty can degrade performance relative to the
trapanimals,andrangerspatroltheparkforillegalactivityandremove
agentsactingalone.UnliketheirsettingandtheoneinCesa-Bianchietal.
anysnarestheyfind,whichcanbemodeledasastochasticbanditproblem
[4],ourproblemhasnointrinsicspatialnature.
[22].Differentpartsofthepark,whichserveasour“arms,”aremoreor
lesslikelytocontainsnaresdependingontheiranimaldensity,accessibil-
ity,etc.,butthepoachingratesacrossaparkareoftenunknownduetothe 4 ProblemStatement
vastnessoftheareas.Rangers,the“agents,”varyintermsoftheirexpertise,
tools,andvehicles,givingthemvaryingsnaredetectionrates,or“sensi- We introduce a sequential decision-making problem in which a set
tivities,”atypeofreal-worldheterogeneitythathasnotbeenpreviously of heterogeneous agents are allocated among a set of arms that
modeled.Sincetherangersareallpatrollingthesamepark,wecombine yield stochastic rewards. There are A agents A = {a}A a=1, N arms
theirobservationstospeedupourlearningofpoachinghotspotsandopti-
N ={n}N n=1,andT timestepsT ={t}T t=1.Thestateofarmnat
mizeourassignmentsforrangersinthenextroundofpatrols,accounting
timetisarandomvariableX t,n∼Bern(µ n),soX t,n∈{0,1}.The
fortherangers’differingpartialobservabilitiesinsnaredetection. agents’ heterogeneity is captured in their “sensitivity,” a scalar value
associatedwitheachagent.Wedenotethesetofagentsensitivitiesby
S={s }A ,wheres representstheprobabilityagentareceivesa
a a=1 a
3 RelatedWork rewardof1conditionalonthetruestateofthearmbeing1.Thus,the
rewardY obtainedwhenpullingarmnisarandomvariablethat
t,a,n
Aueretal.[2]introducetheUCBalgorithmforthestochasticbandit dependsonboththeagentawhopullsitandthearm’smean:
problemthatpullsthehighest-UCBarmineverytimestep.Audibertetal.
Y ∼Bern(s µ ). (1)
[1]introducetheUCB-ValgorithmthatbuildsonUCBbyincorporating t,a,n a n
arms’empiricalvariances.Neitherofthesemodelmultipleagents.Gai
By construction, s = P[Y = 1|X = 1], and in our model,
etal.[7]extendtheUCBalgorithmtothecombinatorialsettingwhere a t,a,n t,n
P[Y =0|X =0]=1.
multiplearmsarepulledineachtimestepwithlinearrewardfunctions. t,a,n t,n
Ateachtimestep,theplannerselectsasuper-armassigningeachagent
Chen et al. [5] introduce an algorithm for possibly unknown reward
N!
functions.Bothassumetherewardobtainedfrompullinganygivenarmis toadistinctarm.Thesuper-armischosenfromthesetF={f}(N−A)!,
f=1
ani.i.d.drawfromafixeddistribution,anassumptionthatdoesnothold wheref :A→N suchthatf(a)≠ f(a′)ifa≠ a′.Thesuper-arm
inourproblem.RejwanandMansour[12]considerthecombinatorial selectedattimetisdenotedf,andsof(a)isthearmtowhichagent
t t
banditsettingwithfull-banditfeedback(onlythesumoftherewardsis aisassignedattimet.Wekeeptrackofthenumberoftimeseacharmhasbeenpulledbyeachagent.Let Algorithm1MIN-WIDTHAlgorithm
c t,a,n=(cid:80)t τ=11 fτ(a)=n (2) 1: U(cid:103)CB 0←[∞,...,∞](lengthN)
2: ranked_agents←flip(argsort(sensitivities))
bethenumberoftimesarmnhasbeenpulledbyagentathroughtime
3: fortinrange(1,T+1)do
tand
4: f←[−1,...,−1](A)
c
=(cid:80)A
c (3)
t,n a=1 t,a,n 5: unassigned_arms←(0,...,N−1)
bethetotalnumberoftimesarmnhasbeenpulledthroughtimetby 6: forainranked_agentsdo
anyagent.Basedonthese,letusalsodefine 7: UCBs←U(cid:103)CB t−1[unassigned_arms]
8: n←unassigned_arms[argmax(UCBs)]
T a,n={t∈T|c t,a,n>0} (4) 9: f[a]←n
10: unassigned_arms.remove(n)
asthesetoftimesagentahaspulledarmnatleastonceand
11: pullsuper-armfandget{Y t,a,ft(a)} a∈A
12: forninrange(N)do
T ={t∈T|c >0} (5)
n t,n
13: U(cid:103)CB t[n]←updaterulegivenbyEquation11
asthesetoftimesforwhicharmnhasbeenpulledatleastoncebyany
agent. andsetsomeupperconfidencebounds{UCB n=µˆ n+ϵ n} n∈N onthem,
Thetotalrewardcollectedbypullingsuper-armfisasumoverthein- whereϵ nisthewidthoftheconfidenceintervalaroundourestimateµˆ nof
dividualagentrewards:r f=(cid:80)A a=1Y t,a,f(a).Theexpectedrewardisthen µ n.InthestandardUCBalgorithm,theoptimalactionistopullthearm
withthehighestmean,andsincethatisunknown,thealgorithminstead
r f=E[r f]=(cid:80)A a=1E[Y t,a,f(a)]=(cid:80)A a=1s aµ f(a). pullsthearmwiththehighestUCB[2].Analogously,inoursetting,the
optimalactionistomatchtheith-bestagentwiththearmwiththeith-
Wedefinetheoptimalsuper-armf⋆ tobetheonethatmaximizesthe
highestmean,butsincethemeansareunknown,weinsteadmatchthe
expectedreward:
ith-bestagentwiththearmwiththeith-highestUCB.Anotherwayto
f⋆=argmax r =argmax (cid:80)A s µ . (6) motivatethisistoconsidertheinfinite-datasetting,inwhichtheUCBsare
f∈F f f∈F a=1 a f(a) equaltothetruearmmeans.Inthatcase,tomaximizeourexpectedreward
The cumulative regret at time T captures how poor the super-arms wemustmatchthehighest-sensitivityagenttothehighest-meanarm.In
selectedatthetimestepselapsedsofarperformcomparedtotheoptimal thefinite-datasetting,weoptimisticallyestimatethemeanswiththeUCBs
super-arminexpectation.Inotherwords,wemeasurehowmuchworse (whichconvergetothemeanswithincreasingamountsofdata),which
thecumulativeexpectedrewardisgivenasequenceofagent-armassign- iswhywematchthehighest-sensitivityagentwiththehighest-UCBarm.
mentsrelativetothebestitcouldbegiventheagentsensitivitiesathand.
TheobjectiveistominimizethecumulativeregretattimeT,givenby 5.3 UpdateRule
R T=(cid:80)T t=1(cid:80)A a=1s a(cid:0) µ f⋆(a)−µ ft(a)(cid:1) . (7) Ateachtimestept,theplannerusesalltherewardscollectedsofarto
generateanewUCB foreacharmn,asderivedin§6.Inparticular,
t,n
theplannerconstructsanempiricalestimatorµˆ forthemeanofeach
5 MIN-WIDTHAlgorithm t,n
armthatcombinesalltheagents’rewardswhileaccountingfortheir
5.1 AlgorithmStructure heterogeneitysoastominimizethewidthoftheconfidenceintervalϵ
t,n
aroundthatestimator.Theempiricalestimatorofthemeanofarmnat
We introduce MIN-WIDTH, a UCB-style algorithm for assigning
timet∈T isgivenby
heterogeneous agents to stationary stochastic arms with Bernoulli

rewards.Weassumeacentralizedplannerthatknowsthesensitivities t∈/T
n
0.5
o tif ma ell stt eh pe .Mag Ie Nn -ts Wa In Dd THc ,oo or ud tli in na et des inth Aei lr goa rs is ti hg mnm 1e ,n rt evt oo lva er sm as roin une da ac nh µˆ t,n= t∈T
n
(cid:80)A a=1sa (cid:80)(cid:80)
A
bt τ == 11 s1 b2fτ ct( ,a b) ,= nnYτ,a,n. (8)
N-length vector of UCBs denoted by U(cid:103)CB, where U(cid:103)CB
t
represents
Thewidthoftheconfidenceintervalonµ attimet∈T is
the UCBs the planner uses to match each agent a with an arm n at n
(cid:115)
timet+1.Ineachtimestep1≤t≤T,theagentsareassignedtoarms ln(2NG(T,A)/δ)
sequentiallyindescendingorderbysensitivity(lines6-10)sothatthe ϵ t,n= 2(cid:80)A s 2c (9)
highest-sensitivityagentisassignedtothearmwiththehighestU(cid:103)CB t−1, a=1 a t,a,n
thenext-highest-sensitivityagentisthenassignedtothearmwiththe for
highestU(cid:103)CB t−1outofthoseremainingunselected,andsoonuntilallthe G(T,A)=(cid:88)T (cid:32) t+A−1(cid:33)
<(T+1)A. (10)
agentshavebeenassignedtodistinctarms.Thesuper-armcorresponding A−1
to this assignment is then pulled and each agent gets some reward t=1
TheUCBonthemeanofarmnattimet∈T is
Y t,a,ft(a)(line11).Next,theUCBsareupdatedU(cid:103)CB t−1[n]→U(cid:103)CB t[n]
foreveryarmn(line13)accordingtoEquation11. UCB =µˆ +ϵ (11)
t,n t,n t,n
5.2 AgentAllocationStrategy
andisusedastheU(cid:103)CB t[n]inline13:U(cid:103)CB t[n]=UCB t,n.Notethatthe
algorithmreturnsafiniteU(cid:103)CB t[n]afterasinglepullofarmnbyany
Ouragentallocationstrategy(lines6-10)isinspiredbythedefinitionof agent.Thedistributionoftherewardscanvarygreatlydependingonthe
theoptimalsuper-arminEquation6:f⋆assignstheith-highest-sensitivity sensitivityoftheagentwhocollectedthem,butbecausetheplannerknows
agenttotheith-highest-meanarm.Inpractice,wedonotknowthetrue alltheagentsensitivities,theycanharnessthatinformationtoappropri-
means{µ n} n∈N.Instead,wecanestimatethemwithsome{µˆ n} n∈N atelyweighttherewardsfromdifferentagentsingeneratingasharedUCB.6 TheoreticalResults which results in w = sa , which holds for any agent
Cn,a,n (cid:80)A b=1sb2cb,n
awithc >0.Sincew =0foragentswithc =0,weget
WeprovideanalyticalresultsfortheMIN-WIDTHalgorithmintroduced a,n Cn,a,n a,n
Equation13.
in§5,withcompleteproofsinAppendixA.Incorporatingalltheagents’
rewardstogenerateasharedUCBforeacharmisacomplexproblem
Next,inTheorem1,weshowthatwecanusetheweightsderivedin
duetotheagents’heterogeneity.Naively,onemaythinkwecouldsimply
Proposition1toconstructanempiricalestimatorforthemeanofeach
divideeachrewardforagivenarmbythesensitivityoftheagentwho
arm,whosedeviationfromthetruemeanweboundwithhighprobability.
collecteditandapplytheoriginalUCBalgorithmtothissequence.Thisis
Thisboundinvolvesthechallengeofcountingthenumberofpossible
invalid,however,becausewhiletheserescaledrewardswillhaveidentical
pullsofeacharmbyeachagent.
means, they will still have different variances. The UCB algorithm
assumestherewardsfromagivenarmarei.i.d.andhencewouldnot Theorem 1. (MIN-WIDTH Concentration Bound). Suppose the
applytotheserescaledrewards.Toresolvethis,inProposition1wetake empiricalestimatorofthemeanofarmnattimet∈T isgivenby
amoregeneralapproachbytreatingthisasanoptimizationproblem Equation8.Thenforϵ giveninEquation9,µˆ satisfies
t,n t,n
whereweoptimizeoverweightsontheagents’rewardstogetthetightest
confidenceintervalaroundthearmmeanestimator. ∀δ∈(0,1),P[∀n∈N,t∈T,|µˆ t,n−µ n|<ϵ t,n]>1−δ. (15)
Proposition1. (MIN-WIDTH WeightsDerivation).Supposeagenta Proof. Applying a union bound over the arms to Equation 14 gives
pullsarmnafixednumberoftimes,anumberwedenotec a,n,where ∀δ∈(0,1),
therewardfromeachpullisY ∼Bern(s µ ).LetC ={c }A
i,a,n a n n a,n a=1  (cid:118) 
containthec a,nforeveryagent.LetD Cn,nbetheweightedsumofthe (cid:117) (cid:117)ln(2N)(cid:88)A
independentrewardscollectedbyalltheagentsfromarmn,expressed P ∀n∈N,|D Cn,n−µ n|<(cid:116) 2δ w Cn,a,n2c a,n>1−δ.
intermsofweightsw Cn,a,n: a=1
(cid:88)A c (cid:88)a,n (cid:88)A c (cid:88)a,n LetHbethesetofallpossibleinstantiationsofthesetC nassumingthat
D Cn,n= w Cn,a,n Y i,a,n= w Cn,a,nY i,a,n. (12) armnhasbeenpulledatleastoncewithinatimehorizonofT,soH
a=1 i=1 a=1i=1 isasetofsets.Toapplyaunionboundoverthesesets,wedeterminethe
Then the weights w
Cn,a,n
that minimize the width of the confidence cardinalityofHusingtheconstraintsthateachelementofC nisbetween
intervalonµ ngivenby 0andT andthesumoftheelementsinC n isbetween1andT.We
denotetheresultingcardinalityG(T,A),whichwouldsimplybeT,asfor
(cid:113)
γ = ln(2/δ)(cid:80)A w 2c CUCB,ifalltheagentswereidentical.Weperformtheunionbound,use
Cn,n 2 a=1 Cn,a,n a,n
thatC ∈H∀t∈T ,andpluginforD andw ,resultingin
t,n n Ct,n,n Ct,n,a,n
undertheconstraintthattheempiricalestimatorD isunbiasedare
Cn,n
∀δ∈(0,1),P[∀n∈N,t∈T ,|µˆ −µ |<ϵ ]>1−δ.
s n t,n n t,n
w =1 × a . (13)
Cn,a,n ca,n>0 (cid:80)A s 2c
b=1 b b,n Fort∈/T n,Equation8givesµˆ t,n=0.5,andϵ t,n=∞sincec t,n=0.
Equation15followsdirectlysincethedifferencebetweenthetruemean
Proof. Sincetherewardscollectedbyacertainagentwhenpullinga
µ and0.5mustbe<∞.
certainarmarei.i.d.,weconsiderweightsonsuchsequencesofi.i.d. n
rewardsratherthanoneverysinglereward.Ifc =0,thenagentahas
a,n Finally,inTheorem2weusetheconcentrationboundontheshared
collectednorewardsforarmn,andsowesetw =0foranysuch
Cn,a,n empiricalmeanfromTheorem1toupperboundthecumulativeregret
agent.Hence,weneedtosolveforw onlyforagentswithc >0.
IfD
istobeunbiased,thenwenC en e, da, En
[D ]=µ
,whichsa e,n
tsthe
oftheMIN-WIDTHalgorithm.
Cn,n Cn,n n
constraint Theorem2. (MIN-WIDTHRegretBound).Supposeweactaccording
A
(cid:88) totheMIN-WIDTHalgorithm.Then∀δ∈(0,1),thecumulativeregret
w s c =1.
Cn,a,n a a,n attimeT isboundedby
a=1
Since w Cn,a,nY i,a,n is bounded by 0 ≤ w Cn,a,nY i,a,n ≤ w Cn,a,n, (cid:34) (cid:115) (cid:18) 2NG(T,A)(cid:19) maxS(cid:35)
Hoeffding’sinequalitygives P R <A(N−1)+2 2ANTln >1−δ.
T δ minS
 (cid:118) 
∀δ∈(0,1),P (cid:12) (cid:12)D Cn,n−µ n(cid:12) (cid:12)<(cid:117) (cid:117) (cid:116)ln(2 2/δ)(cid:88)A w Cn,a,n2c a,n>1−δ,
Proof. Weboundµ −µˆ byµ −µˆ ≤|µˆ −µ
|.Using(1 th6 e)
a=1 n t,n n t,n t,n n
(14) boundon|µˆ t,n−µ n|fromEquation15andtheUCBonthemeanof
yielding γ = (cid:113) ln(2/δ)(cid:80)A w 2c as the width of the armnattimet∈T fromEquation11gives
Cn,n 2 a=1 Cn,a,n a,n
confidenceintervalonthemeanofarmnforsomefixednumberof ∀δ∈(0,1),P[∀n∈N,t∈T,µ <UCB ]>1−δ. (17)
n t,n
pullsofeacharmbyeachagentcapturedinC .Tomakethisconfidence
n
intervalastightaspossible,wesolvefortheweightsthatminimizeγ Cn,n WesplitEquation7intotermswitht<Nandt≥N:
undertheconstraintthatD isunbiasedforanynon-randomC .We
Cn,n n
solvethisconstrainedoptimizationproblemwiththemethodofLagrange N−1 A
(cid:88)(cid:88) (cid:0) (cid:1)
multipliers,usingLagrangian R T= s a µ f⋆(a)−µ ft(a)
(cid:118) t=1a=1
L(w,λ)=(cid:117) (cid:117) (cid:116)ln(2 2/δ)(cid:88)A w Cn,b,n2c b,n+λ(cid:32) (cid:88)A w Cn,b,ns bc b,n−1(cid:33) , +(cid:88)T (cid:88)A s a(cid:0) µ f⋆(a)−µ ft(a)(cid:1) . (18)
b=1 b=1 t=Na=1Because0<µ <1∀n∈N,thedifferencebetweenthemeansofany Agenta’sUCBonthemeanofarmnattimet∈T isthen
n
twoarmsisboundedbyµ n−µ n′<1∀n,n′∈N.Weapplythisbound
tothefirstterminEquation18withn=f⋆(a)andn′=f t(a)andalso UCB t,a,n=µˆ t,a,n+ϵ t,a,n. (24)
usethefactthats ≤1∀a∈A,yielding
a
Here,eachagentisalmostoperatinginthestandardUCBsettingexcept
T A
(cid:88)(cid:88) (cid:0) (cid:1) fortheassignmenthierarchy,whichhasmoresensitiveagentspickwhich
R T<A(N−1)+ s
a
µ f⋆(a)−µ
ft(a)
. (19)
armstheywanttopullbeforelesssensitiveagents.Consequently,less
t=Na=1
sensitiveagentsmayhavetopullarmsthatdonothavethemaximum
LetR N:T bethesecondterminEquation19.UsingEquation17with UCB t,a,n.
n=f⋆(a)toboundµ f⋆(a)gives∀δ∈(0,1),
(cid:34) (cid:88)T (cid:32) (cid:88)A (cid:88)A (cid:33)(cid:35) 7.2 MIN-UCB
P R N:T< s aUCB t,f⋆(a)− s aµ
ft(a)
>1−δ. (20)
t=N a=1 a=1 TheMIN-UCBalgorithmdirectlyimprovesonthenaiveNO-SHARING
By construction, for all t the MIN-WIDTH algorithm selects a strategy.EachagentstillkeepstrackoftheirownUCBforeacharm,but
configurationfthatmaximizes(cid:80)A
s UCB : sincealltheagentUCBsonthemeanofagivenarmholdsimultaneously
a=1 a t,ft(a)
byPropositionA.2,wecantaketheminimumoftheseUCBstogeta
A A
(cid:88) (cid:88) tighterbound.ThesharedUCBforarmnattimet∈T isthen
∀t∈T, s aUCB t,f⋆(a)≤ s aUCB t,ft(a). (21)
a=1 a=1
UCB =minUCB . (25)
t,n t,a,n
We use Equation 21 in Equation 20 and plug in Equation 11 with a∈A
n=f(a),thenuseEquation15andpluginforϵ ,yielding
t t,ft(a) IncontrasttotheNO-SHARINGalgorithm,nowagentseffectivelyget
∀δ∈(0,1),P(cid:20)
R
N:T<(cid:112)
2ln(2NG(T,A)/δ)
i an nf yor am gea nti to hn aa sb po uu lt lea drm ars mth ney evh ea nve ifn ao gt ey ne tt ap hu all sed nos ti .n Tce heU aC lgB ot r,n ith< m∞ wii lf
l
matchtheith-highest-sensitivityagentwiththearmwiththeith-highest
×(cid:88)T (cid:88)A s
a
(cid:21)
>1−δ.
UCB t,n,stillgivinghigher-sensitivityagentspriority.
t=Na=1(cid:113) (cid:80)A b=1s b2c
t,b,ft(a)
ignW orh ei sle poM teI nN t- iaU llC yB vay luie al bd ls ea int fi og rh mte ar tiU onCB byth aa lwn aN ysO u-S siH nA gR thIN eG U, Cit Bst oil fl
Notethat∀a∈A,s ≤maxSand∀b∈A,s ≥minS.UsingEquation3 oneoftheagents,whichaccountsfortherewardscollectedbythatagent
a b
forn=f(a)alongwithLemmaA.6yields alone.Ifwewanttotightlyboundthemeanonagivenarm,intuitively
t
itmakessensetousealltherewardsfromthearm,notjustthoseof
(cid:34) (cid:115) (cid:18) 2NG(T,A)(cid:19) maxS(cid:35) whicheveragenthappenstohavethelowestUCBforthearm.Thisis
∀δ∈(0,1),P R <2 2ANTln >1−δ.
N:T δ minS mostevidentinasettingwheretherearetwoagentsofhighsensitivity,
suchas0.9and0.8.Perhapsthe0.9-agenthasalowerUCBforanarm,
Plugging this bound on R N:T into Equation 19 gives Equation 16, butthepullsbythe0.8-agentrepresentadditionalrewardsthatcouldbe
completingtheproof.BydefinitionofG(T,A),thetimedependencein usedtofurthershrinktheUCBthatMIN-UCBignores,motivatingour
(cid:112)
R N:T isboundedabovebyO( Tln(T)). MIN-WIDTHalgorithmthatcombinesalltheagents’rewards.
Note, however, that both NO-SHARING and MIN-UCB have AT
7 ExperimentalSetup inthelogarithm,whichissmallerthanMIN-WIDTH’sG(T,A)factor.
ThismaycauseMIN-WIDTH’sUCBstobehigherthanthoseofNO-
We perform experiments to compare the efficacy of five algorithms: SHARINGandMIN-UCBinsomecases.Asaresult,weanticipatethat
theonewedesignforthissetting,MIN-WIDTH;twosensitivity-aware MIN-WIDTHmaynotalwaysoutperformNO-SHARINGandMIN-UCB.
baselines we introduce, NO-SHARING and MIN-UCB; and two
canonicalbaselines,CUCBandUCB.1
7.3 CUCB
7.1 NO-SHARING
CUCB [5] combines all the rewards collected from each arm to
Thesimplestinformationsharingsettingisnottocombinerewardsacross generateaUCBforthearm.Thealgorithmisdesignedforsequences
agentsatall.InthisNO-SHARINGstrategy,eachagentkeepstrackof of i.i.d. rewards, which is not the case in our setting because of the
theirownUCBforeacharmrelyingsolelyontheirownrewards.The agent heterogeneity. This algorithm has no way of accounting for
empiricalestimatorofthemeanofarmnaccordingtoagentawith heterogeneousagents,sowenaivelycombineobservationsacrossagents
sensitivitys attimet∈T is inourimplementation,ignoringthefactthatthei.i.d.assumptiondoesnot
a
hold.Consequently,itmayneverbeabletolearntheoptimalagent-arm
(cid:40)
t∈/T a,n 0.5 assignments.ForCUCBweuseEquation26fortheUCBofarmnat
µˆ = (22)
t,a,n t∈T 1 (cid:80)t 1 Y . timet.Sincethisalgorithmwasnotdesignedforheterogeneousagents,
a,n sact,a,n τ=1 fτ(a)=n τ,a,n
werandomlyassignagentstothetop-UCBarmsateachtimestep.
Letthewidthofagenta’sconfidenceintervalonthemeanofarmnat
timet∈T forδ∈(0,1)be (cid:80)t (cid:80)A 1 Y
ϵ =
1(cid:115)
ln(2ANT/δ)
. (23)
UCB t,n= τ (cid:80)=1
t
τ=1a (cid:80)=1
A
a=f 1τ 1(a fτ)= (an )=τ n,a,n
t,a,n s 2c (cid:115)
a t,a,n ln(2Nt/δ)
+ (26)
1ThecodeanddataareavailableonGitHub[9]. 2(cid:80)t τ=1(cid:80)A a=11 fτ(a)=n7.4 UCB µ={0.72,0.74,0.93,0.61}.Sensitivityistheprobabilitythatacustomer
issatisfiedwiththeirstaygiventhatthehotelisclean.Weconsideraset
ThestandardUCBalgorithm[2]maintainsaUCBonthemeanreward
offourcustomertypesS={0.3,0.5,0.7,0.9}andmatcheachtypewith
ofeveryactionthatcanbetakenateachtimestep.Inourimplementation,
oneofthefourhotels,assumingthattheirrelativecleanlinesslikelihoods
wetreateverysuper-armasanarmandapplytheUCBalgorithmto
are initially unknown. We aim to maximize overall satisfaction by
everysuper-arm.WeuseEquation27fortheUCBofsuper-armf at
matchingthecustomersthatcaremostaboutcleanlinesswiththecleanest
timetandpullthesuper-armwiththehighestUCBateachtimestep.By
hotels.Assumingthatspaceatthehotelsislimitedandsomeonewill
treatingeachsuper-armasanarm,theUCBalgorithmisimplicitlyable
needtobematchedwithahotelthattendstobelessclean,weincur
toaccountfortheheterogeneityamongtheagents.However,itdoesnot
thelowestcosttoourcustomers’satisfactionifwematchthecustomer
combineanyinformationacrossagentsorarms,makingitincreasingly
whosesatisfactionisleastcorrelatedwiththehotel’scleanlinesstoaless
unsuitableasthenumberofagentsorarmsincreases.
cleanhotel.Thatway,wekeepspotsopenatthecleanesthotelsforthe
customerswhoareverylikelytobedissatisfiediftheirhotelisnotclean.
(cid:80)t (cid:80)A 1 Y
InFigure1b,MIN-WIDTHoutperformstheotherfouralgorithmsat
UCB = τ=1 a=1 fτ=f τ,a,f(a) alltimes,andtherelativeorderingof MIN-WIDTH, MIN-UCB,and
t,f (cid:80)t 1
τ=1 fτ=f NO-SHARINGisconsistentwiththeamountofinformationsharedacross
(cid:115) agents. Both canonical baselines perform poorly; UCB has 4! = 24
ln(2N!t/δ(N−A)!)
+ 2(cid:80)t 1 (27) super-armstolearnabout,andtheagentsensitivitiesvarywidely,making
τ=1 fτ=f CUCB’sassumptionthattherewardsfromagivenarmarei.i.d.even
lessappropriatethaniftheagentsensitivitiesweremoresimilar.
7.5 Implementation
8.3 PoachingPrevention
WeimplementMIN-WIDTH,NO-SHARING,andMIN-UCBasdescribed
in§5,§7.1,and§7.2,respectively,settingT→tinEquations9and23. Consider a hypothetical park with five areas, each with a different
WhileusingT facilitatestheregretanalysis,usingtinourexperiments probabilityofcontainingasnare:µ={0.1,0.3,0.5,0.7,0.9}.Ifrangers
allowsustoassesstheperformanceatdifferenttimeswithasinglerun findasnare,theygetarewardof1,andifnot,theyreceive0reward.
andalsocompareacrosssimulations.Allgraphsdisplaythecumulative Since even the best ranger teams probably cannot find more than
regretaveragedover90trialswithtwostandarderrorsanduseδ=0.05. 1/3ofthesnarespresent[10],weconsiderteamsoftwo,three,and
fiverangerswithsensitivitiesS={0.2,0.3},S={0.1,0.2,0.3},and
8 Results S={0.1,0.1,0.1,0.2,0.3},respectively.
ComparingFigures2a-cshowsthatwhentherearefewerrangers,it
Weperformsimulationsinfourdomains:threepseudo-syntheticdomains takesmuchmoretimeforthealgorithms’performancetodiverge,which
with parameter values inspired by real data—COVID test allocation, makessensebecauselessinformationiscollectedduringeachroundof
hotelrecommendation,andpoachingprevention—andonefullysynthetic patrolsandtherangers’detectionratesaresimilar.Asweaddrangers,
domain,inwhichwevarytheparametersofthesimulationstostudy eventhoughtheyhaveverylowsensitivity,therelativebenefitofusing
trendsinthealgorithms’behavioracrossproblemsettings.Finally,we MIN-WIDTHincreases,asthelow-sensitivityrangersassistwithexplo-
testtherobustnessofthealgorithmstoestimatingtheagentsensitivities. rationandallowthehigher-sensitivityrangerstoexploitthebestareas.
Thedifferenceinperformancebetweenthetwocanonicalbaselinesand
thethreesensitivity-awarealgorithmsalsoincreasesasweaddrangers.
8.1 COVIDTestAllocation
ForourCOVIDsimulation,supposewehavecapacitytoallocateCOVID
8.4 FullySynthetic
teststo5outof6floorsofacollegedormwiththefollowing(assumed
tobeunknown)prevalencerates:µ={0.05,0.1,0.12,0.15,0.25,0.3}. Weperformadditionalsimulationsforavarietyofarmmeansandagent
Eachpullofasuper-armcorrespondstodistributing5testsamong6 sensitivitiestoexplorethelong-range(highT)performanceofthefive
floors,wherethechoiceofwhototestoneachfloorisrandom.Wehave algorithms,withresultspresentedinAppendixB.Theresults,summa-
3antigentestsand2PCRteststodistributeeachday,withsensitivitiesto rizedinTableB1,demonstratethatthisproblemsettingbenefitsfroman
COVIDof80%and95%,respectively[6]:S={0.8,0.8,0.8,0.95,0.95}. approachdistinctfromamoregeneralstochasticbanditalgorithm.Inthe
Wenotethatwearenotmakingaprescriptiveclaimastohowschools 2×2(2agents,2arms)and3×3experimentsMIN-WIDTHhasthebest
shouldoperateCOVIDtestingbutratherhowouralgorithmcouldbeused long-rangeperformance,whichisconsistentwithFigures1band2c,in
toallocatetestsaccountingforthedifferentsensitivitiesofthetesttypes. whichMIN-WIDTHperformedthebestwhenthenumbersofagentsand
We simulate sequential super-arm pulls and show the results in armswerethesame.Whentherearefeweragentsthanarms,MIN-UCB
Figure1a,whereweseeallthealgorithmsperformsimilarlyfortheinitial sometimesoutperformsMIN-WIDTH.Thissuggeststhatsharingrewards
timesteps,afterwhichMIN-WIDTHperformsthebest.CUCBperforms acrossagentsismostusefulwhenthereareenoughagentstocontinueex-
similarlytoMIN-UCBandNO-SHARING,whichisreasonablesince ploringsothatthebestagentscanexploittheseeminglybestarmssooner.
thetestsensitivitiesarenotverydifferent,soignoringtheirheterogeneity
andcombiningalltheresultsisnotaterriblestrategy.
8.5 SensitivityRobustness
8.2 HotelRecommendation Weexplorehowrobustthesensitivity-awarealgorithms’performanceisto
imperfectknowledgeoftheagentsensitivities,whichwemaynotalways
For our hotel simulation, we extract cleanliness rates for four Punta knowexactly.WhencomputingtheUCBsandassigningagentstoarms,
Cana hotels with more than 500 reviews on TripAdvisor [20]. The theplannerusestheestimatedsensitivitiesratherthanthetrue,assumed-to-
probability that each hotel is clean is the mean of these ratings: be-unknownsensitivitiesusedtocomputetheregret.ThischangewouldFigure1:RegretplottedovertimefortheCOVIDtestallocation(left)andhotelrecommendation(right)domains.
Figure2:Regretplottedovertimeforthepoachingpreventiondomainwithvaryingagentsensitivities.
havenoeffectonthecanonicalbaselines,astheynevermodelsensitivities fromtheunionboundinTheorem1overthepossibleinstantiationsof
explicitly.WereruntheCOVIDexperimentwiththreesetsofestimated C ,thesetoftimeseveryagenthaspulledarmn.Thissetdependson
n
sensitivities:alloverestimated(S˜ ={0.85,0.85,0.85,0.98,0.98}),all thenumberofagentsbutnottheirsensitivities,soitdoesnotcapture
underestimated(S˜={0.75,0.75,0.75,0.9,0.9}),andamix thefactthatsomeagentsaremoresimilarthanothers,whichwebelieve
(S˜={0.75,0.75,0.75,0.98,0.98}).Thepercentchangeinregretisshown yieldsaresultingcardinalityG(T,A)thatessentiallyovercounts.
inTable1andthecumulativeregretisshowninTable2att=300across Foraclearexample,considertwopossibleinstantiationsofthesetC :
n
500trials. {4,5,6}and{5,4,6}.Inthefirstinstantiation,agent1haspulledarmn
Forallalgorithms,overestimatingthesensitivitiesonaveragehurtsper- fourtimes,agent2fivetimes,andagent3sixtimes,whileinthesecond
formancelessthanunderestimatingtheminthiscase.ForMIN-WIDTH instantiation, agent 1 has pulled it five times and agent 2 four times.
andMIN-UCB,underestimatingtheantigentestsensitivitiesandover- Nowsupposethatagents1and2havethesamesensitivity,makingthem
estimatingthePCRtestsensitivitieshurtsperformancethemost,possibly interchangeable.Inthiscase,thesetwoinstantiationsofthesetarenot
becausethePCRtestsaremorefrequentlyallocatedtolower-COVID actuallydistinctandshouldonlybecountedasoneinstantiationrather
floorstoperformexplorationthattheantigentestsarenotconsidered thantwo(asisbeingdonenow).Futureworkcouldpotentiallyresolve
accurateenoughtoreliablycover.Amongthethreesensitivity-awarealgo- thisbyreplacingtheunionboundwithadifferentboundthatisafunction
rithms,NO-SHARINGisleastaffectedbythesesensitivityapproximations oftheagentsensitivities.
becausetherelativeorderingoftheagentsisunchangedandtheagents’ Introducingtheformofheterogeneousagentsensitivitiesthatwestudy
UCBsarenotaffectedbytheestimationerrorinthesensitivitiesofthe heregivesrisetomorerealisticbanditmodelsformyriaddomainsas
otheragents.Overall,MIN-WIDTHhadthelowestregretintheoriginal discussedin§2.Tomodelcertainreal-worldapplicationswithevenmore
experimentandissufficientlyrobustforittocontinueoutperformingthe fidelity,futureworkcouldconsidersettingswherethearmmeanschange
otheralgorithmsinthethreerobustnessexperiments(FiguresB2-B4). withtime(e.g.,COVIDprevalencerates),possiblyinresponsetoarm
Table1:Percentchangeinregret(mean±oneSE)whenusingestimated pulls.Onecouldalsomodelagentsensitivitiesthatvaryacrossmultiple
vs.truesensitivitiesfortheCOVIDexperiment. dimensions (e.g., customer preferences for cleanliness, service, etc.).
Algorithm Overestimated Underestimated Mix Theconstraintpreventingmultipleagentsfrompullingthesamearm
M-W 0.7±0.9 2.5±1.0 9.5±1.0 couldalsoberelaxed,whichwouldnecessitateamodelforinteraction
M-UCB 0.7±1.6 9.1±1.8 28.9±1.9 effects.Theoreticallyanalyzingtheestimated-sensitivitysettingisanother
N-S 0.9±0.5 1.5±0.5 1.0±0.5 directionforfutureworkthatourrobustnessexperimentopensup.
Table2:Cumulativeregret(mean±oneSE)whenusingestimatedvs.
truesensitivitiesfortheCOVIDexperiment.
Algorithm Overestimated Underestimated Mix 10 Conclusion
M-W 10.8±0.1 11.0±0.1 11.7±0.1
M-UCB 14.0±0.1 15.2±0.2 18.0±0.2
N-S 17.5±0.1 17.6±0.1 17.5±0.1 Weintroduceastochasticmulti-armedbanditproblemwithheterogeneous
agentsdistinguishedbyasensitivityparameterthatuniquelycharacterizes
theirrewardfunctionforagivenarm.Wedevelopamethodforassigning
agentstoarmsthatdecomposesthecombinatorialproblemintooneof
9 Discussion
learningthearmmeanswhileprioritizingthehighest-sensitivityagents
Overall, either MIN-WIDTH or MIN-UCB has the best long-range duringarmassignment.Our MIN-WIDTH algorithmcombinesallof
performancewhentheagentsareheterogeneous,withCUCBperforming therewardswithaheterogeneity-awareweightingstrategy.Weprovide
bestforidenticalagents.Bycombiningobservationsacrossagents,its aregretboundforMIN-WIDTHandevaluateitinsimulationsinspiredby
confidence intervals will shrink faster than those of MIN-UCB and COVIDtestallocation,hotelrecommendation,andpoachingprevention,
thereisnoagentheterogeneityitfailstoaccountforinthatcase.When aswellasafullysyntheticdomain.Ourresultsshowthatmodelingagent
therearemorearmsthanagents,MIN-UCBsometimesachieveslower heterogeneitytendstobemostusefulwhenthesensitivitiesaremore
cumulativeregretthanMIN-WIDTH.Asremarkedin§7.2,theconfidence diverseacrossacollectionofagentsandthatsharingmoreinformation
intervalsforMIN-WIDTHmaybewiderbecauseoftheG(T,A)factor doesnotalwaysimproveperformance.EthicsStatement [14] A.Sankararaman,A.Ganesh,andS.Shakkottai.SocialLearninginMulti
AgentMultiArmedBandits. Proc.ACMMeas.Anal.Comput.Syst.,3(3),
Inourpaperweintroduceamodelthatmaybeabletomoreaccurately dec2019.doi:10.1145/3366701.URLhttps://doi.org/10.1145/3366701.
[15] S.Shahrampour,A.Rakhlin,andA.Jadbabaie. Multi-armedbanditsin
capturecertainelementsofreal-worldsystemsthanpastwork,especially
multi-agentnetworks.In2017IEEEInternationalConferenceonAcoustics,
thosewithvaryingagentsensitivities.Havingamorecompletemodelcan SpeechandSignalProcessing(ICASSP),pages2786–2790,2017. doi:
leadtobetterperformanceinappropriatedomains,whichwedemonstrate 10.1109/ICASSP.2017.7952664.
withourCOVIDtestallocation,hotelrecommendation,andpoaching [16] C. Shi, W. Xiong, C. Shen, and J. Yang. Heterogeneous multi-player
multi-armedbandits:Closingthegapandgeneralization.In35thConference
preventionexperiments.Nonetheless,anyautomaticdecision-makingtool
on Neural Information Processing Systems, pages 1–6, 2014. doi:
hasinherentrisksandshouldbeusedinappropriatecontextsbypeople 10.1109/CISS.2014.6814096.
withknowledgeofitscapabilitiesandlimitations.Anyapplicationofour [17] S.Solanki,S.Kanaparthy,S.Damle,andS.Gujar. Differentiallyprivate
federatedcombinatorialbanditswithconstraints,2023.
methodstoreal-worldsettingswouldrequiremuchmoreperspectiveand
[18] M.E.Taylor,M.Jain,Y.Jin,M.Yokoo,andM.Tambe.Whenshouldthere
sociotechnicalanalysisbeyondthealgorithmiccontributionweofferhere. bea"me"in"team"?distributedmulti-agentoptimizationunderuncertainty.
InProceedingsofthe9thInternationalConferenceonAutonomousAgents
andMultiagentSystems:Volume1-Volume1,AAMAS’10,page109–116,
Acknowledgements Richland,SC,2010.InternationalFoundationforAutonomousAgentsand
MultiagentSystems.ISBN9780982657119.
WewouldliketothankLucasJansonforhelpfuldiscussions.L.G.wassup- [19] D.Vial,S.Shakkottai,andR.Srikant. RobustMulti-AgentMulti-Armed
Bandits.InProceedingsoftheTwenty-SecondInternationalSymposiumon
portedbytheNationalScienceFoundationGraduateResearchFellowship
Theory,AlgorithmicFoundations,andProtocolDesignforMobileNetworks
underGrantNo.DGE2140743.E.R.wassupportedbytheHarvardData andMobileComputing,MobiHoc’21,page161–170,NewYork,NY,USA,
ScienceInitiativeandtheHarvardCenterforResearchonComputation 2021.AssociationforComputingMachinery.ISBN9781450385589.doi:
andSociety. 10.1145/3466772.3467045.URLhttps://doi.org/10.1145/3466772.3467045.
[20] H.Wang.TripAdvisorData(00040).PrefLib:ALibraryforPreferences,
Aug.2013.URLhttps://www.preflib.org/dataset/00040.
References [21] N.Wanigasekara,Y.Liang,S.T.Goh,Y.Liu,J.J.Williams,andD.S.
Rosenblum.LearningMulti-ObjectiveRewardsandUserUtilityFunction
inContextualBanditsforPersonalizedRanking. InProceedingsofthe
[1] J.-Y.Audibert,R.Munos,andC.Szepesvári. Exploration–exploitation
Twenty-Eighth International Joint Conference on Artificial Intelligence,
tradeoff using variance estimates in multi-armed bandits. Theoretical
IJCAI-19,pages3835–3841.InternationalJointConferencesonArtificial
Computer Science, 410(19):1876–1902, 2009. ISSN 0304-3975. doi:
IntelligenceOrganization,72019. doi:10.24963/ijcai.2019/532. URL
https://doi.org/10.1016/j.tcs.2009.01.016.URLhttps://www.sciencedirect.
https://doi.org/10.24963/ijcai.2019/532.
com/science/article/pii/S030439750900067X.AlgorithmicLearningTheory.
[22] L.Xu,E.Bondi,F.Fang,A.Perrault,K.Wang,andM.Tambe. Dual-
[2] P. Auer, N. Cesa-Bianchi, and P. Fischer. Finite-time analysis of the
mandatepatrols:Multi-armedbanditsforgreensecurity. TheThirty-Fifth
multiarmedbanditproblem. MachineLearning,47:235–256,2002.
AAAIConferenceonArtificialIntelligenceProceedings,2021.
[3] H. Bastani, K. Drakopoulos, V. Gupta, I. Vlachogiannis, C. Had-
[23] L.Xu,A.Biswas,F.Fang,andM.Tambe.RankedPrioritizationofGroups
jichristodoulou,P.Lagiou,G.Magiorkinis,D.Paraskevis,andS.Tsiodras.
in Combinatorial Bandit Allocation. In Proc. 31st International Joint
EfficientandtargetedCOVID-19bordertestingviareinforcementlearning.
ConferenceonArtificialIntelligence(IJCAI),2022.
Nature,599(7883):108–113,Sep2021.doi:10.1038/s41586-021-04014-z.
[24] L.Yang,Y.-Z.J.Chen,M.H.Hajiemaili,J.C.S.Lui,andD.Towsley.
[4] N.Cesa-Bianchi,T.R.Cesari,andR.D.Vecchia. Cooperativeonline
Distributedbanditswithheterogeneousagents.InIEEEINFOCOM2022
learningwithfeedbackgraphs,2022.
-IEEEConferenceonComputerCommunications,pages200–209,2022.
[5] W.Chen,Y.Wang,andY.Yuan.Combinatorialmulti-armedbandit:General
doi:10.1109/INFOCOM48880.2022.9796901.
framework,resultsandapplications. Proceedingsofthe30thInternational
ConferenceonMachineLearning,2013.
[6] FDA.At-HomeCOVID-19AntigenTests-TakeStepstoReduceYourRiskof
FalseNegativeResults:FDASafetyCommunication,Nov2022.URLhttps:
//www.fda.gov/medical-devices/safety-communications/home-covid-19-a
ntigen-tests-take-steps-reduce-your-risk-false-negative-results-fda-safety.
[7] Y.Gai,B.Krishnamachari,andR.Jain.CombinatorialNetworkOptimization
WithUnknownVariables:Multi-ArmedBanditsWithLinearRewardsand
IndividualObservations. IEEE/ACMTransactionsonNetworking,20(5):
1466–1478,2012.doi:10.1109/TNET.2011.2181864.
[8] A. Ghosh, A. Sankararaman, and K. Ramchandran. Multi-agent
heterogeneous stochastic linear bandits. In Machine Learning and
KnowledgeDiscoveryinDatabases:EuropeanConference,ECMLPKDD
2022, Grenoble, France, September 19–23, 2022, Proceedings, Part
IV, page 300–316, Berlin, Heidelberg, 2023. Springer-Verlag. ISBN
978-3-031-26411-5. doi: 10.1007/978-3-031-26412-2_19. URL
https://doi.org/10.1007/978-3-031-26412-2_19.
[9] L. Gordon, E. Rolf, and M. Tambe. Code and data for “Combin-
ing Diverse Information for Coordinated Action: Stochastic Ban-
dit Algorithms for Heterogeneous Agents”. GitHub, 2024. URL
https://github.com/lgordon99/heterogeneous-stochastic-bandits.
[10] J.Hance. Rangersfind109,217snaresinasingleparkincambodia. The
Guardian,May2018. URLhttps://www.theguardian.com/environment/
radical-conservation/2018/may/22/snares-southeast-asia-cambodia-vie
tnam-laos-tigers-elephants-saola.
[11] U.MadhushaniandN.E.Leonard.Heterogeneousstochasticinteractions
for multiple agents in a multi-armed bandit problem. In 2019 18th
European Control Conference (ECC), pages 3502–3507, 2019. doi:
10.23919/ECC.2019.8796036.
[12] I.RejwanandY.Mansour. Top-kcombinatorialbanditswithfull-bandit
feedback,2019.
[13] E. Rolf, D. Fridovich-Keil, M. Simchowitz, B. Recht, and C. Tom-
lin. A Successive-Elimination Approach to Adaptive Robotic Source
Seeking. IEEE Transactions on Robotics, 37(1):34–47, 2021. doi:
10.1109/TRO.2020.3005537.Appendix
A Theory
A.1 Definitions
T ={t}T
t=1
Y ∼Bern(s µ ).
t,a,n a n
t
(cid:88)
c = 1
t,a,n fτ(a)=n
τ=1
T ={t∈T|c >0}
a,n t,a,n
T ={t∈T|c >0},
n t,n
(cid:40)
t∈/T 0.5
a,n
µˆ =
t,a,n t∈T 1 (cid:80)t 1 Y
a,n sact,a,n τ=1 fτ(a)=n τ,a,n
(cid:115)
1 ln(2ANT/δ)
ϵ = .
t,a,n s 2c
a t,a,n
UCB =µˆ +ϵ
t,a,n t,a,n t,a,n
UCB =minUCB .
t,n t,a,n
a∈A
UCB =µˆ +ϵ
t,n t,n t,n
T A
(cid:88)(cid:88) (cid:0) (cid:1)
R T= s
a
µ f⋆(a)−µ
ft(a)
.
t=1a=1
A.2 NO-SHARINGConcentrationBound
Proposition2(NO-SHARINGConcentrationBound). Supposetheempiricalestimatorofthemeanofarmnaccordingtoagentawithsensitivity
s attimet∈T isgivenbyEquation22,
a
(cid:40)
t∈/T 0.5
a,n
µˆ =
t,a,n t∈T 1 (cid:80)t 1 Y ,
a,n sact,a,n τ=1 fτ(a)=n τ,a,n
forY ,c ,andT definedinEquations1,2,and4,respectively.Thenµˆ satisfies
τ,a,n t,a,n a,n t,a,n
∀δ∈(0,1),P[∀a∈A,n∈N,t∈T,|µˆ −µ |<ϵ ]>1−δ (28)
t,a,n n t,a,n
forϵ asgiveninEquation23,
t,a,n
(cid:115)
1 ln(2ANT/δ)
ϵ = .
t,a,n s 2c
a t,a,n
Proof. LetD bethesumofci.i.d.rewards
c,a,n
Y ∼Bern(s µ ),wherecisfixedandnotrandom.
i,a,n a n
c
(cid:88)
D = Y
c,a,n i,a,n
i=1
NotethateachY isboundedby
i,a,n
0≤Y ≤1.
i,a,n
Hoeffding’sinequalitythengives
(cid:18) 2α2 (cid:19)
∀α>0,P[|D c,a,n−E[D c,a,n]|≥α]≤2exp −(cid:80)c
(1−0)2
.
i=1
PlugginginD yields
c,a,n
(cid:34)(cid:12) (cid:12)(cid:88)c (cid:34) (cid:88)c (cid:35)(cid:12) (cid:12) (cid:35) (cid:18) 2α2 (cid:19)
∀α>0,P (cid:12)
(cid:12)
Y i,a,n−E Y
i,a,n
(cid:12) (cid:12)≥α ≤2exp −(cid:80)c
1
.
(cid:12) i=1 i=1 (cid:12) i=1
Bythelinearityofexpectation,weget
(cid:34)(cid:12) (cid:12)(cid:88)c (cid:88)c (cid:12) (cid:12) (cid:35) (cid:18) 2α2(cid:19)
∀α>0,P (cid:12) Y − E[Y ](cid:12)≥α ≤2exp − .
(cid:12) i,a,n i,a,n(cid:12) c
(cid:12) (cid:12)
i=1 i=1PluggingintheexpectationofY gives
i,a,n
(cid:34)(cid:12) (cid:12)(cid:88)c (cid:88)c (cid:12) (cid:12) (cid:35) (cid:18) 2α2(cid:19)
∀α>0,P (cid:12) Y − s µ (cid:12)≥α ≤2exp − .
(cid:12) i,a,n a n(cid:12) c
(cid:12) (cid:12)
i=1 i=1
Simplifyingyields
(cid:34)(cid:12) (cid:12)(cid:88)c (cid:12) (cid:12) (cid:35) (cid:18) 2α2(cid:19)
∀α>0,P (cid:12) Y −s cµ (cid:12)≥α ≤2exp − .
(cid:12) i,a,n a n(cid:12) c
(cid:12) (cid:12)
i=1
Takingthecomplementoftheequationresultsin
(cid:34)(cid:12) (cid:12)(cid:88)c (cid:12) (cid:12) (cid:35) (cid:18) 2α2(cid:19)
∀α>0,P (cid:12) Y −s cµ (cid:12)<α >1−2exp − .
(cid:12) i,a,n a n(cid:12) c
(cid:12) (cid:12)
i=1
Set
(cid:18) 2α2(cid:19)
δ=2exp − .
c
Wecannowsolveforαintermsofδ.
(cid:18) 2α2(cid:19) (cid:18) 2α2(cid:19) δ 2α2 (cid:18) δ(cid:19) 2α2 (cid:18) 2(cid:19) (cid:114) cln(2/δ)
2exp − =δ=⇒exp − = =⇒− =ln =⇒ =ln =⇒α=
c c 2 c 2 c δ 2
Theinequalitythenbecomes
(cid:34)(cid:12) (cid:12)(cid:88)c (cid:12) (cid:12) (cid:114) cln(2/δ)(cid:35)
∀δ∈(0,1),P (cid:12) Y −s cµ (cid:12)< >1−δ.
(cid:12) i,a,n a n(cid:12) 2
(cid:12) (cid:12)
i=1
Applyingaunionboundover
{(cid:12) (cid:12)(cid:80)c
i=1Y i,a,n−s acµ
n(cid:12) (cid:12)<(cid:112)
cln(2/δ)/2} a∈Agives
(cid:34) (cid:12) (cid:12)(cid:88)c (cid:12) (cid:12) (cid:114) cln(2A/δ)(cid:35)
∀δ∈(0,1),P ∀a∈A,(cid:12) Y −s cµ (cid:12)< >1−δ.
(cid:12) i,a,n a n(cid:12) 2
(cid:12) (cid:12)
i=1
Applyingaunionboundover
{(cid:12) (cid:12)(cid:80)c
i=1Y i,a,n−s acµ
n(cid:12) (cid:12)<(cid:112)
cln(2A/δ)/2}
n∈N
gives
(cid:20) (cid:12) (cid:12)(cid:88)c (cid:12) (cid:12) (cid:114) cln(2AN/δ)(cid:21)
∀δ∈(0,1),P ∀a∈A,n∈N,(cid:12) Y −s cµ (cid:12)< >1−δ.
(cid:12) i,a,n a n(cid:12) 2
(cid:12) (cid:12)
i=1
Applyingaunionboundover
{(cid:12) (cid:12)(cid:80)c
i=1Y i,a,n−s acµ
n(cid:12) (cid:12)<(cid:112)
cln(2AN/δ)/2}
c∈T
gives
(cid:20) (cid:12) (cid:12)(cid:88)c (cid:12) (cid:12) (cid:114) cln(2ANT/δ)(cid:21)
∀δ∈(0,1),P ∀a∈A,n∈N,c∈T,(cid:12) Y −s cµ (cid:12)< >1−δ.
(cid:12) i,a,n a n(cid:12) 2
(cid:12) (cid:12)
i=1
Eventhoughc isarandomvariable,sincec ∈T ∀t∈T forT definedinEquation4,itholdsthat
t,a,n t,a,n a,n a,n
∀δ∈(0,1),P(cid:20)
∀a∈A,n∈N,t∈T
,(cid:12) (cid:12) (cid:12)c (cid:88)t,a,n
Y −s c µ
(cid:12) (cid:12) (cid:12)<(cid:114) c t,a,nln(2ANT/δ)(cid:21)
>1−δ.
a,n(cid:12) i,a,n a t,a,n n(cid:12) 2
(cid:12) (cid:12)
i=1
Dividingbothsidesoftheinequalitybys c gives
a t,a,n
(cid:20) (cid:12) (cid:12) 1 c (cid:88)t,a,n (cid:12) (cid:12) 1(cid:115) ln(2ANT/δ)(cid:21)
∀δ∈(0,1),P ∀a∈A,n∈N,t∈T ,(cid:12) Y −µ (cid:12)< >1−δ.
a,n(cid:12)s c i,a,n n(cid:12) s 2c
(cid:12) a t,a,n (cid:12) a t,a,n
i=1
Bythedefinitionofc inEquation2,summingoverifrom1toc isequivalenttosummingoverτfrom1totandmultiplyingbytheindicator
t,a,n t,a,n
variable1 .
fτ(a)=n
(cid:12) (cid:12) (cid:115)
(cid:20) (cid:12) 1 (cid:88)t (cid:12) 1 ln(2ANT/δ)(cid:21)
∀δ∈(0,1),P ∀a∈A,n∈N,t∈T ,(cid:12) 1 Y −µ (cid:12)< >1−δ
a,n(cid:12)s c fτ(a)=n τ,a,n n(cid:12) s 2c
(cid:12) a t,a,n (cid:12) a t,a,n
τ=1
Usingthedefinitionsofµˆ andϵ giveninEquations22and23,respectively,gives
t,a,n t,a,n
∀δ∈(0,1),P[∀a∈A,n∈N,t∈T ,|µˆ −µ |<ϵ ]>1−δ.
a,n t,a,n n t,a,n
Recallthatfort∈/T ,wehaveµˆ =0.5byEquation22andϵ =∞sincec =0.Becausethedifferencebetweenthetruemeanµ and
a,n t,a,n t,a,n t,a,n n
0.5islessthaninfinitywithprobability1,weget
∀δ∈(0,1),P[∀a∈A,n∈N,t∈T,|µˆ −µ |<ϵ ]>1−δ.
t,a,n n t,a,nA.3 MIN-UCBConcentrationBound
Corollary1(MIN-UCBConcentrationBound). SupposethesharedUCBonµ nattimet∈T isgivenbyEquation25,
UCB =minUCB ,
t,n t,a,n
a∈A
forUCB definedinEquation24.Thenµ isboundedwithhighprobabilityaccordingto
t,a,n n
∀δ∈(0,1),P[∀n∈N,t∈T,µ <UCB ]>1−δ. (29)
n t,n
Proof. First,wecanboundµ −µˆ by
n t,a,n
µ −µˆ ≤|µ −µˆ |=|µˆ −µ |.
n t,a,n n t,a,n t,a,n n
Usingtheboundon|µˆ −µ |fromEquation28gives
t,a,n n
∀δ∈(0,1),P[∀a∈A,n∈N,t∈T,µ −µˆ <ϵ ]>1−δ.
n t,a,n t,a,n
Thisisequivalentto
∀δ∈(0,1),P[∀a∈A,n∈N,t∈T,µ <µˆ +ϵ ]>1−δ.
n t,a,n t,a,n
UsingthedefinitionofUCB inEquation24gives
t,a,n
∀δ∈(0,1),P[∀a∈A,n∈N,t∈T,µ <UCB ]>1−δ.
n t,a,n
Sincethebounds{µ <UCB } holdsimultaneously,thissetincludestheboundµ <min UCB .
n t,a,n a∈A n a∈A t,a,n
(cid:20) (cid:21)
∀δ∈(0,1),P ∀n∈N,t∈T,µ <minUCB >1−δ
n t,a,n
a∈A
UsingthedefinitionofUCB giveninEquation25gives
t,n
∀δ∈(0,1),P[∀n∈N,t∈T,µ <UCB ]>1−δ.
n t,n
A.4 MIN-WIDTHWeightsDerivation
Proposition3(MIN-WIDTHWeightsDerivation). Supposeagentapullsarmnafixednumberoftimes,anumberwedenotec a,n,wherethereward
fromeachpullisY ∼Bern(s µ ).LetC ={c }A containthec foreveryagent.LetD betheweightedsumoftheindependent
i,a,n a n n a,n a=1 a,n Cn,n
rewardscollectedbyalltheagentsfromarmn,expressedintermsofweightsw .
Cn,a,n
A ca,n A ca,n
(cid:88) (cid:88) (cid:88)(cid:88)
D = w Y = w Y
Cn,n Cn,a,n i,a,n Cn,a,n i,a,n
a=1 i=1 a=1i=1
Thentheweightsw thatminimizethewidthoftheconfidenceintervalonµ givenby
Cn,a,n n
(cid:115)
ln(2/δ)(cid:80)A w 2c
γ = a=1 Cn,a,n a,n
Cn,n 2
undertheconstraintthattheempiricalestimatorD isunbiasedaregivenby
Cn,n
s
w = a 1 .
Cn,a,n (cid:80)A s 2c ca,n>0
b=1 b b,n
Proof. Sincetherewardscollectedbyacertainagentwhenpullingacertainarmareindependentandidenticallydistributed,theorderoftherewards
insuchasequenceisunimportant.Thus,weconsiderweightsonsuchsequencesofi.i.d.rewardsratherthanoneveryrewarditself.Notethatifc =0,
a,n
thenagentahascollectednorewardsforarmn,andsowesetw =0foranysuchagent.Hence,weneedtosolveforw onlyforagents
Cn,a,n Cn,a,n
withc >0.ConsidertheexpectationofD asdefinedinEquation12.
a,n Cn,n
A ca,n A
(cid:88)(cid:88) (cid:88)
E[D ]= w s µ =µ w s c
Cn,n Cn,a,n a n n Cn,a,n a a,n
a=1i=1 a=1
IfD istobeunbiased,thenweneed
Cn,n
E[D ]=µ ,
Cn,n nwhichsetstheconstraint
A
(cid:88)
w s c =1. (30)
Cn,a,n a a,n
a=1
TherandomvariablebeingsummedinEquation12isw Y ,whichisboundedby
Cn,a,n i,a,n
0≤w Y ≤w .
Cn,a,n i,a,n Cn,a,n
Hoeffding’sinequalitythengives
(cid:32) (cid:33)
∀α>0,P(cid:2)(cid:12)
(cid:12)D
Cn,n−E(cid:2)
D
Cn,n(cid:3)(cid:12) (cid:12)≥α(cid:3)
≤2exp −
(cid:80)A
(cid:80)2 caα ,n2
w 2
.
a=1 i=1 Cn,a,n
CollapsingthesumoveriandusingtheunbiasednessofD yields
Cn,n
(cid:32) (cid:33)
∀α>0,P(cid:2)(cid:12)
(cid:12)D Cn,n−µ
n(cid:12) (cid:12)≥α(cid:3)
≤2exp −
(cid:80)A
w2α2
2c
.
a=1 Cn,a,n a,n
Takingthecomplementoftheequationresultsin
(cid:32) (cid:33)
∀α>0,P(cid:2)(cid:12)
(cid:12)D Cn,n−µ
n(cid:12) (cid:12)<α(cid:3)
>1−2exp −
(cid:80)A
w2α2
2c
.
a=1 Cn,a,n a,n
Set
(cid:32) (cid:33)
2α2
δ=2exp − .
(cid:80)A w 2c
a=1 Cn,a,n a,n
Wecannowsolveforαintermsofδ.
(cid:32) 2α2 (cid:33) δ 2α2 (cid:18) δ(cid:19) 2α2 (cid:18) 2(cid:19)
exp − = =⇒− =ln =⇒ =ln
(cid:80)A w 2c 2 (cid:80)A w 2c 2 (cid:80)A w 2c δ
a=1 Cn,a,n a,n a=1 Cn,a,n a,n a=1 Cn,a,n a,n
(cid:115)
ln(2/δ)(cid:80)A w 2c
=⇒α= a=1 Cn,a,n a,n
2
TheHoeffdinginequalitycanthenbeexpressedintermsofδratherthanα.
∀δ∈(0,1),P(cid:34) (cid:12) (cid:12)D Cn,n−µ n(cid:12) (cid:12)<(cid:115) ln(2/δ)(cid:80)A a=1 2w Cn,a,n2c a,n(cid:35) >1−δ
Letγ bethewidthoftheconfidenceintervalonthemeanofarmnforsomefixednumberofpullsofeacharmbyeachagentcapturedinC .
Cn,n n
(cid:115)
ln(2/δ)(cid:80)A w 2c
γ = a=1 Cn,a,n a,n
Cn,n 2
Let
(cid:114)
ln(2/δ)
β= .
2
Thewidthγ canthenbeexpressedas
Cn,n
(cid:118)
(cid:117) A
(cid:117)(cid:88)
γ =β(cid:116) w 2c .
Cn,n Cn,a,n a,n
a=1
WewanttheconfidenceintervaltobeastightaspossiblearoundtheunbiasedestimatorD ,sowesolvefortheweightsthatminimizeγ
Cn,n Cn,n
subjecttotheconstraintthatD isunbiasedforanynon-randomC .WedothiswiththemethodofLagrangemultipliers.DefinetheLagrangian
Cn,n n
(cid:118)
(cid:32) A (cid:33) (cid:117) A (cid:32) A (cid:33)
(cid:88) (cid:117)(cid:88) (cid:88)
L(w,λ)=γ Cn,n+λ w Cn,b,ns bc b,n−1 =β(cid:116) w Cn,b,n2c b,n+λ w Cn,b,ns bc b,n−1 .
b=1 b=1 b=1
ConsiderthederivativeofLwithrespecttow forsomeagentawithc >0.
Cn,a,n a,n
∂L 2βw c βw c
= Cn,a,n a,n +λs c = Cn,a,n a,n +λs c
∂w Cn,a,n 2(cid:113) (cid:80)A b=1w Cn,b,n2c
b,n
a a,n (cid:113) (cid:80)A b=1w Cn,b,n2c
b,n
a a,nNext,considerthederivativeofLwithrespecttoλ.
A
∂L (cid:88)
= w s c −1
∂λ Cn,b,n b b,n
b=1
Tosolvetheoptimizationproblem,wesetbothderivativesequalto0.First,wesetthederivativewithrespecttotheweightsequalto0.
βw c βw βw
Cn,a,n a,n +λs c =0=⇒ Cn,a,n +λs =0=⇒ Cn,a,n =−λs
(cid:113) a a,n (cid:113) a (cid:113) a
(cid:80)A w 2c (cid:80)A w 2c (cid:80)A w 2c
b=1 Cn,b,n b,n b=1 Cn,b,n b,n b=1 Cn,b,n b,n
(cid:113)
λs (cid:80)A w 2c
a b=1 Cn,b,n b,n
=⇒w =− (31)
Cn,a,n β
Then,wesetthederivativewithrespecttoλequalto0.
A A
(cid:88) (cid:88)
w s c −1=0=⇒ w s c =1
Cn,b,n b b,n Cn,b,n b b,n
b=1 b=1
Wecanplugtheweightsexpressedintermsofλ,giveninEquation31,intoEquationA.4inordertosolveforλ.
A  λs (cid:113) (cid:80)A w 2c  λ(cid:113) (cid:80)A w 2c A
(cid:88) − b d=1
β
Cn,d,n d,n s bc b,n=1=⇒− d=1 βCn,d,n d,n(cid:88) s b2c b,n=1
b=1 b=1
β
=⇒λ=−
(cid:113)
(cid:80)A w 2c (cid:80)A s 2c
d=1 Cn,d,n d,n b=1 b b,n
WenowplugthisexpressionforλbackintotheexpressionfortheweightsgiveninEquation31,yielding
(cid:113)
w =− β ×−s a (cid:80)A b=1w Cn,b,n2c b,n = s a ,
Cn,a,n (cid:113) (cid:80)A d=1w Cn,d,n2c d,n(cid:80)A b=1s b2c
b,n
β (cid:80)A b=1s b2c b,n
whichholdsforanyagentawithc >0.Sincew =0foragentswithc =0,thefinalformfortheweightscanbecapturedas
a,n Cn,a,n a,n
s
w = a 1 .
Cn,a,n (cid:80)A s 2c ca,n>0
b=1 b b,n
A.5 MIN-WIDTHConcentrationBound
Theorem3(MIN-WIDTHConcentrationBound). Supposetheempiricalestimatorofthemeanofarmnattimet∈T isgivenby
(cid:40)
t∈/T 0.5
n
µˆ t,n= t∈T 1 (cid:80)A s (cid:80)t 1 Y
n (cid:80)A b=1sb2ct,b,n a=1 a τ=1 fτ(a)=n τ,a,n
forY ,c ,andT definedinEquations1,2,and5,respectively.Thenµˆ satisfies
τ,a,n t,b,n n t,n
∀δ∈(0,1),P[∀n∈N,t∈T,|µˆ −µ |<ϵ ]>1−δ
t,n n t,n
for
(cid:115)
ln(2NG(T,A)/δ)
ϵ = ,
t,n 2(cid:80)A s 2c
a=1 a t,a,n
and
T (cid:32) (cid:33)
(cid:88) t+A−1
G(T,A)=
A−1
t=1
where
G(T,A)<(T+1)A.Proof. LetusbeginfromEquation14,whichsays
∀δ∈(0,1),P(cid:34) (cid:12) (cid:12)D Cn,n−µ n(cid:12) (cid:12)<(cid:115) ln(2/δ)(cid:80)A a=1 2w Cn,a,n2c a,n(cid:35) >1−δ.
Applyingaunionboundover
(cid:26) (cid:113) (cid:27)
(cid:12) (cid:12)D Cn,n−µ n(cid:12) (cid:12)< ln(2/δ)(cid:80)A a=1w Cn,a,n2c a,n/2 yields
n∈N
∀δ∈(0,1),P(cid:34) ∀n∈N,(cid:12) (cid:12)D Cn,n−µ n(cid:12) (cid:12)<(cid:115) ln(2N/δ)(cid:80)A a= 21w Cn,a,n2c a,n(cid:35) >1−δ.
LetHbethesetofallpossibleinstantiationsofthesetC assumingthatarmnhasbeenpulledatleastoncewithinatimehorizonofT,soHisa
n
setofsets.Weneedtoapplyaunionboundover
(cid:26) (cid:113) (cid:27)
(cid:12)
(cid:12)D Cn,n−µ
n(cid:12)
(cid:12)<
ln(2N/δ)(cid:80)A
a=1
2wCn,a,n2ca,n
.Inordertoperformthisunionbound,wemustdeterminethecardinalityofH,whichisthenum-
Cn∈H
berofpossibleinstantiationsofthesetC .C containsAelements,whereeachelementc isthenumberoftimesagentahaspulledarmnthroughtime
n n a,n
T.Iftheagenthasneverpulledarmn,thenthatelementis0,andiftheagentpullsarmnineverytimestep,thentheelementisT.Thismeansthateachel-
ementofthesetisanintegerbetween0andT.Bytheassumptionthatarmnhasbeenpulledatleastonce,thesumoftheelementsinC mustbeatleast1.
n
Moreover,becauseamaximumofoneagentcanpulleacharmineverytimestep,thesumoftheelementscanbenogreaterthanT.Hence,thesumofthe
elementsinC mustbeanintegerbetween1andT.Inordertobreakdownthiscomplexcountingproblem,letusfirstconsiderthenumberofpermissible
n
instantiationsofthesetthathavetheelementssumtosome1≤t≤T.Usingtheterminologyofthestarsandbarsmethod,thisproblemisequivalenttothe
numberofwaystodistributetstarsamongAbars,whereemptybinsareallowed.Thenumberofpossiblearrangementsisawell-knownresult:(cid:0)t+A−1(cid:1)
.
A−1
Sincetcanrangefrom1toT,thenumberofpossibleinstantiationsofthesetC isgivenbysummingthisresultfrom1toT,aquantitywedenote
n
G(T,A),giveninEquation10.IfweignoretheconstraintonthesumofC ,thenthenumberofpossibleinstantiationswouldsimplybe(T+1)AsinceC
n n
hasAelements,eachofwhichcantakeonanyintegervaluebetween0andT.ThismeansthatthecardinalityofH,whichwehavedenotedG(T,A),is
boundedaboveby(T+1)A.Notethatifalltheagentswereidentical,thenG(T,A)=TasinCUCB.Theoutcomeofperformingtheunionboundisthen
∀δ∈(0,1),P(cid:34)
∀n∈N,C
n∈H,(cid:12)
(cid:12)D Cn,n−µ
n(cid:12) (cid:12)<(cid:115) ln(2NG(T,A)/δ)(cid:80)
2
A a=1w Cn,a,n2c a,n(cid:35)
>1−δ.
AfterplugginginthederivedweightsfromEquation13,weget
(cid:118)
(cid:34) (cid:117) (cid:117)ln(2NG(T,A)/δ)(cid:80)A (cid:16) sa 1 (cid:17)2 c (cid:35)
∀δ∈(0,1),P ∀n∈N,C n∈H,(cid:12) (cid:12)D Cn,n−µ n(cid:12) (cid:12)<(cid:116) a=1 2(cid:80)A b=1sb2cb,n ca,n>0 a,n >1−δ.
Expandingthesquaregives
(cid:115)
∀δ∈(0,1),P(cid:34)
∀n∈N,C
n∈H,(cid:12)
(cid:12)D Cn,n−µ
n(cid:12)
(cid:12)<
(cid:80)A
1
s 2c
ln(2NG(T,A)/δ)(cid:80) 2A a=11 ca,n>0s a2c a,n(cid:35)
>1−δ.
b=1 b b,n
Because1 isbeingmultipliedbyc ,theindicatorvariableisunnecessary,andweget
ca,n>0 a,n
(cid:34) (cid:115) (cid:35)
∀δ∈(0,1),P ∀n∈N,C n∈H,(cid:12) (cid:12)D Cn,n−µ n(cid:12) (cid:12)< ln 2( (cid:80)2N AG( sT, 2A c)/δ) >1−δ.
a=1 a a,n
SinceC ∈H∀t∈T ,
t,n n
(cid:34) (cid:115) (cid:35)
∀δ∈(0,1),P ∀n∈N,t∈T n,(cid:12) (cid:12)D Ct,n,n−µ n(cid:12) (cid:12)< ln 2(cid:80)(2N AG s(T 2,A c)/δ) >1−δ.
a=1 a t,a,n
NowconsiderwhatD simplifiesto,recallingthedefinitionofD inEquation12andusingw fromEquation13.
Ct,n,n Cn,n Ct,n,a,n
D
=(cid:88)A
w
c (cid:88)t,a,n
Y
=(cid:88)A s
a 1
c (cid:88)t,a,n
Y =
1 (cid:88)A
1 s
c (cid:88)t,a,n
Y
Ct,n,n Ct,n,a,n i,a,n (cid:80)A s 2c ct,a,n>0 i,a,n (cid:80)A s 2c ct,a,n>0 a i,a,n
a=1 i=1 a=1 b=1 b t,b,n i=1 b=1 b t,b,na=1 i=1
TheHoeffdinginequalitythenbecomes
(cid:34) (cid:12) (cid:12) 1 (cid:88)A c (cid:88)t,a,n (cid:12) (cid:12) (cid:115) ln(2NG(T,A)/δ)(cid:35)
∀δ∈(0,1),P ∀n∈N,t∈T ,(cid:12) 1 s Y −µ (cid:12)< >1−δ.
n(cid:12) (cid:12)(cid:80)A b=1s b2c t,b,na=1 ct,a,n>0 a i=1 i,a,n n(cid:12) (cid:12) 2(cid:80)A a=1s a2c t,a,nBythedefinitionofc inEquation2,summingoverifrom1toc onlyforagentswithc >0isequivalenttosummingoverτ from1
t,a,n t,a,n t,a,n
totandmultiplyingbytheindicatorvariable1 .
fτ(a)=n
(cid:34) (cid:12) (cid:12) 1 (cid:88)A (cid:88)t (cid:12) (cid:12) (cid:115) ln(2NG(T,A)/δ)(cid:35)
∀δ∈(0,1),P ∀n∈N,t∈T ,(cid:12) s 1 Y −µ (cid:12)< >1−δ.
n(cid:12) (cid:12)(cid:80)A b=1s b2c t,b,na=1 a τ=1 fτ(a)=n τ,a,n n(cid:12) (cid:12) 2(cid:80)A a=1s a2c t,a,n
Usingthedefinitionsofµˆ andϵ giveninEquations8and9,respectively,gives
t,n t,n
∀δ∈(0,1),P[∀n∈N,t∈T ,|µˆ −µ |<ϵ ]>1−δ.
n t,n n t,n
Recallthatfort∈/T ,wehaveµˆ =0.5byEquation8andϵ =∞sincec =0.Becausethedifferencebetweenthetruemeanµ and0.5is
n t,n t,n t,n n
lessthaninfinitywithprobability1,weget
∀δ∈(0,1),P[∀n∈N,t∈T,|µˆ −µ |<ϵ ]>1−δ.
t,n n t,n
A.6 Lemma
Lemma1. SupposeN,T,A,andc arepositiveintegersasdefinedinSection3.Thenthefollowingboundholds.
t,ft(a)
(cid:88)T (cid:88)A 1 √
√ <2 ANT
c
t=Na=1 t,ft(a)
Proof.
(cid:88)T (cid:88)A 1 (cid:88)T (cid:88)A 1 (cid:88)N (cid:88)T (cid:88)A 1 (cid:88)N c (cid:88)T,n 1
√
c
≤ √
c
= 1 ft(a)=n√
c
= √
j
(32)
t=Na=1 t,ft(a) t=1a=1 t,ft(a) n=1t=1a=1 t,n n=1j=1
Because √1
j
ismonotonicallydecreasingon[1,c T,n],therightRiemannsum(cid:80)c jT =, 1n√1
j
isanunderestimationof1+(cid:82) 1cT,n√1 xdx.
c (cid:88)T,n √1 ≤1+(cid:90) cT,n √1 dx=1+2√ x|cT,n=1+2√
c
−2=2√
c
−1<2√
c (33)
j x 1 T,n T,n T,n
j=1 1
ApplyingtheboundinEquation33toEquation32gives
(cid:88)T (cid:88)A 1 (cid:88)N √
√
c
<2 c T,n. (34)
t=Na=1 t,ft(a) n=1
WecanusetheformofJensen’sinequalityforaconcavefunctiontobound(cid:80)N √
c .
n=1 T,n
(cid:80)N n=1√ c T,n ≤(cid:115) (cid:80)N n=1c T,n
(cid:80)N
1
(cid:80)N
1
n′=1 n′=1
(cid:80)N
c isthetotalnumberofpullsperformedthroughtimeT,whichisAT sinceeachagentpullsonearmineverytimestep.
n=1 T,n
(cid:80)N n=1√ c T,n ≤(cid:114) AT =⇒(cid:88)N √
c
≤√
ANT (35)
N N T,n
n=1
ApplyingtheboundinEquation35toEquation34completestheproof.
A.7 MIN-WIDTHRegretBound
Theorem4(MIN-WIDTHRegretBound). SupposeweactaccordingtotheMIN-WIDTHalgorithm.ThenthecumulativeregretattimeT isbounded
withhighprobabilityaccordingto
(cid:34) (cid:35)
∀δ∈(0,1),P R <A(N−1)+2(cid:112) 2ANTln(2NG(T,A)/δ)maxS >1−δ.
T minSProof. First,wecanboundµ −µˆ by
n t,n
µ −µˆ ≤|µ −µˆ |=|µˆ −µ |.
n t,n n t,n t,n n
Usingtheboundon|µˆ −µ |fromEquation15gives
t,n n
∀δ∈(0,1),P[∀n∈N,t∈T ,µ −µˆ <ϵ ]>1−δ.
n n t,n t,n
Thisisequivalentto
∀δ∈(0,1),P[∀n∈N,t∈T,µ <µˆ +ϵ ]>1−δ.
n t,n t,n
RecalltheUCBonthemeanofarmnattimet∈T giveninEquation11as
UCB =µˆ +ϵ
t,n t,n t,n
withµˆ andϵ giveninEquations8and9,respectively.Wecanthenboundµ bythisUCBwithhighprobability.
t,n t,n n
∀δ∈(0,1),P[∀n∈N,t∈T,µ <UCB ]>1−δ.
n t,n
RecallthedefinitionofcumulativeregretfromEquation7.
T A
(cid:88)(cid:88) (cid:0) (cid:1)
R T= s
a
µ f⋆(a)−µ
ft(a)
t=1a=1
Letussplittheregretintotermswitht<Nandtermswitht≥N.
N−1 A T A
(cid:88)(cid:88) (cid:0) (cid:1) (cid:88)(cid:88) (cid:0) (cid:1)
R T= s
a
µ f⋆(a)−µ
ft(a)
+ s
a
µ f⋆(a)−µ
ft(a)
t=1a=1 t=Na=1
Because0<µ <1∀n∈N,thedifferencebetweenthemeansofanytwoarmsisboundedby
n
µ n−µ n′<1∀n,n′∈N.
ApplyingthisboundtothefirstterminEquation18withn=f⋆(a)andn′=f(a)gives
t
N−1 A T A
(cid:88)(cid:88) (cid:88)(cid:88) (cid:0) (cid:1)
R T< s a+ s
a
µ f⋆(a)−µ
ft(a)
.
t=1a=1 t=Na=1
Next,notethats ≤1∀a∈A.
a
N−1 A T A
(cid:88)(cid:88) (cid:88)(cid:88) (cid:0) (cid:1)
R T< 1+ s
a
µ f⋆(a)−µ
ft(a)
t=1a=1 t=Na=1
Thefirsttermthenreducessothat
T A
(cid:88)(cid:88) (cid:0) (cid:1)
R T<A(N−1)+ s
a
µ f⋆(a)−µ
ft(a)
.
t=Na=1
Now,weneedtoboundthesecondterm.Foreaseofnotation,defineR as
N:T
T A T (cid:32) A A (cid:33)
(cid:88)(cid:88) (cid:0) (cid:1) (cid:88) (cid:88) (cid:88)
R N:T= s
a
µ f⋆(a)−µ
ft(a)
= s aµ f⋆(a)− s aµ
ft(a)
.
t=Na=1 t=N a=1 a=1
UsingEquation17withn=f⋆(a)toboundµ f⋆(a)gives
(cid:34) T (cid:32) A A (cid:33)(cid:35)
(cid:88) (cid:88) (cid:88)
∀δ∈(0,1),P R N:T< s aUCB t,f⋆(a)− s aµ
ft(a)
>1−δ.
t=N a=1 a=1
Byconstruction,forallttheMIN-WIDTHalgorithmselectsaconfigurationfthatmaximizes(cid:80)A
a=1s aUCB t,ft(a).Thisimplies
A A
(cid:88) (cid:88)
∀t∈T, s aUCB t,f⋆(a)≤ s aUCB t,ft(a).
a=1 a=1
UsingEquation21inEquation20gives
(cid:34) T (cid:32) A A (cid:33)(cid:35)
(cid:88) (cid:88) (cid:88)
∀δ∈(0,1),P R < s UCB − s µ >1−δ.
N:T a t,ft(a) a ft(a)
t=N a=1 a=1PlugginginEquation11withn=f(a)gives
t
(cid:34) T (cid:32) A A (cid:33)(cid:35)
∀δ∈(0,1),P R <(cid:88) (cid:88) s (cid:0) µˆ +ϵ (cid:1) −(cid:88) s µ >1−δ.
N:T a t,ft(a) t,ft(a) a ft(a)
t=N a=1 a=1
Regroupingtermsyields
(cid:34) T A (cid:35)
∀δ∈(0,1),P R <(cid:88)(cid:88) s (cid:0) µˆ +ϵ −µ (cid:1) >1−δ.
N:T a t,ft(a) t,ft(a) ft(a)
t=Na=1
Sinceµˆ −µ ≤|µˆ −µ |,weget
t,ft(a) ft(a) t,ft(a) ft(a)
(cid:34) T A (cid:35)
∀δ∈(0,1),P R N:T<(cid:88)(cid:88) s a(cid:0)(cid:12) (cid:12)µˆ t,ft(a)−µ ft(a)(cid:12) (cid:12)+ϵ t,ft(a)(cid:1) >1−δ.
t=Na=1
UsingEquation15forn=f(a)gives
t
(cid:34) T A (cid:35)
∀δ∈(0,1),P R <(cid:88)(cid:88) s (cid:0) ϵ +ϵ (cid:1) >1−δ.
N:T a t,ft(a) t,ft(a)
t=Na=1
Thisreducesto
(cid:34) T A (cid:35)
(cid:88)(cid:88)
∀δ∈(0,1),P R <2 s ϵ >1−δ.
N:T a t,ft(a)
t=Na=1
Now,wepluginforϵ usingEquation9withn=f(a).
t,ft(a) t
(cid:34) (cid:88)T (cid:88)A (cid:115) ln(2NG(T,A)/δ) (cid:35)
∀δ∈(0,1),P R <2 s >1−δ.
N:T a 2(cid:80)A s 2c
t=Na=1 b=1 b t,b,ft(a)
Pullingoutconstantsgives
(cid:34) T A (cid:35)
∀δ∈(0,1),P R <(cid:112) 2ln(2NG(T,A)/δ)(cid:88)(cid:88) s a >1−δ.
N:T (cid:113)
t=Na=1 (cid:80)A b=1s b2c t,b,ft(a)
Notethat∀a∈A,s ≤maxSand∀b∈A,s ≥minS.
a b
(cid:34) T A (cid:35)
∀δ∈(0,1),P R <(cid:112) 2ln(2NG(T,A)/δ)maxS(cid:88)(cid:88) 1 >1−δ.
N:T minS t=Na=1(cid:113) (cid:80)A
b=1c
t,b,ft(a)
UsingEquation3forn=f(a)yields
t
(cid:34) T A (cid:35)
∀δ∈(0,1),P R N:T<(cid:112) 2ln(2NG(T,A)/δ)m ma inx SS(cid:88)(cid:88) √ c1 >1−δ.
t=Na=1 t,ft(a)
UsingLemmaA.6gives
(cid:34) (cid:35)
∀δ∈(0,1),P R <2(cid:112) 2ANTln(2NG(T,A)/δ)maxS >1−δ.
N:T minS
PluggingthisboundonR intoEquation19givesEquation16,completingtheproof.
N:T
B AdditionalExperimentalResults
Arepresentativegraphforthe2×2caseisshowninFigureB1.TableB1:Fivealgorithmsarerankedindescendingorderbylong-rangeperformance:MIN-WIDTH(M-W),MIN-UCB(M-UCB),NO-SHARING
(N-S),CUCB,andUCB.
ArmMeans Sensitivities Long-RangePerformance
0.1,0.9 M-W,M-UCB,N-S,UCB,CUCB
0.5,0.9 M-W,M-UCB,N-S,UCB,CUCB
0.1,0.9
0.1,0.5 M-W,M-UCB,N-S,UCB,CUCB
0.4,0.6 M-W,M-UCB,N-S,UCB,CUCB
0.1,0.9 M-W,M-UCB,N-S,UCB,CUCB
0.5,0.9 M-W,M-UCB,N-S,UCB,CUCB
0.5,0.9
0.1,0.5 M-W,M-UCB,N-S,UCB,CUCB
0.4,0.6 M-W,M-UCB,N-S,UCB,CUCB
0.1,0.9 M-W,M-UCB,N-S,UCB,CUCB
0.5,0.9 M-W,M-UCB,N-S,UCB,CUCB
0.1,0.5
0.1,0.5 M-W,M-UCB,N-S,UCB,CUCB
0.4,0.6 M-W,M-UCB,N-S,UCB,CUCB
0.1,0.9 M-W,M-UCB,N-S,UCB,CUCB
0.5,0.9 M-W,M-UCB,N-S,UCB,CUCB
0.4,0.6
0.1,0.5 M-W,M-UCB,N-S,UCB,CUCB
0.4,0.6 M-W,M-UCB,N-S,UCB,CUCB
0.1,0.9 M-W,M-UCB,N-S,UCB,CUCB
0.1,0.4,0.6
0.1,0.5,0.9 M-W,M-UCB,N-S,UCB,CUCB
0.1,0.9 M-UCB,N-S,M-W,UCB,CUCB
0.5,0.9 M-UCB,N-S,M-W,UCB,CUCB
0.1,0.2,0.9 0.1,0.5 M-UCB,N-S,M-W,UCB,CUCB
0.4,0.6 M-UCB,N-S,M-W,UCB,CUCB
0.7,0.9 M-UCB,N-S,M-W,UCB,CUCB
0.1,0.9 M-UCB,N-S,M-W,UCB,CUCB
0.5,0.9 M-UCB,N-S,M-W,UCB,CUCB
0.1,0.5,0.9 0.5,0.5 CUCB,M-UCB,N-S,M-W,UCB
0.1,0.5,0.9 M-W,M-UCB,N-S,UCB,CUCB
0.1,0.2,0.9 M-W,M-UCB,N-S,UCB,CUCB
0.1,0.9 M-W,M-UCB,N-S,UCB,CUCB
0.1,0.8,0.9 0.1,0.5 M-W,M-UCB,N-S,UCB,CUCB
0.1,0.5,0.9 M-W,M-UCB,N-S,UCB,CUCB
0.5,0.9 M-UCB,N-S,M-W,UCB,CUCB
0.4,0.6 M-UCB,N-S,M-W,UCB,CUCB
0.4,0.6,0.9
0.7,0.9 M-UCB,N-S,M-W,UCB,CUCB
0.1,0.5,0.9 M-W,M-UCB,N-S,UCB,CUCB
0.1,0.4,0.6,0.9 0.7,0.9 M-UCB,N-S,M-W,UCB,CUCB
FigureB1:RegretplottedovertimeforMIN-WIDTH(M-W),MIN-UCB(M-UCB),NO-SHARING(N-S),CUCB,andUCBaveragedover300
trialswithµ={0.1,0.5}andS={0.1,0.9}.FigureB2:RegretplottedovertimeforMIN-WIDTH(M-W),MIN-UCB(M-UCB),NO-SHARING(N-S),CUCB,andUCBaveragedover500
trialswithµ={0.05,0.1,0.12,0.15,0.25,0.3},S={0.8,0.8,0.8,0.95,0.95},S˜={0.85,0.85,0.85,0.98,0.98}.
FigureB3:RegretplottedovertimeforMIN-WIDTH(M-W),MIN-UCB(M-UCB),NO-SHARING(N-S),CUCB,andUCBaveragedover500
trialswithµ={0.05,0.1,0.12,0.15,0.25,0.3},S={0.8,0.8,0.8,0.95,0.95},S˜={0.75,0.75,0.75,0.9,0.9}.
FigureB4:RegretplottedovertimeforMIN-WIDTH(M-W),MIN-UCB(M-UCB),NO-SHARING(N-S),CUCB,andUCBaveragedover500
trialswithµ={0.05,0.1,0.12,0.15,0.25,0.3},S={0.8,0.8,0.8,0.95,0.95},S˜={0.75,0.75,0.75,0.98,0.98}.
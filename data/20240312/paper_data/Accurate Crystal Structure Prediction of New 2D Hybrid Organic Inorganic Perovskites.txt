Accurate Crystal Structure Prediction of New 2D Hybrid Organic Inorganic
Perovskites
Nima Karimitari,1, William J. Baldwin,2, , Evan W. Muller,3 Zachary J.
∗ † ∗
L. Bare,1 W. Joshua Kennedy,4 G´abor Cs´anyi,2 and Christopher Sutton1,
‡
1Department of Chemistry and Biochemistry, University of South Carolina, South Carolina 29208, United States
2Department of Engineering, University of Cambridge, Cambridge CB2 1PZ, UK
3UES, Inc., Beavercreek, Ohio 45432, United States
4Materials and Manufacturing Directorate, Air Force Research Laboratory,
Wright-Patterson AFB, Dayton, Ohio 45433, United States
(Dated: March 12, 2024)
Lowdimensionalhybridorganic-inorganicperovskites(HOIPs)representapromisingclassofelec-
tronically active materials for both light absorption and emission. The design space of HOIPs is
extremely large, since a diverse space of organic cations can be combined with different inorganic
frameworks. Thisimmensedesignspaceallowsfortunableelectronicandmechanicalproperties,but
also necessitates the development of new tools for in silico high throughput analysis of candidate
materials. In this work, we present an accurate, efficient, transferable and widely applicable ma-
chine learning interatomic potential (MLIP) for predicting the structure of new 2D HOIPs. Using
the MACE architecture, an MLIP is trained on 86 diverse experimentally reported HOIP mate-
rials. The MLIP is tested on 73 unseen perovskite compositions (that were previously reported
experimentally), and achieves chemical accuracy with respect to the reference electronic structure
method. Our model is then combined with a simple random structure search algorithm to predict
thestructureofnewHOIPsgivenonlytheproposedcompositionasinput. Successisdemonstrated
by correctly and reliably recovering the crystal structure of a set of experimentally known 2D per-
ovskites. Sucharandomstructuresearchisimpossiblewithabinitiomethodsduetotheassociated
computational cost, but is relatively inexpensive with the MLIP. Finally, the procedure is used to
predict the structure formed by a new organic cation with no previously known corresponding per-
ovskite. Laboratory synthesis of the new hybrid perovskite confirms the accuracy of our prediction
using the combined MLIP and structure-search algorithm. This capability will enable the efficient
and accurate screening of thousands of combinations of organic cations and inorganic layers for
further investigation.
Hybrid organic-inorganic perovskites (HOIPs) belong cations with +1 charge) [5]. Two dimensional HOIPs
to a broad category of materials, generally represented havetheadvantagesofenhancedstabilityunderambient
by the chemical formula ABX . The B-site and X-site conditions and structural tunability. This makes them
3
ions form a network of corner-sharing BX octahedra. promising candidates for applications in photolumines- 6
AlthoughtheA-sitecanbealargeinorganiccation,such cence (PL), photovoltaics, photodetection, and light em-
ascaesium,usinganorganiccationhasprovedextremely mitting diodes (LEDs) [6–9].
successful,resultinginthedevelopmentofstateoftheart
Due to the breadth of the design space of 2D (as well
solution-processedoptoelectronicmaterials[1]. Provided
as1Dand0D)perovskites,in silicopropertyscreeningis
the organic cation is small, the typical perovskite struc-
desirable. However, in order to calculate properties with
tureisretained. Forlargercations,however,thenetwork
ab initio electronic structure methods, one first needs
of corner sharing octahedra is disrupted, leading to ‘low
to know the crystal structure. A similar task has been
dimensional’ structures such as one-dimensional chains
tackledinthefieldoforganiccrystalstructureprediction
or two-dimensional sheets of octahedra (see Fig. 1b).
(CSP): typically, CSP methods involve generating many
Two-dimensional HOIPs are formed when the organic
hundreds or thousands of candidate structures, and se-
cations separate the inorganic layers in the (100), (110)
lecting the lowest energy structures using an empirical
or (111) direction, giving the modified general formula
force field [10]. For general inorganic crystals, the re-
A’ A B X . The constants n and m determine
m n–1 n 3n+1 lated Random Structure Search (RSS) method has been
the number of connected inorganic layers and the charge
successfulforunitcellsofuptoacoupleofdozenatoms,
of the organic cation. They are further categorized into
wherein candidate structures are generated and the ge-
two main types: Dion–Jacobson (DJ) [2] with m = 1
ometry is subsequently relaxed to the nearest local min-
(onesheetofinterlayercationswith+2charge)andRud-
ima in the potential energy landscape [11].
dlesden–Popper (RP) [3, 4] with m = 2 (two sheets of
A particular difficulty in the case of 2D HOIPs is that
theycanhaveextremelylargeunitcellscontainingupto
∗ Theseauthorscontributedequally 1000 atoms. Furthermore, they are structurally complex
† wjb48@cam.ac.uk (see Fig. 1) with the organic molecules having many po-
‡ cs113@mailbox.sc.edu tentially quite flexible degrees of freedom. Direct Den-
4202
raM
11
]ics-lrtm.tam-dnoc[
1v55960.3042:viXra2
sity Functional Theory (DFT) geometry relaxations or of competing low energy minima, with subtly different
molecular dynamics simulations are therefore extremely orientations and stacking patterns of the organic cation.
expensive,whileempiricalforcefieldswhichareaccurate Duetothehighdegreeofsimilaritybetweenthesestruc-
across the desired range of chemical interactions do not tures, an accurate and efficient search tool offers many
exist presently. insightsbeyondjustpredictionofthegroundstatestruc-
An alternative to doing ab initio calculations is to use ture.
machine-learnedinteratomicpotentials(MLIPs)[12–15].
MLIPs can be trained to predict the potential energy of
aconfigurationofatomsdirectlyfromtheatomiccoordi- I. DATASET CONSTRUCTION
nates, allowing for simulations of hundreds of thousands
of atoms at DFT accuracy [16]. Many MLIP architec- A dataset was compiled from three sources: The 2D
tures have been developed in recent years. Key develop- perovskites database of the laboratory of new materials
ments in this area have been the focus on atom-centered for solar energy (NMSE) [31], the Cambridge Structural
energy contributions enabling linear scaling models, the Database [32], and a recent research article by Tremblay
incorporation of physical symmetries into model archi- et al. reporting numerous 2D HOIP structures [33].
tectures [17–19] and efficient construction of many-body The occurrence of different chemical elements and
representationsofatomicenvironments[20–22]. Further- structural features in these sources was quite non-
more, the introduction of graph models to MLIP devel- uniform. Several simplifying restrictions have therefore
opmenthasleadtogreatlyimprovedaccuracyandtrans- been placed on the scope of our model. Firstly, the set
ferability [23–25]. MLIPs have already been used to per- of chemical elements considered for the inorganic layer
form structure prediction for large scale screening tasks, was restricted to only include Pb,I,Br and Cl. As a re-
forexampleinacomputationalstudysearchingfornovel sult,theresultingMLIPcanbeappliedtoonlyPb-based
stable inorganic materials [26]. perovskites, with X = I, Br, or Cl. Furthermore, we re-
Inthiswork,theMACE[27]messagepassingarchitec- stricted the composition of the organic cation to include
ture was used to build a transferable MLIP for HOIPs. only C, H, N and O. These restrictions were imposed
MACEisagraphtensornetworkwhichconstructsmany- due to the occurrence of different chemical elements in
body equivariant messages at each node (nodes corre- the available 2D HOIP datasets: of the structures we
spond to atoms in this case) via the atomic cluster ex- collected, more than 80% were lead-based, and the ma-
pansion [21], which are then passed onto neighbouring jority contained only C, H, and N elements in the or-
nodes. The architecture has been shown to be accurate, ganic cation. Applying these filters resulted in an initial
efficientandtransferable[28],andhasrecentlybeenused dataset of 159 experimentally reported structures. Fig.
to create a state of the art ML organic force field[29] 1a presents some key statistics of this dataset including
and a “foundation model” for materials chemistry[30]. the number of atoms in the unit cell and organic cation,
The model in this work is fitted to data collected from as well as a breakdown of the elements present at the
severalpubliclyavailabledatabasesofexperimentallyre- X-site, number of inorganic layers, organic cation charge
portedHOIPs. Startingfromstructuresreportedinthese and whether the organic cation contains oxygen. Four
databases, an extensive training dataset was generated representative example structures are shown in Fig. 1b
by running an active learning protocol based on molecu- to illustrate the diversity of the perovskites that are in-
lardynamics. Collectedconfigurationswerelabelledwith cluded.
DFTcalculations. Thefinalmodelachievesexcellentac-
curacy across an independent set of perovskites with un-
seen compositions taken from the same sources. II. MODEL DEVELOPMENT AND
To use the model effectively, we present a simple ran- PERFORMANCE
dom structure search procedure designed for 2D HOIPs
and we show that the trained MLIP accurately captures A. Active Learning for Dataset Expansion
thecomplexpotentialenergylandscapeencountereddur-
ing a random structure search task. Furthermore, the In the following, composition will refer to a perovskite
combinationofthestructuresearchingalgorithmandthe as determined by the chemical formula and the experi-
MACE model is an accurate and efficient structure pre- mentallyreportedunitcell, whileconfiguration willrefer
dictiontool. Thisisshownby‘re-discovering’theground to a specific non-equilibrium set of atomic positions, for
statestructureofasetofexperimentallyreportedHOIPs which one could compute a reference energy using DFT.
notseenbythemodelduringfitting,givenonlythemost The dataset described above serves as a starting point
basic information of the perovskite - the identity of the for fitting a MLIP. In practice, however, fitting accurate
organiccationandthecompositionoftheinorganiclayer. and stable models requires a database with many non-
Finally, we predict the crystal structure of a previ- equilibriumconfigurationsforeachtargetcompositionor
ously unknown 2D HOIP. We then synthesize the mate- phase. One popular method for database construction is
rialinthelaboratory,andverifythatthestructureagrees to sample configurations from molecular dynamics tra-
with our prediction. The process reveals a large number jectories. In this study, a different approach is taken in3
FIG. 1: (a): Key properties of the perovskites in the compiled dataset. Note that some structures have multiple
organic cations, but the upper right histogram shows only the size of the largest cation in each structure. (b):
Examples of 2D HOIP structures in the dataset.
which a database of reference configurations is grown it- MDsimulationstartingfromtheexperimentallyre-
eratively in an active learning procedure[34, 35]. ported structure and using the average of the force
Before beginning the active learning procedure, the predictionsofthecommitteememberstopropagate
datasetofexperimentallyreportedcompositionswasfirst the dynamics. At each time step, test the uncer-
divided in two, by randomly sampling 86 perovskites to tainty of the potential by calculating the disagree-
form the core of the training set. The remaining test set mentinthepredictionoftheatomicforcesbetween
compositions will be used to assess the transferability of the committee members.
the final model to new unseen perovskites.
3. Iftherelativeforceuncertaintyofanyatom,defined
The key principle of active learning is to use a model
as the standard deviation of the committee force
which can estimate the uncertainty of its own prediction
predictions divided by the mean of the forces, is
on a given configuration. If this estimate is reliable, one
larger than a specific threshold (in our study this
can search for configurations on which the model is un-
threshold is to 0.2, see also section XB) the MD
certain,andaddonlytheseconfigurationstothedataset.
simulation is terminated. DFT energy and forces
SeveralmethodsexistforconstructingMLIPswithanin-
are calculated for the configuration for which the
built measure of prediction uncertainty. For MACE, the
uncertainty exceeded the threshold, and added to
uncertainty estimate can be obtained as follows: given
thetrainingset. Iftheuncertaintydoesnotexceed
a dataset, one fits several independent models with the
the threshold within 10 ps, terminate the MD and
same hyperparameters, but with a different random ini-
do not collect any new configurations.
tialisation of weights. These models are then referred to
as a committee, and in this case, we use only 3 mod-
4. Refit the committee of models with the expanded
els to form the committee. On a new configuration, the
dataset. It is expected that the configurations
disagreement between the committee members can be
wherethemodelspreviouslydisagreedarenowwell
treatedasanuncertaintyestimate. Aswillbeshownbe-
described with low uncertainty.
low, this comparatively inexpensive procedure leads to
remarkably useful uncertainty estimates. 5. Repeat steps 2-5 until no new configurations are
With this method for assessing the uncertainty of a collected for any of the compositions.
model, the active learning procedure is as follows:
Ineachcycleofactivelearning, werancommitteeMD
1. Givenaninitialdatasetofconfigurations,calculate foreachofthe86compositionsinthetrainingset. Addi-
referenceenergiesandatomicforcesusingDFT.Fit tional configurations are therefore collected at a rate of
a committee of 3 MACE models on this dataset. 86percycleiftheuncertaintyforallcompositionsexceed
thethreshold. However,asthedatasetgrows,manycom-
2. For each composition in the training set, run an positions quickly become well described and do not trig-4
100 (a)
Unstable Potential
Final Potential
102
10 1
101
0 1 2 3 4 5
Time (ps) (b)
4.5
FIG. 2: The relative force uncertainty and actual force
error for one HOIP as a function of time during an MD
simulation. The unstable potential (dashed lines) 5.0
Training = 0.76 meV/atom
occasionally exceeds the relative force uncertainty Test = 1.84 meV/atom
threshold (red solid line at 0.2) with actual force errors 5.5
as large as 100 meV/˚A, while the final potential
remains far below the threshold with force errors
6.0
fluctuating between 10 to 20 meV/˚A.
6.5
6.5 6.0 5.5 5.0 4.5
ger new DFT calculations, resulting in few new training DFT Energy (eV/atom)
configurations per cycle. For this reason, in later cycles
step3wasrepeated10timesforeachtrainingsetcompo- FIG. 3: The parity plot of (a) forces, and (b) energy
sition before retraining the model. The final potential is (per atom) for training and test set samples.
fitted once all the unique perovskite compositions in the
training set are stable, meaning that in 10 independent
MD simulations lasting 10 ps each, the 0.2 relative force are just 7 types of inorganic layer. Therefore, the high-
uncertaintythresholdisnotexceeded. Additionaldetails est force uncertainty typically occurred on the organic
on the active learning procedure are given in section XB cations.
Keytothismethodisthereliabilityoftheuncertainty
measure. Anexampleoftheevolutionoftheuncertainty
measure during a committee MD simulation is shown in B. Final Model Performance
Fig. 2. To assess the uncertainty measure, all configu-
rations in the trajectory were evaluated with DFT, and In total, 18 cycles of active learning were performed.
the actual force error made by the model at each time The final training dataset contains a total of 2457 con-
step is also shown. Two models from different stages in figurations. To test the final potential, MD simulations
the active learning procedure are shown - an ‘unstable’ of73unseentestsetcompositionswereranfor10psand
model from an early point in the active learning process, samplesweretakenevery1ps. Theenergyandforcepre-
and the the final model. dictions for all the training and test samples are shown
Fortheunstablepotential,theuncertaintyexceedsthe in Fig. 3. The RMSE of training (test) dataset for en-
threshold (the solid red line) at multiple instances, and ergyandforcesare0.76(1.84)meV/atomand10.7(31.7)
eventually increases to 1.0 implying total uncertainty in meV/˚A, respectively. In addition, the errors categorized
force predictions. By contrast, the final potential has based on the halide atoms are shown in Table. I. An
both a consistently lower uncertainty and a lower force energyerrorof1kcal/mol(typicallycalled“chemicalac-
error. The key result shown in Fig. 2 is that the differ- curacy”) corresponds to 43.4 meV per formula unit.
ence in force error between the final model and unstable
model is clearly reflected in the estimated uncertainty.
Alsoimportantisthatthespikesintheforceerrorofthe III. RELAXATION OF EXPERIMENTALLY
unstable model closely correlate with the spikes of the REPORTED STRUCTURES
relative force uncertainty.
In general, the highest uncertainty occurs for atomic Experimentally reported structures are typically close
configurations that are less represented in the training to the global minima of the potential energy surface.
set. In particular, there are 61 unique organic cations in For the trained MACE model to be useful for structure
the 86 compositions of the training dataset, while there searching, it must relax these structures to the same lo-
ytniatrecnU
ecroF
.leR
)Å/Vem(
rorrE
ecroF
)mota/Ve(
ygrenE
ECAM5
TABLE I: Energy and force errors for seen and unseen IV. HIGH THROUGHPUT STRUCTURE
configurations categorized based on the halides PREDICTION FOR NEW HOIPS
Seen Compositions Unseen Compositions
Calculating properties of known perovskite structures
Energy Forces Energy Forces with ab initio methods is expensive, but not impossible.
(meV/atom)(meV/˚A) (meV/atom)(meV/˚A) Ontheotherhand,highthroughputstructureprediction
Cl 0.86 9.25 1.86 30.4 for many new compositions is potentially an infeasibly
I 0.74 10.96 1.34 29.88 expensivetask,particularlyforstructureswithlargeunit
cells. This is because crystal structure prediction proto-
Br 0.78 10.39 2.12 48.53
cols typically involve a very large number of either ge-
Total 0.76 10.71 1.84 31.67
ometry relaxations or single point evaluations to predict
the structure of just one chemical composition.
In particular, organic crystal structure prediction in-
volves first generating many (thousands) of candidate
cal minima as would be obtained by a DFT geometry crystal structures by enumerating over key variables,
relaxation. To assess whether this is the case, we con- such as space groups, and employing heuristics. Sin-
sidered 137 perovskite compositions in the dataset that gle point evaluations with empirical force fields are used
have less than 200 atoms, with 58 from the training set to select good candidates, based on lowest potential
and 79 from the test set. For all of these compositions, energy[10].
the experimentally reported structure was relaxed inde- Abinitiorandomstructuresearch(AIRSS),isanother
pendently with DFT and MACE calculators, until the approachthathasbeenexplored[11],particularlyforin-
forces were less than 10 meV/˚A. organic crystals. In this approach, crystal structures are
determined by first guessing random positions of atoms
OnewaytoquantifythedifferencebetweentheMACE within the unit cell, followed by geometry relaxations
andDFT relaxedstructuresisto measuretheroot mean withDFT.Again,thelowestenergystructureischosenas
square displacement (RMSD) of the atoms between the the most probable structure. AIRSS has been employed
two structures. The distribution of RMSD for all 137 successfully to find ground state structures of materials,
compositions is shown in Fig. 4a. For the majority of molecules and features such as defects [11]. This process
the samples, the RMSD is less than 0.1 ˚A. Several out- ispowerful,butlimitedtosmallunitcellsduetothepoor
liers are present with larger RMSDs on the order of 0.3- scaling of DFT.
0.5 ˚A. These outliers generally correspond to cases in Inthefollowingweintroduceasimplestructuresearch
which long, flexible organic molecules move slightly with procedure inspired by these ideas, which is appropriate
respect to each other. for 2D HOIPs.
The independently obtained DFT and MLIP relaxed
structures can also be compared using the total radial A. A Random Structure Search Procedure for 2D
distributionfunction(RDF),whichcontainsinformation HOIPs
about the bond lengths, intermolecular distances and
organic-inorganic distances in the structure. A compar- Our proposed structure searching workflow is sum-
ison between the RDFs of a MACE and DFT relaxed marised as follows: For a given organic cation and inor-
structure is shown in Fig. 4b. For r <3 ˚A, which mostly ganic layer, generate a fixed number of candidate struc-
corresponds to the intramolecular bond distances, the tures, which cover the space of feasible molecular and
differences between MACE and DFT are negligible. For atomic arrangements. The geometry of all structures is
r > 3 ˚A, which contains both the intermolecular dis- thenrelaxedtoalocalminimumusingtheMLIPandthe
tances and inorganic bonds, some differences are appar- lowest potential energy structure is declared as the most
ent,howeverthestructuresrelaxedwithMACEandDFT probable crystal structure. The process for generating
share many of the larger features. random candidate structures is key, and a scheme was
designed based on several simple heuristics. The steps
ToquantifythedifferencebetweentheRDFsofMACE are summarised as follows and shown visually in Fig. 5:
and DFT relaxed structures, we used the first Wasser-
stein distance (the earth mover’s distance, EMD) be- 1. The starting information is the identity of the or-
tween these two distributions, which calculates the least ganic cation, the choice of halide, and the desired
amount work required to change one distribution to the size of the unit cell. The size is determined by the
other [36]. A histogram of the Wasserstein distances for number of organic/inorganic layers, and the num-
63 randomly selected compositions in the train and test ber of octahedra per layer in the unit cell.
sets is shown in Fig. 4c. One can see that the final
MLIP performs similarly for both training and test sets 2. Forthegivencomposition,constructthe3Dgeome-
using this metric. try of the organic cation (enumerating or sampling6
(a) (b) (c)
50
Training
0.10 Test
40
30
20 0.05
10
0 0.00
0.0 0.1 0.2 0.3 0.4 0.5 Distribution
RMSD (Å)
FIG. 4: Evaluating the MACE model for geometry relaxations of experimentally reported structures. (a) Histogram
of the RMSD between the DFT relaxed and the MACE relaxed structures for the entire dataset. (b) Comparison of
the total RDF for a test set structure after relaxing with DFT and MACE. (c) The distribution of the Wasserstein
distance between the RDFs given by the DFT relaxed structure and MACE relaxed structure for 137 unique HOIPs
in the training and test set.
conformers if necessary). Also construct the un- WillBaldwin0/LDHP-builder. The algorithm is specific
tilted, strain-free inorganic layer from lead and the to 2D corner-sharing HOIPs, since it relies on heuris-
chosen halide. This determines the periodicity of tics when placing molecules onto the inorganic layer. In
the system in the in-plane directions. practice, it was found that these heuristics perform re-
markably well. Further details are provided in section
3. Identify‘referencepoints’onthecationandthein-
XD.
organic layer. On the cation, reference points are
definedasformallychargedatomsorsalientatoms.
Ontheinorganiclayer,thereferencepointsarecho-
B. Validation of the Model on Randomly
sentobethemidpointsbetweenprotrudinghalides,
Generated Structures
as shown in Fig. 5.
4. Based on the charge of the organic cation, deter- For an MLIP to be useful for the structure prediction
mine the number of cations per layer required for task,themodelmustbeaccuratefortherandomlygener-
charge neutrality. For each organic cation in the atedstructuresandmustnotexhibitmanyspuriouslocal
unitcell,randomlygenerateasetofreflectionsand minima. Crucially, itshouldreliablyrelaxthestructures
rotations to apply to the organic cation. Subse- to nearby DFT minima.
quently, place the transformed cations onto the in- To demonstrate the accuracy of the model and struc-
organiclayerbypairingreferencepointsonthetwo turesearchingmethod, wepresenttheresultsofthepro-
geometries. cess applied to a known 2D perovskite in Fig. 6. Specif-
ically, we take the the perovskite formed by PbI oc-
6
5. Check for any intersections between cations, or in-
tahedra in the inorganic layer and the organic cation
tersectionsofcationswiththeinorganiclayer. Dis- NH +[C] NH +. The(geometryrelaxed)experimentally
3 6 3
card samples for which these components intersect
reported structure is shown on the right of Fig. 6(c).
one another.
Given the composition, 100 random structures were
generatedusingtherandomgenerationprocedure. Three
6. Fix the lattice constant in the out-of-plane direc-
examples of such structures are shown in Fig. 6b. To
tiontoremovemostofthevacuumregionfromthe
simplify this demonstration, only the correct conformer
cell, including some amount of shear of the unit
oftheorganiccationwasusedtogeneratesamples. Sub-
cell. If more than one inorganic/organic layer per
sequently, these 100 structures were relaxed using the
unitcellisdesired,repeattheaboveprocedureand
MACE model. Since the initial samples are relatively
stack the resulting geometries.
highinenergy-oftencontainingaconsiderableamountof
This process gives structures which sample the con- vacuum or non-physical molecular arrangements - these
figuration space well but which can contain high energy geometry relaxations require several hundreds or even
features, such as regions of vacuum or atoms at energet- thousands of steps. Fig. 6(a) shows the distribution of
ically unfavourable separations. Crucially, the configu- energy of the resulting structures, ordered by increasing
rations are sufficiently sensible that geometry relaxation energy, relative to that of the experimentally reported
leads to reasonable structures. structure. Also shown is the energy of the relaxed sam-
A python package was written to implement this ples after re-evaluation with DFT.
algorithm which is available at https://github.com/ Several important features can be noted. Firstly, due
tnuoC
ecnatsiD
nietsressaW7
equal to that of the experimentally reported structure.
This suggests that the process has indeed re-discovered
thetheexperimentallyreportedstructure. Thiswascon-
firmedbyexaminingthefivelowestenergyrelaxedstruc-
tures. Up to rotations, reflections and cell reductions,
these structures are identical and match the experimen-
tally reported structure as shown in Fig. 6(c).
C. Structure Prediction Performance across the
Dataset
We now demonstrate the usefulness of this procedure
across a wider variety of 2D perovskites. The method
described above has been applied to 13 structures in the
dataset. Fig. 7 summarises the results of this process.
The lower rows identify the perovskite structure, via the
halide in the inorganic layer and the organic cation. The
upper panel shows the distribution of energies of the re-
laxed structures, following the random generation and
relaxation process, with respect to that of the experi-
mentally known structures. For this demonstration, 200
random structures were generated for each halide/cation
combination. Only 200 samples were required, since all
but the last two structures in figure 7 have unit cells
containing only 2 organic cations. Fig. 7 also highlights
which structures were present in the training set of the
MLIP model. For the left-most structures, samples of
theseperovskitesacquiredfrommoleculardynamicsdur-
ingtheactivelearningprocessarepresentinthetraining
set of our model. For the next set of structures, the or-
FIG. 5: Overview of the structure generation algorithm
ganiccationispresentsomewhereinthedataset,butthe
for creating initial guesses for the random structure
combination of cation and inorganic layer is not present.
search process. To make the figure more readable, the
For the four right-most structures, the organic cation is
unit cell is only shown for one of the four candidate
not present in the dataset.
structures in the lower panel.
Inallbutthreecasestheidentifiedstructureswithlow-
est energy correspond to the energy of the experimen-
tal structure. Subsequent comparison showed that these
to the nature of the long organic cation, which can stack
structuresdidindeedmatchtheexperimentallyreported
in a variety of ways, the relaxation process reveals many
version. Therefore, the combination of a simple random
local minima in the potential energy landscape. These
structuresearchingschemewiththedevelopedMLIPcan
appear as plateaus in the energy plot (bottom panel of
successfully identify the ground state structure of these
Fig. 6(a)). After re-calculation of these structures with
complex systems.
DFT, we see that the MLIP energy landscape is broadly
correct in that these minima are correctly ordered with Inthethreecasesforwhichthelowestenergystructure
respect to DFT. The absolute energy error is also very does not match the experimentally reported structure,
low, being around 1 meV/atom which is roughly the ac- one structure search failed to find any structures with
curacy of the model. Furthermore, the top of panel of energyaslowasthatoftheexperimentalstructurewithin
Fig. 6(a) shows the root mean square force, according the 200 searches (the lowest energy found was about 2
to DFT, of the MLIP identified minima. For all but the meV/atom higher than the energy of the experimental
highest energy configurations, the DFT forces are less structure). In the other cases, we confirmed that the
than 10 meV/˚A, suggesting these are close to DFT min- procedure found the experimental minima as well as a
ima. lowerenergystructure. SubsequentevaluationwithDFT
The lowest energy structures identified by this proce- revealed that these structures were also assigned a lower
dure (the first five blue marks in Fig. 6a) have energy energy than the experimental structure by DFT.8
FIG. 6: Rediscovering the structure of known a 2D perovskite. (a) Lower panel: formation energy (meV/atom)
(blue) for the 100 randomly generated candidate structures, after geometry relaxation with the MLIP. Structures
have been ordered according to increasing energy. Red points and lines show the same structures re-calculated with
DFT. Upper panel: Root mean square forces, according to DFT, of each of the relaxed structures. (b) Examples of
the initial random configurations. (c) Comparison between the structure obtained by relaxing the experimentally
determined structure, and the five lowest energy structures found by the screening method.
D. Prediction and Synthesis of new 2D Hybrid the likely error in our model, as well as the error of DFT
Perovskites due to finite k-point sampling.
Several interesting points can be made about these re-
Finally,thestructuresearchprocesswasperformedfor sults: firstly, the lowest lying minimum found by the
a new organic cation with no previously known corre- structure search process agrees with the experimentally
spondingperovskite. Specifically,thecombinationofcis- measured structure. Since our model is fitted to DFT
1,3-cyclohexanediamine with a Pb–I inorganic layer was data which does not perfectly match reality, differences
studied. This molecule is not present in our dataset, but are unavoidable in quantities such as equilibrium bond
consists of chemical groups which are well represented. lengths,wherethePBEfunctionalmakesanerror. How-
Thestructuresearchingprocedurewasconductedwith ever, we can confirm that we predict the right structure
aunitcellcontaining8copiesoftheorganiccation,across by performing a geometry relaxation, with our model, of
two layers. In total, 6000 samples were generated, with the experimentally reported structure. This resulted in
the large number being required due to the large num- exactly minimum 0, and the relaxation trajectory only
ber of molecules present in the unit cell. The perovskite involved only minor changes in bond length, as shown in
was synthesised via slow hydrothermal growth and the the supplementary information.
resulting structure was determined, at 200 K, using a The 5 next lowest energy minima all involve similar
diffractometer as described in section XE. orientations of the organic cation, but differ in the set of
Figures 8a and 8b show the resulting lowest energy reflectionsappliedtothecationsortheoutofplanestack-
structure (denoted as “minimum 0”), as well as the 5 ing vector. It is interesting to examine how easily one
next lowest energy structures that were predicted. As could differentiate between these structures using differ-
shown in the figure, the energy differences between the ent experimental techniques. This was done by measur-
lowestlyingminimaareextremelysmall,withthe5next ing the powder x-ray diffraction pattern (pXRD) of the
best minima being only 0.5 meV/atom higher in energy synthesised perovksite, and comparing to the computed
the ground state. This energy difference is smaller than patternofthelowestenergyminima,asshowninFig. 8c.9
FIG. 7: Performance of the random structure searching protocol applied to 13 experimentally known structures.
Lower panel: Each combination of halide and organic cation shown in the lower part of the figure describes a
perovskite present in the dataset. Some of these structures were used to train the model whereas others are unseen.
Upper panel: Violin plots of the energy distribution of the random samples after geometry relaxation with MACE,
relative to the energy of the geometry relaxed experimental structure. In the ideal case, the lower end of each violin
plot would sit on the dashed line, indicating that the minimum energy structure found by the procedure is indeed
the experimentally reported one. Structures are grouped into three categories. The first group contains perovskites
which are present in the training set of the model. Following this are structures for which the combination of halide
and cation is not present in the training set, but the cation is present paired with a different halide. The last group
contains structures where the organic cation is not present anywhere in the training set.
We compare the experimental result to that predicted trosymmetric. Thismeansthatitwillnotexhibitcircular
from the experimentally reported structure, as well as dichroism which is necessary for certain applications of
minima0,2and5. Thedifferencesbetweenthepredicted 2Dperovskites. Whentargetingcertainproperties,afull
XRD of the experimentally reported structure and mini- pictureofthelandscapeoflowenergyminimumisclearly
mum0(orangeandgreeninFig. 8c)comeonlyfromthe important. Ourstructuresearchingmethodoffersawin-
aforementioned small differences in bond lengths. Inter- dow into this landscape, which could be used to choose
estingly, the spectra of the three numbered minima are experimentalmethods,orgainconfidenceinconclusions.
almost indistinguishable; it would be extremely difficult
torobustlydifferentiatethesestructuresfromthepXRD
alone. Further predictions were made for 4 other organic
Furthermore, the small differences in molecular stack- cationswhichhadnopreviouslyknownperovskitestruc-
ing lead to different optical properties. For example, out tures. These are discussed in the supplementary infor-
of the six structures in Fig. 8, only minimum 0 is cen- mation.10
FIG. 8: Comparing the lowest energy structures during the structure prediction task for a
cis-1,3-cyclohexanediamine based perovskite. Since these unit cells are relatively complex, and differences between
structures are subtle, we have tried to find ‘equivalent’ representations of the unit cells for comparison. Cif files of
all structures are available. (a) The lowest energy minimum found during our procedure, which is equivalent to the
structure deduced by experiment. The unit cell contains 8 molecules and 232 atoms. (b) The next 5 lowest lying
minima, and their energy above the lowest structure. All the structures shown contain 8 molecules, however when a
structure adopts a higher symmetry and hence a smaller unit cell, some molecules appear to hide behind others.
The key difference between minimum 0 and minimum 4 is the out of plane lattice vector. (c) Comparison of the
experimentally measured pXRD with some chosen minima. “Experimentally deduced structure” refers to the unit
cell as deduced using the ShelXT program from data obtained by diffractometer (see also section XE).
E. Scalability and Computational Cost namics steps for each relaxation.
Inthestructuresearchingprocessforthe13structures
Performingtheaboveprocessrequiresgeometryrelax- inFig.7, theaverageunitcellsizewas78atomsand200
ationofmanylargecrystalstructures,startingfromhigh samplesweregeneratedforeachsystem. Theentiresetof
energy configurations. Typically, several hundred relax- calculationsusedtoproduceFig.7wasperformedinonly
ations are required with hundreds to thousands of dy- 20 hours on a single A100 GPU. This suggests that wide11
searches can be performed using modest computational
resources. Bycomparison,asingleDFTrelaxationofone
sample of the randomly generated structures shown in
Fig.6(similarinsizeandcomplexitytoFig7structures),
performedontwonodes(256cores)ofAMDEPYC7742,
can take more than one day. Furthermore, the cubic
scaling of the DFT calculation makes the same task for
much larger systems infeasible.
Onecanalsoseethecomputationaladvantageofusing
our model in the structure search for the newly synthe-
sised perovskite (section IVD), which has 8 molecules
and 232 atoms in the unit cell. For each sample of the
6000 generated structures, relaxation took between 2000
to 4000 steps, leading to a total computational cost of
240 GPU hours. We estimate that performing the same
relaxations with DFT would require approximately 1.2
million CPU node-hours. In this case the speedup corre-
sponds to a factor of 104. Note that the absolute times FIG. 9: The force parity plot for cyclopropanaminium
ofcoursedependonthetypeofGPUandCPUhardware for three differently trained potentials. An ‘unseen’
making a direct comparison not straightforward, but in MLIP, with no samples of cyclopropanaminium,
terms of costing computational resources, an A100 GPU relaxed-model which has 200 randomly selected samples
hour is approximately comparable to a node-hour with from the relaxation trajectories of the structure
128 CPU cores, and hence is the basis for the figures prediction model in the training set, and relaxed+MD
given above. which takes the top 10 most stable structures, followed
by samples taken uniformly from MD trajectories. The
two former MLIPs were trained independently.
V. EXTRAPOLATION TO
UNDERREPRESENTED ORGANICS
tures with the new organic cation. One can relax these
We have demonstrated good performance of the candidates with the model, take samples from the re-
trained MLIP both in terms of single point accuracy laxation trajectories, and add them to the training set.
and in relaxing randomly generated HOIPs structures As shown in Fig. 9, when the model is trained with 200
to global minima. However, it is the case that many distinct samples from relaxation trajectories of cyclo-
of the organic molecules in the test set are structurally propanaminium lead iodide, the resulting force RMSE
andchemicallysimilartotheorganicsinthetrainingset. is 95.3 meV/˚A, a slight improvement over the original
Herewedemonstrateanexampleoforganiccationinour model. The meager improvement may be because many
testset,cyclopropanaminium(showninFig.9),forwhich of the predicted relaxed structures are very similar, in
the model performs poorly and suggest an efficient way terms of bond distances and orientation of the organic
retraining the model to improve the predictions. and inorganic components. A successful approach is to
For the original MLIP, which has not been trained on combine the structure prediction tool with MD simu-
any examples of cyclopropanaminium, committee MD lations. Instead of taking 200 samples from the relax-
simulations immediately exceed the prescribed uncer- ationstrajectories,wetakeonlythe10moststablestruc-
tainty threshold, indicating an uncertainty of the model tures predicted by the structure prediction algorithm,
inpredictingforces. Onsamplesthataretakenfromthis run short MD simulations (5 ps) and take samples uni-
MD, the model makes a large error with respect to DFT formly every 1 ps from the MD trajectories. Note that
with a force RMSE of 228.7 meV/˚A. we do not terminate the MD simulations based on un-
Oneapproachwouldbetoaddsomeoftheseuncertain certainty. Using this to add new data, the error in forces
high-errorsamplestothetrainingsetandusetheALcy- dropsto14.6meV/˚A,withintherangeofpreviouslyseen
cletoimprovethepotentialforthatspecificorganic. This compositions in the training set. This is achieved with
isnotpossiblewhennoexperimentalstructureisknown, only a total of 50 new samples, and in one cycle of re-
since an initial structure is needed for running the active training.
learning. As shown in the supplementary information This approach works because the original MLIP pre-
Section II, we tested several approaches in which DFT dicts physically reasonable structures, despite the large
calculations of only the isolated organic molecule were error in forces with respect to DFT. In particular, the
addedtothetrainingset,butthesefailedtoimprovethe model relaxes the randomly generated configurations to
accuracy of the model to an acceptable level. sensible structures, in terms of the organic-inorganic
Anotherwayofapproachingthisproblemistousethe stacking pattern. Similarly, MD simulations, while they
structure prediction algorithm to generate HOIP struc- mayexhibithighcommitteeuncertaintyinforces,donot12
lead to unrealistic structures (no bond-breaking or coa- TABLE II: Specifications of MACE models used in this
lescence of atoms). study
number of chemical channels 128
VI. CONCLUSIONS
maximum equivariance order L 1
single layer cutoff radius (˚A) 5
We have presented an efficient, accurate and general
number of layers 2
machine learning force field (MLIP) using the MACE
architecture for lead based 2D HOIPs involving organic
cations containing carbon, hydrogen, nitrogen and oxy-
gen. Our model performs well on single point energy sortium, the Cambridge Service for Data Driven Discov-
and force predictions on samples taken from molecular ery (CSD3), and University of South Carolina Hyperion
dynamics simulations and can extrapolate to unseen or- HPC cluster. The authors thank Volker Blum for dis-
ganic cations. cussionsabouttheutilityofstructuresearchingforthese
Furthermore, the model is appropriate for performing materials.
high throughput screening of this class of materials. A
simple random structure search procedure has been pre-
sentedwhich,whenpairedwiththeMACEmodel,isable
to rediscover the experimentally reported structure for a
IX. CONFLICT OF INTEREST
number of 2D perovskites in our database. The model is
demonstrably accurate during this process, correctly re-
producingthecomplexenergylandscape,asshownbyex- CG is director of Symmetric Group LLP, which mar-
ploring specific examples with DFT. The computational kets some MACE models commercially. The other au-
cost of our structure generation process and model is thors declare that they have no conflicts of interest.
smallenoughthatthisprocedurecanbeappliedatscale.
Finally, our method was validated by synthesising a
new perovskite composition. Besides predicting the cor-
rect structure, the model revealed a delicate landscape
of low-lying energy minima, which in its self could be a X. METHODS
useful investigative capability.
A. MACE Machine Learning Interatomic
Potentials
VII. DATA AVAILABLILITY STATEMENT
This work has utilised the MACE framework for con-
The committee of MACE models trained on the full
structing machine learned interatomic potentials [37].
training set is available in a zenodo repository 10.5281/
MACEisarecentlydevelopedequivariantmessagepass-
zenodo.10729400. The full train and test sets are also
ingtensornetworkwhichoffersstateoftheartaccuracy.
available as a python pandas dataframe. The exper-
The MACE architecture has been described and evalu-
imentally determined newly synthesized structure, as
ated in detail previously [27–30]. Therefore, the follow-
well as the five predicted lowest energy structures found
ing description simply discusses some key aspects of the
by our process, are also available. The random struc-
model design.
ture generation algorithm was implemented in a python
package which can be found at https://github.com/ A MACE model predicts the total energy of a system
WillBaldwin0/LDHP-builder. as a sum of atom centered contributions. The environ-
ment around an atom is described by the atomic num-
ber and relative positions of neighbouring atoms, up to
VIII. ACKNOWLEDGEMENTS s ao rcm he itfi ecx te ud recu ut to ilff is: eN sid(i e) a= sf{ roz mj,r ti hj e}j a|r ti oj m<r ic cut c. luT sth ee rM exA pC anE
-
siontoefficientlyconstructatomcenteredfeaturesbased
WB, CS, and CG thank the AFRL for partial fund-
on the local environment. These atom centered features
ing of this project through grant FA8655-21-1-7010.
are many-body, in that they depend simultaneously on
CS and NK gratefully acknowledge the University of
atomic numbers and positions of several neighbours in a
South Carolina for the support provided through start-
non-trivial way. These features are iteratively updated,
up funds and support from the U.S. Department of
and the final energetic contribution from each atom is
Energy, Office of Science, Basic Energy Sciences (DE-
expressed as a learnable function of these features.
SC0022247). Thisworkutilizedcomputationalresources
from the ARCHER2 UK National Supercomputing Ser- The specifications of the MACE models used in this
vice (http://www.archer2.ac.uk) which is funded by EP- work are, in the nomenclature of reference [29], given in
SRC via the membership of the UK Car-Parrinello Con- table II.13
B. Molecular-Dynamics and Geometry Relaxations of regular lead–hailde octahedra. The lead–halide bond
with MACE potentials length is chosen to be the average of such bonds across
our training set.
Allmoleculardynamics(MD)simulationswerecarried For each organic cation to be placed into the unit cell,
using the atomic simulation environment (ASE) package the following process is performed. We assume that the
[38] in the NPT ensemble at 300 K and 1 atmosphere. moleculejoinstothelayerinacertainway: Salientpoints
A Nos´e–Hoover thermostat [39, 40] was used. During on the molecule are defined as the heavy atoms on the
active learning, MD simulations were propagated using ‘extremities’. In practice this is done by first finding the
the average prediction of 3 committee members. The moment of inertia tensor of the molecule and interpret-
relative force uncertainty fi is defined as ing the eigenvectors as a local coordinate basis for the
rel
molecule. For molecules which are longest in a certain
σ
fi = i , (1) direction, the eigenvector with the smallest eigenvalue is
rel F¯ +ϵ
i generally directed along this direction. The extremities
whereσ andF¯ denotethes(cid:12)tan(cid:12)darddeviationandmean of the molecule are defined as the heavy atoms which
i i (cid:12) (cid:12) have the largest relative distance between one another
of forces over the committee members on atom i. ϵ is
when projected onto this vector. One of these heavy
a regularizer to avoid diverging ratios for small forces.
atoms serves as a reference atom which is placed onto
At each MD step the atom with the greatest fi is se-
rel a given point on the inorganic layer. The orientation of
lected, andthisvalueiscomparedagainstthepredefined
the cation is then determined by first applying a ran-
thresholdof0.2. Ifthisuncertaintyindicatorexceedsthe
dom rotation about the selected atom, and subsequently
threshold, the simulation is terminated. The regularizer
applying up to two reflections in planes normal to the
ϵ for all the simulations was set to 0.2 eV/˚A.
lattice vectors of the inorganic monolayer.
All geometry relaxations have been done using pre-
Afterrepeatingtheaboveforeachmoleculeintheunit
conditioned LBFGS as the optimiser[41]. During relax-
cell, the molecules are checked for intersections. Assum-
ations, both cell sizes and atomic positions are allowed
ing there are no intersections, the out of plane lattice
tochangeandtherelaxedcellisachievedwhenthemax-
imum force on each atom is less than 1 meV/˚A. constantisfixedtoremoveasmuchvacuumfromthecell
as possible. The result of this procedure is a monolayer
with a set of organic cations at a random orientation on
the layer. See Fig. 6b for example structures from this
C. Electronic Structure Calculations
procedure.
All the electronic structure calculations for either re-
laxation or single point calculations are performed using
Vienna Ab initio Simulations Package (VASP) [42, 43] E. Synthesis and Characterization of Perovskite
Materials for Verification of Modeled Results
withthePBE[44]fortheexchange-correlationfunctional
and the projector augmented-wave (PAW) pseudopoten-
tials [45, 46]. Dispersion energy-corrections are applied The perovskite 1,3–(cis)–cyclohexanediamine–PbI
4
using D3 approximation [47]. A Γ-centered Monkhorst- wassynthesizedinordertocomparetheobservedcrystal
Pack [48] k-point grids are used to sample the Brillouin structurewiththeresultsobtainedviathecomputational
zones, with a density of 1000 k-points per number of methodsdescribedpreviously. Crystalsoftheperovskite
atoms, withdivisionsalongeachreciprocallatticevector wereobtainedthroughslowhydrothermalgrowthbydis-
proportional to its length, as implemented in pymatgen solving equimolar amounts of the amine and lead (II)
[49]. The electronic wave functions were expanded in a iodide in concentrated hydriodic acid in a sealed pres-
plane wave basis set with an energy cutoff of 600 eV. sure vessel at 150 ◦C and cooled at a rate of 5 ◦C per
hour,resultingintheformationofmm-scaleorangecrys-
talline chunks. Residual hydriodic acid was removed by
D. An Algorithm for Random Structure washing with methylene chloride and diethyl ether, fol-
Generation of 2D HOIPs lowed by drying under vacuum for several days. The
crystal pieces are highly stable to ambient atmosphere
A random structure generation algorithm has been anddemonstratenosignsofdecompositionoverweeksof
developed to demonstrate the usefulness of the MACE storage.
model. Our algorithm is not intended to be completely The crystal structure was determined using a Rigaku
general and relies on several simplifications. Future XtaLAB Synergy diffractometer. Crystal samples were
developments could utilise methods from organic crys- mounted in oil on a ring-loop and placed in a cryo N
2
tal structure prediction for more generality. The code stream at 200 K. CrysAlis Pro was used to screen and
used in this project is available as a python package at collectdiffractionpatternsusingMoK (λ=0.71073˚A).
α
https://github.com/WillBaldwin0/LDHP-builder. A full sphere of diffraction data was collected, and mul-
Theprocedureisasfollows: Theinorganiclayerisfirst tiscan empirical absorption correction was applied. The
generatedfromleadandthechosenhalideasamonolayer maximum resolution that was achieved was Θ = 31.00
◦14
(0.69 ˚A). The structures were solved with the ShelXT dicted and experimental crystal structures to assess the
(Sheldrick, 2016) structure solution program using the presence of any additional crystal phases at room tem-
Intrinsic Phasing solution method and by using Olex2 perature that may contribute to different structural be-
(Dolomanov et al., 2009) as the graphical interface. The havior. Samples were prepared from the as-grown ABX
4
modelwas refinedwithversion2016/6of ShelXL2016/6 perovskite crystals by grinding in a mortar and pestle to
(Sheldrick,2015)usingLeastSquaresminimisation. The ensure uniform distribution of powder particle size and
crystal structure was determined with minimal guidance orientation. All measurements were performed at room
beyondinitialatomicassignmentandtheresultingsolved temperature under ambient atmosphere. The θ/2θ spec-
structure featured a low R value indicating that the traoftheperovskitepowderswerethencomparedtopre-
solved structure aligned well with the atomic positions dictedpatternsgeneratedfromeithertheexperimentalor
observed in the diffraction pattern. as-modeled crystal structures.
Powder XRD was measured on a Rigaku SmartLab as Simulations of pXRD were performed in the VESTA
an additional point of comparison between both the pre- structure visualization software package [50].
[1] D. Weber, “Ch3nh3pbx3, ein pb(ii)-system mit kubis- Available: https://doi.org/10.1021/jacs.5b03796
cher perowskitstruktur / ch3nh3pbx3, a pb(ii)-system [8] G. P. P. Pun, R. Batra, R. Ramprasad, and Y. Mishin,
with cubic perovskite structure,” Zeitschrift fu¨r Natur- “Physicallyinformedartificialneuralnetworksforatom-
forschung B, vol. 33, no. 12, pp. 1443–1445, 1978. [On- istic modeling of materials,” Nature Communications,
line]. Available: https://doi.org/10.1515/znb-1978-1214 vol. 10, no. 1, p. 2339, may 2019. [Online]. Available:
[2] L. Mao, W. Ke, L. Pedesseau, Y. Wu, C. Katan, https://doi.org/10.1038/s41467-019-10343-5
J. Even, M. R. Wasielewski, C. C. Stoumpos, [9] E. R. Dohner, E. T. Hoke, and H. I. Karunadasa, “Self-
and M. G. Kanatzidis, “Hybrid dion–jacobson 2d assembly of broadband white-light emitters,” Journal
lead iodide perovskites,” Journal of the American of the American Chemical Society, vol. 136, no. 5, pp.
Chemical Society, vol. 140, no. 10, pp. 3775– 1718–1721, 2014, pMID: 24422494. [Online]. Available:
3783, 2018, pMID: 29465246. [Online]. Available: https://doi.org/10.1021/ja411045r
https://doi.org/10.1021/jacs.8b00542 [10] G.M.Day,“Currentapproachestopredictingmolecular
[3] C.C.Stoumpos,D.H.Cao,D.J.Clark,J.Young,J.M. organic crystal structures,” Crystallography Reviews,
Rondinelli,J.I.Jang,J.T.Hupp,andM.G.Kanatzidis, vol. 17, no. 1, pp. 3–52, 2011. [Online]. Available:
“Ruddlesden–popper hybrid lead iodide perovskite 2d https://doi.org/10.1080/0889311X.2010.517526
homologous semiconductors,” Chemistry of Materials, [11] C. J. Pickard and R. J. Needs, “Ab initio random
vol. 28, no. 8, pp. 2852–2867, 2016. [Online]. Available: structure searching,” Journal of Physics: Condensed
https://doi.org/10.1021/acs.chemmater.6b00847 Matter, vol. 23, no. 5, p. 053201, jan 2011. [Online].
[4] C. C. Stoumpos, C. M. M. Soe, H. Tsai, W. Nie, J.-C. Available: https://dx.doi.org/10.1088/0953-8984/23/5/
Blancon, D. H. Cao, F. Liu, B. Traor´e, C. Katan, 053201
J. Even, A. D. Mohite, and M. G. Kanatzidis, [12] A. P. Barto´k, S. De, C. Poelking, N. Bernstein, J. R.
“High members of the 2d ruddlesden-popper halide Kermode,G.Csa´nyi,andM.Ceriotti,“Machinelearning
perovskites: Synthesis, optical properties, and so- unifiesthemodelingofmaterialsandmolecules,”Science
lar cells of (ch3(ch2)3nh3)2(ch3nh3)4pb5i16,” Chem, Advances, vol. 3, no. 12, p. e1701816, 2017. [Online].
vol. 2, no. 3, pp. 427–440, 2017. [Online]. Avail- Available: https://www.science.org/doi/abs/10.1126/
able: https://www.sciencedirect.com/science/article/ sciadv.1701816
pii/S2451929417300736 [13] F.Musil,A.Grisafi,A.P.Barto´k,C.Ortner,G.Csa´nyi,
[5] L. Mao, C. C. Stoumpos, and M. G. Kanatzidis, and M. Ceriotti, “Physics-inspired structural represen-
“Two-dimensional hybrid halide perovskites: Principles tations for molecules and materials,” Chemical Reviews,
and promises,” Journal of the American Chemical vol. 121, pp. 9759–9815, 2021.
Society, vol. 141, no. 3, pp. 1171–1190, 2019, pMID: [14] K. T. Butler, D. W. Davies, H. Cartwright, O. Isayev,
30399319. [Online]. Available: https://doi.org/10.1021/ and A. Walsh, “Machine learning for molecular
jacs.8b10851 and materials science,” Nature, vol. 559, no. 7715,
[6] I. C. Smith, E. T. Hoke, D. Solis-Ibarra, M. D. pp. 547–555, Jul 2018. [Online]. Available: https:
McGehee, and H. I. Karunadasa, “A layered hybrid //doi.org/10.1038/s41586-018-0337-2
perovskite solar-cell absorber with enhanced moisture [15] V. L. Deringer, A. P. Barto´k, N. Bernstein, D. M.
stability,” Angewandte Chemie International Edition, Wilkins, M. Ceriotti, and G. Csa´nyi, “Gaussian process
vol. 53, no. 42, pp. 11232–11235, 2014. [Online]. regression for materials and molecules,” Chemical Re-
Available: https://onlinelibrary.wiley.com/doi/abs/10. views, vol. 121, no. 16, pp. 10073–10141, 2021.
1002/anie.201406466 [16] V.L.Deringer,N.Bernstein,G.Csa´nyi,C.B.Mahmoud,
[7] D. H. Cao, C. C. Stoumpos, O. K. Farha, J. T. Hupp, M.Ceriotti,M.Wilson,D.A.Drabold,andS.R.Elliott,
and M. G. Kanatzidis, “2d homologous perovskites as “Originsofstructuralandelectronictransitionsindisor-
light-absorbing materials for solar cell applications,” dered silicon,” Nature, vol. 589, pp. 59–64, 1 2021.
Journal of the American Chemical Society, vol. 137, [17] J.BehlerandM.Parrinello,“Generalizedneural-network
no. 24, pp. 7843–7850, 2015, pMID: 26020457. [Online]. representation of high-dimensional potential-energy sur-15
faces,” Physical Review Letters, vol. 98, no. 14, 4 2007. Grey, P. Grigorev, S. Han, W. Handley, H. H. Heenen,
[18] A. P. Bart´ok, M. C. Payne, R. Kondor, and G. Csa´nyi, K. Hermansson, C. Holm, J. Jaafar, S. Hofmann, K. S.
“Gaussian approximation potentials: The accuracy of Jakob, H. Jung, V. Kapil, A. D. Kaplan, N. Karimitari,
quantummechanics,withouttheelectrons,”PhysicalRe- J. R. Kermode, N. Kroupa, J. Kullgren, M. C. Kuner,
view Letters, vol. 104, no. 13, 4 2010. D.Kuryla,G.Liepuoniute,J.T.Margraf,I.-B.Magda˘u,
[19] A. P. Barto´k, R. Kondor, and G. Csa´nyi, “On A. Michaelides, J. H. Moore, A. A. Naik, S. P. Niblett,
representing chemical environments,” Phys. Rev. B, S. W. Norwood, N. O’Neill, C. Ortner, K. A. Persson,
vol. 87, p. 184115, May 2013. [Online]. Available: K. Reuter, A. S. Rosen, L. L. Schaaf, C. Schran,
https://link.aps.org/doi/10.1103/PhysRevB.87.184115 B. X. Shi, E. Sivonxay, T. K. Stenczel, V. Svahn,
[20] A. V. Shapeev, “Moment tensor potentials: A class C. Sutton, T. D. Swinburne, J. Tilly, C. van der Oord,
of systematically improvable interatomic potentials,” E. Varga-Umbrich, T. Vegge, M. Vondra´k, Y. Wang,
Multiscale Modeling Simulation, vol. 14, no. 3, pp. W. C. Witt, F. Zills, and G. Csa´nyi, “A foundation
1153–1173, 2016. [Online]. Available: https://doi.org/ modelforatomisticmaterialschemistry,”2024.[Online].
10.1137/15M1054183 Available: https://arxiv.org/abs/2401.00096
[21] R. Drautz, “Atomic cluster expansion for accurate [31] “2d perovskites database - the laboratory of new
and transferable interatomic potentials,” Phys. Rev. materials for solar energetics.” [Online]. Available:
B, vol. 99, p. 014104, Jan 2019. [Online]. Available: http://pdb.nmse-lab.ru/
https://link.aps.org/doi/10.1103/PhysRevB.99.014104 [32] C. R. Groom, I. J. Bruno, M. P. Lightfoot, and
[22] ——, “Atomic cluster expansion of scalar, vectorial, S. C. Ward, “The Cambridge Structural Database,”
andtensorialpropertiesincludingmagnetismandcharge Acta Crystallographica Section B, vol. 72, no. 2,
transfer,” Phys. Rev. B, vol. 102, p. 024104, Jul 2020. pp. 171–179, Apr 2016. [Online]. Available: https:
[Online]. Available: https://link.aps.org/doi/10.1103/ //doi.org/10.1107/S2052520616003954
PhysRevB.102.024104 [33] M.-H. Tremblay, A. Boyington, S. Rigin, J. Jiang,
[23] J. Gilmer, S. S. Schoenholz, P. F. Riley, O. Vinyals, J. Bacsa, K. Al Kurdi, V. N. Khrustalev, R. Pachter,
and G. E. Dahl, “Neural message passing for quantum T. V. Timofeeva, N. Jui et al., “Hybrid organic lead
chemistry,” 2017. [Online]. Available: https://arxiv.org/ iodides: Role of organic cation structure in obtaining
abs/1704.01212 1d chains of face-sharing octahedra vs 2d perovskites,”
[24] S. Batzner, A. Musaelian, L. Sun, M. Geiger, J. P. ChemistryofMaterials,vol.34,no.3,pp.935–946,2022.
Mailoa, M. Kornbluth, N. Molinari, T. E. Smidt, and [34] A. M. Tokita and J. Behler, “How to train a neural
B.Kozinsky,“E(3)-equivariantgraphneuralnetworksfor network potential,” The Journal of Chemical Physics,
data-efficient and accurate interatomic potentials,” Na- vol. 159, no. 12, p. 121501, 09 2023. [Online]. Available:
ture Communications, vol. 13, no. 1, p. 2453, 2022. https://doi.org/10.1063/5.0160326
[25] I. Batatia, S. Batzner, D. P. Kova´cs, A. Musaelian, [35] C. van der Oord, M. Sachs, D. P. Kova´cs, C. Ortner,
G. N. C. Simm, R. Drautz, C. Ortner, B. Kozinsky, and G. Csa´nyi, “Hyperactive learning for data-driven
and G. Csanyi, “The design space of e(3)-equivariant interatomic potentials,” npj Computational Materials,
atom-centered interatomic potentials,” 5 2022. [Online]. vol. 9, no. 1, p. 168, Sep 2023. [Online]. Available:
Available: http://arxiv.org/abs/2205.06643 https://doi.org/10.1038/s41524-023-01104-6
[26] A. Merchant, S. Batzner, S. S. Schoenholz, M. Aykol, [36] Y. Rubner, C. Tomasi, and L. J. Guibas, “The
G. Cheon, and E. D. Cubuk, “Scaling deep learning Earth Mover’s Distance as a Metric for Image
for materials discovery,” Nature, vol. 624, no. 7990, Retrieval,” International Journal of Computer Vision,
pp. 80–85, Dec 2023. [Online]. Available: https: vol. 40, no. 2, pp. 99–121, 2000. [Online]. Available:
//doi.org/10.1038/s41586-023-06735-9 https://doi.org/10.1023/A:1026543900054
[27] I. Batatia, D. P. Kovacs, G. Simm, C. Ortner, and [37] I. Batatia, D. P. Kovacs, G. Simm, C. Ortner,
G. Cs´anyi, “Mace: Higher order equivariant message and G. Csanyi, “Mace: Higher order equivariant
passing neural networks for fast and accurate force message passing neural networks for fast and
fields,” Advances in Neural Information Processing Sys- accurate force fields,” in Advances in Neural
tems, vol. 35, pp. 11423–11436, 2022. Information Processing Systems, S. Koyejo, S. Mo-
[28] D. P. Kova´cs, I. Batatia, E. S. Arany, and G. Csa´nyi, hamed, A. Agarwal, D. Belgrave, K. Cho, and
“Evaluation of the MACE force field architecture: From A. Oh, Eds., vol. 35. Curran Associates, Inc.,
medicinal chemistry to materials science,” The Journal 2022, pp. 11423–11436. [Online]. Available: https:
of Chemical Physics, vol. 159, no. 4, p. 044118, 07 2023. //proceedings.neurips.cc/paper files/paper/2022/file/
[Online]. Available: https://doi.org/10.1063/5.0155322 4a36c3c51af11ed9f34615b81edb5bbc-Paper-Conference.
[29] D. P. Kova´cs, J. H. Moore, N. J. Browning, I. Batatia, pdf
J.T.Horton,V.Kapil,W.C.Witt,I.-B.Magda˘u,D.J. [38] A. H. Larsen, J. J. Mortensen, J. Blomqvist, I. E.
Cole,andG.Cs´anyi,“Mace-off23: Transferablemachine Castelli, R. Christensen, M. Du lak, J. Friis, M. N.
learning force fields for organic molecules,” 2023. Groves, B. Hammer, C. Hargus, E. D. Hermes, P. C.
[Online]. Available: https://arxiv.org/abs/2312.15211 Jennings, P. B. Jensen, J. Kermode, J. R. Kitchin,
[30] I. Batatia, P. Benner, Y. Chiang, A. M. Elena, E. L. Kolsbjerg, J. Kubal, K. Kaasbjerg, S. Lysgaard,
D. P. Kova´cs, J. Riebesell, X. R. Advincula, M. Asta, J. B. Maronsson, T. Maxson, T. Olsen, L. Pastewka,
M. Avaylon, W. J. Baldwin, F. Berger, N. Bernstein, A. Peterson, C. Rostgaard, J. Schiøtz, O. Schu¨tt,
A. Bhowmik, S. M. Blau, V. Ca˘rare, J. P. Darby, M. Strange, K. S. Thygesen, T. Vegge, L. Vilhelmsen,
S. De, F. D. Pia, V. L. Deringer, R. Elijoˇsius, M. Walter, Z. Zeng, and K. W. Jacobsen, “The atomic
Z. El-Machachi, F. Falcioni, E. Fako, A. C. Ferrari, simulation environment—a python library for working
A.Genreith-Schriever,J.George,R.E.A.Goodall,C.P. with atoms,” Journal of Physics: Condensed Matter,16
vol. 29, no. 27, p. 273002, jun 2017. [Online]. Available: //link.aps.org/doi/10.1103/PhysRevLett.77.3865
https://dx.doi.org/10.1088/1361-648X/aa680e [45] P.E.Blo¨chl,“Projectoraugmented-wavemethod,”Phys-
[39] S. Nos´e, “A unified formulation of the constant ical Review B, vol. 50, no. 24, p. 17953, 1994.
temperaturemoleculardynamicsmethods,”TheJournal [46] G.KresseandD.Joubert,“Fromultrasoftpseudopoten-
ofChemicalPhysics,vol.81,no.1,pp.511–519,071984. tialstotheprojectoraugmented-wavemethod,”Physical
[Online]. Available: https://doi.org/10.1063/1.447334 Review B, vol. 59, no. 3, p. 1758, 1999.
[40] W. G. Hoover, “Canonical dynamics: Equilibrium [47] S. Grimme, J. Antony, S. Ehrlich, and H. Krieg, “A
phase-space distributions,” Phys. Rev. A, vol. 31, consistent and accurate ab initio parametrization of
pp. 1695–1697, Mar 1985. [Online]. Available: https: densityfunctionaldispersioncorrection(DFT-D)forthe
//link.aps.org/doi/10.1103/PhysRevA.31.1695 94 elements H-Pu,” The Journal of Chemical Physics,
[41] D. Packwood, J. Kermode, L. Mones, N. Bernstein, vol. 132, no. 15, p. 154104, 04 2010. [Online]. Available:
J. Woolley, N. Gould, C. Ortner, and G. Csa´nyi, https://doi.org/10.1063/1.3382344
“A universal preconditioner for simulating condensed [48] H. J. Monkhorst and J. D. Pack, “Special points
phase materials,” The Journal of Chemical Physics, vol. for brillouin-zone integrations,” Phys. Rev. B, vol. 13,
144, no. 16, p. 164109, 04 2016. [Online]. Available: pp. 5188–5192, Jun 1976. [Online]. Available: https:
https://doi.org/10.1063/1.4947024 //link.aps.org/doi/10.1103/PhysRevB.13.5188
[42] G. Kresse and J. Furthmu¨ller, “Efficiency of ab-initio [49] S. P. Ong, W. D. Richards, A. Jain, G. Hautier,
total energy calculations for metals and semiconductors M. Kocher, S. Cholia, D. Gunter, V. L. Chevrier,
using a plane-wave basis set,” Computational Materials K. A. Persson, and G. Ceder, “Python materials
Science, vol. 6, no. 1, pp. 15–50, 1996. genomics (pymatgen): A robust, open-source python
[43] G. Kresse and J. Furthmu¨ller, “Efficient iterative library for materials analysis,” Computational Materials
schemes for ab initio total-energy calculations using Science, vol. 68, pp. 314–319, 2013. [Online]. Avail-
a plane-wave basis set,” Phys. Rev. B, vol. 54, able: https://www.sciencedirect.com/science/article/
pp. 11169–11186, Oct 1996. [Online]. Available: pii/S0927025612006295
https://link.aps.org/doi/10.1103/PhysRevB.54.11169 [50] K. Momma and F. Izumi, “VESTA3 for three-
[44] J. P. Perdew, K. Burke, and M. Ernzer- dimensional visualization of crystal, volumetric and
hof, “Generalized Gradient Approximation Made morphology data,” Journal of Applied Crystallography,
Simple,” Physical Review Letters, vol. 77, pp. vol. 44, no. 6, pp. 1272–1276, Dec 2011. [Online].
3865–3868, Oct 1996. [Online]. Available: https: Available: https://doi.org/10.1107/S0021889811038970Supporting Information:
Accurate Crystal Structure Prediction of New 2D Hybrid Organic Inorganic
Perovskites
Nima Karimitari,1, William J. Baldwin,2, , Evan W. Muller,3 Zachary J.
∗ † ∗
L. Bare,1 W. Joshua Kennedy,4 G´abor Cs´anyi,2 and Christopher Sutton1,
‡
1Department of Chemistry and Biochemistry, University of South Carolina, South Carolina 29208, United States
2Department of Engineering, University of Cambridge, Cambridge CB2 1PZ, UK
3UES, Inc., Beavercreek, Ohio 45432, United States
4Materials and Manufacturing Directorate, Air Force Research Laboratory,
Wright-Patterson AFB, Dayton, Ohio 45433, United States
(Dated: March 12, 2024)
I. PREDICTIONS FOR THE NEWLY SYNTHESISED PEROVSKITE
When validating our prediction of the newly synthesised perovskite, numerical comparisons are similar but do not
perfectly match since our model is trained to reproduce the energy landscape of DFT calculations with PBE+D3
functional. Therefore, there is an overestimation of 3-5% in bond length distances compared to the experiment, as
expected from PBE+D3 functionals. We confirm our prediction is correct by firstly examining the two structures
by eye, which are shown in Fig. 1. Secondly, we showed that a geometry relaxation of the experimentally reported
structure with our model results in exactly the predicted structure. Even though the figure shows that this does
not meaningfully change the structure, this is the origin of the differences between the predicted pXRD of the
experimentally deduced structure and our prediction in the main text Fig. 8.
Thecomputationalcostofthestructurepredictionalgorithmishighlydependentonthenumberofmoleculesinthe
unit cell since this dictates the number of samples required. In our dataset, the median number of molecules per unit
cell(forperovskiteswithnolocally3Dregions)was4. Evidentlythereisatrade-offbetweenrunningfewer,expensive,
searches with large unit cells, or many cheaper searches with small cells and accepting that one will occasionally miss
the correct structure.
FIG. 1: Comparing the structure as deduced from experiment to the lowest minima found by our process.
∗Theseauthorscontributedequally
†Electronicaddress: wjb48@cam.ac.uk
‡Electronicaddress: cs113@mailbox.sc.edu
4202
raM
11
]ics-lrtm.tam-dnoc[
1v55960.3042:viXra2
FIG. 2: Applying our random structure search procedure to 4 molecules with chiral centers. The lowest energy
structure found for the right-most molecule relaxed to a 1D perovskite.
4
2
0
2
Force RMSE = 27.6 meV/A
Energy RMSE = 3.7 meV/atom
4
4 2 0 2 4
DFT Force (eV/Å)
FIG. 3: The force parity plot between the model and DFT on samples taken from an MD simulations of predicted
1D HOIP.
II. EXTRAPOLATION TO 1D PEROVSKITES
WhileconductingrandomstructuresearchesofpotentialnewHOIPs,itwasdiscoveredthatthefinalMACEmodel
is able to extrapolate well to 1D HOIPs, without having seen any in the training set.
We applied the random structure search procedure to four organic cations with chiral centers, as shown in Fig. 2
and predicted the most stable HOIPs that they can form. These structure searches were performed with a small
unit cell, containing just 2 molecules and one inorganic layer. An interesting case is molecule D in Fig. 2, 2-(1-
aminoethyl)pyrrolidinium, for which the most stable structure is a 1D HOIP. This is surprising because the structure
search procedure was the same as described in the main text, where the initial generated samples are all 2D layered
PbX structures, and the model was able to achieve a structure with PbX inorganic unit (the additional halide ions
4 3
are isolated, away from the rest of the inorganic framework). To examine the accuracy of the model and stability of
this structure, a constant pressure MD simulation of the structure was ran at 300 K, 1 atm for 50 ps. The maximum
relativeforceuncertaintyremainsbelowthethreshold(asdiscussedinmaintextsectionII)atalltimes. Furthermore,
the root mean square error with respect to DFT (see also Fig. 3), for samples taken every 5 ps was 27.5 meV/˚Aand
3.7 meV/atom for forces and energy, respectively. This close agreement with DFT implies that the current trained
model, which has not trained to any lower dimensional HOIPs, is accurate in dealing with 1D HOIPs.
)Å/Ve(
ecroF
ECAM3
(a) (b) (c)
4 4
4
2 2
2
0 0
0
2 2 2
Force RMSE = 193.8 meV/A Force RMSE = 111.5 meV/A Force RMSE = 95.3 meV/A
4 Energy RMSE = 137.4 meV/atom 4 Energy RMSE = 67.2 meV/atom 4 Energy RMSE = 1.1 meV/atom
4 2 0 2 4 4 2 0 2 4 4 2 0 2 4
DFT Force (eV/Å) DFT Force (eV/Å) DFT Force (eV/Å)
FIG. 4: Force parity plots for three different analysis of extrapolating to underrepresented molecules. All are taken
from independent MD simulations with (a) trained to isolated molecules in box, (b) trained to only the forces of the
isolated molecules, and (c) trained to the samples taken from the relaxation trajectory.
III. UNDERREPRESENTED ORGANICS
One of the challenges of the trained potential is in dealing with organic molecules with local structural features
and functional groups that are very different to those found in the training dataset. One example, as discussed in the
maintextSectionViscyclopropanaminium. Severalotherapproachesweretestedwhilesearchingforwaystoquickly
add new information about unseen organic molecules. Some of these methods all involved performing calculations of
isolated molecules, and adding just these to the training set. Here we summarise out the outcomes of these analyses.
(a) Isolated Molecules. We place the isolated molecule in an empty box (15 15 15 ˚A) and ran collected
× ×
samples by running molecular dynamics simulations using extended tight binding (xTB)[1]. Specifically, the
GFN2-xTB[2] was used via the xtb-python api. Simulations were ran at 500K using a time step of 1 fs and
200 samples were taken at intervals of 1 ps. These configurations were subsequently evaluated with DFT
using the same settings as the perovskite training data. One difficulty with this method is that cations in
HOIPs are charged molecules and ignoring the charge in the isolated molecule calculations can severally affect
the force/energy errors. However, including them is also a problem due to long range interactions between
neighboring unitcells. We considered the charged cations but with the dipole and quadropole corrections [3].
TheoriginalmodelretrainedtothisdatasetshowshigherthanexpecterrorsasshowninFig.4a. Theretrained
model have a very poor prediction for energies. This is because even with the presence of corrections to long-
rangeinteractions,theenergydifferencebetweenchargedandunchargedcalculationsissolargethatthecurrent
MLIP, trained to cations that are present in the periodic systems, cannot accurately predict both isolated
molecules and molecules in solids.
(b) Isolated Molecules, Force Information Only. As a final test on the isolated molecules, we then tried to
train the original model to only forces of the isolated cyclopropanaminium. This modification led to significant
improvement in both force and energy predictions, as shown in Fig. 4b, but still the error was an order of
magnitude larger than the values reported for seen perovskites in Section II.B.
(c) Structures found by Random Structure Search. Instead of dealing with the isolated molecules, we used
the random structure search procedure to generate initial HOIPs with this molecule and then relax them with
the MLIP. While the MLIP used in the structure search struggles with energy and forces, it can still create
samples that are useful for retraining the model. In Fig. 4c, we retrained the original model to 200 randomly
selected samples from the relaxation trajectories. This leads to an improvement with errors of 95.3 meV/˚Aand
1.1 meV/atom for forces and energy.
(d) Random Structure Search + MD. In our final experiment, we combined the previous step with MD
simulations. This is because in relaxation trajectories, many of the samples are structurally similar making
the learning inefficient, but MD simulations can lead to more diverse local environments that the model can
learn from. Therefore, we collected the 5 most stable structures predicted by the search algorithm method, ran
MDsimulationsfor10ps. Intotal50samples(takenevery1ps)arethenaddedtotheoriginaltrainingsetand
the model is retrained. The errors are at 14.6 meV/˚Aand 0.9 meV/atom also shown in main text in Sec. V.
)Å/Ve(
ecroF
ECAM
)Å/Ve(
ecroF
ECAM
)Å/Ve(
ecroF
ECAM4
[1] C. Bannwarth, E. Caldeweyher, S. Ehlert, A. Hansen, P. Pracht, J. Seibert, S. Spicher, and S. Grimme, “Extended
tight-binding quantum chemistry methods,” WIREs Computational Molecular Science, vol. 11, no. 2, p. e1493, 2021.
[Online]. Available: https://wires.onlinelibrary.wiley.com/doi/abs/10.1002/wcms.1493
[2] C. Bannwarth, S. Ehlert, and S. Grimme, “Gfn2-xtb—an accurate and broadly parametrized self-consistent tight-binding
quantum chemical method with multipole electrostatics and density-dependent dispersion contributions,” Journal
of Chemical Theory and Computation, vol. 15, no. 3, pp. 1652–1671, 2019, pMID: 30741547. [Online]. Available:
https://doi.org/10.1021/acs.jctc.8b01176
[3] J.NeugebauerandM.Scheffler,“Adsorbate-substrateandadsorbate-adsorbateinteractionsofnaandkadlayersonal(111),”
Phys.Rev.B,vol.46,pp.16067–16080,Dec1992.[Online].Available: https://link.aps.org/doi/10.1103/PhysRevB.46.16067
CARBON MARKET SIMULATION WITH ADAPTIVE MECHANISM
DESIGN
HanWang1,WenhaoLi1,HongyuanZha1,BaoxiangWang1,2
1TheChineseUniversityofHongKong,Shenzhen
2VectorInstitute
xwanghan@gmail.com,{liwenhao,zhahy,bxiangwang}@cuhk.edu.cn
ABSTRACT
Acarbonmarketisamarket-basedtoolthatincentivizeseconomicagentstoalignindividualprofits
withtheglobalutility,i.e.,reducingcarbonemissionstotackleclimatechange. Capandtradestands
asacriticalprinciplebasedonallocatingandtradingcarbonallowances(carbonemissioncredit),
enablingeconomicagentstofollowplannedemissionsandpenalizingexcessemissions. Acentral
authorityisresponsibleforintroducingandallocatingthoseallowancesincapandtrade.However,the
complexityofcarbonmarketdynamicsmakesaccuratesimulationintractable,whichinturnhinders
thedesignofeffectiveallocationstrategies.Toaddressthis,weproposeanadaptivemechanismdesign
framework,simulatingthemarketusinghierarchical,model-freemulti-agentreinforcementlearning
(MARL).Governmentagentsallocatecarboncredits,whileenterprisesengageineconomicactivities
andcarbontrading. Thisframeworkillustratesagents’behaviorcomprehensively. Numericalresults
showMARLenablesgovernmentagentstobalanceproductivity,equality,andcarbonemissions. Our
projectisavailableathttps://github.com/xwanghan/Carbon-Simulator.
Keywords CarbonMarket,AdaptiveMechanismDesign,Multi-AgentReinforcementLearning,CapandTrade
1 Introduction
Climatechangehasemergedasapressingworldwideconcern [1],significantlyimperilingglobalecosystems,economic
systems, andsociopoliticalstability. TheUnitedNationsreportsthatindevelopingregions, oneintenindividuals
subsistsonlessthanUS$1.90daily [2],with2.2billionpeopledeprivedofaccesstosafelymanagedpotablewater
resources [3]. Theburgeoningclimatecrisisamplifiesthesechallenges,asworldwidetemperatureescalationsprovoke
droughtsandrisingsealevels,exacerbatingfaminesandenhancedforceddisplacements [4].
In2016,196nationsendorsedtheParisAgreementtomitigateclimatechangecollaboratively. However,pursuing
transnationalenvironmentaltargetsoftenconflictswithshort-terminterests,requiringmechanismstoreconcilelocal
and international objectives [5]. Carbon markets exemplify such mechanisms [6, 7, 8], incentivizing economic
agentstocurbemissions. Thecapandtradeformat,predominantincarbonmarkets,involvesallocatingandtrading
allowances [9,10,11,12]. Economicagentsmustpossesssufficientallowancestooffsetemissionsorfacepenalties
forsurplusemissions. Thecapandtradesystemsetsapredeterminedlimitonallowanceswithinaneconomy,witha
centralauthorityintroducingandallocatingallowancesbasedonspecifiedobjectives. Whilethispolicyhelpsbalance
efficiencyandfairness,determiningtheoptimalallocationremainschallengingingeneraleconomiccontexts. The
high-dimensionaldynamicsofthecarbonmarket,influencedbyrational,self-interested,andfar-sightedeconomic
agents,leadtomarketsimulationrelianceonmodelslikeCGE(computablegeneralequilibrium) [13,14,15]orABM
(agent-basedmodeling) [16,17,18]frameworks,employingsimplifyingassumptionsthatarearduoustovalidate,such
asproductionandtradingbehaviors.
Giventheuniquenatureofthecarbonmarket,weintegratetheAIEconomist [19,20]tosimulatemarketdynamics.
Ouradaptivemechanismdesignframework,employinghierarchical,model-freeMARL,mimicsthecarbonmarket.
Lower-levelenterpriseagentsengageinrealisticeconomicactivities,suchasemittingcarbondioxide,tradingemission
credits, and investing in emission reduction projects. Higher-level government agents analyze diverse allocation
4202
nuJ
21
]GL.sc[
1v57870.6042:viXrastrategiestoachievebalancedefficiencyandfairness,leadingtosignificantcarbonemissionreductions. Theframework
demonstratestheconductofrational,self-interested,andfar-sightedagentswithinthecarbonmarket. Weemphasize
thatourapproachisnotasimpletransferoftheAI-Economistfromtaxationtocarboncreditallocation. Simulatingthe
carbonmarketischallengingduetolimiteddata,fluctuatingregulations,andnon-marketfactors.
Tovalidateoursimulator, weconductedcomparisonswithseveralwidelyadoptedindicatorallocationapproaches
at the firm level [11]. The simulation results indicate reasonable action responses by enterprise agents to these
allocationpolicies. Additionally,numericalfindingsdemonstratethatgovernmentagents,throughMARL,effectively
discoverallocationpoliciescapableofbalancingproductivity,equity,andcarbonemissions. Ourprimarycontributions
encompass: 1)Weproposeasystematiccarbonmarketsimulatorfeaturingcarboncreditsallocationandtrading,and
achieverealisticcarboneconomysimulationbasedonhierarchical,model-freeMARL.2)Weimplementseveralwidely
adoptedindicatorallocationapproachesatthefirmlevelasbaselines. 3)Weobservethatlearning-basedallocation
policiespossessthepotentialtoeffectivelybalanceproductivity,equity,andcarbonemissions.
Figure1: Simulatorstructure. Left: Oneepisodeisdividedintoseveralperiods,andineachperiods,thegovernment
firstlyactstoallocatecarboncredits;theremainingoftime,enterprisesdotheireconomicsactivities.Right:Enterprises’
economicsactivitiesaremodeledinaGather-Trade-Buildgame;inthisgridmap,theycanproduceproperties(build)to
getcoins,canmovewhichcangathercarboncreditsandincreasecommunity’stotalpower(greenprojectinvestment),
docarbonreductioninvestactiontoreducethecarbonemissionlevel(carbonreductioninvestment),alsotradecarbon
creditsandcoinswitheachother.
2 PreliminariesandRelatedWorks
2.1 CarbonMarketandCapandTrade
Acarbonmarketcanmanifestatvariousscales,fromlocaltoglobal. Thispaperprimarilyfocusesonregionalcarbon
markets,whichinvolvetheparticipationofthegovernmentandmanyenterprises. Carbonmarketallowancescanbe
classifiedintomandatoryandvoluntarytypes,withtheformerbeingstrictlyregulatedbythegovernment. Atthesame
time,thelatterencouragesenterprisestodecreasetheiremissionsthroughinvestmentincarboncreditsgeneratedby
government-certifiedprojects,facilitatingemissionsavoidance,reduction,orremovalfromtheatmosphere. Themost
prevalentformofcarbonmarketsisthecapandtradesystem,encompassingapredefinedcapontotalallowanceswithin
theeconomyataspecifictime. Acentralauthorityorgovernmentmanagestheintroductionoftheseallowances,with
thecapvaluebeingestablishedtoalignwiththeirobjectives. Thismechanismensuresanaccuratelytargetedlevelof
emissions.
Carboncreditscanbeintroducedintothemarketthrough3primarymeans. Theinitialmethod,termedfreeallocation,
entailsthegovernmentdeterminingthenumberoffreecreditstoallocatetoenterprisesbasedonfactorssuchasthe
enterprise’ssizeandhistoricalemissions. Anotherapproachinvolvesthegovernmentsellingallowancesinanauction
market. The final method incorporates certified projects, enabling enterprises to garner additional allowances by
undertakingandcompletingenergyconservationandemissionsreductionprojects,typicallyfacilitatedbytechnological
investmentandadvancement. Thispaperexclusivelyfocusesonfreeallocationandgovernment-certifiedprojects.
Inthecontextoffreeallocation,apivotaldecisionconfrontingthegovernmentistheestablishmentofboththeoverall
volumeofallowancesforagivenperiodandthedistributionoftheseallowancesamongenterpriseswithindistinct
regions [21,22,23]. Allocationpoliciescanbeprimarilydividedintofourapproaches: indicator,optimization,game
theoretic,andhybridapproaches. Eachapproachpossessesstrengthsandweaknessesintermsofproductivityandequity.
2Theindicatorapproachisthemostfrequentlyemployedinpractice;however,consensusonindicatorselectionremains
elusive,asdifferingindicatormethodologiescanyieldsubstantiallyvariedallocationoutcomesandarechallengingto
validate [11]. Inoursimulations,weutilizedtheindicatorpolicyasabaselinetocompareagainsttheMARL-based
allocationpolicy.
Theparamountcomponentwithinthecapandtradeiscarbontrading [6,24,12]. Enterprisesthatexceedallotted
emissionslimitscaneludepenaltiesbypurchasingallowancesfromentitiespossessingsurplusallowances. Thispaper
simulatescarbontradingusingabid-and-askauctionmechanism,facilitatingallowance-basedtransactionsbetween
enterprises,analogoustotheAIEconomist[19].
2.2 CarbonMarketSimulatedModels
Theprevailingquantitativesimulatorencompassthecomputablegeneralequilibriummodel(CGE) [13,14,15]andthe
agent-basedmodel(ABM) [16,17,18,25]. CGEmodelsareeconomicframeworksthatobtainempiricaldataasinput
toemulateeconomicstructuresandthebehavioralresponseofeconomicentitiesasaccuratelyasfeasibletoexamine
potentialinfluencesofvariedpoliciesandotherdisturbances. CGEanddynamicCGEmodelshavebeenemployed
extensivelytobroadlyexploreclimatepolicies,specifically,thecarbonmarket [26,14]. Moreover,multi-agent-based
modelshavebeenutilizedtoreplicatedistinctindustries’behavioratanationalscale [16,25,18]. [17]proposeamulti-
agentsimulationframeworktoemulateregionalemissionstradingsystemsandassessnumerousregulatorypoliciesand
carbonauctionregulations. Additionally,othermulti-agent-orientedmodelshavebeenappliedforexploringspecific
aspectsofemissionstradingschemes,suchasprospectivecarbonauctionrules [27]orinternationaltransportation
patterns [28]. Rafieisakhaeietal. [29]introducesmodelstargetingtheEUETSandtheglobaloilmarket,subsequently
examiningtheinterrelationbetweenthesecomponents.
2.3 MachineLearningforEconomicDesign
Inthedomainofeconomicdesign,contemporaryinvestigationshavechieflycenteredonautomatedmechanismdesign
[30]andauctiondesign [31],withtheprimaryaimbeingtheaugmentationofmarketefficacyandresourceallocation
via the employment of machine learning methodologies. Historically, agents within such research contexts have
functionedasstaticentitiesdevoidoflearningcapabilities. However,recentscholarlycontributionshavebegunto
incorporateMARLfortheexaminationofsecuritygames [32]onStackelbergequilibrium,aswellastheinvestigation
ofresourceallocationgames [33]. Furthermore,certainstudieshaveextendedtheapplicationofRLbyenablingagents
tomodifytheirconductinadherencetonovelregulatoryframeworks,therebyintensifyingtherefinementofmarket
design [34,35]andaligningwiththe"PositronicEconomist"paradigm [36]. Moreover,AIeconomists [37]have
successfullyoptimizedtaxationpolicieswithinatwo-levelsimulationenvironment,surpassingtheeffectivenessof
extantreal-worldtaxframeworks.
2.4 Multi-AgentReinforcementLearning
Inthesimulatedenvironmentunderinvestigation,numerousenterpriseagentsadaptinresponsetodistinctgovernment
policyinterventions. Theseagents’trainingprocessisgroundedintheprinciplesofMARL.Owingtothecomplexity
ofenvironmentstatetransitions,whichencompassnotonlystochasticenvironmentalfactorsbutalsotheactionsofall
agentsinvolved,asingleagent’sperspectivemayinadvertentlyconflateenvironmentalrandomnesswiththebehaviorof
otheragents,ultimatelyleadingtoimproperagentupdates [38]. Agrowingbodyofrecentresearchinthedomainof
MARLhasbeendevotedtoimprovingmulti-agentlearninginnon-stationaryenvironments [39],employingstrategies
suchasrewardsharing [40,41]orstateinformationsharing [42,43]amidstagents. Thispaperadoptsanalternative
approachtobolsterthelearningprocess: sharingagentparameters [40]whileprecludingtheexchangeofindividual
agentinformation.
3 CarbonMarketModeling
Inthissection,wewillpresentanapproachtoconductsimulationsofcarbonmarketswithinthecontextofmodel-free
MARL.TheMARLframeworkexhibitsahierarchicalstructure,consistingofthehigher-levelgovernmentRLagent
andlower-levelenterpriseRLagents. Consequently,itisreferredtoasahierarchicalmodel-freeMARLframework,
whichhasalsobeenknownasamanager-workerarchitecture [44,45]inexistingliterature. Section3.1willprovide
anin-depthmathematicalrepresentationofthisframework,whileSections3.3and3.2willelucidatetheinstantiated
modelsforgovernmentandenterpriseRLagents,respectively. WeusenotationsreferencefromRLandeconomics,see
Table3.1.
33.1 HierarchicalMulti-AgentRLFramework
t timestep π governmentallocationpolicy
g
i,j,k enterpriseagentindices p punishment
g governmentagentindex z income
θ,ϕ modelweights l labor
h hiddenstate cl labor-incomecoefficient
s state u utility
o observation swf socialwelfare
a action prod productivity
r reward eq equality
π policy ee excesscarbonemissions
γ discountfactor ce economy-climatecoefficient
T statetransition
x enterpriseattributes xq carbonemissioncredit
xc coin xl carbonemissionlevel
Table1: NotationsforourHierarchicalMulti-AgentRLFramework.
Ontheonehand,theissuesencounteredbyhigher-levelgovernmentagentsinthecarbonmarket(primarilyreferringto
carbonallowancesallocationwithinthispaper)canbemodeledasastandardMarkovdecisionprocess(MDP) [46]
M =(S,A,P,R,γ),giventhefixedlower-levelenterpriseagents. Givenstatess,s′ ∈S andanactiona∈A,the
h
transitionprobabilityfunctionisexpressedasP(s′ |s,a):S×A×S →[0,1]andtherewardfunctionisdefinedby
R(s,a,s′):S×A×S →R. Thediscountfactorisdenotedasγ ∈(0,1]andthepolicyisrepresentedasπ :S×A→
[0,1]. Forthetimestept ∈ [1,T],thediscountedreturnisidentifiedbyG = (cid:80)T γt′−tr . Theobjectiveofthe
t t′=t t′
governmentagentistodetermineapolicyπthatmaximizesJ =E [(cid:80)T γt−1r (s ,a ,s )].
at∼π(·|st),st+1∼P(·|st,at) t=1 t t t t+1
Ontheotherhand,theproblems(production,trade,etc.) encounteredbythelower-levelenterpriseagentsincarbon
marketscanformallydefinedbyapartiallyobservablestochasticgame(POSG) [47]G :(S,A|I| ,R|I| ,P,O|I| ,I),
l i=1 i=1 i=1
givenafixedhigher-levelgovernmentagent. Ateachtimestept ∈ T,lower-levelenterpriseagenti ∈ I obtainsan
observation, oi = O (s ), where O (s ) is emission or observation function. Then each agent i execute an action
t i t i t
ai ∈A simultaneouslyaccordingtotheirhistorical-dependentpolicyπ :O1×A1×···×Ot×At →[0,1]. After
t i i i i i i
that,environmentwillreturnrewardsri ∈R (s ,a )toagenti,wherea denotesthejointactionofallagents. Then
t i t t t
states willtransitionstothenextstates accordingtotransitionfunctionP(s |s ,a ). Eachagent’sobjectiveis
t t+1 t+1 t t
findanoptimalpolicyπtomaximizetheγ-discountedexpectedreturnmax E (cid:2)(cid:80) γtri(cid:3) ,where
πi ai∼πi,a−i∼π−i,s′∼P t t
π means the joint policy of other agents. Note that government and enterprises are make decisions in different
−i
timescales.
Subsequently,weinstantiateM andG ,representinggovernmentandenterpriseswithinthecarbonmarketcontext,
h l
andprovidedefinitionsofstatespaces,actionspaces,andrewardfunctions.
3.2 Lower-Level: EnterpriseModeling
TheGather-Trade-Buildgame,asproposedinAI-Economist [20],isemployedtoemulateenterpriseeconomicbehavior
withinthecontextofacarbonmarket. Thistwo-dimensionalgridworldenablesagentstotraversethegrid,acquire
resources,amasscoins(representingprofit)throughresourceusageinhouseconstructionendeavors,andpartakein
tradingactivitieswithotheragentsbyexchangingresourcesforcoins. Morespecifically,enterprisesarestochastically
initializedongridcellsattheonsetofeachepisode. Subsequently, theseentitiesinitiateactionsateverytimestep
throughoutanepisode,excludingwhenthegovernmentintervenes(tobedetailedlateron). Uponthecompletionof
eachepisode,apenaltyequaltoee∗pisimposedonenterprises’coinholdingsinresponsetosurpassingtheirallotted
carbonemissioncredits.
RewardFunction. Theobjectiveofeachenterpriseistomaximizeitsutilitywhichisdefinedas:
z1−η−1
u(z,l)= −cl∗l, η =0.23, (1)
1−η
4wherezisincomethatthesumofenterprise‘scoins,andlisalsothecumulativelaborduringallprevioustimesteps.
Andforηisisoelasticcoefficient,weuseisoelasticutilityfunction [48]tomodeltheincomecomponentofreward,it
isanonlinearcurvewithhigherηlowersensitivitytotheincomechange. Duringanepisode,labor-incomecoefficient
cl ischanging,itfollowsequation
α∗(1−et/β), (2)
whereα,β isconstantandtreferstotime.
Skill. Enterpriseagents’skillsincludeS andRc,representingenterprisesizeandresearchanddevelopment(R&D)
capabilities.
ActionSpace. Anepisodeisdividedintoseveralperiods. Atthestartofeachperiod,eachenterpriseisallocateda
certainnumberofcarbonemissioncreditsbythegovernmentagent. Ateachtimestepwithinaperiod,enterprisesmust
choosefromasetofactions,includingMove,Produce,Invest,TradeorNO-OP(nooperation).
Tradeactionconsumesoneunitoflabor. Enterpriseagentscanmovetoanyofthefourneighboringgrids. Still,this
actionwillbeblockedbytheedgeofthegridworldorotherenterprises’properties(orhouses). Supposeanenterprise
agentmovestoagridalreadyallocatedagovernment-certifiedproject. Theenterprisewillconsumecoinsandlaborand
receivecarbonemissioncredits. Oncecompleted,theprojectwillremainonthegridandinfluencethecarbonemission
processofallagents.
Produceactionconsumesoneunitoflabor,xl carbonemissioncredits,andprovidestheagentwith10S coins. This
action is available if the current position in the grid environment is not occupied by the enterprise’s property or a
government-certifiedproject. Additionally,whenalargeamountofcarbonemissioniscreated,itwillrandomlypollute
thevalueofnearbyblankgrids. Thiswillintroduceadiscountonthecoinsreceivedwhentheenterpriseproducesin
suchgrids.
Investactioncandecreaseanenterprise’scarbonemissionlevel. Thisactionisavailablewhenanenterprisehas
positivecoins.Itconsumesoneunitoflaborand5/Rccoins.Thecarbonemissionlevel,denotedasxl,isacontinuously
changingenterpriseattribute,withafloatingrangebetween0and1. Atthebeginningoftheepisode,allenterprises
havetheirxl setto1. Throughinvestments,anenterprisecanchangeitsxl. Thecarbonemissionlevelisdefinedas
follows:
xl =Pc ∗(1−Gr), (3)
i i
wherePc isdefinedasPc =exp(−δ∗Rc ∗nr)andGris:
i i i i
np
Gr = . (4)
(cid:80)I(Pc ∗S )+np
j j j
WeusepowerconsumptionPctorepresentthepowerconsumedbyanenterprisewhenproducing10coins. Thisvalue
dependsonthenumberofinvestmentsnr,theenterprise’sR&Dcapabilities,andconstantδ. ThegreenrateGrisused
i
torepresenttheproportionofgreenenergygeneratedfromgovernment-certifiedprojectsintotalenergy. Itdecreases
withahighernumberofcompletedgovernment-certifiedprojectslocatedinthegridworld,denotedasnp,oralower
totalpowerconsumption(cid:80)I(Pc ∗S). Additionally,wehavesetlowerboundstoensurethatxl remainswithina
j j i
reasonablerangeandGrisnon-negative. Wehaveintroduceddelay,forgetting,andrandomfailuresinthecountof
investmentactionsnr tomodelactualcarbonemissionreductioninvestments.
i
Tradeencompassesbiddingandaskingincarbontrading,similartoAIEconomist. TheactionspaceforTradeistwice
thenumberofspecifiedpricelevels. Whenanenterprisepublishesabidoraskrequest,thatrequestremainsactivefora
predeterminednumberoftimestepsuntilitismatchedwithahigher-pricedaskoralower-pricedbid. Therangeforthe
lifetimeofarequestshouldbesmallerthanthelengthofanepisodebecause,atthestartofeachnewepisode,market
requestsarecleared. Publishingarequestinthemarketincursalowerlaborcostthanotheractions,encouragingtrade
activity. However,thisactionissubjecttolimitations. Enterprisescanonlypublishamaximumallowednumberof
requests,andtheymusthaveasufficientamountofcoinsandcarbonemissioncredittoparticipateintrading.
ObservationSpace. Therangeofobservationforenterprisesissignificantlysmallerthanthatofthegovernment.
Regarding position information, enterprises can gather information about their properties’ positions and a limited
squarerangeofthegridworld. Withinthislimitedsquarerange,enterprisescanobservewhichgridareasarepolluted
bycarbonemissionsresultingfromtheirproductionactionsorpurifiedbycompletinggovernment-certifiedprojects.
Enterpriseswillonlyknowtheirskillsandattributesbutcanaccessinformationabouttheaveragecarbonemission
level. Incarbontrading,enterprisescanobservetheembeddedpricehistoryandallpublishedrequests,similartowhat
thegovernmentcanmonitor. Additionally,enterprises’observationswillincludeself-publishedrequests.
53.3 Higher-Level: GovernmentModeling
RewardFunction. Government’sobjectiveistomaximizesocialwelfare,whichisdefinesas:
swf =prod∗eq∗exp(−ce∗ee), (5)
whereprodisdefinedas:
(cid:88)
prod= (xc), (6)
i
i
andeqdefinedfromconceptofginiindex:
(cid:80)N (cid:80)N
|x −x |
eq =1− i=1 j=1 ci cj , 0<eq <1. (7)
2(N
−1)(cid:80)N
x
i=1 ci
ActionSpace. Thegovernmentagentmakesdecisionsatthefirsttimestepofeachperiod. Itsactionisrepresented
byamulti-dimensionaldiscretevector. Thefirstdimensionspecifiestheproportionofthetotalcreditforthisperiod
thatwillbeallocatedtotheremainingunallocatedcarbonemissioncreditsforallperiods. Thenext|I|dimensions,
where|I|referstothenumberofenterpriseagents,determinetheallocationweightofcarbonemissioncreditsforeach
enterpriseagentineachperiod.
Thetotalcreditavailablefortheperiodiscalculatedbasedonthespecifiedproportionoftheperiod’sfullcredit. The
governmentthenallocates10%ofthiscredittoagovernment-certifiedprojectrandomlyplacedonanemptygrid. The
remaining90%ofthetotalcreditisdistributedtoenterprisesaccordingtotheirrespectiveallocationweights.
Eachdimensionoftheactionspacehasasizeof101,withtheremainingaction0usedformaskingattherestofthe
timestepsineachperiod.
Toensuretheproperfunctioningofacapandtrade,itisessentialforthegovernmentagentnotonlytoallocatecarbon
creditstoeachperiodandenterpriseagentbutalsotoestablishtheseverityofpenaltiesforexceedingemissions. Thus,
the|I|+2-thdimensiondeterminestheseverityofpunishments.
Regardingdifferentfacetsofgovernmentpolicy,theparameterthatexertsthemostsignificantinfluenceonenterprise
behavioristhepunishmentsetting,asitdirectlyimpactstheutilityofenterprises. Whenthepunishmentisexcessively
high,enterpriseswillavoidexceedingthecarbonemissioncreditatallcosts,negativelyaffectingproductivityandtrade.
Conversely,supposethepunishmentissettoolow. Inthatcase,productionactionswillgounchecked,resultinginlow
equalityandexceedinglyhighcarbonemissions. Therefore,wehavemaintainedaconstantpunishmentformostofour
experiments. Aftereachperiod,thecarbonemissioncreditsallocatedtoenterprisesareresetwhilethegovernment
projectremainsintact.
ObservationSpace. Thegovernmentpossessesaccesstocomprehensiveinformation. Firstly,itcanobservetheentire
gridworld,includingthepositionsofallenterpriseagents,theirproperties’locations,andthegovernment-certified
project’slocation. Next,concerningtheprivateinformationofenterprises,thegovernmentcancollectdataontheir
skillsandattributes. Additionally,real-timemarketinformation,includingembeddedpricehistoryandallpublished
requests,isreadilyavailable. Furthermore,thegovernmenthasaccesstoinformationrelatedtocarbonemissioncredits,
suchasexcessrecordsandthetotalremainingcredit.
Remark: Notably,indevelopingacarbonmarketmodelsimilartoAI-Economist,weoptforaselectionofhyper-
parameterswithoutreferencingempiricaldata,relyingsolelyonfundamentaleconomicprinciples. Thisendowsthe
simulationmodelwithseveraladvantages. Firstly,governmentandenterpriseagentspossessnopriorknowledgeof
externalmarketsoreconomictheoryandlackanyunderstandingofeachother’sbehavioralpatterns. Consequently,
thesimulatorcanoptimizearbitrarysocialoutcomesthroughhyperparameterconfiguration. Secondly,carbonmarket
dataisscarceandtypicallyencompassesrelativelysmallmarketscales. Ourproposedsimulator,byusingappropriate
hyperparametersettings,transcendsthelimitationsofreal-worlddata,enablingtheexaminationofallocationstrategies
and the impact of economic activities under varying carbon market scales. Lastly, the simulator can validate the
rationalityofdifferenteconomictheoriesbyadjustinghyperparametersfollowingvarioustheoreticalperspectives.
4 EnterpriseBehaviorSimulation
Uponthecompletionofcarbonmarketmodeling,wecanemploy(MA)RLtotrainthegovernment(enterprise)agent(s),
enablingthemtoexhibitbehaviorthatcloselyresemblesreal-worldscenarios,therebyachievingarealisticsimulation
6Figure2: Quantitativeresultsofdifferentallocationpolicies.
ofthecarbonmarket. Thissectionprimarilyfocusesonthesimulationofthecriticalentitiesinthecarbonmarket,
namelythebehaviorofenterpriseagents. BasedonrewardfunctionwedefinedinEquation(1),wecanobtaindesired
policyπ bymaximizingtotaldiscountedreward:
i
(cid:34) T (cid:35)
(cid:88)
m πa ixE ai∼πi,a−i∼π−i,s′∼T
t
γt(u i,t−u i,t−1)+u i,0 . (8)
LikeAIEconomist,weuseastrongbaselineinMARL,theindependentPPO[49],totrainadaptiveresponseenterprise
agentsforgovernmentpolicy. Weincorporate5enterpriseagentsintothecarbonmarketinthesimulation.
4.1 TrainingDetails
Toenhanceagents’performance,theobservationofenterprisesincludespositioninformation,whichcanberepresented
asanimage.Toprocessthispositioninformation,aconvolutionalneuralnetwork(CNN)isemployed.Otherinformation
isaddedtotheCNN’soutput,andthecombineddataispassedthroughapipelineconsistingoffullyconnected(FC)
layers,alongshort-termmemory(LSTM)network,andadditionalFClayers. Thisprocessyieldsactionlogits. Agents’
policiesareobtainedbyapplyinganactionmaskandperformingasoftmaxoperationontheselogits.
MARLtrainingaimstodiscoveranallocationpolicythatmaximizestheGovernment’srewardr,whilealsofindinga
balancebetweenproductivity,equality,andcarbonemissionsunderthedesignatedeconomy-climatecoefficientce.
Forthejointoptimizationofenterpriseandgovernmentpolicies,wefirstinitializetheparametersofenterpriseagentsto
thosetrainedundergovernmentpoliciesbasedonFlatandEnterprisesizeastheindicator(SI)scenario. Subsequently,
theparametersofgovernmentpoliciesarerandomlyinitialized. Duringtraining,weutilizethePPOalgorithm[49]
undertheRLlibframework[50]. Additionally,weexperimentwithvarioushyperparametersforbothenterpriseand
governmentagents,includinglearningrateandentropyregularization. Followingtrainingwith400millionsamples,we
findbothenterpriseandgovernmentagentstoconvergetostablepolicies,whicheffectivelybalanceproductivity,equity,
andcarbonemissions. (Figure2)
4.2 BaselineAllocationPolicies
Weutilizetheindicatorapproach[11]toallocatetheproportionoftotalcarboncreditsforeachenterpriseannually,
withEmission(alsocalledgrandfatheringorGF[51]),Emissionintensity(alsocalledbenchmarkingorBM[52]),
andEnterprisesizeselectedasindicators(shortenasSI).Duetothelargetemporalscaleofoursimulationspanning10
years,thegovernmentagentneedstoallocatethetotalcarbonemissioncreditsforeachyearoverthe10-yearperiod. We
refertotheglobalcarbonemissionhistoricaldataandfutureforecastsprovidedbytheIPCC[53]toestablishemission
scenariosonalargetemporalscale: wecallthisscenarioConvex. Additionally,weprovidescenarioswheretheannual
7Figure3: SimulationdetailsforMARLandotherapproacheswithSI,whichincludethesocialwelfare,cumulative
carbonemissions,thetotalnumberoftradeactivities,properties,governmentprojects,andtheinvestments.
emissiontargetsdecreasegraduallyovertime(Decreasing),andscenarioswheretheannualemissiontargetsremain
constantovertime(Flat).
4.3 SimulationDetails
Inthissection, wedelveintothespecificsofoursimulationsetupandtheobservedbehaviorsofenterpriseagents
under various government policies. We analyze key activities such as trade, production, and the construction of
government-certifiedprojects,assessingtheirimpactonoverallproductivity,equality,andcarbonemissions. Through
thesesimulations,weaimtoillustratehowdifferentallocationpoliciesinfluenceenterprisebehaviorandtheresulting
economicandenvironmentaloutcomes.
TradeActivities. Ineachtradeactivity,acarbonemissioncreditcirculatesamongtheenterprises,alongwithcoins
correspondingtothecurrentpriceofthecarbonemissioncredit. Thepriceofemissioncreditfluctuatessignificantly
withchangesinenterprisecarbonemissionlevel,makingitchallengingtoanalyze. Therefore,weanalyzeenterprise
tradingactivitiesbyaveragingtradingvolumesovermultipleepisodes. Asshowninthegraphinthemiddle-upperpart
ofFigure3,undervariousgovernmentpolicies,thecirculationofcoinsamongenterprisesduetotradingalignsclosely
withtheequalityofgovernmentpolicies.
ProductionActivities. Produceactionistheonlyactionthatgeneratescoins,andthecoinsgeneratedinasingle
productionaresolelyrelatedtotheenterprise’ssize. Therefore,thetotalincomeofallenterprisesinanepisodeis
closelyrelatedtothetotalnumberofproduceactions,whichisessentiallythenumberofproperties.
GovernmentCertifiedproject. Government-certifiedprojectsinoursetuprepresentgovernment-ledpublicgreen
energyinitiatives,aligningwithreal-worldscenarios. Inoursimulator,theseprojectscanstorecarboncreditsacross
periods. Whenconstructed,theyinitiallyreducethecarbonemissionsofallenterprises(definedinEquation3). They
alsopay1unitofcarbonemissioncredittotheconstructor(i.e., enterprise)butchargehighcoinsandlaborcosts.
Asobservedinthebottom-leftpartofFigure3,allbaselinepoliciesexhibitlowertotalgovernment-certifiedproject
construction. Incontrast,theMARL-basedallocationpolicystandsoutwithsignificantlyhighergovernment-certified
projectconstruction. ThisdifferencemaystemfromtheMARL-basedpolicy’smorediversifiedallocationstrategies,
resultinginhighersocialwelfare.
Carbon emission. According to Equation (3), invest actions can reduce the carbon emissions of the investing
enterprisewhilealsohavingaminorimpactonthecarbonemissionsofotherenterprises. Theoverallcarbonemissions
8arerelatedtotheoverallproductionactivitiesandthecarbonemissionsofindividualenterprises. Fromthelower-
middle and lower-right parts of Figure 3, in conjunction with the previous analyses of production activities and
government-certifiedprojects,wecanobservedifferentbehavioralpatternsassociatedwiththe4differentpolicies.
Under the flat policy, enterprises engage in more total production and investment activities, resulting in higher
carbonemissions. However,duetothelackofdifferentiationinthispolicy,someenterprisesexceedtheirallocated
carbon credits significantly. In the decreasing policy, economic activities of enterprises are subdued, leading to
lowerproductivitybuthigherequalityandfewerexcesscarbonemissions. Fortheconvexpolicy,therearefewertotal
productionactivitiesbutmoreinvestmentactivities,resultinginlowerandfewerexcesscarbonemissions. Underthe
MARL-basedpolicy,enterprisesconstructmoregovernment-certifiedprojectsthatcanenhanceoverallincome. Dueto
differentiatedallocationstrategies,evenwithlowerinvestmentactivity,therearemoretotalproductionactivitiesand
highercarbonemissionsbutfewerexcesscarbonemissions.
5 Visualization
Inthissection,wepresentthevisualtoolsdevelopedtoillustratethesimulationresultsandanalyzethebehaviorsofthe
agentsinourcarbonmarketmodel. Visualizationplaysacrucialroleinunderstandingthecomplexinteractionsand
outcomeswithinthemulti-agentreinforcementlearning(MARL)environment. Ourvisualtoolsprovideinsightsinto
thedynamicsofenterpriseandgovernmentagents,theireconomicactivities,andtheimpactofdifferentpolicies.
Figure4: Simulatordashboard,itpresentsdetailedinformationencompassingenterprises’attributes,assets,andactions
withinasingletimestepacrossvariousexampleepisodesunderdifferentpolicies. Additionally,itprovidesvisual
representations of the average carbon prices over different periods and presents rewards for both enterprises and
government.
5.1 DashboardOverview
Thesimulatordashboard(Figure4)offersacomprehensiveviewofthesimulationatanygiventimestepwithinan
episode. It includes detailed information about the attributes, assets, and actions of enterprises, as well as visual
9representationsoftheaveragecarbonprices,tradevolumes,andrewardsforbothenterprisesandthegovernment. This
allowsforanintuitivecomparisonbetweendifferentbaselineandMARLstrategies.
Thedashboardisdividedintoseveralkeysections:
• Skills: Displaystheresearchabilityandmanufacturingvolumeofeachenterprise.
• GridWorld: Visualizesthepositionsandmovementsofenterpriseswithinthegridworld.
• CarbonPrice: Tracksthefluctuationsincarbonemissioncreditprices.
• Rewards: Showsthecumulativerewardsforbothenterprisesandthegovernment.
• CarbonEmissionCredits: Illustratestheremainingcarboncreditsforeachenterprise.
• Coins: Displaystheaccumulationofcoinsbyeachenterprise.
• CarbonEmissionLevel: Monitorsthechangesincarbonemissionlevelsovertime.
• Labor: Tracksthelaborusageofeachenterprise.
Byleveragingthesevisualizations,wegainvaluableinsightsintothetrade-offsbetweenproductivity,equality,and
carbonemissions,ultimatelyguidingthedevelopmentofmoreeffectivecarbonmarketpolicies.
6 ClosingRemarks
Inthispaper,enterpriseandgovernmentagentsparticipateincarbonmarketsimulationsviaMARL-basedadaptive
mechanismdesign. Byfine-tuningthegovernment’srewardfunction,wecanexploittheadaptabilitytostrikeabalance
between various economic and climate objectives. Unlike the commonly used indicator approach, MARL-based
agentscanincorporatemorecomprehensiveinformation,enablingthemtoformulatemorepersonalizedanddiversified
allocationstrategies. Wealsoillustratesthepracticalityofemployinghierarchicalmodel-freeMARLforcarbonmarket
simulation.Itenvisionsthepotentialofmachinelearningtocontributetoglobalemissionreductionendeavors.However,
theproposedsimulatorstillneedstobeimproved,notablytheabsenceofempiricalmodelingforemissionsreduction
investments made by enterprises. Consequently, future simulations can enhance their realism by integrating more
real-worlddata.
EthicalStatement
Inourdevelopmentofthecarbonmarketsimulator,weadheretoprinciplesoftransparency,integrity,andfairness,
ensuringcompliancewiththehighestethicalstandardswhileadvancingunderstandinginenvironmentaleconomics.
Weprioritizeprivacy,equity,andsocialresponsibilitythroughoutourresearchanddevelopmentprocess. However,
it’simportanttoacknowledgethatoursimulatormaynotencompassallaspectsoftherealworld. Assuch,wedonot
endorsetheuseoflearnedpoliciesforactualpolicymaking.
Acknowledgements
BaoxiangWangispartiallysupportedbyNationalNaturalScienceFoundationofChina(62106213,72394361).
10References
[1] RichardSchmalensee,ThomasM.Stoker,andRuthA.Judson. Worldcarbondioxideemissions: 1950-2050. The
ReviewofEconomicsandStatistics,80(1):15–27,1998.
[2] UnitedNations. EndingPoverty. https://www.un.org/en/global-issues/ending-poverty/,2023. Ac-
cessedonJune13,2024.
[3] United Nations. Water. https://www.un.org/en/global-issues/water/, 2023. Accessed on June 13,
2024.
[4] United Nations. Climate Change. https://www.un.org/en/global-issues/climate-change/, 2023.
AccessedonJune13,2024.
[5] UNFCCC. Theparisagreement,2015.
[6] UNFCCC. Kyotoprotocol. 1997. AccessedonJune13,2024.
[7] MichaelWara. Istheglobalcarbonmarketworking? Nature,445(7128):595–596,2007.
[8] KaileZhouandYiwenLi. Carbonfinanceandcarbonmarketinchina: Progressandchallenges. Journalof
CleanerProduction,214:536–549,2019.
[9] LawrenceHGoulderandAndrewRSchein. Carbontaxesversuscapandtrade: acriticalreview. ClimateChange
Economics,4(03):1350010,2013.
[10] RichardSchmalenseeandRobertNStavins. Thedesignofenvironmentalmarkets: Whathavewelearnedfrom
experiencewithcapandtrade? OxfordReviewofEconomicPolicy,33(4):572–588,2017.
[11] P.ZhouandM.Wang. Carbondioxideemissionsallocation: Areview. EcologicalEconomics,125:47–59,2016.
[12] CameronHepburn. Carbontrading: Areviewofthekyotomechanisms. AnnualReviewofEnvironmentand
Resources,32(1):375–393,2007.
[13] MichaelHübler,SebastianVoigt,andAndreasLöschel. Designinganemissionstradingschemeforchina—an
up-to-dateclimatepolicyassessment. Energypolicy,75:57–72,2014.
[14] LingTang,JiaruiShi,andQinBao. Designinganemissionstradingschemeforchinawithadynamiccomputable
generalequilibriummodel. EnergyPolicy,97:507–520,2016.
[15] HuiminBi,HaoXiao,andKejuanSun. Theimpactofcarbonmarketandcarbontaxongreengrowthpathwayin
china: adynamiccgemodelapproach. EmergingMarketsFinanceandTrade,55(6):1312–1325,2019.
[16] LingTang,JiaqianWu,LeanYu,andQinBao. Carbonallowanceauctiondesignofchina’semissionstrading
scheme: Amulti-agent-basedapproach. EnergyPolicy,102:30–40,2017.
[17] MeirongZhou,MingZhou,YanchunPan,ZhiminChen,andJunZeng. Multi-agent-basedsimulationforpolicy
evaluationofcarbonemissions. InTheory,Methodology,ToolsandApplicationsforModelingandSimulationof
ComplexSystems: 16thAsiaSimulationConferenceandSCSAutumnSimulationMulti-Conference,AsiaSim/SCS
AutumnSim2016,Beijing,China,October8-11,2016,Proceedings,PartIII16,pages265–272.Springer,2016.
[18] JoãoBernardoNarcisodeSousa. Carbonmarketmulti-agentsimulationmetamodel: atestbedforcoordination
mechanismsinsociotechnicalsystems. 2021.
[19] StephanZheng,AlexanderTrott,SunilSrinivasa,DavidCParkes,andRichardSocher. Theaieconomist:Taxation
policydesignviatwo-leveldeepmultiagentreinforcementlearning. Scienceadvances,8(18):eabk2607,2022.
[20] Alexander Trott, Sunil Srinivasa, Douwe van der Wal, Sebastien Haneuse, and Stephan Zheng. Building a
foundation for data-driven, interpretable, and robust policy design using the ai economist. arXiv preprint
arXiv:2108.02904,2021.
[21] PaulBaer,GlennFieldman,TomAthanasiou,andSivanKartha. Greenhousedevelopmentrights: towardsan
equitableframeworkforglobalclimatepolicy. InThePoliticsofClimateChange,pages192–212.Routledge,
2013.
[22] ChristophBöhringerandAndreasLange.Onthedesignofoptimalgrandfatheringschemesforemissionallowances.
EuropeanEconomicReview,49(8):2041–2055,2005.
[23] Wen-JingYi,Le-LeZou,JieGuo,KaiWang,andYi-MingWei. Howcanchinareachitsco2intensityreduction
targetsby2020? aregionalallocationbasedonequityanddevelopment. EnergyPolicy,39(5):2407–2415,2011.
[24] MikelGonzález-Eguino. Theimportanceofthedesignofmarket-basedinstrumentsforco2mitigation: Anage
analysisforspain. EcologicalEconomics,70(12):2292–2302,2011.
11[25] Song-min Yu, Ying Fan, Lei Zhu, and Wolfgang Eichhammer. Modeling the emission trading scheme from
an agent-based perspective: System dynamics emerging from firms’ coordination among abatement options.
EuropeanJournalofOperationalResearch,286(3):1113–1128,2020.
[26] THuwEdwardsandJohnPHutton. Allocationofcarbonpermitswithinacountry: ageneralequilibriumanalysis
oftheunitedkingdom. EnergyEconomics,23(4):371–386,2001.
[27] AkramEsmaeiliAvval,FarzadDehghanian,andMohammadaliPirayesh. Auctiondesignfortheallocationof
carbonemissionallowancestosupplychainsviamulti-agent-basedmodelandq-learning. Computationaland
AppliedMathematics,41(4):170,2022.
[28] HideyukiMizuta,SeiKato,andHidekiTai. Agent-basedsimulationofco2emissionstradingandlarge-scale
trafficflow. InSICE,2008.
[29] MohammadhusseinRafieisakhaei,BabakBarazandeh,AmirbahadorMoosavi,MasoudFekri,andKavehBastani.
Modelingdynamicsofthecarbonmarket: Asystemdynamicsapproachontheco2emissionsanditsconnections
totheoilmarket. InICSDS,2016.
[30] VincentConitzerandTuomasSandholm. Complexityofmechanismdesign. arXivpreprintcs/0205075,2002.
[31] PaulDütting,FelixFischer,PichayutJirapinyo,JohnKLai,BenjaminLubin,andDavidCParkes. Paymentrules
throughdiscriminant-basedclassifiers,2015.
[32] YufeiWang,ZheyuanRyanShi,LantaoYu,YiWu,RohitSingh,LucasJoppa,andFeiFang. Deepreinforcement
learningforgreensecuritygameswithreal-timeinformation. InProceedingsoftheAAAIConferenceonArtificial
Intelligence,volume33,pages1401–1408,2019.
[33] DavidBalduzzi,MartaGarnelo,YoramBachrach,WojciechCzarnecki,JulienPerolat,MaxJaderberg,andThore
Graepel. Open-endedlearninginsymmetriczero-sumgames. InInternationalConferenceonMachineLearning,
pages434–443.PMLR,2019.
[34] PingzhongTang. Reinforcementmechanismdesign. InIJCAI,pages5146–5150,2017.
[35] WeiranShen,BinghuiPeng,HanpengLiu,MichaelZhang,RuohanQian,YanHong,ZhiGuo,ZongyaoDing,
PengjunLu,andPingzhongTang. Reinforcementmechanismdesign: Withapplicationstodynamicpricingin
sponsoredsearchauctions. InProceedingsoftheAAAIconferenceonartificialintelligence,volume34,pages
2236–2243,2020.
[36] DavidThompson,NeilNewman,andKevinLeyton-Brown. Thepositroniceconomist: Acomputationalsystem
foranalyzingeconomicmechanisms. InProceedingsoftheAAAIConferenceonArtificialIntelligence,volume31,
2017.
[37] StephanZheng,AlexanderTrott,SunilSrinivasa,NikhilNaik,MelvinGruesbeck,DavidCParkes,andRichard
Socher. The ai economist: Improving equality and productivity with ai-driven tax policies. arXiv preprint
arXiv:2004.13332,2020.
[38] CarolineClausandCraigBoutilier. Thedynamicsofreinforcementlearningincooperativemultiagentsystems.
AAAI/IAAI,1998(746-752):2,1998.
[39] GuillaumeJLaurent,LaëtitiaMatignon,LeFort-Piat,etal. Theworldofindependentlearnersisnotmarkovian.
InternationalJournalofKnowledge-basedandIntelligentEngineeringSystems,15(1):55–64,2011.
[40] TabishRashid,MikayelSamvelyan,ChristianSchroederDeWitt,GregoryFarquhar,JakobFoerster,andShimon
Whiteson. Monotonicvaluefunctionfactorisationfordeepmulti-agentreinforcementlearning. TheJournalof
MachineLearningResearch,21(1):7234–7284,2020.
[41] PeterSunehag,GuyLever,AudrunasGruslys,WojciechMarianCzarnecki,ViniciusZambaldi,MaxJaderberg,
MarcLanctot,NicolasSonnerat,JoelZLeibo,KarlTuyls,etal. Value-decompositionnetworksforcooperative
multi-agentlearning. arXivpreprintarXiv:1706.05296,2017.
[42] RyanLowe,YiIWu,AvivTamar,JeanHarb,OpenAIPieterAbbeel,andIgorMordatch. Multi-agentactor-critic
formixedcooperative-competitiveenvironments. Advancesinneuralinformationprocessingsystems,30,2017.
[43] ChaoYu,AkashVelu,EugeneVinitsky,JiaxuanGao,YuWang,AlexandreBayen,andYiWu. Thesurprising
effectiveness of ppo in cooperative multi-agent games. Advances in Neural Information Processing Systems,
35:24611–24624,2022.
[44] TianminShuandYuandongTian. M3RL:Mind-awaremulti-agentmanagementreinforcementlearning. InICLR,
2019.
[45] JinmingMaandFengWu. Feudalmulti-agentdeepreinforcementlearningfortrafficsignalcontrol. InAAMAS,
2020.
12[46] RichardBellman. Amarkoviandecisionprocess. Journalofmathematicsandmechanics,pages679–684,1957.
[47] EricAHansen, DanielSBernstein, andShlomoZilberstein. Dynamicprogrammingforpartiallyobservable
stochasticgames. InAAAI,2004.
[48] Gerard Debreu et al. Representation of a preference ordering by a numerical function. Decision processes,
3:159–165,1954.
[49] ChristianSchroederdeWitt,TarunGupta,DenysMakoviichuk,ViktorMakoviychuk,PhilipHSTorr,Mingfei
Sun,andShimonWhiteson. Isindependentlearningallyouneedinthestarcraftmulti-agentchallenge? arXiv
preprintarXiv:2011.09533,2020.
[50] EricLiang,RichardLiaw,RobertNishihara,PhilippMoritz,RoyFox,KenGoldberg,JosephGonzalez,Michael
Jordan,andIonStoica. Rllib: Abstractionsfordistributedreinforcementlearning. InInternationalconferenceon
machinelearning,pages3053–3062.PMLR,2018.
[51] LarsZetterberg,MarkusWråke,ThomasSterner,CarolynFischer,andDallasBurtraw. Short-runallocationof
emissionsallowancesandlong-termgoalsforclimatepolicy. Ambio,41:23–32,2012.
[52] HeleenGroenenbergandKornelisBlok. Benchmark-basedemissionallocationinacap-and-tradesystem. Climate
Policy,2(1):105–109,2002.
[53] Climate. Climate Change 2023: Synthesis Report. Contribution of Working Groups I, II and III to the Sixth
AssessmentReportoftheIntergovernmentalPanelonClimateChange. IPCC,Geneva,2023.
13
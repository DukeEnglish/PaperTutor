SupervisedAutoencoderMLPforFinancialTimeSeriesForecasting
BartoszBieganowski1andRobertS´lepaczuk2
1UniversityofWarsaw,FacultyofEconomicSciences,QuantitativeFinanceResearchGroup,Ul.Długa44/50,00-241Warsaw,
Poland.ORCID:https://orcid.org/0009-0003-8671-8266
2UniversityofWarsaw,FacultyofEconomicSciences,DepartmentofQuantitativeFinanceandMachineLearning,Quantitative
FinanceResearchGroup,Ul.Długa44/50,00-241Warsaw,Poland.ORCID:https://orcid.org/0000-0001-5527-2014,corresponding
author:rslepaczuk@wne.uw.edu.pl
Abstract
Thispaperinvestigatestheenhancementoffinancialtimeseriesforecastingwiththeuseofneuralnetworksthrough
supervised autoencoders, aiming to improve investment strategy performance. It specifically examines the impact of
noiseaugmentationandtriplebarrierlabelingonrisk-adjustedreturns, usingtheSharpeandInformationRatios. The
studyfocusesontheS&P500index,EUR/USD,andBTC/USDasthetradedassetsfromJanuary1,2010,toApril30,
2022.Findingsindicatethatsupervisedautoencoders,withbalancednoiseaugmentationandbottlenecksize,significantly
booststrategyeffectiveness. However,excessivenoiseandlargebottlenecksizescanimpairperformance,highlighting
theimportanceofpreciseparametertuning.Thispaperalsopresentsaderivationofanoveloptimizationmetricthatcan
beusedwithtriplebarrierlabeling.Theresultsofthisstudyhavesubstantialpolicyimplications,suggestingthatfinancial
institutionsandregulatorscouldleveragetechniquespresentedtoenhancemarketstabilityandinvestorprotection,while
alsoencouragingmoreinformedandstrategicinvestmentapproachesinvariousfinancialsectors.
Keywords: machine learning, algorithmic investment strategy, supervised autoencoders, financial time series, trading
strategy,risk-adjustedreturn.
JELCodes:C14,C45,C53,C58,G13
Note: Thisresearchdidnotreceiveanyspecificgrantfromfundingagenciesinthepublic,commercial,ornot-for-profit
sectors.
1
4202
rpA
2
]RT.nif-q[
1v66810.4042:viXraIntroduction
This research focuses on the development of an Algorithmic Investment Strategy (AIS) that leverages Supervised Au-
toencoder - Multi-Layer Perceptron (SAE-MLP) networks. This strategy aims to utilize high-frequency price data, a
significant shift from traditional methods that primarily rely on daily closing prices. The study is structured to test and
answerthreeprimaryresearchquestions:
• RQ1. Doesdataaugmentationanddenoisingviaautoencodersimprovetheperformanceofastrategy?
• RQ2. Doestriplebarrierlabelingimproveclassifierperformanceoversimpledirectionclassification?
• RQ3. Doeshyperparametertuninghelpachievebetterperformanceoftheinvestmentstrategy?
ThefinancialinstrumentsunderstudyincludetheS&P500Index(SPX),theEUR/USDcurrencypair,andBitcoin
(BTC).OurdatasetspansfromJanuary1,2016,toApril31,2022,withthelatterperiodusedasout-of-sampledatafor
testing. Itisimportanttonotethedifferenceintradinghoursfortheseassets,withtheS&P500indexhavingrestricted
hoursandBitcoinbeingtraded24/7.
Toaddressourresearchquestions,weemployempiricalmethods,developingtradingstrategiesbasedonvarious
SAE-MLP model architectures. These models are tested using data collected at one-minute intervals. Our approach
involves using the SAE-MLP model for price prediction, employing a walk-forward method. This process begins with
hyperparameters sourced from existing literature, followed by fine-tuning through hyperparameter optimization. We
anticipatethatmodelswithalgorithm-selectedhyperparameterswillshowsuperiorperformance.
Ourmethodologyalsoincludestransformingthereturnestimationproblemfromaregressionmodeltoaclassifi-
cationone,focusingonpredictingpricedirectionratherthantheexactprice. Thisshiftisexpectedtobemoreeffective
forgeneratinginvestmentsignalsduetothemorerelevantlossfunctioninthiscontext. Wesubsequentlytesttriplebarrier
labeling, a novel technique of estimating maximum and minimum prices from a given period instead of fixed-horizon
close prices. Additionally, we conduct a sensitivity analysis to examine the robustness of our findings under different
assumptions.
The structure of this paper is as follows: Section 1 provides a literature review, emphasizing neural network
applications in stock and cryptocurrency price predictions. Section 2 details the data and financial instruments used.
Section3describesthemethodology, includingtheSAE-MLPmodel, walk-forwardapproach, equitylineconstruction,
ensemble model, and performance metrics. It also elaborates on the research approaches. Section 4 presents empirical
results,comparingthemwitheachotherthroughequitylinechartsandperformancemetricstables. Section5conductsa
sensitivityanalysisofthemostpromisingapproach,focusingonvariationsinhyperparameters. Thepaperconcludeswith
Section6,summarizingtheresearchfindings.
1 Literature Review
The exploration of financial market efficiency and the predictability of stock price movements has long captivated aca-
demicinterest. Thishasledtoextensiveresearchintegratingmachinelearningtechniquesintofinancialanalysis. Central
tothisdiscussionistheEfficientMarketHypothesis(EMH),whichpositsthatstockpricesreflectallavailableinforma-
tion, rendering them fundamentally unpredictable. This hypothesis is categorized into three forms: weak, semi-strong,
and strong. The weak form challenges the basis of technical analysis by suggesting that stock prices follow a random
path. Thesemi-strongformarguesthatstockpricesinstantaneouslyincorporateallpublicinformation,therebydiminish-
ingtheeffectivenessoffundamentalanalysis. Thestrongformextendsthisargumenttoincludeallinformation, public
andprivate,inthedeterminationofstockprices(Malkiel,1973).
Fama(1970)acknowledgedthepresenceofstatisticallysignificantpatternsindailyreturnsthatcouldpotentially
affect profitable trading strategies, yet he also noted that these patterns might not contradict the EMH. Malkiel (2005)
further argued that active equity management often fails to outperform passive investment strategies, a viewpoint that
alignswiththeEMH.However,behavioralfinancetheoristslikeBarberisandThaler(2002)havecounteredbysuggesting
thatmarketinefficienciescancausestockpricestodeviatefromtheirtruevalues. Thisperspectivechallengesthenotion
that the inability of portfolio managers to consistently beat market indices is a definitive indicator of market efficiency.
Contrary to the EMH, a significant contingent of technical analysts, or technicians, maintain that historical price data
can be used to forecast future stock prices (Lo and Hasanhodzic, 2010). Additionally, the existence of stock market
anomalies and serial correlations in economic factors presents further challenges to the EMH (Abu-Mostafa and Atiya,
1996).AnotherprominentmodelintimeseriespredictionistheBox-JenkinsModel,orARIMA(autoregressiveintegrated
moving average), formulated by George Box and Gwilym Jenkins. This model combines autoregression, differencing,
andmovingaveragestopredictstockprices. Ithasbeenwidelyappliedinfinancialforecasting(BoxandJenkins,1976).
Giventherecentadvancementsinpowerfulcomputersandefficientmachinelearningalgorithms,itisnotsurprising
thatmanymachinelearning(ML)techniqueshavebeenresearchedforforecastingthedirectionoffinancialinstruments’
prices. Examples of supervised learning approaches that can be trained to forecast asset prices and trends based on
2previous data and provide insightful historical price analysis include Support Vector Machine (SVM), Decision Trees,
andANNs(ZenkovaandS´lepaczuk,2019). Morepaperstryingtotacklethisissuearedescribedbelow.
Ariyoetal. (2014)appliedtheARIMAmodeltodatafromtheNewYorkandNigeriaStockExchanges,demon-
strating its capability in short-term price prediction and its comparability to other techniques like ANNs. Azari (2018)
alsotestedtheARIMAmodel’seffectivenessinpredictingBitcoinvaluesoverthreeyears.Themodelshowedproficiency
inshort-termforecasts,particularlyinstableperiods,butstruggledwithsuddenpricefluctuationsandlong-termpredic-
tions, especially in volatile periods like the end of 2017. This limitation highlights the challenges in predicting prices
overextendedperiodsorinhighlyvolatilemarkets. InastudyconductedbySiamietal. (2018),theeffectivenessofdeep
learning-basedtimeseriesforecastingalgorithms,includingLSTM,wascomparedtothatofmoreestablishedalgorithms
like ARIMA. The results showed that LSTM and other deep learning-based techniques outperformed ARIMA with an
average error rate reduction of 84 to 87 percent, demonstrating the superiority of LSTM. The study also found that the
trainedforecastmodelbehavedrandomlyandthenumberoftrainingcycles(epochs)hadnoimpactonitsperformance.
InanotherstudybyGrudniewiczandS´lepaczuk(2021),variousMachineLearningalgorithmswereappliedtotechnical
analysis indicators for the WIG20, DAX, S&P 500, and a few selected CEE indices. The study concluded that quanti-
tativetechniquesoutperformedpassivestrategiesintermsofrisk-adjustedreturns,withtheBayesianGeneralizedLinear
ModelandNaiveBayesbeingthetopmodelsfortheinvestigatedindices. DiPersioandHonchar(2017)investigatedthe
performanceofthreerecurrentneuralnetwork(RNN)models,includingabasicRNN,LSTM,andGatedRecurrentUnit
(GRU), using the price of Google stock as input. The study also provided insights into the hidden dynamics of RNN.
TheirresultsshowedthattheLSTMoutperformedtheothermodelswitha72percentaccuracyonafive-dayhorizon. Ki-
jewskiandS´lepaczuk(2020)utilizedtraditionaltechniquesandarecurrentneuralnetworkmodel(LSTM)toimplement
buy/sellsignalsforalgorithmicinvestmentstrategies. Theirstudyevaluatedtheeffectivenessofinvestmentalgorithmson
theS&P500indextimeseries, spanning20yearsofdatafrom2000to2020. Theyemployedarollingtraining-testing
windowfordynamicparameteroptimizationthroughoutthebacktestingprocess.Thecombinationofsignalsfromseveral
methodsdoubledthereturnsonthesamelevelofriskoftheBuy&Holdstrategybenchmark.Thestudyfurtherfoundthat
theLSTMmodelwassignificantlylessresistanttochangesinparametersthanconventionaltechniques,asdemonstrated
throughathoroughsensitivitystudy.
Many studies have explored the use of ensemble or hybrid techniques with LSTM for improved performance.
Hossain et al. (2018) developed a deep learning-based hybrid model consisting of LSTM and GRU architectures to
predictS&P500pricesusingadatasetspanning66years. Inthisapproach,theinputdataispassedtotheLSTMnetwork
togenerateafirst-levelprediction,andtheoutputoftheLSTMlayeristhenpassedtotheGRUlayertoprovidethefinal
prediction. The proposed model outperformed earlier neural network techniques with a Mean Squared Error (MSE) of
0.00098inprediction.
However,manycurrentstudiesdonotconsidernon-stationarity,whichisasignificantchallengeinfinancialtime
seriesforecasting.Shahetal.(2018)demonstratedthepotentialofLSTM-RNN-basedmodelsinpredictingnon-stationary
data. ThestudyshowsthattheLSTMmodelprovidesexcellentresultsfordailyforecastsandsatisfactoryoutcomesfor
predictionsmadesevendaysinadvanceusingonlydailypriceasafeature.Theauthorsusedalargertrainingdatasetspan-
ning20years,includingmarketupsanddowns,totrainthemodel. ThestudysuggeststhatLSTMRNNhasthepotential
foridentifyingunderlyingtrendsandproducinglonger-termforecastswiththeadditionofmorefeatures,particularlyfor
volatilestockdatasets.
BaranochnikovandS´lepaczuk(2022)proposeawalk-forwardprocedureforcross-validationofmachinelearning
models in financial time series forecasting. They apply this method to test algorithms on four financial assets (Bitcoin,
Tesla, Brent Oil, and Gold) and conclude that LSTM outperforms GRU in most cases. De Prado (2016) presented a
method called combinatorial purged cross-validation (CV) for backtesting time series data that addresses some of the
issueswithtraditionalk-foldCVmethods,suchasthatfinancedatacannotbeexpectedtobedrawnfromanindependent
and identically distributed (IID) process, causing k-fold CV to fail. Additionally, the testing set is often used multiple
timesduringmodeldevelopment,leadingtoselectionbias. Intheirstudy,Kamalovetal. (2021)analyzetheeffectiveness
ofstockpriceandreturnasinputfeaturesfordirectionalforecastingmodels,usingdatafromtenhigh-capUScorporations
overtenyears. Theyemployfourcategorizationtechniquestoconstructforecastingmodelsandobservethatstockprice
outperformsreturnasanindependentinputfeatureforpredictingthedirectionofpricemovement. However,whentech-
nicalindicatorsareaddedtotheinputfeatureset,theperformancedifferencebetweenthetwoinputfeaturesdiminishes.
Theauthorsconcludethatstockpriceisamorepotentinputfeaturethanreturnvalueinpredictingthedirectionofprice
movement.
Leetal.(2018)proposeanovelapproachforimprovingthegeneralizationperformanceofneuralnetworksthrough
theuseofasupervisedauto-encoder. Theauthorsnotethatregularizinghiddenlayersinneuralnetworksisnotastraight-
forward task, and existing layer-wise suggestions lack theoretical guarantees for improved performance. In their work,
theyanalyzethesupervisedauto-encodermodel,whichpredictsbothinputs(reconstructionerror)andtargetsjointly. The
authorsprovideanovelgeneralizationresultsforlinearauto-encoders,provinguniformstabilitybasedontheinclusionof
thereconstructionerror. Theirapproachisshowntooutperformsimplisticregularizationmethodssuchasnorms,aswell
asmoreadvancedregularizationtechniquessuchastheuseofauxiliarytasks.
TheuseofMachineLearningtechniquesforpredictinghighlynonlinearandnoisydataondigitalblockchainplat-
formshasbecomeincreasinglycommonduetothenotableincreaseincryptocurrencytrading. Intheirstudy,Suhwanet
3al. (2019) examined several cutting-edge deep learning techniques for predicting Bitcoin prices, including deep neural
networks(DNN),longshort-termmemory(LSTM)models,convolutionalneuralnetworks,deepresidualnetworks,and
theircombinations.TheexperimentalresultsshowedthatDNN-basedmodelsoutperformedtheothermodelsinpredicting
thedirectionofpricemovement,whileLSTM-basedmodelsoutperformedtheothermodelsinpriceprediction. Further-
more,theevaluationofprofitabilityindicatedthatclassificationmodelsweresuperiortoregressionmodelsinalgorithmic
trading.
LahmiriandBekiros(2020)examinetheuseofmachinelearning(ML)modelsinhigh-frequencytradingofBit-
coin. Theyexplorethreedifferenttypesofmodels,includingalgorithmicmodelssuchasregressiontrees,statisticalML
approaches like support vector regressions (SVR), and artificial neural network (ANN) topologies such as feedforward
(FFNN) or Bayesian regularization (BRNN). The study’s results suggest that ANN models outperform other models in
noisysignalenvironments. Theauthorsarguethattheincreasingneedforunderstandingandforecastingvariablesacross
shorter time horizons, coupled with technological advancements and big data processing power, has led to the current
developmentsinhigh-frequencydataestimation. Michan´kówetal. (2022)projectedthefuturevaluesoftheBitcoinand
S&P500index,utilizingdatafrom2013totheendof2020andacrossdaily,hourly,and15-minutefrequencyintervals.
Theyformulatedauniquelossfunction, whichamplifiesthepredictivecapabilitiesoftheLSTMmodelforalgorithmic
investmentstrategies. TheresearchersdeterminedthattheprimaryelementsdictatingtheefficacyofLSTMinalgorith-
mic investment tactics include the approach adopted for hyperparameter tuning, the architecture of the model, and the
estimationprocess.
In the spot and futures markets for the S&P 500, Schulmeister (2009) examines how technical trading strategies
canusemomentumandreversaleffects. Basedondailystatistics,2580technicalmodels’profitabilityhascontinuously
decreased since 1960 and has been negative since the early 1990s. The same models, however, yield an average gross
returnof7.2%eachyearbetween1983and2007whenbasedon30-minutedata. Thisoutcomemaybetheconsequence
of recent improvements in stock market efficiency or a change in stock price trends from 30-minute prices to higher
frequencypricing,aclaimlatersupportedbyKryn´skaandS´lepaczuk(2022).
Dudek et al. (2024) perform a comparative analysis of statistical and machine learning methods for forecasting
cryptocurrencyvolatility, examiningmodelslikeGARCH,LASSO,andLSTMacrossBitcoin, Ethereum, Litecoin, and
Monero. They find that no single model is universally best, but SVR and FNM show consistent performance across
different cryptocurrencies and time frames. Ozbayoglu et al. (2020) provide a comprehensive survey of deep learning
applicationsinfinance,categorizingworksbyfinancialsubfieldsandanalyzingthembasedontheirdeeplearningmodels.
Theyhighlightthesignificantpotentialofdeeplearninginfinanceandsuggestareasforfutureresearch.Sezeretal.(2020)
offer a systematic literature review on deep learning for financial time series forecasting, categorizing studies by their
forecastingareasanddeeplearningmodels. Theyemphasizethesuperiorperformanceofdeeplearningovertraditional
modelsandidentifyresearchgapsandopportunities. Tkácˇ andVerner(2016)reviewtheuseofartificialneuralnetworks
inbusinessapplicationsovertwodecades,focusingonfinancialdistressforecasting,stockpriceprediction,anddecision
support. They note a preference for multilayer feedforward networks and suggest ample room for further research to
enhanceneuralnetworkmodels.
Huetal. (2015)conductedaliteraturereviewonevolutionarycomputationforrulediscoveryinstockalgorithmic
trading, noting a bias toward genetic algorithms and technical analysis. They identify research gaps in fundamental
analysis,transactioncostconsideration,andthecombinationoftradingrulediscoverywithportfolioselection.Fischerand
Krauss(2018)demonstratetheeffectivenessofLSTMnetworksinpredictingfinancialmarketmovements,outperforming
traditional models with substantial profits before 2010. They note that LSTM networks profit from stocks with high
volatilityandshort-termreversalcharacteristics,andshowlowexposuretosystematicrisk. Kraussetal. (2017)evaluate
deepneuralnetworks,gradient-boostedtrees,andrandomforestsforstatisticalarbitrageontheS&P500,findingthatan
ensemble of these methods yields significant out-of-sample returns. This poses a challenge to the semi-strong form of
marketefficiency,despitearecentdeclineinprofits. SezerandOzbayoglu(2018)proposeanalgorithmictradingmodel
usingdeepconvolutionalneuralnetworks,convertingfinancialtimeseriesinto2-Dimagesthroughtechnicalindicators.
Their model outperforms traditional trading systems and the buy-and-hold strategy, showcasing the potential of deep
learninginfinancialforecasting.
Tosummarize,manystudiesindicatethatmachinelearningmodelsoutperformothertechniques,particularlysta-
tistical approaches (e.g., ARIMA models), especially for nonstationary data. It has been proposed that models perform
better when the input value is asset price rather than return. It has further been suggested that intra-day data-driven
strategiesshouldoutperforminter-daydata-drivenstrategies. Inourstudy,weaimtoenhancetheresearchbycomparing
differenttypesofneuralnetworkmodelstodevelopsuccessfultradingstrategiesusingpricesandotherfeaturesasinput
data.
42 Data
2.1 TradedAssets
Theresearchpresentedinthispaperusesthreetimeseriesofdatafortradingandsixmoreasfeatures. Thefirsttraded
timeseriesreferstotheStandardandPoor’s500(S&P500)index. Minute-frequencyopen-high-low-close(OHCL)data
isused,whichwasobtainedcommerciallyfromFirstRateData. ThedatarangesfromJanuary2010toApril2022. The
databeforeJanuary1st,2020isusedexclusivelyfortrainingstrategies. Usinglong-rangetrainingallowsfortestingthe
investmentalgorithmsthroughavarietyofmarketregimes,withdifferentcombinationsoftrendandvolatility. Itincludes
periodsofhighvolatilityanddownsideshocks,suchasthefinancialcrisisof2008,andtheconsecutiveuptrendof2009.
Thesamepointcanbemadefortestdata-theCOVID-relateddownturninMarchof2020,thereboundinthefollowing
months,aswellassteadybearmarketof2022makethetestingenvironmentoftradingalgorithmsquiterobust. Figure1
presentsfluctuationsofSP500intheperiodofourresearch.
ThesecondtradedassetisBitcoin(Figure2),thecryptocurrencythatwasreleasedin2009,whichonlyyearslater
gainedsignificantpopularityasatradeableasset. ThepopularityislinkedtotherapidgrowthofthepriceofBitcoinin
itslifetime,causedmainlybyexpectationsforBitcointobeasuccessoroffiatmoney. Thedatawasalsoobtainedfrom
FirstRateDatainOHLCformat. ThetestingdataforBitcoincoverstwoofthemajor"peaks"initsprice,whichprovides
awaytotestthealgorithm’srobustnessinextremeconditions.
Figure1: LogpriceofSP500withtrain/testcutoff. Figure2: LogpriceofBTCUSDwithtrain/testcutoff.
Source:FirstRateData,S&P500indexintheperiodfromJanuary1,2010 Source:FirstRateData,BTC/USDpairintheperiodfromJanuary1,2010,
toApril30,2022;AccessedMay2022. toApril30,2022;AccessedMay2022.
ThethirdtradedassetistheEUR/USDpair(Figure3),whichsharessomecharacteristicswithbothBitcoin(trade-
able 24/7) and SP500 (being one of the most liquid assets in the world). Although the test period represents mostly a
downwardtrend,weviewitasavaluablebalancingassettotestascomparedtothemostlygrowingS&P500indexand
BTC/USD.
Each of the three assets varies in terms of fundamental characteristics, such as asset class and the number of
participantsinthemarket,butalsointermsofstatisticalpropertiesoftheirreturns. Thedescriptivestatisticsobtainedfor
thetradedfinancialinstrumentsatselectedfrequenciesareshowninTable1. Wecannoticethattheaveragereturnacross
all frequencies and for all three instruments is positive. In terms of volatility, Bitcoin is clearly the most volatile asset,
followedbyS&P500andEURUSDinthelastplace.
2.2 FeatureTimeSeries
Whenitcomestothetimeseriesusedasfeaturesinthispaper,thefirstoneistheseasonallyadjustedInitialClaims(ICSA),
retrievedfromtheFederalReserveBankofSt.Louis,FRED.Aninitialclaimisaclaimfiledbyanunemployedindividual
Figure3: PriceofEURUSDwithtrain/testcutoff.
Source:FirstRateData,EUR/USDpairintheperiodfromJanuary1,2010,toApril30,2022;AccessedMay2022.
5Table1: Descriptivestatisticsfordailyreturnsofthethreetradedassets,dailydata(2010-01-01to2022-04-30).
EURUSD BTC SPX
count 3147 4305 3147
mean -0.00352% 0.52245% 0.0481%
std 0.53612% 7.78643% 1.1135%
min -2.90496% -57.20567% -11.9840%
25% -0.31678% -1.35672% -0.3770%
50% 0.00739% 0.16627% 0.0612%
75% 0.30343% 2.13115% 0.5626%
max 3.00608% 336.83900% 9.3827%
Source:OwnElaborationbasedonFirstRateData,AccessedMay2022
after a separation from an employer. The claim requests a determination of basic eligibility for the Unemployment
Insuranceprogram. ThisdataisreleasedeveryThursdaybytheFEDandreportsthesituationofunemploymentonthe
lastSaturday.
WestTexasIntermediate(WTI)LightSweetCrudeOilfuturesarecurrentlytheworld’smostliquidoilcontract.
Theinclusionofthisassetasafeatureissupportedbythecorrelationbetweensomeofthetradedassetsandoil. Arisein
oilpricescanindicatestrongeconomicgrowthandincreaseddemandforenergy,whichcaninfluenceeachofthetraded
assets. Conversely,afallinoilpricescanindicateaslowdownintheeconomyandadecreaseindemandforenergy.
HenryHubNaturalGasfuturesarecurrentlythethirdmosttradedphysicalcommodityintheworld,andtheyare
included in features for similar reasons as the crude oil futures - the price movements are a good approximation of the
world’seconomyenergydemand,whichinturnhasgreateffectonthetradedassets.
Cornfuturesarethemosttradedfood-relatedcommodityintheworld,andtheirpricemovementsprovideinsight
intothestateoftheeconomyinseveralways. Ariseincornfuturespricescanindicatestrongdemandforcornasafeed
grainforlivestock,asakeyingredientinvariousprocessedfoodproducts,andasabiofuelfeedstock.Thisstrongdemand
could be driven by factors such as population growth, rising incomes, and government policies that support biofuels.
Conversely,afallincornfuturespricescanindicateweakerdemandduetofactorssuchasaslowdownintheeconomy,a
decreaseinbiofuelproduction,oragoodcropyield. Additionally,changescanalsoreflectshiftsinsupplyduetoweather
conditions,pestanddiseaseoutbreaks,tradepolicies,andotherfactors.
Goldistheonlypreciousmetalincludedinthefeaturespace.Historically,ariseingoldpricesindicateduncertainty
orinstabilityinthemarkets, asinvestorsoftenturnedtogoldasasafehavenduringtimesofturmoil. Declinesingold
pricesoftenindicatedincreasedconfidenceinthestabilityofriskierassetssuchasstocks. Goldpricealsoreflectsmining
production, central banks buying or selling it as a store of value, and other factors, making it a good candidate for
informativefeatures.
CopperandAluminumarethetwomostdemandedindustrialmetals,andeventhoughtheiruseisdifferent,they
both provide insight into activity levels in construction, transportation, and manufacturing. Growth in prices for these
metals generally correlated positively with population growth, rising incomes, and government infrastructure spending.
The decline in these prices was usually caused by the slowdown of industrial activity and government infrastructure
spending.
Figure4illustratesthevariedcompositionofourfeaturespace,eachcomponentrepresentingadistinctpartofthe
economy.Featurespaceselectionaimstoreflectwhattradersmightlookatwhenmakingtheirtradingdecisions.Ourgoal
istocoverawiderangeofeconomicindicators,providingaclearerandmorecompletepictureofthefactorsaffectingthe
market.
Table2displaysourlistoffeaturesalongwiththeanticipatedeffectsoftheirincreaseanddecrease. Theseeffects
are inferred from standard economic literature, as well as the intuitive understanding of market behaviors. This table
aimstoprovideanoverviewofhoweachfeaturemightinfluencemarketconditions,drawingfromestablishedeconomic
principlesandpracticalmarketinsights.
3 Feature Engineering
3.1 Motivation
Financialtimeseriesarenotoriousfortheirlowsignal-to-noiseratios,aconceptemphasizedbyLopezdePrado(2018).
Thischaracteristicislargelyduetoarbitrageforcesinthemarket. Standardstationaritytransformations,suchasinteger
differentiation,oftenexacerbatethisissuebyeliminatingvaluablehistoricalmemory,eventhoughpriceseriesinherently
depend on their past. Integer differentiated series, like returns, truncate this history after a limited sample window. To
6Figure4: Visualizationofmainfeaturesusedforthemodel.
Source:OwnElaboration.PlottedwithMatplotlibpackage.
Table2: Presumedimpactofprices/valueschangeontheglobaleconomy.
Feature PresumedIncreaseImpact PresumedDecreaseImpact
ICSA Negative: Indicates rising unemployment, po- Positive: Suggests decreasing unemployment,
tentialeconomicslowdown potentialeconomicgrowth
Oil Mixed:Benefitsoilexporters,increasecostsfor Mixed: Lowers costs for importers and con-
importersandconsumers sumers,butmayharmoil-exportingeconomies
Gas Negative: Increases energy costs, affects con- Positive: Decreases energy costs, boosts con-
sumerspendingandproductioncosts sumerspendingandlowersproductioncosts
Corn Negative: Raisesfoodandfeedprices,impacts Positive: Lowersfoodandfeedprices, benefi-
foodindustryandinflation cialforfoodindustryandinflationcontrol
Gold Mixed:Oftenseenasasafehaven,theincrease Mixed: A decrease may reflect investor
mayindicateeconomicuncertainty confidence, but could impact gold-producing
economies
Copper Positive: Suggests industrial growth and de- Negative: May indicate reduced industrial ac-
mand,oftenapositiveeconomicindicator tivityandeconomicslowdown
Aluminium Positive: Indicates industrial demand and Negative:Couldsuggestaslowdowninkeyin-
growth,especiallyinconstructionandmanufac- dustrieslikeconstructionandmanufacturing
turing
Source:OwnElaboration.
7uncover any residual signal in these transformed series, statisticians then apply complex mathematical methods, which
canleadtofalsediscoveries. Inthiscontext,theuseofARFIMA(AutoregressiveFractionallyIntegratedMovingAver-
age),models,initiallyproposedbyGrangerandJoyeux(1980),offersaninsightfulperspective. Thesemodelsallowfor
fractionaldifferentiation,providingamorenuancedapproachtomaintainingdatastationaritywhilemaximizingmemory
retention.
For inferential analysis, researchers typically transform these series into invariant processes such as returns on
pricesorchangesinyield. Thisachievesstationaritybutatthecostoftheseries’memory. Whilestationarityiscrucial
forinference,completelyerasingmemoryisnotidealinsignalprocessing,asmemoryisakeycomponentofamodel’s
predictive power. Stationary models, for instance, depend on some level of memory to assess deviations in the price
processfromlong-termexpectations.Thechallenge,therefore,istodeterminetheminimallevelofdifferentiationrequired
torenderapriceseriesstationarywhileretainingasmuchmemoryaspossible.Ourgoalistoextendtheconceptofreturns
toincludestationaryserieswherememoryisnotentirelydiscarded.
Cointegrationmethodshavebeenvaluedfortheirabilitytomodelserieswithmemory.However,weviewzerodif-
ferentiationasarbitraryas1-stepdifferentiation. Thespectrumbetweenfullydifferentiatedandnon-differentiatedseries
presentsopportunitiesforfractionaldifferentiation,aconceptintegraltoARFIMAmodels,toenhancethepredictability
ofMLmodels.
Supervised learning requires stationary features because it involves mapping an unseen observation to labeled
examplestopredicttheobservation’slabel. Withoutstationarity,thismappingbecomesunreliable. However,achieving
stationarity alone does not ensure predictive accuracy. It is a necessary but not sufficient condition for optimal ML
performance. Thechallengeliesinfindingtherightbalancebetweenachievingstationarityandretainingmemory. Over-
differentiationmayincreasestationaritybutattheexpenseofmemory,whichcanimpairtheforecastingabilityofanML
algorithm. Thischapterexploresamethodologytoaddressthisbalance, drawingontheprinciplesofARFIMAmodels
andtheinsightsofLopezdePrado,tooptimizefeatureengineeringinfinancialtimeseriesanalysis.
3.2 FractionallyDifferentiatedFeatures
DePrado(2015)introducestheconceptapplyingARFIMAassumptionstomachinelearningfeatures-fractionallydiffer-
entiatedfeatures. WeconsiderthebackshiftoperatorBappliedtoatimeseriesofafeature{X}suchthatBkX =X .
t t t−k
It follows that the difference between current and last feature’s value can be expressed as (1−B)X. For example,
t
(1−B)2 =1−2B+B2, where B2X =X so that (1−B)2X =X −2X +X . For any positive integer n, it also
t t−2 t t t−1 t−2
holdsthat:
n (cid:18) n(cid:19) n (cid:18) n(cid:19)
(x+y)n= ∑ xkyn−k= ∑ xn−kyk (1)
k k
k=0 k=0
Ontheotherhandforanyrealnumberd:
∞ (cid:18) d(cid:19)
(1+x)d = ∑ xk (2)
k
k=0
isthebinomialseries. Inamodelwheredisallowedtobearealnumber,thebinomialseriescanbeexpandedinto
aseriesofweightswhichcanbeappliedtofeaturevalues:
(cid:40) (cid:41)
d(d−1) d(d−1)(d−1) k−1d−i
ω = 1,−d, , ,...,(−1)k∏ (3)
2! 3! k!
i=0
The essence of fractional differencing of features is that it allows us to generalize the idea of differentiation to
non-integerorders. Byapplyingthebinomialseriesexpansiontothedifferencingoperator,wecancomputedifferences
of any real order d. This means we are not limited to just taking the first, second, or nth difference, but can compute a
"fractional" difference that may lie somewhere between these whole numbers. This fractional differencing can capture
long-term memory in time series data while ensuring stationarity, which is crucial for many time series analysis and
modelingtechniques. Figure5displaystheweightsassociatedwitheachlagdependingonthevalueond. Byadjusting
thevalueofd,wecanachieveabalancebetweenremovingnoiseandpreservingmeaningfulinformationintheseries.
As we are looking to implement the concept of fractionally differentiated features, a critical decision arises: de-
termining the optimal value of d, the order of fractional differentiation. This value plays a pivotal role in dictating the
balancebetweenretainingmemoryofpastvaluesandensuringstationarityinthetimeseriesdata.Whilememorycaptures
theinherentdependenciesandpatternsovertime,stationarityfacilitatesrobustmodelingandprediction.
3.3 OptimalFractionalDifferentiationOrder
For each feature X using the fixed-width window fractional differentiation (FFD) method allows us to determine the
t
minimumcoefficientd thatmakesthefractionallydifferentiatedseriesX stationary(i.e. passestheAugmentedDickey-
t
8Figure5: ω askincreases. Eachlineisassociatedwithdifferentvalueofd.
k
Source:OwnElaborationbasedon:MarcosLopezdePrado,AdvancesinFinancialMachineLearning,2018
Figure6: ω askincreases. Eachlineisassociatedwithadifferentvalueofd.
k
Source:OwnElaborationbasedon:MarcosLopezdePrado,AdvancesinFinancialMachineLearning,2018
Fullertest). Thiscoefficientd signifiesthememoryextentthatmustbeeliminatedtoattainstationarity. IfX isalready
t
stationary, d = 0. For a unit root, d <1, while for explosive behaviors, d >1. An especially intriguing scenario is
0<d<1,indicatingtheseriesis"slightlynon-stationary". Here,althoughdifferentiationisessential,acompleteinteger
differentiationmightoverlyeliminatememoryandpredictivecapability.
Figure6visualizesaconceptusingtheADFstatisticcomputedonE-miniS&P500futuresprices,rolledforward
anddownsampledtodailyfrequency,spanningbacktothecontract’sbeginning. Thex-axisrepresentsthedvalueassoci-
atedwiththeADFstatisticontherighty-axis. TheoriginalserieshasanADFvalueof−0.3387,whilethereturnsseries
isat−46.9114. TheADFstatisticsurpassesthe95%confidencethresholdof−2.8623aroundd=0.35. Thelefty-axis
indicatesthecorrelationbetweentheoriginalanddifferentiatedseriesforvariousd values. Remarkably,thecorrelation
remainshighat0.995ford=0.35, suggestingsuccessfulstationarityachievementwithoutsignificantmemoryloss. In
contrast,standardintegerdifferentiationresultsinameager0.03correlationwiththeoriginalseries,almostentirelyeras-
ingmemory. Mostfinancestudiesleantowardsintegerdifferentiationd=1,significantlyhigherthan0.35. Thissuggests
a tendency to over-differentiate, removing more memory than required by standard econometric assumptions. Table 3
presents the results of applying fractional differentiation across a range of values, d, from 0.00 to 1.00 on the feature
space used for the model. Two metrics are considered for each asset at every d-value: the ADF p-value, which gauges
thedegreeofstationarity,andthecorrelationmetric,whichquantifieshowcloselythedifferentiatedseriesresemblesthe
original series (thus serving as an indicator of memory retention). The majority of the assets achieve stationarity by a
differentiationvalueofd =0.35. Particularly, assetslikeCLandHHhintatstationarityevenatd =0.10. Conversely,
morestubbornserieslikeBitcoinandSP500onlyvergeonstationarityford>0.30(atα =0.01).
Figure 7 offers a more intuitive visualization of how fractional differentiation progressively transitions the Corn
priceseriesintoaseriesofpricedifferences. Thisfigurehighlightstheneedforequilibriumbetweenmaintainingstation-
arityandpreservingmemorywithintheseries,whichtypicallyoccursintherangebetweend=0andd=1.0.
9Table3: Optimaldifferentiationordersforeachfeatureused.
SPX BTC EURUSD CL HH ZC GC HG ALI
d ADFpcorr ADFpcorr ADFpcorr ADFpcorr ADFpcorr ADFpcorr ADFpcorr ADFpcorr ADFp corr
0.00 0.97 0.97 0.81 0.79 0.39 1.00 0.26 0.97 0.18 0.94 0.50 0.99 0.09 0.99 0.37 0.99 0.08 0.99
0.05 0.83 0.97 0.89 0.80 0.19 1.00 0.06 0.96 0.07 0.93 0.28 0.98 0.08 0.99 0.17 0.99 0.03 1.00
0.10 0.53 0.97 0.77 0.79 0.08 0.99 0.00 0.94 0.01 0.92 0.17 0.98 0.02 0.98 0.01 0.98 0.10 0.99
0.15 0.39 0.97 0.60 0.79 0.01 0.97 0.00 0.91 0.00 0.89 0.03 0.96 0.00 0.96 0.00 0.96 0.06 0.98
0.20 0.10 0.97 0.37 0.78 0.00 0.94 0.00 0.86 0.00 0.84 0.01 0.93 0.00 0.93 0.00 0.93 0.01 0.97
0.25 0.01 0.95 0.13 0.77 0.00 0.90 0.00 0.82 0.00 0.77 0.00 0.89 0.00 0.89 0.00 0.89 0.00 0.95
0.30 0.00 0.92 0.01 0.76 0.00 0.83 0.00 0.77 0.00 0.71 0.00 0.84 0.00 0.84 0.00 0.83 0.00 0.93
0.35 0.00 0.89 0.00 0.74 0.00 0.77 0.00 0.71 0.00 0.64 0.00 0.79 0.00 0.79 0.00 0.77 0.00 0.90
0.40 0.00 0.86 0.00 0.71 0.00 0.70 0.00 0.65 0.00 0.58 0.00 0.74 0.00 0.73 0.00 0.70 0.00 0.87
0.45 0.00 0.82 0.00 0.67 0.00 0.64 0.00 0.58 0.00 0.51 0.00 0.68 0.00 0.66 0.00 0.64 0.00 0.83
0.50 0.00 0.77 0.00 0.61 0.00 0.58 0.00 0.51 0.00 0.44 0.00 0.61 0.00 0.59 0.00 0.57 0.00 0.78
0.55 0.00 0.70 0.00 0.56 0.00 0.51 0.00 0.43 0.00 0.38 0.00 0.54 0.00 0.52 0.00 0.49 0.00 0.73
0.60 0.00 0.62 0.00 0.51 0.00 0.43 0.00 0.36 0.00 0.31 0.00 0.46 0.00 0.44 0.00 0.42 0.00 0.66
0.65 0.00 0.54 0.00 0.45 0.00 0.37 0.00 0.29 0.00 0.26 0.00 0.39 0.00 0.36 0.00 0.35 0.00 0.58
0.70 0.00 0.45 0.00 0.38 0.00 0.30 0.00 0.24 0.00 0.21 0.00 0.32 0.00 0.28 0.00 0.29 0.00 0.49
0.75 0.00 0.37 0.00 0.32 0.00 0.24 0.00 0.19 0.00 0.18 0.00 0.26 0.00 0.23 0.00 0.23 0.00 0.41
0.80 0.00 0.30 0.00 0.25 0.00 0.20 0.00 0.15 0.00 0.14 0.00 0.21 0.00 0.18 0.00 0.18 0.00 0.33
0.85 0.00 0.23 0.00 0.20 0.00 0.15 0.00 0.11 0.00 0.11 0.00 0.16 0.00 0.13 0.00 0.14 0.00 0.25
0.90 0.00 0.17 0.00 0.14 0.00 0.11 0.00 0.08 0.00 0.09 0.00 0.12 0.00 0.10 0.00 0.11 0.00 0.17
0.95 0.00 0.11 0.00 0.09 0.00 0.08 0.00 0.05 0.00 0.06 0.00 0.08 0.00 0.06 0.00 0.08 0.00 0.10
1.00 0.00 0.03 0.00 0.00 0.00 0.03 0.00 0.01 0.00 0.03 0.00 0.03 0.00 0.01 0.00 0.03 0.00 -0.02
Source:OwnElaborationbasedon:MarcosLopezdePrado,AdvancesinFinancialMachineLearning,2018,ADFp-p-valueforAugmentedDickey-
Fullertest. corr-timeseriesautocorrelationcoefficient. Assetsymbols: CL-Oil,HH-NaturalGas,ZC-Corn,GC-Gold,HG-Copper,ALI-
Aluminium.
3.4 Implementation
Fractionaldifferencingemergesasapivotaltechniquethatattemptstobalancethetwinimperativesofachievingstationar-
ityandpreservingmemory. Traditionalintegerdifferencingoftenovercorrects,eliminatingmorememorythannecessary
to meet econometric requirements, thereby diminishing the predictive power of the series. The fractional differencing
method,ontheotherhand,enablesamorenuancedtransformation,allowingtheretentionofcriticalinformationalcom-
ponentswithinaserieswhileensuringitsstatisticalpropriety.
Givenitsadvantages,fractionaldifferencingwillbeappliedtothefeaturesinthispaper. Thenatureofthetrans-
formationbecomesparticularlyusefulgiventheuniquecharacteristicsoffuturedata,wherelongmemorymightcontain
essentialinformationforforecasting.
In terms of practical application, a walk-forward validation methodology will be adopted. This iterative process
involves:
• TrainingSegment: Utilizinganinitialsegmentofthedata,theoptimalfractionaldifferencingparameterd,willbe
determinedtoachievethebalancebetweenmemoryretentionandstationarity.
• TestSegment: Theidentifiedd willthenbeappliedtothesucceedingsegment(orwindow)ofthedata, allowing
formodelevaluation.
Rolling Forward: The window then rolls forward in time, with the process iteratively repeating recalculating,
and testing—ensuring that the model adapts to the evolving characteristics of the series and remains robust to varying
conditions. Throughthisapproach,wenotonlyensurethatourmodelsaregroundedinrigorousstatisticaltechniques,but
alsothattheyaredynamicallyadaptable,reflectingtheevolvingnatureoffinancialmarkets.
Insum,theapplicationoffractionaldifferencing,pairedwiththewalk-forwardvalidationstrategy,presentsarobust
frameworkfortimeseriesforecastinginfuturesmarkets,maximizingbothpredictiveaccuracyandstatisticalvalidity.
10Figure7: Exampleofdifferentdlevelsimpactoncorntimeseries.
Source:OwnElaborationbasedon:MarcosLopezdePrado,AdvancesinFinancialMachineLearning,2018
Algorithm1FractionalFeatureDifferentiationinWalk-ForwardValidation
1: Setarangeofpossiblevaluesford (e.g.,from0to1)
2: SetsignificancelevelforADFtest(e.g.,1%)
3: Initiateadictionaryassociatingeachfeaturewithoptimald.
4: foreachsegmentpair(train,test)do
5: foreachfeaturedo
6: Applyfractionaldifferencingtotrainsegmentofthefeatureatdiscreetintervals
7: CalculateADFteststatisticandp-valueforeachdforafeature
8: Chooselowestd suchthatp-value<significancelevel.
9: Savefeaturenameandassociatedoptimald tothedictionary
10: Applyoptimald differencingtobothtrainandtestsetofthefeature
11: endfor
12: Trainthemodelontrainsegment,evaluateontestset
13: endfor
Source: OwnElaboration
4 Triple Barrier Labelling
4.1 LabellingMethodology
Mostmodernapproachestoalgorithmictradingusingmachinelearningconsistofformulatingthetradingasaclassifica-
tionproblem,wherethepredictedclassdescribesourposition(1-long,-1-short,0-noposition)inthemarketatagiven
11Figure8: Triple-barrier-labellingvisualization.
Source:OwnElaborationbasedon:MarcosLopezdePrado,AdvancesinFinancialMachineLearning,2018
time. In this paper, we are using the triple barrier labeling method. For specified window size λ, and maximum trade
lengthnminutes,triplebarrierlabellingforagiventimet canbeexpressedas:

1, if max(S,...,S )≥S ·(1+λ)
 t t+n t
P t = −1, if min(S t,...,S t+n)≤S t·(1−λ) (4)
0,
otherwise
Figure8representsthethreecasesvisually. Inthefirstcase,theupperbarrierwasexceeded,thereforewewould
havepreferredtobelongattimet. Inthesecondcase,noneofthehorizontalbarrierswasexceeded,sotominimizenoise
inresults,weideallystayoutofthemarketinthiscase. Inthethirdcase,thelowerbarrierwasexceeded,thereforeour
preferredpositionwasshort. Thismethodologyalsoassumesinexecution,eachtradehastake-profitandstop-losssetat
theirrespectiveS ·(1+λ)andS ·(1−λ)levels.
t t
Algorithm2Triple-BarrierLabeling-Simpleimplementation
1: Initializeanemptyserieslabelswiththesameindexasprices
2: foreachindexidxinpricesdo
3: Setentry_pricetothepriceatidx
4: Calculateprofit_targetasentry_price×(1+profit_taking)
5: Calculatestop_loss_targetasentry_price×(1+stop_loss)
6: Settime_barrier_idxtotheminimumofidx+time_barrierandthelastindexofprices
7: foreachpriceifromidxtotime_barrier_idxdo
8: ifprices[i]≥profit_targetthen
9: Setlabels[idx]to1
10: break
11: elseifprices[i]≤stop_loss_targetthen
12: Setlabels[idx]to-1
13: break
14: elseifiisequaltotime_barrier_idxthen
15: Setlabels[idx]to0
16: break
17: endif
18: endfor
19: endfor
20: returnlabels
Source: OwnElaboration
ItfollowsfromEq. (4)thatoncorrect(non-zero)prediction,ourreturnonagiventradewillalwaysbeλ (before
transactionalcosts). Wedefinesuchacaseoftakingthecorrectpositionasa"directlycorrect"prediction. The"directly
incorrect"prediction(Y =−Y ),ontheotherhand,willresultinareturnonthetradeof−λ.On"indirectlyincorrect"
true pred
prediction,forexample,(Y =0,Y =1)thereturncanbeeitherpositiveornegative,dependingonwheretheprice
true pred
isatt+n,however,willalwaysbewithin(−λ,λ). Onpredictingclass0wedonotopenanypositionthereforeourreturn
onthetradewillalwaysbezero. Table2presentsthereturndistributionforgivenpredicted/truelabelcombinations.
Table2. Returnonatradegivenclassificationresult.
12Pred/True 1 0 -1
1 λ (−λ,λ) −λ
0 0 0 0
-1 −λ (−λ,λ) λ
Source: OwnElaboration
4.2 TBL-OptimizedPerformanceMetric
To maximize the trading strategy performance, we must introduce an error preference mechanism. After all, missing a
profitabletrade(type0error)willhavealessereffectonourportfoliothanenteringanincorrecttrade(type1error). To
accountforthat,wecannotusetheaccuracymetricinourmodels. Instead,wehavetocreateanovel,return-maximizing
metric.
Wedefinedirectlycorrectcount asthenumberoftimesthemodelenteredthecorrectpositionwhichresultedin
thereturnofλ. Wecansimilarlydefinedirectlyincorrectcount asthenumberoftimesthemodelenteredanincorrect
position:
DCC=|{(Y ,Y )∈S|Y ̸=0andY =Y }| (5)
pred true pred pred true
DIC=|{(Y ,Y )∈S|Y ̸=0andY ̸=Y }| (6)
pred true pred pred true
Where|S|isthecardinalityofsetS. Itfollowsfromourexecutionassumptionsthatcumulativereturnfromtrades
whereY ∈(−1,1)canbeexpressedas:
true
DCC DIC
Φ= ∏(1+λ)·∏(1−λ)=(1+λ)DCC·(1−λ)DIC (7)
1 1
Theaboveequationlookslikeagoodcontenderforanoptimizationmetric. However,itisimportanttonotethat
theaboveequationdoesnottakeintoaccountthesituationwhereweenterthetradeandthevertical,time-basedbarrier
isreached. Wedefinethenumberofsuchtradesastimedexitcount(TEC).Wehaveshownthatinthesecasesthereturn
on the trade will be within (−λ,λ), however, we cannot assume the average trade return in these situations to be 0.
Wecanthereforeintroduceapreferencemechanismthatdiscouragesenteringsuchtrades,whichalsohasamuchlesser
"discouragementmagnitude"thanfordirectlyincorrecttrades. Wecandothatbyconstructingtheoptimizationmetricas
ifthesetradesonaverageproducealoss,howeversmallitmaybe:
(cid:18) (cid:19)TEC
λ
Φ=(1+λ)DCC·(1−λ)DIC· 1− (8)
δ
where δ >λ. In our study, we set δ arbitrarily to 20, indicating that twenty timed exits are considered equally
undesirableasonedirectincorrectclassification. Notably,selectingaδ valuelowerthanλ tendstofavortradesthathave
historicallyledtotimedexits. Furtherresearchiswarrantedtoexplorethepotentialbenefitsofthisapproachforassets
characterizedbyconsistentlong-termtrends,suchastheS&P500index.
5 Model Training Considerations
5.1 DataAugmentation
Dataaugmentationisatechniquethathasbeenpivotalinaddressingtheissuesofoverfittingandunderrepresentationin
machinelearning. Originally, itsusewasmostprominentincomputervisionproblems, whereitsignificantlyenhanced
the performance of neural networks. Figure 9 presents exemplary data augmentation on images. In these applications,
data augmentation involves making alterations to images in the training dataset to create additional training examples.
Thesealterationscanincludetransformationssuchasrotating,flipping,scaling,oralteringthecolorbalanceofimages.
Theaugmenteddatasetthusgeneratedpresentsawidervarietyofscenariosforthemodeltolearnfrom,whichimproves
itsabilitytogeneralizetonew,unseenimages.
Thesuccessofdataaugmentationincomputervisionsparkedinterestinitspotentialapplicabilitytootherareasof
machinelearning. Innaturallanguageprocessing(NLP),forexample,dataaugmentationmightinvolvetheparaphrasing
of sentences or the use of synonyms to expand the dataset. In audio processing, it could involve varying the pitch or
adding background noise to sound clips. In tabular data, techniques like feature noise injection or synthetic minority
over-samplingareusedtoenrichthedatasets.
Dataaugmentationhasfoundavaluableplaceinthedomainoftimeseriesanalysisaswell,whichisthefoundation
formanyalgorithmictradingstrategies. Timeseriesdatainherentlycarriesthechallengeofbeingsequential,whereeach
pointistemporallyrelatedtoitspredecessorsandsuccessors. Insuchacontext, traditionaldataaugmentationmethods
13Figure9: Dataaugmentationexampleforcomputervisionproblems.
Source:Populartechniquestopreventoverfittinginneuralnetworks,datahacker.rs,AccessedMay2022
usedincomputervisionorNLPcannotbedirectlyappliedduetotheriskofdisruptingthetimesequence,whichiscritical
tothepredictivenatureofthedata.
In algorithmic trading, the time series data typically consists of historical price movements, volumes, and other
financialindicatorsthataretime-dependent. Toaugmentthistypeofdata,theintroductionofnoisetofeaturesbasedona
fractionofhistoricalfeaturevolatilityisaneffectivetechniqueandisthebasisfordataaugmentationinthispaper. This
approachpreservesthetemporalstructureofthedatawhileexpandingthedataset. Byaddingnoisethatisaproportionof
thehistoricalvolatility,oneensuresthattheaugmenteddataremainsrealisticandwithintheboundsofpotentialmarket
scenarios.
The noise added is typically Gaussian or drawn from a similar distribution, scaled according to the historical
volatilityofthefeature. Forexample,ifaparticularstockhasshownvolatilityof2%overacertainperiod,augmenting
thedatabyaddingnoisewithastandarddeviationof0.2%(0.1noiseratio)ofthepricefeaturecreatesnew,plausibleprice
pathsforthemodeltolearnfrom. Thismethodofdataaugmentationhelpsincreatingamorerobustalgorithmictrading
strategy by forcing the model to learn not only from the historical sequence of prices but also from a range of possible
pricemovementsthatcouldoccurinrealmarketconditions.
Thistechniquecanalsobeadaptedtocatertomulti-featuretimeseriesdatawhereeachfeaturemayexhibitdif-
ferentlevelsofvolatility. Byscalingthenoiseforeachfeatureindividuallyaccordingtoitsownhistoricalvolatility,the
augmenteddatarespectstherelativevariabilityofeachmarketindicator.
Theutilityofaddingnoisebasedonhistoricalfeaturevolatilityistwofold. Firstly,ithelpsinpreventingoverfitting
by ensuringthat the modeldoes notlearn to anticipatethe exact historical sequence ofevents but ratherthe underlying
patterns that govern market movements. Secondly, it increases the robustness of the algorithmic trading strategy by
exposing the model to a wider variety of market conditions during the training phase, enhancing its ability to perform
underdifferentmarketscenarios.
Inconclusion,dataaugmentationintimeseriesproblems,particularlyforalgorithmictrading,playsacriticalrole
inmodeltraining. Byjudiciouslyaddingnoisetothefeaturesasafractionoftheirhistoricalvolatility,onecangeneratea
morediverseandcomprehensivesetoftrainingscenarios. Thisapproachleadstotradingalgorithmsthatarelesslikelyto
bethrownoffbytheinherentnoiseandunpredictabilityoffinancialmarketsandarebetteratgeneralizingfrompastdata
tofutureevents.
5.2 SupervisedAutoencoderMLP
Anartificialneuralnetworkisamachinelearningmodelthatisinspiredbythestructureandfunctionofthehumanbrain.
Itiscomposedoflayersofinterconnected"neurons,"whichprocessandtransmitinformation.Eachneuronreceivesinput
fromotherneurons, computesthedotproductofaninputvector, andthensendstheoutputtootherneuronsinthenext
layer,oftenwithapre-definedactivationfunctioninbetween.
Mathematically,aneuralnetworkcanbedefinedasafunctionthatmapsinputstooutputs. Theinputsaretypically
represented by a vector x, and the outputs are represented by a vector, y. Artificial neural networks are capable of
approximatinganycontinuousfunction,hencetheyarewidelyusedinmachinelearningtasks.
Theneuralnetworktypewhichisexaminedindetailinthispaperisanautoencoder,presentedinFigure10.Anau-
toencoderisatypeofartificialneuralnetworkusedtolearnefficientcodingsofunlabeleddata. Theencodingisvalidated
andrefinedbyattemptingtoregeneratetheinputfromtheencoding. Theautoencoderlearnsarepresentation(encoding)
for a set of data, typically for dimensionality reduction, by training the network to ignore insignificant data, leading to
findingthemostefficientwaystocompresspasseddata. Anautoencoderconsistsof3parts: encoder,"code"(alsocalled
14Figure10: Supervisedautoencoderstructure.
Source:EsaúVillatoro-Tello,ShantipriyaParida,SajitKumar,PetrMotlicek,ApplyingAttention-BasedModelsforDetectingCognitiveProcessesand
MentalHealthConditions,2021,CognitiveComputation
Figure 11: Walk-forward validation procedure. The training set, initially expanding, is limited to a 3-period length,
thereforeshiftinginsteadofexpandingsincesplit4.
Source:OwnElaboration.FinalimplementationinPython3.10usingNumPypackage
the bottleneck), and decoder. The encoder compresses the input and produces the code, which is the compressed, de-
noiseddata. Thedecoderthenreconstructstheinputonlyusingthecode. Themetricforautoencoderperformanceisthe
similaritybetweenreconstructeddataandoriginalinput.
Asupervisedautoencoder(SAE)isavariationofanautoencoderthatcanbeusedforregressionandclassification
tasks.InSAE,theencodedvaluesareconcatenatedwiththeoriginalinputandusedtotrainasupervisedpredictionmodel
onprovidedlabels. TheperformancemetricofSAEisacombinationoftheaccuracyofreconstructionofinputdatafrom
code(unsupervisedpart)andtheaccuracyofpredictionsusingconcatenatedoriginaldataandthecode(supervisedpart).
SAE models have shown to have improved generalization performance especially if the data is inherently noisy, which
makesitaperfectcandidateforamodelinalgorithmictradingproblems.
5.3 Walk-forwardValidation
In traditional validation approaches, the dataset is split into a training set and a testing set, where the model is trained
on the training set and then evaluated on the testing set. However, this approach does not accurately reflect real-world
scenarios,wheremodelsneedtobeupdatedandretrainedregularlytoadapttothechangingpatternsinthedata.
Walk-forwardvalidation,presentedinFigure11,isatechniquethatinvolvesdividingthetimeseriesdatasetinto
multiple overlapping windows of a constant or expanding size. In each window, a model is trained on the first part of
the window (train set) and evaluated on the second one (validation set). This process continues until the entire dataset
has been used for training and testing the model. The window size can expand as the test size moves forward, or it
canstopexpandingandstartshiftingtoensurethemodelisfrequentlyupdatedwiththemostrecentdata,enhancingits
adaptabilitytonewpatterns. Thechoiceofexpandingversusconstantsizewindowcomesdowntoourassumptionsover
thecorrelationsinthedata-dowesuspectthatthecorrelationsconvergetothefinal,"population"value,ordoweexpect
them to shift constantly? Constant window size assumes the latter, and good performance of strategies built with this
methodmightindicate,thatthecorrelationschangesteadilyenoughthattheycanbetakenadvantageof.
The walk-forward validation technique has several advantages over traditional validation approaches. Firstly, it
providesamoreaccurateestimateofthemodel’sperformanceinreal-worldscenarios,wheremodelsneedtobeupdated
and retrained regularly. Secondly, it allows for the detection of changes in the data patterns over time, as the model
isevaluatedoneachoverlappingwindow. Thirdly, itensuresthatthemodelisnotoverfittedtoaspecificportionofthe
dataset,asitiscontinuouslyretrainedonthelatestdata.Finally,theconstantsizewindowfostersadaptabilitybyrequiring
themodeltoperformwellacrossvarioussegmentsofdatathatreflectpotentialshiftsintheunderlyingdata-generating
process.
Thewalk-forwardmethodmayalsobeusedtotunehyperparameters. Avalidationperiodfollowsthein-sample
and is before the out-of-sample in this scenario. The walk-forward model training with the hyperparameter adjustment
15procedureisanalogoustotheprocessdescribedabove,withconstantwindowsizeadjustmentstoensurethemodelremains
responsivetothelatestdatatrends.
5.4 Constructionofequityline
InordertoshowhowSAE-MLPsmaybeusedinalgorithmictrading,astraightforwardbuy-selltradingstrategyischosen
basedonwhethertheinstrumentpriceisanticipatedtoriseorfalloverthenexttimeperiod. Forsimplicity, weassume
thattheordersweplacewillnothaveaneffectonthemarketandthattheyareexecutedinstantly,atthelastcloseprice.
AsbothS&P500IndexandBitcoinmarketsareveryliquid,thisassumptionseemsnotfarfromthetruth. Ifourmodel
sendsa“buy”signal, thestrategyclosesoutashortpositionandtakesalongposition. Ifthelongpositionwasalready
taken,itleavesthepositionopen. Ifthemodelsendsa“sell”signalthealgorithmtakesashortposition. Tocalculatethe
cumulativeunrealizedP&Lthefollowingassumptionsareused:
• Theaccountisopenedwith$1.000;
• Positionscanbeopenedinanyamount,theydonothavetobefullunits;
• Transactioncostsarecalculatedforeachopeningandclosingoftheposition,whichmeanschangingpositionfrom
shorttolongwillincurdoublecosts. TransactioncostforS&P500IndexandEUR/USDamountsto0.005%,for
Bitcoinitis0.1%
5.5 PerformanceMetrics
Foreachstrategyandasset,severalindicatorsarecomputedtoevaluateprofitabilityandperformance. Whenevaluating
portfolioperformance,itiscriticaltoconsidernotjustthereturnbutalsotheriskofthestrategy. Inthestudy,weutilize
performancemetricsfromMichan´kówetal. (2022)andRys´andS´lepaczuk(2018).
AnnualizedReturnCompounded
TheAnnualizedReturnCompounded(ARC),istheconstantrateofannualreturnoverthewholeperiodofinvest-
ment,sothat:
V(t )=V(t )·(1+ARC)n (9)
n 0
where:
V(t )-theinitialvalueoftheinvestment
0
V(t )-thevalueoftheinvestmentattheendoftheperiod
n
t −t -numberofyears
n 0
AnnualizedStandardDeviation(ASD)
Volatilityisastatisticalindicatorofthevariationofreturns. Mostofthetime,securityisriskierthemorevolatile
itis. Volatilitymaybeexpressedaseitherthestandarddeviationorvariationbetweenreturnsfromthesamesecuritiesor
marketindex.Volatilitymightbeeasilyswitchedtoannualizedvaluesbymultiplyingthestandarddeviationofthereturns
bythesquarerootofthenumberofobservationsinayear(e.g. 252fordailydataoftheS&P500Indexand365fordaily
dataofBitcoinprices). Inourresearch,weuseAnnualizedStandardDeviation(ASD)asameasureofvolatility:
(cid:115)
1 N √
ASD= ∑(R −Rˆ)2· n (10)
t year
N−1
t=1
where:
Rˆ-theaveragesimplereturn(e.g. dailyfordailydata)ofthegiveninstrument
R -thesimplereturnduringperiodt
t
n -numberofobservationsinayear
year
InformationRatio
The Sharpe ratio, created by Nobel Prize winner William F. Sharpe, aids investors in determining the return on
investmentrelativetoitsrisk. Theratioistheaveragereturnovertherisk-freerateforeachunitofvolatilityoroverall
risk. Becauseweassumeazero-raterisk-freerate,insteadofSharpeRationwewilldefineIR:
ARC
IR= (11)
ASD
16Table4: ComparisonofDifferentApproaches
Approach1 Approach2 Approach3 Approach4
Activation tanh tanh swish swish
Loss mse log-loss log-loss log-loss
Epochs 50 50 50 50
LearningRate 0.01 0.01 0.01 0.01
HiddenLayers 1 1 1 1
GaussianNoiseRate 0.00 0.00 0.05 0.05
ProblemType regression classification classification classification
ModelType BaseModel +Classification +SAE/Denoising +SAE/Denoising
+TBL
Source: OwnElaboration
MaxDrawdown(MDD)
Aportfolio’smaximumdrawdown(MDD)isthelargestlossthatcouldberecordedbetweenaportfolio’speakand
bottom before a new high is reached. Maximum drawdown serves as a gauge for the potential loss over a certain time
frame. Maximumdrawdown(MDD),amajorconcernformostinvestorsisatoolusedtocomparetherelativeriskiness
ofdifferentinvestmentstrategies.
MDD(T)= max(max V −V ) (12)
t τ
t∈[0,T] t∈[0,T]
MaxLossDuration(MLD)
MaximumLossDuration(MLD)istheworst(thegreatest/longest)periodbetweenpeaksthattheinvestmenthas
experienced. Itisexpressedinthenumberofyears:
m −m
j i
MLD=max (13)
S
forwhichVal(m )>Val(m)and j>i.Val(m )andVal(m)arethevaluesofthelocalmaximumsindaysm and
j i j i j
mirespectively. m andmiarethenumbersofdaysindicatinglocalmaximumsoftheequityline. ThescaleparameterS
j
denotesthenumberoftradingsessionsinayear.
InformationRatio**
Kos´c´ et al. (2019) in their study use an additional measure to assess the effectiveness ofthe strategy, which is a
modification of the Information Ratio measure. This measure also takes into account the sign of the portfolio’s rate of
returnandthemaximumdrawdown:
ARC2·sign(ARC)
IR∗∗= (14)
ASD·MDD
6 Results
6.1 ModelDescription
Thedifficultyofoptimizingthemodel’shyperparametersduetoitshighcomputationalcomplexityisoneoftheforemost
challengeswithneuralnetworks. Ourfirstapproachistochooseasetofhyperparametersusingheuristictechniquesand
existingresearch,whichallowsustorefitthemodelmorethanonceandexecutetrainingonarollingwindow. Theexact
valuesofhyperparametersusedarebasedontheresearchofKijewskiandS´lepaczuk(2020)andpresentedinTable4.
Inourstudy,wehaveimplementedfourdifferentapproachestoevaluatetheperformanceofSAE-MLPmodelsin
predictingstockprices. Approach#1usesthewalk-forwardmethodtooptimizethehyperparametersinasimplereturn
estimating model. Given that this is a computationally intensive problem, we have utilized Bayesian Search instead of
GridSearchoneachwindow, performing15trialstoidentifythebestsetofhyperparameters. WehaveemployedMean
Squared Error (MSE) as the criterion metric for selecting the best set of hyperparameters for regression issues. It is
importanttonotethatthisapproachrequiresavalidationperiodtofine-tunethehyperparameters,whichreducesthetotal
out-of-sampleduration.
For Approach #2, we use the same neural network model as in Approach #1, but with a classification problem
wherewepredictthedirectionofthestockpricesinsteadofforecastingreturns. Thisrequiresmodifyingthelossfunction
toasuitablebinaryclassificationfunction,suchasthelog-lossfunction.
17Table 5: Performance metrics: Approach 1 with 5-
minutebarfrequency(top)comparedtobuyandhold
(bottom).
Figure12: CumulativereturnsforApproach1with5-
minutebarfrequencycomparedtobuyandhold.
Approach1-5min SP500 BTCUSD EURUSD Eq.Weighted
CumulativeReturn 0.57% -41.44% -11.08% -17.32%
AnnualReturn 0.23% -19.92% -4.76% -7.59%
AnnualizedStd 4.65% 24.18% 4.56% 6.98%
InformationRatio 0.05 -0.82 -1.04 -1.09
MaxDrawdown 9.51% 54.44% 13.30% 21.72%
MLD 568days 596days 606days 596days
IR** 0.0 -0.3 -0.37 -0.38
BuyAndHold SP500 BTCUSD EURUSD Eq.Weighted
CumulativeReturn 26.83% 452.57% -5.58% 157.94%
AnnualReturn 10.76% 108.57% -2.44% 50.30%
AnnualizedStd 25.58% 69.97% 6.93% 45.38%
InformationRatio 0.42 1.55 -0.35 1.11
Source: Own Elaboration. Out-of-sample performance between MaxDrawdown 38.25% 67.04% 15.78% 49.95%
01.01.2020and30.04.2022,ownbacktestingimplementation. MLD 125days 129days 331days 129days
IR** 0.12 2.51 -0.05 1.12
Source: Own Elaboration. Out-of-sample performance between
01.01.2020and30.04.2022,ownbacktestingimplementation.
ForApproach#3,weareretrainingthemodelusingnoiseaugmentationanddenoisingwiththeSAE-MLPmodel,
butkeepingthesimpledirectionalclassificationlabeling.
ForApproach#4,weuseSAE-MLPnoiseaugmentationanddenoising,butthistimewithaclassificationproblem
whereweusetheaforementionedtriple-barrierlabeling. WealsousetheperformancemetricΨmentionedinthelabeling
sectionofthispaper.
Itisworthmentioningthatwehaveappliedall4approachesforallthreeassets. Moreover,wehavederivedresults
forequally-weightedportfolioforeachapproach. Thus,foreachapproach,wehaveproduced16equitylinesintotal(4
approachesx3assets)+4"portfolio"lines.
6.2 Approach1-RegressionNext-CloseForecasting
InanalyzingtheperformanceofApproach1utilizinga5-minutebarfrequency(Figure13,Table5),theresultsdepicted
mostlynegativeperformanceacrossassets. FortheS&P500,amodestcumulativereturnof0.57%wasachieved,withan
informationratioof0.05, suggestingweakperformanceperunitofrisk. Thiswascontrastedbyasignificantdownturn
inBitcoin,whichexperiencedasubstantialcumulativelossof41.44%,culminatinginaninformationratioof-0.82. The
EUR/USDcurrencypairalsounderperformedwithan11.08%decreaseinvalueandaninformationratioof-1.04.
The IR∗∗, which adjusts for drawdown depth, was zero for the SP500, suggesting a neutral performance after
accountingforthemaximumdrawdownof9.51%. Incontrast, BitcoinandEUR/USD,aswellastheportfolio, showed
negativeIR∗∗sof-0.3,-0.37,and-0.38,respectively,underscoringthecompoundedeffectofbothunderperformanceand
significantdrawdowns,withthemaximumdrawdownsreachingover50%forBitcoin,13.30%forEUR/USD,and21.72%
fortheportfolio.
Approach 1 with a 15-minute bar frequency (Figure 14, Table 6) presented a slightly improved, although still
differentiatedoutcomeacrosstheassetclassesanalyzed.TheSP500yieldedapositivecumulativereturnof11.00%andan
impressiveinformationratioof0.96.ThiswascomplementedbyarobustIR∗∗of0.79afteradjustingfordrawdown,which
wasrelativelyshallowat5.42%.Bitcoin’sperformanceremainedinnegativeterritorywithasignificantcumulativelossof
25.29%,anegativeinformationratioof-0.50,andaIR∗∗of-0.12.TheEUR/USDpairdisplayedapositiveturnaroundwith
acumulativereturnof5.52%andaninformationratioof0.45,withanotablylowmaximumdrawdownof3.74%,resulting
inapositiveIR∗∗ of0.27. Theequally-weightedportfolio’sresultsweremixed,withasmallcumulativelossof-2.92%,
aslightlynegativeinformationratioof-0.17,andaIR∗∗ justintothenegativeat-0.02,suggestinganeutralperformance
when accounting for drawdown severity, which was notably less at 12.72%. The duration of maximum drawdown was
significantlyreducedacrosstheassets,particularlyfortheSP500andEUR/USD,indicatingamoreresilientstrategyover
thisinterval.
Forapproach1,with30-minutebars(Figure15,Table7),SP500deliveredaminimalcumulativereturnof1.14%
withalowinformationratioof0.10. Thestrategy’sresilienceisweakastheIR∗∗ settledat0.0afteraccountingforthe
drawdown. Bitcoin, however, stoodoutwitharemarkablecumulativereturnof98.85%, translatingintoaninformation
ratioof1.41. ThisperformanceisemphasizedbyaIR∗∗of0.74afteraccountingforthemaximumdrawdownof62.65%.
TheEUR/USDpair,contrarily,facedacumulativereturnof-3.52%andanegativeinformationratioof-0.33. TheIR∗∗
of -0.06 indicates a slight underperformance after factoring in the drawdown extent. The equally weighted portfolio
showcased a strong cumulative return of 32.16% and an information ratio of 1.07, suggesting effective diversification
18Table 6: Performance metrics: Approach 1 with 15-
minutebarfrequency(top)comparedtobuyandhold
Figure13:CumulativereturnsforApproach1with15-
(bottom).
minutebarfrequencycomparedtobuyandhold.
Approach1-15min SP500 BTCUSD EURUSD Eq.Weighted
CumulativeReturn 11.00% -25.29% 5.52% -2.92%
AnnualReturn 4.43% -11.40% 2.26% -1.22%
AnnualizedStd 4.61% 22.62% 4.98% 7.40%
InformationRatio 0.96 -0.50 0.45 -0.17
MaxDrawdown 5.42% 47.17% 3.74% 12.72%
MLD 154days 314days 155days 314days
IR** 0.79 -0.12 0.27 -0.02
BuyAndHold SP500 BTCUSD EURUSD Eq.Weighted
CumulativeReturn 26.83% 452.57% -5.58% 157.94%
AnnualReturn 10.76% 108.57% -2.44% 50.30%
AnnualizedStd 25.58% 69.97% 6.93% 45.38%
InformationRatio 0.42 1.55 -0.35 1.11
MaxDrawdown 38.25% 67.04% 15.78% 49.95%
MLD 125days 129days 331days 129days
Source: Own Elaboration. Out-of-sample performance between
IR** 0.12 2.51 -0.05 1.12
01.01.2020and30.04.2022,ownbacktestingimplementation.
Source: Own Elaboration. Out-of-sample performance between
01.01.2020and30.04.2022,ownbacktestingimplementation.
Table 7: Performance metrics: Approach 1 with 30-
minutebarfrequency(top)comparedtobuyandhold
Figure14:CumulativereturnsforApproach1with30-
(bottom).
minutebarfrequencycomparedtobuyandhold.
Approach1-30min SP500 BTCUSD EURUSD Eq.Weighted
CumulativeReturn 1.14% 98.85% -3.52% 32.16%
AnnualReturn 0.47% 33.02% -1.48% 12.27%
AnnualizedStd 4.69% 23.47% 4.53% 11.43%
InformationRatio 0.10 1.41 -0.33 1.07
MaxDrawdown 9.67% 62.65% 8.41% 22.78%
MLD 265days 180days 583days 144days
IR** 0.0 0.74 -0.06 0.58
BuyAndHold SP500 BTCUSD EURUSD Eq.Weighted
CumulativeReturn 26.83% 452.57% -5.58% 157.94%
AnnualReturn 10.76% 108.57% -2.44% 50.30%
AnnualizedStd 25.58% 69.97% 6.93% 45.38%
InformationRatio 0.42 1.55 -0.35 1.11
MaxDrawdown 38.25% 67.04% 15.78% 49.95%
MLD 125days 129days 331days 129days
Source: Own Elaboration. Out-of-sample performance between
IR** 0.12 2.51 -0.05 1.12
01.01.2020and30.04.2022,ownbacktestingimplementation.
Source: Own Elaboration. Out-of-sample performance between
01.01.2020and30.04.2022,ownbacktestingimplementation.
benefits. The portfolio’s IR∗∗ of 0.58 highlights its resilience, even in light of a 22.78% maximum drawdown. The
durationofthemaximumdrawdownshowedimprovementforBitcoinatonly180days,whiletheportfolio’sdrawdown
periodwasnotablyshortat144days,signifyingaquickerrecoveryfromlosses.
6.3 Approach2-Directionalclassifier
Forapproach2,5-minutebars(Figure16,Table8),SP500yieldedacumulativereturnof5.41%onthetestset,reflecting
an information ratio of 0.46. However, the IR∗∗ falls to 0.1 when accounting for a maximum drawdown of 10.31%.
Bitcoin faced a notable downturn with a cumulative loss of 21.72% and an information ratio of -0.42, though the IR∗∗
at -0.07 implies a slightly less negative outlook when considering the drawdown. The EUR/USD pair exhibited strong
performancewithacumulativereturnof9.84%andaninformationratioof0.82,indicatingasolidperformanceperunitof
risk. ThisisreinforcedbyahighIR∗∗of0.58,despiteamaximumdrawdownof5.64%,pointingtoefficientrisk-adjusted
returns. Theequally-weightedportfolio,however,resultedinamarginalcumulativelossof-2.16%,aninformationratio
of-0.11,andanearlyneutralIR∗∗of-0.01,reflectinganoverallbalancedbutslightlynegativeperformanceafterfactoring
inthemaximumdrawdownof14.06%.
Forapproach2with15-minbars(Figure17,Table9),Bitcoin(BTCUSD)achievedthehighestcumulativereturn
at 19.92%, while the S&P 500 (SP500) experienced a negative cumulative return of -3.08%. In terms of annual return,
Bitcoinagainoutperformedwith7.83%,andtheSP500remainednegativeat-1.29%. Theannualizedstandarddeviation
19Table 8: Performance metrics: Approach 2 with 5-
minutebarfrequency(top)comparedtobuyandhold
Figure15: CumulativereturnsforApproach2with5-
(bottom).
minutebarfrequencycomparedtobuyandhold.
Approach2-5min SP500 BTCUSD EURUSD Eq.Weighted
CumulativeReturn 5.41% -21.72% 9.84% -2.16%
AnnualReturn 2.21% -9.67% 3.97% -0.90%
AnnualizedStd 4.77% 23.22% 4.82% 8.29%
InformationRatio 0.46 -0.42 0.82 -0.11
MaxDrawdown 10.31% 56.07% 5.64% 14.06%
MLD 532days 422days 215days 422days
IR** 0.1 -0.07 0.58 -0.01
BuyAndHold SP500 BTCUSD EURUSD Eq.Weighted
CumulativeReturn 26.83% 452.57% -5.58% 157.94%
AnnualReturn 10.76% 108.57% -2.44% 50.30%
AnnualizedStd 25.58% 69.97% 6.93% 45.38%
InformationRatio 0.42 1.55 -0.35 1.11
MaxDrawdown 38.25% 67.04% 15.78% 49.95%
MLD 125days 129days 331days 129days
Source: Own Elaboration. Out-of-sample performance between
IR** 0.12 2.51 -0.05 1.12
01.01.2020and30.04.2022,ownbacktestingimplementation.
Source: Own Elaboration. Out-of-sample performance between
01.01.2020and30.04.2022,ownbacktestingimplementation.
Table 9: Performance metrics: Approach 2 with 15-
minutebarfrequency(top)comparedtobuyandhold
Figure16:CumulativereturnsforApproach2with15-
(bottom).
minutebarfrequencycomparedtobuyandhold.
Approach2-15min SP500 BTCUSD EURUSD Eq.Weighted
CumulativeReturn -3.08% 19.92% 11.73% 9.52%
AnnualReturn -1.29% 7.83% 4.71% 3.85%
AnnualizedStd 4.73% 22.99% 4.79% 7.32%
InformationRatio -0.27 0.34 0.98 0.53
MaxDrawdown 10.72% 41.52% 8.38% 12.60%
MLD 479days 505days 382days 500days
IR** -0.03 0.06 0.55 0.16
BuyAndHold SP500 BTCUSD EURUSD Eq.Weighted
CumulativeReturn 26.83% 452.57% -5.58% 157.94%
AnnualReturn 10.76% 108.57% -2.44% 50.30%
AnnualizedStd 25.58% 69.97% 6.93% 45.38%
InformationRatio 0.42 1.55 -0.35 1.11
MaxDrawdown 38.25% 67.04% 15.78% 49.95%
MLD 125days 129days 331days 129days
Source: Own Elaboration. Out-of-sample performance between
IR** 0.12 2.51 -0.05 1.12
01.01.2020and30.04.2022,ownbacktestingimplementation.
Source: Own Elaboration. Out-of-sample performance between
01.01.2020and30.04.2022,ownbacktestingimplementation.
was the highest for Bitcoin at 22.99%, suggesting higher volatility, while EUR/USD exhibited the lowest volatility at
4.79%.
Most crucially, when considering the IR∗∗ — which accounts for drawdown depth — the EUR/USD pair stands
outwitharobustscoreof0.55,signifyingafavorablerisk-adjustedreturnafteraccountingfordrawdowns. Theequally-
weightedportfoliohadanInformationRatio**of0.16, which, whilelowerthantheindividualEUR/USDstrategy, still
indicates a positive risk-adjusted performance. The negative Information Ratio** for the SP500 at -0.03 suggests an
unfavorablereturnwhenadjustingfordrawdowndepth,highlightingtheimportanceofthismetricinevaluatingstrategy
performance.
For Approach 2 with 30-minute bars (Figure 18, Table 10), Bitcoin leads the cumulative return at an impressive
32.51%, outshining the SP500 which displayed a negative cumulative return of -3.51%. The annual return follows a
similarpattern,withBitcoinachievingasubstantial12.40%comparedtotheSP500’s-1.47%,alongsideEURUSDannual
returnof2.91%.
Mostimportantly,whenfactoringinthedrawdowndepthwiththeIR∗∗,Bitcoinandtheequally-weightedportfolio
exhibitpositivefiguresof0.21and0.24,indicatingabetterrisk-adjustedreturnprofile. TheEUR/USDalsomaintainsa
strongIR∗∗at0.34. However,theSP500continuestounderperformonarisk-adjustedbasis,reflectedbyitsnegativeIR∗∗
of-0.05,furtheremphasizingtheasset’schallengeswithinthisparticularapproachandfrequencysetting.
20Table 10: Performance metrics: Approach 2 with 30-
minutebarfrequency(top)comparedtobuyandhold
Figure17:CumulativereturnsforApproach2with30-
(bottom).
minutebarfrequencycomparedtobuyandhold.
Approach2-30min SP500 BTCUSD EURUSD Eq.Weighted
CumulativeReturn -3.51% 32.51% 7.15% 12.05%
AnnualReturn -1.47% 12.40% 2.91% 4.84%
AnnualizedStd 4.89% 24.53% 4.85% 8.72%
InformationRatio -0.30 0.51 0.60 0.55
MaxDrawdown 9.22% 30.44% 5.09% 11.04%
MLD 455days 207days 251days 206days
IR** -0.05 0.21 0.34 0.24
BuyAndHold SP500 BTCUSD EURUSD Eq.Weighted
CumulativeReturn 26.83% 452.57% -5.58% 157.94%
AnnualReturn 10.76% 108.57% -2.44% 50.30%
AnnualizedStd 25.58% 69.97% 6.93% 45.38%
InformationRatio 0.42 1.55 -0.35 1.11
MaxDrawdown 38.25% 67.04% 15.78% 49.95%
MLD 125days 129days 331days 129days
Source: Own Elaboration. Out-of-sample performance between
IR** 0.12 2.51 -0.05 1.12
01.01.2020and30.04.2022,ownbacktestingimplementation.
Source: Own Elaboration. Out-of-sample performance between
01.01.2020and30.04.2022,ownbacktestingimplementation.
Table 11: Performance metrics: Approach 3 with 5-
minutebarfrequency(top)comparedtobuyandhold
Figure18: CumulativereturnsforApproach3with5-
(bottom).
minutebarfrequencycomparedtobuyandhold.
Approach3-5min SP500 BTCUSD EURUSD Eq.Weighted
CumulativeReturn 0.29% 41.29% -3.18% 12.80%
AnnualReturn 0.12% 15.43% -1.33% 5.13%
AnnualizedStd 4.68% 23.35% 4.66% 9.44%
InformationRatio 0.03 0.66 -0.29 0.54
MaxDrawdown 5.21% 45.75% 9.94% 15.74%
MLD 350days 269days 520days 290days
IR** 0.0 0.22 -0.04 0.18
BuyAndHold SP500 BTCUSD EURUSD Eq.Weighted
CumulativeReturn 26.83% 452.57% -5.58% 157.94%
AnnualReturn 10.76% 108.57% -2.44% 50.30%
AnnualizedStd 25.58% 69.97% 6.93% 45.38%
InformationRatio 0.42 1.55 -0.35 1.11
MaxDrawdown 38.25% 67.04% 15.78% 49.95%
MLD 125days 129days 331days 129days
Source: Own Elaboration. Out-of-sample performance between
IR** 0.12 2.51 -0.05 1.12
01.01.2020and30.04.2022,ownbacktestingimplementation.
Source: Own Elaboration. Out-of-sample performance between
01.01.2020and30.04.2022,ownbacktestingimplementation.
6.4 Approach3-SAE-MLPClassifier
Approach3,employinga5-minutebarfrequency(Figure19,Table11),presentsavariedperformancelandscapeacross
differentassetsandtheequally-weightedportfolio. ThecumulativereturnforBitcoinisnotablyhighat41.29%,signif-
icantlyoutperformingtheS&P500indexwhichshowsamarginalgainof0.29%, andtheEUR/USDcurrencypairthat
experiencedadeclineof-3.18%. Bitcoin’sannualreturnstandsatacompelling15.43%,whiletheSP500andEUR/USD
demonstrateastarkcontrastwith0.12%and-1.33%respectively.
When considering the IR∗∗, Bitcoin maintains a positive score of 0.22, and the equally weighted portfolio also
demonstratesresiliencewithascoreof0.18. TheIR∗∗ fortheSP500breaksevenat0.0. TheEUR/USD,however,hasa
slightlynegativeIR∗∗ of-0.04,reflectingamodestlyunfavorablerisk-adjustedreturnwhentakingdrawdowndepthinto
account.
Approach 3 with a 15-minute bar frequency (Figure 20, Table 12) reveals significant improvements in perfor-
mancemetricsacrosstheS&P500(SP500),Bitcoin(BTCUSD),andtheEUR/USDcurrencypair,aswellastheequally-
weightedportfoliooftheseassets. Bitcoinstandsoutwithanexceptionalcumulativereturnof115.28%,whiletheSP500
also reports a robust 15.36% and the EUR/USD shows a moderate gain of 8.21%. When annualized, Bitcoin’s return
remainsimpressiveat37.48%,withtheSP500andEUR/USDyielding6.11%and3.33%respectively.
Bitcoin’s IR∗∗ at 2.01 and the equally-weighted portfolio’s at 3.22 are high, suggesting an excellent return even
whenaccountingfordrawdownseverity. TheSP500alsomaintainsastrongIR∗∗at1.11. TheEUR/USDexhibitsalower
21Table 12: Performance metrics: Approach 3 with 15-
minutebarfrequency(top)comparedtobuyandhold
Figure19:CumulativereturnsforApproach3with15-
(bottom).
minutebarfrequencycomparedtobuyandhold.
Approach3-15min SP500 BTCUSD EURUSD Eq.Weighted
CumulativeReturn 15.36% 115.28% 8.21% 46.28%
AnnualReturn 6.11% 37.48% 3.33% 17.11%
AnnualizedStd 5.09% 24.45% 4.81% 10.03%
InformationRatio 1.20 1.53 0.69 1.71
MaxDrawdown 6.59% 28.65% 5.71% 9.07%
MLD 199days 151days 150days 151days
IR** 1.11 2.01 0.4 3.22
BuyAndHold SP500 BTCUSD EURUSD Eq.Weighted
CumulativeReturn 26.83% 452.57% -5.58% 157.94%
AnnualReturn 10.76% 108.57% -2.44% 50.30%
AnnualizedStd 25.58% 69.97% 6.93% 45.38%
InformationRatio 0.42 1.55 -0.35 1.11
MaxDrawdown 38.25% 67.04% 15.78% 49.95%
MLD 125days 129days 331days 129days
Source: Own Elaboration. Out-of-sample performance between
IR** 0.12 2.51 -0.05 1.12
01.01.2020and30.04.2022,ownbacktestingimplementation.
Source: Own Elaboration. Out-of-sample performance between
01.01.2020and30.04.2022,ownbacktestingimplementation.
Table 13: Performance metrics: Approach 3 with 30-
minutebarfrequency(top)comparedtobuyandhold
Figure20:CumulativereturnsforApproach3with30-
(bottom).
minutebarfrequencycomparedtobuyandhold.
Approach3-30min SP500 BTCUSD EURUSD Eq.Weighted
CumulativeReturn 12.37% 39.88% 21.78% 24.68%
AnnualReturn 4.96% 14.95% 8.53% 9.59%
AnnualizedStd 4.78% 22.11% 4.91% 7.76%
InformationRatio 1.04 0.68 1.74 1.24
MaxDrawdown 4.18% 29.18% 5.69% 8.48%
MLD 240days 157days 91days 136days
IR** 1.23 0.35 2.6 1.4
BuyAndHold SP500 BTCUSD EURUSD Eq.Weighted
CumulativeReturn 26.83% 452.57% -5.58% 157.94%
AnnualReturn 10.76% 108.57% -2.44% 50.30%
AnnualizedStd 25.58% 69.97% 6.93% 45.38%
InformationRatio 0.42 1.55 -0.35 1.11
MaxDrawdown 38.25% 67.04% 15.78% 49.95%
MLD 125days 129days 331days 129days
Source: Own Elaboration. Out-of-sample performance between
IR** 0.12 2.51 -0.05 1.12
01.01.2020and30.04.2022,ownbacktestingimplementation.
Source: Own Elaboration. Out-of-sample performance between
01.01.2020and30.04.2022,ownbacktestingimplementation.
ratioof0.4,indicatingalessfavorablereturnonriskwhendrawdownsareconsidered.
Approach3witha30-minutebarfrequency(Figure21, Table13)showcasesabalancedperformanceacrossthe
assets.ThecumulativereturnforBitcoinisnotableat39.88%,withtheSP500andEUR/USDalsopostingpositivereturns
of12.37%and21.78%,respectively. Theequallyweightedportfoliobenefitsfromthecombinedperformance,yieldinga
cumulativereturnof24.68%.
Most importantly, when considering the IR∗∗, the EUR/USD achieves an exceptional score of 2.6, reflecting an
outstandingrisk-adjustedreturnconsideringdrawdowndepth. Theequallyweightedportfolioalsoperformsimpressively
with an IR∗∗ of 1.4, further emphasizing the benefits of diversification. The SP500’s IR∗∗ stands at a solid 1.23, while
Bitcoinlagswithascoreof0.35, indicatingthatitshigherreturnsareaccompaniedbyproportionatelyhigherrisksand
drawdowns. ThisdatahighlightsthestrengthoftheEUR/USDinthisparticularstrategyandtimeframe, outperforming
eventherobustreturnsofanequallyweightedportfolio.
6.5 Approach4-SAE-MLP+TBLClassificationForecasting
Approach 4 using a 5-minute bar frequency (Figure 22, Table 14) depicts a contrasting performance profile across the
assets. TheSP500showsacumulativereturnof-5.64%,indicatingadecline,whereasBitcoinandEUR/USDbothreport
positive cumulative returns of 11.78% and 10.12%, respectively. The equally weighted portfolio’s cumulative return
standsat5.42%,reflectingthemixedresultsoftheunderlyingassets.
22Table 14: Performance metrics: Approach 4 with 5-
minutebarfrequency(top)comparedtobuyandhold
Figure21: CumulativereturnsforApproach4with5-
(bottom).
minutebarfrequencycomparedtobuyandhold.
Approach4-5min SP500 BTCUSD EURUSD Eq.Weighted
CumulativeReturn -5.64% 11.78% 10.12% 5.42%
AnnualReturn -2.38% 4.73% 4.08% 2.22%
AnnualizedStd 4.59% 22.72% 4.84% 8.47%
InformationRatio -0.52 0.21 0.84 0.26
MaxDrawdown 8.13% 39.53% 5.99% 14.37%
MLD 462days 149days 248days 182days
IR** -0.15 0.02 0.57 0.04
BuyAndHold SP500 BTCUSD EURUSD Eq.Weighted
CumulativeReturn 26.83% 452.57% -5.58% 157.94%
AnnualReturn 10.76% 108.57% -2.44% 50.30%
AnnualizedStd 25.58% 69.97% 6.93% 45.38%
InformationRatio 0.42 1.55 -0.35 1.11
MaxDrawdown 38.25% 67.04% 15.78% 49.95%
MLD 125days 129days 331days 129days
Source: Own Elaboration. Out-of-sample performance between
IR** 0.12 2.51 -0.05 1.12
01.01.2020and30.04.2022,ownbacktestingimplementation.
Source: Own Elaboration. Out-of-sample performance between
01.01.2020and30.04.2022,ownbacktestingimplementation.
Table 15: Performance metrics: Approach 4 with 15-
minutebarfrequency(top)comparedtobuyandhold
Figure22:CumulativereturnsforApproach4with15-
(bottom).
minutebarfrequencycomparedtobuyandhold.
Approach4-15min SP500 BTCUSD EURUSD Eq.Weighted
CumulativeReturn -0.90% 180.77% 13.80% 64.55%
AnnualReturn -0.38% 53.51% 5.51% 22.97%
AnnualizedStd 4.60% 23.56% 4.70% 11.13%
InformationRatio -0.08 2.27 1.17 2.06
MaxDrawdown 10.17% 30.09% 4.01% 10.79%
MLD 222days 58days 220days 103days
IR** -0.0 4.04 1.61 4.39
BuyAndHold SP500 BTCUSD EURUSD Eq.Weighted
CumulativeReturn 26.83% 452.57% -5.58% 157.94%
AnnualReturn 10.76% 108.57% -2.44% 50.30%
AnnualizedStd 25.58% 69.97% 6.93% 45.38%
InformationRatio 0.42 1.55 -0.35 1.11
MaxDrawdown 38.25% 67.04% 15.78% 49.95%
MLD 125days 129days 331days 129days
Source: Own Elaboration. Out-of-sample performance between
IR** 0.12 2.51 -0.05 1.12
01.01.2020and30.04.2022,ownbacktestingimplementation.
Source: Own Elaboration. Out-of-sample performance between
01.01.2020and30.04.2022,ownbacktestingimplementation.
WhenevaluatingtheIR∗∗,theEUR/USDexcelswitharobustscoreof0.57. Theequallyweightedportfolioand
BitcoinpresentmarginalIR∗∗scoresof0.04and0.02,respectively,reflectinglimitedrisk-adjustedreturnswhenaccount-
ingfordrawdowns. TheSP500’snegativeIR∗∗of-0.15furtheraccentuatesitsunderperformanceinthisapproach. These
resultshighlighttheoutperformanceoftheEUR/USDcurrencypairwithinApproach4,especiallywhenconsideringthe
riskassociatedwithdrawdowns.
Approach 4 with a 15-minute bar frequency (Figure 23, Table 15) presents a remarkable divergence in the per-
formanceoftheSP500,Bitcoin(BTCUSD),EUR/USD,andanequally-weightedportfolio. Bitcoincommandsthestage
with an extraordinary cumulative return of 180.77%, dwarfing the SP500’s slight decline of -0.90% and surpassing the
solidperformanceofEUR/USDat13.80%. TheequallyweightedportfoliobenefitsfromBitcoin’sstellarperformance,
achievingacumulativereturnof64.55%.
WhenconsideringtheInformationRatiowithtwoasterisks, whichadjustsfordrawdowndepth, Bitcoinexhibits
ascoreof4.04,andtheequally-weightedportfoliosurpassesthiswitharatioof4.39,bothindicatinghighrisk-adjusted
returns.TheEUR/USDalsoshowsastrongIR∗∗of1.61.Incontrast,theSP500breaksevenwitharatioof-0.0,suggesting
no excess return after adjusting for drawdowns. These results highlight the potential benefits of combining high-return
assetswithdiversificationstrategies.
Approach4witha30-minutebarfrequency(Figure24,Table16)demonstratesavariedperformanceamongthe
SP500,Bitcoin(BTCUSD),EUR/USD,andanequallyweightedportfolio.Bitcoindeliversastrikingcumulativereturnof
116.30%,significantlyoutshiningtheSP500’sreturnof8.49%andEUR/USD’sreturnof10.82%. Theequallyweighted
23Table 16: Performance metrics: Approach 4 with 30-
minutebarfrequency(top)comparedtobuyandhold
Figure23:CumulativereturnsforApproach4with30-
(bottom).
minutebarfrequencycomparedtobuyandhold.
Approach4-30min SP500 BTCUSD EURUSD Eq.Weighted
CumulativeReturn 8.49% 116.30% 10.82% 45.20%
AnnualReturn 3.44% 37.75% 4.36% 16.75%
AnnualizedStd 4.84% 24.42% 4.92% 10.44%
InformationRatio 0.71 1.55 0.89 1.60
MaxDrawdown 6.41% 39.74% 7.90% 12.54%
MLD 383days 140days 255days 130days
IR** 0.38 1.47 0.49 2.14
BuyAndHold SP500 BTCUSD EURUSD Eq.Weighted
CumulativeReturn 26.83% 452.57% -5.58% 157.94%
AnnualReturn 10.76% 108.57% -2.44% 50.30%
AnnualizedStd 25.58% 69.97% 6.93% 45.38%
InformationRatio 0.42 1.55 -0.35 1.11
MaxDrawdown 38.25% 67.04% 15.78% 49.95%
MLD 125days 129days 331days 129days
Source: Own Elaboration. Out-of-sample performance between
IR** 0.12 2.51 -0.05 1.12
01.01.2020and30.04.2022,ownbacktestingimplementation.
Source: Own Elaboration. Out-of-sample performance between
01.01.2020and30.04.2022,ownbacktestingimplementation.
Figure24: Comparisonofinformationratiosacrossapproachesandbarlengths
Source:OwnElaboration,tableproducedinMicrosoftExcel.
portfoliopresentsanimpressivecumulativereturnof45.20%,reflectingthestrongperformanceofBitcoin.
WhenadjustedfordrawdowndepthwiththeIR∗∗, Bitcoin’srisk-adjustedperformanceisstillstrongat1.47, but
it is the equally-weighted portfolio that stands out with a ratio of 2.14, showcasing excellent risk-adjusted returns. The
SP500andEUR/USDhaveIR∗∗ of0.38and0.49, respectively, whicharepositivebutlessremarkablecomparedtothe
portfolio’s.
6.6 Summary
Our research has demonstrated that the application of Supervised Autoencoder de-noising in combination with Triple
Barrier labeling significantly improves machine learning performance in the context of financial time series analysis.
Figure25demonstratesthatSupervisedAutoencoderallowsforeffectivede-noisingofthedata,essentiallyenhancingthe
signal-to-noiseratio,andthusleadingtobettermodelperformance.Table17presentsp-valuesfortwostatisticalteststhat
evaluatewhetherthestrategyproducedstatisticallybetterperformancethanthebuy-and-holdstrategies.
TheDiebold-Marianotest(Diebold,Mariano,2002),isspecificallydesignedtoevaluateandcomparetherelative
forecastingaccuracyoftwocompetingpredictivemodels. Thistestcalculatesthedifferencesinthepredictiveerrorsof
thetwomodelsandassesseswhetherthesedifferencesarestatisticallysignificant. Thetestassumesthatthesedifferences
arenormallydistributed,especiallyunderlargesamplesizes,inaccordancewiththecentrallimittheorem.
Ontheotherhand,wealsoemployedaprobabilistict-testtocomparetheInformationratiosofthetwoinvestment
√
1/n
strategies.ThistestutilizesasimplifiedformulaforthestandarderroroftheSharperatio,expressedasSE= ,where
σ
nisthesamplesizeofthereturns,andσ isthestandarddeviationofthedifferencesinreturnsbetweenthetwoinvestment
strategies. LiketheDiebold-Marianotest,theprobabilistict-testassumesthatthedifferencesinreturnsfollowanormal
distribution. Bothtests,theDMtest,andtheprobabilistict-test,areessentialtoassesstheeffectivenessofourproposed
approach. Wesetacriticalvalueα =0.01forthesetests,indicatingastrictcriterionforstatisticalsignificance.
The table indicates that the most tests where the strategy significantly outperformed buy and hold were trading
EUR/USD and SP500, whereas it was particularly difficult to achieve similar results for BTC/USD, as only one test
(Approach4,15min)significantlyoutperformedsaidcryptocurrency. Intermsofthesestatisticaltests,thisapproachwas
alsothemostsuccessfulone,rejectingthenullhypothesesin5outof8tests.
24Table17: P-valuesforstatisticaltestsforcomparingtheperformanceofstrategiesoverbuy&hold.
Source: OwnElaboration,testsconductedwithstattestspackage. DMH 0: Classifieraccuracyisnotgreaterthan"always-long"accuracy. T-testH 0:
TheinformationRatioofthestrategyisnotgreaterthanthebuy-and-holdinformationratio. Theboldvaluesindicateapproachesandassetswherea
givenp-valueexceededthecriticalvalue,rejectingthenullhypothesis.
Figure25: Sensitivityanalysisoftriple-barrierlabelingparametersinApproach4,15minbars.
Source:OwnElaboration.X-Axis:windowlengthinminutes.Y-Axis:windowheight.
What is also important to note, is that for equally weighted portfolio strategies, all approaches that succeeded
inrejectingthenullhypothesesinvolvedtheuseofSAEortriplebarrierlabeling. Basedontheseresults, weviewthat
triplebarrierlabelingprovidesarobustmechanismtolabeldatabasedonpredeterminedprofit-takingandstop-losslevels,
capturingmorerealisticandcomplexmarketdynamicscomparedtotraditionalmethods.Thisamalgamationoftechniques
improvesmodelaccuracyandpredictivepower,aswellashandlesfinancialmarketvolatilityandnoisebetter.
7 Sensitivity Analysis
Thesensitivityanalysispresentedhereconcernstheapproach4,15-minutebars. Weviewthatthesensitivityanalysisof
thisapproachdemonstratesparticularlywellthebenefitsandchallengesoftheSAE-MLP+TBLmethod.
For this approach, the information ratio presented in Figure 26 increased as the stop-loss/take-profit levels were
expanded up to around 0.18-0.21%, beyond which we note a decline to 1.3-1.8 levels. This diminishing return could
beattributedtooverexposuretomarketvolatilityathigherstop-loss/take-profitlevels,thusnegativelyaffectingtherisk-
adjustedreturn. Furthermore,itisalsoevidentthataugmentingthetradedurationuptoanoptimalpointofapproximately
15-20minutesenhancesthestrategyperformance. However,beyondthispoint,afurtherincreaseintradedurationdoes
not uniformly enhance the performance, signifying increased uncertainty or noise over extended trading horizons. The
observedvariationintheinformationratiounderlinesthestrategy’ssensitivitytotheseparameters,emphasizingthene-
cessityfortheircarefulcalibration.
From Figure 27, it can be observed that the Information Ratio appears to be stable around the point where 5%
Gaussiannoiseisadded,whereasthesizeoftheautoencoder’sbottleneckhasmuchlessimpactontheoverallinformation
ratio. Thissuggeststhatamoderateamountofdataaugmentation,combinedwithaconsiderablereductionoffeaturesize
throughtheautoencoder,optimallyimprovesthestrategy’srisk-adjustedreturn.
As the percentage of Gaussian noise added to features increases beyond 5%, the Information Ratio generally
decreases,indicatingapotentialoverfittingproblem. Toomuchnoisemaybecausingthemodeltolearnfromthis’noise’,
whichdoesn’tnecessarilyrepresentanytrueunderlyingpatterninthemarketdata,leadingtodegradationofout-of-sample
performance.
25Figure26: SensitivityanalysisofSAEparameters.
Source:OwnElaboration,Y-axis:Noiserateasafractionofannualizedvolatility.X-axis:bottlenecksizeasapercentageoforiginalfeaturescount.
Figure27: SensitivityanalysisofSAEhiddenlayercount.
Source:OwnElaboration.YAxis-encoderhiddenlayercount.XAxis-decoderhiddenlayercount.
Similarly,ifthesizeoftheautoencoder’sbottleneckisexpandedbeyond40%oftheoriginalnumberoffeatures,
theInformationRatioalsoshowsadownwardtrend,albeitmuchlesssteepthaninthecaseofthenoiseparameter. This
couldbeduetothefactthattoomanyfeaturesmayretainmorenoisethansignal,resultinginalessrobustmodel.
When it comes to the count of hidden layers in the autoencoder, figure 28 shows the optimal configuration is
not uniformly increasing with the number of layers. The performance does not consistently improve with additional
layers, indicating that an increase in model complexity beyond a certain point does not necessarily translate to better
performanceandmayleadtooverfittingorotherinefficiencies. Thisobservationalignswiththeprincipleofparsimony
inmodelselection,wherethesimplestmodelthatadequatelyexplainsthedataispreferred.
Figure29presentsthesensitivityanalysisofbatchsizesandlearningrates,Anotablepatternisthatlargerbatch
sizestendtoachievehigherinformationratiosatlowerlearningrates,withthebatchsizeof256atalearningrateof1e-3
standingoutasparticularlyeffective. Likewise,thehighestlearningratesseemtoproduceonaverageworseresults. This
could suggest that smaller learning rates may help in avoiding oscillations around the global minimum, a phenomenon
thatcanoccurathigherlearningrates,leadingtoapotentialdecreaseintheinformationratio.
Inconclusion, theresultsimplythatthereisanoptimallevelofcomplexityfortheautoencoderarchitecturethat
maximizestheSharperatio. Consequently,carefulconsiderationmustbegiventotheselectionofthenumberofhidden
Figure28: Sensitivityanalysisofbatchsizeandlearningrate.
Source:OwnElaboration.Y-Axis-batchsize.X-Axis-learningrate.
26layerswhendesigningsuchastrategytoachieveabalancebetweenmodelexpressivenessandperformance.
Conclusions and Further Research
Thisresearchsetouttoexplorethepotentialimprovementsinstrategyperformanceyieldedbytheapplicationofsuper-
visedautoencodersinthecontextoffinancialtimeseries. Wefurtherincorporatednoiseaugmentationandtriplebarrier
labeling to understand the interplay of these factors in determining the strategy’s risk-adjusted return, quantified by the
SharpeRatioandtheInformationRatio.
Through rigorous testing and sensitivity analysis, we demonstrated that employing supervised autoencoders sig-
nificantlyenhancedtheperformancemetricsofthestrategy. Ouranalysissuggestedanoptimalbalancebetweenthelevel
ofGaussiannoiseaddedtothefeaturesandthesizeoftheautoencoder’sbottleneck.
However,anincreaseinthelevelofnoiseandbottlenecksizebeyondcertainthresholdsledtoadecreaseinperfor-
mance,presumablyduetooverfittingandtheinclusionofmorenoisethansignal,respectively. Thesefindingsunderline
theneedforcarefulcalibrationoftheseparameterstoensurethemosteffectiveutilizationofsupervisedautoencodersin
thiscontext.
• RQ1. Doesdataaugmentationanddenoisingviaautoencodersimprovetheperformanceofastrategy? -Findings
presentedintheresultssection(Figure26)suggestthatdataaugmentationusingGaussiannoiseanddenoisingvia
autoencoders significantly improved the performance of the strategy. This was evident since Approach 3 outper-
formedApproaches1and2acrossallbarlengthsintermsoftheInformationRatioofanequallyweightedportfolio,
undertheoptimallevelsofnoiseandautoencoderbottlenecksize. However,cautionisnecessaryastherelationship
betweennoiselevel,bottlenecksize,andperformancewasnotlinear,indicatingtheneedforcarefulcalibrationof
theseparameters.
• RQ2. Does triple barrier labeling improve classifier performance over simple direction classification? - Triple
barrierlabelinggenerallyoutperformedsimplelabelingduetoitsabilitytohandlemarketnoisebetter(Figure25),
aswellasthesymmetryofrewardswhichmakesforbetteroptimizationmetrics,whichisdemonstratedbyapproach
4outperformingapproaches1-3in15-minuteand30-minutebars. Wenotethattriplebarrierlabelingmaynotbe
thebestchoiceforhigh-frequencytradingsincethe5-minutebarperformancewasworsethanforapproach3.
• RQ3. Doeshyperparametertuninghelpachievebetterperformanceoftheinvestmentstrategy? -Hyperparameter
tuningwasshowntobecrucialinachievingsuperiorperformanceinourstrategy(Figures26,27,28). Theoptimal
performance was observed under a specific combination of noise level and autoencoder bottleneck size, empha-
sizingtheimportanceofhyperparameteroptimizationintheapplicationofmachinelearningtechniquestotrading
strategies.
Despitethepromisingresults,thestudyissubjecttocertainlimitations. Firstly,thefindingsarebasedonhistorical
data, andassuch, theirpredictivepowerinrelationtofutureperformanceshouldbeconsideredwithcaution, giventhe
volatileandevolvingnatureoffinancialmarkets. Secondly,theresearchdoesnottakeintoaccountslippage,whichcould
potentiallydiminishthenetreturnsofthestrategy,especiallyifdealinginilliquidmarketsorwithlargecapital. Thestudy
alsoassumesthatstop-lossesandtakeprofitsfromtriplebarrierlabelingareexecutedimmediatelyandperfectly,which
isnotalwaysthecaseinthemarkets.
Thispaperintroducesseveralnewapproachestoalgorithmictrading. First,itappearstobethefirststudytoapply
our specific model architecture in the field of algorithmic trading. This approach differs notably from the traditional
models typically seen in this area. Second, while the concept of triple barrier labeling has been previously discussed,
our research goes a step further by developing a specialized optimization metric designed explicitly for use with triple
barrier labeling. These contributions are significant steps forward in integrating advanced machine-learning techniques
intofinancialtradingstrategies.
Theempiricalevidenceindicatingthatalgorithmicmodelscanoutperformtraditionalbuy-and-holdstrategiessug-
gests a necessity for their adoption in asset management to enhance market efficiency and potential investment returns.
Consequently, we view it as vital for regulators to craft policies that facilitate the ethical integration of these models,
ensuringmarketfairnessandstabilitywhilemitigatingsystemicrisks. Institutionalinvestorsandfundmanagersareen-
couragedtoembracetheseadvancedstrategies,necessitatinginvestmentsintechnologyandskilledpersonneltomaintain
competitivenessandupholdtheirfiduciaryresponsibilities. Thisshifttowardsalgorithmictradingisnotonlyareflection
ofthepotentialforimprovedfinancialperformancebutalsoamovementtowardtheinevitablemodernizationoffinancial
marketpractices.
Intermsoffurtherresearch,werecommendinvestigatingothertypesofnoiseandtheirimpactsonthestrategy’s
performance. Additionally,theintegrationofslippageintothemodelwouldprovideamorerealisticpictureofthestrat-
egy’snetreturns.Exploringdifferentarchitecturesfortheautoencoderortheintegrationofotherdeeplearningtechniques
mayalsoyieldinterestinginsights. Theimpactofthesemethodsonothertypesoffinancialtimeseriesdata,beyondthe
oneusedinthisstudy,wouldalsobeafruitfulavenueforfutureresearch.
27The findings from this study provide a compelling case for the continued exploration of machine learning tech-
niquesinfinancialtimeseriesanalysisandtradingstrategydevelopment.Asourunderstandingofthesetoolsdeepens,we
moveclosertounlockingtheirfullpotentialinpredictivemodelinganddecision-makingwithinthecomplexlandscapeof
financialmarkets.
References
[1] Abu-Mostafa,Y.S.,Atiya,A.F.(1996).Introductiontofinancialforecasting.ApplIntell6,205–213.
[2] Ariyo, A., Adewumi, A., Ayo, C. (2014). Stock price prediction using the ARIMA model. UKSim 2014.
10.1109/UKSim.2014.67.
[3] Azari,A(2018).BitcoinPricePrediction: AnARIMAApproach.KTHRoyalInstituteofTechnology.
[4] Ballings,M.,VandenPoel,D.,Hespeels,N.,Gryp,R.(2015).Evaluatingmultipleclassifiersforstockpricedirection
prediction.ExpertSystemswithApplications,42(20),7046-7056.
[5] BaranochnikovI.,S´lepaczukR.(2022)AcomparisonofLSTMandGRUarchitectureswithnovelwalk-forwardap-
proachtoalgorithmicinvestmentstrategy.WorkingPapersofFacultyofEconomicSciences,UniversityofWarsaw,
WP21/2022(397).
[6] Barberis, N., Thaler, R. (2002). A Survey of Behavioral Finance. Handbook of the Economics of Finance, 1(1),
chapter18,1053-1128.
[7] Billah,B.,King,M.L.,Snyder,R.D.,Koehler,A.B.(2006).Exponentialsmoothingmodelselectionforforecasting.
InternationalJournalofForecasting,22(2),239-247.
[8] Box,G.E.P.,Jenkins,G.M.(1976).Timeseriesanalysis: Forecastingandcontrol.SanFrancisco: Holden-Day.
[9] ChenW-H.,ShihJ-Y.,WuS.(2006)Comparisonofsupport-vectormachinesandbackpropagationneuralnetworks
inforecastingthesixmajorAsianstockmarkets.InternationalJournalofElectronicFinance,(I),49-67.
[10] : Diebold F., Mariano R. (2002) Comparing Predictive Accuracy. Journal of Business, Economic Statistics , Jan.,
2002,Vol.20,No.1,TwentiethAnniversaryCommemorativeIssue(Jan.,2002),pp.134-144
[11] Fama, E. F. (1970). Efficient Capital Markets: A Review of Theory and Empirical Work. The Journal of Finance,
25(2),383–417.
[12] de Faria, E.L., Albuquerque, M.P., Gonzalez, J.L. , Cavalcante, J.T.P., Albuquerque, M.P. (2009). Predicting the
Brazilianstockmarketthroughneuralnetworksandadaptiveexponentialsmoothingmethods.ExpertSystemswith
Applications36(10),12506-12509.
[13] dePrado,M.L.(2018),AdvancesinFinancialMachineLearning,Wiley;1stedition,ISBN-10: 1119482089
[14] Dudek,G.,Fiszeder,P.,Kobus,P.,&Orzeszko,W.(2024).Forecastingcryptocurrenciesvolatilityusingstatistical
andmachinelearningmethods: Acomparativestudy.AppliedSoftComputing,151,111132.
[15] Fischer,T.,&Krauss,C.(2018).Deeplearningwithlongshort-termmemorynetworksforfinancialmarketpredic-
tions.EuropeanJournalofOperationalResearch,270(2),654-669.
[16] Gers,F.,Schmidhuber,J.,Cummins,F.(2000)LearningtoForget: ContinualPredictionwithLSTM.NeuralCom-
putation,12(10):2451–2471.
[17] Granger, C.W.J. and Joyeux, R. (1980), An introductino to long-term memory time series models and fractional
differencing.JournalofTimeSeriesAnalysis,1: 15-29.https://doi.org/10.1111/j.1467-9892.1980.tb00297.x
[18] GrudniewiczJ.,S´lepaczukR.(2021)Applicationofmachinelearninginquantitativeinvestmentstrategiesonglobal
stockmarkets.WorkingPapersofFacultyofEconomicSciences,UniversityofWarsaw,WP23/2021(371).
[19] Hochreiter,S.,Schmidhuber,J.(1997).LongShort-termMemory.Neuralcomputation,9,1735-80.
[20] Hossain,M.A.,Rezaul,K.,Thulasiram,R.K.,Bruce,N.,Wang,Y.(2018).HybridDeepLearningModelforStock
PricePrediction.Paperatthe2018IEEESymposiumSeriesonComputationalIntelligence,Bangalore,India.
[21] Hu, Y., Liu,K., Zhang, X., Su,L., Ngai, E.W.T.,&Liu, M.(2015).Applicationofevolutionarycomputationfor
rulediscoveryinstockalgorithmictrading: Aliteraturereview.AppliedSoftComputing,36,534-551.
[22] A.K.Jain;JianchangMao;K.M.Mohiuddin(1996)Artificialneuralnetworks: atutorial.Computer.29(3),31-44.
28[23] Ji,S.,Kim,J.,Im,H.(2019)AComparativeStudyofBitcoinPricePredictionUsingDeepLearning.Mathematics.
7(10):898.
[24] Kamalov, F., Gurrib, I., Rajab, K.(2021).FinancialForecastingwithMachineLearning: PriceVsReturn.Journal
ofComputerScience,17(3),251-264.
[25] Kijewski,M.,S´lepaczuk,R.(2020)PredictingpricesofS&P500indexusingclassicalmethodsandrecurrentneural
networks.WorkingPapersofFacultyofEconomicSciences,UniversityofWarsaw,WP27/2020(333).
[26] Krauss,C.,Do,X.A.,&Huck,N.(2017).Deepneuralnetworks,gradient-boostedtrees,randomforests: Statistical
arbitrageontheS&P500.EuropeanJournalofOperationalResearch,259(2),689-702.
[27] Kryn´ska, K., S´lepaczuk, R. (2023). Daily and intraday application of various architectures of the LSTM model
in algorithmic investment strategies on Bitcoin and the S&P 500 Index, Working Papers of Faculty of Economic
Sciences,UniveristyofWarsaw,WP25/2022(401).hhtps://papers.ssrn.com/sol3/papers.cfm?abstract_id=4628806
[28] Kos´c´, K., Sakowski, P., S´lepaczuk, R. (2019) Momentum and contrarian effects on the cryptocurrency market,
PhysicaA:StatisticalMechanicsanditsApplications,2019,vol.523,issueC,691-701
[29] Lahmiri, S., Bekiros, S. (2020) Intelligent forecasting with machine learning trading systems in chaotic intraday
Bitcoinmarket.Chaos,Solitons,Fractals,133(C).
[30] Le, L., Patterson, A., White, M. (2018). Supervised autoencoders: Improving generalization performance with
unsupervisedregularizers.Advancesinneuralinformationprocessingsystems,31.
[31] Lo,A.W.,Hasanhodzic,J.(2010).TheHereticsofFinance: ConversationswithLeadingPractitionersofTechnical
Analysis.JohnWileyandSons.
[32] Malkiel,B.G.(1973).ARandomWalkDownWallStreet.(W.W.Norton,Co.,NewYork).
[33] Malkiel,B.G.(2005).ReflectionsontheEfficientMarketHypothesis: 30YearsLater.FinancialReview40(1):1-9.
[34] Michan´kówJ.,SakowskiP.,S´lepaczukR.(2022)ThecomparisonofLSTMinalgorithmicinvestmentstrategieson
BTCandSP500index.Sensors22,917.
[35] Olah, C. (2015). Understanding LSTM Networks. Available at: https://colah.github.io/posts/2015-08-
Understanding-LSTMs/(Accessed: 11July2022).
[36] Ozbayoglu, A. M., Gudelek, M. U., & Sezer, O. B. (2020). Deep learning for financial applications: A survey.
AppliedSoftComputing,93,106384.
[37] Rys´, P., S´lepaczuk, R.(2018)Machinelearninginalgorithmictradingstrategyoptimization-implementationand
efficiency.WorkingPapersofFacultyofEconomicSciences,UniversityofWarsaw,WP25/2018(284).
[38] Sepp,H.,Schmidhuber,J.(1997)LongShort-TermMemory.Neuralcomputation,9(8):1735–1780.
[39] Sezer,O.B.,Gudelek,M.U.,&Ozbayoglu,A.M.(2020).Financialtimeseriesforecastingwithdeeplearning: A
systematicliteraturereview: 2005–2019.AppliedSoftComputing,90,106181.
[40] Sezer, O.B., &Ozbayoglu, A.M.(2018).Algorithmicfinancialtradingwithdeepconvolutionalneuralnetworks:
Timeseriestoimageconversionapproach.AppliedSoftComputing,70,525-538.
[41] Shah,D.Campbell,W.,Zulkernine,F.(2018).AComparativeStudyofLSTMandDNNforStockMarketForecast-
ing.PresentedatIEEEInternationalConferenceonBigData(Seattle,Washington,USA).
[42] Schulmeister,S.(2009)Profitabilityoftechnicalstocktrading: Hasitmovedfromdailytointradaydata? Reviewof
FinancialEconomics,18(4).
[43] ZenkowaM.,S´lepaczukR.(2019),RobustnessofSupportVectorMachinesinAlgorithmicTradingonCryptocur-
rencyMarket,CentralEuropeanEconomicJournal,5(1),pp.186-205,https://doi.org/10.1515/ceej-2018-0022
[44] Tkácˇ, M., & Verner, R. (2016). Artificial neural networks in business: Two decades of research. Applied Soft
Computing,38,788-804.
29
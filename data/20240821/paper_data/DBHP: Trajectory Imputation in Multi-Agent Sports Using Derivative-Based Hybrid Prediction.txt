DBHP: Trajectory Imputation in Multi-Agent Sports
Using Derivative-Based Hybrid Prediction
HanjunChoi1*,HyunsungKim2,3*,MinhoLee4,
Chang-JoKim3,JinsungYoon3,andSang-KiKo3,5
1KoreaElectronicsTechnologyInstitute,Seongnam,SouthKorea
2KoreaAdvancedInstituteofScienceandTechnology,Daejeon,SouthKorea
3FitogetherInc.,Seoul,SouthKorea
4SaarlandUniversity,Saarbru¨cken,Germany
5UniversityofSeoul,Seoul,SouthKorea
Abstract for trajectory data collection, such as sports games with
broadcastingcameraviewwhereplayerscandisappearfrom
Manyspatiotemporaldomainshandlemulti-agenttrajectory
theviewdependingontheirrelativepositionstotheball.
data,butinreal-worldscenarios,collectedtrajectorydataare
often partially missing due to various reasons. While exist- Theprevalenceofmissingvaluesinmulti-agenttrajectory
ing approaches demonstrate good performance in trajectory data calls for developing effective imputation techniques.
imputation, they face challenges in capturing the complex Oneofthesimpleyetpowerfulsolutionsistoemploynaive
dynamics and interactions between agents due to a lack of rule-based imputation methods such as forward/backward
physicalconstraintsthatgovernrealistictrajectories,leading fillorlinearinterpolation.However,theycannotcapturethe
to suboptimal results. To address this issue, the paper pro- complex dynamics and interactions between agents, result-
posesaDerivative-BasedHybridPrediction(DBHP)frame-
inginsuboptimalperformance.Onthisaccount,manystud-
workthatcaneffectivelyimputemultipleagents’missingtra-
ies have proposed deep learning-based imputation methods
jectories. First, a neural network equipped with Set Trans-
thatconsiderthespatiotemporaldependenciesofthemulti-
formers produces a naive prediction of missing trajectories
agentmovements.Thoughtheyaimedtoimproveaccuracy
whilesatisfyingthepermutation-equivarianceintermsofthe
orderofinputagents.Then,theframeworkmakesalternative bymodelingsuchdependencies,mostofthemfailedtosig-
predictionsleveragingvelocityandaccelerationinformation nificantlyoutperformtheaforementionednaivebaselines.
and combines all the predictions with properly determined To address this issue, this paper proposes a framework
weightstoprovidefinalimputedtrajectories.Inthisway,our named Derivative-Based Hybrid Prediction (DBHP) that
proposed framework not only accurately predicts position, imputes missing values in multi-agent trajectory data with
velocity,andaccelerationvaluesbutalsoenforcesthephysi-
highaccuracybyenforcingthephysicalrestrictionsthatre-
calrelationshipbetweenthem,eventuallyimprovingboththe
alistic trajectories should satisfy. First, a deep neural net-
accuracy and naturalness of the predicted trajectories. Ac-
workequippedwithSetTransformers(Leeetal.2019)and
cordingly,theexperimentresultsaboutimputingplayertra-
agent-wise bidirectional LSTMs (Hochreiter and Schmid-
jectoriesinteamsportsshowthatourframeworksignificantly
outperformsexistingimputationbaselines. huber 1997) produces a series of predictions for missing
values. In addition to this direct prediction of players’ po-
sitions,theframeworkmakesalternativepredictionsnamed
1 Introduction
Derivative-AccumulatingPredictions(DAPs)byaccumulat-
Various spatiotemporal domains such as transportation, ing the predicted velocity and acceleration on the nearest
robotics,surveillance,andsportshandlemulti-agenttrajec- observed positions for each missing segment in either di-
torydata.Inparticular,withtherecentadvancementofcom- rection.Then,theframeworkcompromisesbyproperlyde-
puter vision and sensing technologies, a growing number termining weights between the three types of predictions,
of groups are collecting these types of data for various use i.e.,neuralnetworkoutput,forwardandbackwardDAPs,to
cases.However,acquiringacompletesetoftrajectorydatais makethebestfinalprediction.
stillverychallengingastherearemanypracticalpossibilities
Intheexperiments,weevaluatedtheperformanceofour
ofmissingpartialtrajectories.WearabledevicessuchasGPS
proposed framework on the three benchmark datasets col-
trackersormotionsensorsmayexperiencetemporarysignal
lected from popular team sports: soccer, basketball, and
loss or malfunction, obstructing the collection of complete
American football. The experimental results demonstrate
trajectorydata.Similarly,computervisionsystemsoftenfail
thatourframeworksignificantlyoutperformsexistingbase-
todetectagentsinoccludedregionsorinlow-lightingcon-
lines for multi-agent trajectory imputation in terms of ac-
ditions.Inparticular,somedomainsposeuniquechallenges
curacy. In particular, leveraging the derivative information
was found to be effective in improving the physical plau-
*Theseauthorscontributedequally.
Copyright©2025,AssociationfortheAdvancementofArtificial sibility of the imputed trajectories. Lastly, we present the
Intelligence(www.aaai.org).Allrightsreserved. additional possibility of utilizing our framework for other
4202
guA
02
]IA.sc[
1v87801.8042:viXrapractical tasks, such as estimating match statistics with in- unidirectional manner and cannot leverage the information
completetrackingdataandforecastingfuturetrajectoriesof ofthefutureobservations.
playersinsports.
Insummary,themaincontributionsareasfollows:
DP
1. We introduce a multi-agent trajectory prediction model Multi-agent trajectories Set Transformer
employing Set Transformers to ensure the permutation-
equivariance of the agents. This architecture itself im-
putesmissingvaluesmoreaccuratelythanpreviousstate-
of-the-artimputationmodels.
2. We propose the DAP mechanism that assembles Missing Observed Bi-LSTM
smootherpredictionsthantheoutputsoftheaboveneural
networkbyleveragingthephysicalrelationshipsbetween
DAP
theposition,velocity,andacceleration.
3. WeproposetheDBHPframeworkcombiningtheabove
predictions by a weighted sum, where the weights are + + + + + +
learnedtomaximizetheirrelativeadvantages.
4. Wedemonstratethattheproposedframeworkhastheca-
pabilitytogeneralizeacrossvarioussportsgamesandis + + + + - - - -
Forward Backward
applicabletopracticalmissingscenarios.
2 RelatedWork DBHP
Imputed trajectories
Weighted sum
Though many studies have proposed methods for imputing
timeseriesdata,notallofthemhaveaddressedthespecific
challengesofmulti-agenttrajectorieswithcomplexinterac-
tions and dynamics. To name a few, TimesNet (Wu et al.
2023) and TIDER (Liu et al. 2023a) were designed to im- Missing Observed
putemultivariatetimeseriesbymodelingtheirtemporalpat-
terns such as multi-periodicity, seasonality, or local biases,
buttheyareinappropriateformulti-agentspatiotemporaldo- Figure1:Overviewoftheproposedframework.
mainssuchasteamsportssincethebehaviorsofagentsare
highlyuncertainwithoutrepeatingpatterns.SPIN(Marisca,
Cini,andAlippi2022)regardedtheinteractionbetweendata
3 ProposedFramework
acquiredfrommultiplesensors,butitassumedthatthesen-
sors’locationsarefixedandthusisnotapplicabletoourcase Our study about multi-agent trajectory imputation assumes
ofmovingagents.Otherstudieshavealsoaddressedmulti- a scenario where the missing time intervals of each agent
agenttrajectoryimputation(Liuetal.2023b;ChoiandLee could differ from those of others. To elaborate, let the tra-
2023; Fang et al. 2024); however, they are limited to sce- jectories of K players be X = {xk }K , where each
1:T 1:T k=1
narios where agents’ positions remain fixed, making them agent k’s input features xk at each time t consist of their
t
unsuitableforourresearchinvolvingmovingagents. (x,y)positionpk = (pk ,pk ),velocityvk = (vk ,vk ),
t t,x t,y t t,x t,y
On the other hand, recent studies designed to impute and acceleration ak = (ak ,ak ). Here, the velocity and
multi-agenttrajectoriesfocusonmodelingagents’complex t t,x t,y
acceleration are calculated from the position values by the
interactions and dynamics. BRITS (Cao et al. 2018) pro-
followingapproximations:
posedanRNN-basedmulti-agentimputationmodelthatin-
corporates the observed features at missing time steps and pk−pk vk −vk
past information, but it is prone to compounding errors v tk ≈ t ∆tt−1, ak t ≈ t+1 ∆t t (1)
caused by an incorrect prediction at an early stage. To ad-
dress this issue, non-autoregressive imputation frameworks where∆tisthedifferencebetweenadjacenttimesteps.
suchasNAOMI(Liuetal.2019)andNRTSI(Shan,Li,and Inourscenario,eachxk 1:T hasmissingpartsidentifiedby
Oliva 2023) were proposed, but they can only handle the amaskingsequencemk =(mk,...,mk)wheremk =1
1:T 1 T t
case when all agents have the same missing period. Omid- ifxk isobservedand0ifitismissing.Notethatthemodel
t
shafiei et al. Omidshafiei et al. (2022) recently proposed mayimproperlyexploittheinformationattheendpointsof
GraphImputerthatisapplicabletopracticalscenariossuch maskedsegmentsinthissettingsinceEq.(1)usestheposi-
asmissingplayertrajectoriesoutofthecameraviewinteam tionalinformationatadjacenttimestepswhenapproximat-
sports.Notethatmanystudies(Yehetal.2019;Zhanetal. ing the derivatives. To prevent this, we also mask the two
2019;Kamraetal.2020;Lietal.2020;Sunetal.2022b,a) frames adjacent to each missing segment to simulate a real
haveproposedframeworksformulti-agenttrajectorypredic- situation where the model could not know the velocity and
tion,buttheyaredesignedtoforecastfuturetrajectoriesina accelerationatthosepoints.
...
...
...
...
FC
&
Softmax
Bi-LSTMGiven this setting, an imputation model aims to take the Lastly,afully-connectedlayerdecodesthejointhiddenstate
incomplete data {mk ⊙ xk }K as input and produce tooutputapredictionxˆk,dateachtimet:
1:T 1:T k=1 t
imputed trajectories {xˆk }K . Combining these imputed
trajectorieswiththeobs1 e: rT vek d= f1 ragmentsresultsincomplete xˆk t,d =FC(hk t,f,hk t,b). (7)
trajectories{x˜k }K ,i.e.,
1:T k=1 Wecallthepredictionobtainedinthisphasethedirectpre-
x˜k =mk ⊙xk +(1 −mk )⊙xˆk , (2) diction(DP)andcombineitwiththeotherpredictionsfrom
1:T 1:T 1:T T 1:T 1:T laterphasestogetmoreaccuratefinalprediction.
fork =1,...,K.
Derivative-Accumulating Prediction We start from the
Thenoveltyoftheproposedframeworkliesinthemech-
following relationships between the position, velocity, and
anism of enhancing the model performance by integrating
accelerationderivedfromEq.(1):
positions directly predicted by a neural network and those
resulting from accumulating predicted derivatives (i.e., ve- pk ≈pk+vk ∆t, vk ≈vk+ak∆t, (8)
t+1 t t+1 t+1 t t
locityandaccelerationvalues).SeeFigure1illustratingthe
Taking this into account, we compute Derivative-
overallarchitectureofourframework.
AccumulatingPrediction(DAP)withimprovedstabilityby
Neural Network-Based Direct Prediction This section enforcingthephysicalrelationshipsinEq.(8),asanalterna-
describes the neural network architecture producing naive tivetothedirectimputationresult.Toelaborate,let(t ,t )
s e
predictions of imputed trajectories. It takes partially ob- be an arbitrary missing segment for a player k. Then, we
served trajectories {mk ⊙xk }K as an input and pre- recursivelypredictpositionsinsidethesegmentbyaccumu-
1:T 1:T k=1
dictseachagentk’sfulltrajectory latingvelocitiesandaccelerationsineitherdirection.Along
the forward direction, we start from the observed position
xˆk,d ={(pˆk,d,pˆk,d,vˆk,d,vˆk,d,aˆk,d,aˆk,d)}T , (3) pk and recursively add predicted velocities and accelera-
1:T t,x t,y t,x t,y t,x t,y t=1 ts
tionstoobtainpredictionspˆk,f basedonEq.(8):
wherethesuperscriptdstandsfor“directprediction”. t
To build an effective neural architecture for modeling pˆk,f =pk (9)
multiple trajectories, we should enforce a strong induc- ts ts
tive bias called the permutation-equivariance. Since there pˆk,f ≈pˆk,f +vˆk,d∆t (10)
t t−1 t
is no semantic order of agents in our multi-agent systems,
≈pˆk,f +(vˆk,d +aˆk,d∆t)∆t, t <t<t . (11)
a permutation in the order of input agents should not af- t−1 t−1 t−1 s e
fect the output value for each agent and only change the Likewise, we start from the observed position pk at the
output order by the same permutation. We utilize the en- te
opposite endpoint and recursively subtract the predicted
codermoduleoftheSetTransformer(Leeetal.2019)toen- derivativestoobtainbackwardpredictionspˆk,b.
sure the permutation-equivariance of outputs. A Set Trans- t
Adopting DAPs instead of direct predictions carries sev-
former consists of an encoder that produces permutation-
eral advantages. First, since the loss between these DAPs
equivariant representations of multi-agent inputs and a de-
andthegroundtruthmorepenalizesunstablepredictionsof
coder that produces a single permutation-invariant output
the velocity and acceleration, minimizing it improves the
sharedforallagents.Itisnaturaltoonlyemployitsencoder
smoothness of the predicted derivatives. Considering that
part for our permutation-equivariant task, but to improve
existing position-oriented imputation models suffer from
the model performance, we also attach the permutation-
fluctuatingtrajectories,thesesmoothderivativeshaveaclear
invariantembeddingthatresultsfromafullSetTransformer
advantage in that they result in more plausible positional
architecture,includingtheencoderanddecoderparts.
predictions. Furthermore, enforcing the relationships be-
To be specific, we obtain permutation-equivariant agent-
tween the physical quantities imposes an additional induc-
wiseembeddings{zk}K fromtheencoderofaSetTrans-
t k=1 tivebiastothemodel,whichmakesitmoredata-efficient.
former and a single permutation-invariant embedding z
t
fromafullSetTransformerforeachtimestept: DynamicHybridPrediction ThoughDAPhasaclearad-
vantage over direct prediction, it also has a potential draw-
(z1 t,...,zK t )=ST-Encoder(m1 tx1 t,...,mK t xK t ), backcalledtheerrorcompoundingproblem.Namely,since
z =SetTransformer(m1x1,...,mKxK). (4) weonlyrelyontheobservationatanendpointasananchor
t t t t t
andthepredictedderivativesthatareaccumulatedonthean-
Frame-by-frame application of the Set Transformer to the chor, the prediction error tends to grow as the number of
input features yields embeddings {(z1,...,zK,z )}T . iterationsinEq.(11)oritsbackwardcounterpartincreases.
t t t t=1
Then, bidirectional LSTMs (Hochreiter and Schmidhu- Onthecontrary,thedirectpredictionsresultingfromEq.(7)
ber 1997) sharing weights across agents extract the arerobustagainstthisproblemsincetheydonotstrictlyde-
sequential information from the concatenated sequence pendonpredictionsatothertimesteps.
{(xk,zk,z )}T per agent k by updating joint hidden To address this trade-off, we take a hybrid approach
t t t t=1
states: named Derivative-Based Hybrid Prediction (DBHP) to
leverage the advantages of DP and DAP. That is, instead
hk,f =LSTMf(xk,zk,z ;hk,f ), (5)
t t t t t−1 of solely relying on one of the aforementioned predictions
hk,b =LSTMb(xk,zk,z ;hk,b ). (6) {(pˆk,d,pˆk,f,pˆk,b)}K ,wecompromisebetweenthemby
t t t t t+1 1:T 1:T 1:T k=1computing a weighted sum. More specifically, we first de-
ploy an additional Bi-LSTM as well as the original Bi-
LSTMperagenttoobtainweightsusedtocombinetheDP
andDAP.Specifically,wefeedthepredictionsofthreetypes
xˆk,d,pˆk,f,pˆk,btogetherwiththecontextembeddingszk,z
t t t t t
resultingfromEq.(4)peragentkandtimesteptintoaBi-
LSTMtoupdatehiddenstates:
h˜k,f =LSTMf(xˆk,d,pˆk,f,pˆk,b,zk,z ,γ ;h˜k,f ), (12)
t t t t t t t t−1
h˜k,b =LSTMb(xˆk,d,pˆk,f,pˆk,b,zk,z ,γ ;h˜k,b ). (13)
t t t t t t t t+1
where γ = exp(−max{0,W δ +b }) is the temporal
t γ t γ
decay introduced in BRITS (Cao et al. 2018) to inform the
modelhowfaragiventimesteptisfromthebothobserved
Figure2:Exampleofasimulatedcameraviewandimputed
endpoints. Since we want to fairly weigh the bidirectional
DAPs,weusethetimegapδ = (t−t ,t −t)fromboth trajectoriesinsoccer.Theshadedareaindicatestheobserved
t s e
region on the pitch. The model imputes the trajectories of
directions.
playersoutsidethisregion,wheretranslucentcirclesrepre-
Lastly, a fully-connected layer with a softmax activation
sentthepredictedlocations.
returnsweightsaddingupto1:
(λk,d,λk,f,λk,b)=Softmax(FC(h˜k,f,h˜k,b)). (14)
t t t t t
playerscollectedfrom3matches.Forbasketball,weuse100
Basedontheseweights,themodelyieldsafinalprediction:
matches among 631 matches of SportsVU’s NBA dataset2,
pˆk =λk,dpˆk,d+λk,fpˆk,f +λk,bpˆk,b, (15) where each match contains trajectories of 10 players. The
t t t t t t t
American football dataset is from the Kaggle competition3
and combine the resulting trajectories with the observed
withNFL’sNextGenStatsdata,whereweadopttheprepro-
fragmentsbyEq.(2)asfollows:
cessed version4 of NRTSI (Shan, Li, and Oliva 2023) con-
x˜k 1:T =mk 1:T ⊙xk 1:T +(1 T −mk 1:T)⊙xˆk 1:T, (16) taining 9,543 5-second time series. The original sampling
rates of the three datasets are 25Hz, 25Hz, and 10Hz, re-
wherexˆk =(pˆk ,pˆk ,vˆk,d,vˆk,d,aˆk,d,aˆk,d).
t t,x t,y t,x t,y t,x t,y spectively, but we downsampled them to a common rate of
Loss function In our framework, the more accurate the 10Hzforconsistency.Forsoccerandbasketball,200frames
prediction at each stage, the more reliable the final DBHP wereusedasinputdatawith22playersand10players,re-
outputs.Hence,weminimizenotonlythelossbetweenthe spectively,whileforAmericanfootball,50framesand6of-
final prediction and the true trajectories, but also terms to fensiveplayerswereusedasinputdata.
compare the auxiliary predictions with the ground truth.
Missingscenarios Toevaluatethemodelperformanceon
Thatis,wecomputethemeanabsoluteerror(MAE)forthe
various missing patterns, we consider the following three
DP,DAP,andthefinalhybridprediction.WenametheMAE
scenariosthatmayoccurduringdataacquisitionprocesses:
loss function for DP, forward and backward DAPs and the
finalhybridpredictionasLd,Lf,Lb,andLh,respectively. • Uniformmissingscenario:Allplayershavemissingval-
Finally,theproposedDBHPmodelistrainedbyminimizing uesatthesametimeinterval.Notethatamongthebase-
lines,NAOMI(Liuetal.2019)andNRTSI(Shan,Li,and
LDBHP =Ld+Lf +Lb+Lh. (17)
Oliva2023)aredesignedtoonlyhandlethisscenarioand
notcapableofthefollowingotherscenarios.
4 MainExperiments
• Agent-wise missing scenario: Individual players have
Oneofthemostchallengingdomainsformulti-agenttrajec-
missingvaluesatdifferenttimeintervals.
torypredictionisteamsportssincethemovementsandinter-
• Broadcastingcamerascenario:Avirtualcamerafollows
actionsofplayersarehighlydynamicandcomplex,andthe
the ball and only captures the players inside the camera
exampleisillustratedinFigure2.Thus,weconductexperi-
view,resultinginmissingvaluesfortheremainingplay-
mentsonteamsportsdatatoevaluatetheimputationperfor-
ers.FollowingGraphImputer(Omidshafieietal.2022),
mance of our proposed framework on this challenging do-
weconductanexperimentonlyonthesoccerdatasetfor
main.
thisscenario.
4.1 ExperimentalSettings Figure 3 illustrates examples of masking matrices of the
Data preparation In the experiments, we independently soccer dataset used in each missing scenario. Since our
train models and evaluate the performance on three public taskistoimputetrajectoriesgiventheobserveddatabefore
datasets collected from three popular team sports: soccer,
basketball,andAmericanfootball.Thesoccerdatasetispro-
2https://github.com/linouk23/NBA-Player-Movements
vided by Metrica Sports1 and contains tracking data of 22 3https://www.kaggle.com/competitions/nfl-big-data-bowl-
2021
1https://github.com/metrica-sports/sample-data 4https://github.com/lupalab/NRTSI/tree/main/codes stochasticDataset Soccer Basketball AmericanFootball
Scenario Uniform Agent-wise Camera Uniform Agent-wise Uniform Agent-wise
Metric PE SCE PE SCE PE SCE PE SCE PE SCE PE SCE PE SCE
L.Interp. 3.8406 0.1299 5.0752 0.1631 3.1083 0.0993 3.3481 0.1483 4.4992 0.1787 0.8897 1.1063 1.5128 1.0641
C.Spline. 2.2085 0.0867 11.4647 0.2939 1.9209 0.0547 2.3114 0.1025 10.3857 0.2715 0.7448 0.9463 1.2041 0.5306
BRITS 7.4859 3.9089 5.7266 2.9627 7.4208 4.1967 2.9085 1.0521 2.4238 0.5397 1.7990 10.9459 1.7527 10.6807
NAOMI 4.5343 3.9793 N/A N/A N/A N/A 1.5254 0.3230 N/A N/A 0.9692 2.3112 N/A N/A
NAOMI-ST 2.0147 1.3561 N/A N/A N/A N/A 1.5038 0.0818 N/A N/A 0.5889 0.6367 N/A N/A
NRTSI 3.1791 0.0854 N/A N/A N/A N/A 2.5291 0.0734 N/A N/A 0.5158 0.2989 N/A N/A
CSDI 3.4295 0.1586 4.0279 0.1305 3.5181 0.2132 2.2558 0.0631 2.3471 0.0563 0.5558 0.4905 0.6182 0.4288
G.Imputer 4.6511 0.1191 5.6011 0.1508 3.6512 0.0934 2.8305 0.1066 2.5859 0.0700 0.8899 1.1023 1.5128 1.0631
DBHP-TF 1.4384 0.0555 2.0286 0.0551 1.2849 0.0377 1.1585 0.0495 1.4701 0.0411 0.1752 0.1229 0.2389 0.1077
DBHP 1.3205 0.0516 1.9832 0.0535 1.2296 0.0374 0.9727 0.0438 1.3862 0.0381 0.1542 0.1126 0.2104 0.0967
Table1:Performanceoftrajectoryimputationmodelsondifferentdatasetsandmissingscenarios.
Uniform Agent-wise Camera Oliva2023):theaverageabsolutedifferencebetweenthe
0 0 0
varianceofthetrueandpredictedvelocitiestoassessthe
40 40 40 naturalnessofimputedtrajectories.
80 80 80
120 120 120
160 160 160
4.2 ExperimentalResults
0 4 8 12 16 20 0 4 8 12 16 20 0 4 8 12 16 20
Agent Agent Agent
Missing Observed
Table 1 exhibits the trajectory imputation performance of
Figure 3: Visualization of example masking matrices for the aforementioned models on different datasets and miss-
threedifferentmissingscenarios. ingscenarios.Experimentalresultsshowthatourproposed
framework significantly outperforms other baselines. Since
thelackofpermutationequivalenceisconsideredasoneof
and after the missing intervals, we make the first and last the main limitations of baselines, we attach the Set Trans-
five frames of each window not missed as in the previous former encoder to NAOMI which is a competitive baseline
works (Liu et al. 2019; Omidshafiei et al. 2022; Shan, Li, modelandreporttheresultwiththenameNAOMI-ST.The
andOliva2023).Itisalsoworthmentioningthatweuseda comparison between NAOMI and NAOMI-ST shows that
dynamic missing rate ranging from 0.1 to 0.9 during train- the permutation equivariance is indeed an important cause.
ing,andevaluateditwithafixedmissingrateof0.5during We also replace Bi-LSTM from DBHP which is employed
testing to enable the model to learn across various missing for sequential modeling by a transformer module and re-
ratescenarios. port the result with the name DBHP-TF. The comparison
between DBHP-TF and DBHP validates our choice of Bi-
Models and evaluation metrics In the experiments, we
LSTM for sequential modeling as DBHP performs slightly
compare the imputation performance with several base-
better than DBHP-TF. Figure 4 visualizes the imputed tra-
line models. Additionally, we also conduct experiments on
jectoriesresultingfrommajorbaselineswithourmodel.
DBHP-TF, which utilizes a Transformer in the encoder
part of DBHP. Note that for models such as BRITS, CSDI Another observed advantage of our proposed framework
and NAOMI that do not preserve permutation-equivariance is data efficiency. For the soccer dataset with only two
of the order of input players, we sort trajectories by the matchesoftrainingdata,otherneuralnetworkbaselinesare
sum of average x and y coordinates to ensure permu- evenworsethanthelinearinterpolation.Giventhatbaselines
tation robustness. Therefore, to verify the importance of suchasNAOMIandNRTSIoutperformthelinearinterpola-
permutation-equivariance in the multi-agent trajectory im- tiononbothbasketballandAmericanfootballdatasetswith
putation task, We conduct additional experiments on the sufficient training data, the main reason for their poor per-
NAOMI-STmodel,whichaddsasettransformerembedding formanceonthesoccerdatasetappearstobetheshortageof
totheNAOMI. trainingdata.Ontheotherhand,ourframeworkexhibitsway
To evaluate the performance of our framework and the betterperformancethanallbaselinesincludingthelinearin-
baselines,weadoptthefollowingtwometrics: terpolation on the soccer dataset as well as the basketball
and American football datasets. Considering the difficulty
• Position error (PE): the average Euclidean distance be-
in acquiring complete trajectory data in many domains, we
tweenthetrueandpredictedpositions.
believethatourframeworkcanbeefficientlyappliedtovar-
• Step change error (SCE) (Liu et al. 2019; Shan, Li, and iousdomainsevenwithasmallamountoftrainingdata.
pets
emiTAccording to Table 2, using velocities and accelerations
asinputfeaturesofDPclearlyhelpsthemodelbetterpredict
missingtrajectories.Inparticular,modelsthatonlyobserve
positional information suffer from significant performance
degradation. We think this comes from the architecture of
DPthatfirstindependentlyencodesmulti-agentcontextsfor
(a)GroundTruth (b)Linearinterpolation each time step by Set Transformers and then connects se-
quential information by agent-wise Bi-LSTMs. Here, tak-
ingderivativesasinputmakestheSetTransformersconsider
someinformationofadjoiningtimesteps,resultinginmore
comprehensivecontextembeddingsthanthoseonlyobserv-
ingpositions.
(c)BRITS (d)CSDI
Resultsondifferentwindowsizesandmissingrates We
comparethemodelperformanceonscenarioswithdifferent
windowsizesandmissingrates.Alongerwindowallowsthe
model to observe more data points but leads to an increase
inthemaximumlengthofamissingsegment.Meanwhile,a
highermissingrateincreasestheoverallratioofthemissing
framestotheobservedframes.Tobespecific,weindepen-
(e)GraphImputer (f)DBHP dently changed the size of the sliding windows from 50 to
600 and the missing rate from 0.3 to 0.7 of the agent-wise
Figure4:Comparisonofgroundtruthandimputedtrajecto-
missingscenario.Then,wemeasuredthepositionerrorsof
riesforthebasketballdataset.
modelsforeachcombination.Wealsoevaluatedtheperfor-
manceofthebroadcastingcamerascenarioforeachwindow
sizeandreportedthemissingrateofit.
4.3 AblationStudies
Inadditiontothemainexperiments,wehavecarriedoutab-
WS\MR 0.3 0.5 0.7 Camera(MR)
lationstudiestoexploretheimpactsofeachcomponentin-
troducedinDBHPframework.Wealsoconductcomparative 50 0.0691 0.1158 0.1552 0.0841(0.4569)
analysesondifferentwindowsizesandmissingratesforour 100 0.3561 0.5948 0.8047 0.4622(0.5138)
proposedmodel.Forsimplicity,bothexperimentswerecon- 200 1.2805 2.0491 2.5556 1.1711(0.5375)
ductedonlyonthesoccerdataset. 300 2.3129 3.2746 4.0821 1.5993(0.5454)
600 4.2597 5.9329 7.2485 2.1410(0.5540)
Impactofthederivativeinformationasinput Toempir-
ically justify the use of derivative features in DP and DAP, Table3:PositionerrorsoftheDBHPtrainedforandapplied
wecomparedtheperformanceofourdynamicDBHPonthe toscenarioswith differentwindowsizesandmissing rates.
broadcastingcamerascenariowiththosetrainedwithoutac- Thenumberinsideeachparenthesisintherightmostcolumn
celerations(i.e.,usingpositionsandvelocities)andevenve- indicatesthemissingrateofthecorrespondingbroadcasting
locities (i.e., only using positions) of observed trajectories. camerascenario.
Furthermore,wemadeDPonlypredictpositionsandveloc-
ities, and DAP estimate positions only based on predicted
velocities.Wetrainedthemodelswiththese“velocity-only” Agreeingwithourintuition,Table3showsthatthemodel
DAPandcomparedtheperformancewiththeircounterparts becomes less accurate as either the window size or the
thatexploitedpredictedaccelerationvalues. missing rate increases. In particular, the position error of
the agent-wise missing scenario becomes much larger for
a longer window, even with a small missing rate. This is
DPFeats. DAPFeats. pˆk,d pˆk,f pˆk,b pˆk
t t t t because some players may miss most frames in the pro-
pos. vel. 4.0008 2.8203 2.8261 2.5549 cess of randomly distributing the total number of missing
pos. vel.&acc. 2.9119 2.6973 2.6858 2.4954 framestoindividuals.Accordingly,inalongerwindow,the
pos.&vel. vel. 1.6600 1.5742 1.5590 1.4025 model has to predict the players’ stochastic movements for
pos.&vel. vel.&acc. 1.6235 1.5731 1.5670 1.4013 tensofseconds,resultinginalargeerrorduetoitsinherent
allfeats. vel. 1.6713 1.4985 1.5595 1.2644 difficulty.Meanwhile,inthebroadcastingcamerascenario,
the maximum length of a missing segment does not signif-
allfeats. vel.&acc. 1.4963 1.4122 1.3982 1.2296
icantly change according to the window size. This results
inrobustperformanceagainstvaryingwindowsizes,imply-
Table 2: Position errors of the components of the dynamic
ingthatourframeworkcanbereliablyappliedtoreal-world
DBHPinEq.15trainedusingdifferentsubsetsoffeatures.
broadcastingdata.5 Applications matedbyeachmethod,astheyarewidelyusedasindicators
for players’ physical performance or fitness. We first com-
Inthissection,weexplorethepossibilityofleveragingour
pute velocities from the observed/imputed positions based
frameworkforpracticaltasks.Asexamples,wepresenttwo
onEq.1andobtainspeedvaluesbycalculatingthenormsof
promisingapplicationsinsoccerdomain:pitchcontrolanal-
thesevelocityvectors.Then,wecomputethedistancecov-
ysis(Spearmanetal.2017)andapproximatingmatchstatis-
eredbyeachplayerbysummingupthespeedvaluesmulti-
ticsfromincompletetrackingdata.
pliedby∆t=0.1s.Forthelatter,ifaplayerrunsfasterthan
Pitch control analysis We show that our framework can 6ms−1forconsecutiveframes,wedetecthis/hermovement
beusedtoperformpitchcontrol(Spearmanetal.2017)anal- duringtheframesasasprint.Then,wecountthenumberof
ysis, which is a well-established technique in soccer ana- sprintstheplayermadeduringthegivenperiod.
lytics, in partially-observable settings. Pitch control can be
used to quantify how soccer players control regions on the
Distance(m) #Sprints
pitch at each time step by relying on physics-based mod-
eling. In Figure 5, the pitch image corresponding to each Model OR Mean MAPE Mean MAPE
modelrepresentsthedifferencebetweenpitchcontrolresults
True - 11,093.5 - 41.49 -
where one from the ground-truth trajectory and the other
from the partial observations where the missing trajectory L.Interp. 1.55% 10,049.2 9.28% 38.13 7.97%
is imputed by the model. If a specific area of the pitch is BRITS 34.68% 10,559.7 4.57% 52.07 30.95%
shadedwithadarkercolor,itindicatesagreaterdifference. G.Imputer 5.23% 8,972.1 19.15% 37.85 9.80%
Figure5showsthatDBHPachievesthemostsimilarresult DBHP 0.01% 10,931.4 1.48% 40.41 4.25%
comparedtootherbaselines.
Table4:Playerstatisticsestimatedbydifferentmodelsand
theirmeanabsolutepercentageerrors(MAPE)forthesoccer
test data. OR stands for the outlier rate, i.e., the proportion
ofoutlierframeswithlargespeedoraccelerationvalues.
For evaluation, we use the soccer test data consisting of
thehalfofamatchandassumethebroadcastingcamerasce-
nario. Since players played for different time periods, we
normalize each player’s statistics by 90 minutes and cal-
(a)GroundTruth (b)Linearinterpolation culatetheaveragesofsuchnormalizedvaluesestimatedby
DBHPandotherbaselines,respectively.
AccordingtoTable4,DBHPprovidesaccurateestimates
close to the ground truth with few outliers. Especially con-
sidering that other methods either suffer from a huge num-
berofoutliers(BRITS)orinaccuratedistancemeasures(lin-
earinterpolationandGraphImputer),itisobviousthatour
modeltakesclearadvantageofsmoothpredictionofveloci-
ties. In a nutshell, our framework is practical in that it can
provide reliable statistics (with incomplete tracking data)
(c)BRITS (d)CSDI
whichoriginallyrequireentireplayertrajectories.
6 Conclusions
This paper proposes DBHP, a trajectory imputation frame-
work that imputes missing values of multiple agents with
improvedquality.Itconsistsofaneuralnetworkthatmakes
an initial prediction in a permutation-equivariant manner
andanadditionalschemeforincorporatingderivativestore-
fine the imputation results. The experiments conducted on
(e)GraphImputer (f)DBHP
the sports datasets with various missing scenarios demon-
Figure5:Absoluteerrorofpitchcontrolanalysis. strate the effectiveness of our approach in imputing multi-
agent trajectories with not only higher accuracy but also
improved reality. Though our study focused on the perfor-
Approximationofmatchstatistics Inthissection,weex- manceofourframeworkonteamsportsdata,webelieveit
plore howaccurately our method canestimate statistics for canalsobeappliedtootherspatiotemporaldomains.Future
theentirematchwhenimputedtrajectoriesaremergedwith workwillfurtherinvestigateitsapplicationtopracticaltasks
knownobservations.Toelaborate,wecomparethetotaldis- inteamsportsandotherdomainsthatrequirecompletetra-
tance covered by a player and the number of sprints esti- jectoriesofmultipleagents.References Shan, S.; Li, Y.; and Oliva, J. B. 2023. NRTSI: Non-
Cao,W.;Wang,D.;Li,J.;Zhou,H.;Li,L.;andLi,Y.2018.
recurrenttimeseriesimputation.InIEEEInternationalCon-
BRITS: Bidirectional recurrent imputation for time series.
ferenceonAcoustics,SpeechandSignalProcessing.
InAdvancesinNeuralInformationProcessingSystems31. Spearman, W.; Basye, A.; Dick, G.; Hotovy, R.; and Pop,
Choi,M.;andLee,C.2023.ConditionalInformationBottle- P. 2017. Physics-based modeling of pass probabilities in
neckApproachforTimeSeriesImputation. InTheTwelfth soccer. InMITSloanSportsAnalyticsConference.
InternationalConferenceonLearningRepresentations. Sun, F.; Kauvar, I.; Zhang, R.; Li, J.; Kochenderfer, M. J.;
Fang,S.;Wen,Q.;Luo,Y.;Zhe,S.;andSun,L.2024. Bay- Wu, J.; and Haber, N. 2022a. Interaction modeling with
OTIDE: Bayesian Online Multivariate Time series Imputa- multiplexattention.InAdvancesinNeuralInformationPro-
tionwithfunctionaldecomposition. cessingSystems35.
Hochreiter,S.;andSchmidhuber,J.1997. Longshort-term Sun, Q.; Huang, X.; Gu, J.; Williams, B. C.; and Zhao, H.
memory. NeuralComputation. 2022b. M2I: From factored marginal trajectory prediction
tointeractiveprediction. InIEEE/CVFConferenceonCom-
Kamra, N.; Zhu, H.; Trivedi, D.; Zhang, M.; and Liu, Y.
puterVisionandPatternRecognition.
2020. Multi-agent trajectory prediction with fuzzy query
attention. In Advances in Neural Information Processing Teranishi, M.; Tsutsui, K.; Takeda, K.; and Fujii, K. 2022.
Systems33. Evaluation of creating scoring opportunities for teammates
insoccerviatrajectoryprediction. InECMLPKDDWork-
Kingma,D.P.;andWelling,M.2014. Auto-encodingvari-
shoponMachineLearningandDataMiningforSportsAn-
ationalbayes. InProceedingsofthe2ndInternationalCon-
alytics.
ferenceonLearningRepresentations.
Wu, H.; Hu, T.; Liu, Y.; Zhou, H.; Wang, J.; and Long, M.
Kipf,T.N.;Fetaya,E.;Wang,K.;Welling,M.;andZemel,
2023. TimesNet: Temporal 2d-variation modeling for gen-
R. S. 2018. Neural relational inference for interacting sys-
eraltimeseriesanalysis. InThe11thInternationalConfer-
tems. In Proceedings of the 35th International Conference
enceonLearningRepresentations.
onMachineLearning.
Wu,Y.;andSwartz,T.2023. Evaluationofoff-the-ballac-
Le,H.M.;Carr,P.;Yue,Y.;andLucey,P.2017. Data-driven
tionsinsoccer. StatisticaApplicata-ItalianJournalofAp-
ghostingusingdeepimitationlearning.
pliedStatistics.
Lee, J.; Lee, Y.; Kim, J.; Kosiorek, A. R.; Choi, S.; and
Yeh, R. A.; Schwing, A. G.; Huang, J.; and Murphy, K.
Teh, Y. W. 2019. Set Transformer: A Framework for
2019. Diverse generation for multi-agent sports games.
attention-based permutation-invariant neural networks. In
In IEEE/CVF Conference on Computer Vision and Pattern
Proceedings of the 36th International Conference on Ma-
Recognition.
chineLearning.
Zhan, E.; Zheng, S.; Yue, Y.; Sha, L.; and Lucey, P.
Li,J.;Yang,F.;Tomizuka,M.;andChoi,C.2020. Evolve-
2019. Generating multi-agent trajectories using program-
Graph:Multi-agenttrajectorypredictionwithdynamicrela-
maticweaksupervision. InProceedingsofthe7thInterna-
tional reasoning. In Advances in Neural Information Pro-
tionalConferenceonLearningRepresentations.
cessingSystems33.
Liu, S.; Li, X.; Cong, G.; Chen, Y.; and Jiang, Y. 2023a.
Multivariate time-series imputation with disentangled tem-
poralrepresentations. InThe11thInternationalConference
onLearningRepresentations.
Liu, S.; Li, X.; Cong, G.; Chen, Y.; and Jiang, Y. 2023b.
Multivariate time-series imputation with disentangled tem-
poralrepresentations. InTheEleventhinternationalconfer-
enceonlearningrepresentations.
Liu, Y.; Yu, R.; Zheng, S.; Zhan, E.; and Yue, Y. 2019.
NAOMI: Non-autoregressive multiresolution sequence im-
putation. In Advances in Neural Information Processing
Systems32.
Marisca,I.;Cini,A.;andAlippi,C.2022.Learningtorecon-
structmissingdata fromspatiotemporalgraphswith sparse
observations.InAdvancesinNeuralInformationProcessing
Systems35.
Omidshafiei, S.; Hennes, D.; Garnelo, M.; Wang, Z.; Re-
casens, A.; Tarassov, E.; Yang, Y.; Elie, R.; Connor, J.;
Muller,P.;Mackraz,N.;Cao,K.;Moreno,P.;Sprechmann,
P.;Hassabis,D.;Graham,I.;Spearman,W.;Heess,N.;and
Tuyls, K. 2022. Multiagent off-screen behavior prediction
infootball. ScientificReports.A Appendix/SupplementalMaterial
A.1 DatasetStatistics
Dataset Split #Matches #Episodes #Frames
Soccer Train. 2 134 70,119
Valid. 0.5 28 20,690
Test 0.5 34 21,424
Basketball Train. 70 4,835 1,843,329
Valid. 10 687 249,474
Test 20 1,362 529,764
A.Football Train. - 8,500 425,000
Valid. - 1,043 52,150
Test - - -
Table5:Datasetsusedinourexperiments.
Table5providesdetailsoneachdataset,includingthenumberofmatches,episodes,andframes.Thetermepisodeisdefined
asatimeintervalduringwhichthegamewasinplaywithoutanypausesormissingframes.Forthesoccerdataset,matchesare
dividedintoepisodesbasedonthetimesatwhichthegamewaspausedandresumed.Incontrast,forthebasketballdataset,since
mostout-of-playsituationshavealreadybeenexcluded,anepisodeisdefinedasthetimeintervalthatcontainsallconsecutive
timepoints.Whentrainingmodelswitheitherthesoccerorbasketballdatasets,weselectepisodesthatareatleast200frames
inlengthandcreateaPyTorchDatasetbyslidinga200-framewindow(equivalentto20seconds)acrosseachepisodewitha
5-frame (0.5 seconds) overlap, resulting in adjoining windows that share 195 frames. For the American football dataset, we
followtheNRTSIsetting,treatingeachpreprocessed5-secondwindowasanepisode.
A.2 HybridwithstaticorDynamicWeights
Dataset Soccer Basketball AmericanFootball
Scenario Uniform Agent-wise Camera Uniform Agent-wise Uniform Agent-wise
Metric PE SCE PE SCE PE SCE PE SCE PE SCE PE SCE PE SCE
DBHP-S 1.3564 0.0514 2.0192 0.0569 1.3187 0.0589 0.9744 0.0434 1.3882 0.0378 0.1681 0.1378 0.2184 0.1037
DBHP-S2 1.3261 0.0521 1.9891 0.0537 1.2376 0.0379 0.9739 0.0442 1.3885 0.0388 0.1571 0.1159 0.2127 0.0978
DBHP 1.3205 0.0516 1.9832 0.0535 1.2296 0.0374 0.9727 0.0438 1.3862 0.0381 0.1542 0.1126 0.2104 0.0967
Table6:Performanceofhybridpredictionmodelsondifferentdatasetsandmissingscenarios.
Inthissection,weconductadditionalexperimentstovalidatethenecessityofdynamichybridpredictioninthemulti-agent
trajectory imputation task. Accordingly, we introduce another two different hybrid schemes, DBHP-S and DBHP-S2, which
usepredefinedstaticweightsinsteadoflearnableweights.
As defined in the Derivative-Accumulating Prediction in Section 3, let (t , t ) be an arbitrary missing segment for player
s e
k.TheDBHP-SandDBHP-S2arebasedontheassumptionthatDAPsbecomelessaccurateastheycorrespondtotimesteps
furtherawayfromtheobservedanchors(i.e.,pk orpk ).ForDBHP-S,weassignlargeweightstoforwardDAPsneartheleft
ts te
endpoint, to DP in the middle, and to backward DAPs near the right endpoint, respectively. Then, we combine the DP and
bidirectionalDAPsineitherdirectionbypredeterminedweightsasfollows:
 t−t t −t
t −s t pˆk t,d+ tm −t pˆk t,f ift s <t<t m,
pˆk,s = m s m s (18)
t t −t t−t

t
e
−t
pˆk t,d+
t
−tm pˆk t,b ift
m
≤t<t e.
e m e m
wheret =(t +t )/2isthemidpointofthesegment.ForDBHP-S2,weassignlargeweightstoforwardDAPneartheleft
m s e
endpointandtobackwardDAPneartherightendpoint.Foraplayerk’smissingsegment(t t ),wecombineDAPsineither
s e
directionusingpredeterminedweightsasfollows:
t −t t−t
pˆk,s2 = e pˆk,f + s pˆk,b. (19)
t t −t t t −t t
e s e sDP DAP-F DAP-B
0 0 0 1.0
0.8
50 50 50
0.6
100 100 100
0.4
150 150 150
0.2
200 200 200 0.0
0 2 4 6 8 101214161820 0 2 4 6 8 101214161820 0 2 4 6 8101214161820
Agent Agent Agent
0 0 0 1.0
0.8
50 50 50
0.6
100 100 100
0.4
150 150 150
0.2
200 200 200 0.0
0 2 4 6 8 101214161820 0 2 4 6 8 101214161820 0 2 4 6 8101214161820
Agent Agent Agent
Figure6:VisualizationoftheweightsassignedtoeachDP,DAP-F,andDAP-BfortheDBHPmodel.
Table6showsthetrajectoryimputationperformanceofdifferenthybridpredictionmodels.Inmostcases,theperformance
of our proposed DBHP, achieves better results than that of other hybrid models. Figure 6 illustrates the visualization of the
weightsassignedtoeachpredictionintheDBHPmodel.TheweightsofDAPsareheavilyassignedtotheneartheendpoints
ofthemissingsegment,whiletheweightsofDParesignificantlyassignedtothemiddle.
TheseresultsdemonstratethatourDBHPmodelcanappropriatelycombineeachpredictiontofitdiversesituationssuchas
theagents’intensemovementsorthelengthofmissingsegments.Tobespecific,insituationswhereanagentabruptlychanges
directionorundergoessuddenchangesinspeedandacceleration,theDAP’spredictionsmaybecomeinaccurate.Inthesecases,
utilizing the DP prediction could be more accurate. Additionally, as the length of the missing segment increases, the risk of
errorcompoundingintheDAP’spredictionsalsorises.Forthesereasons,itisessentialtodesignamodelthatcanappropriately
adapttothesesituationswhengivenpartialtrajectoriesinmulti-agenttrajectoryimputationtask.
A.3 Impactoflossfunctions
Loss DP DAP-F DAP-B DBHP-S DBHP-S2 DBHP
Ld 1.4903 7.6358 7.6371 2.1680 3.0482 3.9707
Lf 64.3613 1.4092 1.8953 32.4138 1.4077 17.1049
Lb 62.0796 1.8719 1.4615 31.9822 1.4544 17.5418
Ld+Lf 1.3382 1.3511 1.9678 1.3273 1.3897 1.4616
Ld+Lb 1.3799 2.0537 1.3944 1.3824 1.4681 1.5356
Lh 59.3137 3.6357 3.6915 30.1380 1.5318 1.3311
Ld+Lf +Lb+Lh 1.4963 1.4122 1.3982 1.3187 1.2376 1.2296
Table7:Positionerrorsofthemodelstrainedusingdifferentcombinationsofthelossfunction.
WecomparethepredictionsofDP,DAPs,DBHP-S,DBHP-SandDBHPtrainedwithdifferentcombinationsoflossterms.
Table7showsthatDBHPachievesthebestperformancewhenallintroducedlossfunctionsareused.Tobespecific,themodel
trainedwithonlyLd minimizestheMAE(MeanAbsoluteError)betweenthepositionspredictedbyDPandthegroundtruth,
soDAPsbasedonthepredictedderivativesarenottrained.Ontheotherhand,whilemodelstrainedonlywithLf orLbpredict
DAPs better than the model trained only with Ld, the final performance of DBHP is inaccurate as the positions predicted by
DParenottrained.ModelstrainedwithLd+Lf orLd+LbachieveaccuratepredictionsforbothDPandDAPs,eventhough
theweightsbetweenthethreecomponentsarenottrained.Lastly,thecomparisonbetweenthemodeltrainedonlywithLhand
theproposedmodelindicatesthatdirectlyenforcingthepredictionsofDPandDAPswithauxiliarylosstermssuchasLd,Lf,
pets
emiT
pets
emiTand Lb actually helps DBHP achieve better performance. We speculate that the hybrid prediction works much better as the
performanceofeachcomponentimproves.
A.4 AdaptationtoTrajectoryForecasting
Forecastingfuturetrajectoriesofmultipleagentsisanotherimportanttaskforvariousapplicationssuchascrowdnavigation,
autonomousdriving,andbehavioranalysis(Kipfetal.2018;Yehetal.2019;Lietal.2020;Sunetal.2022a).Especially,in
teamsportswearedealingwith,predictingplayers’futuretrajectoriescanserveasatoolforcounterfactualanalysistoevaluate
players’actualmovementscomparedtothe“average”movementsforagivensituation(Leetal.2017;Teranishietal.2022;
WuandSwartz2023).
Thus, we investigate our framework’s ability to adapt to the trajectory forecasting task. Since we cannot access the future
informationintheforecastingtask,wedeployunidirectionalLSTMsinDPandDBHPinsteadofthebidirectionalones.Also,
wemakeDBHPobtainfinalpredictionsonlybasedonDPandDAP-F,i.e.,
pˆk =λk,dpˆk,d+λk,fpˆk,f. (20)
t t t t t
Task Imputation Forecasting
WS 50 100 200 50 100 200
F.Fill 4.1400 7.3255 9.6273 3.0578 6.1874 9.5810
BRITS 3.5872 5.5834 7.3686 6.9112 8.4179 10.6051
DP 0.2749 0.9417 2.1607 0.7035 2.9183 6.9366
DAP 0.2032 0.9011 2.1276 0.4987 2.5613 6.1439
DBHP 0.1460 0.8170 2.0256 0.4987 2.5608 6.1309
Table8:Positionerrorsofthepredictionsmadebythemodelsonthetrajectoryimputationandforecastingtasks.Allsettings
sharethesamemissingrateof0.5.Notethatthemissingsegmentisinthemiddleofthegivenperiodfortheimputationtask,
whileitisfixedtothelatterhalfoftheperiodfortheforecastingtask.
ToevaluatethisDBHPforecaster,wecompareditsperformancewiththatofsomebaselines(forwardfillsandBRITS)which
are applicable to the forecasting task. Specifically, for the soccer dataset with window sizes 50, 100, and 200, we made the
modelsobservethefirsthalfofthetrajectoriesandpredicttheremaininghalf,respectively.Forreference,wealsomeasuredthe
performanceofthetrajectoryimputationmodelstrainedfortheuniformmissingscenariowithamissingrateof0.5.
According to Table 8, our framework consistently outperforms other forecasting baselines, but the performance is worse
than the imputation task with the same setting. In particular, the DBHP forecaster does not improve that much from DAP-
F’s performance as its imputation counterpart does. This is because it cannot leverage information from the future with the
assistanceofDAP-B.Ontheotherhand,itseemsthatDAP-FforecaststrajectoriesmoreaccuratelythanDP,demonstratingthe
effectivenessofusingderivativeinformationfortrajectoryforecasting.
One thing that we want to point out is that predicting players’ future trajectories is a stochastic task since there is great
uncertaintyinthedynamicnatureofsportsgames.Thisimpliesthatthepredictedtrajectoriescanberealisticeveniftheyare
verydifferentfromtruetrajectoriesintermsofpositionerror.Onthisaccount,moststudies(Yehetal.2019;Zhanetal.2019;
Lietal.2020)fortrajectoryforecastingemployarchitecturesbasedonVariationalAutoencoder(VAE)(KingmaandWelling
2014)andmakethemodelgeneratemultipleoutputsforthesameinputtoencouragediversity.Thesearethekeydifferences
fromourtrajectoryimputationtask,whichisratherdeterministicinthatthemissingmovementissomewhatdeterminedgiven
itsstart/endpointsandotherplayers’movements.Weleavefurtherfine-tuningourderivative-basedframeworkandcomparing
itsperformancewithstate-of-the-arttrajectoryforecasters(Yehetal.2019;Zhanetal.2019;Lietal.2020;Sunetal.2022a)
asfuturework.
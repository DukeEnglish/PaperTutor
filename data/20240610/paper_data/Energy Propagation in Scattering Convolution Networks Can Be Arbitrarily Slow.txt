ENERGY PROPAGATION IN SCATTERING CONVOLUTION NETWORKS CAN BE
ARBITRARILY SLOW
HARTMUT FU¨HR, MAX GETTER
Abstract. Weanalyzeenergydecayfordeepconvolutionalneuralnetworksemployedasfeatureextractors,such
asMallat’swaveletscatteringtransform. Fortime-frequencyscatteringtransformsbasedonGaborfilters, ithas
beenestablishedthatenergydecayisexponential,forarbitrarysquare-integrableinputsignals. Ourmainresults
allowtoprovethatthisiswrongforwaveletscatteringinarbitrarydimensions. Inthissetting,theenergydecay
ofthescatteringtransformactingonagenericsquare-integrablesignalturnsouttobearbitrarilyslow. Thefact
that this behavior holds for dense subsets of L2(Rd) emphasizes that fast energy decay is generally not a stable
property of signals.
Wecomplementthesefindingswithpositiveresultsallowingtoconcludefast(uptoexponential)energydecay
for generalized Sobolev spaces that are tailored to the frequency localization of the underlying filter bank.
Bothnegativeandpositiveresultshighlightthatenergydecayinscatteringnetworkscriticallydependsonthe
interplay of the respective frequency localizations of the signal on the one hand, and of the employed filters on
the other.
Keywords: Deep convolutional neural networks, scattering transform, energy propagation, filter banks, wavelets
AMS Subject Classification: Primary: 42C15, 68T07 Secondary: 42C40, 42B35
1. Introduction
1.1. Motivation and related work. Uptothisday, thetremendoussuccessofconvolutionalneuralnetworks
(CNNs) in computer vision tasks [22] like image classification is only partially understood. This outstanding
performance of CNNs is generally believed to be due to their ability to capture information at multiple scales
throughtheuseofconvolutionsandsubsequentlyaggregatingtheinformationobservedatthesescalesbymeans
of further operations such as pooling. Consequently, CNNs are seemingly able to extract semantic content from
imageswhilediscardingirrelevantinformation. However,theavailablerigorousanalyticalexplanationsfortheir
success are still incomplete.
In his pioneering work [11], St´ephane Mallat introduced the scattering transform, a nonlinear operator
that cascades convolutions followed by the modulus non-linearity. The scattering transform can be viewed
as an infinitely deep and infinitely wide CNN with the modulus as non-linearity, predetermined filters, and
no pooling [19]. Due to the use of hand-crafted filters based on a wavelet construction, there is no need to
train the network. The windowed scattering transform was extended in [19] to allow for the use of other
(optionally learned) filters that are not wavelet-generated, with potentially different filters for different layers,
other non-linearities than the modulus, and pooling operations between layers. The present work studies the
scattering transform in a more classical fashion, with, for simplicity of exposition, identical (not necessarily
wavelet-generated) filters across network layers, the modulus as non-linearity, and no pooling.
Despite the absence of a training phase and pooling, Mallat-type scattering networks are still performing
comparablywelltootherstate-of-the-artmodels, evenaftermorethanadecadeofprogressinmachinelearning
since their invention (e.g., [15, 23]). They are used in various applications such as vision and audio tasks,
quantum chemistry, medicine, astronomy, and manifold learning [1, 2, 5, 6, 8, 14, 16, 17]. In many of these,
the scattering transform (or a variant thereof) is employed in the preprocessing phase of the input data in that
1
4202
nuJ
7
]AF.htam[
1v12150.6042:viXra2 HARTMUTFU¨HR,MAXGETTER
it acts as a feature extractor, which is supposed to improve the overall performance of the machine learning
model.
Such scattering networks satisfy many of the nice properties that are generally believed to be essential in
a feature extractor [11, 12, 19, 13]. One of these properties, which is of particular importance both from a
practical as well as a theoretical point of view, is the question of fast energy propagation across the network
layers: Under mild assumptions on the filters, the energy of any input signal decomposes, for every N N,
∈
into the aggregated energy that is contained in the first N layers of the scattering network and some energy
remainder (see Proposition 1.3 for details). Thus, the scattering transform preserves the energy of an input
signal if and only if the corresponding energy remainder converges to zero as N . In this sense, all of the
→ ∞
original information about the input signal is then still contained in the features generated by the scattering
network. In practice, however, only finitely many features of the infinite scattering network can be computed.
Therefore, a lower bound for the loss of information when restricting the network to finitely many features
of the first N layers is given by the corresponding energy remainder. Hence, fast decay of this quantity is
desirable.
Energyconservationintheabovesensewasfirstestablishedin[11, Theorem2.6]forwavelet-generatedfilter
banks under a rather restrictive and technical admissibility assumption. Under less restrictive assumptions on
thewavelets, butonlyindimensiond = 1, thedecayoftheenergyremainderwasshown[18, Theorem3.1]tobe
at least of exponential order (αN) for Sobolev functions with some unspecified, signal-independent α (0,1).
O ∈
In recent years, quantitative results in a similar fashion were also derived for other types of filter banks. Energy
decay was proven (in arbitrary dimension) to be at least of exponential order (αN) for all finite-energy input
O
signals, with some unspecified, signal-independent α (0,1), if the filters of the underlying scattering network
∈
form a so-called uniform covering frame [3, Proposition 3.1]. In particular, this class of filter banks includes
certain Weyl-Heisenberg (Gabor) frames [3, Proposition 2.3]. However, the uniform covering property requires
the Fourier supports of the filters to be uniformly bounded, so that a broad range of commonly used filter
banks in signal processing (e.g., wavelet-generated filter banks) is not adressed by this result.
With refined estimates, but based on an idea similar to that of [18, Theorem 3.1], energy decay was proven
to be at least of exponential order (αN) for Sobolev functions if the filter bank is generated by a bandlimited
O
wavelet in dimension d = 1, with a concretely specified decay factor α that depends on the bandwidth of the
generator [20, Theorem 2], [21, Theorem 3.1]. If the filters do not necessarily have an underlying structure as
in the case of wavelet-generated filters, but instead satisfy certain mild analyticity assumptions in arbitrary
dimension d N, energy decay was shown to be at least of polynomial order (N−m d) for Sobolev functions,
∈ O
where m (0,1] and m 0 as d [20, Theorem 1].
d d
∈ → → ∞
So far, an important question has remained unanswered:
Does exponential energy decay hold for the wavelet scattering transform, globally on L2(Rd)?
1.2. Contributions. Our first main result, Theorem 2.2, provides a negative answer to the question of global
exponential energy decay for the wavelet scattering transform. In fact, we show that energy decay can even
become arbitrarily slow over L2(Rd) when emplyoing filter banks that have an underlying structure similar to
wavelet-generated filter banks (including the latter). It turns out that, for given decay rate, the set of signals
that do not obey this rate in terms of scattering energy decay is dense in L2(Rd). Informally, energy decay can
thus be considered instable over L2(Rd) for these types of scattering networks.
We complement these negative findings with our second main result, Theorem 3.9, which is of positive
nature. By exploiting the interplay between Fourier decay of the input signal and frequency concentration of
the underlying filters of the scattering network, we provide explicit upper bounds on the convergence rates
of the energy remainder for large filter-dependent subclasses of L2(Rd), thereby generalizing, unifying, and
partially improving the findings of the previous works [3, 18, 20, 21].
Inviewofselectingwavelet-generatedfiltersforthescatteringnetwork(asisthecaseinmanyapplications),
these results have two main implications:ENERGY PROPAGATION IN SCATTERING CONVOLUTION NETWORKS 3
Fast energy propagation in wavelet scattering networks can only be guaranteed if a priori knowledge
•
about the global Fourier decay of the input data is available, with sufficient conditions specified by
Corollary 4.7.
The set of those signals in L2(Rd), for which the mixed (ℓ1,L2(Rd)) scattering norm considered in [11,
• Section 2.5] is infinite, is dense in L2(Rd). Results in the spirit of [11, Theorem 2.12], which guarantee
stability of the windowed scattering transform to the action of small diffeomorphisms for signals with
finitemixed(ℓ1,L2(Rd))scatteringnorm,thereforedonotapplytosuch(inthissense)ill-behavedinput
signals. On the other hand, finiteness of this mixed scattering norm can be guaranteed by means of our
positive results, e.g., for all f Hs (Rd), s > 1, which generalizes [13, Proposition 2.4] to arbitrary
dimension d N if the generati∈ ng wlo ag velet is bandlimited.
∈
1.3. Structure of the paper. We begin our exposition in Section 1.5 by reviewing the windowed scattering
transform and clarifying our base assumptions on the underlying filters of the scattering network.
Our results in Section 2 concern filter banks with an inherent structure similar to those generated by
wavelets. The starting point of our analysis is Lemma 2.1, which states an approximate version of super-
additivity of the energy remainder for signals that are nearly separated in freqeuncy domain. We build on
this result by constructing an adversarial signal by means of an infinite series of appropriately chosen, nearly
pairwise separated (in frequency domain) signals.
In Section 3, we derive upper bounds on the decay rate of the energy remainder, which are based on the
interplay between Fourier decay of the input signal and the frequency concentration of the filters. Our results
apply to a broad range of filter banks and their corresponding signal classes. The filters must satisfy a mild
analyticity assumption, which can be seen as a refinement of the setting considered in [20, Assumption 1].
Finally, we illustrate our results in Section 4 by outlining the consequences for a certain class of filters
with uniformly bounded bandwidth, and for wavelet-generated filters. In doing so, we recover some existing
resultsfromtheliterature, andweimproveandgeneralizeothers. Theseresultsareofconsiderableindependent
interest, which is further enhanced by the contrast to the negative findings from Section 2.
1.4. Notation. Fix a dimension d N. The sets Nd Nd Zd Rd Cd have their usual meanings. For
0
S Rd and x Rd, we define S :=∈ s S s x ⊆ for a⊆ ll k ⊆ 1,...⊆ ,d . We denote the Euclidean inner
≥x k k
pro⊆
duct of
two∈
vectors z,w Cd by
z{ ,w∈ :=|(cid:80)d≥
z w , with
a∈ sso{
ciated
n} o}
rm , and the respective open
∈ ⟨ ⟩ k=1 k k ∥·∥2
ball in Rd with radius r > 0 and center x Rd by B (x) Rd. Further, we write (x) := B (x) B (x)
r r,R R r
∈ ⊆ S \
for the closed spherical shell with center x, inner radius r > 0, and outer radius R > 0. For x = 0, we set
:= (0). By 1 , we refer to the indicator function of a set M Rd. If M is Lebesgue-measurable, its
r,R r,R M
S S ⊆
measure is denoted by vol(M) [0, ]. The sphere in Rd is the set Sd−1 := x Rd x = 1 .
As usual, GL (R) is the set∈ of d∞ d invertible matrices with entries from{R,∈ and O| ∥ (R∥ )2 is th} e subgroup of
d d
×
orthogonal matrices. It is well known that any complex matrix A has a singular value decomposition, where
we denote the value of a smallest (respectively largest) singular value of A by σ (A) (respectively σ (A)).
min max
We denote the identity matrix in dimension d by I .
d
ForsequencesE,W : N R,wewriteW (E )ifthereexistC > 0andN NsuchthatW C E
N N 0 N N
→ ∈ O ∈ ≤ ·
holds for all N N . We denote the support of a function f : Rd C by supp(f) := x Rd f(x) = 0 ,
∈
≥N0
→ { ∈ | ̸ }
where the closure is taken with respect to standard Euclidean topology on Rd. For A GL (R), we also define
d
∈
D1f := det(A) f(A ), and D2f := det(A) 1/2f(A ). Moreover, we set f∗ := f( ).
A | | · A | | · −·
For f L1(Rd), we define the Fourier transform of f by
∈
(cid:90)
f( ) := f(cid:98)( ) := f(x) e−2πi⟨x,·⟩dx.
F · · Rd4 HARTMUTFU¨HR,MAXGETTER
The Fourier transform extends uniquely to a unitary automorphism of L2(Rd) by this choice of normalization.
Its inverse is the unique operator extension of the inverse Fourier transform given by
(cid:90)
−1f( ) := f(cid:98)( ) = f(x) e2πi⟨x,·⟩dx.
F · −· Rd
If ω : (0, ) (0, ) is a nondecreasing function, we define
∞ → ∞
(cid:110) (cid:12) (cid:111)
L2(Rd) := f L2(Rd) (cid:12) ω( )f(cid:98) L2(Rd) .
F ω ∈ (cid:12) ∥·∥2 ∈
For s > 0, setting ω s(t) := (1+t2)2s , the fractional Sobolev space of class regularity s is Hs(Rd) := FL2 ωs(Rd).
We define the s-fractional Log-Sobolev space by Hs (Rd) := L2 (Rd), where ω (t) := lns(e+t). Fur-
log F ω s,log s,log
thermore, let S(Rd) denote the Schwartz space on Rd. For a Hilbert space and a countable set Λ, we
H
define
(cid:40) (cid:12) (cid:41)
(cid:12) (cid:88)
ℓ2( ) := ℓ2(Λ; ) := f = (f ) Λ (cid:12) f 2 < ,
H H λ λ∈Λ ∈ H (cid:12) ∥ λ ∥H ∞
(cid:12)
λ∈Λ
whichitselfisaHilbertspace,equippedwiththeinnerproductgivenby f,g := (cid:80) f ,g forf,g ℓ2( )
⟨ ⟩ λ∈Λ⟨ λ λ ⟩ ∈ H
(with unconditional convergence of the series).
1.5. A brief review of the windowed scattering transform. A scattering network computes cascades of
convolutions followed by the application of the modulus as non-linearity, with no pooling between the layers.
Given any ψ L1(Rd) L2(Rd), we denote by
∈ ∩
U[ψ] : L2(Rd) L2(Rd), f f ψ
→ (cid:55)→ | ∗ |
the single step scattering propagator associated to filtering with the function ψ (which in this context is thus
commonly called a filter). Moreover, we refer to an ordered sequence p = (ψ ,...,ψ ) (L1(Rd) L2(Rd))N
1 N
as a path of length N N. Iterating the single step scattering propagators along this pat∈ h yields th∩ e scattering
∈
propagator
U[p] : L2(Rd) L2(Rd), f U[ψ ]...U[ψ ]f = ... f ψ ... ψ .
N 1 1 N
→ (cid:55)→ | | ∗ | ∗ |
For notational convenience, we define the scattering propagator along the empty path e (the unique path of
length zero) to be the identity operator U[e] := id L2(Rd).
A designated function χ L1(Rd) L2(Rd) induces a windowed scattering propagator along a path p of
length N N and window χ∈ (referred t∩ o as output-generating filter), given by
∈
S[p;χ] : L2(Rd) L2(Rd), f (U[p]f) χ = ... f ψ ... ψ χ.
1 N
→ (cid:55)→ ∗ | | ∗ | ∗ |∗
By Young’s convolution inequality, the operators U[p] and S[p;χ] are well-defined.
Our main objective is to study the properties of the operators (see Figure 1)
U[P] : L2(Rd) ℓ2(P;L2(Rd)), f (U[p]f)
→ (cid:55)→ p∈P
and
S[P;χ] : L2(Rd) ℓ2(P;L2(Rd)), f (S[p;χ]f)
→ (cid:55)→ p∈P
for certain path sets P. In particular, this requires the operators to be well-defined in the sense that, for any
f L2(Rd), the series (cid:80) U[p]f 2 converges unconditionally. In this respect, let us now state our main
∈ p∈P ∥ ∥2
requirement on the filters, which are the basic building blocks of the windowed scattering transform.
Throughout this paper, we assume that F := χ Ψ L1(Rd) L2(Rd) is a countably infinite collection
{ }∪ ⊂ ∩
of functions so that the corresponding filter transform
(1) L2(Rd) ℓ2(F;L2(Rd)), f (f χ) (f ψ)
→ (cid:55)→ ∗ ∪ ∗ ψ∈ΨENERGY PROPAGATION IN SCATTERING CONVOLUTION NETWORKS 5
f ψ ψ , f ψ ψ χ f ψ ψ , f ψ ψ χ f ψ ψ , f ψ ψ χ
|| ∗
1
|∗
2
| || ∗
1
|∗
2
|∗ || ∗
1
|∗
2′
| || ∗
1
|∗
2′
|∗ || ∗
1′
|∗
2
| || ∗
1′
|∗
2
|∗
f ψ , f ψ χ f ψ , f ψ χ
| ∗
1
| | ∗
1
|∗ | ∗
1′
| | ∗
1′
|∗
f, f χ
∗
Fig. 1. Illustration of the operators U[P],S[P;χ] for the path set P = e,ψ ,ψ ,(ψ ,ψ ),(ψ ,ψ ),(ψ ,ψ )
{
1 1′ 1 2 1 2′ 1′ 2
}
and output-generating filter χ.
is an isometry. This is precisely the case if F forms a semi-discrete Parseval frame [10, Section 5.1.5], i.e., if for
all f L2(Rd),
∈
(cid:88)
2 2 2
(2) f χ + f ψ = f .
∥ ∗ ∥2 ∥ ∗ ∥2 ∥ ∥2
ψ∈Ψ
We will frequently use the fact (which follows directly from Parseval’s theorem and the convolution theorem)
that F forms a semi-discrete Parseval frame if and only if F satisfies the Littlewood-Paley condition
(cid:88)
(3) χ (cid:98)(ξ) 2+ ψ(cid:98)(ξ) 2 = 1 a.e. ξ Rd.
| | | | ∈
ψ∈Ψ
If any of the latter equivalent conditions holds, then every f L2(Rd) admits a decomposition
∈
(cid:88)
(4) f = f χ χ∗+ f ψ ψ∗.
∗ ∗ ∗ ∗
ψ∈Ψ
Remark 1.1. To simplify the notation, we do not assign the filters Ψ an explicit (countably infinite) index set,
unless we work in a more concrete setting. This precludes the use of multiple occurrences of the same filter,
which is often allowed in the definition of the scattering transform. In principle, this can be accommodated,
primarily at notational cost, by extending the subsequent discussion to multisets. To us the benefit of such an
extension seems quite limited, which is why we have refrained from making the necessary adjustments.
WewillmainlyconsidertheoperatorsU[P]andS[P;χ]onnonemptysubsetsP ofthesetofallfinitelength
scattering paths := (cid:83)∞ ΨN, where we set Ψ0 := e . The windowed scattering transform associated with
PΨ N=0 { }
the filters F is the operator
(5) [F] := S[ ;χ] : L2(Rd) ℓ2( ;L2(Rd)), f (S[p;χ]f) .
S PΨ → PΨ (cid:55)→ p∈PΨ
In the interest of generality, we do not make further assumptions on the Parseval frame F for now. Even in this
very general setting, the windowed scattering transform [F] (see Figure 2) is always a well-defined operator
into the Hilbert space ℓ2( ;L2(Rd)). This will be adressS ed in more detail by Proposition 1.3.
Ψ
P
Typically, the filters are concentrated in different areas in frequency domain, with χ taking on the special
role of a low-pass filter and the remaining filters Ψ being of high-pass nature. For the sake of concreteness and
later use, let us give one particular example of an admissible collection F in dimension d = 1, where in this
case F is generated from a bandlimited wavelet.
Example 1.2. Let ψ,ϕ L1(R) L2(R) satisfy supp(ψ(cid:98)) [1,2] and
∈ ∩ ⊆ 2
∞
(cid:88)(cid:16) (cid:17)
ϕ(cid:98)(ξ) 2+ ψ(cid:98)(2−j ξ) 2+ ψ(cid:98)( 2−j ξ) 2 = 1, a.e. ξ R.
| | | · | | − · | ∈
j=16 HARTMUTFU¨HR,MAXGETTER
f ψ ψ ψ f ψ ψ ψ
||| ∗
1
|∗
2
|∗
3
| ||| ∗
1′
|∗
2′
|∗
3′
|
... ...
f ψ ψ f ψ ψ
|| ∗
1
|∗
2
| • • || ∗
1′
|∗
2′
|
f ψ ψ χ f ψ ψ χ
|| ∗
1
|∗
2
|∗ || ∗
1′
|∗
2′
|∗
f ψ f ψ
| ∗
1
| • | ∗
1′
|
f ψ χ f f ψ χ
| ∗
1
|∗ | ∗
1′
|∗
f χ
∗
Fig. 2. Indication of the architecture of a scattering network as described above, with filters ψ ,ψ Ψ
j j′
∈
corresponding to the j-th network layer, j 1,2,3 . The function χ is the output-generating filter,
∈ { }
which is (in our setup) the same across all layers.
Such a pair of functions arises, e.g., from the construction of an orthogonal wavelet basis, with father wavelet
(scaling function) ϕ and mother wavelet ψ. Then, F := χ ψ j Z 0 is a semi-discrete Parseval
j
{ }∪{ | ∈ \{ }}
frame, where χ := ϕ and
(cid:40)
D1 ψ = 2jψ(2j ) for j N
ψ := 2j · ∈ .
j D1 ψ( ) = 2|j|ψ( 2|j| ) for j Z
2|j| −· − · ∈ <0
The filter transform is in this case the associated wavelet transform.
The following proposition, which was first stated in (the proof of) [11, Theorem 2.6] and later generalized
in [19, Proposition 1] and [20, Proposition 1], forms the basis for all further analysis in this paper.
Proposition 1.3. Every f L2(Rd) satisfies the energy decomposition, for all N N ,
0
∈ ∈
N−1
(6) (cid:88) ∥S[Ψn;χ]f ∥2 ℓ2(Ψn;L2(Rd))+(cid:13) (cid:13)U[ΨN]f(cid:13) (cid:13)2
ℓ2(ΨN;L2(Rd))
= ∥f ∥2 2.
n=0
Consequently,
[F]f f ,
∥S ∥ℓ2(PΨ;L2(Rd)) ≤ ∥ ∥2
which ensures the well-definedness of the operator [F] : L2(Rd) ℓ2( ;L2(Rd)).
Ψ
S → P
Moreover,
(7) lim
(cid:13) (cid:13)U[ΨN]f(cid:13) (cid:13)2
= 0
N→∞
ℓ2(ΨN;L2(Rd))
holds if and only if
(8) [F]f 2 = f 2 .
∥S ∥ℓ2(PΨ;L2(Rd)) ∥ ∥2
The energy decomposition identity (6) quantifies the loss of information about the original input signal f
if the scattering network is restricted to its first N layers. Motivated by this important relationship, let us
therefore define the quantity, for any given = Φ F and N N ,
0
∅ ̸ ⊆ ∈
W N[Φ](f) :=
(cid:13) (cid:13)U[ΦN]f(cid:13) (cid:13)2
ℓ2(ΦN;L2(Rd))
=
(cid:88)
∥U[p](f)
∥2
2.
p∈ΦNENERGY PROPAGATION IN SCATTERING CONVOLUTION NETWORKS 7
Our main objective in this paper is to study the asymptotic behavior of the quantity W [Ψ](f) as N ,
N
→ ∞
which, as we will show, distinctively depends on the interplay between the choice of filters Ψ and the input
signal f. If there is no ambiguity about the underlying filters Ψ, we will sometimes only write W (f) to refer
N
to W [Ψ](f).
N
As already pointed out in Section 1.1, there are several sufficient criteria for F available that guarantee the
asymptotic energy decay (7). More precisely, [18, Theorem 3.1] and [20, Theorem 1, Theorem 2] state an upper
bound on W [Ψ](f), for all f L2(Rd) and N N , which is of the type
N ≥2
∈ ∈
(cid:90)
(9) W N[Ψ](f) f(cid:98)(ξ) 2 K N(ξ)dξ
≤ Rd| | ·
for a family of integral kernels (K N) N∈N (independent of f) that satisfy the following properties:
≥2
For all N N , K is continuous.
≥2 N
• For all N ∈ N , 0 K K 1.
≥2 N+1 N
• lim K∈ (ξ) = 0≤ holds po≤ intwise≤ for all ξ Rd.
N→∞ N
• ∈
By Dini’s theorem [4, Theorem 7.3], this upper integral bound entails, for all f L2(Rd), the convergence
∈
(7) (cf. [20, Proposition 2]). In particular, the scattering transform [F] is norm-preserving in these settings
S
by Proposition 1.3. Specifically the assumptions of [20, Theorem 1] allow for some flexibility in the choice
of the filters while guaranteeing norm-preservation. Clearly, this implies that the single signal that produces
zero-features in every layer by means of the scattering transform is the trivial null-signal f = 0.
In order to produce many informative (in the sense of nontrivial) features by means of the scattering
transform, one typically chooses an output-generating filter χ that is of low-pass type. By the Littlewood-
Paley condition (3), the remaining filters Ψ are automatically of high-pass nature. Let us briefly illustrate how
informativeness of [F] can be achieved by imposing a low-pass condition on χ: Let 0 = g,χ L1(Rd) L2(Rd)
S ̸ ∈ ∩
and suppose that χ(0) = 0. By continuity of χ and ( g ), and since ( g )(0) = g > 0, there exist ε,δ > 0
(cid:98) ̸ (cid:98) F | | F | | ∥ ∥1
such that χ ( g ) ε on B (0). Thus, we have
(cid:98) δ
| |·|F | | | ≥
(cid:90)
g χ 2 = ( g ) χ 2 ( g )(ξ) 2 χ(ξ) 2dξ ε2 vol(B (0)) > 0.
∥| |∗ ∥2 ∥F | | · (cid:98) ∥2 ≥ |F | | | ·|(cid:98) | ≥ · δ
B (0)
δ
Hence, any feature of this type is nontrivial. The assumption that χ(0) = 0 is of vital importance for the
(cid:98)
̸
argument, as is shown in [20, Appendix A] by the example of a scattering network (feature extractor) with
nontrivial kernel.
For the remainder of this section, we will collect some basic auxiliary statements about the windowed
scattering transform that will prove useful later. We include their proofs for self-containment.
Lemma 1.4. Let N N. Then U[FN] : L2(Rd) ℓ2(F;L2(Rd)) is well-defined and norm-preserving, i.e., for
all f L2(Rd), ∈ →
∈ (cid:88)
W [F](f) = U[p]f 2 = f 2 .
N ∥ ∥2 ∥ ∥2
p∈FN
Proof. This is easily shown by induction: The base case N = 1 is exactly one of the characterizations of a
semi-discrete Parseval frame, hence true for F. The induction step is established as follows. Suppose that the
statement is true for some N N. Then, for all f L2(Rd), we have
∈ ∈
(cid:88) (cid:88) (cid:88)
W [F](f) = W [F]( f ψ ) = f ψ 2 = f ψ 2 = f 2 .
N+1 N | ∗ | ∥| ∗ |∥2 ∥ ∗ ∥2 ∥ ∥2
ψ∈F ψ∈F ψ∈F
□
Despite its simplicity and brevity, the argument illustrates how the underlying inductive structure of the
scattering network can be exploited in proofs. The following Proposition (cf. [11, Proposition 2.5]) states
the non-expansiveness of the operators U and S, which is also due to their inductive definition. Considering8 HARTMUTFU¨HR,MAXGETTER
the desirable properties of the scattering transform as a feature extractor, this property can be considered as
stability against additive noise.
Proposition 1.5. Let = P ΨN for some N N . Then, for all f,g L2(Rd),
0
∅ ̸ ⊆ ∈ ∈
S[P;χ]f S[P;χ]g U[P]f U[P]g f g .
∥ − ∥ℓ2(P;L2(Rd)) ≤ ∥ − ∥ℓ2(P;L2(Rd)) ≤ ∥ − ∥2
Moreover, if [F] = S[ ;χ] is norm-preserving, then it is also nonexpansive.
Ψ
S P
Proof. By the Littlewood-Paley condition (3), we have χ 1. Thus, for all p P, and all f,g L2(Rd),
∥(cid:98) ∥∞ ≤ ∈ ∈
S[p;χ]f S[p;χ]g = (U[p]f U[p]g) χ U[p]f U[p]g ,
∥ − ∥2 ∥ − ∗ ∥2 ≤ ∥ − ∥2
which proves the first inequality.
Observe that it suffices to prove the second inequality for the case P = ΨN, which we do by induction on
N N . The base case N = 0 is trivial. For the purpose of the induction step, suppose that the hypothesis is
0
tru∈ e for some N N . By the reverse triangle inequality, we have, for all f,g L2(Rd),
0
∈ ∈
U[ΨN+1]f U[ΨN+1]g 2
|| −
||ℓ2(ΨN+1;L2(Rd))
(cid:88) (cid:88)
2
= (U[p]f) ψ (U[p]g) ψ
∥| ∗ |−| ∗ |∥2
p∈ΨNψ∈Ψ
(cid:88) (cid:88)
2
(U[p]f U[p]g) ψ
≤ ∥| − ∗ |∥2
p∈ΨNψ∈Ψ
(cid:88) (cid:88)
2
= (U[p]f U[p]g) ψ
∥ − ∗ ∥2
p∈ΨNψ∈Ψ
(cid:88)
2 2
= ( U[p]f U[p]g S[p;χ]f S[p;χ]g )
∥ − ∥2−∥ − ∥2
p∈ΨN
= (cid:13) (cid:13)U[ΨN]f U[ΨN]g(cid:13) (cid:13)2 (cid:13) (cid:13)S[ΨN;χ]f S[ΨN;χ]g(cid:13) (cid:13)2 ,
−
ℓ2(ΨN;L2(Rd))−
−
ℓ2(ΨN;L2(Rd))
where the second last step is due to F being a frame. Applying the induction hypothesis to the right-hand side
of the latter inequality concludes this part of the proof.
Finally, if [F] is norm-preserving, the non-expansiveness of [F] follows directly from the above estimates
S S
(which were derived independent of the induction hypothesis) using a telescoping series argument. In fact, by
Proposition 1.3, we have lim W [Ψ](h) = 0 for all h L2(Rd), which entails that, for all f,g L2(Rd),
N→∞ N
∈ ∈
lim (cid:13) (cid:13)U[ΨN]f U[ΨN]g(cid:13) (cid:13)2 = 0.
N→∞ −
ℓ2(ΨN;L2(Rd))
Consequently,
[F]f [F]g 2
||S −S
||ℓ2(PΨ;L2(Rd))
∞
= (cid:88) (cid:13) (cid:13)S[ΨN;χ]f S[ΨN;χ]g(cid:13) (cid:13)2
−
ℓ2(ΨN;L2(Rd))
N=0
∞
(cid:88) (cid:16)(cid:13) (cid:13)U[ΨN]f U[ΨN]g(cid:13) (cid:13)2 (cid:13) (cid:13)U[ΨN+1]f U[ΨN+1]g(cid:13) (cid:13)2 (cid:17)
≤ −
ℓ2(ΨN;L2(Rd))−
−
ℓ2(ΨN+1;L2(Rd))
N=0
2
= f g .
∥ − ∥2
□
We exploit the non-expansiveness of U to derive some useful estimates concerning the energy remainder.ENERGY PROPAGATION IN SCATTERING CONVOLUTION NETWORKS 9
Lemma 1.6. Let = Φ Ψ, and let N N. Then, we have, for all f,g L2(Rd),
∅ ̸ ⊆ ∈ ∈
(cid:112)
a) W [Φ](f) W [Φ](g) √2 f g W [Φ](f)+W [Φ](g),
| N − N | ≤ ·∥ − ∥2· N N
b) W [Φ](f) 1 W [Φ](g) f g 2 .
N ≥ 2 · N −∥ − ∥2
Proof. Let f,g L2(Rd). Applying the reverse triangle inequality yields, for any p ΦN,
∈ ∈
2 2
U[p]f U[p]g = U[p]f U[p]g ( U[p]f + U[p]g )
|∥ ∥2−∥ ∥2| |∥ ∥2−∥ ∥2|· ∥ ∥2 ∥ ∥2
U[p]f U[p]g ( U[p]f + U[p]g ).
≤ ∥ − ∥2· ∥ ∥2 ∥ ∥2
Together with the Cauchy-Schwarz inequality and the non-expansiveness of U[ΦN], we obtain
(cid:12) (cid:12)2
(cid:12) (cid:12)
|W N[Φ](f) −W N[Φ](g) |2 = (cid:12) (cid:12)
(cid:12)
(cid:88) ∥U[p]f ∥2 2−∥U[p]g ∥2 2(cid:12) (cid:12)
(cid:12)
(cid:12)p∈ΦN (cid:12)
 2
(cid:88)
 U[p]f U[p]g ( U[p]f + U[p]g )
≤ ∥ − ∥2· ∥ ∥2 ∥ ∥2
p∈ΦN
   
(cid:88) (cid:88)
2 2
 U[p]f U[p]g   ( U[p]f + U[p]g ) 
≤ ∥ − ∥2 · ∥ ∥2 ∥ ∥2
p∈ΦN p∈ΦN
(cid:88) (cid:16) (cid:17)
2 2 2
f g 2 U[p]f +2 U[p]g
≤ ∥ − ∥2· ∥ ∥2 ∥ ∥2
p∈ΦN
2
= 2 f g (W [Φ](f)+W [Φ](g)).
∥ − ∥2· N N
Taking square roots on both sides of the latter inequality proves a).
We again use the non-expansiveness of U[Φ] and find that
W N[Φ](g) = (cid:13) (cid:13)U[ΦN](g) −U[ΦN](f)+U[ΦN](f)(cid:13) (cid:13)2
ℓ2(ΦN;L2(Rd))
(cid:16)(cid:13) (cid:13)U[ΦN](g) U[ΦN](f)(cid:13)
(cid:13)
+(cid:13) (cid:13)U[ΦN](f)(cid:13)
(cid:13)
(cid:17)2
≤ −
ℓ2(ΦN;L2(Rd)) ℓ2(ΦN;L2(Rd))
(cid:16)
g f
+(cid:13) (cid:13)U[ΦN](f)(cid:13)
(cid:13)
(cid:17)2
≤ ∥ − ∥2 ℓ2(ΦN;L2(Rd))
2 f g
2 +2(cid:13) (cid:13)U[ΦN](f)(cid:13) (cid:13)2
≤ ∥ − ∥2 ℓ2(ΦN;L2(Rd))
2
= 2 f g +2W [Φ](f).
∥ − ∥2 N
By rearranging, we conclude the proof of b). □
It is now easy to derive the continuity of W [Φ], which we will use to prove the density result, Proposition
N
2.3, in Section 2.
Corollary 1.7. Let = Φ Ψ, and let N N. Then, W [Φ] : L2(Rd) R is continuous.
N
∅ ̸ ⊆ ∈ →
Proof. Continuity at f = 0 is obvious, since we have, for all g L2(Rd), W [Φ](g) g 2 . Now, fix ε > 0 and
∈ N ≤ ∥ ∥2
f L2(Rd) 0 . Define
∈ \{ }
(cid:40) (cid:41)
ε
δ = δ(f,ε) := min , f > 0.
√10 f ∥ ∥2
∥ ∥210 HARTMUTFU¨HR,MAXGETTER
Applying Lemma 1.6a) to g L2(Rd) with f g < δ gives
∈ ∥ − ∥2
W [Φ](f) W [Φ](g) 2 2 f g 2 (W [Φ](f)+W [Φ](g))
| N − N | ≤ ∥ − ∥2· N N
2δ2 ( f 2 + g 2 )
≤ · ∥ ∥2 ∥ ∥2
2δ2 ( f 2 +( f +δ)2)
≤ · ∥ ∥2 ∥ ∥2
10δ2 f 2 ε2.
≤ ·∥ ∥2 ≤
□
We conclude this section with a lemma describing the interplay of the scattering propagator with dilations,
which is similar to covariance (cf. [11, Equation (20)]). Despite its elementary proof, this property forms the
basis for our main result in Section 2.
Lemma 1.8. Let N N, let p (L1(Rd) L2(Rd))N, and let A GL (R). Then, for all f L2(Rd),
d
∈ ∈ ∩ ∈ ∈
U[p]D1f = D1U[D1 p]f,
A A A−1
where D1 p := (D1 p ,...,D1 p ). Moreover, if = Φ F, then we have, for all f L2(Rd),
A−1 A−1 1 A−1 N ∅ ̸ ⊆ ∈
W [Φ](D2f) = W [D1 Φ](f).
N A N A−1
Proof. Let f L2(Rd), and let g L1(Rd) L2(Rd). A direct computation shows that
∈ ∈ ∩
(D1f) g = D1(f (D1 g)).
A
∗
A
∗
A−1
The modulus operator
M : L2(Rd) L2(Rd), h h
→ (cid:55)→ | |
commutes with D1, which proves U[g]D1f = D1U[D1 g]f. Iterating this relation along the path p concludes
A A A A−1
the first identity.
Concerning the second, we note that D A1 = |det(A) |21 ·D A2, which gives U[p]D A2 = D A2U[D A1 −1p]. Since D A2
is unitary on L2(Rd), summing over all paths in ΦN entails the second identity. □
2. Slow Scattering Propagation
In this section, we show that energy propagation can be arbitrarily slow in scattering networks that employ
filters F = χ Ψ with an underlying structure similar to those generated by wavelets.
{ }∪
Assomeofthedetailsofthissectionarequitetechnical, webeginbyillustratingtheconceptualideabehind
them. In light of this, let us consider the situation from Example 1.2 again, i.e., suppose that the high-pass
filters Ψ = {ψ
j
|
j
∈
Z \{0
}}
are generated by dilations of ψ
∈
L1(R) ∩L2(R), supp(ψ(cid:98))
⊆
[ 21,2], according to
(cid:40)
D1 ψ = 2jψ(2j ) for j N
ψ := 2j · ∈ .
j D1 ψ( ) = 2|j|ψ( 2|j| ) for j Z
2|j| −· − · ∈ <0
We want to show that for any nonincreasing null-sequence E RN , there exists a function f L2(R) that
>0 E
∈ ∈
satisfies the following conditions:
2
a) We have f = E .
∥ E ∥2 1
b) For all N N, we have that W [Ψ](f) 1 E .
∈ N ≥ 2 · N
Proof sketch. Define
(cid:16)(cid:112) (cid:17)
(a k) k∈N := E k E k+1 ,
− k∈NENERGY PROPAGATION IN SCATTERING CONVOLUTION NETWORKS 11
and note that a telescoping argument gives
N
(cid:88)
lim a2 = lim E E = E .
k 1 N+1 1
N→∞ N→∞ −
k=1
F 4.i 7x )a sn hy owf
0 t∈
haL t,2( fR or) at lh la Ntsat Nisfi ,es ∥f
0 ∥2
= 1andsupp(f(cid:98)0)
⊆
[1,2]. Wewilllater(seeCorollary2.8andCorollary
∈
lim W (f ) = 1,
N m
m→∞
where f := 2m/2f (2m ), m N. This is a consequence of Lemma 1.8.
m 0
Therefore, we can fin· d a st∈ rictly increasing sequence (m k) k∈N N such that, for all k N, m k+1 2+m k
and W (f ) 1. We claim that ⊆ ∈ ≥
k m k ≥ 2
∞
(cid:88)
f := a f L2(R)
E k m k ∈
k=1
does the job. To this end, first note that, for all m N, supp(f(cid:99)m) [2m,2m+1]. In particular, the (f m) m∈N
are orthonormal, hence f 2 = (cid:80)∞ a 2 = E . M∈ oreover, since ⊆
∥ E ∥2 k=1| k | 1
supp(ψ(cid:99)j) [sgn(j) 2|j|−1,sgn(j) 2|j|+1],
⊆ · ·
we have

a f ψ if j = m for some k N
  k m k ∗ m k k ∈
f ψ = a f ψ if j = m +1 for some k N , j Z 0 .
E ∗ j  k m k ∗ m k+1 k ∈ ∈ \{ }
0 else
Altogether, we obtain, for all N N,
∈
(cid:88)
W (f ) = W ( f ψ )
N E N−1 E j
| ∗ |
j∈Z\{0}
∞
(cid:88)
= (W ( a f ψ )+W ( a f ψ ))
N−1 | k m k ∗ m k| N−1 | k m k ∗ m k+1 |
k=1
∞
(cid:88)
= a 2 (W ( f ψ )+W ( f ψ ))
| k | · N−1 | m k ∗ m k| N−1 | m k ∗ m k+1 |
k=1
∞ ∞ ∞
(cid:88) (cid:88) 1 (cid:88) 1
= a 2 W (f ) a 2 W (f ) a 2 = E .
| k | · N m k ≥ | k | · k m k ≥ 2 · | k | 2 · N
k=1 k=N k=N
□
To summarize, the central idea of the proof is as follows: Given δ > 0, construct a sequence of signals
(f m k) k∈N
⊆
L2(R) such that (i) the energy remainder W N behaves (super-)additively due to separation in the
frequency domain and (ii) the energy decays slowly for f across the first k layers of the scattering network,
m
k
according to W (f ) δ. Weighting the signals with an ℓ2-sequence ensures square-integrability of f . The
k m k ≥ E
energy that is contained in the scattering layers of f of depth greater than N 1 (i.e., W (f )) is controlled
E N E
−
by the weighted energy remainders of the signals (f ) . This results in a slow propagation of energy across
m k k≥N
allnetworklayers. Thespeedof convergenceis boundedfrom belowbythe speed ofconvergence oftheℓ2-series
of the chosen weights.
In order to generalize this idea to larger classes of filter banks and higher dimensions, we need to establish
a much more general version of super-additivity for the family of nonlinear operators (W
N
: L2(Rd) R) N∈N.
→
In the proof sketch above, we have implicitly used their additivity on separated signals (cf. [13, Lemma 2.3]).12 HARTMUTFU¨HR,MAXGETTER
However, if the generator ψ fails to be bandlimited, we cannot generally expect exact additivity on separated
signals. Moreover, we would like to allow for more flexibility in the choice of our filter bank. The following
lemma establishes an approximate version of super-additivity for the operators (W N) N∈N if the signals are
nearly separated in Fourier domain. We use the high-pass filters Ψ to measure the degree of separation.
L the em rem exa is2 t. fi1 n. itL eet seF ts= Ψ(( Ff k ,) kk )∈N 0 Ψ⊂ ,L k2(R Nd),
,
l se ut ch(η tk h) ak∈ tN t0 he∈ foR lN > lo0 0 w, ia nn gd hl oe lt d:a = (a k) k∈N 0 ∈ ℓ2(N 0;C). Assume that
0
⊆ ∈
(i) The series
(cid:80)∞
a a f ,f converges.
k,j=0| k j ⟨ k j ⟩|
(ii) The series
(cid:80)∞
ε converges, where ε := (k+1) η
+(cid:80)∞
η .
k=0 k k · k j=k+1 j
(iii) The sets Ψ(F,k), k N , are pairwise disjoint.
0
∈
(iv) We have, for every k N ,
0
∈
(cid:88)
2
f ψ η .
∥ k ∗ ∥2 ≤ k
ψ∈Ψ\Ψ(F,k)
(v) We have, for every k N and 0 j < k,
0
∈ ≤
(cid:88)
2
f ψ η .
∥ j ∗ ∥2 ≤ k
ψ∈Ψ(F,k)
Then, the series
∞
(cid:88)
f := a f
k k
k=0
converges in L2(Rd) with f 2 (cid:80)∞ a a f ,f , and we have, for every N N, n N ,
∥ ∥2 ≤ k,j=0| k j ⟨ k j ⟩| ∈ ∈ 0
(cid:88)∞ (cid:18) a
k
2
2
(cid:19)
(10) W (f) | | W (f ) 2 a ε .
N
≥ 2 ·
N k
− ∥
∥ℓ2(C)· k
k=n
Moreover, suppose that in addition to our standing assumptions (i)-(v) there exists δ > 0 such that
(vi) for all k N,
∈
W (f ) 4δ.
k k
≥
(vii) for all k N,
∈
δ a 2
k
ε ·| | .
k ≤ 2 a 2
∥
∥ℓ2(C)
Then we even have, for all N N,
∈
∞
(cid:88)
(11) W (f) δ a 2.
N k
≥ · | |
k=N
Proof. The series defining f converges if
(cid:13) (cid:13)
m
(cid:13) (cid:13)(cid:88) a f (cid:13) (cid:13) n,m→∞ 0.
(cid:13) k k(cid:13)
−−−−−→
(cid:13) (cid:13)
k=n 2
Expanding the latter norm squared yields
(cid:13)
m
(cid:13)2
m ∞
(cid:13)(cid:88) (cid:13) (cid:88) (cid:88)
(12) (cid:13) a f (cid:13) = a a f ,f a a f ,f .
(cid:13) k k(cid:13) k j k j k j k j
·⟨ ⟩ ≤ | ·⟨ ⟩|
(cid:13) (cid:13)
k=n 2 k,j=n k,j=nENERGY PROPAGATION IN SCATTERING CONVOLUTION NETWORKS 13
Being the remainder of a convergent series by assumption (i), the right-hand side of (12) converges to 0, so
that f is in fact a well-defined element of L2(Rd). Setting n = 0 in (12), we also obtain the claimed bound for
the (squared) norm of f as m .
→ ∞
Let us now turn to the proof of (10). Here, we first note that the recursive nature of W and Lemma 1.6
N
b) imply
(cid:88)
W (f) = W ( f ψ )
N N−1
| ∗ |
ψ∈Ψ
∞
(cid:88) (cid:88)
W ( f ψ )
N−1
≥ | ∗ |
k=nψ∈Ψ(F,k)
∞ (cid:18) (cid:19)
(cid:88) (cid:88) 1
2
W ( (a f ) ψ ) f ψ (a f ) ψ
≥ 2 · N−1 | k k ∗ | −∥| ∗ |−| k k ∗ |∥2
k=nψ∈Ψ(F,k)
(cid:88)∞ (cid:88) (cid:18) a k 2 2(cid:19)
| | W ( f ψ ) (f a f ) ψ
≥ 2 · N−1 | k ∗ | −∥ − k k ∗ ∥2
k=nψ∈Ψ(F,k)
 
(cid:88)∞ a k 2 (cid:88)
(13) = | | W N−1( f
k
ψ ) Rest k.
2 | ∗ | −
k=n ψ∈Ψ(F,k)
As a consequence of our assumptions (iii)-(v), the remainder is bounded by
(cid:13)  (cid:13)2
(cid:13) ∞ (cid:13)
(cid:88) (cid:13) (cid:88) (cid:13)
Rest k = (cid:13) a jf j ψ(cid:13)
(cid:13) ∗ (cid:13)
ψ∈Ψ(F,k)(cid:13) j=0,j̸=k (cid:13)
2
 2
∞
(cid:88) (cid:88)
≤
 |a j |·∥f j ∗ψ ∥2
ψ∈Ψ(F,k) j=0,j̸=k
 2  2
k−1 ∞
(cid:88) (cid:88) (cid:88)
≤
2  |a j |·∥f j ∗ψ ∥2 + |a j |·∥f j ∗ψ ∥2 
ψ∈Ψ(F,k) j=0 j=k+1
 
k−1 ∞
(cid:88) (cid:88) (cid:88)
2 2 2
≤
2 ∥a ∥ℓ2(C)·  ∥f j ∗ψ ∥2+ ∥f j ∗ψ ∥2
ψ∈Ψ(F,k) j=0 j=k+1
 
∞
(cid:88)
2
≤
2 ∥a ∥ℓ2(C)·k ·η
k
+ η j.
j=k+1
Moreover, for every k n,
≥
(cid:88) (cid:88) (cid:88)
W ( f ψ ) = W ( f ψ ) W ( f ψ )
N−1 k N−1 k N−1 k
| ∗ | | ∗ | − | ∗ |
ψ∈Ψ(F,k) ψ∈Ψ ψ∈Ψ\Ψ(F,k)
(cid:88)
= W (f ) W ( f ψ )
N k N−1 k
− | ∗ |
ψ∈Ψ\Ψ(F,k)
W (f ) η .
N k k
≥ −14 HARTMUTFU¨HR,MAXGETTER
Substituting this and the bound for Rest into (13) yields
k
 
(cid:88)∞ a k 2 (cid:88)
W N(f) | | W N−1( f k ψ ) Rest k
≥ 2 | ∗ | −
k=n ψ∈Ψ(F,k)
  
(cid:88)∞ a
k
2
2
(cid:88)∞
≥
| 2| ·(W N(f k) −η k) −2 ∥a ∥ℓ2(C)·k ·η k + η j
k=n j=k+1
  
(cid:88)∞ a
k
2
2
(cid:88)∞
≥
| 2| ·W N(f k) −2 ∥a ∥ℓ2(C)·(k+1) ·η k + η j
k=n j=k+1
(cid:88)∞ (cid:18) a
k
2
2
(cid:19)
= | | W (f ) 2 a ε .
2 ·
N k
− ∥
∥ℓ2(C)· k
k=n
Finally, let us derive (11) from (10) under the additional assumptions (vi) and (vii). Choosing n = N in
(10) and exploiting the upper bound for ε , k N, we find that
k
∈
(14) W (f)
(cid:88)∞ (cid:18) |a
k
|2
W (f ) 2 a
2
ε
(cid:19) (cid:88)∞ (cid:18) |a
k
|2
W (f ) δ a
2(cid:19)
.
N
≥ 2 ·
N k
− ∥
∥ℓ2(C)· k
≥ 2 ·
N k
− ·|
k
|
k=N k=N
Since W (f) is nonincreasing in N for fixed f L2(Rd), we have, for all k N,
N
∈ ≥
W (f ) W (f ) 4δ.
N k k k
≥ ≥
Substituting this into (14) concludes the proof. □
We are now ready to state and prove a first theorem about arbitrarily slow energy propagation in scattering
networks. This is a generalization of the idea outlined at the beginning of this section.
T seh tseo Ψr (e Fm ,k)2 ⊆.2. ΨL ,e kt ∈F N= 0,(f am nd) m a∈N s0 ub⊂ seL qu2 e( nR cd e). (fS mu kp )p ko ∈s Ne 0t oh fat Ffo wr ita hll mto 0le =ra 0nc ae ns d(η suk) ck h∈N th0 a∈
t
tR hN > e0 0 fot lh loer we ine gxi hst olfi dn :ite
(i) The expression C F := sup m∈N 0∥f m ∥2 2 is finite, i.e., F is a bounded sequence.
(ii) We have, for all j,k N with j < k,
0
∈
(cid:10) (cid:11)
f ,f η .
| m k mj | ≤ k
(iii) The sets Ψ(F,k), k N , are pairwise disjoint.
0
∈
(iv) We have, for every k N ,
0
∈
(cid:88)
2
f ψ η .
∥ m k ∗ ∥2 ≤ k
ψ∈Ψ\Ψ(F,k)
(v) We have, for every k N and 0 j < k,
0
∈ ≤
(cid:88) (cid:13) (cid:13)2
(cid:13)f
mj
∗ψ(cid:13)
2 ≤
η k.
ψ∈Ψ(F,k)
(vi) There exists δ > 0 such that, for all k N, W (f ) 4δ.
∈ k m k ≥
If E = (E N) N∈N RN >0 is a nonincreasing null-sequence, then there exists f E L2(Rd) that satisfies
∈ ∈
a) f 2 2C (1+E ),
∥ E ∥2 ≤ F · 1
b) f f 2 2C E , and
∥ E − 0 ∥2 ≤ F · 1
c) for all N N, W (f ) δ E .
N E N
∈ ≥ ·ENERGY PROPAGATION IN SCATTERING CONVOLUTION NETWORKS 15
Proof. Define
(cid:16)(cid:112) (cid:17)
(a k) k∈N := E k E k+1 ,
− k∈N
and set a := 1. A telescoping argument gives, for every N N,
0
∈
∞ ∞
(cid:88) (cid:88)
a 2 = (E E ) = E .
k k k+1 N
| | −
k=N k=N
In particular, a = (a k) k∈N 0 ∈ ℓ2(N 0;C) with ∥a ∥2 ℓ2(N 0;C) = 1+E 1.
We want to apply Lemma 2.1 to a subsequence (f m k) k∈N 0 of F, which implies that f E can be chosen of the
type
∞
(cid:88)
f := a f .
E k m k
k=0
Here, (f m k) k∈N 0 will be the subsequence of F from the prerequisites of this theorem that depends on tolerance
levels (η k) k∈N 0, which we will now specify.
Recall from Lemma 2.1 that f converges in L2(Rd) with an upper bound for its squared norm given by
E
2 (cid:80)∞ (cid:10) (cid:11)
f a a f ,f . Likewise,
∥ E ∥2 ≤ k,j=0| k j · m k mj |
(cid:13)
∞
(cid:13)2
∞
f f 2 = (cid:13) (cid:13)(cid:88) a f (cid:13) (cid:13) (cid:88) a a (cid:10) f ,f (cid:11) .
∥ E − 0 ∥2 (cid:13) k m k(cid:13) ≤ | k j · m k mj |
(cid:13) (cid:13)
k=1 2 k,j=1
We will bound the latter series using the approximate orthogonality relation (ii). Repeatedly applying the
Cauchy-Schwarz inequality yields, for all n N ,
0
∈
∞
(cid:88) (cid:10) (cid:11)
a a f ,f
| k j · m k mj |
k,j=n
 
∞ k−1 ∞
= (cid:88) a (cid:88) a (cid:10) f ,f (cid:11) + a f ,f + (cid:88) a (cid:10) f ,f (cid:11) 
| k |· | j |·| m k mj | | k |·|⟨ m k m k⟩| | j |·| m k mj |
k=n j=n (cid:124) (cid:123)(cid:122) (cid:125) (cid:124) (cid:123)(cid:122) (cid:125) j=k+1 (cid:124) (cid:123)(cid:122) (cid:125)
≤η
k
≤CF ≤ηj
 1   1
∞ ∞ 2 ∞ ∞ 2
(cid:88) (cid:88) (cid:88) (cid:88)
≤ C F · |a k |2+ |a j |2  ·  |a k |·(k −n) ·η k2+ η j2   
k=n j=n,j̸=k k=n j=k+1
    1
∞ ∞ ∞ ∞ 2
(cid:88) (cid:88) (cid:88) (cid:88)
C F a k 2+ a j 2   (k n) η k2+ η j2  .
≤ · | | | | · − ·
k=n j=n k=n j=k+1
Thus, if we choose the tolerances (η k) k∈N 0 ∈
RN
>0 0 small enough such that
 
∞ ∞
(cid:88) (cid:88)
k η k2+ η j2  C F2,
· ≤
k=0 j=k+1
then we obtain
 
∞ ∞ (cid:40)
(cid:88) |a ka j ·(cid:10) f m k,f mj (cid:11)
| ≤
2C F ·(cid:88) |a j |2  = 22 CC F · E(1+E 1) i if
f
n
n
=
=
0
1
.
F 1
k,j=n j=n ·16 HARTMUTFU¨HR,MAXGETTER
This proves the norm bounds in a) and b).
areA fres ein toL ce hm om osa e,2 w.1 e, cd ae nfi an de dε ik ti: o= na( lk ly+ as1 s) u· mη k e+ tha(cid:80) t∞ j t= hk e+ s1 erη ij esfo (cid:80)r a ∞ll k ε∈ cN on0. veS ri gn ec se at nh de tt ho ale tr ia tn hc oe ls d( sη ,k f) ok r∈ aN l0 lk∈ RN > N0 0
,
k=0 k ∈
δ a 2
k
ε ·| | .
k ≤ 2 a 2
∥
∥ℓ2(C)
By applying Lemma 2.1, we conclude that, for all N N,
∈
∞
(cid:88)
W (f ) δ a 2 = δ E .
N E k N
≥ · | | ·
k=N
□
Under certain assumptions on the high-pass filters Ψ, the latter theorem guarantees that for any nonin-
creasing null-sequence E = (E N) N∈N RN >0 there exists at least one input signal f E L2(Rd) whose network
∈ ∈
energy propagates slower across the network layers than E. Specifically, this implies that the set
(cid:110) (cid:12) (cid:111)
f L2(Rd) (cid:12) W (f) / (E )
(cid:12) N N
∈ ∈ O
is nonempty. Our next result provides a sufficient criterion under which this set is even dense in L2(Rd).
Proposition 2.3. Let E = (E N) N∈N RN >0 be a nonincreasing null-sequence. Assume that for all g L2(Rd)
there are C g,δ g > 0 such that the follow∈ ing holds: For every nonincreasing null-sequence E′ = (E N′ ) N∈∈ N
∈
RN >0
with liminf N→∞EN/E N′ = 0 there exists f g,E′
∈
L2(Rd) such that
(i) (cid:13) (cid:13)f g,E′ −g(cid:13) (cid:13)2 2 ≤ C g ·E 1′, and
(ii) W N(f g,E′)
≥
δ
g
·E N′ for all N
∈
N.
Then,
(cid:110) (cid:12) (cid:111)
Y := f L2(Rd) (cid:12) W (f) (E )
E (cid:12) N N
∈ ∈ O
is a countable union of nowhere dense sets in L2(Rd). In particular, L2(Rd) Y is dense in L2(Rd).
E
\
Proof. Define, for all p N,
∈
(cid:110) (cid:12) (cid:111)
M := f L2(Rd) (cid:12) N N : W (f) p E ,
p (cid:12) N N
∈ ∀ ∈ ≤ ·
and observe that Y can be written as countable union of these sets,
E
(cid:91)
Y = M .
E p
p∈N
Our goal is to show that M is nowhere dense in L2(Rd) for every p N. To this end, let us first recall from
p
∈
Corollary 1.7 that the nonlinear operator W : L2(Rd) R is continuous. Thus,
N
→
(cid:92) (cid:110) (cid:12) (cid:111)
M = f L2(Rd) (cid:12) W (f) p E
p (cid:12) N N
∈ ≤ ·
N∈N
is closed and it only remains to show that the interior of M is empty: Fix g M , ε > 0, and define
p p
∈


ε2
if N = 1
E′ := 2Cg (cid:113) , for N N.
N E 1′
·
E EN
1
if N
≥
2 ∈ENERGY PROPAGATION IN SCATTERING CONVOLUTION NETWORKS 17
Clearly, E′ = (E N′ ) N∈N
∈
RN >0 is a nonincreasing null-sequence that satisfies liminf N→∞EN/E N′ = 0. Hence,
there is f g,E′ L2(Rd) that satisfies (i) and (ii) from the assumptions of this lemma. Thus, there is N 0 N
∈ ∈
such that
W N0(f g,E′)
≥
δ
g
·E N′
0
> p ·E N0,
which means
f g,E′ B ε(g) M p,
∈ \
where B (g) denotes the open ball with radius ε and center g in L2(Rd) with respect to . Since this entails
ε ∥·∥2
that the interior of M is empty, we have shown in total that Y is a countable union of nowhere dense sets in
p E
L2(Rd). Therefore, its complement L2(Rd) Y is dense in L2(Rd) by the Baire category theorem. □
E
\
Fortheremainderofthissection, wewillbeexaminingtheassumptionsofTheorem2.2andProposition2.3.
While the number of conditions on the family F and the high-pass filters Ψ that must be met simultaneously
for our results to apply is considerable, we will demonstrate that these conditions can in fact be easily satisfied.
To provide a concrete reference model, let us next establish that F can be obtained by L2-normalized dilations
of a single function.
Lemma 2.4. Let f L2(Rd). If (A m) m∈N GL d(R)N satisfies lim m→∞σ min(A m) = , then
∈ ∈ ∞
lim (cid:12) (cid:12)(cid:10) f,D2 f(cid:11)(cid:12) (cid:12) = 0.
m→∞
Am
Proof. The statement is obvious if f = 0. For the other case, fix f L2(Rd) 0 and ε > 0. By Lebesgue’s
dominated convergence theorem there is R > 0 so that f := f 1 ∈ satisfie\ s{ }
R
·
BR(0)
ε
f f .
∥ − R ∥2 ≤ 2 f
∥ ∥2
For m N, splitting the inner product gives
∈
(15) (cid:12) (cid:12)(cid:10) f,D A2 mf(cid:11)(cid:12) (cid:12)
≤
(cid:12) (cid:12)(cid:10) f,D A2 mf R(cid:11)(cid:12) (cid:12)+(cid:12) (cid:12)(cid:10) f,D A2 m(f −f R)(cid:11)(cid:12) (cid:12)
We obtain an upper bound for the second term by the Cauchy-Schwarz inequality,
(16) (cid:12) (cid:12)(cid:10) f,D A2 m(f −f R)(cid:11)(cid:12) (cid:12) ≤ ∥f ∥2·(cid:13) (cid:13)D A2 m(f −f R)(cid:13) (cid:13) 2 = ∥f ∥2·∥f −f R ∥2 ≤ 2ε .
We now turn our attention to the first term in (15). As can be seen from a singular value decomposition of
A , we have, for all x Rd,
m
∈
A x σ (A ) x .
∥ m ∥2 ≥ min m ·∥ ∥2
Since by assumption lim σ (A ) = , we find that, for all x Rd 0 ,
m→∞ min m
∞ ∈ \{ }
1 (A x) 1 (x) m→∞ 0.
BR(0) m ≤ B R (0) −−−−→
σmin(Am)
Hence, by Lebesgue’s dominated convergence theorem there is m N so that, for all m m ,
0 0
∈ ≥
(cid:13) (cid:13)
(cid:13) (cid:13) (cid:13)f ·1 B R (0)(cid:13) (cid:13) (cid:13) ≤ 2 ε f .
σmin(Am) 2 ∥ ∥2
Thus, for all m m ,
0
≥
(cid:90)
(cid:12) (cid:12)(cid:10) f,D A2 mf R(cid:11)(cid:12) (cid:12)
≤
Rd|f(x) |·|D A2 mf(x) |·1 BR(0)(A mx)dx
(cid:90)
f(x) D2 f(x) 1 (x)dx
≤ Rd| |·| Am |· B σminR (Am)(0)
(cid:13) (cid:13)
(17) ≤ (cid:13) (cid:13) (cid:13)f ·1 B R (0)(cid:13) (cid:13) (cid:13) ·(cid:13) (cid:13)D A2 mf(cid:13) (cid:13) 2 ≤ 2ε .
σmin(Am) 218 HARTMUTFU¨HR,MAXGETTER
Plugging (16) and (17) into (15) concludes the proof. □
The following lemma shows that F satisfies assumptions (i)–(v) from Theorem 2.2 if it is generated by L2-
normalized matrix-dilations of a fixed function for matrices that asymptotically become increasingly expansive.
Lemma 2.5. Let (A m) m∈N GL d(R)N be so that lim m→∞σ min(A m) = . Let f L2(Rd), and define
f := D2 f, m N. Finally,∈ choose f 0,f . ∞ ∈
m Am ∈ 0 ∈ { }
Then, F = (f m) m∈N
0
satisfies assumptions (i)–(v) from Theorem 2.2.
Proof. The statement is trivial if f = 0. Hence, suppose f L2(Rd) 0 in the following. Furthermore,
∈ \ { }
assumptions (i)-(v) of Theorem 2.2 are clearly easier to meet if we are in the case that f = 0 (instead of
0
f = f). Therefore, we will only spell out the proof for f = f. For notational convenience, we set A := I , so
0 0 0 d
we can write f = D2 f.
0 A0
2 2
k
h2. o2
∈
ldB
is
.Ny
s
W0at ,h
t
eaie
s
n
pfin
d
reo odr ca.m eesWa
u
dl bei bz sa
n
yet
o
qi
cw
uo hn
e
oh
n
oo
a
c
sf
v
e
it
e
nh
(
gfte
o
m
td hksi
eh
)la
ko
s∈t
w
ei No
t0
sn ths
o
Ψ,
a
f
(tC FFfF
o ,kr
w:=
)a itl
hs lu
t
Ψmp olm
,e
0
k∈
ra
=N n0
c
0∥ Nef
s
0am ,n(∥
η
ad2
k n)
s=
dk u∈
c
(∥
N
mhf 0∥
kt∈
)h2 kaRi ∈s
t
NN >fi
a0
0n ssi tt Nuhe
me
N, ri pe. ie nte.
i
d,
ox
ua
nis
cs
st
ts iu
(fi
vim
n
i e)
lip
-
yt (e
.t vio )sen ots( fi Ψ) To h(f
F
eT
o,
rkh e)e mo ⊆r 2e Ψm
.2,
⊆ ∈ ∈
Starting with k = 0 and m = 0, we only need to show that condition (iv) can be satisfied. Since
0
(cid:88)
2 2
f ψ f < ,
∥ m0 ∗ ∥2 ≤ ∥ ∥2 ∞
ψ∈Ψ
there is a finite subset Ψ(F,0) Ψ such that
⊂
(cid:88)
2
f ψ η .
∥ m0 ∗ ∥2 ≤ 0
ψ∈Ψ\Ψ(F,0)
For the induction step, let k N and assume that Ψ(F,0),...,Ψ(F,k 1) and m ,...,m are such that
0 k−1
∈ −
(ii)-(v) hold. Our goal is now to obtain Ψ(F,k) and m with the desired properties.
k
It is easy to meet condition (ii): For all m N and 0 j < k, we have
0
∈ ≤
(cid:12)(cid:28) (cid:29)(cid:12) (cid:12)(cid:28) (cid:29)(cid:12)
|(cid:10) f m,f mj (cid:11)
|
= (cid:12) (cid:12)
(cid:12)
D A2 − m1 jD A2 mf,f (cid:12) (cid:12)
(cid:12)
= (cid:12) (cid:12)
(cid:12)
D A2 mA− m1 jf,f (cid:12) (cid:12) (cid:12).
Moreover,
(cid:16) (cid:17) (cid:16) (cid:17) σ (A ) σ (A )
σ A A−1 σ (A ) σ A−1 = min m min m .
min m mj
≥
min m
·
min mj
σ
max(cid:0)
A
mj(cid:1)
≥ max 0≤l<kσ max(A m l)
Since the latter bound is uniformly in j for 0 j < k, and lim σ (A ) = by assumption, Lemma
m→∞ min m
2.4 implies that there exists m′ N such that≤(cid:10) f ,f (cid:11) < η holds for all j ∞ 0,...,k 1 whenever we
k ∈ 0 | m k mj | k ∈ { − }
choose m larger than m′.
k k
The harder part is to satisfy the remaining conditions (iii)-(v) simultaneously. We begin with a simple
observation about the impact of matrix-dilations on the frequency content of f. For R > r > 0, let
P f := −1( (f) 1 )
r,R
F F ·
Sr,R
be the projection of f on the subspace of L2(Rd) whose Fourier transform is supported in S . We introduce
r,R
ε (0,1/2), which will be chosen later in the proof (small enough). By Lebesgue’s dominated convergence
∈
theorem, f(cid:98)is concentrated in a spherical shell S up to ε-error for some R(ε) > r(ε) > 0, meaning that
r(ε),R(ε)
(cid:13) (cid:13)2 2
(cid:13)P r(ε),R(ε)f(cid:13)
2 ≥
(1 −ε) ·∥f ∥2.ENERGY PROPAGATION IN SCATTERING CONVOLUTION NETWORKS 19
(cid:91)
Now, if A GL (R), then D2f is concentrated in S up to ε-error, since
∈ d A σmin(A)·r(ε),σmax(A)·R(ε)
(cid:13) (cid:13)P σmin(A)·r(ε),σmax(A)·R(ε)D A2f(cid:13) (cid:13)2
2
= (cid:13) (cid:13) (cid:13)D(cid:91) A2f ·1
S
σmin(A)·r(ε),σmax(A)·R(ε)(cid:13) (cid:13) (cid:13)2
2
(cid:90)
= det(A) −1 f(cid:98)(A−Tξ) 2 1
S
(ξ)dξ
Rd| | ·| | · σmin(A)·r(ε),σmax(A)·R(ε)
(cid:90)
= f(cid:98)(z) 2 1
S
(ATz)dz
Rd| | · σmin(A)·r(ε),σmax(A)·R(ε)
(cid:90)
f(cid:98)(z) 2 1
S
(z)dz
≥ Rd| | · r(ε),R(ε)
(cid:13) (cid:13)2 2
= (cid:13) FP r(ε),R(ε)f(cid:13)
2 ≥
(1 −ε) ·∥f ∥2.
Specifically, setting
r := min σ (A ) r(ε) and R := max σ (A ) R(ε),
<k
0≤j<k
min mj
·
<k
0≤j<k
max mj
·
the above frequency concentration estimate entails
(cid:13) (cid:13)2
(cid:13) (cid:13)(id L2(Rd) −P r <k,R <k)f mj(cid:13) (cid:13) 2 ≤ ε ·∥f ∥2 2 for 0 ≤ j < k.
By the Littlewood-Paley condition (3) and the continuity of the Fourier transform of the filters, there is a finite
(cid:83)k−1
subset Ψ(cid:101) Ψ containing Ψ(F,j), and such that
⊆ j=0
(cid:88)
(18) |χ (cid:98)(ξ) |2+ |ψ(cid:98)(ξ) |2 > 1 −ε for all ξ
∈
S
r <k,R
<k.
ψ∈Ψ(cid:101)
By the Riemann-Lebesgue lemma, there exists T R such that
<k
≥
(cid:88)
(19) χ (cid:98)(ξ) 2+ ψ(cid:98)(ξ) 2 < ε whenever ξ T.
| | | | | | ≥
ψ∈Ψ(cid:101)
Since lim σ (A ) = by assumption, there is m′′ N with σ (A ) r(ε) T for all m m′′. Define
m→∞ min m ∞ k ∈ min m · ≥ ≥ k
m := max m′,m′′ , r := σ (A ) r(ε), and R := σ (A ) R(ε). Thus,
k { k k} k min m k · k max m k ·
(cid:13) (cid:13)2
(cid:13) (cid:13)(id L2(Rd) −P r k,R k)f m k(cid:13) (cid:13)
2 ≤
ε ·∥f ∥2 2.
Moreover, because of (19), the Littlewood-Paley condition (3), and the continuity of the Fourier transform of
the filters, there exists a finite subset Ψ(F,k,ε) Ψ Ψ(cid:101) so that
⊆ \
(cid:88)
ψ(cid:98)(ξ) 2 > 1 ε for all ξ S
r ,R
,
| | − ∈ k k
ψ∈Ψ(F,k,ε)
which itself entails
(cid:88)
(20) ψ(cid:98)(ξ) 2 < ε for all ξ S
r ,R
.
| | ∈ k k
ψ∈Ψ\Ψ(F,k,ε)
At the same time, (18) and the fact that Ψ(F,k,ε) Ψ Ψ(cid:101), imply
⊆ \
(cid:88)
(21) ψ(cid:98)(ξ) 2 < ε for all ξ S
r ,R
.
| | ∈ <k <k
ψ∈Ψ(F,k,ε)
η
We claim that Ψ(F,k) := Ψ(F,k,ε) with ε := k does the job.
2∥f∥2
220 HARTMUTFU¨HR,MAXGETTER
In fact, first note that conditions (i)-(iii) are immediately satisfied by the above construction. Concerning
condition (iv), we have
(cid:88) (cid:88) (cid:88) (cid:13) (cid:13)2
∥f m k ∗ψ ∥2 2 = ∥(P r k,R kf m k) ∗ψ ∥2 2+ (cid:13) (cid:13)((id L2(Rd) −P r k,R k)f m k) ∗ψ(cid:13) (cid:13) 2
ψ∈Ψ\Ψ(F,k) ψ∈Ψ\Ψ(F,k) ψ∈Ψ\Ψ(F,k)
(cid:90) (cid:88) (cid:13) (cid:13)2
≤
Rd|f(cid:100)m k(ξ) |2
·
|ψ(cid:98)(ξ) |2 ·1 Srk,Rk(ξ)dξ +(cid:13) (cid:13)(id L2(Rd) −P r k,R k)f m k(cid:13) (cid:13)
2
ψ∈Ψ\Ψ(F,k)
(cid:90)
≤
ε
·
Rd|f(cid:100)m k(ξ) |2dξ +ε ·∥f ∥2
2
2 2
= ε f +ε f = η .
·∥ m k∥2 ·∥ ∥2 k
Finally, we obtain condition (v) by proceeding analogously to the previous step. Indeed, for 0 j < k, we have
≤
(cid:88) (cid:13) (cid:13)f mj ∗ψ(cid:13) (cid:13)2 2 = (cid:88) (cid:13) (cid:13)(P r <k,R <kf mj) ∗ψ(cid:13) (cid:13)2 2+ (cid:88) (cid:13) (cid:13) (cid:13)((id L2(Rd) −P r <k,R <k)f mj) ∗ψ(cid:13) (cid:13) (cid:13)2
2
ψ∈Ψ(F,k) ψ∈Ψ(F,k) ψ∈Ψ(F,k)
(cid:90) (cid:88) (cid:13) (cid:13)2
≤
Rd|f(cid:100)mj(ξ) |2
·
|ψ(cid:98)(ξ) |2 ·1 Sr<k,R<k(ξ)dξ +(cid:13) (cid:13)(id L2(Rd) −P r <k,R <k)f mj(cid:13) (cid:13)
2
ψ∈Ψ(F,k)
(cid:90)
≤
ε
·
Rd|f(cid:100)mj(ξ) |2dξ +ε ·∥f ∥2
2
(cid:13) (cid:13)2 2
= ε ·(cid:13)f mj(cid:13) 2+ε ·∥f
∥2
= η k.
□
We summarize our previous results in the case where F is generated by L2-normalized matrix-dilations.
Corollary 2.6. Let (A m) m∈N GL
d(R)N
be so that lim m→∞σ min(A m) = . Suppose that
∈ ∞
δ := inf inf limsupW (D2 f) > 0.
f∈L2(Rd),k∈N m→∞
k Am
∥f∥ =1
2
Then, for every g L2(Rd) there exists a universal constant C > 0 with the following property:
g
For any noninc∈ reasing null-sequence E = (E N) N∈N RN >0 there is f g,E L2(Rd) such that
∈ ∈
a) f 2 C (1+E ),
∥ g,E ∥2 ≤ g · 1
b) f g 2 C E , and
∥ g,E − ∥2 ≤ g · 1
c) W (f )
∥g∥2
2 δ E for all N N.
N g,E ≥ 8 · · N ∈
Furthermore,
(cid:110) (cid:12) (cid:111)
Y := f L2(Rd) (cid:12) W (f) (E )
E (cid:12) N N
∈ ∈ O
is a countable union of nowhere dense sets in L2(Rd). In particular, L2(Rd) Y is dense in L2(Rd).
E
\
Proof. Let us first assume that g = 0. Define g := D2 g for m N , where A := I . From the assumption
t th ha at
t
δ W> (cid:16)0, gmw ke (cid:17)conc 1lud δe
,
t oh ra et qt uh ive are̸ lee nx tli ysts Wa s (t gricm t )ly in ∥c grA ∥e
2
2m asi δng fos re aq lu∈ le knc0 e N(m .k T) k h∈ eN 0 e0 x⊆ istN e0 nd cw eit oh
f
fm 0 = th0 a, tan sad tis su fic eh
s
k ∥g∥ 2 ≥ 2 · k m k ≥ 2 · ∈ g,E
the properties a)–c) then follows from Theorem 2.2 and Lemma 2.5.
Forg = 0,fixanyh L2(Rd)with h = 1. Seth := 0 L2(Rd)andh := D2 hform N. Againfrom
theassumptionthatδ
>∈
0,
weconclude∥ th∥2 atthereisa0 strictly∈ increasingseqm uence(mAm
k) k∈N 0
⊆∈N
0 withm 0 = 0,ENERGY PROPAGATION IN SCATTERING CONVOLUTION NETWORKS 21
and such that, for all k
∈
N, W k(h m k)
≥
1 2·δ. Applying Theorem 2.2 and Lemma 2.5 to the sequence (h m k) k∈N
then yields f := f L2(Rd) that satisfies f 2 2E and, for all N N, W (f ) 1 δ E .
Overall, tg h,E is alsoh s,E ho∈ ws that we can apply P∥ rog p,E o∥ si2 ti≤ on 2.1 3, which complet∈ es the N proog, fE . ≥ 8 · · N □
We are now ready to present the main theorem of this section. It states that the prerequisites of Corollary
2.6 are satisfied if the high-pass filters Ψ admit an inclusive structure when L1-dilated by the matrix sequence
(A m−1) m∈N. Specifically, this includes filter banks, where the high-pass filters Ψ arise from the L1-normalized
dilations by the matrix sequence (A m) m∈N applied to a finite number of generators, as is the case for wavelet-
generatedfilterbanks. Inthesecases,boththeresultofarbitrarilyslowenergypropagationanditsconsequence
concerning the density of signals that fail to meet a given decay rate apply.
Theorem 2.7. Let (A m) m∈N GL
d(R)N
be such that the following are true:
∈
(i) We have lim σ (A ) = .
m→∞ min m
∞
(ii) The inclusion Ψ Ψ holds for all m N, where Ψ := D1 Ψ.
m ⊆ m+1 ∈ m A− m1
Then, Ψ := (cid:83) Ψ is a semi-discrete Parseval frame. Moreover, for all f L2(Rd), k N,
∞ m∈N m
∈ ∈
lim W [Ψ](cid:0) D2 f(cid:1) = f 2 .
m→∞ k Am ∥ ∥2
In particular, Corollary 2.6 applies with δ = 1.
Proof. By the Littlewood-Paley condition (3), we have, for every m N,
∈
(cid:88) (cid:88)
χˆ(AT ξ) 2+ ψˆ(ξ) 2 = χˆ(AT ξ) 2+ ψˆ(AT ξ) 2 = 1 a.e. ξ Rd.
m m m
| | | | | | | | ∈
ψ∈Ψm ψ∈Ψ
In particular, for all f L2(Rd), m N,
∈ ∈
(cid:88)
2 2
f ψ f ,
∥ ∗ ∥2 ≤ ∥ ∥2
ψ∈Ψm
which implies
(cid:88)
2 2
f ψ f .
∥ ∗ ∥2 ≤ ∥ ∥2
ψ∈Ψ∞
Ontheotherhand, asaconsequenceoflim σ (AT ) = , theRiemann-Lebesguelemma, andLebesgue’s
m→∞ min m
∞
dominated convergence theorem, we find that
(cid:88) f ψ 2 (cid:88) f ψ 2 = f 2 (cid:13) (cid:13)f D1 χ(cid:13) (cid:13)2 m→∞ f 2 .
∥ ∗ ∥2 ≥ ∥ ∗ ∥2 ∥ ∥2−(cid:13) ∗ A− m1 (cid:13) 2 −−−−→ ∥ ∥2
ψ∈Ψ∞ ψ∈Ψm
Thus, Ψ is a semi-discrete Parseval frame.
∞
Fix f L2(Rd). Recall from Lemma 1.8 that we have, for all k N, m N,
∈ ∈ ∈
W [Ψ](D2 f) = W [D1 Ψ](f) = W [Ψ ](f).
k Am k A− m1 k m
Let ε > 0. Since W [Ψ ](f) = f 2 by Lemma 1.4, there is a finite subset Ψ˜ = Ψ˜(ε) Ψ such that
k ∞ ∥ ∥2 ⊂ ∞
2
W k[Ψ(cid:101)](f)
≥
∥f ∥2−ε.
Since Ψ(cid:101) is finite, there exists M = M(ε) N with Ψ(cid:101) Ψ M. Thus, for all m M,
∈ ⊂ ≥
2 2
∥f
∥2 ≥
W k[Ψ m](f)
≥
W k[Ψ M](f)
≥
W k[Ψ(cid:101)](f)
≥
∥f ∥2−ε,
which concludes the second part of the theorem. □22 HARTMUTFU¨HR,MAXGETTER
In our main application of the latter theorem (concerning scattering with wavelets, see Section 4.2), the
matrices (A m) m∈N are generated by a single expansive matrix, which immediately implies that condition (i)
from Theorem 2.7 is fulfilled. Given its importance and simplicity, we conclude this section by explicitly
(re-)stating our main negative findings for this particular instance of our assumptions, which is much easier to
verify than the assumptions of Theorem 2.2.
Corollary 2.8. Let A GL (R) be such that σ (A) > 1. If Ψ Ψ holds for all m N, where
d min m m+1
Ψ := D1 Ψ, then Ψ ∈ := (cid:83) Ψ is a semi-discrete Parseval frame.⊆ Moreover, for all f L2(∈Rd), k N,
m A−m ∞ m∈N m ∈ ∈
lim W [Ψ](cid:0) D2 f(cid:1) = f 2 .
m→∞ k Am ∥ ∥2
In particular, Corollary 2.6 applies with δ = 1.
3. Convergence Rates for Scattering Propagation
In this section, we show that under mild analyticity assumptions on the scattering filters Ψ, fast energy
propagation can still be achieved for large signal classes in L2(Rd). These signal classes depend on the required
speed of energy propagation, i.e., as one would expect, the faster the energy propagation, the smaller the signal
class we can guarantee this speed for. This is reflected by an interplay between the frequency localization of
the filters in terms of size and shape of their Fourier supports, and the decay behavior of the Fourier transform
of the input signal relative to the filters.
Notably, our results in this section are very general,
since they hold in any dimension d N;
• ∈
because our assumptions can be easily satisfied;
•
as the setup provides several parameters that can be used for fine-tuning.
•
In particular, we will see in Section 4.2 that these results apply to filter banks generated by bandlimited
wavelets, thereby complementing the negative results from the previous section about arbitrarily slow energy
propagation in such scattering networks.
Our analysis begins with a similar approach to that of [18, Theorem 3.1] and [20, Theorem 1, Theorem 2],
establishing an upper bound on W [Ψ](f), for all f L2(Rd) and N N , which is of the type
N ≥2
∈ ∈
(cid:90)
(22) W N[Ψ](f) f(cid:98)(ξ) 2 K N(ξ)dξ
≤ Rd| | ·
for a family (K N) N∈N of integral kernels (independent of f) that satisfy additional properties. In fact, we
≥2
will partially combine the techniques from [18, 20] in the proof of Theorem 3.5, which allows for more flexibility
in our assumptions on the filters. On this basis, we will then exploit the inductive structure of the scattering
network to involve the filters Ψ in right-hand side of (22).
To clarify our assumptions for this section, we need to introduce some additional notation. Let ν∗ Sd−1
be the vector with entries ν∗ := 1/√ d for each k 1,...,d . For ρ [0,1), we denote by ∈
k ∈ { } ∈
(cid:110) (cid:12) (cid:111)
Hρ := x Rd (cid:12) x,ν∗ (1 ρ) x
∈ ≥0 (cid:12) ⟨ ⟩ ≥ − ·∥ ∥2
the closed cone in the first canonical orthant with its tip at the origin and opening angle relative to ν∗
parameterized by ρ. Note that Hρ is precisely the first canonical orthant Rd if ρ 1 √1 . In particular,
≥0 ≥ − d
in dimension d = 1, we have, for all ρ [0,1), Hρ = [0, ). The following assumptions are motivated by [20,
∈ ∞
Assumption 1].
Assumption 3.1. Let κ N ≥2. Let (r j) j∈N RN >0 be a strictly increasing sequence of scales and suppose that
γ := γ(κ) := inf j∈N rjr +j
κ
>∈ 0. In addition to t∈ he Littlewood-Paley condition (3), we assume that there exists aENERGY PROPAGATION IN SCATTERING CONVOLUTION NETWORKS 23
partition Ψ = (cid:83) Ψ such that for every ψ Ψ , j N, there is an orthogonal matrix A O (R) such that
j∈N j
∈
j
∈
ψ
∈
d
ρ
supp(ψ(cid:98))
⊆
H
A ψ
∩Srj,rj+κ,
where Hρ := A x x Hρ .
A ψ { ψ | ∈ }
ξ2 ξ2
rj rj+1 rj+2 ξ1 rj rj+1 rj+2 rj+3ξ1
Fig.3. Illustrationoftheallowedregionsforthefrequencysupportsoftwodifferentfiltersfrom(possibly)
two different families of high-pass filters. The parameter κ (left κ = 2, right κ = 3) reflects the number
of scales the filter may interfere with, and ρ parameterizes the opening angle of the colored segment.
Thepresentsettingmayberegardedasarefinementof[20,Assumption1],inthatitincorporatesadditional
information pertaining to the frequency localization of the filters, which ultimately affects the decay behavior
of the energy remainder. We think of this as follows: By the Littlewood-Paley condition (3), the filters Ψ
induce a decomposition of the frequency space Rd according to
Rd = B (0) (cid:91) (cid:91) (Hρ ).
r1 ∪ A ψ ∩Srj,rj+κ
j∈Nψ∈Ψj
The filters Ψ are of high-pass nature in the sense that they leave a frequency gap around zero,
(cid:88)
(23) |ψ(cid:98)(ξ) |2 = 0 for all ξ
∈
B r1(0).
ψ∈Ψ
By the Littlewood-Paley condition (3), this gap is filled by χ. Moreover, any high-pass filter is frequency-
(cid:98)
localized in a region that is the intersection of a spherical shell, and a (rotated) cone with tip at the origin
and angular spread parameterized by ρ. The maximum number of scale-interferences is specified by κ. The
parameter γ reflects the (inverse of the) maximal relative spread between the inner and outer radius of any
such shell. Clearly, we have γ (0,1), since the scales are strictly increasing. The closer γ is to 1 and the
∈
closer ρ is to 0, the more localized the high-pass filters are in frequency space.
These additional parameters will be reflected in the decay rates that we can guarantee for the energy
remainder of certain signals, offering new insight into the interplay between the localization of the filters (in
terms of size and shape of their Fourier supports) and the frequency decay behavior of the signals. We note
however that our assumptions implicitly require the filters to be bandlimited, which is slightly more restrictive
than the setting considered in [20, Assumption 1].24 HARTMUTFU¨HR,MAXGETTER
We begin our analyis with two auxiliary results about the geometry of the allowed domain for the Fourier
supports of the filters. The first one provides an upper bound on the maximum distance from ν∗ to any other
point in the set Hρ Sd−1.
∩
Lemma 3.2. If t > 0, then max x∈Hρ∩Sd−1 ∥x −tν∗ ∥2 2 ≤ t2 −2t ·(1 −ρ)+1.
Proof. A direct computation shows that, for all x Hρ Sd−1,
∈ ∩
x tν∗ 2 = x 2 2t x,ν∗ +t2 ν∗ 2 t2 2t (1 ρ) x +1 = t2 2t (1 ρ)+1.
∥ − ∥2 ∥ ∥2− ·⟨ ⟩ ·∥ ∥2 ≤ − · − ·∥ ∥2 − · −
□
The next lemma will be crucial for the induction step in the proof of Theorem 3.5.
Lemma 3.3. There is a family (ν ψ)
ψ∈Ψ
Rd so that, for all ψ Ψ, and all ξ supp(ψ(cid:98)),
⊆ ∈ ∈
ξ ν α ξ ,
∥ − ψ ∥2 ≤ ·∥ ∥2
(cid:113)
where α = α(γ,ρ) := 1 4γ (1 ρ)2 (0,1).
− (1+γ)2 · − ∈
Proof. Since the function (0,1) R, γ 4γ is strictly increasing, we have
→ (cid:55)→ (1+γ)2
4γ 4γ 4γ
0 < (1 ρ)2 < lim = 1.
(1+γ)2 · − ≤ (1+γ)2 γ↑1 (1+γ)2
Thus, α (0,1). Now let, for every ψ Ψ , j N,
j
∈ ∈ ∈
2r
ν := j (1 ρ) A ν∗ Rd.
ψ ψ
1+γ · − · ∈
By Assumption 3.1, any ξ
∈
supp(ψ(cid:98)) can be written as A ψω = ξ for some ω
∈
Hρ ∩Srj,rj+κ. Since A
ψ
is an
orthogonal matrix, it preserves the euclidean distances ξ = ω and
∥ ∥2 ∥ ∥2
(cid:13) (cid:13)
ξ ν ψ 2 =
(cid:13)
(cid:13)ω
2r j ·(1 −ρ) ν∗(cid:13)
(cid:13) .
∥ − ∥ (cid:13) − 1+γ · (cid:13)
2
It therefore suffices to show that the latter term is bounded by α ω . By Lemma 3.2,
·∥ ∥2
(cid:13) (cid:13)
(cid:13)ω 2rj·(1−ρ) ν∗(cid:13) (cid:13) (cid:13)
(cid:13) − (1+γ) · (cid:13) 2 max (cid:13) (cid:13) ω 2r j ·(1 −ρ) ν∗(cid:13) (cid:13)
∥ω
∥2
≤ s∈[rj,rj+κ](cid:13) ∥ω
∥2
− s ·(1+γ) · (cid:13)
2
(cid:13) (cid:13)
(cid:13) 2r (1 ρ) (cid:13)
max max (cid:13)x j · − ν∗(cid:13)
(cid:13) (cid:13)
≤ s∈[rj,rj+κ]x∈Hρ∩Sd−1(cid:13) − (cid:124)s ·(1 (cid:123)(cid:122)+γ) (cid:125)· (cid:13)
2
=:t(s)
(cid:112)
max t(s)2 2t(s) (1 ρ)+1
≤ s∈[rj,rj+κ] − · −
(cid:112)
max t(s)2 2t(s) (1 ρ)+1
≤ s∈[rj,γ−1rj] − · −
(cid:112)
(24) = max t2 2t (1 ρ)+1.
t∈(cid:104) 2γ·(1−ρ),2(1−ρ)(cid:105) − · −
1+γ 1+γ
Since the polynomial
P : R R, t t2 2t (1 ρ)+1
→ (cid:55)→ − · −ENERGY PROPAGATION IN SCATTERING CONVOLUTION NETWORKS 25
is convex, the maximum in (24) is attained at one of the boundary points of the interval. A direct computation
yields
(cid:115)
(cid:112) 4γ
max r2 2r (1 ρ)+1 = 1 (1 ρ)2.
r∈(cid:104) 2γ·(1−ρ),2(1−ρ)(cid:105) − · − − (1+γ)2 · −
1+γ 1+γ
□
The following lemma is due to Mallat (cf. [11, Lemma 2.7]) and will turn out to be essential for proving
the main result of this section. For the sake of completeness, we reproduce its (elementary) proof.
Lemma 3.4. Let f L2(Rd), g L1(Rd), and ν Rd. If g 0, then
∈ ∈ ∈ ≥
(cid:90) (cid:16) (cid:17) (cid:90) (cid:12) (cid:12)2 (cid:16) (cid:17)
( f )(ξ) 2 1 g (cid:98)(ξ) 2 dξ (cid:12) (cid:12)f(cid:98)(ξ)(cid:12)
(cid:12)
1 g (cid:98)(ξ ν) 2 dξ.
Rd|F | | | · −| | ≤ Rd · −| − |
Proof. Clearly, since g 0, we have
≥
2 2 2
f g = f M g f M g .
∥| |∗ ∥2 ∥| |∗| ν |∥2 ≥ ∥ ∗ ν ∥2
By the convolution theorem and Parseval’s theorem, we obtain
(cid:90) (cid:16) (cid:17)
2 2 2 2
( f )(ξ) 1 g(ξ) dξ = f f g
Rd|F | | | · −|(cid:98) | ∥| |∥2−∥| |∗ ∥2
(cid:90) (cid:12) (cid:12)2 (cid:16) (cid:17)
≤
∥f ∥2 2−∥f ∗M νg ∥2
2
= Rd(cid:12) (cid:12)f(cid:98)(ξ)(cid:12)
(cid:12) ·
1 −|g (cid:98)(ξ −ν) |2 dξ.
□
We are now ready to establish an upper bound on the energy remainder that is of the type (22). Previous
work in this direction [18, 20, 21] showed that, in dimension d = 1, for certain wavelet-generated filter banks
Ψ , there exist constants C = C(Ψ ) > 0 and α = α(Ψ ) (0,1) such that, for all (real-valued, cf. [18])
wav wav wav
signals f L2(R), and for all N N , ∈
≥2
∈ ∈
W N[Ψ wav](f)
(cid:90)
f(cid:98)(ξ) 2
(cid:18)
1
(cid:12)
(cid:12) (cid:12)ϑ(cid:98)(cid:0) C αN−1
ξ(cid:1)(cid:12)
(cid:12)
(cid:12)2(cid:19)
dξ.
≤ R| | · − · ·
Here, ϑ(cid:98)denotes a concretely specified positive definite and even function that ensures asymptotic decay of the
right-hand side (a Gaussian in [18], and a truncated power function in [20]). Our result is an extension of
this previous work, since it applies to the fairly large class of filter banks satisfying Assumption 3.1, including
filter banks that are not necessarily structured as in the case of wavelet-generated filter banks. At the same
time, our result holds in arbitrary dimension d N. Moreover, for filters that satisfy our Assumption 3.1,
∈
which is slightly more restrictive than [20, Assumption 1], we improve the bound given in [20, Theorem 1] from
polynomial decay of order m
d
(where m
d
(0,1] and m
d
0 as d ) in the argument of ϑ(cid:98)to exponential
∈ → → ∞
decay.
Theorem 3.5. Let ϑ L1(Rd), ϑ 0, and suppose that there exists a nonincreasing function η : [0, ) [0,1]
∈ ≥ ∞ →
so that η(0) = 1 and |ϑ(cid:98)
|
= η( ∥·∥2). Then, there exists a universal constant C
χ,ϑ
> 0 such that, for all
f L2(Rd), and all N N ,
≥2
∈ ∈
(25) W N(f)
(cid:90)
f(cid:98)(ξ) 2
(cid:18)
1
(cid:12)
(cid:12) (cid:12)ϑ(cid:98)(cid:0) C
χ,ϑ
αN−1
ξ(cid:1)(cid:12)
(cid:12)
(cid:12)2(cid:19)
dξ,
≤ Rd| | · − · ·
(cid:113)
where α = α(γ,ρ) := 1 4γ (1 ρ)2.
− (1+γ)2 · −
Moreover, if there is C(cid:101) > 0 so that ϑ(cid:98)(C(cid:101) ) χ (cid:98), then (25) holds for all N N with C
χ,ϑ
= C(cid:101).
| · | ≤ | | ∈26 HARTMUTFU¨HR,MAXGETTER
Proof. We perform induction on N.
First, let us assume that there is C(cid:101) > 0 so that ϑ(cid:98)(C(cid:101) ) χ (cid:98). In this scenario, it is easy to prove the base
| · | ≤ | |
case, whichworksanalogouslytotheproofofthe basecasein[20, Theorem 1]. Infact, bytheLittlewood-Paley
condition (3), for all f L2(Rd),
∈
(cid:90)
(cid:88) (cid:88)
W 1(f) = ∥f ∗ψ ∥2
2
=
Rd
|f(cid:98)(ξ) |2 ·|ψ(cid:98)(ξ) |2dξ
ψ∈Ψ ψ∈Ψ
(cid:90) (cid:90)
= f(cid:98)(ξ) 2 (1 χ (cid:98)(ξ) 2)dξ f(cid:98)(ξ) 2 (1 ϑ(cid:98)(C(cid:101) ξ) 2)dξ.
Rd| | · −| | ≤ Rd| | · −| · |
The proof of the base case is harder if there is no C(cid:101) > 0 such that ϑ(cid:98)(C(cid:101) ) χ
(cid:98)
holds true. Here we proceed
| · | ≤ | |
in three steps, motivated by [18, Section 6.3]. In the first two steps we construct certain auxiliary functions,
whose properties will be exploited to eventually prove the base case in the last step.
Step 1: Let r > 0 be as in Assumption 3.1, corresponding to the radius of the frequency gap of the high-
1
pass filters Ψ. Choose an even function h C∞(Rd) that is supported in Br1(0) and that satisfies h(ξ) > 0
∈ 2
for all ξ
∈
Br 21(0). Set g := F(h ∗h). Then, g
∈
S(Rd), g = |(cid:98)h |2
≥
0, supp(g (cid:98))
⊆
B r1(0), and g (cid:98)(ξ) > 0 for all
ξ Br1(0). In particular,
∈ 2
m := min g(ξ) 2 > 0.
g (cid:98)
| |
ξ∈Br1(0)
2
Finally, we may assume that g 1 by imposing h 1 if necessary.
∥(cid:98) ∥∞ ≤ ∥ ∥2 ≤
Step 2: Let c˜: [0, ) (0, ) be nonincreasing and such that
∞ → ∞
(cid:90)
c˜( ν )dν = 1.
Rd ∥ ∥2
Defining the functions c : Rd [0, ), ν c˜( ν ) and F := g 2 c, we find that, for all ξ Rd,
→ ∞ (cid:55)→ ∥ ∥2 |(cid:98) | ∗ ∈
(cid:90) (cid:90) (cid:16) (cid:17) (cid:16) r (cid:17)
F(ξ) = Rd|g (cid:98)(ν) |2 ·c(ξ −ν)dν
≥
m
g
Br1(0)c(ξ −ν)dν
≥
m
g
·vol Br 21(0) ·c˜ ∥ξ ∥2+ 21 .
2
Thus, if we choose c = c˜( ) so that
∥·∥2
η2(s)
lim = 0,
s→∞
c˜(cid:0)
s+
r1(cid:1)
2
then there is M > 0 such that, for all ξ Rd B M(0), it holds F(ξ) ϑ(cid:98)(ξ) 2. Furthermore, F is strictly
∈ \ ≥ | |
positive and continuous. Hence,
m := min F(ξ) > 0.
F
ξ∈BM(0)
Since lim η(s) = 0, there exists C > α−1 such that, for all ξ Rd B (0),
s→∞ χ,ϑ
∈ \
r1
m
F
ϑ(cid:98)(C
χ,ϑ
α ξ) 2.
≥ | · · |
Finally, we deduce F 1 from g 1 and c = 1. Altogether, for all ξ Rd B (0),
∥ ∥∞ ≤ ∥(cid:98) ∥∞ ≤ ∥ ∥1 ∈ \ r1
(26) 0 1 F(ξ) 1 ϑ(cid:98)(C
χ,ϑ
α ξ) 2.
≤ − ≤ −| · · |
Step 3: Recall from (23) that (cid:80) ψ∈Ψ|ψ(cid:98) |2 vanishes on B r1(0). Since g
(cid:98)
is supported in B r1(0) and since
g 1, we have
(cid:98) ∞
∥ ∥ ≤ (cid:88)
ψ(cid:98)(ξ) 2 1 g (cid:98)(ξ) 2 a.e. ξ Rd.
| | ≤ −| | ∈
ψ∈ΨENERGY PROPAGATION IN SCATTERING CONVOLUTION NETWORKS 27
Hence, for all f L2(Rd),
∈
W 2(f) = (cid:88) (cid:88) (cid:13) (cid:13) ||f ∗ψ |∗ψ′ |(cid:13) (cid:13)2
2
= (cid:88) (cid:88) (cid:13) (cid:13) |f ∗ψ |∗ψ′(cid:13) (cid:13)2
2
ψ∈Ψψ′∈Ψ ψ∈Ψψ′∈Ψ
(cid:90)
(cid:88)
( f ψ )(ξ)
2 (cid:0)
1 g(ξ)
2(cid:1)
dξ.
(cid:98)
≤ Rd|F | ∗ | | · −| |
ψ∈Ψ
Using (23) and Lemma 3.4, we conclude that, for all ν Rd,
∈
(cid:90)
W 2(f) (cid:88) f(cid:98)(ξ) 2 ψ(cid:98)(ξ) 2 (cid:0) 1 g (cid:98)(ξ ν) 2(cid:1) dξ
≤ Rd| | ·| | · −| − |
ψ∈Ψ
(cid:90)
f(cid:98)(ξ) 2 (cid:0) 1 g (cid:98)(ξ ν) 2(cid:1) dξ.
≤ Rd\Br1(0)| | · −| − |
Finally, we average this inequality with the function c and insert the upper bound from (26) to obtain
(cid:90) (cid:90)
W 2(f) c(ν) f(cid:98)(ξ) 2 (cid:0) 1 g (cid:98)(ξ ν) 2(cid:1) dξ dν
≤ Rd · Rd\Br1(0)| | · −| − |
(cid:90) (cid:90)
= f(cid:98)(ξ) 2 c(ν) c(ν) g (cid:98)(ξ ν) 2dν dξ
Rd\Br1(0)| | · Rd − ·| − |
(cid:90)
= f(cid:98)(ξ) 2 (1 F(ξ)) dξ
Rd\Br1(0)| | · −
(cid:90)
f(cid:98)(ξ) 2 (cid:0) 1 ϑ(C
χ,ϑ
α ξ) 2(cid:1) dξ.
≤ Rd| | · −| · · |
This concludes the proof of the base case.
The induction step goes along the lines of [20, Theorem 1]: Suppose that (25) holds for some N N
for all f L2(Rd). Our goal is then to establish the analogous upper bound for W (f). For ψ Ψ∈ , let
N+1
ν
ψ
Rd b∈ e as in Lemma 3.3. Note that the inverse Fourier transform of ϑ(cid:98)(cid:0) C
χ,ϑ
αN−1 (cid:1) is nonneg∈ ative by
∈ · ·
the non-negativity of ϑ. Thus, applying the induction hypothesis to f ψ , as well as employing Lemma 3.4,
| ∗ |
we find that
W N( f ψ )
(cid:90)
( f ψ )(ξ) 2
(cid:18)
1
(cid:12)
(cid:12) (cid:12)ϑ(cid:98)(cid:0) C
χ,ϑ
αN−1
ξ(cid:1)(cid:12)
(cid:12)
(cid:12)2(cid:19)
dξ
| ∗ | ≤ Rd|F | ∗ | | · − · ·
(cid:90)
f(cid:98)(ξ) 2 ψ(cid:98)(ξ) 2
(cid:18)
1
(cid:12)
(cid:12) (cid:12)ϑ(cid:98)(cid:0) C
χ,ϑ
αN−1 (ξ ν
ψ)(cid:1)(cid:12)
(cid:12)
(cid:12)2(cid:19)
dξ.
≤ Rd| | ·| | · − · · −
Summing over ψ Ψ on both sides of the above inequality yields
∈
(cid:90)
(cid:88)
(27) W N+1(f) = W N( f ψ ) f(cid:98)(ξ) 2 h N−1(ξ)dξ,
| ∗ | ≤ Rd| | ·
ψ∈Ψ
where
h N−1(ξ) := (cid:88) ψ(cid:98)(ξ) 2 (cid:18) 1 (cid:12) (cid:12) (cid:12)ϑ(cid:98)(cid:0) C
χ,ϑ
αN−1 (ξ ν ψ)(cid:1)(cid:12) (cid:12) (cid:12)2(cid:19) .
| | · − · · −
ψ∈Ψ
Now, Lemma 3.3 comes into play to establish a pointwise upper bound for h that suffices to conclude
N−1
the proof. Since (cid:80) ψ(cid:98)(ξ) 2 1 holds for all ξ Rd, it is enough to show that we have, for all ψ Ψ, and
ψ∈Ψ| | ≤ ∈ ∈28 HARTMUTFU¨HR,MAXGETTER
all ξ supp(ψ(cid:98)),
∈
1 (cid:12) (cid:12) (cid:12)ϑ(cid:98)(cid:0) C
χ,ϑ
αN−1 (ξ ν ψ)(cid:1)(cid:12) (cid:12) (cid:12)2 1 (cid:12) (cid:12) (cid:12)ϑ(cid:98)(cid:0) C
χ,ϑ
αN ξ(cid:1)(cid:12) (cid:12) (cid:12)2 .
− · · − ≤ − · ·
In fact, 1 ϑ(cid:98)2 = 1 η2( ), where 1 η2 is nondecreasing, and Lemma 3.3 implies that
−| | − ∥·∥2 −
(cid:13) (cid:13)C χ,ϑ ·αN−1 ·(ξ −ν ψ)(cid:13) (cid:13) 2 ≤ (cid:13) (cid:13)C χ,ϑ ·αN ·ξ(cid:13) (cid:13) 2.
Consequently, we have, for all ξ Rd,
∈
h N−1(ξ) 1 (cid:12) (cid:12) (cid:12)ϑ(cid:98)(cid:0) C
χ,ϑ
αN ξ(cid:1)(cid:12) (cid:12) (cid:12)2 .
≤ − · ·
Inserting this into (27) concludes the induction step and thus the proof of the theorem. □
Remark 3.6. Smaller values of α lead to faster convergence to 0 of the integral on the right side of (25) as
N . Hence, let us briefly comment on the impact of the parameters on the value of α. To this end, we
→ ∞
note that the function
(cid:115)
4γ
α : (0,1) [0,1) (0,1), (γ,ρ) 1 (1 ρ)2
× → (cid:55)→ − (1+γ)2 · −
is strictly decreasing in γ, while it is strictly increasing in ρ. Moreover, we have the asymptotic behavior
lim α(γ,ρ) = 0.
(γ,ρ)→(1,0)
We interpret this as follows: α is small if the size of the Fourier supports of the filters is approximately constant
across all scales and if the filters are well localized in terms of their maximum angular frequency spread. This
result appears to be consistent with the earlier findings stated in [20,Theorem1], which indicate a faster decay in
lower dimensions: A reduction of the underlying dimension implicitly forces a higher concentration of angular
frequency, with a maximum concentration achieved in dimension d = 1.
1
0.5
1
0
0
0.2 0.5
0.4
0.6 ρ
0.8
γ 1 0
Fig. 4. Plot of α as a function of the parameters γ and ρ. Smaller values of α guarantee faster decay.
Next, we show how Theorem 3.5 entails fast (up to exponential) energy decay for signals belonging to
generalizedSobolevspacesthataretailoredtothefrequencylocalizationofthehigh-passfiltersΨ. Weintroduce
certain weights to define these spaces.
)ρ,γ(αENERGY PROPAGATION IN SCATTERING CONVOLUTION NETWORKS 29
Definition 3.7. Let k > 0. We say that a function ω : (0, ) (0, ) is a weakly tk-dominated weight if
∞ → ∞
ω is nondecreasing and if there exists T > 0 so that the auxiliary function
h : (0, ) (0, ), t tk ω−2(t)
k,ω
∞ → ∞ (cid:55)→ ·
is bounded on (0,T), nondecreasing on [T, ), and satisfies lim h (t) = .
t→∞ k,ω
∞ ∞
If, in addition to the above, h is nondecreasing on the entire interval (0, ), then we say that ω is a
k,ω
∞
strongly tk-dominated weight.
Remark 3.8. If ω is differentiable, we can easily establish a sufficient criterion for the (simultaneous) mono-
tonicity of ω and h , relying on the non-negativity of their derivatives. In fact, for all t > 0,
k,ω
h′ (t) = k tk−1 ω−2(t) 2tk ω−3(t) ω′(t) = ω−2(t) tk−1 (cid:0) k 2t ω−1(t) ω′(t)(cid:1) .
k,ω
· · − · · · · − · ·
Thus, h′ (t) 0 is equivalent to k ω(t) 2t ω′(t). Altogether, if there is T 0 so that for all t > T,
k,ω ≥ · ≥ · ≥
k ω(t) 2t ω′(t) 0,
· ≥ · ≥
then both ω and h are nondecreasing on (T, ).
k,ω
∞
We define, for all ψ Ψ,
∈
d ψ := ξ′i ∈n Rf
d
ξ∈ss uu pp
p(ψ(cid:98))(cid:13)
(cid:13)ξ
−ξ′(cid:13)
(cid:13) 2 = ξm ′∈i Rn dξ∈m supa px
(ψ(cid:98))(cid:13)
(cid:13)ξ
−ξ′(cid:13)
(cid:13) 2.
For a weakly tk-dominated weight, we consider the generalized Sobolev space
 (cid:12) 
(cid:12)
Dω(Ψ;L2(Rd)) :=  f
∈
L2(Rd) (cid:12) (cid:12)
(cid:12)
(cid:88) ω2(d ψ) ·∥f ∗ψ ∥2
2
< ∞ .
 
(cid:12) ψ∈Ψ
Theorem 3.9. Let ϑ L1(Rd) be as in Theorem 3.5, and assume that there are k = k > 0, C = C > 0 such
ϑ ϑ
that, for all ξ Rd, ∈
∈
(28) 1 ϑ(cid:98)(ξ) 2 C ξ k .
−| | ≤ ·∥ ∥2
If ω : (0, ) (0, ) is a weakly tk-dominated weight, then we have, for all f (Ψ;L2(Rd)),
ω
∞ → ∞ ∈ D
W (f)
(cid:0) ω−2(cid:0) α−N(cid:1)(cid:1)
,
N
∈ O
(cid:113)
where α = α(γ,ρ) := 1 4γ (1 ρ)2 (0,1).
− (1+γ)2 · − ∈
Moreover, if there is C(cid:101) > 0 so that ϑ(cid:98)(C(cid:101) ) χ (cid:98), and if ω is a strongly tk-dominated weight, then the
following explicit upper bound holds:
For|
all
N· | ≤N | ,|
≥2
∈
 
(cid:110) (cid:111) (cid:88)
W N(f)
≤
max 1,C ·C(cid:101)k ·α−k · ω2(d ψ) ·∥f ∗ψ ∥2 2 ·ω−2(α−N).
ψ∈Ψ
Remark 3.10. By the non-negativity of ϑ, the condition (28) can only be satisfied if k = k 2. Let us briefly
ϑ
sketch the reason for this. By definition of the L1-Fourier transform, we have, for all ξ
Rd≤
,
∈
(cid:16) (cid:17)
1 ϑ(cid:98)(ξ) 2 = Re ϑ(cid:98)(0) 2 ϑ(cid:98)(ξ) 2
−| | | | −| |
(cid:18)(cid:90)
(cid:16) (cid:17)
(cid:19)
= Re ϑ(x) ϑ(y) 1 e−2π·i·⟨ξ,x−y⟩ dλ(x,y)
R2d · · −
(cid:90)
= ϑ(x) ϑ(y) (1 cos(2π ξ,x y )) dλ(x,y).
R2d · · − ·⟨ − ⟩30 HARTMUTFU¨HR,MAXGETTER
For all z [ 1,1],
∈ −
z2
1 cos(z) .
− ≥ 3
Hence, if ξ = s e , where s > 0, and e denotes the first standard unit vector in Rd, we obtain
1 1
·
1 ϑ(cid:98)(ξ) 2 (cid:90)
−| | ϑ(x) ϑ(y) (x y )2dλ(x,y)
∥ξ ∥2 2 ≥ {(x,y)∈R2d : |2π·s·(x1−y1)|≤1
}
· · 1 − 1
(cid:90)
s→0 2
ϑ(x) ϑ(y) (x y ) dλ(x,y) > 0.
1 1
−−−→ R2d · · −
We conclude that k 2.
ϑ
≤
Now, observe that larger values for k in (28) allow more flexibility in the choice of ω, as the assumptions
regarding h are easier to fulfill. However, as justified above, the largest possible value for any ϑ L1(Rd) is
k,ω
∈
k = 2. Finally, note that, while we can show an analogous result to Theorem 3.5 for ϑ L2(Rd), we would
ϑ
∈
not gain a qualitative improvement to Theorem 3.9, since the same threshold order of convergence k = 2 in
ϑ
(28) would still hold.
Proof. Fix f (Ψ;L2(Rd)). Let, for every ψ Ψ,
ω
∈ D ∈
ξ ψ
∈
a ξr ′g ∈m Rdin ξ∈m supa px
(ψ(cid:98))(cid:13)
(cid:13)ξ
−ξ′(cid:13)
(cid:13) 2.
We start in a similar fashion to the induction step of the proof of Theorem 3.5. By the same theorem, by the
path structure of the scattering network, and by Lemma 3.4, we find that, for all sufficiently large N N,
∈
(cid:88)
W (f) = W ( f ψ )
N N−1
| ∗ |
ψ∈Ψ
(cid:88)(cid:90)
( f ψ )(ξ) 2
(cid:18)
1
(cid:12)
(cid:12) (cid:12)ϑ(cid:98)(cid:0) C
χ,ϑ
αN−1
ξ(cid:1)(cid:12)
(cid:12)
(cid:12)2(cid:19)
dξ
≤ Rd|F | ∗ | | · − · ·
ψ∈Ψ
(29)
(cid:88)(cid:90)
f(cid:98)(ξ) 2 ψ(cid:98)(ξ) 2
(cid:18)
1
(cid:12)
(cid:12) (cid:12)ϑ(cid:98)(cid:0) C
χ,ϑ
αN−1 (ξ ξ
ψ)(cid:1)(cid:12)
(cid:12)
(cid:12)2(cid:19)
dξ.
≤ Rd| | ·| | · − · · −
ψ∈Ψ
Our strategy is to split the integral into small scales and large scales compared with α−N, and to establish
upper bounds on those terms separately. Note that our conditions on h guarantee that, for all sufficiently
k,ω
large N N,
∈
(30) sup h (t) = h (α−N) = α−kN ω−2(α−N).
k,ω k,ω
·
t∈(0,α−N]
For the small scales, we use (28) and (30) to derive
(cid:90)
f(cid:98)(ξ) 2 ψ(cid:98)(ξ) 2
(cid:18)
1
(cid:12)
(cid:12) (cid:12)ϑ(cid:98)(cid:0) C
χ,ϑ
αN−1 (ξ ξ
ψ)(cid:1)(cid:12)
(cid:12)
(cid:12)2(cid:19)
dξ
| | ·| | · − · · −
B α−N(ξ ψ)
(cid:90)
≤
|f(cid:98)(ξ) |2 ·|ψ(cid:98)(ξ) |2 ·C ·(cid:13) (cid:13)C
χ,ϑ
·αN−1 ·(ξ −ξ ψ)(cid:13) (cid:13)k
2
dξ
B α−N(ξ ψ)
(cid:90)
= C ·C χk
,ϑ
·αk(N−1)
·
|f(cid:98)(ξ) |2 ·|ψ(cid:98)(ξ) |2 ·ω2( ∥ξ −ξ
ψ
∥2) ·h k,ω( ∥ξ −ξ
ψ
∥2)dξ
B α−N(ξ ψ)
(cid:90)
C C χk
,ϑ
α−k ω−2(α−N) f(cid:98)(ξ) 2 ψ(cid:98)(ξ) 2 ω2(d ψ)dξ.
≤ · · · · | | ·| | ·
B α−N(ξ ψ)ENERGY PROPAGATION IN SCATTERING CONVOLUTION NETWORKS 31
The monotonicity of ω suffices to control the large scales,
(cid:90)
f(cid:98)(ξ) 2 ψ(cid:98)(ξ) 2
(cid:18)
1
(cid:12)
(cid:12) (cid:12)ϑ(cid:98)(cid:0) C
χ,ϑ
αN−1 (ξ ξ
ψ)(cid:1)(cid:12)
(cid:12)
(cid:12)2(cid:19)
dξ
Rd\B α−N(ξ ψ)| | ·| | · − · · −
(cid:90)
≤ Rd\B α−N(ξ
ψ)|f(cid:98)(ξ) |2 ·|ψ(cid:98)(ξ) |2 ·ω2( ∥ξ −ξ
ψ
∥2) ·ω−2( ∥ξ −ξ
ψ
∥2)dξ
(cid:90)
ω−2(α−N) f(cid:98)(ξ) 2 ψ(cid:98)(ξ) 2 ω2(d ψ)dξ.
≤ · Rd\B α−N(ξ ψ)| | ·| | ·
Inserting those estimates into (29) yields, for all sufficiently large N N,
∈
(cid:110) (cid:111) (cid:88)(cid:90)
W N(f) max 1,C C χk
,ϑ
α−k ω−2(α−N) f(cid:98)(ξ) 2 ψ(cid:98)(ξ) 2 ω2(d ψ)dξ
≤ · · · · Rd| | ·| | ·
ψ∈Ψ
 
(cid:110) (cid:111) (cid:88)
= max 1,C ·C χk
,ϑ
·α−k · ω2(d ψ) ·∥f ∗ψ ∥2 2 ·ω−2(α−N).
ψ∈Ψ
Now, if there is C(cid:101) > 0 so that ϑ(cid:98)(C
χ,ϑ
) χ
(cid:98)
and if h
k,ω
is nondecreasing on the entire interval (0, ), then
(29) and (30), and thus also the| latter· b| ou≤ nd| f| or W (f), are in fact valid for all N N . This conc∞ ludes the
N ≥2
proof of the theorem. ∈ □
The following lemma shows that fast decay (with respect to the weight ω) of the Fourier transform suffices,
independent of Ψ, for a signal to belong to the generalized Sobolev space (Ψ;L2(Rd)).
ω
D
Lemma 3.11. Let k > 0. If ω : (0, ) (0, ) is a weakly tk-dominated weight, then
∞ → ∞
L2(Rd) (Ψ;L2(Rd)).
ω ω
F ⊆ D
(cid:83)
Proof. Recall from Assumption 3.1 that Ψ can be decomposed into Ψ = j∈NΨ
j
such that supp(ψ(cid:98))
⊆
Srj,rj+κ
whenever ψ Ψ . In particular, d r γ−1 r . By assumption on ω, there exists J N such that h
j ψ j+κ j k,ω
is nondecrea∈ sing on (r , ). Hence,≤ for all j≤ N · , ∈
J >J
∞ ∈
(31) ω2(d ) ω2(γ−1 r ) γ−k ω2(r ).
ψ j j
≤ · ≤ ·
Let f L2(Rd). We aim to show that the sum (cid:80) ω2(d ) f ψ 2 converges. To do so, we split the sum
∈ F ω ψ∈Ψ ψ ·∥ ∗ ∥2
into small scales and large scales compared with J,
J (cid:90) ∞ (cid:90)
(cid:88) (cid:88) (cid:88) (cid:88)
f(cid:98)(ξ) 2 ψ(cid:98)(ξ) 2 ω2(d ψ)dξ + f(cid:98)(ξ) 2 ψ(cid:98)(ξ) 2 ω2(d ψ)dξ,
| | ·| | · | | ·| | ·
j=1ψ∈Ψj
Srj,rj+κ
j=J+1ψ∈Ψj
Srj,rj+κ
so that it suffices to bound these expressions individually. We can easily control the small scales by the
monotonicity of ω,
J (cid:90)
(cid:88) (cid:88)
f(cid:98)(ξ) 2 ψ(cid:98)(ξ) 2 ω2(d ψ)dξ
| | ·| | ·
j=1ψ∈Ψj
Srj,rj+κ
J (cid:90)
(cid:88) (cid:88)
ω2(r J+κ) f(cid:98)(ξ) 2 ψ(cid:98)(ξ) 2dξ
≤ · | | ·| |
j=1ψ∈Ψj
Srj,rj+κ
ω2(r J+κ) (cid:88)J (cid:88) (cid:90)
f(cid:98)(ξ) 2 ψ(cid:98)(ξ) 2 ω2( ξ )dξ.
≤ ω2(r ) · | | ·| | · ∥ ∥2
1
j=1ψ∈Ψj
Srj,rj+κ32 HARTMUTFU¨HR,MAXGETTER
For the large scales, in addition to the monotonicity of ω, we also use (31) to find that
∞ (cid:90)
(cid:88) (cid:88)
f(cid:98)(ξ) 2 ψ(cid:98)(ξ) 2 ω2(d ψ)dξ
| | ·| | ·
j=J+1ψ∈Ψj
Srj,rj+κ
∞ (cid:90)
(cid:88) (cid:88)
ω2(γ−1 r j) f(cid:98)(ξ) 2 ψ(cid:98)(ξ) 2dξ
≤ · · | | ·| |
j=J+1ψ∈Ψj
Srj,rj+κ
∞ (cid:90)
(cid:88) (cid:88)
γ−k ω2(r j) f(cid:98)(ξ) 2 ψ(cid:98)(ξ) 2dξ
≤ · · | | ·| |
j=J+1ψ∈Ψj
Srj,rj+κ
∞ (cid:90)
(cid:88) (cid:88)
γ−k f(cid:98)(ξ) 2 ψ(cid:98)(ξ) 2 ω2( ξ )dξ.
≤ · | | ·| | · ∥ ∥2
j=J+1ψ∈Ψj
Srj,rj+κ
(cid:110) (cid:111)
Altogether, letting C = max ω2(rJ+κ) ,γ−k , we obtain
ω2(r1)
∞ (cid:90)
(cid:88) (cid:88) (cid:88)
ω2(d ψ) ·∥f ∗ψ ∥2
2 ≤
C
·
|f(cid:98)(ξ) |2 ·|ψ(cid:98)(ξ) |2 ·ω2( ∥ξ ∥2)dξ
ψ∈Ψ j=1ψ∈Ψj
Srj,rj+κ
(cid:90)
(cid:88)
C κ f(cid:98)(ξ) 2 ψ(cid:98)(ξ) 2 ω2( ξ )dξ
≤ · · Rd| | ·| | · ∥ ∥2
ψ∈Ψ
(cid:90)
C κ f(cid:98)(ξ) 2 ω2( ξ )dξ < .
≤ · · Rd| | · ∥ ∥2 ∞
□
There are choices of the weight ω and the filter bank Ψ, for which the inclusion L2(Rd) (Ψ;L2(Rd))
ω ω
is strict, i.e., the spaces L2(Rd) and (Ψ;L2(Rd)) do not coincide, see Remark 4F .3. ⊆ D
ω ω
F D
As a consequence of Theorem 3.9 and Lemma 3.11, we obtain asymptotic convergence rates for signals of
(logarithmic) Sobolev regularity.
Corollary 3.12. Suppose that Assumption 3.1 holds for Ψ with parameters γ and ρ. As before, let
(cid:115)
4γ
α := 1 (1 ρ)2 (0,1).
− (1+γ)2 · − ∈
Then, the following hold:
a) If f Hs(Rd) for some s > 0, then
∈
W (f) (α2min{s,1}·N).
N
∈ O
b) If f Hs (Rd) for some s > 0, then
∈ log
W (f) (N−2s).
N
∈ O
Proof. Let
ϑ : Rd R, x e−π·∥x∥2 2.
→ (cid:55)→
Then, ϑ satisfies the prerequisites of Theorem 3.5. From the series expansion of the one-dimensional Gaussian
at 0 we can see that, for all ξ Rd,
∈ 1 ϑ(cid:98)(ξ) 2 2π ξ 2 .
−| | ≤ ·∥ ∥2
Now, part a) follows immediately from Theorem 3.9 and Lemma 3.11 if we take
ω : (0, ) (0, ), t
(1+t2)2s
.
∞ → ∞ (cid:55)→ENERGY PROPAGATION IN SCATTERING CONVOLUTION NETWORKS 33
In fact, using the criterion from Remark 3.8, it is straightforward to see that ω is a strongly t2-dominated
weight if s (0,1], since for all t > 0,
∈
2ω(t) 2s
t2
(1+t2)2s = 2t ω′(t) 0.
≥ · 1+t2 · · ≥
We draw the conclusion by noting that L2(Rd) = Hs(Rd) and that, for all N N,
ω
F ∈
ω−2(α−N) α2s·N.
≤
For s > 1, the statement simply follows from the inclusion Hs(Rd) H1(Rd).
⊆
In order to establish part b), let us consider
ω : (0, ) (0, ), t lns(e+t).
∞ → ∞ (cid:55)→
We verify the condition from Remark 3.8 again. In general, ω is not a strongly t2-dominated weight (if s is too
large). However, ω is a weakly t2-dominated weight. Indeed, for all t es e, we have ln(e+t) s, which
≥ − ≥
entails
t
2ω(t) = 2ln(e+t) lns−1(e+t) 2s lns−1(e+t) = 2t ω′(t) 0.
· ≥ · e+t · · ≥
Finally, by definition, L2(Rd) = Hs (Rd), and we have, for all N N,
F ω log ∈
ω−2(α−N) ln−2s(α−N) = ln−2s(α−1) N−2s.
≤ ·
This concludes the proof of part b) by Theorem 3.9. □
Remark 3.13. Using arguments very similar to those in the proof of Theorem 3.9 together with the compactly
supported positive definite radial basis function
(32) ϑ(cid:98): Rd R, ξ (1 ξ )⌊d 2⌋+1
→ (cid:55)→ −∥ ∥2 +
in the above proof, one can derive the following explicit upper bounds (as opposed to the asymptotic bounds in
the above corollary):
a) If f Hs(Rd) for some s > 0, then we have, for all N N,
∈ ∈
(cid:40) 2(cid:0)(cid:4)d(cid:5) +1(cid:1)(cid:41)
W (f) max 1, 2 f 2 αmin{2s,1}·N.
N
≤ α r ·∥
∥Hs(Rd)·
1
·
b) If f Hs (Rd) for some s > 0, then we have, for all N N,
∈ log ∈
(cid:40) 2(cid:0)(cid:4)d(cid:5) +1(cid:1)(cid:41)
W (f) max 1, 2 ln−min{2s,1}(α−1) f 2 N−min{2s,1}.
N ≤ α r
1
· ·∥ ∥H ls og(Rd)·
·
The differences in the asymptotic rates of decay (compared with the above corollary) are due to the fact that
the largest possible values k in (28) differ if ϑ is a Gaussian (k = 2) or if ϑ is defined as in (32)
ϑ ϑ
•
(k = 1).
ϑ
the weight ω : (0, ) (0, ),t lns(e+t) is not strongly t-dominated if s is too large. However, it
• is easy to see that∞ ω i→ s stron∞ gly t-(cid:55)→ dominated if s (0, 1].
∈ 234 HARTMUTFU¨HR,MAXGETTER
4. Applications
4.1. Scattering with UFC filters. In this section, we apply our results from Section 3 to a large class of
filter banks that is closely related to the class of uniform covering frames introduced in [3].
Definition 4.1. We say that the filters Ψ have uniform frequency concentration (UFC) if they fulfill
Assumption 3.1, and if
D := supd = sup inf sup ξ ξ < .
Ψ ψ∈Ψ ψ ψ∈Ψξ ψ∈Rd ξ∈supp(ψ(cid:98))∥ − ψ ∥2 ∞
It turns out that for such scattering networks, energy decay is exponential, globally on L2(Rd). Thereby,
we complement the earlier result [3, Proposition 3.3], which states global exponential energy decay for scat-
tering networks based on uniform covering frames. We have several comments concerning the similarities and
differences between our following result and the result in [3]:
In [3], the output-generating low-pass filter is assumed to be bandlimited. Our result also applies if
•
that is not the case.
In[3],thefrequencysupportofeachfilterψ Ψisassumedtobeconnected. Ourresultdoesnotrequire
• ∈
connectedness of the frequency supports. However, as is pointed out in [3, Remark 2.2], the motivation
to require connectedness of the frequency supports is to preclude certain pathological behavior such
as supp(ψ(cid:98)) having two connected components, where one component is near the origin and the other
is far from the origin. In our setting, we implicitly preclude such pathological behavior by means of
Assumption 3.1, which imposes frequency localization of the filters.
If D < , then the frequency support of each filter ψ Ψ is contained in a closed ball of radius
Ψ
• ∞ ∈
D . In particular, Ψ satisfies the uniform covering property introduced in [3], i.e., for any R > 0, there
Ψ
exists N N such that for each ψ Ψ, the set supp(ψ(cid:98)) can be covered by N cubes of side length 2R.
∈ ∈
In turn, if Ψ satisfies the uniform covering property, and if the frequency supports of the filters are
connected, then D < .
Ψ
∞
The findings in [3, Proposition 3.3] guarantee exponential decay of the energy remainder: For all
• f L2(Rd), and all N N,
∈ ∈
(cid:16) (cid:17)
W (f) αN f 2 f χ 2 ,
N ≤ · ∥ ∥2−∥ ∗ ∥2
for an unspecified constant α (0,1) depending only on the uniform covering frame. The main advant-
∈
age of our result is that we can explicitly specify the values for all occurring quantities in the upper
bound on the energy remainder, including a precise value for α.
Corollary 4.2. Suppose that the filters Ψ have uniform frequency concentration with parameters γ, ρ, and r
1
from Assumption 3.1.
Then we have, for all f L2(Rd), and for all N N,
∈ ∈
(cid:40) 2(cid:0)(cid:4)d(cid:5) +1(cid:1)(cid:41)
(cid:16) (cid:17)
W (f) max 1, 2 D f 2 f χ 2 αN,
N ≤ α r · Ψ · ∥ ∥2−∥ ∗ ∥2 ·
1
·
(cid:113)
where, as before, α := 1 4γ (1 ρ)2. Asymptotically, we even have
− (1+γ)2 · −
W (f)
(cid:0) α2N(cid:1)
.
N
∈ O
Proof. Both statements (the specific bound and the asymptotic behavior) are immediate consequences of The-
orem 3.9. To derive the specific upper bound, we choose (in the notation of the theorem)
ω : (0, ) (0, ), t √t and ϑ(cid:98): Rd R, ξ (1 ξ )⌊d 2⌋+1 .
∞ → ∞ (cid:55)→ → (cid:55)→ −∥ ∥2 +ENERGY PROPAGATION IN SCATTERING CONVOLUTION NETWORKS 35
Clearly, ω is a strongly t-dominated weight. Further, ϑ satisfies the prerequisites of Theorem 3.5 with
|ϑ(cid:98)(r 1−1 ·)
| ≤
|χ
(cid:98)
|, i.e., C
χ,ϑ
= r 1−1. Moreover, by Bernoulli’s inequality we have, for all ξ
∈
Rd,
(cid:18)(cid:22) (cid:23) (cid:19)
d
1 ϑ(cid:98)(ξ) 2 2 +1 ξ .
−| | ≤ 2 ·∥ ∥2
Finally, note that
(cid:88) (cid:88) (cid:16) (cid:17)
ω2(d ) f ψ 2 ω2(D ) f ψ 2 = D f 2 f χ 2 ,
ψ ·∥ ∗ ∥2 ≤ Ψ · ∥ ∗ ∥2 Ψ · ∥ ∥2−∥ ∗ ∥2
ψ∈Ψ ψ∈Ψ
which concludes the first part of the corollary. The asymptotic rate also follows directly from Theorem 3.9, if
we take
ω : (0, ) (0, ), t t and ϑ : Rd R, x e−π·∥x∥2 2.
∞ → ∞ (cid:55)→ → (cid:55)→
□
Remark 4.3. In the context of the above corollary, it holds that
L2(Rd) ⊊ L2(Rd) = (Ψ;L2(Rd)).
ω ω
F D
This again shows the strength of Theorem 3.9, and stresses the role of the filter bank specificity in energy
propagation in scattering networks.
4.2. Scattering with Wavelets. In this section, we apply our results from Section 2 and Section 3 to filter
banks that are wavelet-generated.
We begin by briefly reviewing scattering with directional wavelets as introduced in [11]. Let a > 1, and let
G < O (R) be a finite subgroup of rotations in Rd that comprises the reflection operator I G.
d
− ∈
Definition 4.4. We say that a pair of functions (ψ,ϕ) (cid:0) L1(Rd) L2(Rd)(cid:1)2 is admissible for (a,G)-
∈ ∩
wavelet scattering if
∞
(cid:88) (cid:88)
(33) ϕ(cid:98)(ξ) 2+ ψ(cid:98)(a−j M−1ξ) 2 = 1 a.e. ξ Rd.
| | | · | ∈
j=1M∈G
Note that (33) entails that
(cid:88) (cid:88)
ψ(cid:98)(a−j M−1ξ) 2 = 1 a.e. ξ Rd,
| · | ∈
j∈ZM∈G
which also implicitly requires ψ to have at least one vanishing moment, i.e., ψ(cid:98)(0) = 0. Fix J Z, and set
∈
Λ(a,G,J) := aj M j Z ,M G GL (R).
>−J d
{ · | ∈ ∈ } ⊆
Let, for each λ = aj M Λ(a,G,J),
· ∈
ψ := D1 ψ = adjψ(aj M−1 ).
λ λT
· ·
Moreover, set
ϕ := D1 ϕ = a−dJϕ(a−J ).
J a−J·I
·
Finally, define
Wav(ψ,a,G,J) := ψ λ Λ(a,G,J) .
λ
{ | ∈ }36 HARTMUTFU¨HR,MAXGETTER
By construction, the filters Wav(ψ,a,G,J) together with the corresponding low-pass filter χ := ϕ form a
J
semi-discrete Parseval frame. In fact, we obtain the Littlewood-Paley condition (3) from the admissibility
condition (33) by an index shift,
∞
(cid:88) (cid:88) (cid:88)
ϕ(cid:98)J(ξ) 2+ ψ(cid:98)(λ−1 ξ) 2 = ϕ(cid:98)(aJ ξ) 2+ ψ(cid:98)(a−j M−1ξ) 2
| | | · | | · | | · |
λ∈Λ(a,G,J) j=1−JM∈G
∞
(cid:88) (cid:88)
= ϕ(cid:98)(aJ ξ) 2+ ψ(cid:98)(a−j M−1(aJ ξ)) 2 = 1 a.e. ξ Rd.
| · | | · · | ∈
j=1M∈G
Definition 4.5. We say that the filters Ψ are wavelet-generated if there exist a finite subgroup G < O (R)
d
with I G, a > 1, J Z, and a pair (ψ,ϕ) (cid:0) L1(Rd) L2(Rd)(cid:1)2 that is admissible for (a,G)-wavelet
− ∈ ∈ ∈ ∩
scattering such that Ψ = Wav(ψ,a,G,J).
Our main application of the negative findings from Section 2 is that energy propagation can be arbitrarily
slow in wavelet scattering networks.
Corollary 4.6. If the scattering filters Ψ are wavelet-generated, then for any nonincreasing null-sequence
E = (E N) N∈N RN >0 there exists f g,E L2(Rd) such that
∈ ∈
a) f 2 C (1+E ),
∥ g,E ∥2 ≤ g · 1
b) f g 2 C E , and
∥ g,E − ∥2 ≤ g · 1
c) W (f )
∥g∥2
2 E for all N N.
N g,E ≥ 8 · N ∈
Furthermore,
(cid:110) (cid:12) (cid:111)
Y := f L2(Rd) (cid:12) W (f) (E )
E (cid:12) N N
∈ ∈ O
is a countable union of nowhere dense sets in L2(Rd). In particular, L2(Rd) Y is dense in L2(Rd).
E
\
Proof. The proof is a straightforward application of Corollary 2.8. Suppose that Ψ = Wav(ψ,a,G,J). Setting
A := a I gives σ (A) = a > 1. Moreover, for all m N, applying D1 to the filters Ψ results in an index
· d min ∈ A−m
shift, which leads to the required inclusion relation
Ψ m := D A1 −mΨ = (cid:8) D A1 −mψ λ (cid:12) (cid:12) λ
∈
Λ(a,G,J)(cid:9)
= (cid:8) D1 ψ (cid:12) (cid:12) λ Λ(a,G,J)(cid:9)
λT·A−m
∈
= ψ λ Λ(a,G,J +m)
λ
{ | ∈ }
ψ λ Λ(a,G,J +m+1) = Ψ .
λ m+1
⊆ { | ∈ }
□
The fact that for any nonincreasing null-sequence E RN the set L2(Rd) Y , which contains those
>0 E
∈ \
signals whose associated energy propagates not at the order of E through the scattering network, is dense in
L2(Rd) indicates that wavelet scattering energy propagation is not a stable property of signals. This is further
emphasized by the contrast that fast energy propagation provably also holds for dense signal classes of L2(Rd)
if the generating wavelet is bandlimited.
Corollary 4.7. Suppose that the scattering filters are wavelet-generated according to Ψ = Wav(ψ,a,G,J).
Moreover, assume that there exist M O (R), ρ [0,1), and κ N such that
ψ d ≥2
∈ ∈ ∈
ρ
supp(ψ(cid:98))
⊆
H
M ψ
∩Sa−1,aκ−1.ENERGY PROPAGATION IN SCATTERING CONVOLUTION NETWORKS 37
Let
(cid:115)
4aκ
α := 1 (1 ρ)2 (0,1).
− (1+aκ)2 · − ∈
If ω : (0, ) (0, ) is a weakly t2-dominated weight, then we have, for all f (Ψ;L2(Rd)),
ω
∞ → ∞ ∈ D
W (f) (ω−2(α−N)).
N
∈ O
Specifically, we can guarantee the following convergence rates:
a) If f Hs(Rd) for some s > 0, then
∈
W (f) (α2min{s,1}·N).
N
∈ O
b) If f Hs (Rd) for some s > 0, then
∈ log
W (f) (N−2s).
N
∈ O
Proof. We only need to show that Assumption 3.1 is satisfied in this setting. To this end, we note that we
have, for all λ = aj M Λ(a,G,J),
· ∈
(cid:16) (cid:17)
ρ ρ
supp(ψ(cid:99)λ)
⊆
λ ·supp(ψ(cid:98))
⊆
λ
·
H
M ψ ∩Sa−1,aκ−1
= H
M·M ψ
∩Saj−1,aκ+j−1.
Thus, we may apply Theorem 3.9 and Corollary 3.12, where γ = a−κ. □
Remark 4.8. Particularizing part a) of Corollary 4.7 for an overlap of κ = 2 and ρ = 0 in dimension d = 1
improves the currently best known upper bound on the asymptotic convergence rate for f Hs(R) from
∈
(cid:32) (cid:33)
(cid:18) a2 1(cid:19)min{2s,1}·N
W (f) −
N ∈ O a2+1
given by [21, Theorem 3.1] to
(cid:32) (cid:33)
(cid:18) a2 1(cid:19)2min{s,1}·N
W (f) − .
N ∈ O a2+1
Remark 4.9. The semantic content of a generic signal occurring in classification tasks is typically stable to the
action of small diffeomorphisms that deform signals [11,12]. The windowed scattering transform was introduced
as a model for feature extraction, building translation invariant representations of signals in L2(Rd) that take
this form of stability into account.
One approach [7, 19, 9] to prove stability of the scattering transform to the action of small diffeomorphisms
relies on the non-expansiveness of [F]. In this case, the stability ultimately results from the deformation
sensitivity of the class of signals beinS g considered, and thus naturally only applies to strict subclasses of L2(Rd).
A different approach [11, 13] explicitly takes into account the network architecture of scattering networks.
Here, stability of the wavelet scattering transform to the action of small diffeomorphisms can be guaranteed for
signals that have a finite mixed (ℓ1,L2(Rd)) scattering norm, i.e., for signals f L2(Rd) that satisfy
∈
∞ ∞
(34) ∥U[ PΨ](f) ∥ℓ1(PΨ;L2(Rd)) =
(cid:88) (cid:13) (cid:13)U[ΨN]f(cid:13)
(cid:13) ℓ2(ΨN;L2(Rd)) =
(cid:88)
(W
N[Ψ](f))1
2 < ∞.
N=0 N=0
In general, it is not easy to decide whether a signal satisfies this condition. In light of Corollary 4.6, there
exist dense subsets of L2(Rd) for which the mixed (ℓ1,L2(Rd)) scattering norm (34) does not converge. On
the other hand, if the generating wavelet of the filter bank is bandlimited, then Corollary 4.7 implies that the
mixed (ℓ1,L2(Rd)) scattering norm is finite at least for all signals belonging to Hs (Rd) for any s > 1. This
log
generalizes [13, Proposition 2.4] to arbitrary dimension d N.
∈38 HARTMUTFU¨HR,MAXGETTER
5. Concluding remarks
The successful application of wavelet based scattering transforms in pattern recognition or pattern classific-
ation tasks is attributed at least in part to the ability of the cascade of filter banks to correlate signal structures
across different scales. It can be argued that our constructions of counterexamples to fast energy decay defy
this intuition, by using signals consisting of components that are so dispersed in frequency that the scattering
transform essentially processes them in separate channels. Hence for this class of signals, across-scale correl-
ation of different frequency components is intentionally (approximately) disabled. That these signals exist in
L2(Rd) emphasizes the possibility that the intuitions underlying the interpretation of scattering transforms are
generally applicable only to more limited signal classes, i.e., they might reflect a type of implicit bias on the
modeling side. Understanding how this bias is related to the choice of filter bank has been one of the initial
impulses of this work.
Acknowledgements
TheauthorsacknowledgefundingbytheDeutscheForschungsgemeinschaft(DFG,GermanResearchFound-
ation) - Project number 442047500 through the Collaborative Research Center ”Sparsity and Singular Struc-
tures” (SFB 1481).
References
[1] JoakimAnd´en,VincentLostanlen,andSt´ephaneMallat.Jointtime-frequencyscatteringforaudioclassification.In2015IEEE
25th International Workshop on Machine Learning for Signal Processing (MLSP), pages 1–6. IEEE, 2015.
[2] Joyce Chew, Matthew Hirn, Smita Krishnaswamy, Deanna Needell, Michael Perlmutter, Holly Steach, Siddharth Viswanath,
and Hau-Tieng Wu. Geometric scattering on measure spaces. Applied and Computational Harmonic Analysis, page 101635,
2024.
[3] Wojciech Czaja and Weilin Li. Analysis of time-frequency scattering transforms. Applied and Computational Harmonic
Analysis, 47(1):149–171, 2019.
[4] Emmanuele DiBenedetto. Real analysis. Springer, 2002.
[5] MichaelEickenberg,GeorgiosExarchakis,MatthewHirn,St´ephaneMallat,andLouisThiry.Solidharmonicwaveletscattering
for predictions of molecule properties. The Journal of chemical physics, 148(24), 2018.
[6] FengGao,GuyWolf,andMatthewHirn.Geometricscatteringforgraphdataanalysis.InInternationalConferenceonMachine
Learning, pages 2122–2131. PMLR, 2019.
[7] Philipp Grohs, Thomas Wiatowski, and Helmut Bo¨lcskei. Deep convolutional neural networks on cartoon functions. In 2016
IEEE International Symposium on Information Theory (ISIT), pages 1163–1167. IEEE, 2016.
[8] MatthewHirn,St´ephaneMallat,andNicolasPoilvert.Waveletscatteringregressionofquantumchemicalenergies.Multiscale
Modeling & Simulation, 15(2):827–863, 2017.
[9] Michael Koller, Johannes Großmann, Ullrich Monich, and Holger Boche. Deformation stability of deep convolutional neural
networks on sobolev spaces. In 2018 IEEE International Conference on Acoustics, Speech and Signal Processing (ICASSP),
pages 6872–6876. IEEE, 2018.
[10] St´ephane Mallat. A wavelet tour of signal processing. Elsevier, 1999.
[11] St´ephane Mallat. Group invariant scattering. Communications on Pure and Applied Mathematics, 65(10):1331–1398, 2012.
[12] St´ephane Mallat. Understanding deep convolutional networks. Philosophical Transactions of the Royal Society A:
Mathematical, Physical and Engineering Sciences, 374(2065):20150203, 2016.
[13] Fabio Nicola and S Ivan Trapasso. Stability of the scattering transform for deformations with minimal regularity. Journal de
Math´ematiques Pures et Appliqu´ees, 180:122–150, 2023.
[14] Paul Sinz, Michael W Swift, Xavier Brumwell, Jialin Liu, Kwang Jin Kim, Yue Qi, and Matthew Hirn. Wavelet scattering
networks for atomistic systems with extrapolation of material properties. The Journal of Chemical Physics, 153(8), 2020.
[15] Jingtong Su and Julia Kempe. Wavelets beat monkeys at adversarial robustness. arXiv preprint arXiv:2304.09403, 2023.
[16] Emma Tolley. Wavelet scattering networks for identifying radio galaxy morphologies. arXiv preprint arXiv:2403.03016, 2024.
[17] Michael Tschannen, Thomas Kramer, Gian Marti, Matthias Heinzmann, and Thomas Wiatowski. Heart sound classification
using deep structured features. In 2016 Computing in Cardiology Conference (CinC), pages 565–568. IEEE, 2016.
[18] Irene Waldspurger. Exponential decay of scattering coefficients. In 2017 international conference on sampling theory and
applications (SampTA), pages 143–146. IEEE, 2017.ENERGY PROPAGATION IN SCATTERING CONVOLUTION NETWORKS 39
[19] ThomasWiatowskiandHelmutBo¨lcskei.Amathematicaltheoryofdeepconvolutionalneuralnetworksforfeatureextraction.
IEEE Transactions on Information Theory, 64(3):1845–1866, 2017.
[20] Thomas Wiatowski, Philipp Grohs, and Helmut Bo¨lcskei. Energy propagation in deep convolutional neural networks. IEEE
Transactions on Information Theory, 64(7):4819–4842, 2017.
[21] ThomasWiatowski,PhilippGrohs,andHelmutBo¨lcskei.Topologyreductionindeepconvolutionalfeatureextractionnetworks.
In Wavelets and Sparsity XVII, volume 10394, pages 269–280. SPIE, 2017.
[22] Xia Zhao, Limin Wang, Yufei Zhang, Xuming Han, Muhammet Deveci, and Milan Parmar. A review of convolutional neural
networks in computer vision. Artificial Intelligence Review, 57(4):1–43, 2024.
[23] Xiaosheng Zhao, Shifan Zuo, and Yi Mao. 3d scatternet: Inference from 21 cm light-cones. In 40th International Conference
on Machine Learning, 2023.
Email address: getter@mathga.rwth-aachen.de, fuehr@mathga.rwth-aachen.de
Lehrstuhl fu¨r Geometrie und Analysis, RWTH Aachen University, D-52056 Aachen, Germany